2
2
0
2

g
u
A
3
1

]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[

2
v
1
6
9
4
0
.
4
0
2
2
:
v
i
X
r
a

Title

Predicting solution scattering patterns with explicit-solvent molec-
ular simulations

Running title

Explicit-solvent SAS predictions

Authors

Leonie Chatzimagas1 and Jochen S. Hub1

Aﬃliations

1Theoretical Physics and Center for Biophysics, Saarland University, Saarbrücken 66123,
Germany

Keywords

Small-angle scattering, SAXS, SANS, all-atom molecular dynamics simulations, hydration
layer, excluded solvent

Abstract

Small-angle X-ray or neutron scattering (SAXS/SANS/SAS) is widely used to obtain struc-
tural information on biomolecules or soft-matter complexes in solution. Deriving a molecular
interpretation of the scattering signals requires methods for predicting SAS patterns from a
given atomistic structural model. Such SAS predictions are non-trivial because the patterns
are inﬂuenced by the hydration layer of the solute, the excluded solvent, and by thermal
ﬂuctuations. Many computationally eﬃcient methods use simpliﬁed, implicit models for
the hydration layer and excluded solvent, leading to some uncertainties and to free parame-
ters that require ﬁtting against experimental data. SAS predictions based on explicit-solvent
molecular dynamics (MD) simulations overcome such limitations at the price of an increased
computational cost. To rationalize the need for explicit-solvent methods, we ﬁrst review the
approximations underlying implicit-solvent methods. Next, we describe the theory behind
explicit-solvent SAS predictions that are easily accessible via the WAXSiS web server. We
present the workﬂow for computing SAS pattern from a given molecular dynamics trajec-
tory. The calculations are available via a modiﬁed version of the GROMACS simulations
software, coined GROMACS-SWAXS, which implements the WAXSiS method. Practical
considerations for running routine explicit-solvent SAS predictions are discussed.

1

Introduction

Small- and wide-angle X-ray scattering (SWAXS) has originally been used to probe the
overall shape of biomolecules or soft-matter complexes in solution. In recent decades, SWAXS
has developed into an increasingly quantitative probe, primarily due to improved sample
preparation, more brilliant light sources, and single-photon counting detectors (Koch et al.,

1

 
 
 
 
 
 
2003; Putnam et al., 2007; Graewert and Svergun, 2013). Thanks to the advent of free-
electron lasers, time-resolved SWAXS (TR-SWAXS) measurements are capable of tracking
ultrafast dynamics of biomolecules or small molecules in solution (Arnlund et al., 2014;
Levantino et al., 2015; Brinkmann and Hub, 2016). Complementary, small-angle neutron
scattering (SANS) has remained popular because it allows for contrast-variation experiments
by changing the D
O concentration of the buﬀer (Gabel, 2015). Henceforth, we use the term
2
SAS (small-angle scattering) when referring to both SWAXS and SANS.

Analysis of the SAS curve gives information on the overall shape and macroscopic prop-
erties of the probe, such as the radius of gyration, maximum particle size, the structural
order (globular vs. unfolded), molecular mass, and particle volume. In contrast, an atomistic
interpretation cannot be drawn from the data alone owing to the low information content
of the SAS curves, but instead requires methods for theoretically predicting SAS intensi-
ties from a given atomistic structure. Such SAS curve predictions, so-called forward models,
enable the validation or the reﬁnement of structural models or ensembles against SAS data.
The physical properties that give rise to a solution scattering curve I(q) are well under-

stood. Namely, the intensities are given by

I(q) = (cid:104)|F (q)|2(cid:105)Ω ,

(1)

where (cid:104)·(cid:105)Ω denotes the orientational average in reciprocal space, and F (q) is the Fourier
transform of the electron density contrast ∆ρ(r) between the solution and the pure-buﬀer
system:

(cid:90)

F (q) =

∆ρ(r) e−iq·r d3r

(2)

However, computing I(q) from a given structural model such as a crystal structure or a
molecular dynamics (MD) simulation of a biomolecule is complicated by several aspects:

(i) Since SAS detects the electron density contrast in solution, computing I(q) requires
knowledge of the volume of solvent that is displaced by the solute. For a biomolecule
with internal disorder and a rough surface, the displaced volume is far from obvious. In
addition, as discussed below, the volume taken by atoms of a certain chemical element
depends on the chemical environment, suggesting that tabulated atomic volumes are
subject to marked uncertainties.

(ii) The density of the hydration layer of biomolecules diﬀers from the density of bulk
solvent, thus contributing to the density contrast ∆ρ. The hydration layer is inﬂu-
enced by properties such as the biomolecule’s charge and geometry, the amino acid
composition of the surface (anionic, cationic, hydrophobic, hydrophilic neutral), or the
salt type and concentration of the buﬀer. For instance, highly charged biomolecules
such as DNA/RNA were shown to exhibit a tight hydration layer (Pollack, 2011).
For biomolecules with large surface-to-volume ratio, such as intrinsically disordered
proteins, the hydration layer is expected to strongly contribute to the SAS signal.
However, how such properties determine the hydration layer is not yet understood on
a quantitative level (Kim et al., 2016).

(iii) SAS curves are inﬂuenced by thermal ﬂuctuations of the biomolecule. Using analytic
models, Moore (2014) showed that including Debye-Waller factors or correlated atomic
ﬂuctuations inﬂuences the calculated SAS curves at relatively small scattering angles

2

of q (cid:38) 0.2 Å−1. These ﬁndings are in line with earlier experimental observations (Tiede
et al., 2002) and with MD simulations, which revealed alterations of SAXS curves at
q (cid:38) 0.25 Å−1 upon modulating atomic ﬂuctuations during the simulations (Chen and
Hub, 2014).

In the last three decades, a wide range of methods have been developed for predicting SAS
intensities from atomistic structures, reﬂecting the increasing importance of SAS experiments
for biomolecular research and the need for a physically founded interpretation of the data
(Svergun et al., 1995; Merzel and Smith, 2002a,b; Tjioe and Heller, 2007; Bardhan et al.,
2009; Ravikumar et al., 2013; Yang et al., 2009; Schneidman-Duhovny et al., 2010, 2013;
Stovgaard et al., 2010; Poitevin et al., 2011; Liu et al., 2012; Nguyen et al., 2014; Putnam
et al., 2015; Grudinin et al., 2017; Oroguchi et al., 2009; Oroguchi and Ikeguchi, 2012;
Grishaev et al., 2010; Virtanen et al., 2011; Park et al., 2009; Köﬁnger and Hummer, 2013;
Chen and Hub, 2014; Knight and Hub, 2015). The methods mainly diﬀer by

• the method for modeling the hydration layer, involving explicit all-atom models, in-
creased atomic form factors for solvent-exposed solute atoms, layers of uniform electron
density, implicit models with internal structure, or several others;

• modeling of the excluded solvent based on tabulated atomic volumes up to explicit

all-atom models;

• mathematical methods for computing the orientational average involving the Debye

equation, a spherical harmonics expansion, or numerical quadrature;

• the spatial resolution, i.e., whether the SAS curves are computed from individual atoms

or from coarse-grained beads.

In this chapter, we focus on the calculation of SAS curves from atomistic explicit-solvent
MD simulations as implemented in GROMACS-SWAXS, an extension of the GROMACS
simulation software (https://gitlab.com/cbjh/gromacs-swaxs) (Chen and Hub, 2014; Chen
et al., 2019). The method is easily accessible via the WAXSiS web server at https://waxsis.uni-
saarland.de (Knight and Hub, 2015). As a rationale behind the explicit-solvent methods,
we ﬁrst review the approximations and limitations underlying widely used implicit-solvent
methods, with a focus on the role of the hydration layer and excluded solvent for obtaining
the density contrast. Next, we brieﬂy describe the theory of explicit-solvent SAS curve pre-
dictions from explicit-solvent MD simulations as used by GROMACS-SWAXS and WAXSiS.
Finally, the workﬂow of SAS calculations from an MD trajectory and practical considerations
are discussed.

2

Implicit-solvent methods

Computationally eﬃcient methods for computing SAS curves, as implemented in CRYSOL,
FoXS, PepsiSAXS, or several other tools, use an implicit representation of the hydration
layer and excluded solvent. To rationalize the beneﬁts of explicit-solvent SAS calculations,
we discuss the limitation of implicit-solvent methods in the following.

3

Figure 1: (A/C) Hydration layer (B/D) displaced solvent, as represented by (A/B) explicit-
solvent and (C/D) several implicit-solvent methods. (A) A spatial envelope is deﬁned (blue
mesh) that includes the biomolecule and the hydration layer, here shown for the protein
PCNA (pdb code 4D2G) (De Biasio et al., 2015). (B) The same spatial envelope is used
to deﬁne the displaced solvent. (C) Implicit-solvent methods use a simpliﬁed description of
the hydration layer, often modeled as a layer of uniform density, while (D) the displaced
solvent is typically described by water dummy beads with estimated volumes taken from a
publication by Traube (1895) and ﬁtted against the data.

Displaced solvent. Many methods represent the displaced (or excluded) solvent with the
help of water dummy beads, which are typically placed at the positions of the biomolecule’s
heavy atoms (see Fig. 1D) (Svergun et al., 1995; Grudinin et al., 2017). The electron density
of the bead is essentially taken as ρd(r) = ρs exp(−πr2/v2/3), where ρs is the electron density
of the solvent and v the displaced volume, such that the bead carries ρsv electrons, as desired.
The atomic form factor of the bead is given by the Fourier transform of the electron density,
fd(q) = ρsv exp(−v2/3q2/4π). In the implicit-solvent description, the buﬀer subtraction is
carried out by reducing the atomic form factor of the biomolecule’s heavy atom with the
form factor of the dummy bead fd(q), leading to so-called “reduced form factors”.

This method requires knowledge of the displaced volumes v for all atoms. However,
estimates for the displaced volume diﬀer substantially within the literature, leading to some
uncertainty in the predicted SAS curve (Hub, 2018). Most SAXS prediction methods use
and cite the displaced volumes reported by Fraser et al. (1978). These data originally date
back to a publication in 1895 by Isidor Traube, which was based on the volume change of
water in response to the solvation of various organic compounds (Traube, 1895). Table 1
presents the atomic volumes reported by Fraser et al. in Å3 as well as the original values
by Traube in ccm/mol for several atoms or chemical groups. Traube and Fraser values are
identical since ccm/mol = 1.66 Å3.

4

Table 1: Displaced volumes from Voronoi tessellation of crystal structure cores by Pontius
et al. (1996), as well as from densitometric data by Traube (1895), as cited by Fraser et al.
(1978). Pontius values represent averages and standard deviations from all amino acids.
Traube and Fraser values are identical, using ccm/mol = 1.66 Å3. Fraser volumes of chemical
groups represent sums of single-atom volumes.

Atomic group Pontius et al. [Å3] Fraser et al., 1978 [Å3]

H
C
N

O

OH
NH
CH
CH
CH

2

3

8.8 (0.8)

22.3 (0.4)

23.9 (0.9)
14.1 (0.3)
11.8 (0.6)
20.9 (1.8)
33.9 (1.2)

5.15
16.44
2.49

9.13

14.28
7.64
21.59
26.74
31.89

Traube, 1895 [ccm/mol]
3.1
9.9
1.5 (trivalent)
10.7 (pentavalent)
8.5–10.7 (in nitro compound)
5.5 (carbonyl oxygen)
2.3 or 0.4 (hydroxy oxygen)

More recently, atomic volumes have been obtained by Pontius et al. using Voronoi tessel-
lation applied to the core region of high-resolution protein structures (Pontius et al., 1996).
The volumes by Traube and Fraser greatly diﬀer from the volumes obtained from crystal
structures (Table 1, columns 2 and 3). Compared to the Pontius values, the Fraser values
greatly overestimate the volumes of CH and CH
groups, and they underestimate the vol-
2
umes of N and O atoms and of NH or OH groups. Notably, Traube reported volumes of N or
O atoms for alternative chemical environments such as nitro or (today outdated) “pentava-
lent” environments as well as for hydroxyl groups; however, these were not cited by Fraser,
which may explain why they are not used in SAS calculations today (Table 1, column 4).

Besides the uncertainty owing to the choice of tabulated atomic volumes, additional
uncertainty may arise because the atomic volumes depend on the chemical environment.
Whereas the volumes by Pontius et al. represent the atomic packing in the core of stable
proteins, it seems unlikely that the volumes also hold for more ﬂexible protein surfaces, for
detergent micelles, or for nucleotides. For n-hexadecane, for instance, the Pointius and Fraser
volumes would imply a molecular volume of 360.4 Å3 and 438.1 Å3, respectively, whereas the
experimental value is 486.6 Å3.

Hydration layer (HL). Several tools model the hydration layer (HL) as a layer with a
predeﬁned thickness and a uniform excess density (Fig. 1C). For instance, CRYSOL con-
structs a homogeneous 3 Å-wide layer described by a two-dimensional angular function lead-
ing to a simplistic representation of the HL, which may not be suitable for molecules with
cavities or non-globular shapes (Svergun et al., 1995). CRYSOL3 aims to overcome this
limitation by incrusting the surface (Franke et al., 2017)) similar to the grid-based den-
sity employed by PepsiSAXS (Grudinin et al., 2017). In contrast, FoXS models the HL by
increasing atomic form factors of solvent-exposed atoms (Schneidman-Duhovny et al., 2010).
The density of HLs of biomolecules likely depends on the type of the water–surface

5

interactions and, therefore, on the chemical composition of the surface. For instance, Kim
et al. (2016) found that acidic amino acids (Glu/Asp) exhibit a tighter HL as compared to
basic amino acids (Arg/Lys), an eﬀect that our group recently observed in MD simulations
(unpublished data). Likewise, it seems plausible that the HL of maltoside or sodium dodecyl
sulfate (SDS) head groups of detergent micelles exhibit diﬀerent densities as compared to
the HL of charged or hydrophobic amino acids. Such chemical speciﬁcity of the HL is not
captured by implicit solvent methods, explaining why they require ﬁtting of the HL against
experimental data.

Risk of overﬁtting solvent-related parameters Owing to the simpliﬁed description of
the HL and excluded solvent, implicit-solvent methods require two or three parameters that
are adjusted upon ﬁtting the calculated curve to the experimental curve. One parameter
adjusts the excess density of the HL, while another parameter adjusts the volumes of the
dummy beads that represent the excluded solvent. Some methods adjust in addition the
overall displaced volume. The parameters are typically ﬁtted by minimizing the residuals
between the calculated and experimental SAS curves. Whether the ﬁtted parameters reﬂect
the physical situation such as the true HL density, or whether they merely absorb errors
in the structural model or in the experimental data, is typically not clear. Hence, ﬁtting
solvent-related parameter may hide structurally relevant information.

A possible consequence of ﬁtting parameters is illustrated in Fig. 2, which presents the
validation of MD simulations of a protein-detergent complex against SAXS data (Chen
and Hub, 2015b; Berthaud et al., 2012). The complexes were composed of an aquaporin-0
tetramer solvated in 250 to 330 βDDM detergent molecules. Computing SAXS curves from
the simulations with implicit-solvent methods and ﬁtting the curves to experimental data
leads to χ-values that hardly depend on the number of βDDM molecules, suggesting that
alterations in the structural model have been absorbed into the ﬁtting parameters (Fig.
2D). Consequently, the experimental number of βDDM molecules cannot be obtained by
comparison with the data. This example illustrates that structurally relevant information
may be hidden upon ﬁtting free parameters. In contrast, when using explicit-solvent SAXS
calculations described below, the χ-agreement of models with diﬀerent βDDM numbers
with the data can be distinguished because no solvent-related parameters are ﬁtted, thereby
revealing that the model with 290 βDDM exhibits the best agreement with the data (Fig.
2C).

3 Explicit-solvent SAS predictions with the WAXSiS method

Several methods for predicting SAS curves have been presented that model both the ex-
cluded solvent and the HL with explicit-solvent MD simulations (Oroguchi et al., 2009;
Park et al., 2009; Köﬁnger and Hummer, 2013; Chen and Hub, 2014). Here, we focus on
the WAXSiS method, which is based on the formalism by Park et al. (2009). However,
whereas the implementation by Park et al. required a constrained biomolecule, the WAXSiS
method allows SAS predictions from MD simulations of ﬂexible biomolecules by deﬁning
the SAS-contributing solvent with a spatial envelope. In addition, the WAXSiS method
corrects (i) imprecise densities of water models and (ii) small density mismatches between
the biomolecule and the pure-solvent simulation systems, both of which may inﬂuence the

6

Figure 2: SAXS curve prediction and snapshots of a protein-detergent complex. (A) MD
simulation systems of aquaporin-0 solubilized in 250 to 330 βDDM detergent molecules
simulated with the Charmm36 force ﬁeld. (B) Explicit-solvent SAXS curve predictions for
diﬀerent number of βDDM using an aggregated ensemble of 90 ns to 100 ns MD trajectories
(colored lines). Experimental data (black dashed line) from Berthaud et al. (2012). (C) χ-
agreement between experimental SAXS curves and explicit-solvent SAXS calculations from
free MD simulations (colored bars) or from the WAXSiS webserver (black bars). WAXSiS
restrains the DDM molecules in a short simulation, rationalizing the increased χ-values.
NβDDM = 290 reveals the best agreement with experiment. (D) χ-agreement by CRYSOL,
FoXS, and AquaSAXS, revealing nearly constant χ due to the adjustment of free parameters.
Reprinted with permission from Chen and Hub (2015b), Copyright 2020 American Chemical
Society.

SAS prediction signiﬁcantly. A careful comparison of diﬀerent implicit and explicit SAXS
prediction methods has been presented by Bernetti and Bussi (2021).

In the WAXSiS method, a spatial envelope is deﬁned that encloses the biomolecule and
the heterogeneous density of the HL (Fig. 1A, Fig. 3A). Hence, the HL structure is fully
deﬁned by the force ﬁeld and does not require a free ﬁtting parameter. The buﬀer subtraction
is carried out by computing the scattering intensity diﬀerence between (a) the biomolecule
with the envelope-enclosed solvent and (b) an explicit-solvent pure-buﬀer simulation, from
which an identical volume is taken with the help of the same envelope (Fig 1B). Thereby,
the displaced solvent is modeled with atomic detail and without need of knowing atomic
volumes of solute atoms.

Compared to implicit-solvent methods, the explicit-solvent calculations are computa-
tionally far more expensive as they require MD simulations, but they have several crucial
advantages:

(i) The calculations do not require any free solvent-related parameters that must be ﬁtted
to experimental data. Thus, the amount of structural information, which can be ex-
tracted from the low-information SAS data, is not further reduced. By circumventing
the ﬁtting of the HL density, the radius of gyration is not adjusted against the data.

7

Figure 3: (A) Solvent electron density around Rnase A, taken from an explicit-solvent MD
simulations with position restraints on all heavy atoms, revealing the marked structure of
the hydration layer. Only solvent density inside an envelope (blue mesh) is shown, where
the envelope was constructed at a 7Å distance from the protein surface. (B) Solvent density
as function of the distance from the Van der Waals surface for three diﬀerent proteins (see
legend), averaged over the protein surface. Simulations were carried out with the Amber99sb-
ildn/Tip3p force ﬁelds. Here, the solvent density was scaled with a small constant factor to
match the experimental bulk density of 334 e nm−3, as implemented in GROMACS-SWAXS
to correct imprecise densities of some water models.

(ii) The use of “reduced form factors” is avoided and, with this, the uncertainties subject
to atomic volumes. This may explain the better accuracy compared to implicit-solvent
methods for predicting the SAS intensities of heterogeneous systems (such as protein-
detergent complexes) and for molecules with non-globular geometries (Ivanović et al.,
2018a, 2020).

(iii) The explicit-solvent description remains valid at wide scattering angles (q >1.5 Å),

where the internal structure of water becomes relevant (Park et al., 2009).

(iv) By computing the SAS patterns from an MD trajectory, the method naturally ac-
counts for thermal ﬂuctuations, which inﬂuence the SAS patterns at remarkably small
scattering angles of q (cid:38) 0.25 Å−1 (Tiede et al., 2002; Moore, 2014; Chen and Hub,
2014, 2015b).

As an example, Fig. 4A compares the experimental SAXS curve of the ring-shaped
protein PCNA with a curve computed with the WAXSiS method. The WAXSiS curve was
computed from the 4D2G crystal structure of PCNA, to which missing termini were added
(Cordeiro et al., 2017), and the computed curve was henceforth scaled with a constant factor
(Iscaled(q) = f IWAXSiS(q)). No other parameters were adjusted. Figure 4B compares SAXS
curves computed from the 4D2G structure (without termini) computed with WAXSiS and
with several implicit-solvent methods. All methods used default settings, and the calculated
curves were not ﬁtted against the experiment. Evidently, the predicted SAXS curves diﬀer
signiﬁcantly, presumably owing to diﬀerent modeling of the hydration layer and excluded
solvent.

8

Figure 4: (A) Experimental SAXS data of the ring-shaped protein PCNA (grey) and
SAXS curve computed with the WAXSiS model from a PCNA model with modeled loops
(cid:0)χ2 = 1.35(cid:1) (Cordeiro et al., 2017). (B) Comparison of SAXS curves of the PCNA crys-
tal structure (pdb code 4D2G) computed with diﬀerent methods with default settings (see
legend). Panel A adapted and reused with permission from Cordeiro et al. (2017).

4 Theory

The experimental SAS intensity is given by the diﬀerence between the scattering intensity
of the solution Isample(q) and the solvent Isolvent(q):

I(q) = Isample(q) − Isolvent(q)

(3)

To calculate this excess intensity I(q) from MD trajectories, the WAXSiS method follows the
formalism by Park et al. (2009). The low-dilution limit is considered, such that correlations
between diﬀerent solute molecules can be neglected and the scattering experiment can be
modeled by a single solute molecule in a solvent bath. A spatial envelope is constructed
around the solute including the hydration layer (Fig. 1A). The instantaneous electron density
of the solute system A(r) and of the solvent system B(r) is divided into the electron density
inside and outside of the envelope, indicated by subscripts i and o, respectively,

A(r) = Ai(r) + Ao(r) ,

B(r) = Bi(r) + Bo(r) .

(4)

(5)

Assuming that the envelope is large enough such that density correlations between the inside
and the outside of the envelope are due to bulk water, the excess scattering intensity only
requires knowledge of the Fourier transforms of the electron densities inside the envelope
˜Ai(q) and ˜Bi(q):

I(q) = (cid:10)D(q)(cid:11)

Ω ,

(6)

where

D(q) = (cid:10)(cid:12)

(cid:12) ˜Ai(q)(cid:12)
(cid:12)

2(cid:11)(ω)

− (cid:10)(cid:12)

(cid:12) ˜Bi(q)(cid:12)
(cid:12)

2(cid:11)(ω)

+ 2Re(cid:2)−(cid:10) ˜B∗

i (q)(cid:11)(ω)(cid:10) ˜Ai(q) − ˜Bi(q)(cid:11)(ω)

].

(7)

Here, (cid:104)...(cid:105)Ω denotes the orientational average in q-space, (cid:104)...(cid:105)(ω) the average over solute and
solvent ﬂuctuations at ﬁxed solute orientation ω, and Re is the real part. In practice, (cid:104)...(cid:105)(ω)

9

represents the average over MD frames after superimposing the solute onto a reference
structure of orientation ω. ˜Ai(q) and ˜Bi(q) are calculated using the atomic form factors
fj(q) and coordinates rj of atom j,

˜Ai(q) =

NA(cid:88)

j=1

fj(q)e−iq·rj ,

(8)

where NA is the number of atoms within the envelope in the respective MD frame (Fig. 1A).
˜Bi(q) is calculated analogously over the solvent atoms within the envelope (Fig. 1B). The
form factors are approximated using the Cromer-Mann parameters ak, bk and c of atom j
(Cromer and Mann, 1968),

fj(q) =

4
(cid:88)

k=1

ake−bk(q/4π)2

+ c .

(9)

The formalism is identical for SANS calculations, except that the atomic form factors fj(q)
are replaced by the coherent neutron scattering lengths bj of the scattering atoms (Chen
et al., 2019; Dias-Mirandela et al., 2018).

Comparing to experimental data

To compare a predicted curve with experimental data, the experimental curve Iexp can be
ﬁtted to the calculated curve Ic by minimizing

χ2 = N −1

q

Nq
(cid:88)

i=1

(cid:2)Ic(qi) − (cid:0)f Iexp(qi) + c(cid:1)(cid:3)2
σ2
i

,

(10)

where Nq denotes the number of q-points, and σi are the experimental errors. Besides the
overall scale f , an oﬀset c may be ﬁtted to account for small experimental uncertainties
from the buﬀer subtraction. Here, the experimental curves are ﬁtted instead of the calculated
curves, because the calculated curves are predicted without any free parameters. In practice,
it is advisable to ﬁt also without the oﬀset c and, thereby, to test whether c absorbs only
a small constant oﬀset, as desired, or whether ﬁtting the oﬀset would hide a structurally
relevant discrepancy between Iexp and Ic.

5 Workﬂow

We present a brief workﬂow for computing a SAS curve from an explicit-solvent MD simula-
tion (Fig. 5). Because the SAS calculations are implemented into an extension of GROMACS,
it is convenient (but not required) to run the MD simulation with GROMACS as well. This
workﬂow is automated also on the web server WAXSiS (https://waxsis.uni-saarland.de).
However, the MD simulations on WAXSiS are carried out with the Yasara software which
allows fully automated MD simulations even in presence of ligands or modiﬁed amino acids
(Krieger and Vriend, 2015). Several additional tutorials and more detailed documentation
for GROMACS-SWAXS are available at https://cbjh.gitlab.io/gromacs-swaxs-docs.

10

Figure 5: Workﬂow for SAS curve predictions with GROMACS-SWAXS. *Suggested mdp
parameters are shown in listing 1.

5.1 A: With any GROMACS

1. Run an MD simulation of your biomolecule in solution with either GROMACS-SWAXS
or any other GROMACS version. Choose the simulation box large enough, such that the
envelope (see below) will ﬁt into the box. To generate the box use, e.g.,

gmx editconf -d 1.5 -f protein . gro - bt dodecahedron -o box . gro

where for the -d option a distance between 1.5 and 2.0 is usually suﬃcient.
2. Run an MD simulation of pure solvent for the buﬀer subtraction. Use the same water
model and MD parameter (mdp) ﬁle as used for the solute simulations to ensure that solute
and solvent simulations exhibit identical bulk solvent densities, as required for an accurate
buﬀer subtraction. The solvent simulation box should be at least as large as your solute
simulation box. Produce 1 ns to 5 ns of simulation, writing the simulation frames every 1 ps
to 5 ps, i.e. ∼1000 frames.

11

Solute simulation:box large enough to include envelope(e.g. 1.5 nm distance to protein)Pure solvent simulation:box size ≥ solute system1-5ns, writing frames every 1-5 ps  trajectory ofsolute  trajectory of solventsolvent.tprsolute.tprGenerate the envelopedistance to protein surface ≥ 0.7 nmInclude atomic form factors/neutron scattering lengths into the systems topology1. Generatea tpr ﬁle to detect chemial elements2. Create scatter.itp ﬁles for each moleculetype in the topology 3. Include the ﬁles at the end of the corresponding [moleculetype] section in the topology envelope.datenvelope-ref.groscatter_ProteinA.itp... generate solute tpr ﬁlegenerate pure solvent tpr ﬁlemdp ﬁle with SWAXS options*mdp ﬁle with SWAXS options*waxs-solute = Set the evironemental variables export GMX_ENVELOPE_FILE=envelope.datexport GMX_WAXS_FIT_REFFILE=envelope-ref.groCompute the SWAXS curve with gmx mdrun gmx mdrun -s solute.tpr -rerun solutetraj.xtc -sw solvent.tpr -fw solventtraj.xtcWith any GROMACSWith GROMACS-SWAXS5.2 B: With GROMACS-SWAXS

When the simulations of solute and pure solvent have ﬁnished, we continue with preparing
and running the SAS curve calculation. Once the steps below are understood, they can be
scripted to automate the SAS curve calculation.
1. Download and compile GROMACS-SWAXS (https://gitlab.com/cbjh/gromacs-swaxs),
and load it into your path:

source / path / to / gromacs - swaxs / bin / GMXRC

5.2.1 Specify the atomic form factors/neutron scattering lengths

2. Generate a run-input (tpr) ﬁle using gmx grompp of GROMACS-SWAXS to detect the
chemical elements, which are used below for assigning the Cromer-Mann parameters or
neutron scattering lengths. Chemical elements are recognized using atom names and masses
to ensure that a Cα carbon atom (C) is not confused with calcium (Ca), Fluor (F) not with
Iron (Fe), etc. Atomic masses are reliably provided by a tpr ﬁle. An empty mdp ﬁle may be
used for this step:

rm -f anymdp . mdp ; touch anymdp . mdp
gmx grompp -f anymdp . mdp -p topol . top -o tmp . tpr

3. Now, the previously created tpr ﬁle is used to generate a scatter.itp ﬁle for each molecule,
which contains the Cromer-Mann parameters or the neutron scattering lengths. If the solute
contains non-default groups, such as chromophore, a heme group, or similar, ﬁrst prepare
an index ﬁle with the entire solute. Then run:

gmx genscatt -s tmp . tpr [ - n index . ndx ] [ - vsites ]

Select your complete solute, such as Protein, Protein_HEME or Protein_Chromophore.
If you use virtual sites, use -vistes and select Prot-Masses (or a group with heme, the
chromophore, etc.). The -visites option instructs gmx genscatt that atomic masses deviate
from the physical masses, as common when using virtual sites. gmx genscatt writes one itp
ﬁle for each molecule type. These must be added to each moleculetype deﬁnition in the
topology, similar to the #include "posres.itp" line for deﬁning position restraints.

5.2.2 Generating the envelope

4. Generate the envelope from the trajectory of the solute simulations

gmx genscatt -s tmp . tpr -f solutetraj . xtc -d 0.7

The output envelope.dat lists inner and outer radii of the envelope surface, whereas envelope-ref.gro
is a reference structure with orientation ω used to superimpose the solute frames onto the
envelope (see Theory). The envelope may be visualized with PyMol with the ﬁle envelope.py .

5.2.3 Generating the solute and solvent run-input ﬁles

5. Generate tpr ﬁles with gmx grompp and with an mdp ﬁle that contains all SAS-speciﬁc
parameters, as presented in Listing 1.

gmx grompp -f rerun . mdp -c solutesystem . gro [ - n index . ndx ] -o solute . tpr

In addition, a tpr ﬁle of the pure-solvent system is required, prepared with a mdp ﬁle with
an empty solute entry ( waxs-solute = )

12

Listing 1: A typical set of SAS-speciﬁc mdp parameters for calculating a SWAXS/SANS
curve with GROMACS-SWAXS. The calculation of SANS curves is optional, as indicated
by square brackets.

= -1

= C - alpha

= Water_and_ions

= Protein ; or Protein - Masses

; read scattering info from topology
define = - DSCATTER
; turn on SAXS calc . and , optionally , multiple SANS calc .
scatt - coupl = xray [ neutron neutron ...]
; solute group
waxs - solute
; solvent group
waxs - solvent
; rotational fit group as used with gmx genenv
waxs - rotfit
; or use a PBC atom near the geometric center , as suggested by gmx genenv
waxs - pbcatom
; for uniform average over all simulation frames
waxs - tau
; number of q - points
waxs - nq
; qmin and qmax in nm ^( -1)
waxs - startq
waxs - endq
; number of q - vectors for spherical average , use ~0.2*( D * qmax )^2
waxs - nsphere
; experimental solvent density in e / nm3 , for solvent density correction
waxs - solvdens = 334
; Use I ( sample ) - I ( buffer ) as buffer subtraction scheme
waxs - correct - buffer = no
; D2O concentrations of SANS calculations
waxs - deuter - conc = [0.42 1]

= 0
= 10

= 1500

= 101

= 0

gmx grompp -f solvent . mdp -c solventsystem . gro -o solvent . tpr

5.2.4 Compute the SAS curve

6. Finally, compute the SAS curves from the solute simulations with the rerun functionality
of gmx mdrun . The envelope ﬁles are speciﬁed with environment variables, as follows:

export GM X_E NV ELO PE_ FIL E = envelope . dat
export G M X _ W A X S _ F I T _ R E F F I L E = envelope - ref . gro
gmx mdrun -s solute . tpr - rerun solutetraj . xtc \

- sw solvent . tpr - fw solventtraj . xtc

The SAS calculations strongly beneﬁt from the use of a GPU or from using multiple CPU
cores, for instance using gmx mdrun -ntomp 16 -gpu_id 0 ... . The SAS curves are written to
the ﬁles waxs_final.xvg .

13

6 Practical considerations

6.1 Convergence

The number of simulation frames required to receive a converged SAS curve depends on
the contrast between solute and solvent, where a lower contrast leads to slower convergence.
The contrast is lower if the hydration layer is large compared to the biomolecule, i.e., if
the envelope contains mostly water. Speciﬁcally, small biomolecules or intrinsically disor-
dered proteins (IDPs) require a larger number of simulation frames as compared to larger
or globular biomolecules. As a reference, for a smaller protein such as the GB3 domain,
approximately 300 frames are required to obtain a well-converged SAS curve. A larger pro-
tein such as glucose isomerase requires approx. 70 frames. The statistical errors listed in
waxs_final.xvg are computed with error propagation, assuming that each simulation frame
provides an independent solvent structure, which is fulﬁlled when using frames with time
spacing (cid:38) 1 ps.

For IDPs, the convergence should be carefully assessed, for instance by dividing the
trajectory of both the biomolecule and the buﬀer into ten independent blocks, and then
comparing the ten SAS curves computed from the blocks. The standard error over the
blocks provides a rigorous measure for statistical uncertainty.

6.2 Orientational average

The parameter J (mdp option waxs-nsphere) determines the number of q-vectors used to
take the orientational average. It should be taken as J ≈ α(Dqmax)2. Where D is the
maximum diameter of the solute, qmax the maximum momentum transfer (mdp option waxs-
endq), and the constant α determines the accuracy of the orientational average. For most
biomolecules, α = 0.2 is suﬃcient, while for excessively elongated rod-like structures a value
of α = 0.5 may be required.

6.3 Envelope size

The distance of the envelope from the biomolecular surface (speciﬁed with gmx genenv -d)
should be at least 0.6 nm to 0.7 nm, thereby containing the density modulations along the
hydration layers. For highly charged biomolecules, a larger envelope may be used to account
for the entire counter ion cloud. We found previously that a distance of ∼3 times the Debye
length is required to include most eﬀects from the counter ion cloud on the radius of gyration
of glucose isomerase (Ivanović et al., 2018b). At a salt concentration of 100 mM, this may
require an envelope distance of ∼3 nm and, hence, large simulation systems.

6.4 Solvent density correction

A solvent density correction is necessary for two reasons: (i) Due to ﬁnite-size eﬀects, the
bulk solvent densities and correlations may slightly diﬀer between the solute simulation and
the pure-solvent simulation (Köﬁnger and Hummer, 2013). (ii) The density of certain water
models, such as the popular Tip3p model, deviate from the experimental water densities.
The parameter for solvent density correction should be chosen to match the experimental
electron density of the solvent (mdp option waxs-solvdens ).

14

6.5 Atomic ﬂuctuations

Structural ﬂuctuations inﬂuence the SAS proﬁle. Depending on the scientiﬁc question, po-
sition restraints may or may not be applied to the biomolecule, for instance with the aim
to obtain the SAS curve for structure with given backbone coordinates or for a ﬂexible
biomolecular ensemble, respectively. To resolve the structure of the HL, it may be useful to
restrain all heavy atoms of the biomolecule to avoid that side chain ﬂuctuations smear out
the HL structure, as used to obtain the solvent densities shown in Fig. 3.

6.6 Water models

We validated previously that most popular water force ﬁelds lead to nearly identical SAS
curves at moderate scattering angles, suggesting that most water models exhibit similar
packing at the biomolecular surface (Chen and Hub, 2014). Only at very wide angle of q (cid:38)
2 Å−1, where the water scattering is dominant, large eﬀects from the water models are visible.
However, we recently observed that water models with increased dispersion interactions such
as the Tip4p2005s or Tip4p-D may impose tighter packing on the protein surface, leading to
slightly increased radii of gyration (unpublished data) (Best et al., 2014; Piana et al., 2015).
These observations open a novel route for validating protein–water interactions by modern
force ﬁelds against experimental SAS data.

6.7 Computational costs

Run times of SAS predictions depend on the number of atoms, on the applied convergence
criteria, and on the hardware. Typical costs may be illustrated by the execution time for
diﬀerent proteins on the WAXSiS webserver at https://waxsis.uni-saarland.de, which is cur-
rently (by August 2022) equipped with a 16-core AMD Ryzen 9 processor and an Nvidia
RTX 3070Ti graphics card. Using the convergence setting “normal”, which is suitable for
tests, SAS predictions of lysozyme (PDB id 1LYS), glucose isomerase (PDB id 1MNZ),
and RNA polymerase II (PDB id 1TWF) required 2.7 min, 4.8 min, and 15.2 min, respec-
tively. Using the convergence setting “thorough”, which is recommended for publications,
the execution times for the same biomolecules increased to 10.8 min, 14.2 min, and 36.3 min,
respectively. These numbers may change as the hardware improves or as the convergence
criteria are adapted in future releases of the WAXSiS webserver.

7 Summary

Both implicit- and explicit-solvent SAS prediction methods are highly valuable for the struc-
tural interpretation of experimental SAS methods. Implicit-solvent methods are computa-
tionally eﬃcient, thus allowing high-throughput calculations on a laptop. They are unequiv-
ocally capable of validating the overall shape of structural models against SAS data, and to
reveal eﬀects from larger conformational transitions. To harvest structural details, as encoded
in high-precision SAS data collected from modern SEC-SAXS or SEC-SANS experiments,
explicit-solvent methods are needed. They are (i) based on an accurate representation of
the hydration layer and the excluded solvent, thereby avoiding solvent-related ﬁtting pa-
rameters, (ii) are accurate for inhomogeneous systems since they do not require tabulated
atomic volumes, and (iii) include eﬀects from structural ﬂuctuations on SAS curves. The

15

WAXSiS method presented here may be further used for structure reﬁnement simulations
by restraining an MD simulation to experimental SAS data (Chen and Hub, 2015a; Chen
et al., 2019). More details on structure reﬁnement are provided in a chapter of Part B of
this monograph.

Running a SAS prediction on the WAXSiS webserver requires between 3 and 40 min
including the MD simulation. On a fast workstation or a computer cluster, tens to hundreds
of explicit-solvent calculations are feasible within days, suggesting that the cost for explicit-
solvent SAS calculations are negligible as compared to the costs for experimental sample
preparation or for data collection at the beamline. Therefore, we expect that the methods
presented here will become a routinely used tool for SAS-based structural biology.

8 Acknowledgements

We thank Tobias Fischbach for support with preparing Figure 2A. This study was supported
by the Deutsche Forschungsgemeinschaft (HU 1971-3/1).

References

Arnlund, D., Johansson, L. C., Wickstrand, C., Barty, A., Williams, G. J., Malmerberg, E.,
Davidsson, J., Milathianaki, D., DePonte, D. P., Shoeman, R. L., et al. (2014). Visualizing
a protein quake with time-resolved X-ray scattering at a free-electron laser. Nat. Methods,
11(9):923–926.

Bardhan, J., Park, S., and Makowski, L. (2009). It SoftWAXS: A computational tool for mod-
eling wide-angle X-ray solution scattering from biomolecules. J. Appl. Cryst., 42(5):932–
943.

Bernetti, M. and Bussi, G. (2021). Comparing state-of-the-art approaches to back-calculate
SAXS spectra from atomistic molecular dynamics simulations. Eur. Phys. J. B, 94(9):180.

Berthaud, A., Manzi, J., Pérez, J., and Mangenot, S. (2012). Modeling detergent orga-
nization around aquaporin-0 using small-angle X-ray scattering. J. Am. Chem. Soc.,
134(24):10080–10088.

Best, R. B., Zheng, W., and Mittal, J. (2014). Balanced Protein–Water Interactions Im-
prove Properties of Disordered Proteins and Non-Speciﬁc Protein Association. Journal of
Chemical Theory and Computation, 10(11):5113–5124.

Brinkmann, L. U. L. and Hub, J. S. (2016). Ultrafast anisotropic protein quake propagation
after CO-photodissociation in myoglobin. Proc. Natl. Acad. Sci. USA, 113:10565–10570.

Chen, P.-c. and Hub, J. S. (2014). Validating solution ensembles from molecular dynamics

simulation by wide-angle X-ray scattering data. Biophys. J., 107:435–447.

Chen, P.-c. and Hub, J. S. (2015a). Interpretation of solution X-ray scattering by explicit-

solvent molecular dynamics. Biophys. J., 108:2573–2584.

Chen, P.-c. and Hub, J. S. (2015b). Structural Properties of Protein-Detergent Complexes

from SAXS and MD Simulations. J. Phys. Chem. Lett., 6:5116–5121.

16

Chen, P.-c., Shevchuk, R., Strnad, F. M., Lorenz, C., Karge, L., Gilles, R., Stadler, A. M.,
Hennig, J., and Hub, J. S. (2019). Combined Small-Angle X-ray and Neutron Scattering
Restraints in Molecular Dynamics Simulations. Journal of Chemical Theory and Compu-
tation, 15(8):4687–4698.

Cordeiro, T. N., Chen, P.-c., De Biasio, A., Sibille, N., Blanco, F. J., Hub, J. S., Crehuet,
R., and Bernadó, P. (2017). Disentangling polydispersity in the PCNA-p15PAF complex,
a disordered, transient and multivalent macromolecular assembly. Nucleic Acids Res.,
45:1501–2015.

Cromer, D. T. and Mann, J. B. (1968). X-ray scattering factors computed from numerical

Hartree-Fock wave functions. Acta Cryst. A, 24(2):321–324.

De Biasio, A., de Opakua, A. I., Mortuza, G. B., Molina, R., Cordeiro, T. N., Castillo,
F., Villate, M., Merino, N., Delgado, S., Gil-Cartón, D., Luque, I., Diercks, T., Bernadó,
P., Montoya, G., and Blanco, F. J. (2015). Structure of p15PAF–PCNA complex and
implications for clamp sliding during DNA replication and repair. Nat Commun, 6(1):6439.

Dias-Mirandela, G., Tamburrino, G., Ivanović, M. T., Strnad, F. M., Byron, O., Rasmussen,
T., Hoskisson, P. A., Hub, J. S., Zachariae, U., Gabel, F., Hoskisson, P., Hub, J. S.,
Zachariae, U., Gabel, F., and Javelle, A. (2018). Merging in-solution X-ray and neutron
scattering data allows ﬁne structural analysis of membrane-protein detergent complexes.
J. Phys. Chem. Lett., 9:3910–3914.

Franke, D., Petoukhov, M. V., Konarev, P. V., Panjkovich, A., Tuukkanen, A., Mertens, H.
D. T., Kikhney, A. G., Hajizadeh, N. R., Franklin, J. M., Jeﬀries, C. M., and Svergun,
D. I. (2017). ATSAS 2.8 : A comprehensive data analysis suite for small-angle scattering
from macromolecular solutions. J Appl Crystallogr, 50(4):1212–1225.

Fraser, R., MacRae, T., and Suzuki, E. (1978). An improved method for calculating the
contribution of solvent to the X-ray diﬀraction pattern of biological molecules. J. Appl.
Cryst., 11(6):693–694.

Gabel, F. (2015). Small-angle neutron scattering for structural biology of protein–rna com-

plexes. In Methods in Enzymology, volume 558, pages 391–415. Elsevier.

Graewert, M. A. and Svergun, D. I. (2013). Impact and progress in small and wide angle

X-ray scattering (SAXS and WAXS). Curr. Opin. Struct. Biol., 23(5):748–754.

Grishaev, A., Guo, L., Irving, T., and Bax, A. (2010). Improved ﬁtting of solution X-ray
scattering data to macromolecular structures and structural ensembles by explicit water
modeling. J. Am. Chem. Soc., 132:15484–15486.

Grudinin, S., Garkavenko, M., and Kazennov, A. (2017). Pepsi-SAXS: An adaptive method
for rapid and accurate computation of small-angle X-ray scattering proﬁles. Acta. Cryst.
D, 73(5).

Hub, J. S. (2018). Interpreting solution X-ray scattering data using molecular simulations.

Curr. Opin. Struct. Biol., 49:18–26.

17

Ivanović, M. T., Bruetzel, L. K., Lipfert, J., and Hub, J. S. (2018a). Temperature-dependent
atomic models of detergent micelles reﬁned against small-angle X-ray scattering data.
Angew. Chem. Int. Ed., 57:5635–5639.

Ivanović, M. T., Bruetzel, L. K., Shevchuk, R., Lipfert, J., and Hub, J. S. (2018b). Quantify-
ing the inﬂuence of the ion cloud on SAXS proﬁles of charged proteins. Physical Chemistry
Chemical Physics, 20(41):26351–26361.

Ivanović, M. T., Hermann, M. R., Wójcik, M., Pérez, J., and Hub, J. S. (2020). Small-Angle
X-ray Scattering Curves of Detergent Micelles: Eﬀects of Asymmetry, Shape Fluctuations,
Disorder, and Atomic Details. The Journal of Physical Chemistry Letters, 11(3):945–951.

Kim, H. S., Martel, A., Girard, E., Moulin, M., Härtlein, M., Madern, D., Blackledge, M.,
Franzetti, B., and Gabel, F. (2016). SAXS/SANS on supercharged proteins reveals residue-
speciﬁc modiﬁcations of the hydration shell on supercharged proteins reveals residue-
speciﬁc modiﬁcations of the hydration shell. Biophys. J., 110(10):2185–2194.

Knight, C. J. and Hub, J. S. (2015). WAXSiS: A web server for the calculation of
SAXS/WAXS curves based on explicit-solvent molecular dynamics. Nucleic Acids Res.,
43:W225–W230.

Koch, M. H., Vachette, P., and Svergun, D. I. (2003). Small-angle scattering: A view on
the properties, structures and structural changes of biological macromolecules in solution.
Quart. Rev. Biophys., 36(02):147–227.

Köﬁnger, J. and Hummer, G. (2013). Atomic-resolution structural information from scat-

tering experiments on macromolecules in solution. Phys. Rev. E., 87:052712.

Krieger, E. and Vriend, G. (2015). New ways to boost molecular dynamics simulations. J.

Comput. Chem., 36(13):996–1007.

Levantino, M., Schiro, G., Lemke, H. T., Cottone, G., Glownia, J. M., Zhu, D., Chollet,
M., Ihee, H., Cupane, A., and Cammarata, M. (2015). Ultrafast myoglobin structural
dynamics observed with an X-ray free-electron laser. Nature Commun., 6:6772.

Liu, H., Morris, R. J., Hexemer, A., Grandison, S., and Zwart, P. H. (2012). Computation
of small-angle scattering proﬁles with three-dimensional Zernike polynomials. Acta Cryst.
A, 68(2):278–285.

Merzel, F. and Smith, J. C. (2002a). Is the ﬁrst hydration shell of lysozyme of higher density

than bulk water? Proc. Natl. Acad. Sci. USA, 99:5378–5383.

Merzel, F. and Smith, J. C. (2002b). SASSIM: A method for calculating small-angle X-ray
and neutron scattering and the associated molecular envelope from explicit-atom models
of solvated proteins. Acta Cryst. D, 58:242–249.

Moore, P. B. (2014). The Eﬀects of Thermal Disorder on the Solution-Scattering Proﬁles of

Macromolecules. Biophys. J., 106:1489–1496.

Nguyen, H. T., Pabit, S. A., Meisburger, S. P., Pollack, L., and Case, D. A. (2014). Accurate
small and wide angle x-ray scattering proﬁles from atomic models of proteins and nucleic
acids. J. Chem. Phys., 141(22):22D508.

18

Oroguchi, T., Hashimoto, H., Shimizu, T., Sato, M., and Ikeguchi, M. (2009).

Intrinsic
Dynamics of Restriction Endonuclease it EcoO109I Studied by Molecular Dynamics Sim-
ulations and X-Ray Scattering Data Analysis. Biophys. J., 96:2808–2822.

Oroguchi, T. and Ikeguchi, M. (2012). MD–SAXS method with nonspherical boundaries.

Chem. Phys. Lett., 541:117–121.

Park, S., Bardhan, J. P., Roux, B., and Makowski, L. (2009). Simulated x-ray scattering of

protein solutions using explicit-solvent models. J Chem Phys, 130:134114.

Piana, S., Donchev, A. G., Robustelli, P., and Shaw, D. E. (2015). Water Dispersion Inter-
actions Strongly Inﬂuence Simulated Structural Properties of Disordered Protein States.
The Journal of Physical Chemistry B, 119(16):5113–5123.

Poitevin, F., Orland, H., Doniach, S., Koehl, P., and Delarue, M. (2011). AquaSAXS: A
web server for computation and ﬁtting of SAXS proﬁles with non-uniformally hydrated
atomic models. Nucl. Acids Res., 39:W184–W189.

Pollack, L. (2011). Saxs studies of ion–nucleic acid interactions. Annual review of biophysics,

40:225–242.

Pontius, J., Richelle, J., and Wodak, S. J. (1996). Deviations from standard atomic volumes

as a quality measure for protein crystal structures. J. Mol. Biol., 264(1):121–136.

Putnam, C. D., Hammel, M., Hura, G. L., and Tainer, J. A. (2007). X-ray solution scatter-
ing (SAXS) combined with crystallography and computation: Deﬁning accurate macro-
molecular structures, conformations and assemblies in solution. Quart. Rev. Biophys.,
40(3):191–285.

Putnam, D. K., Weiner, B. E., Woetzel, N., Lowe, E. W., and Meiler, J. (2015). BCL::SAXS:
GPU accelerated Debye method for computation of small angle X-ray scattering proﬁles.
Proteins Struct. Funct. Bioinf., 83(8):1500–1512.

Ravikumar, K. M., Huang, W., and Yang, S. (2013). Fast-SAXS-pro: A uniﬁed approach to
computing SAXS proﬁles of DNA, RNA, protein, and their complexes. J. Chem. Phys.,
138(2):01B609.

Schneidman-Duhovny, D., Hammel, M., and Sali, A. (2010). FoXS: A web server for rapid

computation and ﬁtting of SAXS proﬁles. Nucl. Acids Res., 38:W540–W544.

Schneidman-Duhovny, D., Hammel, M., Tainer, J. A., and Sali, A. (2013). Accurate SAXS
proﬁle computation and its assessment by contrast variation experiments. Biophys. J.,
105(4):962–974.

Stovgaard, K., Andreetta, C., Ferkinghoﬀ-Borg, J., and Hamelryck, T. (2010). Calculation
of accurate small angle X-ray scattering curves from coarse-grained protein models. BMC
Bioinformatics, 11(1):429.

Svergun, D., Barberato, C., and Koch, M. H. J. (1995). CRYSOL – a Program to Evaluate
X-ray Solution Scattering of Biological Macromolecules from Atomic Coordinates. J. Appl.
Cryst., 28:768–773.

19

Tiede, D. M., Zhang, R., and Seifert, S. (2002). Protein conformations explored by diﬀerence
high-angle solution x-ray scattering: Oxidation state and temperature dependent changes
in cytochrome c. Biochemistry, 41(21):6605–6614.

Tjioe, E. and Heller, W. T. (2007). Ornl_sas: software for calculation of small-angle scat-
tering intensities of proteins and protein complexes. Journal of Applied Crystallography,
40(4):782–785.

Traube, J. (1895). Ueber das Molekularvolumen. Ber. Dtsch. Chem. Ges., 28(3):2722–2728.

Virtanen, J. J., Makowski, L., Sosnick, T. R., and Freed, K. F. (2011). Modeling the hydra-
tion layer around proteins: Applications to small-and wide-angle x-ray scattering. Biophys.
J., 101(8):2061–2069.

Yang, S., Park, S., Makowski, L., and Roux, B. (2009). A rapid coarse residue-based compu-
tational method for X-ray solution scattering characterization of protein folds and multiple
conformational states of large protein complexes. Biophys. J., 96(11):4449–4463.

20

