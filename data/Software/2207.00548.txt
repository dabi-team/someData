2
2
0
2

l
u
J

1

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
8
4
5
0
0
.
7
0
2
2
:
v
i
X
r
a

AIROPA III: Testing Simulated and On-Sky Data

Paolo Turria,b,*, Jessica R. Luc, Gunther Witzeld, Anna Ciurloe, Tuan Doe, Andrea M. Gheze,
Michael P. Fitzgeralde, Matthew C. Brittonf, Sam Raglandg, Sean K. Terryc
aUniversity of British Columbia, Department of Physics & Astronomy, 6224 Agricultural Rd, Vancouver, BC,
Canada, V6T 1Z1
bNational Research Council, Herzberg Astronomy and Astrophysics, 5071 W. Saanich Rd, Victoria, BC, Canada,
V9E 2E7
cUniversity of California - Berkeley, Astronomy Department, 501 Campbell Hall, Berkeley, CA, USA, 94720
dMax Planck Institute for Radio Astronomy, Auf dem H¨ugel 69, Bonn, Germany, D-53121
eUniversity of California - Los Angeles, Division of Astronomy & Astrophysics, Los Angeles, CA, USA, 90095
fThe Aerospace Corporation, 2310 E. El Segundo Blvd, El Segundo, CA, USA, 90245
gW. M. Keck Observatory, 65-1120 Mamalahoa Hwy, Kamuela, HI, USA, 96743

Abstract.

Adaptive optics images from the W. M. Keck Observatory have delivered numerous inﬂuential scientiﬁc results,
including detection of multi-system asteroids, the supermassive black hole at the center of the Milky Way, and directly
imaged exoplanets. Speciﬁcally, the precise and accurate astrometry these images yield was used to measure the mass
of the supermassive black hole using orbits of the surrounding star cluster. Despite these successes, one of the major
obstacles to improved astrometric measurements is the spatial and temporal variability of the point-spread function
delivered by the instruments. AIROPA is a software package for the astrometric and photometric analysis of adaptive
optics images using point-spread function ﬁtting together with the technique of point-spread function reconstruction.
In adaptive optics point-spread function reconstruction, the knowledge of the instrument performance and of the
atmospheric turbulence is used to predict the long-exposure point-spread function of an observation. In this paper
we present the results of our tests using AIROPA on both simulated and on-sky images of the Galactic Center. We
ﬁnd that our method is very reliable in accounting for the static aberrations internal to the instrument, but it does not
improve signiﬁcantly the accuracy on sky, possibly due to uncalibrated telescope aberrations.

Keywords: adaptive optics, PSF reconstruction, Galactic Center, astrometry.

*Paolo Turri, turri@astro.ubc.ca

1 Introduction

Adaptive optics (AO) is a technology used in ground-based optical and near-infrared (NIR) as-
tronomy to compensate for the blurring effects of the Earth’s atmosphere (see Ref. 1 for a com-
prehensive review on the subject). Atmospheric turbulence deteriorates the ﬂat incoming wave-
front of light and the corresponding diffraction-limited point-spread function (PSF) of a telescope
into a broad, seeing-limited PSF, with a width set by the amount of turbulence. AO corrects the
aberrations using wavefront sensing cameras and deformable mirrors operating at milli-second
timescales. By restoring the diffraction-limited full width at half maximum (FWHM) of the PSF,
AO achieves observations with a higher spatial resolution and signal-to-noise ratio than seeing-
limited observations.

One of the most successful applications of AO in astronomy has been the study of the Galactic
Center (GC) at the W. M. Keck Observatory. The compact radio source Sgr A* at the center of our
Galaxy2 has a NIR counterpart surrounded by a cluster of high proper motion, orbiting stars.3–5
AO has been used to resolve this dense environment, and make precise astrometric, photometric,
and spectroscopic measurements of individual stars for the past 20 years. These measurements
have been used to prove that a supermassive black hole (SMBH) resides at the center with a mass

1

 
 
 
 
 
 
of 4.02 ˆ 106 M@ at a distance of 8.0 kpc,6–8 surrounded by a young nuclear star cluster whose
formation is still not well understood, an old nuclear star cluster with an unusual metallicity dis-
tribution, and short-period orbiting stars9, 10 that have been used to test general relativity and other
theories of gravity.11

One of the primary limitations to studies with AO of crowded ﬁelds are the systematic errors
caused by the imperfect knowledge of the PSF. The accuracy achievable by AO instrumentation
in astrometry, photometry and the measurement of spectra is degraded if the PSF model used
for ﬁtting is not representative of the data.12–16 One of the most difﬁcult aspects of the PSF to
model is the spatial variability over the ﬁeld of view. The main sources of ﬁeld-dependent PSF
variation are uncorrected atmospheric turbulence17 and non-common path aberrations.18 In single-
conjugate AO systems, like the one at Keck, the correction is optimized in the direction of the guide
star and deteriorates rapidly outside a radius of several arcseconds, an effect known as angular
anisoplanatism.19 This is caused by the loss of correlation between the wavefront measured in
the direction of the guide stars and the wavefront corrected in a different direction. The effect
is the elongation of the PSF in the direction of the guide star. The magnitude of the angular
anisoplanatism depends on the distance from the guide star, on the vertical distribution of the
atmospheric turbulence, and on the elevation angle of the telescope.

One solution to model a ﬁeld-dependent PSF is to use many bright and isolated stars to measure
it at different ﬁeld positions.20, 21 The more the PSF varies, the larger the required number of these
“PSF stars”. In the GC ﬁeld of view of NIRC2 and OSIRIS, two of the instruments served by
the Keck AO system, there are only a dozen of suitable PSF stars, not enough to characterize the
observed spatial variation. In addition, the extreme degree of crowding in the region does not
allow a clear measurement of the proﬁle of most of them. With just a limited number of sources
available, so far only a constant PSF has been used for PSF ﬁtting of the Keck observations.

An alternative to the direct measurement of the PSF is to predict it by modelling the optical
system and the atmospheric turbulence using the technique of PSF-reconstruction.22, 23 While this
approach has been proved both in theory and on sky,24–27 it has not been used consistently for
scientiﬁc observations. Furthermore, the off-axis variations of the PSF are not predicted and must
be modeled.

AIROPA (Anisoplanatic and Instrumental Reconstruction of Off-axis PSFs for AO) is a PSF-
ﬁtting software with ﬁeld-dependent PSF-reconstruction, developed with the goal of improving
the accuracy of the GC astrometry and photometry with NIRC2, the Keck AO imager. AIROPA
models two components of the PSF variability–the instrumental aberrations and the atmospheric
aberrations–and can be used to analyze NIRC2 and OSIRIS images, which are the two instruments
fed by the Keck AO systems.

AIROPA is described in a series of papers: an overview,28 details of the instrumental model-
ing,29 and on-sky testing in a wide range of atmospheric conditions.30 In this paper we discuss
the testing of AIROPA with simulated and on-sky NIRC2 images. In Section 2, we outline the
operating principles of AIROPA on NIRC2 images. The instrumental and astronomical data used
for this paper are introduced in Section 3. In Section 4 we present the astrometric and photometric
analysis with AIROPA of several simulated images, while in Section 6 we use our software on
real on-sky images of the GC taken with NIRC2. Section 7 discusses the results of our tests of
AIROPA’s performance.

2

Fig 1 Diagram of AIROPA in variable-PSF mode. The elements represented by a parallelogram are star catalogs.
Blue items are produced by our modiﬁed version of StarFinder, green by ARROYO, and red by the NIRC2 image
reduction pipeline.

2 AIROPA

AIROPA reconstructs the PSF for an image through a combination of (1) empirical extraction from
stars in the image and (2) model prediction from atmospheric turbulence proﬁles and instrumen-
tal aberration maps. The AIROPA modules for star detection, empirical PSF extraction, and PSF
ﬁtting are built upon StarFinder,31 an IDL program that extracts stellar astrometry and photom-
etry from focal plane images using a single PSF over the whole image. AIROPA improves on
StarFinder by building and ﬁtting a grid of reconstructed, spatially variable PSFs deﬁned across
the FOV. It also uses an improved algorithm to smooth the PSF halo and to make it converge to
zero at the edges, by clipping the values that are below the noise level and that are not contiguous
to the rest of the PSF model.

AIROPA offers two alternative approaches to PSF modelling. The classical single-PSF
mode uses StarFinder to ﬁt every star in an image using the same PSF model, empirically extracted
from the median of the normalized proﬁles of a user-selected set of PSF reference stars. The
variable-PSF algorithm (Figure 1) uses instead a grid of different PSFs across the ﬁeld of
view, built from a combination of the empirically extracted PSF and a ﬁeld-dependent model of
anisoplanatic and instrumental aberrations.28

The PSF of an exposure taken at the time t, and at the position r in the NIRC2 FOV, can be
described as the convolution of the on-axis (r “ 0) PSF with an instrumental and atmospheric
component that characterize its spatial variability:

P SF pr, tq “ P SF0ptq ˚ P SFinstpr, tq ˚ P SFatmpr, tq.

(1)

For faster computation and easier manipulation of the terms, we use the convolution theorem with
the optical transfer function (OTF), deﬁned as the Fourier transform of the PSF:

OTF pr, tq “ OTF0ptq ¨ OTFinstpr, tq ¨ OTFatmpr, tq.

(2)

3

InputSource DetectionPSF FittingPSF ReconstructionImageMASS/DIMMInstrumental phase mapsOTFatmOTFinstrPupil maskPSFsOTFsOTF0,sOTFPSFCross-correlationOutputIterative PSF and Source ExtractionProximity cutFittedQuality cutOTF0PSF starsThe OTFinst and OTFatm are the ratios of the OTF at the position r respect to the one on-axis
OTF0, caused by instrumental aberrations and AO angular anisoplanatism, respectively. The OTF
is composed of a real part (called the modulation transfer function, or MTF) and an imaginary part
(called the phase transfer function, or PhTF).

The NIRC2 contribution to the OTF can be considered constant with time during one year of
observations of the GC (see Section 5), except for the position angle of the telescope pupil as
seen by the instrument, which changes between exposures as the telescope tracks the target during
the night. OTFinst is measured typically once a year at several positions in the NIRC2 FOV (see
Section 3.2). The OTF ratio is then masked using the telescope pupil rotated by the position angle
it had at the time of the exposure,29 recorded in the NIRC2 FITS image header.

The atmospheric factor OTFatm is calculated on a grid within the FOV using the ARROYO
code,32 which models the angular anisoplanatism produced by the Keck AO system. This program
requires knowledge of the position of the natural guide star (NGS) and laser guide star (LGS)
relative to the frame, as well as the turbulence proﬁle measured at the time of the exposure (Section
4.1).

Last, the spatially constant OTF0 of the exposure is extracted empirically from the PSF stars.
Each star’s individual, off-axis P SFs is Fourier-transformed into OTFs “ FtP SFsu. Following
Eq. 2, the on-axis OTF0,s of a star can be computed by removing the instrumental and atmospheric
components:

OTF0,sptq “

OTFspr, tq
OTFinstpr, tq ¨ OTFatmpr, tq

.

(3)

The OTF0 of an image is the average of the OTF0,s from the set of selected PSF reference stars.

Once all three OTF components are in place, the OTF pr, tq for a position in an exposure is
obtained using Eq. 2, and the P SF pr, tq is calculated as its inverse Fourier transform. The ﬁnal
PSF is cut to a diameter of 150 px (1.52), since the reconstruction beyond this distance is imprecise,
given the typical exposure time, brightness and number of PSF stars of our observations.

StarFinder cross-correlates the reconstructed PSF with the image to identify the stars in the
ﬁeld. Some of them are spurious detections of speckles, and are removed from the list, based on the
magnitude difference and proximity to other stars. The catalog is then used to ﬁt the reconstructed
PSF by minimizing the least squares error between the data and the model. Objects with poor
ﬁttings, such as galaxies or cosmic rays, are dismissed. The catalog so obtained can be used to
subtract from the image the sources close to the PSF stars, yielding a more accurate PSF and
detections. For our analysis, we repeat this iteration three times before reaching the ﬁnal catalog
of sources.

3 Data to Validate AIROPA

3.1 Instrument Description

The Keck LGS AO System consists of a pair of similar single-conjugate AO instruments mounted
on a Nasmyth platform of both Keck I and II telescopes.33 It employs both an artiﬁcial LGS and
a natural star for measuring the tip-tilt modes only (T/T star). Each system delivers a correction
in the NIR using a single deformable mirror and a tip-tilt mirror to correct the aberrations. The
two systems serve different scientiﬁc instruments. For this paper we concentrate on the system on
Keck II that serves the NIRC2 imager. Its 1024ˆ1024 pixels cover a ﬁeld of view of 10.22with a
scale of 9.942 mas px´1.34 The detector is an Aladdin III InSb with a gain of 4.0 e´ ADU´1 and

4

Fig 2 Composite images of the Adaptive Optics System calibration ﬁber in focus, taken by NIRC2 in different years.
The ﬁber light is only impacted by the optics in the AO system and the NIRC2 instrument.

Fig 3 Zoomed-in views of the left panel of Figure 2 with logarithmic color scale, showing images of the calibration
ﬁber at the four corners. All four PSFs are a result of the AO+NIRC2 optical system, and are clearly elongated in the
direction of the center of the ﬁeld of view.

a dark current of 0.1 e´ px´1 s´1. NIRC2’s read noise is 60.0 e´ when using a Fowler sampling35
of 8 (the setting typically used with NIRC2).

3.2 Phase Maps to Calibrate Instrumental Aberrations

The instrumental aberrations of the AO system and imager are characterized by phase maps mea-
sured using out-of-focus images of a ﬁber source at 81 positions (on a 9ˆ9 grid) in the NIRC2
ﬁeld of view.29, 36, 37 The phase maps were recovered from the ﬁber images by using the Gerchberg-
Saxton algorithm,38 the same method used for the image sharpening of the instrument.

In our tests, we have analyzed the composite images of the in focus calibration ﬁber taken
with NIRC2 in 2017 and 2018 (Figure 2). For the latter, the ﬁber was positioned in a sparse
conﬁguration and not on a grid. The most noticeable pattern of aberrations is the elongation of the
PSF similar to tangential astigmatism, along the direction of the center of the ﬁeld (Figure 3).

5

Fig 4 MTF sampled at different ﬁeld positions across the 102ˆ102 FOV of NIRC2. The color scale is linear, normal-
ized between 0 (blue) and 1 (red). The range of angular frequencies of each MTF is ˘70 arcsec´1. The instrumental
MTF was taken in 2017. The atmospheric MTF is calculated for a turbulence proﬁle with 0.652seeing.

Fig 5 MTF at three ﬁeld positions of the NIRC2 FOV: center, corner, and halfway between the two. The Instrumental
and atmospheric MTF are compared to the diffraction limit of a circular aperture with the diameter of the Keck
telescope.

Instrumental OTFs (Figure 4) are calculated from the 2017 grid of phase maps decomposed
using principal component analysis and then projected on a 33ˆ33 grid by cubic convolution in-
terpolation. The grid is upsampled from the original 9ˆ9 to provide a smoother transition between
reconstructed PSFs. The MTFs shown in Figure 4 represent the ability of the optical system to
reproduce the contrast of two-dimensional spatial frequencies. The highest frequencies are at the
edge of each panel. The wider the MTF, the smaller the PSF associated to it, resulting in NIRC2
exposures with higher resolution. As shown in Figure 5, the NIRC2 MTF is close to the diffraction
limit in most of the FOV, with considerable deviations only in the corners of the ﬁeld.

In Section 5 we use Figure 2 also to test the two AIROPA modes, by ﬁtting the in-focus ﬁber

images with the instrumentation-only PSF.

6

Fig 6 A NIRC2 exposure of the GC taken on 2017-08-22 with the Kp ﬁlter (FWHM = 71 mas, SR = 0.25).

Fig 7 Seeing measured by the DIMM instrument (see Section 4.1) during the night of the GC observation.

3.3 On-sky Images for Testing AIROPA

For the tests with on-sky data, we have used AIROPA on 116 NIRC2 images of the GC taken
with NIRC2,39, 40 each image made of 10 exposures of 2.8 s coadded. All images have been taken
with the Kp ﬁlter (λc “ 2.1245 µm) and an example exposure is shown in Figure 6. This is the
principal band used for astrometry of the GC at Keck because, compared to shorter wavelengths,
the PSF has a higher Strehl ratio (SR), producing a higher signal-to-noise ratio for the stars. We
have chosen to analyze the night between 2017-08-22 and 2017-08-23 HST, because of the low
median seeing of 0.692during the observation of the GC, despite it being at the beginning of the
night, when the seeing is typically stronger (Figure 7). Since a strong atmospheric turbulence has
the effect of smoothing the PSF of a long exposure, the good seeing allows us to evaluate how
well the instrumental aberrations are corrected. The GC dataset was reduced using our standard
NIRC2 pipeline to remove instrumental signatures, such as ﬂat ﬁelding, bad pixel masking,7, 9 and
correction for geometric distortions.34, 41

7

-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")19202122230123456HST0.40.60.81.01.21.4seeing (")2017-8-222017-8-23DIMMGC observationFig 8 Luminosity function of the stars used to simulate the GC. Magnitudes are in the Kp ﬁlter.

3.4 Star Catalog for Simulated Images

In addition to the observed images, we have created a simulated NIRC2 image of the GC by using
the most recent catalog of known stellar sources derived from observations with Keck.40 Of these
stars, 1652 have their proﬁle completely or partially within the ﬁeld of view, with the luminosity
function shown in Figure 8.

4 Simulations to Validate AIROPA

For our initial tests of AIROPA, we have generated NIRC2 images of point sources. The use
of simulated images allows for an accurate measurement of the performance of AIROPA in con-
trolled conditions, where the known input position and luminosity of the sources are compared to
the values extracted by AIROPA. All images have been simulated at λ “ 2.1245 µm, the central
wavelength of the NIRC2 Kp ﬁlter. All reported magnitude measurements are instrumental, not
calibrated to a standard photometric system. The grid of input PSFs has been calculated from
the instrumental phase maps, atmospheric turbulence proﬁle and reference PSF described in Sec-
tions 3.2, 4.1, and 4.2, respectively.

Synthetic images have been produced with the python package MAOSI1 (Make Adaptive Optics
Simulated Images), which uses as inputs a catalog of star positions and intensities, a PSF grid, and
relevant parameters of the imaging system (read noise, background ﬂux, gain, detector size, pixel
scale), together with the exposure time. Saturation of the detector and non-linearity response are
not simulated.

When the simulated image has a spatially variable PSF, the proﬁle of a star at a position in
the ﬁeld of view is computed using a bilinear interpolation of the PSF grid. Then, the sub-pixel
positioning of the PSF onto the detector pixel grid is calculated using a bilinear spline interpolation.
For all simulated images, we have used 200 coadds of 2.8 s exposures.

1github.com/jluastro/maosi

8

101520m050100150200250N4.1 Turbulence

To model the atmospheric PSF, AIROPA uses information on the seeing and the altitude proﬁle
of the turbulence layers C 2
42 taken simultaneously to the science data, or within a few minutes.32
n
These parameters are provided, respectively, by the DIMM43, 44 and MASS45, 46 instruments of the
Mauna Kea Atmospheric Monitor at the Canada-France-Hawaii Telescope. We have also employed
a single DIMM and MASS measurement from the same night to generate synthetic images for
testing, with a seeing of 0.652. The corresponding atmospheric OTF grid simulated by AIROPA is
shown in the right panel of Figure 4. These MTFs are considerably smaller than the instrumental
ones in the left panel–as can be seen in Figure 5–indicating that the atmosphere is the limiting
factor to the spatial resolution of our observations.

4.2 Reference PSF

To generate a synthetic PSF and simulate a NIRC2 frame, we need to provide AIROPA with a
reasonable model of the PSF containing the aberrations common to all stars in the ﬁeld of view
(see Section 2). We have extracted one from a stack of 72 LGS NIRC2 images of a bright star
in a binary system with 202of separation. The companion star was used as the NGS, with its
magnitude and distance from the science ﬁeld comparable to the star USNO-A2.0 0600.28577051
(17h45m40s.72, -29˝01112.2) (mR “ 13.8 mag), which is typically employed in GC observations
to measure tip-tilt on the Keck AO System.7

4.3 PSF Fitting

First, the baseline astrometric and photometric performance of AIROPA was determined using
simulations of bright sources in a sparse ﬁeld with a PSF that does not change across the ﬁeld
of view. The same PSF grids used to simulate the images are then employed for the PSF-ﬁtting.
Because of the optimal PSF-ﬁtting conditions (high signal-to-noise ratio of „ 1000, no crowd-
ing, uniform PSF, no PSF extraction), the residuals in position and brightness are interpreted as
systematic errors from the underlying StarFinder code and the approximations that it uses.

The center of the instrumental PSF grid is used as the uniform PSF. We have produced an image
with an irregular 7ˆ7 grid of point sources (Figure 9). The x and y coordinates of the stars have
been substantially deviated from a perfect grid by adding a random value with uniform distribution
of ˘0.52. It was done to avoid a regular pattern of stars that could be mistaken for a feature of the
PSF. If most stars have the halo of other stars in the same relative position, the algorithm extracting
the PSF will mistake this additional light as part of the model.

The image was then analyzed using the single-PSF mode of AIROPA, using all 49 sources
as PSF stars. The astrometric residuals are deﬁned as the difference between the input and output
positions in two directions: ∆x, ∆y. The average astrometric residuals, when injecting with a
∆x2 ` ∆y2 is 6.2¨10´3 mas. Differences
single PSF and recovering with a single PSF, are ∆r “
between the input and output positions are shown in Figure 10. The extracted photometry too is
extremely consistent with the input values, with the average of the absolute photometric residuals
|∆mKp| at 2 ¨ 10´4 mag. ∆r and ∆mKp have very small values because we have removed almost
completely random noises and systematic errors from the measurements, leaving only the pixel
sampling error. They represent therefore the best astrometric and photometric precision possible
in ideal conditions with AIROPA.

?

9

Fig 9 Simulation of a NIRC2 image of bright sources with uniform and instrumentation-only PSF.

Fig 10 Astrometric residuals of simulated bright sources created with a uniform PSF and extracted with AIROPA in
single-PSF mode. The input PSF is from an observed on-axis ﬁber source image.

10

-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")4.4 PSF Spatial Variability

Accurate PSF-ﬁtting of images with an AO-corrected extended ﬁeld of views requires the correct
mapping of the spatial variations of the PSF. To characterize the ability of AIROPA to reconstruct
and ﬁt variable PSFs, we have generated two images similarly to the one in Figure 9, except
for the use of a variable PSF. In the PSF-reconstruction algorithm of AIROPA, the instrumental
and atmospheric OTF ratio grids are calculated independently and then are combined. The ﬁrst
of the synthetic frames is built from the instrumental OTF only, while the other simulates also
atmospheric aberrations. The atmospheric parameters used were derived from the data described
in Section 4.1. The LGS is simulated at the center of the frame and the T/T star is on the pixel
position (-391, 2463). The zenith angle is 45˝. This conﬁguration reproduces typical NIRC2
observations of the GC, with the star USNO-A2.0 0600.28577051 for tip-tilt sensing.

When using AIROPA in variable-PSF mode with the instrumentation-only image, the
average astrometric and photometric residuals are 1.9 ¨ 10´1 mas and 5.5 ¨ 10´3 mag, respectively.
When the atmospheric OTF is also included, the two values are ∆r “ 1.9¨10´1 mas and |∆mKp| “
6.1 ¨ 10´3 mag. The residuals are comparable between the two tests (left and central columns of
Figure 11), but are signiﬁcantly larger than with the a constant-PSF image in Section 4.3.

To understand the deterioration of the results when dealing with a variable PSF, we have to
consider how the PSF model is used differently for simulating the image and ﬁtting it. While
MAOSI smooths the PSF between positions of the grid to reproduce its gradual variation as in real
instruments (see Section 4), StarFinder and several other PSF-ﬁtting software programs use the
nearest neighbor approach. The discrepancy between the PSF used to generate a star and to ﬁt it,
causes a loss in accuracy of more than an order of magnitude in both astrometry and photometry.
This effect can be better appreciated by looking at the increment in residuals as a function of the
distance between a star and the center of the grid cell of its PSF (Figure 12). While a ﬁner grid
would reduce these errors, the maximum practical grid resolution is determined by the density of
the instrumental phase map (Section 3.2).

We then run AIROPA in single-PSF mode on the variable-PSF simulated images to
replicate the current on-sky analysis. This allows us to evaluate how large of an error is produced
by ignoring the PSF spatial variability. The results can be seen in the right column of plots in
Figure 11. The astrometric and photometric residuals increase to 1.2 mas and 3.9 ¨ 10´2 mag,
respectively. The quiver plot for the single-PSF mode in Figure 11 shows a dominant radial
pattern for the astrometric residuals. The correlation between the single-PSF residuals and the
distance of the stars from the center of the ﬁeld of view is more obvious from the left column of
panels in Figure 13). AIROPA’s variable-PSF mode ability of making residuals more uniform
is shown on the right column.

4.5 GC Simulations

A more faithful simulation of the systematic errors that AIROPA could face with on-sky images
requires sources with a realistic luminosity function and density. We have chosen to use the GC
as a representative target for observations with NIRC2 because of its crowding and the wide range
of magnitudes. The purpose of this test is to assess the combined accuracy of PSF reconstruction
and PSF ﬁtting algorithms in AIROPA. The simulation of the central 102of the Galactic SMBH
(Figure 14) uses the same conditions (zenith angle, DIMM and MASS proﬁle data, LGS and T/T
star positions) of the tests in Section 4.4.

11

Fig 11 Astrometric (ﬁrst and second row) and photometric (third row) residuals in Kp of simulated bright sources
with non-uniform PSF. The use of a spatially variable PSF (ﬁrst and second column) produces better residuals than a
uniform one (right column).

12

Fig 12 Residuals of simulated bright sources with non-uniform, instrumental and atmospheric PSF, after using
variable-PSF mode, as a function of their distance from the center of the corresponding PSF grid cell. Mag-
nitude errors are in the Kp ﬁlter.

Fig 13 Astrometric (top row) and photometric (bottom row) residuals in Kp of a grid of stars with instrumental and
atmospheric variable PSF, as function of distance from the center of the image.

13

Fig 14 Simulated and residual images of the GC. The same color scale is used for the single-PSF and
variable-PSF subtracted images.

Fig 15 Simulated and residual images of several stars in the GC. The single-PSF and variable-PSF subtracted
images have the same color scale. The green dots show the location where stars were planted.

As in the previous Section, the variable-PSF mode provides a clear improvement on the
astrometry and photometry over the single-PSF mode. The image after subtracting the stars
with a variable PSF (right panel of Figure 14) has much cleaner residuals than the one using a
constant PSF (central panel of Figure 14), both in the core and in the halo of the PSF, as can be
observed in the close-ups in Figure 15.

14

Fig 16 Astrometric (ﬁrst row) and photometric (second row) residuals in Kp with AIROPA on a simulated GC image,
as a function of magnitude.

To quantify the performance of the two modes, we have considered the average residuals of
only the brightest stars that have instrumental magnitude mKp ď 14. Up to this magnitude, PSF-
ﬁtting residuals are mostly affected by systematic errors in the model of the PSF rather than by
noise (Figure 16).

For bright stars, astrometric residuals are greatly reduced from 8.3 ¨ 10´1 mas to 1.7 ¨ 10´1
mas, and the same is true for photometric residuals, lowered from 3.7 ¨ 10´2 mag to 0.6 ¨ 10´2 mag
(Figure 17). The values for the variable-PSF mode are in line with those in the test with the
sparse ﬁeld (Section 4.4), indicating that a level of crowding like the one in the GC is efﬁciently
managed by the PSF-ﬁtting algorithm.

A test image crowded with stars with a wide range of magnitudes is useful also to investigate
the ability of AIROPA to ﬁnd all and only the stars inserted in the simulation. Fewer input stars
should be missed (false negatives) and fewer fake stars should be detected (false positives) with the
variable-PSF mode if it is as accurate as expected. The single-PSF and variable-PSF
modes in AIROPA miss a similar number of sources, 251 versus 222 respectively (Figure 18), with
a slight improvement when using the reconstructed PSF. The detection threshold in Starﬁnder is
the minimum correlation between the image of a star and the PSF ﬁtted to it.31 For both modes in
AIROPA, we have used a threshold of 0.8.

15

Fig 17 Astrometric (ﬁrst and second row) and photometric (third row) residuals in Kp with AIROPA on a simulated
GC image. The quiver plots show only bright stars (mKp ď 14).

16

Fig 18 Kp luminosity function of the stars planted, but not detected by PSF-ﬁtting in the simulated image of the GC.

Fig 19 Kp luminosity function of the stars detected, but not planted, in the GC simulation.

A random peak in the noise or a speckle of a bright source can be interpreted incorrectly as
a real star by the PSF-ﬁtting software. Using variable-PSF greatly reduces the number of
erroneous detection, from 197 to 13 (Figure 19). This improvement is caused by the ability of
the reconstructed PSF to reproduce better the images of stars, resulting in less features of their
proﬁles left unﬁtted and misinterpreted as separate sources. The small number of wrong detections
in the variable-PSF case are mostly noise spikes of the background, unaffected by the choice
of PSF-reconstruction algorithm.

A useful metric to measure the residuals of the PSF-ﬁtting is the fraction of variance unex-
plained (FVU),29, 47 deﬁned as the ratio between the variance of the residuals and the variance of
the image itself:

F V U “

res

σ2
σ2

img

(4)

The ﬁtting errors of bright stars are impacted minimally by noise, and are mostly caused by sys-
tematic errors of the PSF. Therefore, the FVU of bright stars is a better indicator of the ability

17

Fig 20 FVU of the stars in the GC simulation. Magnitudes are in the Kp ﬁlter.

Fig 21 FVU of the stars in the GC simulation, as a function of astrometric and photometric errors. Data points are
coloured by instrumental magnitudes in the Kp ﬁlter.

to reconstruct the PSF than in faint stars. Smaller FVU values indicate a better ﬁt. Using the
single-PSF mode on the GC simulation, we measure a median FVU of 5.7 ¨ 10´4. By ﬁtting
the same stars with the reconstructed PSF, the median value decreases by an order of magnitude,
6.2 ¨ 10´5.

The relation between FVU and astrometric or photometric errors is complex, depending on
multiple factors such as the speciﬁc shape of the PSF, or the crowding level. Nevertheless, for
NIRC2 observations of the GC, we can estimate it from Figure 21. A clear positive correlation can
be observed in both panels, with the brightest stars having the smallest errors and FVU.

5 Calibration Fiber

In transitioning from simulations to on-sky observations, we can ﬁrst assess the ability of AIROPA
to reconstruct the instrumental component of the PSF for the internal source described in Sec-
tion 3.2. Here we present a summary of the analysis of the in-focus images of the calibration ﬁber,

18

Fig 22 Observed and residual images of several stars in the GC, from a NIRC2 exposure. The single-PSF and
variable-PSF subtracted images have the same color scale. The green dots show the location where stars were
detected.

with the details reported in 29. Since the positioning of the mechanical arm holding the ﬁber and
the light intensity are not very stable or repeatable, we do not know the intrinsic astrometry or pho-
tometry of the sources with a precision better than the measurements that we found in the previous
sections. We have instead relied on the study of the residuals , with the lower residuals indicating
a more successful PSF-ﬁtting.

The variable-PSF mode reduces the median FVU of the ﬁber images from 5.8 ¨ 10´3
to 2.4 ¨ 10´3, indicating a more accurate PSF than the single-PSF. The number of speckles
mistaken for real sources are also reduces by two thirds.

The instrumental phase maps measured in 2017 have also been tested with images of the ﬁber
taken in 2018. The use of the variable PSF yields the same improvement respect to the constant one
as for the 2017 images, indicating a substantial stability with time of the instrumental aberrations.

6 On Sky

Analyzing the residual images of bright stars (Figure 22), we notice that the variable-PSF is
not performing distinctly better than with a homogeneous PSF. A marginal reduction in the residual
intensity can be observed, but not as clear as in simulations (Figure 15).

19

Fig 23 FVU of the on-sky observations of the GC as a function of Kp instrumental magnitude. The FVU of a star is
its average on all exposures.

As with the calibration ﬁber images, we use the FVU to measure the the ability of AIROPA to
reconstruct the PSF on GC images taken with NIRC2. The average FVU was calculated for the
stars that are identiﬁed in at least ﬁve of the 116 exposures of the GC ﬁeld (Section 3.3). The av-
erage FVU of stars brighter than mKp “ 14 mag does not improve by using the variable-PSF
mode, changing to 3.6 ¨ 10´3 from 3.3 ¨ 10´3 of the single-PSF mode (Figure 23).

We can also measure the accuracy of the astrometry and photometry against the temporal vari-
ation of the PSF between images. The smaller the standard deviation of the stars’ positions and
magnitudes, the better the ability of the reconstructed PSF to follow the change in PSF. Average
astrometric residuals of stars mKp ď 14 have similar values between the single-PSF mode
(σr “ 1.29 mas) to the variable-PSF mode (σr “ 1.31 mas) (top row of Figure 24). A
small improvement of 10% is achieved with the average photometric residuals of bright stars, from
σmKp “ 3.4 ¨ 10´2 mag to σmKp “ 3.1 ¨ 10´2 mag (bottom row of Figure 24).

7 Discussion and Summary

We have tested the performance of AIROPA ﬁrst with simulated NIRC2 images. We have de-
termined the baseline astrometric and photometric capabilities of the underlying ﬁtting algorithm
by analyzing a sparse ﬁelds of bright sources, to reduce the uncertainty caused by the shot noise,
generated using a constant PSF.

To understand the effects of a PSF changing with direction, we have simulated another ﬁeld of
bright sources, but using a variable PSF with characteristics typical of NIRC2 observations of the
GC. Instrumental aberrations dominate over atmospheric angular anisoplanatism as cause in the
spatial variation of the OTF and PSF (Figure 4). By using a sparse ﬁeld, the systematic errors of
PSF-ﬁtting are caused only by the spatial variability and not by crowding. We have demonstrated
that the variable-PSF mode of AIROPA can reduce astrometric and photometric residuals on
average by 80%, respectively from 1.2 to 1.9 ¨ 10´1 mas, and from 3.9 ¨ 10´2 mag to 6.1 ¨ 10´3 mag.
We have then replicated the effect of crowding on the measurements by simulating an im-
age of the sources included in our catalog of the GC. We ﬁnd that for also for this case the

20

Fig 24 Astrometric (ﬁrst row) and photometric (second row) standard deviations with AIROPA on-sky GC images, as
a function of Kp magnitude.

variable-PSF mode provides strong gains in astrometry and photometry, with the average
accuracy in position and magnitude changing from 8.3 ¨ 10´1 mas to 1.7 ¨ 10´1 mas and from
3.7 ¨ 10´2 mag to 0.6 ¨ 10´2 mag, respectively. The improvement in the recovery of position and
luminosity is more substantial for the most distant stars from the optical axis of the instrument, as
can be seen by comparing the panels on the left and right of Figure 13.

We have tested the capacity of AIROPA to reconstruct the instrumental part of the PSF by ﬁtting
the proﬁle of the calibration ﬁber source with the predicted model (Section 5). Since we do not
have a precise knowledge of the true position and luminosity of the source, we have used the FVU
as diagnostic metric. We have found that the variable-PSF of AIROPA provides a median
FVU of 6.2 ¨ 10´5, still a signiﬁcant advantage over the single-PSF mode (FVU=5.7 ¨ 10´4).
Instrumental aberrations also present a remarkable stability, with the reconstructed PSF providing
the same improvements in PSF ﬁttings data taken after one year.

When we analyze real observations of the GC, we ﬁnd that AIROPA does not improve the
astrometry or photometry, with ﬁtting residuals of bright stars similar between the single-PSF
and variable-PSF modes. The speckle patterns also change with the direction in the ﬁeld
of view. To determine the cause of the difference between the predicted and observed PSF, we
have considered the atmospheric and instrumental modules that constitute the PSF-reconstruction
algorithm in AIROPA.

We believe that the source of the problem is not likely in the atmospheric simulation, since it
does not dominate the reconstruction of the PSF shape and its variability, when compared to the

21

contribution of the instrument (Figure 5). Also, our atmospheric modelling deals principally with
the angular anisoplanatism effect on long exposure, and is not capable to reproduce the speckles
like those observed in the residuals.

We also judge the phase diversity algorithm used for measuring the instrumental OTF to be
sound, because of the positive results when tested with the calibration ﬁber images. One important
contribution to the total instrumental aberrations that is not accounted in our model is the impact
of quasi-static aberrations introduced by the telescope. Since they would be introduced before
the calibration unit, they are not probed by the calibration ﬁber, and therefore are not included in
our instrumental phase maps. The 10 m primary mirror of the Keck telescopes requires a careful
positioning of the segments.48 It is, however, unlikely that an error in the alignment caused by the
telescope elevation is the source of the speckles observed, since the primary mirror is in a pupil,
and they would appear with the same pattern across the ﬁeld of view. It is instead possible that
the sagging of the secondary mirror or aberrations introduced by the telescope’s K-mirror could be
the cause of ﬁeld-dependent aberrations that are not modeled and that dominate over the internal
aberrations of the AO bench and NIRC2 that AIROPA is trying to suppress.

To overcome the shortfall of AIROPA with on-sky observation, our next step will be to measure
static and quasi-static aberrations directly on sky with phase diversity, as in 48. We will use a
bright star with a similar elevation to the GC during our observations. By dithering the telescope,
we would also position it at different detector coordinates, to sample the PSF in different directions
of the ﬁeld of view. By comparing our model of the wavefront with that measured on NIRC2 with
phase diversity, we expect to identify the source of the described inconsistencies. This necessary
step will ultimately allow us to understand the aberrations of the full optical system, to correct the
approach of AIROPA and to reliably use PSF reconstruction on sky.

Acknowledgments

The data presented herein were obtained at the W. M. Keck Observatory, which is operated as a
scientiﬁc partnership among the California Institute of Technology, the University of California
and the National Aeronautics and Space Administration. The Observatory was made possible by
the generous ﬁnancial support of the W. M. Keck Foundation. The authors wish to recognize
and acknowledge the very signiﬁcant cultural role and reverence that the summit of Maunakea
has always had within the indigenous Hawaiian community. We are most fortunate to have the
opportunity to conduct observations from this mountain.

We thank the staff of the Keck Observatory, especially Randy Campbell, Jim Lyke, Carlos
´Alvarez, and Peter Wizinowich, for all their help in obtaining calibration data. We acknowledge
support from the W. M. Keck Foundation, the Heising-Simons Foundation, the Gordon and Betty
Moore Foundation, and the National Science Foundation (AST-1412615, AST-1518273).

Authors would like to thank the anonymous referee for helpful suggestions that improved the

structure and readability of the paper.

References

1 R. Davies and M. Kasper, “Adaptive optics for astronomy,” ARA&A 50, 305 (2012).
2 B. Balick and R. L. Brown, “Intense sub-arcsecond structure in the Galactic Center,” ApJ

194, 265 (1974).

22

3 A. M. Ghez, B. L. Klein, M. Morris, et al., “High proper-motion stars in the vicinity of
Sagittarius A*: evidence for a supermassive black hole at the center of our Galaxy,” ApJ 509,
678 (1998).

4 A. M. Ghez, M. Morris, E. E. Becklin, et al., “The accelerations of stars orbiting the Milky

Way’s central black hole,” ApJ 407, 349 (2000).

5 R. Genzel, F. Eisenhauer, and S. Gillessen, “The Galactic Center massive black hole and

nuclear star cluster,” RvMP 82, 3121 (2010).

6 A. M. Ghez, S. D. Hornstein, J. R. Lu, et al., “The ﬁrst laser guide star adaptive optics
observations of the Galactic Center: Sgr A*’s infrared color and the extended red emission in
its vicinity,” ApJ 635, 1087 (2005).

7 A. M. Ghez, S. Salim, N. N. Weinberg, et al., “Measuring distance and properties of the
Milky Way’s central supermassive black hole with stellar orbits,” ApJ 689, 1044 (2008).
8 A. Boehle, A. M. Ghez, R. Sch¨odel, et al., “An improved distance and mass estimate for Sgr

A* from a multistar orbit analysis,” ApJ 830, 17 (2016).

9 J. R. Lu, A. M. Ghez, S. D. Hornstein, et al., “A disk of young stars at the Galactic Center as

determined by individual stellar orbits,” ApJ 690, 1463 (2009).

10 T. Do, G. D. Martinez, S. Yelda, et al., “Three-dimensional stellar kinematics at the Galactic
Center: measuring the Nuclear Star Cluster spatial density proﬁle, black hole mass, and
distance,” ApJL 779, L6 (2013).

11 A. Hees, T. Do, A. M. Ghez, et al., “Testing general relativity with stellar orbits around the

supermassive black hole in our Galactic Center,” PhRvL 118, 211101 (2017).

12 R. Sch¨odel, “Accurate photometry with adaptive optics in the presence of anisoplanatic ef-
fects with a sparsely sampled PSF. the Galactic Center as an example of a challenging target
for accurate AO photometry,” A&A 509, A58 (2010).

13 S. Trippe, R. Davies, F. Eisenhauer, et al., “High-precision astrometry with MICADO at the

European Extremely Large Telescope,” MNRAS 402, 1126 (2010).

14 J. Ascenso, B. Neichel, M. Silva, et al., “PSF reconstruction for AO photometry and astrom-

etry,” in Proceedings of the Fourth AO4ELT Conference, (2015).

15 T. K. Fritz, N. Kallivayalil, E. R. Carrasco Damele, et al., “Astrometry with MCAO at Gemini

and at ELTs,” in Proceedings of the Fourth AO4ELT Conference, (2015).

16 P. Turri, A. W. McConnachie, P. B. Stetson, et al., “Optimal stellar photometry for multi-

conjugate adaptive optics systems using science-based metrics,” AJ 153, 199 (2017).

17 T. Fusco, J.-M. Conan, L. M. Mugnier, et al., “Characterization of adaptive optics point
spread function for anisoplanatic imaging. Application to stellar ﬁeld deconvolution,” A&AS
142, 149 (2000).

18 M. Lamb, D. R. Andersen, J.-P. V´eran, et al., “Non-common path aberration corrections for
current and future AO systems,” in Adaptive Optics Systems IV, E. Marchetti, L. M. Close,
and J.-P. V´eran, Eds., Proceedings of the SPIE 9148, 914857 (2014).
19 D. L. Fried, “Anisoplanatism in adaptive optics,” JOSA 72, 52 (1982).
20 P. B. Stetson, “DAOPHOT: a computer program for crowded-ﬁeld stellar photometry,” PASP

99, 191 (1987).

21 L. Schreiber, E. Diolaiti, A. Sollima, et al., “Developing a new software package for psf esti-
mation and ﬁtting of adaptive optics images,” in Adaptive Optics Systems III, B. L. Ellerbroek,
E. Marchetti, and J.-P. V´eran, Eds., Proceedings of the SPIE 8447, 84475V (2012).

23

22 J.-P. V´eran, F. J. Rigaut, H. Maitre, et al., “Estimation of the adaptive optics long-exposure

point-spread function using control loop data,” JOSAA 14, 3057 (1997).

23 R. Wagner, O. Beltramo-Martin, C. M. Correia, et al., “Overview of PSF determination tech-
niques for adaptive-optics assisted ELT instruments,” in Proceedings of the Sixth AO4ELT
Conference, (2019).

24 O. A. Martin, C. M. Correia, E. Gendron, et al., “PSF reconstruction validated using on-sky
CANARY data in MOAO mode,” in Adaptive Optics Systems V, E. Marchetti, L. M. Close,
and J.-P. V´eran, Eds., Proceedings of the SPIE 9909, 99091Q (2016).

25 S. Ragland, T. J. Dupuy, L. Jolissaint, et al., “Status of point spread function determination
for Keck adaptive optics,” in Adaptive Optics Systems VI, L. M. Close, L. Schreiber, and
D. Schmidt, Eds., Proceedings of the SPIE 10703, 107031J (2018).

26 L. Gilles, L. Wang, and C. Boyer, “Point spread function reconstruction simulations for laser
guide star multi-conjugate adaptive optics on extremely large telescopes,” in Adaptive Optics
Systems VI, L. M. Close, L. Schreiber, and D. Schmidt, Eds., Proceedings of the SPIE 10703,
1070349 (2018).

27 D. Massari, A. Marasco, O. Beltramo-Martin, et al., “Successful application of PSF-R tech-

niques to the case of the globular cluster NGC 6121 (M 4),” A&A 634, L5 (2020).

28 G. Witzel, J. R. Lu, A. M. Ghez, et al., “The AIROPA software package: milestones for
testing general relativity in the strong gravity regime with AO,” in Adaptive Optics Systems
V, E. Marchetti, L. M. Close, and J.-P. V´eran, Eds., Proceedings of the SPIE 9909, 990910
(2016).

29 A. Ciurlo, P. Turri, G. Witzel, et al., “AIROPA II: modeling instrumental aberrations for

off-axis point spread functions in adaptive optics,” (in prep.).

30 S. K. Terry, J. R. Lu, P. Turri, et al., “AIROPA IV: validation with various science cases,” (in

prep.).

31 E. Diolaiti, O. Bendinelli, D. Bonaccini, et al., “Analysis of isoplanatic high resolution stellar

ﬁelds by the StarFinder code,” A&AS 147, 335 (2000).

32 M. C. Britton, “The anisoplanatic point-spread function in adaptive optics,” PASP 118, 885

(2006).

33 P. L. Wizinowich, D. Le Mignant, A. H. Bouchez, et al., “The W. M. Keck Observatory Laser

Guide Star Adaptive Optics System: overview,” PASP 118, 297 (2006).

34 S. Yelda, J. R. Lu, A. M. Ghez, et al., “Improving Galactic Center astrometry by reducing the

effects of geometric distortion,” ApJ 725, 331 (2010).

35 A. M. Fowler and I. Gatley, “Demonstration of an algorithm for read-noise reduction in in-

frared arrays,” ApJ 353, L33 (1990).

36 A. Ciurlo, T. Do, G. Witzel, et al., “Off-axis PSF reconstruction for integral ﬁeld spectro-
graph: instrumental aberrations and application to Keck/OSIRIS data,” in Adaptive Optics
Systems VI, L. M. Close, L. Schreiber, and D. Schmidt, Eds., Proceedings of the SPIE 10703,
107031O (2018).

37 B. N. Sitarski, G. Witzel, M. P. Fitzgerald, et al., “Modeling instrumental ﬁeld-dependent
aberrations in the NIRC2 instrument on the Keck II telescope,” in Adaptive Optics Systems
IV, E. Marchetti, L. M. Close, and J.-P. V´eran, Eds., Proceedings of the SPIE 9148, 91486T
(2014).

24

38 R. W. Gerchberg and W. O. Saxton, “A practical algorithm for the determination of phase

from image and diffraction plane pictures,” Optik 35, 237 (1972).

39 A. K. Gautam, T. Do, A. M. Ghez, et al., “An adaptive optics survey of stellar variability at

the Galactic Center,” ApJ 871, 103 (2019).

40 S. Jia, J. R. Lu, S. Sakai, et al., “The Galactic Center:

improved relative astrometry for

velocities, accelerations, and orbits near the supermassive black hole,” ApJ 873, 9 (2019).
41 M. Service, J. R. Lu, R. Campbell, et al., “A new distortion solution for NIRC2 on the Keck

II telescope,” PASP 128, 095004 (2016).

42 A. Rocca, F. Roddier, and J. Vernin, “Detection of atmospheric turbulent layers by spa-
tiotemporal and spatioangular correlation measurements of stellar-light scintillation,” JOSA
64, 1000 (1974).

43 H. M. Martin, “Image motion as a measure of seeing quality,” PASP 99, 1360 (1987).
44 M. Sarazin and F. Roddier, “The ESO differential image motion monitor,” A&A 227, 294

(1990).

45 V. Kornilov, A. A. Tokovinin, O. Vozyakova, et al., “MASS: a monitor of the vertical tur-
bulence distribution,” in Adaptive Optical System Technologies II, P. L. Wizinowich and
D. Bonaccini, Eds., Proceedings of the SPIE 4839, 837 (2003).

46 A. Tokovinin, V. Kornilov, N. Shatsky, et al., “Restoration of turbulence proﬁle from scintil-

lation indices,” MNRAS 343, 891 (2003).

47 T. Do, A. Ciurlo, G. Witzel, et al., “Point-spread function reconstruction for integral-ﬁeld
spectrograph data,” in Adaptive Optics Systems VI, L. M. Close, L. Schreiber, and D. Schmidt,
Eds., Proceedings of the SPIE 10703, 107031I (2018).

48 S. Ragland, “A novel technique to measure residual systematic segment piston errors of large
aperture optical telescopes,” in Ground-based and Airborne Telescopes VII, H. K. Marshall
and J. Spyromilio, Eds., Proceedings of the SPIE 10700, 107001D (2018).

Paolo Turri is a Postdoctoral Researcher at University of British Columbia in the Department
of Physics and Astronomy. Turri’s interests are in adaptive optics, PSF reconstruction and AO
science data analysis. Turri is currently involved in the design of the multi-object AO system for
the GIRMOS instrument on Gemini North.

Jessica R. Lu is an Associate Professor at University of California, Berkeley in the Astronomy
Department. Lu’s expertise is in adaptive optics, astrometry, stellar populations and dynamics,
gravitational microlensing, and black holes. Lu is the Project Scientist for adaptive optics projects
including ‘imaka on the University of Hawaii 2.2 m telescope and KAPA at the W. M. Keck
Observatory.

Biographies of the other authors are not available.

25

List of Figures

1

2

3

Diagram of AIROPA in variable-PSF mode. The elements represented by a
parallelogram are star catalogs. Blue items are produced by our modiﬁed version
of StarFinder, green by ARROYO, and red by the NIRC2 image reduction pipeline.
Composite images of the Adaptive Optics System calibration ﬁber in focus, taken
by NIRC2 in different years. The ﬁber light is only impacted by the optics in the
AO system and the NIRC2 instrument.
Zoomed-in views of the left panel of Figure 2 with logarithmic color scale, showing
images of the calibration ﬁber at the four corners. All four PSFs are a result of the
AO+NIRC2 optical system, and are clearly elongated in the direction of the center
of the ﬁeld of view.

4 MTF sampled at different ﬁeld positions across the 102ˆ102 FOV of NIRC2. The
color scale is linear, normalized between 0 (blue) and 1 (red). The range of angular
frequencies of each MTF is ˘70 arcsec´1. The instrumental MTF was taken in
2017. The atmospheric MTF is calculated for a turbulence proﬁle with 0.652seeing.
5 MTF at three ﬁeld positions of the NIRC2 FOV: center, corner, and halfway be-
tween the two. The Instrumental and atmospheric MTF are compared to the diffrac-
tion limit of a circular aperture with the diameter of the Keck telescope.
A NIRC2 exposure of the GC taken on 2017-08-22 with the Kp ﬁlter (FWHM =
71 mas, SR = 0.25).
Seeing measured by the DIMM instrument (see Section 4.1) during the night of the
GC observation.
Luminosity function of the stars used to simulate the GC. Magnitudes are in the
Kp ﬁlter.
Simulation of a NIRC2 image of bright sources with uniform and instrumentation-
only PSF.

8

9

6

7

10 Astrometric residuals of simulated bright sources created with a uniform PSF and
extracted with AIROPA in single-PSF mode. The input PSF is from an ob-
served on-axis ﬁber source image.

11 Astrometric (ﬁrst and second row) and photometric (third row) residuals in Kp of
simulated bright sources with non-uniform PSF. The use of a spatially variable
PSF (ﬁrst and second column) produces better residuals than a uniform one (right
column).

12 Residuals of simulated bright sources with non-uniform, instrumental and atmo-
spheric PSF, after using variable-PSF mode, as a function of their distance
from the center of the corresponding PSF grid cell. Magnitude errors are in the Kp
ﬁlter.

13 Astrometric (top row) and photometric (bottom row) residuals in Kp of a grid of
stars with instrumental and atmospheric variable PSF, as function of distance from
the center of the image.
Simulated and residual images of the GC. The same color scale is used for the
single-PSF and variable-PSF subtracted images.

14

26

15

Simulated and residual images of several stars in the GC. The single-PSF and
variable-PSF subtracted images have the same color scale. The green dots
show the location where stars were planted.

16 Astrometric (ﬁrst row) and photometric (second row) residuals in Kp with AIROPA

on a simulated GC image, as a function of magnitude.

17 Astrometric (ﬁrst and second row) and photometric (third row) residuals in Kp
with AIROPA on a simulated GC image. The quiver plots show only bright stars
(mKp ď 14).

18 Kp luminosity function of the stars planted, but not detected by PSF-ﬁtting in the

simulated image of the GC.

19 Kp luminosity function of the stars detected, but not planted, in the GC simulation.
20
21

FVU of the stars in the GC simulation. Magnitudes are in the Kp ﬁlter.
FVU of the stars in the GC simulation, as a function of astrometric and photometric
errors. Data points are coloured by instrumental magnitudes in the Kp ﬁlter.
22 Observed and residual images of several stars in the GC, from a NIRC2 exposure.
The single-PSF and variable-PSF subtracted images have the same color
scale. The green dots show the location where stars were detected.
FVU of the on-sky observations of the GC as a function of Kp instrumental mag-
nitude. The FVU of a star is its average on all exposures.

23

24 Astrometric (ﬁrst row) and photometric (second row) standard deviations with

AIROPA on-sky GC images, as a function of Kp magnitude.

27

