Draft version April 14, 2022
Typeset using LATEX twocolumn style in AASTeX63

2
2
0
2

r
p
A
2
1

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
0
2
0
6
0
.
4
0
2
2
:
v
i
X
r
a

Localizing Sources of Variability in Crowded TESS Photometry

Michael E. Higgins1 and Keaton J. Bell2, ∗

1Department of Physics, Duke University, Durham, NC-27708, USA
2DIRAC Institute, Department of Astronomy, University of Washington, Seattle, WA-98195, USA

Submitted to AAS Journals

ABSTRACT
The Transiting Exoplanet Survey Satellite (TESS) has an exceptionally large plate scale of 21(cid:48)(cid:48) px−1,
causing most TESS light curves to record the blended light of multiple stars. This creates a danger of
misattributing variability observed by TESS to the wrong source, which would invalidate any analysis.
We develop a method that can localize the origin of variability on the sky to better than one ﬁfth of a
pixel. Given measured frequencies of observed variability (e.g., from periodogram analysis), we show
that the corresponding best-ﬁt sinusoid amplitudes to raw light curves extracted from each pixel are
distributed the same as light from the variable source. The primary assumption of this method is that
other nearby stars are not variable at the same frequencies. Essentially, we are using the high frequency
resolution of TESS to overcome limitations from its low spatial resolution. We have implemented our
method in an open source Python package, TESS localize (github.com/Higgins00/TESS-Localize),
that determines the location of a variable source on the sky given TESS pixel data and a set of
observed frequencies of variability. Our method utilizes the TESS Pixel Response Function models,
and we characterize systematics in the residuals of ﬁtting these models to data. Given the ubiquity of
source blending in TESS light curves, verifying the source of observed variability should be a standard
step in TESS analyses.

Keywords: astronomical object identiﬁcation — CCD photometry — time series analysis — variable

stars

1. INTRODUCTION

The Transiting Exoplanet Survey Satellite (TESS) is
executing a thorough census of photometric variability
over 85% of the sky (Ricker et al. 2015). It collects con-
tinuous images in a series of pointings (sectors), visit-
ing each of these overlapping ﬁelds for approximately 27
days. During its ﬁrst two years of operations, TESS ob-
tained full-frame images (FFIs) every 30 min, as well as
2-min cadence subframe images around ≈ 20,000 bright
stars and other targets of speciﬁc interest per sector
(Fausnaugh et al. 2021). The current extended mission
has increased the FFI rate to 10 min, added a 20-sec ca-
dence, and increased the number of short-cadence tar-
gets in each sector. The records of stellar variability

Corresponding author: Michael Higgins
michael.higgins@duke.edu

∗ NSF Astronomy and Astrophysics Postdoctoral Fellow

obtained during these extensive photometric campaigns
achieve frequency resolutions of ≈ 0.43 µHz or ﬁner, and
they are not confused by aliasing from temporal gaps in
the data that aﬀect ground-based surveys.

What TESS achieves in frequency resolution, it lacks
in spatial resolution. TESS has an exceptionally large
plate scale of 21(cid:48)(cid:48) px−1. As a result, multiple stars of-
ten contribute light to the same detector pixels, and
it can be diﬃcult to identify which star is the source of
recorded variability. The source blending problem varies
with direction, with upwards of dozens of stars brighter
than magnitude 18 contributing light to most pixels near
the galactic plane. When analysing TESS light curves,
there is considerable risk of attributing detected vari-
ability to the wrong source, leading to erroneous con-
clusions.

Even with 4(cid:48)(cid:48) pixels, blending was a concern for analy-
ses of data from the Kepler spacecraft. Kepler (Borucki
et al. 2010) can be considered a predecessor of TESS that

 
 
 
 
 
 
2

Higgins & Bell

also obtained continuous light curves of stars primarily
to detect exoplanet transits, though in a ﬁeld of view
400 times smaller. Kepler observed over 500,000 stars
from which a list of Kepler objects of interest (KOIs)
that had transit-like signals was compiled. Nearly half
of these KOIs turned out to be false positives caused
by contamination from eclipsing binaries (Bryson et al.
2013). Colman et al. (2017) demonstrated another ex-
ample of blended starlight complicating analyses of Ke-
pler light curves, showing that anomalous peaks in the
periodograms of red giant stars could indicate a compan-
ion orbiting within the convective giant envelope, while
in many cases such signals likely originate from chance
alignments with other variable sources in the ﬁeld.

Since Kepler and TESS are motivated by the search
for transiting exoplanets, many tools have been devel-
oped to vet candidate transit signals. Shallow planet
transits can be mimicked by contaminating light from
eclipsing binary systems. Giacalone et al. (2020) re-
view the history of software tools for vetting candidate
transits that test the data against transit and blended-
binary models, and introduce the Triceratops package
that utilizes the Gaia DR2 star catalog to model the pos-
sible contamination from many stars that is especially
relevant for TESS. The software tool LATTE provides an
interactive interface for investigating potential contam-
inant or systematic origins of candidate transit signals
in TESS (Eisner et al. 2020). One such diagnostic is to
test whether the centroid of light from a target source
moves during transits or eclipses, which could indicate
that the transited star is spatially oﬀset from the target
(Bryson et al. 2013; Hedges 2021).

Time series photometry from TESS is invaluable for
studying many types of brightness variability of astro-
nomical objects. Some methods have been developed
to address the challenges of source blending in gen-
eral. Oelkers & Stassun (2018) presented a data re-
duction pipeline to remove blended light from photom-
etry through a method called diﬀerence imaging anal-
ysis (DIA) where a high signal-to-noise image stack is
subtracted from a reference frame to remove any non-
variable signal in the photometry. The DIA method is
useful when looking for transient events. The method
used in Colman et al. (2017) to identify whether sig-
nals originate from their target stars or nearby contam-
inating sources was to compute a periodogram for light
curves extracted from each pixel in a Kepler “postage
stamp” and identify where the corresponding peaks ap-
pear to be centered in the pixels. This process was done
by visual inspection to get a general idea of the loca-
tion of the source of the anomalous peaks in the pe-
riodograms and spatially resolve them. Hedges et al.

(2021) developed a method that can extract individ-
ual, deblended light curves for sources that are sepa-
rated by at least one pixel and diﬀer in brightness by
more than a magnitude. In many cases, potential source
confusion can be resolved by comparing to additional
archival or follow-up time series photometry that is spa-
tially resolved for the various sources in the ﬁeld (e.g.,
Collins et al. 2018). To aid in disentangling variability
of blended sources in northern TESS Cycle 2 ﬁelds, the
Zwicky Transient Facility conducted a nightly, contem-
poraneous photometric survey at high angular resolution
that can be compared to TESS data to match variability
in many cases (van Roestel et al. 2019).

This paper presents a new method to solve the per-
sisting problem of spatially resolving signal sources in
low-resolution time series survey photometry. Our strat-
egy for localizing where variability is originating from in
the pixel data is to ﬁt the spatial distribution of sig-
nal amplitudes for frequencies of interest. We recom-
mend verifying the source of variability for all analyses
of TESS data where signiﬁcant frequencies of variation
can be measured. We are releasing a Python pack-
age, TESS localize at github.com/Higgins00/TESS-
Localize, that can ﬁt the sky location of observed vari-
ability in the TESS pixel data. We detail the method in
Section 2, validate its performance with simulations in
Section 3, explore some case studies with real TESS data
in Section 4, and provide practical guidance for users in
Section 5.

2. METHODS

In general, TESS pixels record the combined light con-
tributions from many sources. If we detect variability
in an extracted light curve, it is not immediately clear
which source the variability originates from. We have
developed a method for localizing the source of detected
variability in the TESS pixel data based on the fact that
the (unnormalized) amplitude of variation in each pixel
is proportional to the ﬂux contribution from the variable
source. Essentially, we are able to resolve the variable
source in frequency space for each pixel. We develop
the concepts and assumptions behind the method be-
fore detailing its implementation in the Python package
that we are releasing as an open-source research tool.

2.1. Overview

We will consider our source of interest to be some the-
oretical variable star with average total ﬂux F measured
by the detector. This ﬂux is distributed on the detec-

Localizing Blended Variable Stars in TESS

3

tor following the TESS pixel response function (PRF1;
Bryson et al. 2010). The PRF represents the point
spread function convolved with average pointing jitter
during an exposure, as recorded by each pixel. We in-
dicate the fraction of the source ﬂux measured by the
pixel at column i and row j as Pi,j, assuming for now
that pointing is steady during the observations. This
light will be blended with a potentially complicated dis-
tribution of background light from other nearby sources,
and we represent the average fractional ratio of the ﬂux
from the source star to the total ﬂux in each pixel as
Ci,j.2 The average total ﬂux measured from all sources
in each pixel is F ∗ Pi,j/Ci,j.

The primary assumption underlying our method is
that the other nearby stars do not exhibit signiﬁ-
cant variations at frequencies that are unresolved from
those of our source. Here, nearby means contribut-
ing light to the target pixel ﬁles (TPFs) that are read
out around every short-cadence target, or to the sub-
frame cutouts acquired from the full frame images with
TESSCut (Brasseur et al. 2019). For simplicity, we will
refer to both as TPFs in this work. Putting this as-
sumption another way, the only appreciable eﬀect that
other stars have on the periodograms of light curves ex-
tracted from a TPF is on the measurement noise at the
frequencies speciﬁed. This assumption will be satisﬁed
in most cases, owing to the high frequency resolution
achieved by the TESS data of ≈ 0.43 µHz, as well as
the minimal aliasing. For 2-minute cadence data, for
instance, this resolution corresponds to over 10,000 ef-
fectively independent frequency bins below the Nyquist
frequency of 4467 µHz. It is unlikely that the frequencies
of variation of blended background stars will happen to
fall within the same frequency bins as our target source
variability. We provide practical guidance for validating
this assumption in Section 5.

Suppose the target star of interest varies sinusoidally
with frequency ν and relative (fractional) amplitude a.
Since we assume that only the source exhibits signiﬁcant
power at frequency ν, we can ﬁt a model for how the ﬂux
varies at this frequency only in each pixel

Fν(i,j)(t) = F × Pi,j(a sin (2π(νt + φ)) + 1/Ci,j)

= Ai,j sin (2π(νt + φ)) + (cid:104)Fluxi,j(cid:105),

(1)

where φ is a phase term shared across pixels. This is
essentially the Fourier component at frequency ν, plus

1 https://heasarc.gsfc.nasa.gov/docs/tess/observing-technical.

html#point-spread-function

2 Analogous to the CROWDSAP header value that approximates
crowding in the Science Processing Operations Center pipeline
apertures.

an oﬀset for the average ﬂux in the pixel. Since F and
a are constant values, the ﬁtted amplitude Ai,j is pro-
portional to Pi,j, the fraction of light from the variable
source in pixel (i, j). Therefore, if we ﬁt this model for
every pixel in the TPF, we can empirically recover how
the light from the variable source is distributed on the
detector. In practice, the TESS pointing drifts during
a sector by ∼ 0.01 pix, so the average amplitude distri-
bution will be slightly broader than the per-frame PRF.
Fitting a PRF model to this average amplitude distri-
bution yields an estimate of the location of the variable
source on the sky.

This localization procedure can be improved by ﬁtting
a common location for multiple frequencies of variation,
assuming that they all arise from the same target. Gen-
eral non-sinusoidal variations can be represented as a
sum of sine waves (harmonics for periodic variability).

2.2. Implementation

In practice, we anticipate that users will have identi-
ﬁed frequencies of variability from a periodogram analy-
sis of a light curve, and they then wish to verify where on
the detector those variations arise from. Our implemen-
tation of this signal localization method in the Python
package TESS localize requires a user to provide a list
of frequencies, TPF data, and optionally the aperture
used to extract the light curve that the frequencies were
measured from. If an aperture is not provided, the TPF
pipeline aperture will be used by default. There is also
an option that tries to automatically choose an appro-
priate aperture containing the highest Lomb-Scargle pe-
riodogram power at the provided frequencies. The ﬂow
of how the software proceeds based upon user input is
presented in Figure 1.

Intrinsic variability from any individual

source
will arrive with the same phase across the image.
TESS localize performs an initial ﬁt to the light curve
extracted from the aperture, which should provide a
high signal-to-noise measurement of signal phases. The
ﬁrst ﬁt ﬁxes amplitudes based on the Lomb-Scargle peri-
odogram amplitudes evaluated at the provided frequen-
cies, ﬁxes the average ﬂux to the mean measured ﬂux,
and brute-force samples phase in 20 evenly sampled
steps to obtain good starting phase values for further
optimization. Then a second, non-linear least-squares
ﬁt is performed where phases, amplitudes, and mean
ﬂux are all free to vary. These ﬁts are all performed
using the implementation of the Levenberg–Marquardt
algorithm via the Python package lmfit (Newville et al.
2018).

With the signal phases measured, TESS localize
moves on to ﬁt the signal amplitudes from the un-

4

Higgins & Bell

auto pca function computes a periodogram of the ﬁrst
ﬁve (by default) principal components and returns the
number the last periodogram to not show signiﬁcant
power at any of the frequencies in the frequency list
input by the user. TESS localize then performs least-
squares ﬁts of our (multi-)sinusoid model to the light
curve from each pixel with lmfit, with frequencies ﬁxed
to the input values, and phases ﬁxed to the best-ﬁt val-
ues to the aperture light curve from the previous step.
The uncertainty on the ﬁtted amplitudes are expected
to be σa = (cid:112)2/N σF , where σF is the typical light-
curve ﬂux error, and N is the number of points in the
light curve (Montgomery & O’Donoghue 1999). Since
σF ≈
F , pixels with more ﬂux contamination will yield
noisier measurements of the signal amplitudes. This is
accounted for when least-squares ﬁtting sinusoids to the
light curves by weighting by the reciprocal of the ﬂux
uncertainties.

√

With amplitudes measured for each frequency in each
pixel, TESS localize ﬁnally ﬁts the common location
where this variability arises from. We created a Python
package called TESS PRF3 that interpolates the TESS
PRFs created by the TESS Science Processing Opera-
tions Center (Jenkins et al. 2016, SPOC;) available on
the Mikulski Archive for Space Telescopes (MAST) for
a given location on the detector, which we describe in
Appendix B. TESS localize simultaneously ﬁts a PRF
model to the location in the TPF from which all pro-
vided frequencies are most consistent with originating,
scaled to diﬀerent amplitudes for each signal. With
lmfit, the program minimizes the absolute diﬀerence
between the pixel-by-pixel amplitudes from the previ-
ous step and the PRF model, divided by the amplitude
ﬁt uncertainties.

Diﬀerential velocity aberration causes TESS pointing
to drift slightly during a sector, as recorded by the TPF
data columns ‘POS CORR1’ and ‘POS CORR2,’ which
give column and row pixel oﬀsets relative to WCS meta-
data. The typical standard deviation of this pointing
variation is ≈ 0.02 pix, which will broaden the amplitude
heatmap slightly, but not enough to aﬀect our ﬁtting
signiﬁcantly. TESS localize adjusts the best-ﬁt source
location to account for the average pointing oﬀset for
that TPF. This pointing information is not currently
preserved in TPF-like data produced with TESSCut,4 so
results from TESSCut images may have inaccuracies of-
order 0.01 pix.

3 https://github.com/keatonb/TESS PRF
4 A ﬁx for this issue has been requested:

https://github.com/spacetelescope/astrocut/issues/58

Figure 1. Flow chart of the TESS localize method de-
scribed in this work. The ﬁrst grey box and the green dia-
monds are the only parts of the software that require user
input.

normalized light curves extracted from each pixel
in the TPF. Before ﬁtting, TESS localize option-
ally removes an automatically determined number of
trends most common among pixels outside the pro-
vided aperture with principal component analysis using
the RegressionCorrector tools from the lightkurve
package (Lightkurve Collaboration et al. 2018). The

Localizing Blended Variable Stars in TESS

5

The TESS localize program returns the optimized
column and row location within the TPF where the ob-
served variability is most likely located, with intrinsic
uncertainties. The code adopts the FITS WCS stan-
dard that integer pixel locations represent the center of
pixels (Greisen et al. 2006). For each signal in the in-
put frequency list, a “heatmap” of amplitude, signal to
noise, error, or the ﬁt model can be displayed with the
plot function. The program can optionally query the
Gaia Archive for the locations of stars in the ﬁeld, rank-
ing them by the relative probability that their locations
are consistent with the source of variability (Brown et al.
2018). Relative probabilities are calculated by using the
extrinsic error model discussed in Section 4.2.1. The
extrinsic error accounts for systematic errors that arise
when ﬁtting a PRF model to real TESS data. The user
can use these outputs to verify which stars are likely
to be the source of variability they are interested in, so
that misattributions of variability to incorrect sources
may be avoided.

3. SIMULATIONS

To assess the performance of our method under ideal
conditions, we simulated TESS-like pixel data for three
scenarios. These tests provide empirical evidence that
our implementation of this method recovers accurate
variable source positions, and that the intrinsic uncer-
tainties given by the ﬁtting procedure closely match the
residuals. The three situations we simulated are as fol-
lows:

1. An isolated star that is variable with diﬀerent am-

plitudes relative to noise.

2. A star that is at varying distances to the edge of

a TPF.

3. Two blended stars at varying separations from

each other.

For these simulations, we approximate TESS TPF
data by generating sequences of 11x11 pixel images ev-
ery 2 min for a duration of 27 days. Light from each
star is distributed as a Gaussian across the pixels with a
scale factor (standard deviation) of 0.7 pix. These Gaus-
sians are sampled nine times ﬁner than the plate scale in
each dimension and integrated over the pixel locations to
approximate a TESS PRF. In all simulations, the star
that is variable is only variable at one signal that has
a period of 10 days. Our method will perform better
for sources that vary with multiple frequencies, which
boosts the eﬀective signal-to-noise for our ﬁtting proce-
dure. A 5-pixel cross-shaped aperture centered at the
simulated star is used to determine the signal-to-noise.

The noise is simulated by adding normally distributed
independent random values scaled to the square root of
the ﬂux in each pixel of each image.

3.1. Case 1: Star Variability Signal-to-Noise

Figure 2. Predicted standard errors from the ﬁtting proce-
dure (solid lines) and the observed standard deviation of the
ﬁt residuals (points) as a function of signal-to-noise in the
aperture. The signal-to-noise is computed as the signal am-
plitude divided by mean amplitude in the periodogram of the
light curve. We ran 1000 simulations for each signal-to-noise
value tested.

Figure 3. Fraction of the source star ﬁts with a relative
amplitude error less than 20% for the same simulations at
diﬀerent signal-to-noise levels displayed in Figure 2.

We simulated a star 1000 times in the center of the
TPF for multiple signal-to-noise ratios. As a metric
for signal-to-noise, we deﬁne A/(cid:104)A(cid:105) as the amplitude
of our signal divided by the mean amplitude in the pe-
riodogram of the light curve extracted from a 5 pixel
cross-shaped aperture centered about the true location
of the simulated star. For context, simulating 10,000

2.55.07.510.012.515.017.520.0A<A>0.0250.0500.0750.1000.1250.1500.175Standard Error (pixels)predicted x standard errorpredicted y standard errorobserved x standard errorobserved y standard error2.55.07.510.012.515.017.520.0A<A>0.20.40.60.81.0Fraction of 5 detections6

Higgins & Bell

light curves shows that a signal with A/(cid:104)A(cid:105) greater than
4.4 has less than a 0.1% probability of being caused by
pure noise (false alarm probability; see also Baran &
Koen 2021). We applied our source localization method
to all 1000 simulated stars per A/(cid:104)A(cid:105) to obtain the best-
ﬁt location with estimated uncertainties.

As a criterion for a signiﬁcant detection, we keep only
the result that have a fractional error on the amplitude
ﬁt of less than 20%, corresponding to a 5σ signiﬁcance
threshold. The distribution of the locations ﬁt for these
stars is approximately Gaussian. Figure 2 displays the
average standard error reported by our ﬁtting procedure
as a function of A/(cid:104)A(cid:105) as solid lines. The standard de-
viations of the residuals between simulated and ﬁtted
position are plotted as points for each signal-to-noise
level, and they follow the reported uncertainties from
the ﬁts to within a few percent. Figure 3 shows the
fraction of simulations that yielded a 5σ detection for
diﬀerent signal-to-noise ratios. Our method successfully
ﬁts signals detected to a signiﬁcance of A/(cid:104)A(cid:105) > 7.5 ev-
ery time, with intrinsic errors less than 0.1 pix in each
direction.

3.2. Case 2: Star Location

Figure 4. Errors on the position of the ﬁt star as a function
of the distance from the edge of the TPF.

To test whether the precision of our method degrades
when light from the variable star is not entirely con-
tained within the TPF, we simulated a star 1000 times
each at locations with various distances from the edge of
the image in the Y-axis, but centered in the X-axis. We
found that a star with a A/(cid:104)A(cid:105) > 7 could be successfully
ﬁt to the edge of a TPF with ﬁt residuals that agree to
within a tenth of the reported errors. Figure 4 shows the
predicted and observed uncertainties for varying source
distances from the edge of the TPF. Fit locations be-
come less precise as light from the source falls oﬀ the

edge of the TPF, but this is accurately reﬂected in the
reported intrinsic error. The TESS localize code raises
a warning if the ﬁt indicates that most of the ﬂux is
located outside the TPF. You may achieve a more pre-
cise localization using TESSCut (Brasseur et al. 2019)
to retrieve pixel data encompassing more light from the
source.

3.3. Case 3: Two Blended Stars

Figure 5. Predicted and observed X and Y standard errors
as a function of the separation between the source star and
the non-source star.

To determine the eﬀectiveness of our method where
light from multiple sources is blended in the same pixels,
we introduced a second star with constant brightness at
diﬀerent distances in the X direction from our target
star. This second star was set to have the same average
ﬂux as the variable star. The variable star by itself has a
ﬂux of 1000 and a variability of 3% resulting in a A/(cid:104)A(cid:105)
by itself of approximately 16, which is suﬃcient for our
code to obtain a > 5σ detection for all trials. For each
separation from the central variable star, we simulated
1000 data sets.

The plot of the typical reported and observed un-
certainties in the best-ﬁt column and row for diﬀerent
source separations in Figure 5 shows three distinct fea-
tures. First, column and row uncertainties match when
the stars are simulated at the same position or are com-
pletely separated. Second, the error in column posi-
tion initially increases with separation as the combined
starlight is elongated along this dimension, and the addi-
tional contaminant ﬂux increases the ﬁtting uncertainty
on signal amplitudes. Finally, the overall precision im-
proves as separation increases since the A/(cid:104)A(cid:105) in the
target aperture increases as contamination decreases.
Despite these eﬀects, the uncertainties reported by our

012345Distance From the Edge (px)0.0200.0250.0300.035Standard Error (px)predicted standard errorobserved standard error012345Separation0.03250.03500.03750.04000.04250.04500.04750.0500Standard Errorfit Y std. error fit X std. error observed Y std. errorobserved X std. errorLocalizing Blended Variable Stars in TESS

7

ﬁtting procedure closely match the typical residuals for
these simulations.

4. DEMONSTRATIONS WITH TESS DATA

The simulations in the preceding section support that
our methodology can faithfully recover a variable source
location in pixel data in idealized cases (e.g., Gaussian
point spread function, no data systematics), with re-
ported errors matching the intrinsic uncertainty of the
ﬁtting procedure. Here we apply our localization tools
to actual TESS data, staring with a practical analysis
that we contributed to C´orsico et al. (2021). We then
apply our tools to an ensemble of eclipsing binary sys-
tems that enables us to deﬁne a model for extrinsic un-
certainty and pointing systematics that we incorporate
into the TESS localize software.

4.1. Pulsations and Eclipses in the Light Curve of the

GW Vir Star RX J2117.1+3412

C´orsico et al. (2021) carried out an analysis of 2-min
cadence TESS observations of six GW Vir type pulsating
white dwarfs. The light curve of one of these targets,
RX J2117.1+3412 (TIC 117070953, Sector 15), showed
evidence of both eclipses and pulsations. This implied
an exciting interpretation that this hot pulsating white
dwarf in a young planetary nebula could also be part
of an eclipsing binary system. Due to the prevalence of
source blending in TESS data, this hypothesis must be
rigorously tested, and C´orsico et al. (2021) were able to
reject this interpretation with the use of TESS localize.
The Lomb-Scargle periodogram for this light curve in
the region of signiﬁcant variability signals is displayed in
the top panel of Figure 6. In addition to the ﬁfteen pul-
sation signatures in the frequency range 500–1225 µHz,
there appears a sequence of low-frequency harmonics at
multiples of 9.511 µHz, indicative of binary eclipses. Be-
cause the high- and low-frequency signals appear to be
associated with diﬀerent physical processes, we test each
set of signals independently for consistency between the
concentration of power on the sky and the location of the
GW Vir target. The two sets of signals that we ﬁt with
the pre-whitening frequency analysis software Pyriod5
are marked with diﬀerent colors in the top panel of Fig-
ure 6, and the heatmaps for each are displayed in the
middle panels. These heatmaps are a result of sum-
ming the individual amplitude heatmaps for each fre-
quency and dividing by the root sum squared of the
error heatmaps. While the power associated with pulsa-
tions is concentrated in the pixels surrounding the white

dwarf RX J2117.1+3412, the signals from binary eclipses
are signiﬁcantly oﬀset from our target source.

Comparing to Gaia source locations, TESS localize
returns a relative likelihood that the pulsation signals
originate from the white dwarf of 99.9%. The origin of
the eclipse signals is consistent with two Gaia sources,
77.7% with source id 1855294415817908480 and 22.3%
with 1855294415817907840. To conﬁrm this analysis, we
extract light curves from the single “hottest” pixel as-
sociated with each set of signals, normalize and remove
long-term trends with lightkurve, and display these
in the bottom panel of Figure 6. This “hottest” pixel
aperture can be accessed as a TESS localize class vari-
able called maxsignal aperture. The binary eclipses
are far more pronounced in the light curve extracted far-
ther from the white dwarf target where the binary signal
amplitudes appear largest, conﬁrming that the eclipsing
binary is a diﬀerent contaminating source in the ﬁeld.
RX J2117.1+3412 was dismissed as an eclipsing binary
by C´orsico et al. (2021) on the basis of this analysis.

The full code needed to localize the eclipse and pul-
sation signals in the TIC 117070953 TPF is provided in
Appendix A. Besides measuring the frequencies of vari-
ability from a periodogram, which we assume has been
done already, it only takes one line of code to down-
load the TPF data with lightkurve, and one line of
code to localize the source with TESS localize. The
localization step takes roughly one minute on a typical
consumer laptop.

4.2. Eclipsing binary systems

Prˇsa et al. (2022) derived a catalog of 4584 eclipsing
binaries in the ﬁrst two years of short-cadence TESS
data.6 We run our code on the 120-s cadence light
curves for these targets to test its performance. Start-
ing with the orbital periods tabulated by Prˇsa et al.,
we use Pyriod to automatically determine the frequen-
cies of greatest power in the periodograms of the 3470
eclipsing binaries with orbital periods shorter than ﬁve
days. The periodogram of an eclipsing binary light curve
typically consists of many harmonics of the orbital fre-
quency to reproduce the eclipse proﬁles, as seen in the
previous example. We iteratively determine the highest
periodogram value at a multiple of the orbital frequency,
ﬁnd a corresponding best-ﬁt sinusoid to the light curve,
update the orbital frequency estimate, and then look for
the next highest harmonic. The ﬁrst signal is required
to exceed seven times the median value across the pe-
riodogram. We repeat this process on the residuals of
the ﬁt to include up to the 20th harmonic (or up to the

5 github.com/keatonb/Pyriod

6 tessebs.villanova.edu

8

Higgins & Bell

Figure 6. Top: Periodogram of RX J2117.1+3412. Low-frequency signals of an eclipsing binary (orange) and high-frequency
signals from stellar pulsations (blue) ﬁt with Pyriod are marked. Middle: Heatmaps for low- (left) and high-frequency (right)
signals. These two diﬀerent types of signal clearly originate from diﬀerent positions on the sky. These heatmaps are a result of
summing the individual amplitude heatmaps for each frequency and dividing by the root sum squared of the error heatmaps.
The gray points indicate the positions of Gaia DR2 sources brighter than G = 18 mag in the ﬁeld. Bottom: Light curves
extracted from the single hottest pixels in each heatmap (marked with a red border in heatmaps). The binary eclipse signature
is conﬁrmed to be much more pronounced in the light curve extracted away from the white dwarf target (orange), compared to
the light curve extracted at the position of the white dwarf (blue).

020040060080010001200frequency (Hz)0246amplitude (mma)eclipsespulsations17151720172517301735time (BJD-2457000)1.01.11.2rel. flux (+ offset)Localizing Blended Variable Stars in TESS

9

Figure 7. Sub-pixel best-ﬁt locations for 9774 binary stars.
Top and right panels display marginalized histograms. Ex-
cesses at every ninth of a pixel, as well as at the edge of pixels
(0.5) indicate that the procedure of ﬁtting a PRF model to
data prefers these locations.

Figure 8. Residuals between the ﬁt locations and the known
locations of the targeted stars. Top and right panels dis-
play marginalized histograms, and the dashed lines show the
marginalized two-component Gaussian mixture model that
we adopt as an extrinsic error model in Section 4.2.1

Nyquist frequency), or until no additional harmonics ex-
ceed ﬁve times the median periodogram value. Many of
these targets were observed in multiple TESS sectors,
and we end up with a total of 9774 binary frequency so-
lutions through Sector 42 (allowing for a couple hundred
failed downloads), from which we can compare our ﬁtted
source location to the location of the targeted star.

We run TESS localize with these targets and fre-
quency lists, using pipeline apertures and the auto pca
function to estimate the best number of PCA compo-
nents (up to three) that are safe to use without po-
tentially removing the signal of interest. For 67% of
these eclipsing binaries, auto pca preferred to not per-
form any PCA correction, while it ﬁt and removed the
strongest one, two, and three principal components in
15%, 7%, and 11% of cases, respectively.

TESS localize ﬁts a separate height of the PRF
model to the amplitude distribution for each provided
frequency. Similar to source detection in an astronomi-
cal image, we should apply a signiﬁcance test that signal
is present over the background of noise. We require that
the height of at least one component exceed ﬁve times
its uncertainty to be considered a signiﬁcant detection,
discarding results for only 145 light curves. There is
some structure in the resulting best-ﬁt source locations,
suggesting that there are systematics present in results
from actual TESS data that did not appear in our ide-
alized simulations from Section 3. Figure 7 displays

the decimal portions of the source locations returned
by TESS localize. There are excesses every ninth of a
pixel, which correspond to the locations with modelled
PRFs that we interpolate between (see Appendix B).
There is also an excess at 0.5, corresponding to pixel
edges (pixel centers are deﬁned to have integer positions;
Greisen et al. 2006). It appears to be a feature of ﬁt-
ting with the PRF models that least-squares solutions
are more likely to be found at these locations, which is
an extrinsic error that will increase the ﬁtting residuals
beyond what would be expected from the formal ﬁtting
uncertainties.

To assess the eﬀect of extrinsic error on the results,
we further restrict our analysis to the ﬁt results that
have formal intrinsic ﬁtting errors smaller than 0.05 pix
in both dimensions. The median intrinsic uncertainties
are smaller than 0.01 pix in each direction, so this rejects
only the most imprecise 6% of results in the tail of the
ﬁt distribution.

The residuals between the ﬁt locations and the known
locations of the targeted stars are displayed in Figure 8.
The bulk of the results appear to be distributed about
the targeted source locations. In some cases, the eclips-
ing binary is not the targeted source, and we would ex-
pect to ﬁt an oﬀset source location. Any bright star
within a pixel of the target will contribute light to the
aperture, so we expect this background of contaminant
sources to be uniform within a pixel of the target. We

0.00.20.40.60.81.0column % 10.00.20.40.60.81.0row % 11.00.50.00.51.0source col - fit col1.00.50.00.51.0source row - fit row10

Higgins & Bell

Table 1. Extrinsic error model Gaussian mixture compo-
nents (source - ﬁt).

Location
(column, row)

(0.0018, -0.0296)

(-0.0054, -0.0202)

(cid:34)

Covariance
(pix2)
0.00231 −0.00003
0.00194
−0.00003
(cid:35)
(cid:34)

0.0282 −0.0024
0.0515
−0.0024

(cid:35)

Height

0.626

0.259

use the pyGMMis package (Melchior & Goulding 2016) to
ﬁt a two-component Gaussian mixture model (GMM) to
the residuals, plus a uniform background model. The
GMM distributions are indicated in Figure 8, where
they appear to match the marginalized histograms well.
The locations, covariance matrices, and heights for the
two best-ﬁt two-dimensional Gaussians are in Table 1.
The uniform background model represents 11.4% of the
variable source density within one pixel of the targeted
sources. Both Gaussian components are wider than ex-
pected from the formal ﬁtting uncertainties, capturing
the combined intrinsic and extrinsic errors. The best-
ﬁt row locations are also notably greater than the tar-
geted source locations according to WCS header info by
≈ 0.025 pix, indicating a potential systematic error in
the TESS pointing model of ≈ 0.5(cid:48)(cid:48).

4.2.1. Extrinsic Error Model

The GMM ﬁt to the eclipsing binary location residu-
als provides a sensible empirical model for the extrinsic
error on source locations ﬁt by TESS localize. Both
components have scale factors signiﬁcantly larger than
the median intrinsic uncertainties of < 0.01 pix in each
direction, so formal ﬁtting errors cannot account for the
residuals. The small intrinsic errors in the data will
slightly increase the scale of the GMM over what would
be expected from purely extrinsic errors, so using this
model as a proxy for the extrinsic errors is a conserva-
tive choice that errs on the side of overestimating uncer-
tainty.

TESS localize takes a pyGMMis object as an extrin-
sic error model, with the model ﬁt to the eclipsing bi-
nary position residuals as the default. The intrinsic er-
ror from the PRF ﬁt given by the covariance matrix is
added to the covariance matrices of the GMM model, in
eﬀect convolving the extrinsic error model by a Gaussian
representation of the ﬁt uncertainties. When evaluating
the relative likelihood of nearby Gaia sources being the
origin of observed variability, the GMM is evaluated at
each source location, and the total likelihood of the vari-
ability coming from any nearby source is normalized to
one, assuming that the variability originates from one

of the known sources. An upper magnitude limit can
be provided for sources to include in this calculation
(default: G ≤ 18 mag), which is especially useful if the
amplitude of variability rules out faint sources.

5. DISCUSSION AND CONCLUSIONS

We have demonstrated a method that can reliably lo-
calize the sources of observed variability in TESS data.
The amplitudes of sinusoidal variability ﬁt to the un-
normalized light curves extracted from each pixel in a
TPF are proportional to the fraction of light from the
variable source captured by each pixel. A PRF model
of how light from a point source is distributed on the
detector can be ﬁt to the pixel-by-pixel amplitudes to
localize the source of variability in the image. This can
be converted to a location on the sky or compared to
known positions of potential sources in the images.

The localization procedure is implemented in an open-
source Python package TESS localize, available at
github.com/Higgins00/TESS-Localize. The code re-
quires two inputs for localization: TPF data passed as a
Lightkurve object, and the frequencies of observed vari-
ability from periodogram analysis. The package returns
a best-ﬁt pixel position, sky coordinates, and relative
probabilities of this position corresponding to known
Gaia sources. The few lines of code needed to local-
ize the sources of variability considered in Section 4.1
are provided in Appendix A.

Most TESS light curves represent the blended light
from multiple sources due to the exceptionally large
plate scale of 21(cid:48)(cid:48) pix−1. This results in a signiﬁcant
risk of misattributing observed variability to the wrong
source. The localization procedure developed here mit-
igates this risk, and we encourage that every analysis of
TESS light curves include tests to conﬁrm the source of
variability. Not all variability in a light curve necessar-
ily originates from one source, so using TESS localize
to test that subsets of signal frequencies appear to orig-
inate from a consistent location is advised. An example
analysis from C´orsico et al. (2021) was detailed in Sec-
tion 4.1, where signals from pulsations and eclipses in
the TPF of TIC 117070953 were shown to come from two
diﬀerent sources. Mullally et al. (2022) demonstrated a
good use of TESS localize when using TESS data to
vet the suitability of proposed spectrophotometric stan-
dard stars for James Webb Space Telescope instrument
calibration.

The main underlying assumption to our method that
must be satisﬁed in order to obtain reliable results is that
only one source in the TPF is variable at the provided
frequencies. It is unlikely for multiple stars in a TPF to
be variable at the same frequency by chance due to the

Localizing Blended Variable Stars in TESS

11

high frequency resolution of 0.43 µHz for a 27-day TESS
sector. This is more likely to be a problem if another
source in the TPF exhibits broadband variability that
spans many frequency bins. If more than one source is
variable at a provided frequency, the ﬁtted amplitudes in
the corresponding heatmap will not be distributed like
the PRF. This issue might be circumvented by omit-
ting the problematic frequency if it is part of a set of
frequencies that must originate from the same target.

Results could also be negatively aﬀected if systematic
trends in the light curves also vary at a provided fre-
quency. TESS localize includes an option to attempt
to remove systematics with principal component anal-
ysis using Lightkurve tools (Lightkurve Collaboration
et al. 2018). It is important to check that the princi-
pal component trends determined from pixels outside
the provided aperture will not remove the variability
of interest, which you can do by inspecting their peri-
odograms.

It is important that the signal you wish to localize is
strong within the provided aperture (pipeline aperture
by default). Signal phases are ﬁxed by TESS localize
to the values that ﬁt best to the light curve extracted
from the aperture, so the quality of results are limited
to the precision of this initial ﬁt. It may be the case that
most power at the given frequencies is located outside
the aperture, and that a better ﬁt could be obtained
by providing a diﬀerent aperture. There is an option to
try to automatically choose a best aperture where the
Lomb-Scargle periodogram values at the input frequen-
cies are highest. A more precise localization may be
obtained by using the results of an initial ﬁt to choose a
new aperture that better captures the signal of interest.
If most of the light from the variable source is located oﬀ
the edge of the TPF, a more suitable set of pixels could
be obtained from the FFI with TESSCut (Brasseur et al.
2019), though only at the long FFI cadence which may
be insensitive to high frequency variability.

If the above assumptions are not satisﬁed, results ob-
tained by TESS localize will be of poor quality. We
recommend inspecting the following to ensure reliable

localization results:
that the amplitude heatmap ap-
pears to be distributed like a PRF, that the detection
is signiﬁcant with a ﬁtted height exceeding ﬁve times
its uncertainty, and that the signals are localized to a
position consistent with an astronomical source. More
guidance for troubleshooting TESS localize results and
up-to-date usage instructions are available on the pack-
age GitHub repository.

ACKNOWLEDGEMENTS

K.J.B. is supported by the National Science Founda-
tion under Award AST-1903828. We thank Jon Jenkins,
Rebekah Hounsell, Roland Vanderspek, Michael Faus-
naugh, Scott Fleming, Susan Mullally, and Andrej Prˇsa
for helpful discussions. This paper includes data col-
lected with the TESS mission, obtained from the MAST
data archive at the Space Telescope Science Institute
(STScI). Funding for the TESS mission is provided by
the NASA Explorer Program. STScI is operated by the
Association of Universities for Research in Astronomy,
Inc., under NASA contract NAS 5–26555. This research
made use of Lightkurve, a Python package for Kepler
and TESS data analysis (Lightkurve Collaboration et al.
2018). This work has made use of data from the Euro-
pean Space Agency (ESA) mission Gaia (https://www.
cosmos.esa.int/gaia), processed by the Gaia Data Pro-
cessing and Analysis Consortium (DPAC, https://www.
Funding
cosmos.esa.int/web/gaia/dpac/consortium).
for the DPAC has been provided by national institu-
tions, in particular the institutions participating in the
Gaia Multilateral Agreement. Resources supporting this
work were provided by the NASA High-End Computing
(HEC) Program through the NASA Advanced Super-
computing (NAS) Division at Ames Research Center for
the production of the SPOC data products.

Software: Astropy (Astropy Collaboration et al.
2013, 2018), Lightkurve (Lightkurve Collaboration et al.
2018), lmﬁt (Newville et al. 2018), Matplotlib (Hunter
2007), pyGMMis (Melchior & Goulding 2016)

REFERENCES

Astropy Collaboration, Robitaille, T. P., Tollerud, E. J.,

Borucki, W. J., Koch, D., Basri, G., et al. 2010, Science,

et al. 2013, A&A, 558, A33,

doi: 10.1051/0004-6361/201322068

Astropy Collaboration, Price-Whelan, A. M., Sip˝ocz, B. M.,

et al. 2018, AJ, 156, 123, doi: 10.3847/1538-3881/aabc4f

327, 977, doi: 10.1126/science.1185402

Brasseur, C. E., Phillip, C., Fleming, S. W., Mullally, S. E.,
& White, R. L. 2019, Astrocut: Tools for creating cutouts
of TESS images. http://ascl.net/1905.007

Brown, A. G. A., Vallenari, A., Prusti, T., et al. 2018,

Baran, A. S., & Koen, C. 2021, AcA, 71, 113,

doi: 10.32023/0001-5237/71.2.3

Astronomy & Astrophysics, 616, A1,
doi: 10.1051/0004-6361/201833051

12

Higgins & Bell

Bryson, S. T., Tenenbaum, P., Jenkins, J. M., et al. 2010,
ApJL, 713, L97, doi: 10.1088/2041-8205/713/2/L97
Bryson, S. T., Jenkins, J. M., Gilliland, R. L., et al. 2013,

PASP, 125, 889, doi: 10.1086/671767

Collins, K. A., Collins, K. I., Pepper, J., et al. 2018, AJ,

156, 234, doi: 10.3847/1538-3881/aae582

Colman, I. L., Huber, D., Bedding, T. R., et al. 2017,
MNRAS, 469, 3802, doi: 10.1093/mnras/stx1056

C´orsico, A. H., Uzundag, M., Kepler, S. O., et al. 2021,
A&A, 645, A117, doi: 10.1051/0004-6361/202039202
Eisner, N. L., Lintott, C. J., & Aigrain, S. 2020, Journal of
Open Source Software, 5, 2101, doi: 10.21105/joss.02101

Fausnaugh, M., Morgan, E., Vanderspek, R., et al. 2021,
PASP, 133, 095002, doi: 10.1088/1538-3873/ac1d3f

Giacalone, S., Dressing, C. D., Jensen, E. L. N., et al. 2020,

The Astronomical Journal, 161, 24,
doi: 10.3847/1538-3881/abc6af

Lightkurve Collaboration, Cardoso, J. V. d. M., Hedges, C.,

et al. 2018, Lightkurve: Kepler and TESS time series

analysis in Python, Astrophysics Source Code Library.

http://ascl.net/1812.013

Melchior, P., & Goulding, A. D. 2016, pyGMMis:

Mixtures-of-Gaussians density estimation method.

http://ascl.net/1611.013

Montgomery, M. H., & O’Donoghue, D. 1999, Delta Scuti

Star Newsletter, 13, 28

Mullally, S. E., Sloan, G. C., Hermes, J. J., et al. 2022,

arXiv e-prints, arXiv:2201.03670.

https://arxiv.org/abs/2201.03670

Newville, M., Otten, R., Nelson, A., et al. 2018,

lmﬁt/lmﬁt-py 0.9.12, 0.9.12, Zenodo,

doi: 10.5281/zenodo.1699739

Greisen, E. W., Calabretta, M. R., Valdes, F. G., & Allen,

Oelkers, R. J., & Stassun, K. G. 2018, AJ, 156, 132,

S. L. 2006, A&A, 446, 747,
doi: 10.1051/0004-6361:20053818

Hedges, C. 2021, Research Notes of the American

Astronomical Society, 5, 262,
doi: 10.3847/2515-5172/ac376a

doi: 10.3847/1538-3881/aad68e

Prˇsa, A., Kochoska, A., Conroy, K. E., et al. 2022, ApJS,

258, 16, doi: 10.3847/1538-4365/ac324a

Ricker, G. R., Winn, J. N., Vanderspek, R., et al. 2015,

Hedges, C., Luger, R., Martinez-Palomera, J., Dotson, J., &

Journal of Astronomical Telescopes, Instruments, and

Barentsen, G. 2021, AJ, 162, 107,
doi: 10.3847/1538-3881/ac0825

Hunter, J. D. 2007, Computing in Science & Engineering, 9,

90, doi: 10.1109/MCSE.2007.55

Jenkins, J. M., Twicken, J. D., McCauliﬀ, S., et al. 2016, in

Society of Photo-Optical Instrumentation Engineers
(SPIE) Conference Series, Vol. 9913, Software and
Cyberinfrastructure for Astronomy IV, ed. G. Chiozzi &
J. C. Guzman, 99133E, doi: 10.1117/12.2233418

Systems, 1, 014003, doi: 10.1117/1.JATIS.1.1.014003

van Roestel, J., Bellm, E. C., Duev, D. A., et al. 2019,

Research Notes of the American Astronomical Society, 3,

136, doi: 10.3847/2515-5172/ab459c

Vorobiev, D., Irwin, A., Ninkov, Z., et al. 2019, Journal of

Astronomical Telescopes, Instruments, and Systems, 5,

041507, doi: 10.1117/1.JATIS.5.4.041507

Localizing Blended Variable Stars in TESS

13

APPENDIX

A. TESS localize CODE EXAMPLE

The Python code below reproduces the localizations of the sources of both pulsational and eclipsing binary variability

observed in the TPF for target TIC 117070953 that was presented in Section 4.1.

1 import TESS_Localize as tl
2 import lightkurve as lk
3 import astropy . units as u
4
5 # Binary frequencies
6 l ow _ fr e q u e n c y_ li s t = [9.51112996 , 19.02225993 , 28.53338989 , 38.04451986 ,
7

47.55564982 , 57.06677979 , 66.57790975 , 76.08903972]

8
9 # Pulsation frequencies
10 h i g h _ f r e q u e n c y _l i s t = [500.559 , 506.057 , 642.255 , 740.266 , 884.017 ,
889.556 , 957.817 , 963.28 , 969.013 , 1028.729 ,
11
1034.356 , 1107.713 , 1212.297 , 1217.872 , 1223.429]

12

13
14 # Download TPF data for this target with lightkurve
15 tpf = lk . s e a r c h _ t a r g e t p i x e l f i l e ( ’ TIC117070953 ’ , sector =15 , cadence =120) . download ()
16
17 # Localize the low frequencies ( binary eclipses )
18 low = tl . Localize ( targetpixelfile = tpf , frequencies = low_frequency_list , frequnit = u . uHz ,
19

p r i n c i p a l _ c o m p o n e n t s = ’ auto ’)

20
21 # Localize the high frequencies ( stellar pulsations )
22 high = tl . Localize ( targetpixelfile = tpf , frequencies = high_frequency_list , frequnit = u . uHz ,
23

p r i n c i p a l _ c o m p o n e n t s = ’ auto ’)

B. SAMPLING THE TESS PIXEL RESPONSE FUNCTION WITH TESS PRF

The TESS PRF model ﬁles

As an ancillary product of this work, we developed a Python package for interpolating the TESS Pixel Response
Function (PRF) models called TESS PRF, available at github.com/keatonb/TESS PRF. The PRF describes how light
from a point source will be distributed across pixels at diﬀerent positions on the detector. It accounts for the optical
point spread function, pointing jitter during an exposure, and intra-pixel sensitivity (Vorobiev et al. 2019). The PRF
models are an important TESS data product with many potential uses, such as simulating realistic TESS data or
performing PRF photometry. In this work, we used the PRF models to ﬁt to pixel-by-pixel amplitude distributions
to achieve our source localization results.
are

on MAST at heasarc.gsfc.nasa.gov/docs/tess/observing-
technical.html#point-spread-function. They were created by the TESS Science Processing Operations Center (Jenkins
et al. 2016) following the methods developed for the Kepler spacecraft described in Bryson et al. (2010). Diﬀerent
sets of models are applicable to TESS Sectors 1-3 and Sectors 4 and later. For each camera and CCD, PRF model
ﬁles are available for a grid of pixels separated by 512 columns or rows. Each of these ﬁles contains 81 PRF models
depending on where the ﬂux source is located within a given pixel. These are sampled every ninth of a pixel in each
direction, starting from 1/18th of a pixel from the edge, and with the central model corresponding to the center of
the pixel. These models are interleaved so that the PRF values at one of these subpixel locations are given by every
ninth array value. The esoteric format of these PRF ﬁles motivated our creation of the TESS PRF package.

available

TESS PRF was built for local analysis of TESS pixel subregions, such as a TPF, so that the PRF can be assumed
not to change appreciably across the image. As a ﬁrst step, TESS PRF interpolates between the available PRF ﬁles to
a given pixel location, which should be near the center of the TPF you wish to analyze. It will access the relevant
ﬁles from MAST by default, or it can be pointed to a local directory containing these ﬁles for faster or oﬄine analysis.
After this ﬁrst interpolation, a second interpolation is performed to position the model at a given subpixel location
within the TPF with the locate function. See package documentation for detailed usage instructions.

