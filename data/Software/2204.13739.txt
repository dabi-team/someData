2
2
0
2

r
p
A
8
2

]
S
D
.
h
t
a
m

[

1
v
9
3
7
3
1
.
4
0
2
2
:
v
i
X
r
a

Global analysis of regulatory network dynamics: equilibria
and saddle-node bifurcations

Shane Kepley∗, Konstantin Mischaikow†, and Elena Queirolo‡

May 2, 2022

Abstract

In this paper we describe a combined combinatorial/numerical approach to studying
equilibria and bifurcations in network models arising in Systems Biology. Often inter-
actions are only coarsely known in terms of a regulatory or signalling network topology.
Consequently, ODE models of the dynamics suﬀer from high dimensional parameters
which presents a signiﬁcant obstruction to studying the global dynamics via numerical
methods.

Given a network topology describing state variables which regulate one another via
monotone and bounded functions, we ﬁrst use the Dynamic Signatures Generated by Reg-
ulatory Networks (DSGRN) software to obtain a combinatorial description which sum-
marizes the dynamics. This summary is coarse but global and we use this information
as a ﬁrst pass to identify “interesting” subsets of parameters in which to focus. We
construct an associated ODE model with high parameter dimension using our Network
Dynamics Modeling and Analysis (NDMA) Python library. We introduce algorithms for
eﬃciently investigating the dynamics in these ODE models restricted to these parameter
subsets. Finally, we perform a statistical validation of the method and several interest-
ing dynamical applications including ﬁnding saddle-node bifurcations in a 54 parameter
model.

1 Introduction

Consider an explicit system of diﬀerential equations

˙x = f (x, λ),

x ∈ RN , λ ∈ RM .

(1)

A natural goal is to understand the global dynamics over all parameter values. In general
this goal is likely unreachable. A simpler problem is to choose a relevant invariant set, e.g.
an equilibrium or periodic orbit, and identify the set of parameters at which this exists. This
leads to the closely related problem of identifying speciﬁc types of bifurcations, i.e. set of
parameters at which the above mentioned invariant sets change. In special cases, considerable
progress has been made on these simpler problems, such as [19], and more general results
presented in [9].

We refer to the question of existence and stability of equilibria as the equilibrium problem.
If M , the dimension of parameter space, equals 1, then the equilibrium problem is often ap-
proached by identifying an equilibrium at a given parameter value and then using continuation

∗s.kepley@vu.nl
†mischaik@math.rutgers.edu
‡elena.queirolo@tum.de

1

 
 
 
 
 
 
techniques to characterize the equilibrium as a function of λ and to identify bifurcation points,
i.e. isolated points in parameter space where the equilibrium changes stability or disappears.
This same strategy can be carried out when M = 2 though characterizing the equilibria is a
challenge [4, 8] as one needs to identify a 2-dimensional surface of points in RN . Therefore,
typically one settles for identifying the bifurcations. If these are saddle-node bifurcations (as-
sociated with the appearance and disappearance of equilibria), then generically they take the
form of 1-dimensional curves that themselves can be identiﬁed via continuation.

The focus of this paper is in addressing the equilibrium problem, but for large M . Our
analysis is carried out for a speciﬁc family of ODEs though in principle these techniques are
much more broadly applicable. Observe that the immediate challenge is that bifurcations
occur on higher dimensional surfaces. For example, generically saddle-node bifurcations will
be associated with M − 1-dimensional hypersurfaces and deriving an explicit representations
for these hypersurface appears to be impossible. In fact, identifying even a single parameter
on this hypersurface is already highly nontrivial. With this in mind, the goal of this paper is
to describe techniques for ﬁnding such parameters.

The main idea is to consider the problem at two “resolutions”. First, we apply combina-
torial methods which consider the dynamics coarsely. These methods have been implemented
in the DSGRN library and have been previously used to systematically address modest, but
still interesting questions about invariant sets and bifurcations in high dimensional parameter
spaces. We discuss this in greater depth below. The second step is to use the information
gained from this combinatorial analysis to guide a reﬁned analysis of the dynamics using an
ODE with high parameter dimension. Despite the high parameter dimension, we restrict to
parameter subsets identiﬁed as “interesting” using DSGRN and perform these computations
eﬃciently using our NDMA numerical library which incorporates several novel algorithms
introduced in section 4.

Speciﬁcally, in this paper we demonstrate that for a broad family of diﬀerential equations
we can eﬃciently propose paths in parameter space along which we expect to experience a
saddle-node bifurcation and then check the veracity of this expectation. Stated diﬀerently,
even though we do not know the M − 1 dimensional hypersurface along which the saddle-node
bifurcations occur, we can suggest paths that we expect cross this hypersurface and then check
if this is the case. Moreover, we believe that our approach is applicable to broader range of
bifurcations and that it can be applied to a much wider class of nonlinearities.

A unique feature of our approach is the starting point: an explicit description in parameter
space that suggests where the bifurcations of interest occur. To explain how this description
is derived we begin with a brief discussion of software [2, 18, 6, 14], called Dynamic Signatures
Generated by Regulatory Networks (DSGRN). Leaving the details to section 3 for the moment
we note that the input to DSGRN is an annotated directed graph and a list of interaction
functions (see section 2 for formal deﬁnitions). The output of DSGRN is an explicit ﬁnite
decomposition of parameter space with the property that on each region of the decomposition
there is a constant combinatorial representation of dynamics called a Morse graph. This
decomposition is organized via the parameter graph where each node of the parameter graph
represents a single region. An edge between two nodes indicates that the closure of the two
associated regions intersect over a codimension one hypersurface. If the annotated directed
graph has N nodes and E edges, then the associated parameter space is Ξ = (0, ∞)N +3E.

For the sake of demonstration, in much of the discussion of this paper we will focus on a
particularly simple annotated graph that represents the regulatory network commonly referred
to as the Toggle Switch, shown in Figure 1(a). Taking the toggle switch as the input to DSGRN,
the associated parameter space is Ξ = (0, ∞)8. DSGRN decomposes Ξ into nine regions and
the parameter graph for the toggle switch is shown in Figure 1(b).

2

1

4

7

1

2

(a)

(b)

2

5

8

3

6

9

c

a

(c)

b

a

b

(d)

(e)

(f)

Figure 1: (a) Toggle switch. (b) Parameter graph for toggle switch. (c) Morse graph at node
5 of parameter graph. (d) Morse graph at nodes 1, 2, and 4 of parameter graph. Note that
the element a of these Morse graph can be directly identiﬁed with the element a of the Morse
graph at node 5. (e) Morse graph at nodes 6, 8, and 9 of parameter graph. Note that the
element b of these Morse graph can be direcctly identiﬁed with the element b of the Morse
graph at node 5. (f) Morse graph at nodes 3 and 7.

As indicated above a Morse graph is associated to each node in the parameter graph and
the Morse graph provides a characterization of the global dynamics. More precisely a Morse
graph is an acyclic directed graph or equivalently a partially ordered set (M, ≤). The elements
of the Morse graph represent potential recurrent dynamics and the partial order indicates the
direction of the dynamics, i.e., if p, q ∈ M and p < q, then no orbit can limit in backward
time to the recurrent dynamics associated to p and in forward time to the recurrent dynamics
associated to q.

Returning to the toggle switch, Figure 1(c)-(f) indicate the Morse graphs at diﬀerent
nodes of the parameter graph. An appropriate interpretation of this information is that at
the parameter values associated with Node 5 (we denote this as R(5)), the system exhibits
bistability where the elements a and b indicate the existence of distinct attractors and the
element c indicates the existence of an unstable invariant set that acts as a separatrix between
the two attractors. At the remaining parameter nodes, the Morse graph contains a single
element suggesting that at the associated parameter values the dynamics is monostable.

Ignoring for the moment the meaning of the parameters, the third column of Table 1
provides the explicit decomposition of parameter space. There is an edge in the parameter
graph between Node 5 and Node 2 and from Table 1 the reader can check that the shared
boundary between the associated regions R(5) and R(2) is the 7 dimensional surface deﬁned
by

(cid:96)1,2 = γ1θ2,1,

(cid:96)2,1 < γ2θ1,2 < (cid:96)2,1 + δ2,1.

(2)

If the recurrent dynamics captured by the elements a, b, and c of the Morse graph at Node 5
are equilibria, then the change in dynamics between parameters in Node 5 and Node 2 is most
easily associated with the occurrence of a saddle-node bifurcation, i.e., for each parameter
value that lies on the hypersurface deﬁned by (2) there exists a saddle-node bifurcation.

3

Node Phenotype

Attractors

Inequalities

Reduced Inequalities

1

2

3

4

5

6

7

8

9

Monostable

{(1, 0)}

Monostable

{(1, 0)}

γ1θ2,1 < (cid:96)1,2 < (cid:96)1,2 + δ1,2
(cid:96)2,1 < (cid:96)2,1 + δ2,1 < γ2θ1,2

1 < (cid:96)1,2
(cid:96)2,1 + δ2,1 < γ2

γ1θ2,1 < (cid:96)1,2 < (cid:96)1,2 + δ1,2
(cid:96)2,1 < γ2θ1,2 < (cid:96)2,1 + δ2,1

1 < (cid:96)1,2
(cid:96)2,1 < γ2 < (cid:96)2,1 + δ2,1

Monostable

{(1, 1)}

γ1θ2,1 < (cid:96)1,2 < (cid:96)1,2 + δ1,2
γ2θ1,2 < (cid:96)2,1 < (cid:96)2,1 + δ2,1

1 < (cid:96)1,2
γ2 < (cid:96)2,1

Monostable

{(1, 0)}

Bistable

{(0, 1), (1, 0)}

Monostable

{(0, 1)}

Monostable

{(0, 0)}

Monostable

{(0, 1)}

(cid:96)1,2 < γ1θ2,1 < (cid:96)1,2 + δ1,2
(cid:96)2,1 < (cid:96)2,1 + δ2,1 < γ2θ1,2

(cid:96)1,2 < 1 < (cid:96)1,2 + δ1,2
(cid:96)2,1 + δ2,1 < γ2

(cid:96)1,2 < γ1θ2,1 < (cid:96)1,2 + δ1,2
(cid:96)2,1 < γ2θ1,2 < (cid:96)2,1 + δ2,1

(cid:96)1,2 < 1 < (cid:96)1,2 + δ1,2
(cid:96)2,1 < γ2 < (cid:96)2,1 + δ2,1

(cid:96)1,2 < γ1θ2,1 < (cid:96)1,2 + δ1,2
γ2θ1,2 < (cid:96)2,1 < (cid:96)2,1 + δ2,1

(cid:96)1,2 < 1 < (cid:96)1,2 + δ1,2
γ2 < (cid:96)2,1

(cid:96)1,2 < (cid:96)1,2 + δ1,2 < γ1θ2,1
(cid:96)2,1 < (cid:96)2,1 + δ2,1 < γ2θ1,2

(cid:96)1,2 + δ1,2 < 1
(cid:96)2,1 + δ2,1 < γ2

(cid:96)1,2 < (cid:96)1,2 + δ1,2 < γ1θ2,1
(cid:96)2,1 < γ2θ1,2 < (cid:96)2,1 + δ2,1

(cid:96)1,2 + δ1,2 < 1
(cid:96)2,1 < γ2 < (cid:96)2,1 + δ2,1

Monostable

{(0, 1)}

(cid:96)1,2 < (cid:96)1,2 + δ1,2 < γ1θ2,1
γ2θ1,2 < (cid:96)2,1 < (cid:96)2,1 + δ2,1

(cid:96)1,2 + δ1,2 < 1
γ2 < (cid:96)2,1

Table 1: The result of the DSGRN analysis for the Toggle Switch. As indicated in Figure 1(b)
DSGRN partitions the parameter space into 9 parameter regions which give rise to the nodes of
the parameter graph. The Morse graph associated with each node gives rise to the phenotype.
The inequalities column indicates the explicit region in parameter space associate to each
node. For the reduced parameter space deﬁned in Section 5.2, the corresponding parameter
regions are the semi-algebraic subsets of Ξ∗ described by the inequalities in the last column.

4

It is quite reasonable if by this point the reader is troubled by the fact that no particular
dynamical system has been discussed, and yet, an explicit seven dimensional set of saddle-
nodes is being proposed. This leads to two fundamental points.

1. DSGRN has been designed with the goal of characterizing dynamics for a broad class of
dynamical systems as opposed to ﬁnding speciﬁc solutions to any particular system.

2. The hypersurface deﬁned by (2) is meant to provide an educated guess as to where

saddle-node bifurcations occur.

To quantify how useful (2) is requires that we consider a particular family of diﬀerential
equations. For this paper we use Hill models (see section 2 for an explicit formulation). There
are three reasons that we choose to work with these models.

1. They are expressed in terms of rational functions. As a consequence, a numerical library
can be built that computes derivatives of the vector ﬁeld up to any given order, with
respect to both the phase space variables and any of the parameters. Therefore, this
library provides a basis for rigorous validation of the numerically detected dynamics. The
DSGRN parameter space embeds in a very natural way into the Hill model parameter
space.

2. They arise naturally in the context of systems biology.

The Hill model for the toggle switch is given by

˙x1 = −γ1x1 + (cid:96)1,2 + δ1,2

˙x2 = −γ2x2 + (cid:96)2,1 + δ2,1

θd1,2
1,2
1,2 + xd1,2
θd1,2
θd2,1
2,1
2,1 + xd2,1
θd2,1

1

2

(3)

which includes 10 parameters, {γ1, (cid:96)1,2, δ1,2, θ1,2, d1,2, γ2, (cid:96)2,1, δ2,1, θ2,1, d2,1} ⊂ (0, ∞). The
corresponding DSGRN parameters are {γ1, (cid:96)1,2, δ1,2, θ1,2, γ2, (cid:96)2,1, δ2,1, θ2,1} and as ﬁrst pass it
is useful to think of DSGRN as capturing the dynamics of (3) in the singular limit as the
exponents d1,2 and d2,1 go to inﬁnity. In fact, there is a bijection between the equilibria iden-
tiﬁed by DSGRN and the equilibria for a Hill function model for suﬃciently large exponents
[3, Theorem 3.13]. In the case of the Toggle Switch these equilibria agree with the vertices of
the Morse graphs.

While we believe that the ability of DSGRN to identify equilibria is of fundamental im-
portance, it is worth noting that within the synthetic biology community the toggle switch
represents a ﬁrst successful design of a synthetic genetic switch [5]. For this community an
abstract existence result invoking the phrase “suﬃciently large exponents” is not of direct
use as typical biochemical models involve Hill exponents d that are on the order of 5 or less.
This brings us full circle and we ask the following questions. First, can we use the DSGRN
information to provide intuition as to which parameter values will lead to bistability for (3)?
Second, can we use this information to identify at what parameter values saddle-node bifurca-
tions will occur. We note that the Morse graphs for a combinatorial network model typically
encode a richer description of the global dynamical structure than simply the number and
type of combinatorial attractors in each parameter region, such as the phase space region
in which they occur. Analysis of the relative location of these attractors in “phase space”
across multiple parameter regions may suggest subtle, yet global information about how these

5

attractors continue and which types of bifurcations occur. We demonstrate this in a speciﬁc
example in section 6.2.

One of the aims of this paper is to develop a general procedure by which we can begin with
the information from the DSGRN computations on the toggle switch and build up towards
more complicated systems of ODEs. Figure 2 is meant to provide intuition concerning the
approach we take. Consider an eight-dimensional slice of DSGRN parameter space Ξ through
regions R(4), R(5), and R(6). As indicated in Figure 1 DSGRN identiﬁes bistability for R(5)
and monostability for R(4) and R(6). For simplicity we assume d = d1,2 = d2,1. By [3] and as
indicated by the gray regions the equilibria identiﬁed by DSGRN persist for d suﬃciently large.
Finally, for d = 1 equation (3) has a unique equilibrium. As a consequence the bistability
exhibited in R(5) for large d must fail for some value of d > 1. The generic expectation is that
bistability is lost via a saddle-node bifurcation and thus there should be an nine-dimensional
surface in Λ the parameter space for (3) on which this bifurcation occurs. Two simpliﬁed
scenarios for the structure of this surface are shown in Figure 2: the solid curve and the
dashed curve. The solid curve is meant to suggest that if a saddle-node bifurcation occurs
then the Ξ parameters lie in R(5), whereas the dashed curve suggest that the Ξ parameters
may lie in R(4) or R(6).

d = ∞

d = 100

d = 1

bistability

γa
R(4)

γb

γc

R(5)

R(6)

Ξ

monostability

Figure 2: Schematic description of the strategy of this paper. R(4), R(5), and R(6) are
regions of parameter space Ξ identiﬁed by DSGRN for Toggle switch. As indicated in Figure 1
DSGRN identiﬁes bistability for R(5) and monostability for R(4) and R(6). We are interested
in understanding the equilibrium structure for (3). Set d = d1,2 = d2,1. By [3] and as
indicated by the gray regions the equilibria identiﬁed by DSGRN persist for d suﬃciently
large. For d = 1 (3) has a unique equilibrium. There therefore must be an interface between
the monostability region and the bistability region. In this paper, we justify that the main
mechanism to pass from monostability to bistability is through a saddle node bifurcation and
we investigate the “shape” of the boundary between stability regions.

The remainder of this paper is organized as follows. In section 2, the notation and structure
of Hill models is introduced. While the core ideas of this paper are model-independent, and
only rely on smooth approximations of step functions, the implementation is not and a choice
for the class of ODE models is required. Our implementation in the NDMA library is based
on Hill functions due to their compatibility with the combinatorial dynamical models used in
DSGRN. In section 3 we review the basics of the DSGRN software for readers who may not
be familiar with it.

In section 4 we consider the numerical equilibrium and saddle-node bifurcation problems

6

for Hill models. Both are characterized as zero ﬁnding problems. Additionally, we introduce an
algorithm for obtaining a-prior bounds on equilibria and isolating them based on the so called
“radii polynomials”. In section 5.1 we carefully describe the entire combinatorial/numerical
approach for the Toggle Switch example and perform a statistical validation of its eﬀectiveness
in characterizing equilibria and saddle-node bifurcations in this model.

We conclude the paper with three examples which demonstrate eﬀectiveness of our strategy
to bifurcation analysis. These examples include further analysis of the Toggle Switch example
as well as a 54 parameter model of the Epithelial-Mesenchymal Transition (EMT) network
which is of practical importance. In this example, the high parameter dimension makes it
essentially impossible to predict the number of stable equilibria or observe a saddle-node
bifurcation by randomly choosing parameters. Nevertheless, we demonstrate that we can
eﬃciently do both.

2 Hill models

In this section we provide a formal deﬁnition of the Hill models considered in this paper. We
begin by noting that Hill models take the form

˙x = −Γx + H(x),

x ∈ [0, ∞)N

(4)

where Γ is a diagonal matrix with Γii = γi > 0. The rest of this section is dedicated to
deﬁning the nonlinear function H. This requires several preliminary constructions that are
imposed so that there is an obvious correspondence between the computations that DSGRN
is currently capable of performing and the form of the Hill models.

Deﬁnition 1. An activating Hill response is a function H + : [0, ∞) → [0, ∞) given by

H +(x) := (cid:96) + δ

xd
θd + xd

and a repressing Hill response is a function H − : [0, ∞) → [0, ∞) given by

H −(x) := (cid:96) + δ

θd
θd + xd

where the parameters {(cid:96), δ, θ, d} are positive and d ≥ 1.
We refer to the parameter d as the Hill exponent.

In biological applications, Hill models are extensively used for modeling the internal be-
haviour of the cell [5, 17, 21]. They are coupled with the study of network dynamics, as
presented in [18], where a repressing edge is associated with H − and an activating edge with
H −.

Observe that H + is monotonically increasing and satisﬁes

H +(0) = (cid:96)

lim
x→∞

H +(x) = (cid:96) + δ.

Similarly, H − is monotonically decreasing and satisﬁes

H −(0) = (cid:96) + δ

lim
x→∞

H −(x) = (cid:96).

In general H is a function of multiple variables and in what follows we indicate how H can

be constructed from activating and repressing Hill responses.

7

Deﬁnition 2. A polynomial, p ∈ R[z1, . . . , zN ] is called an interaction function if it has the
form

p =

q
(cid:89)

m=1

pm,

where pm =

(cid:88)

zj,

j∈Im

and {I1, . . . , Iq} is a partition of the integers, {1, . . . , N }.

Interaction functions allow us to deﬁne Hill models.

Deﬁnition 3. A Hill model is a system of diﬀerential equations ˙x = f (x), x ∈ [0, ∞)N such
that for each i ∈ {1, . . . , N },

˙xi = fi(x) = −γixi + Hi(x)

where

for some interaction function pi.

Hi(x) = pi

(cid:0)H ∗

i,1(x1), . . . , H ∗

i,N (xN )(cid:1)

(5)

(6)

Though suppressed in the notation presented above Hill models involve a multitude of
parameters. In particular, each variable xi contributes a parameter γi and xj inﬂuencing the
rate of change of xi contributes four parameters (cid:96)i,j, δi,j, θi,j, and di,j. Occasionally, ordering
these parameters is relevant. In this case we express the parameter vector as λ = (γ, (cid:96), δ, θ, d)
where the ordering on the vectors γ, (cid:96), δ, θ, and d is lexicographic with respect the ordering
of the nodes. For ﬁxed parameter λ we will write the Hill model as

˙x = f (x, λ).

3 DSGRN

As indicated in the introduction DSGRN [18] is a software designed to analyze the global
dynamics of gene regulatory networks. There is substantial mathematical theory underpinning
the development of DSGRN [10, 13, 11, 12], however for the purposes of this paper we treat
it as a black box.

The input to the software is an annotated directed graph (G, p), e.g. Figure 1(a), with
N nodes, E edges indicating activation or repression, and a vector of choices of interaction
functions p = (p1, . . . , pN ), where pn is the interaction function applied at node n. To each
such graph DSGRN ascribes a parameter space Ξ := (0, ∞)N +3E with parameters {γ, (cid:96), δ, θ}.
The Hill models described in Section 2 are based on these parameters plus the Hill exponents
d ∈ (0, ∞)E.

Remark 1. To match a Hill model with DSGRN, one interprets the edges of the annotated
graph (G, p) as

H ∗

i,j =






H +
i,j
H −
i,j
0

if j → i
if j (cid:97) i
otherwise.

The output is the DSGRN database that is best understood conceptually as an annotated
graph that we refer to as a parameter graph and denote by PG(G, p). Each node v of PG(G, p)
corresponds to a semi-algebraic set R(v) ⊂ Ξ = (0, ∞)N +3E given in terms of explicit in-
equalities, and the union of closures of all these semi-algebraic sets is Ξ = [0, ∞)N +3E. If two
nodes v and v(cid:48) share an edge in the parameter graph, then their expressions as semi-algebraic

8

sets diﬀers by exactly one inequality, and in particular cl(R(v)) ∩ cl(R(v(cid:48))) is a codimension 1
hypersurface in Ξ = (0, ∞)N +3E.

In addition, the DSGRN database assigns to each node v a partially ordered set (M(v), ≤v),
that is visually expressed via the Hasse diagram and called the Morse graph at parameter node
v. Given a particular choice of parameter values λ = (γ, (cid:96), δ, θ, d) if (γ, (cid:96), δ, θ) ∈ R(s), then
under the assumption that each coordinate of d is suﬃciently large we claim the Morse graph
provides a useful combinatorial representation of the global dynamics of the associated Hill
model ˙x = f (x, λ).

To provide at least some intuition (see [2, 7, 3] for details) into content of this assertion we
provide a minimal amount of information about the internal workings of DSGRN. Returning
to Deﬁnition 1 observe that H + and H − converge to step functions

(cid:40)
(cid:96)
(cid:96) + δ

if ξ < θ
if ξ > θ

and

(cid:40)

(cid:96) + δ
(cid:96)

if ξ < θ
if ξ > θ,

respectively, as d → ∞. Thus, in this singular limit the thresholds θ indicate the locations in
phase space where the dynamics changes. DSGRN exploits this by decomposing phase space
Ξ = (0, ∞)N into a cubical complex deﬁned by the hyperplanes xi = θj,i for any edge i to j in
the regulatory network. DSGRN models the dynamics via a directed graph, called the state
transition graph that identiﬁes how cells are mapped to adjacent cells (a self loop indicates that
the cell is mapped to itself). There is a single state transition graph associated to each node
s in the parameter graph. DSGRN compresses the information in the state transition graph
by identifying the recurrent strongly connected path components, i.e. the strongly connected
path components that contain at least one edge. There is a 1-1 correspondence between the
recurrent strongly connected path components and the elements of M(s). Furthermore, given
p, q ∈ M(s), p ≤s q implies that there exists a path in the state transition graph from the
strongly connect path component associated with q to the strongly connect path component
associated with p.

Observe that if a cell in the state transition graph has a self edge, then that cell must belong
to a recurrent strongly connected path component. Furthermore, at least conceptually, the
existence of a self edge suggests the existence of a ﬁxed point. With this in mind if p ∈ M(s)
arises from a recurrent strongly connected path component that contains exactly one cell from
the cubical complex, then DSGRN labels p as an F P . In particular, if p is a minimal element
of M(s) and labeled as an F P , then the expectation is that p identiﬁes a stable ﬁxed point.

As is indicated in the introduction we are interested in identifying bifurcations to diﬀeren-
tial equations. Since a formal deﬁnition of bifurcation involves a change in the structure of an
invariant set, DSGRN is incapable of directly identifying bifurcations. Nevertheless changes
in the Morse graphs as a function of parameter nodes strongly suggest that the dynamics for
associated diﬀerential equations should also changes. Thus, for the purpose of this paper, we
introduce the following deﬁnition.

Deﬁnition 4. Let (G, p) be an annotated graph with a vector of interaction functions and
let PG(G, p) be the associated parameter graph. A DSGRN saddle-node bifurcation edge is an
edge (v1, v2) in PG(G, p) such that the number of minimal FP in M(v1) and M(v2) diﬀers by
exactly one and the number of nonminimal FP in M(v1) and M(v2) diﬀers by exactly one.

4 Equilibria and Saddle-node Bifurcations

Our strategy for identifying saddle-node bifurcations for (1) involves four steps.

9

Step 1 Choose a parameterized path r : [0, 1] → Λ along which we expect a saddle-node

bifurcation to occur.

Step 2 Subdivide [0, 1] at points 0 = s0 < · · · < si < · · · < sI = 1 and identify equilibria of

(1) at parameter value r(si).

Step 3 If the number of equilibria for f at r(si) and r(si+1) diﬀers, then a reﬁned search

takes place to precisely determine where a bifurcation sould take place.

Step 4 If any candidates are identiﬁed in step 3, we apply the algorithm outlined in this

section to numerically ﬁnd the saddle-node bifurcation with higher precision.

Remark 2. Step 3 requires, in usual circumstances, to apply a continuation algorithm to
the equilibria. Such algorithm then would detect the presence of saddles. In the case of Hill
models, continuation algorithms are not ideal when the Hill coeﬃcient is a free parameter.
Indeed, continuing equilibrium branches with respect to the Hill coeﬃcient is a stiﬀ problem:
far from a saddle node bifurcation, the equilibria move little in phase space, while close to
saddle nodes signiﬁcant changes occur depending on small changes of the Hill coeﬃcient. This
results in unreliable numerical continuation. For this reason, a bisection algorithm has also
been implemented, that results in a cruder approach, but has proven to be not only more
reliable but also faster than its continuation counterpart.

Observe that to eﬀectively carry out this strategy requires that we be able to perform
four tasks. First, we need to be able to make an informed guess concerning the path r. As
indicated in the introduction we choose curves along which the DSGRN parameter ξ ∈ Ξ is
constant, i.e. only the Hill coeﬃcients are allowed to vary. To further simplify things, for all
examples in this work we have chosen to identify all Hill coeﬃcients and consider curves for
which this single shared Hill coeﬃcient ranges between 1 and 100. This choice has been made
in the interest of simplicity, and it is not a constraint of the method nor of the library we are
discussing.

As a result of the experiments of this paper we propose that if the ODE of interest is a
Hill model (4), then ξ should be chosen to belong to a region for which the associated DSGRN
Morse graph indicates multistability. Such region should be adjacent to at least one region
that possesses a diﬀerent number of equilibria. We expect this choice to be driven by the
application at hand, thus it is beyond the scope of this paper to discuss it in further depth.

Second, we need an algebraic problem that deﬁnes a saddle-node bifurcation. For a deﬁni-
tion of a saddle node bifurcation and analytic conditions that guarantee its existence we refer
the reader to [1, Section 8.2] and [1, Theorem 8.12], respectively. Theorem 1 [15] presented
below provides a means by which we can numerically ﬁnd that a saddle node bifurcation
occurs.

Theorem 1. Consider a smooth one parameter family of ODEs,

˙x = g(x, s),

x ∈ RN , s ∈ R.

Deﬁne G : R2N +1 → R2N +1 by

G(x, v, s) :=





g(x, s)
Dxg(x, s)v
vT v − 1





x, v ∈ RN , s ∈ R.

(7)

Let u = (x, v, s) ∈ R2N +1 and suppose ˆu := (ˆx, ˆv, ˆs) is a root of G satisfying

1. DuG(ˆu) is an isomorphism.

10

2. Every nonzero eigenvalue of Dxg(ˆx, ˆs) has nonzero real part.

Then g undergoes a saddle-node bifurcation at (ˆx, ˆs) and ker Dxg(ˆx, ˆs) = span {ˆv}.

Remark 3. It is possible to use this Theorem, in combination with validation techniques, to
prove the existence of a saddle node bifurcation. This lies beyond the scope of this paper,
but the interested reader can refer to [15] for additional details. All computational elements
needed for the validation of a Hill model are included in NDMA.

Third, identiﬁcation of equilibria is a well studied but nontrivial problem. We exploit the
structure of Hill models and provide an algorithm (see Algorithm 2) that identiﬁes regions in
phase space in which the equilibria must occur. This is discussed in Section 4.2.

Fourth, we identify numerical equilibria. From the previous, we can (and do) obtain
diﬀerent numerical representations for the same equilibrium. Furthermore, near the saddle-
node bifurcation distinct equilibria can be nearly the same and we need to be able to insure
that they are distinct. We resolve these issues with Algorithm 3 discussed in Section 4.3. Thus,
the main focus of this Section is the development of Step 2, in particular the identiﬁcation
of all equilibria. While we are not claiming that our algorithm is fail proof, we claim it to
be reliable. This Section will present the details of such search, ﬁrst presenting an overview
of the algorithm, and then going into more detail on the two key steps, comprised of a root
ﬁnding algorithm for Hill models in Section 4.2 and a method to identify numerical equilibria
in Section 4.3.

Throughout this section we suppose λ ∈ Λ is ﬁxed, f : X → T X is a Hill model with

X ⊂ RN , and ˆx ∈ RN is an equilibrium solution i.e. f (ˆx) = 0.

4.1 Overview of equilibrium ﬁnding

Within Step 2, we are asked to numerically ﬁnd all equilibria for a given parameter value.
In this Section, we give an initial overview of our method. We ﬁrst assume implementations
of two black box algorithms. The ﬁrst is a root ﬁnding implementation which we denote by
FindRoot, which takes a function, f : RN → RN , and an initial guess x0 ∈ RN as input
and attempts to identity a root of f near x0. When successful it returns ˆx ∈ RN satisfying
(cid:107)f (ˆx)(cid:107) ≈ 0. For the computations in this work we used a Newton based root ﬁnder but other
options exist of course.

The second algorithm, denoted by Unique, identiﬁes pairs of distinct vectors in RN which

approximate the same root of f . That is, if ˆx1, ˆx2 satisfy

(cid:107)f (x1)(cid:107) ≈ 0 ≈ (cid:107)f (ˆx2)(cid:107)

and

(cid:107)ˆx1 − ˆx2(cid:107) ≈ 0,

then Unique(f, ˆx1, ˆx2) = ˆx1. If Unique does not identify ˆx1 and ˆx2 as zeros of f , then we say
that they are approximately distinct with respect to f .

If ˆx is an array of vectors in RN and f a function from RN to itself, then Unique(f, ˆx)
returns an new array of vectors in RN of size equal or smaller than ˆx, in which each pair of
vectors is approximately distinct.

It is worth noting that Hill functions are trivially bounded, thus for any Hill model, there

exists a rectangular subset of X of the form

N
(cid:89)

R :=

[ai, bi],

[ai, bi] ⊂ (0, ∞) for all 1 ≤ i ≤ N.

(8)

i=1

such that all the zeros of the Hill model are within this rectangle. Furthermore, computing
the bounds of R is trivial. The details are presented in Section 4.2.

11

With both FindRoot, R and Unique in hand, we can present the algorithm for the com-
putation of all (up to numerical error) zeros of the Hill model f . Each interval in the product
(8) is partitioned into k subintervals bounded by k + 1 uniformly spaced nodes. The product
of these nodes forms a grid of points in RN which covers R. Each of the (k + 1)N points in
this grid is taken as an initial condition for Findroot which attempts to return a candidate
equilibrium nearby. The algorithm returns an array containing such candidates which are not
identiﬁed as equivalent by Unique. The pseudocode is described in Algorithm 1.

Algorithm 1 General algorithm

ˆx ← ()
∆i ← bi−ai
ui ← (ai, ai + ∆i, . . . , ai + (k − 1)∆i, bi)
for κ ∈ {1, . . . , k}N do

1: function HillEquilibria(f, R, k)
2:
3:
4:
5:
6:
7:

k

x0 ← (u1,κ1, . . . , uN,κN )
rκ ← FindRoot(f, x0)
if rκ then ˆx.Append(rk)
end if

8:
9:
10:
11:
12: end function

end for
return Unique(f, ˆx)

(cid:46) Initialize equilibrium array

(cid:46) Discretize factors

(cid:46) Returns a candidate when it converges
(cid:46) Append candidate equilibrium

4.2 The bootstrap algorithm

In this section we deﬁne a second algorithm which exploits the structure of Hill models in spe-
ciﬁc cases to localize equilibria more reliably and eﬃciently than the Newton-based algorithm
described above. The main idea is to begin with an initial rectangular subset of (0, ∞)N which
is an enclosure for all equilibria and then iteratively obtain tighter rectangular enclosures by
“bootstrap”.

Deﬁnition 5. We say that a continuous function g : [0, ∞)N → (0, ∞)N has a monotone
factorization if for each i = 1, . . . , N , gi factors as

gi(x) = g+

i (x)g−

i (x)

for all x ∈ [0, ∞)N ,

where g+
and similarly, g−
x1, . . . , xN .

i : [0, ∞)N → (0, ∞)N is bounded and strictly increasing with respect to x1, . . . , xN
i : [0, ∞)N → (0, ∞)N is bounded and strictly decreasing with respect to

Consider a continuous function f : [0, ∞)N → RN of the form f (x) = −Γx + g(x) where
g : [0, ∞)N → (0, ∞)N has a monotone factorization and for all i = 1, . . . , N , fi(x) = −γix +
gi(x) and γi > 0. Deﬁne Φ : R2N → R2N coordinate-wise by the formulas

Φi(α, β) =

1
γi

where α, β ∈ RN .

i (α)g−
g+

i (β)

and ΦN +i(α, β) =

1
γi

i (β)g−
g+

i (α),

i = 1, . . . , N

Theorem 2. Consider f , and Φ as deﬁned above. Assume that lim inf
(cid:107)x(cid:107)→∞

g−
i (x) > 0 for all

i = 1, . . . , N . Then, the following are true.

12

(i) x ∈ [0, ∞)N is a zero of f if and only if (x, x) ∈ [0, ∞)2N is a ﬁxed point of Φ.
(ii) Deﬁne (cid:0)α(0), β(0)(cid:1) ∈ R2N coordinate-wise by

α(0)
i

:=

1
γi

g+
i (0) lim inf
(cid:107)x(cid:107)→∞

g−
i (x)

and β(0)

i

:=

1
γi

lim sup
(cid:107)x(cid:107)→∞

i (x)g−
g+

i (0)

(9)

and iteratively deﬁne (αn+1, βn+1) = Φ(αn, βn) for n ≥ 1. Then, (ˆα, ˆβ) := limn→∞(αn, βn)
exists.

(iii)

If f (ˆx) = 0, then

ˆαi ≤ ˆxi ≤ ˆβi,

for all i = 1, . . . , N.

Proof. We leave it to the reader to check (i). (ii) follows from the boundedness and strict
monotonicity of g+
i . To be more speciﬁc, we prove inductively that for 1 ≤ i ≤ N ,
α(n)
and β(n)
are monotonically increasing and decreasing sequences, respectively. The base
i
case follows from easy estimates

i and g−

i

α(1)

i = Φi

(cid:16)

α(0), β(0)(cid:17)

=

(cid:16)

α(0)(cid:17)

g−
i

g+
i

(cid:16)

β(0)(cid:17)

>

1
γi

1
γi

g+
i (0) lim inf
(cid:107)x(cid:107)→∞

i (x) = α(0)
g−

i

and

β(1)
i = ΦN +i

(cid:16)

α(0), β(0)(cid:17)

=

(cid:16)

β(0)(cid:17)

g−
i

g+
i

(cid:16)

α(0)(cid:17)

<

1
γi

1
γi

lim sup
(cid:107)x(cid:107)→∞

i (x)g−
g+

i (0) = β(0)

i

.

Now assume that α(n)

i < α(n−1)

i

implies that

and β(n)

i > β(n−1)

i

. The strict monotonicity of g+

i and g−

i

α(n+1)
i

= Φi

(cid:16)

α(n), β(n)(cid:17)

=

(cid:16)

α(n)(cid:17)

g−
i

g+
i

(cid:16)

β(n)(cid:17)

>

1
γi

(cid:16)

α(n−1)(cid:17)

g+
i

1
γi

i (β(n−1)) = α(n)
g−

i

and

β(n+1)
i

= ΦN +i

(cid:16)

α(n), β(n)(cid:17)

=

(cid:16)
β(n)(cid:17)

g−
i

g+
i

(cid:16)

α(n)(cid:17)

<

1
γi

1
γi

(cid:16)

β(n−1)(cid:17)

g−
i

g+
i

(cid:16)

α(n−1)(cid:17)

= β(n)
i

.

The proof of (iii) is also done inductively. Deﬁne

N
(cid:89)

R(n) :=

[α(n)
i

, β(n)
i

].

i=1

By the proof of (ii), R(n+1) ⊂ R(n). Deﬁne F : [0, ∞)N → [0, ∞)N by the formula

Fi(x) =

1
γi

gi(x)

1 ≤ i ≤ N.

Observe that if f (ˆx) = 0, then F (ˆx) = ˆx. Therefore, it suﬃces to prove that if F (ˆx) = ˆx then
ˆx ∈ R(n) for all n ∈ N.

Observe that from the deﬁnitions of F and (cid:0)α(0)), β(0)(cid:1),

F (cid:0)[0, ∞)N (cid:1) = R(0)

13

and therefore ˆx ∈ R(0).

Inductively, suppose that n ∈ N is ﬁxed and ˆx ∈ R(n−1), i.e.

α(n−1)
i

≤ ˆxi ≤ β(n−1)

i

for 1 ≤ i ≤ N.

(10)

The inequalities of (10) combined with the deﬁnition of Φ implies that for all 1 ≤ i ≤ N

α(n)

i =

1
γi

(cid:16)

α(n−1)(cid:17)

g−
i

g+
i

(cid:16)

β(n−1)(cid:17)

≤ Fi(ˆx) = ˆxi ≤

(cid:16)

β(n−1)(cid:17)

g−
i

g+
i

(cid:16)

α(n−1)(cid:17)

= β(n)
i

1
γi

where the inequalities are obtain from the fact that g+
increasing and decreasing respectively. Therefore, ˆx ∈ R(n).

i and g−

i are strictly monotonically

Observe that F (cid:0)R(n−1)(cid:1) = R(n).
This motivates the following algorithm for bounding equilibria.

(cid:46) Initialize orbit as described in Theorem 2

Algorithm 2 Bootstrap algorithm
1: function RootEnclosure(f )
2:

u ← (α(0), β(0))
v ← Φ(u)
while (cid:107)u − v(cid:107) > (cid:15) do

u ← v
v ← Φ(u)

3:
4:
5:
6:
7:
8:

i=1[vi, vN +i]

end while
R ← (cid:81)N
return R
9:
10: end function
11: function MonotoneHillEquilibria(f, k)
12:
13:
14: end function

R ←RootEnclosure(f )
return HillEquilibria(f, R, k)

4.3

Isolating equilibria

Let us consider the situation in which the previous Sections equilibrium ﬁnding numerical
algorithms return two solutions x1 and x2. It is possible that they are two numerical repre-
sentations of the same analytic solution, or that they represent two diﬀerent analytic solutions.
The numerical radii polynomial approach can allow us a heuristic to make this distinction.

The radii polynomial approach, as presented in [9, 16], is usually implemented rigorously
for the validation of zero ﬁnding problems.
In this Section, we are only interested in an
approximate implementation, thus our results do not have status of proofs, contrary to the
references given.

While it is possible to attempt a validation of any of the equilibria or saddle-node bifurca-
tions found in this work, this is not the focus of the present work and we have not implemented
it here. Validation of a single equilibrium or saddle-node bifurcation using the radii polyno-
mial approach requires a given high precision numerical solution. It does not provide a means
for producing such a solution which is the focus in this paper.

The radii polynomial approach is build around the contraction mapping theorem. In an
abstract setting, we consider a zero-ﬁnding problem F (x) = 0. In our setting, F = h(·, λ) is
the vector ﬁeld associated with a Hill model, but the discussion in this section is presented in

14

a more general way. Suppose x is an approximate root of F and A is an approximate inverse
of the Jacobian of F at x i.e. informally we assume

(cid:107)F (x)(cid:107) ≈ 0

(cid:107)A − DF (x)−1(cid:107) ≈ 0.

Then we deﬁne a “Newton-like” operator by the formula

T (x) = x − AF (x),

(11)

with the idea that if x and A are suﬃciently good approximations, then T is expected to be a
contraction in some neighborhood of x. To estimate the radius of contraction of T , we make
use of the following theorem.

Theorem 3. Let x, A be given and T as deﬁned in Equation (11). Suppose Y > 0 and
Z : (0, ∞) → (0, ∞) satisfy the bounds

Y ≥ (cid:107)T (x) − x(cid:107),

Z(r) ≥ max

b∈B1(0)

(cid:107)DT (x + rb)(cid:107),

then, let us deﬁne the radii polynomial as

p(r) = Y + (Z(r) − 1)r.

(12)

If there exists an r∗ such that p(r∗) < 0, then there exists a unique ˆx such that F (ˆx) = 0 and
(cid:107)x − ˆx(cid:107) < r∗.

For the proof we refer to [9].
It is useful to ﬁrst simplify

(cid:107)T (¯x) − ¯x(cid:107) = (cid:107)AF (¯x)(cid:107) = Y,

thus Y can be computed straighforwardly.

In our case, we notice DT (x) = I − ADF (x), thus

DT (x + rb) = I − ADF (x + rb) = I − ADF (x) + A (DF (x) − DF (x + rb))

and we split to computation of Z(r) into the computation of Z0 ≥ (cid:107)I − ADF (x)(cid:107) and Z1(r) ≥
maxb∈B1(0) (cid:107)A (DF (x) − DF (x + rb)) (cid:107). It’s worth noting that

max
b∈B1(0)

(cid:107)A (DF (x) − DF (x + rb)) (cid:107) ≤ max

z,b∈B1(0)

(cid:107)AD2F (x + rz)b(cid:107)r.

We then approximate maxz,b∈B1(0) (cid:107)AD2F (x + rz)b(cid:107)r ≈ (cid:107)AD2F (x)(cid:107)r := Z1r, by assuming
that the second derivative of F is almost constant. While the approximation is crude, it has
proven to be suﬃciently precise for the task of identifying equivalent equilibria.

We then have the radii polynomial as

and the biggest existence radius is

p(r) = Y + (Z0 + Z1r − 1)r,

r∗ =

1 − Z0 + (cid:112)Z 2
1 − 4(Z0 − 1)Y
2Z1

.

With this approach in mind, we can distinguish between numerical duplicates of equilibria
and multiple equilibria. Considering the numerical approximations ¯x1, ¯x2 of equilibria, we

15

can compute their associated (approximate) existence radii r∗
2),
then we consider them to be numerical duplicates, otherwise, they represent diﬀerent analytical
solutions. We can then expand this algorithm to a set of approximate equilibria {¯x1, . . . ¯xn}.
First, all radii r∗
i , i = 1, . . . , n are computed, then we delete any xi such that there is an xj
with (cid:107)xi − xj(cid:107) < max(r∗
j ). To reduce the number of comparisons, we restrict ourselves to
j < i.

2. If (cid:107)¯x1 − ¯x2(cid:107) < max(r∗

i , r∗

1, r∗

1, r∗

We implement RadiiPol as a function that computes r∗ for any function f and approximate

equilibrium ¯x.

Algorithm 3 Unique algorithm

1: function Unique(f , X)
for ¯x ∈ X do
2:

r ←RadiiPol(f, ¯x)
if ¯y ∈ X: (cid:107)¯x − ¯y(cid:107) < r then

delete ¯y from X

3:
4:
5:
6:
end for
7:
return X
8:
9: end function

end if

5 The Toggle Switch

In this section we present the analysis for the Toggle Switch example discussed in in Section
1 and shown in Figure 1(a). We have chosen this example because the Toggle Switch is the
one of the simplest network motifs which exhibits both monostability and bistablity Indeed,
both the combinatorial Toggle Switch analyzed using DSGRN and the Toggle Switch Hill
model analyzed using NDMAgenerically exhibit two dynamic phenotypes depending on the
parameters. The monostable phenotype is characterized by the existence of a single, globally
attracting, stable equilibrium. On the other hand, the bistable phenotype is characterized by
the existence of two asymptotically stable equilibria and a single saddle equilibrium. As a
reminder, the word “equilibrium” here refers generally to both the classical deﬁnition of an
equilibrium for an ODE as well as the combinatorial equilibrium deﬁned in Section 3.

5.1 The Toggle Switch Hill model

We begin by brieﬂy outlining how the Hill model construction described in Section 2 yields
a Hill function model associated with the ODEs in Equation (3). The Toggle Switch has
two state variables of interest, denoted by x1, x2, and thus the appropriate phase space is
X = (0, ∞)2. For i = 1, 2, the state variable xi is assigned a positive linear decay parameter,
γi. In addition, both edges of the network are assigned a negative Hill function since both edges
in Figure 1(a) are repressing. These Hill functions contribute the additional 8 parameters to
the model and the parameter space for the Toggle Switch Hill model is Λ = (0, ∞)10. As
described in Section 2, we collect the parameters into a vector which we order as follows

λ := (γ1, (cid:96)1,2, δ1,2, θ1,2, d1,2, γ2, (cid:96)2,1, δ2,1, θ2,1, d2,1) ∈ Λ.

Since each node of the Toggle Switch has only a single incoming edge we assign the interaction
function deﬁned by p(z) = z to both coordinates of H. Therefore, the Toggle Switch Hill model

16

is given by the formula

f (x, λ) = −Γx + H(x),

x ∈ X, λ ∈ Λ

where the linear and nonlinear terms are given by

Γ =

(cid:18)γ1
0

(cid:19)

0
γ2

H(x) =

(cid:19)

(cid:18)H −
H −

1,2(x2)
2,1(x1)

.

(13)

(14)

As expected this is simply the vectorized form of the system of ODEs in Equation (3). Addi-
tionally, we note that f satisﬁes the hypotheses of Theorem 2 and consequently in the analysis
to follow, Algorithm 2 was employed to bound the equilibria for the Toggle Switch. In fact,
in Section 5.3 we prove a stronger version of Theorem 2 which improves the eﬃciency of our
statistical investigation.

The relevant parameters for the combinatorial Toggle Switch model analyzed using DSGRN

are as vectorized and denoted by

ξ := (γ1, (cid:96)1,2, δ1,2, θ1,2, γ2, (cid:96)2,1, δ2,1, θ2,1) ∈ Ξ,

where we remind the reader that Ξ = (0, ∞)8 denotes the combinatorial parameter space which
excludes the Hill coeﬃcient parameters. Despite the fact that Ξ is 8 dimensional, DSGRN
computes the combinatorial dynamics for the Toggle Switch in less than a second on a basic
laptop. Recall from Section 1 that the combinatorial description of the dynamics consists of
the 9 semi-algebraic sets listed in Table 1 and the Morse graph describing the combinatorial
dynamics for all parameters in each of these 9 regions.

Finally, we relate the combinatorial and Hill model parameter spaces by deﬁning the

projection map πΞ : Λ → Ξ by the formula

πΞ(γ1, (cid:96)1,2, δ1,2, θ1,2, d1,2, γ2, (cid:96)2,1, δ2,1, θ2,1, d2,1) = (γ1, (cid:96)1,2, δ1,2, θ1,2, γ2, (cid:96)2,1, δ2,1, θ2,1).

In terms of this projection we can now restate the heuristic claims made at the end of Section
1. First, we claim that, with very high probability, λ ∈ Λ is a bistable parameter for f if and
only if πΞλ ∈ R(5). Then, let r : [0, 1] → Λ be a path such that d1,2 = d2,1 = 1 at r(0),
d1,2, d2,1 (cid:29) 1 at r(1), and πΞ ◦ r is constant. Then we claim that with very high probability,
we ﬁnd a saddle-node bifurcation for f along r if and only if πΞ ◦ r ∈ R(5).

We will use statistical hypothesis testing combined with our eﬃcient numerical implemen-

tation of the Toggle Switch to justify these two claims.

5.2 Reducing the number of parameters

While the full parameter space of the Toggle Switch can be studied by NDMA, we are inter-
ested in making the results more readable and easier to handle from a statistical perspective
too. For this, we will make several changes to the model in order to reduce the dimension of
the parameter space.

We will reduce the number of parameters via two mechanisms. First we will equate the
Hill coeﬃcients associated to both edges in the Toggle Switch. This amounts to assuming that
d := d1,2 = d2,1, is the common value of both Hill coeﬃcients which reduces the number of
parameters in the model by 1. Second, we will further reduce the dimension of the parameter
space via non-dimensionalization of the parameters.

After identifying the Hill coeﬃcients and performing non-dimensionalization whereby we
may ﬁx 3 parameter values to be γ1 = θ2,1 = θ1,2 = 1 we obtain the reduced Toggle Switch

17

Hill model deﬁned by

f ∗(x) :=

(cid:32) −x1 + (cid:96)∗
2 x2 + (cid:96)∗

−γ∗

1,2 + δ∗
1,2
2,1 + δ∗
2,1

1
1+xd
2
1
1+xd
1

(cid:33)

.

(15)

where the parameters of the reduced model are related to the original parameters by the
identities

(cid:96)∗
1,2 :=

δ∗
1,2 :=

(cid:96)∗
2,1 :=

δ∗
2,1 :=

γ∗
2 :=

(cid:96)1,2
γ1θ2,1
δ1,2
γ1θ2,1
(cid:96)2,1
γ1θ1,2
δ2,1
γ1θ1,2
γ2
γ1

d := d1,2 = d2,1.

The parameter space associated to f ∗ is the subspace, Λ∗ ⊂ Λ, deﬁned by

Λ∗ := {λ ∈ Λ : γ1 = θ2,1 = θ1,2 = 1, d1,2 = d2,1 = d} ∼= (0, ∞)6,

and we denote a typical parameter by

λ∗ := (cid:0)(cid:96)∗

1,2, δ∗

1,2, γ∗

2 , (cid:96)∗

2,1, δ∗

2,1, d(cid:1) ∈ Λ∗.

The dynamics generated by f ∗ are conjugate to f restricted to the subset {λ ∈ Λ : d1,2 = d2,1}

and therefore we have performed all computations described in the remaining sections using
the reduced Toggle Switch model. We also note that the NDMAlibrary has been written to
allow these sorts of constraints to be implemented just as easily as a general Hill model, and
takes advantage of the reduced number of parameters for faster computation. However, it is
crucial to point out that none of the algorithms in this paper rely on either of the reductions
performed on this example.

After imposing these parameter constraints for the DSGRN parameter regions we obtain a
reduced version of the combinatorial parameter space denoted by Ξ∗ := (0, ∞)5 ⊂ R5 where a
(cid:1). Observe
typical reduced combinatorial parameter has the form ξ∗ = (cid:0)(cid:96)∗
that the 9 DSGRN parameter regions are projected onto semi-algebraic subsets of Ξ∗ deﬁned
by the reduced inequalities given in the last column of Table 1. Of course, the dynamic
phenotypes for each region are unchanged as a consequence of the conjugacy. Analogous to
the discussion in Section 5.1 we deﬁne a projection map for the reduced parameter space
πΞ∗ : Λ∗ → Ξ∗ which is deﬁned by projection onto the ﬁrst 5 coordinates.

2,1, δ∗
2,1

1,2, γ∗

1,2, δ∗

2 , (cid:96)∗

In the projected parameter space Ξ∗, we can readily deﬁne all the parameter regions already
introduced by DSGRN in Λ∗ in Section 5.1. The reduced inequalities for each projected region
R∗(i), i = 1, . . . , 9 are presented in the last column of Table 1.

5.3 Numerical analysis of the Toggle Switch

Here we explicitly describe our implementation of numerical techniques described in Sections
4 for the Toggle Switch example starting with ﬁnding equilibria. For the case of the Toggle

18

Switch, some additional results are stated in Theorem 4. We begin by observing that f ∗
satisﬁes Deﬁnition 5 for any λ∗ ∈ Λ∗ and therefore the bootstrap algorithm is applicable.
Following the construction in Section 4.2 we obtain the bootstrap map for the reduced Toggle
Switch which is given by the formula

Φ(α, β) =











1
γ∗
2

1
γ∗
2

(cid:96)∗
1,2 +
(cid:16)
(cid:96)∗
2,1 +

(cid:96)∗
1,2 +
(cid:16)
(cid:96)∗
2,1 +

δ∗
1,2
1+βd
2
δ∗
2,1
1+βd
1
δ∗
1,2
1+αd
2
δ∗
2,1
1+αd
1











(cid:17)

(cid:17)

(α, β) ∈ R2 × R2.

Following Algorithm 2 we start with the initial condition

(cid:16)

α(0), β(0)(cid:17)

:=







(cid:96)∗
1,2
(cid:96)∗
2,1
1,2 + δ∗
(cid:96)∗
1,2
2,1 + δ∗
(cid:96)∗
2,1







,

and deﬁne the iterates under Φ by (cid:0)α(n), β(n)(cid:1) = Φ(cid:0)α(n−1), β(n−1)(cid:1) for n ≥ 1. Theorem 2
ensures that the sequence of iterates converges to a ﬁxed point of Φ denoted by (ˆα, ˆβ) ∈ R2×R2
and that all equilibria of f ∗ are contained in the rectangle [ ˆα1, ˆβ1] × [ˆα2, ˆβ2] ⊂ X. However,
in the case of the toggle switch we can prove a stronger version of Theorem 2 which we will
exploit in our statistical analysis.

Theorem 4. Let f ∗ : X → T X denote the Toggle Switch Hill model with λ∗ ∈ Λ∗ ﬁxed and let
Φ : R4 → R4 be the associated bootstrap map for f ∗. Suppose the orbit through u(0) converges
to ˆu := (ˆα, ˆβ) ∈ R2 × R2 and let ˆR := [ˆα1, ˆβ1] × [ˆα2, ˆβ2] ⊂ X denote the equilibrium bounds
guaranteed by Theorem 2. Then exactly one of the following is true.

1. ˆR is a degenerate rectangle (i.e. for i = 1, 2, ˆαi = ˆβi) and f ∗ has a unique equilibrium

ˆx = (ˆα1, ˆα2) which is stable.

2. ˆR is non-degenerate and f ∗ has at least two stable equilibria. Speciﬁcally, the corners of

ˆR with coordinates

ˆx1 = (ˆα1, ˆβ2),

ˆx2 = ( ˆβ1, ˆα2)

are stable equilibria of f ∗.

Proof. Deﬁne ˆx1 := (ˆα1, ˆβ2), ˆx2 := ( ˆβ1, ˆα2), and observe that since (ˆα, ˆβ) is a ﬁxed point of Φ
we have by direct computation

H1,2( ˆβ2) = ˆα1
H2,1( ˆβ1) = γ∗
H1,2(ˆα2) = ˆβ1
H2,1(ˆα1) = γ∗
2

2 ˆα2

ˆβ2.

It follows that

f ∗(ˆx1) = f ∗( ˆα1, ˆβ2) =

f ∗(ˆx2) = f ∗( ˆβ1, ˆα2) =

(cid:18) ˆα1 − H1,2( ˆβ2)
ˆβ2 − H2,1(ˆα1)
γ∗
2
(cid:18) ˆβ1 − H1,2(ˆα2)
2 ˆα2 − H2,1( ˆβ1)
γ∗

(cid:19)

(cid:19)

(cid:19)

(cid:19)

(cid:18)0
0
(cid:18)0
0

=

=

19

so that ˆx1, ˆx2 are equilibria for f ∗. Evidently, if ˆR is degenerate then ˆx1 = ˆx2 and by Theorem
2 it follows that this is the unique equilibrium for f ∗. On the other hand if ˆR is nondegenerate
then ˆx1 and ˆx2 are distinct equilibria of f ∗.

Next, we prove that ˆx1 is stable as the argument for stability of ˆx2 is similar. Observe

that the derivative of f ∗ at ˆx1 is given by the formula

Df ∗(ˆx1) =

(cid:18) −1
H (cid:48)

2,1(ˆα1)

(cid:19)

H (cid:48)

1,2( ˆβ2)
−γ∗
2

which has eigenvalues satisfying

z2 + (1 + γ∗

2 )z + γ∗

2 − H (cid:48)

1,2( ˆβ2)H (cid:48)

2,1(ˆα1) = 0.

(16)

Observe that since H1,2 and H2,1 are monotonically decreasing, the discriminant of the

polynomial in Equation (16) is

(1 + γ∗

(cid:16)
2 )2 − 4

2 − H (cid:48)
γ∗

1,2( ˆβ2)H (cid:48)

2,1( ˆα1)

(cid:17)

= (1 − γ∗

2 )2 + H (cid:48)

1,2( ˆβ2)H (cid:48)

2,1( ˆα1) > 0.

Hence, we can deduce that the eigenvalues are real and distinct and thus ˆx1 is hyperbolic.
Consequently, Df ∗(ˆx1) has two linearly independent eigenvectors which we denote by v1, v2.
Let f1, f2 denote the two components of f ∗. We consider points x = (x1, x2) near the
equilibrium at ˆx1 lying on the lines deﬁned by x1 = ˆα1 and x2 = ˆβ2. Speciﬁcally, we have the
four cases:

1. If x1 < ˆα1, then f1(x1, ˆβ2) = −x1 + H1,2( ˆβ2) > − ˆα1 + H1,2( ˆβ2) = 0.

2. If x1 > ˆα1, then f1(x1, ˆβ2) = −x1 + H1,2( ˆβ2) < − ˆα1 + H1,2( ˆβ2) = 0.

3. If x2 < ˆβ2, then f2(ˆα1, x2) = −γ∗

2 x2 + H2,1(ˆα1) > −γ∗
2

ˆβ2 + H2,1(ˆα1) = 0.

4. If x2 > ˆβ2, then f2(ˆα1, x2) = −γ∗

2 x2 + H2,1(ˆα1) < −γ∗
2

ˆβ2 + H2,1(ˆα1) = 0.

Consequently, if (cid:15) > 0 is suﬃciently small, then f ∗ is transverse to the boundary of the ball
B(cid:15)(ˆx1) := (cid:8)x ∈ R2 : (cid:107)x − ˆx1(cid:107) < (cid:15)(cid:9)

and the ﬂow generated by f ∗ is in-ﬂowing. It follows from continuity of f ∗ that there exists
(cid:15) > 0 suﬃciently small such that the ﬂow restricted to the subspaces span{v1} and span{v2}
is also in-ﬂowing. Hence, v1 and v2 lie in the stable manifold of ˆx1.

5.4 Statistical analysis of saddle nodes

Having built numerical methods to search for saddle nodes in the Toggle Switch, we now
perform a statistical investigation of their results. Speciﬁcally, we investigate the accuracy of
the dynamical phenotypes predicted using DSGRN as well as the eﬀectiveness of our algorithm
for numerically ﬁnding saddle-node bifurcations based on those predictions. We begin with
the observation that if d = 1, then f ∗ has a unique equilibrium which is stable.

From our previous discussion of the Toggle Switch 5, given a parameter πΞ∗ λ∗ = (cid:0)(cid:96)∗

and a path r : [1, ∞] → Λ∗ deﬁned by r(s) = (cid:0)(cid:96)∗
tion were perfectly accurate then we would expect the following statements to hold:

1,2, γ∗

2,1, δ∗

1,2, δ∗

1,2, γ∗
2,1, s(cid:1), if the DSGRN predic-

1,2, δ∗

2 , (cid:96)∗

2 , (cid:96)∗

2,1, δ∗
2,1

(cid:1)

1. If πΞ∗ λ∗ ∈ R∗(5), then f ∗ undergoes a saddle-node bifurcation along the parameterized

path r.

20

2. If πΞ∗ λ∗ /∈ R∗(5), then f ∗ doesn’t undergo a saddle-node bifurcation along r.

Considering the non-linearity introduced by following the path r, we have to consider these
statements from a statistical perspective, that is: most paths r that connect R∗(5) × {∞} and
R∗(5) × {1} undergo a numerical saddle node.

These two previous statements can be summarized by the following statistical statement:

there is a correlation between the existence of a saddle node for λ∗ and λ∗ ∈ R(5).

Using the numerical algorithms described in this paper and Theorem 4 we quantify the
strength of this correlation using a χ2 test with the null hypothesis being that no correlation
exists. To describe the categorical random variables of the test we introduce some additional
notation.

We start by randomly sampling parameters from Ξ∗ and denote these samples by {ξ∗

1 , · · · , ξ∗
For each sample parameter, we check whether or not it lies in R∗(5) and whether or not we de-
tect a saddle-node bifurcation along r. On this basis we form 4 mutually exclusive categories.
We let

N }.

1. p(5)

s denotes the number of parameters in R∗(5) undergoing a saddle-node bifurcation,

2. p(5)

m denotes the number of monostableparameters in R∗(5) which do not undergo a
saddle node bifurcation,

3. pC

s denotes the number of parameters in the complement of R(5) undergoing a saddle-
node bifurcation,

4. pC

m denotes the number of monostable parameters in the complement of R(5) which do
not undergo a saddle-node bifurcation.

Remark 4. An important element to discuss is the distribution of the chosen sample. For
the Toggle Switch, a Gaussian distribution is created, such that each sample is the square
of sample from said distribution. The variance and covariance matrix are chosen such that
the probability of a sample being in either of the nine DSGRN regions R(i), i = 1, . . . , 9
is (roughly) equal. For bigger networks, such a distribution is hard to achieve, but in the
Toggle Switch case we are able to ﬁnd distributions such that the best sampled region has
roughly the double of the number of samples as the worst sampled region. Let us remind
that each region is unbounded, and no uniform sampling can be achieved. This justiﬁes the
use of unbounded distributions. The data-set for the Toggle Switch is created in the function
create dataset ToggleSwitch.

The computation of the values in step 1-4 creates the following correlation matrix

M =

(cid:32)

p(5)
pC
s
s
p(5)
m pC
m

(cid:33)

.

Once the matrix M is assembled, we are able to use them to compute the χ2-test, []. This
test is meant to prove that there is a correlation between a parameter being in R5 and such
parameter undergoing a saddle node. The smaller the p-value of the test, the stronger the
correlation is expected to be.

In toggle switch chi test, a sample from a random distribution is built, such that there
are roughly equal number of sample points in R(5) and its complement. Then, the matrix M
is built. While each run the exact values might diﬀer due to the sampling, a computation run
on 104 produced

21

M =

(cid:18)1116
74

(cid:19)

,

36
8685

together with Figures 5. While the code computes a data-set of this size in less than 5 minutes
on a laptop, choosing larger data-sets would not give us better results, but the clarity of the
ﬁgures would be impacted.

Thus, 93.7% of parameters in R(5) undergo a saddle node with Hill coeﬃcient under 100,
compared to 0.4% outside of R(5). Then, a χ-square test is run with M as input, giving a
p-value of 0. This value is a statistical guarantee that combinatorial saddles correspond to
smooth saddles and our approach is able to ﬁnd the majority of saddle nodes.

We remark that the values of M do not include the parameters for which we could ﬁnd
a change in the number of equilibria but for which Newton did not return a solution for the
saddle node problem (7). These parameters were few (89) in our run and are the product of
numerical artifacts, as such they should be considered as outliers in our discussion.

Remark 5. Increasing the maximum Hill coeﬃcient considered increases the likelihood of
ﬁnding saddle nodes in R∗(5), but also the likelihood of outliers due to numerical instabilities
at high Hill coeﬃcient values.

6 Applications to bifurcation analysis

6.1 Multiple saddle-node bifurcations, hysteresis, and isolas

We conduct here a numerical investigation into the qualitative nature of bistability for the
Toggle Switch model. We once present the simplest explanation for the attractors computed
with DSGRN in Table 1. Speciﬁcally, for generic ξ∗ ∈ Ξ∗ with πΞ∗ (ξ∗) ∈ R∗(5), then for
“large” d we expect f ∗ to have three equilibria: two stable and one saddle. For all other
parameters we expect to ﬁnd a single globally stable equilibrium for all Hill coeﬃcients. In the
previous section we demonstrated that with overwhelming probability this simple assumption
is correct. The most parsimonious situation for a generic parameter to exhibit such global
dynamics would be the following:

• If πΞ∗ (ξ∗) ∈ R∗(5) then along a Hill path through ξ∗ f ∗ undergoes a single saddle-
node bifurcation. At this point the saddle and one of the stable equilibria collide and
disappear.

• If πΞ∗ (ξ∗) /∈ R∗(5), then f ∗ has a single globally stable equilibrium for all d ∈ [1, ∞). In

particular, f ∗ does not undergo any saddle-node bifurcations.

While the ﬁrst part of this assumption has been discussed in the previous Section, we here want
to investigate the behaviour of parameters outside R∗(5). The second part of the assumption
seems reasonable based not only on our previous statistical result but also on the following
intuition. For d > 2 both Hill functions are sigmoidal with d controlling the incline of the
steepest part of the sigmoid. Therefore, for the Toggle Switch with identiﬁed Hill coeﬃcients,
it seems reasonable to guess that the nullclines of f ∗ move “toward each other” monotonically
as d → ∞. This intuition is shown in Figure 3 and suggests that f ∗ may undergo at most one
saddle-node bifurcation with respect to d. However, the techniques described in this paper
provide the means to eﬃciently test this conjecture. Despite the fact that the parameter
space is “high” dimensional, the combinatorial analysis suggests that if a counterexample
exists, one might look for it near the boundary of R∗(5). With this search strategy in mind
and using the eﬃcient numerical methods described in this work, we easily ﬁnd parameters

22

Figure 3: Toggle Switch nullclines for varying Hill coeﬃcient along a Hill path. As the response
of both Hill functions becomes steeper, the nullclines tend to be closer to one another until the
saddle-node bifurcation at which point the nullclines intersect tangentially. Further increasing
d increases the area bounded between the nullclines and the three equilibria appear to move
further apart from each other.

which numerically demonstrate multiple bifurcations and surprisingly this conjecture appears
to be false.

Indeed, the numerical investigation suggests that parameters outside of R∗(5) may undergo
(at least) two saddle-node bifurcations along a Hill path at some Hill coeﬃcients 1 < d1 < d2 <
∞. For Hill coeﬃcients in [1, d1) and (d2, ∞), the system is monostable and bistable in (d1, d2).
This behavior is shown for two parameters in Figure 4. Moreover, the transition between
monostability and bistability need not be hysteretic despite the fact that this model is a sort
of “canonical” network motif associated with hysteretic switching. Indeed, pairs of saddle-node
bifurcations occurring along a single Hill path may be hysteretic (i.e. connected by a single
equilibrium branch) or form isolas which are disconnected from a “main” branch associated to
stable equilibrium which persists for all Hill coeﬃcients. The combination of these dynamic
behaviors in this model suggests one possible cause for failures in the construction of synthetic
biological switches. In Figure 4, we present a plot of the Hill coordinate with respect to the x1
coordinate of numerically found equilibria for two diﬀerent parameters outside of the center
region. We can see how they diﬀer in the fact that, in the ﬁrst parameter, a continuous
function can be plotted, while in the second one, the Hill coeﬃcient is not a function of x1
and creates an isolas. In both cases, the saddles have been ﬁrst found numerically, then the
equilibria have been numerically continued to produce the ﬁgures.

6.2 Degenerate saddle-node bifurcations

In this section we numerically investigate and compare the saddle-node bifurcations in the
Toggle Switch occurring near the “corners” of R(5). We note how the description of the
attractors given by DSGRN also includes not only a count of the stable equilibria but their
relative position in a simpliﬁed phase space. This richer information can be used to fur-
ther investigate the dynamical behaviour supported by a system buy applying our combined
combinatorial-numerical approach.

In Section 6.2 we demonstrate how to deduce additional dynamical information in the
Toggle Switch model. Consider the simplest situation that all of the attractors in the Morse
decomposition identiﬁed for each region of the combinatorial parameter space in Table 1 is
associated with a single stable equilibrium for some smooth vector ﬁeld f : (0, ∞)2 → R2

23

Figure 4:
Branches of equilibria computed for the reduced Toggle Switch for varying
d via pseudo-arc length continuation depicting the two mechanisms which cause multiple
(Left) Hysteretic behaviour for the Toggle Switch found at pa-
saddle-node bifurcations.
rameter value λ∗ = [0.9243, 0.0506, 0.8125, 0.0779, 0.8161].
(Right) An isola is found at
λ∗ = [0.6470, 0.3279, 0.9445, 0.5301, 0.3908] indicating that multiple saddle-node bifurcations
are possible without hysteretic switching.

located in the indicated quadrant of the state space. We consider ﬁrst a path through the
continuous parameter space which visits the parameter regions in the order R(5) (cid:55)→ R(8) (cid:55)→
R(7) (cid:55)→ R(4) (cid:55)→ R(5). In the combinatorial system, a continuous branch of equilibria can not
cross the hyperplanes deﬁned by the equations x1 = γ1θ2,1 and x2 = γ2θ1,2. Therefore, if f is a
faithful continuous representation of the combinatorial dynamics then the most parsimonious
explanation for the sequence of Morse decompositions along this path is as follows.

For parameters in R(5), f has (at least) one unstable equilibrium. When passing between
regions R(5) and R(8), this unstable equilibrium and the stable equilibrium in (1, 0) disappear
in a saddle-node bifurcation. Similarly, when passing between regions R(5) and R(4) this
unstable equilibrium and the stable equilibrium in (0, 1) disappear in a saddle-node bifurcation.
Therefore, along the boundary separating R(4) and R(7) these two saddle-node bifurcations
collide in a codimension-2 cusp bifurcation and similarly on the boundary between R(8) and
R(7). An analogous analysis of a path visiting the regions (in order) R(5) (cid:55)→ R(2) (cid:55)→ R(3) (cid:55)→
R(6) (cid:55)→ R(5) suggests another cusp bifurcation at the “corner” shared by R(5) and R(3).

To contrast this behavior, consider a path visiting the parameter regions R(5) (cid:55)→ R(8) (cid:55)→
R(9) (cid:55)→ R(6) (cid:55)→ R(5). For all regions along this path, the unique stable equilibrium is located
in quadrant (0, 1) which is most likely modelled by the existence of a common smooth branch
of equilibria which remains in this quadrant throughout the path. On the boundary between
R(5) and R(6), the unstable equilibrium and the stable equilibrium in (1, 0) disappear in a
saddle-node bifurcation much like on the boundary between R(5) and R(8). A similar situation
occurs for paths visiting regions R(5) (cid:55)→ R(2) (cid:55)→ R(1) (cid:55)→ R(4) (cid:55)→ R(5). This behaviour is
not likely compatible with a cusp bifurcation at the ”corner” between R(5) and R(1) or R(9).
Thus, our conjecture is that bifurcations for parameters at the “corners” shared by region
R(5) and regions R(1), R(9) and those at the corners shared by R(5) and regions R(3), R(7)
are caused by very diﬀerent mechanisms.

To investigate our conjecture, suppose once again that f ∗ is the nondimensionalized Toggle
Switch Hill model deﬁned in section 5.2 with 6 dimensionless parameters. For visualisation
purposes, we deﬁne a suitable dimension reduction map from from Λ∗ onto the rectangle

24

[0, 3]2 ⊂ R2 which preserves these 9 DSGRN parameter regions and the relative distances
between parameters and the region boundaries.

To start, suppose ξ∗ ∈ Ξ∗ and deﬁne the related parameters {a1, b1, a2, b2} by the formulas

a1 := (cid:96)∗
1,2

b1 := (cid:96)∗

1,2 + δ∗
1,2

a2 :=

(cid:96)∗
2,1
γ∗
2

b2 :=

2,1 + δ∗
(cid:96)∗
2,1
γ∗
2

.

Observe that if the reduced polynomial inequalities in Table 1 are expressed in terms of these
new parameters, then the 9 DSGRN parameter regions as well as their boundaries are deﬁned
by linear manifolds. For example, region R(5) is given by

R(5) = (cid:8)(a, b) ∈ R2 × R2 : 0 < a1 < 1 < b1 and 0 < a2 < 1 < b2

(cid:9)

and the boundary separating R(5) and R(6) is given by

∂R(5) ∩ ∂R(6) = (cid:8)(a, b) ∈ R2 × R2 : 0 < a1 < 1 < b1, a2 = 1, and 1 < b2

(cid:9).

Implicitly this deﬁnes a nonlinear transformation ψ : Ξ∗ → R2 × R2 given by the formula
ψ(ξ∗) = (a, b) which maps each DSGRN region to a unique hyperplane in R2 × R2.

To complete the construction, ﬁx positive constants a, b and deﬁne another map g : R2 ×R2

by the formulas

g1(a, b) =






b2
1 + 1−a2
b2−a2
2 + a2−1
a−1

if b2 ≤ 1
if a2 < 1 < b2
if 1 ≤ a2

g2(a, b) =






b1
1 + 1−a1
b1−a1
2 + a1−1
a−1

if b1 ≤ 1
if a1 < 1 < b1
if 1 ≤ a1

(17)

Observe that the bounded subset Ka,b ⊂ image ψ deﬁned by the formula

Ka,b := (cid:8)(a, b) ∈ image ψ : (cid:107)a(cid:107)∞ ≤ a, (cid:107)b(cid:107)∞ ≤ b(cid:9).

we have that g(Ka,b) ⊂ [0, 3]3.

We use the previous constructions to visualize the relative position of parameters as follows.
M } ⊂ Ξ∗ we choose a, b suﬃciently large so
j ) ∈ Ka,b for 1 ≤ j ≤ M . Therefore, the mapping g ◦ ψ : Ξ∗ → [0, 3]2 satisﬁes the

Given a ﬁxed collection of parameters {ξ∗
that ψ(ξ∗
following properties.

1 , . . . , ξ∗

1. Each of the 9 parameter regions is mapped to a distinct unit square in [0, 3]2 and their
relative positions are preserved. In fact, g ◦ ψ has been constructed so that the images
of these regions are simply obtained by superimposing the graph in Figure 1(b) onto
[0, 3]2. We let S(i) := g ◦ ψ(R∗(i)) denote these unit squares for 1 ≤ i ≤ 9.

2. Each boundary separating a pair of parameter regions is mapped into a line of the form
gi = j with i ∈ {1, 2} and j ∈ {1, 2, 3}. In other words, boundaries of parameter regions
are mapped onto boundaries of the corresponding unit square and relative positions of
the boundaries are also preserved.

3. Relative proximity to boundaries is preserved. Speciﬁcally, suppose ξ1, ξ2 ∈ R∗(j) and
dist(ξ1, ∂R(j)) < dist(ξ2, ∂R(j)), then dist(g ◦ ψ(ξ1), ∂S(j)) < dist(g ◦ ψ(ξ2), ∂S(j)).

Given this projection of the parameter space into a two-dimensional Euclidean space we now
visually investigate the behavior of saddle-node bifurcations along the boundary of R∗(5).

To generate random parameters for a statistical analysis, we construct an unbounded
distribution F such that samples taken from F span the parameter regions R(i) ⊂ Ξ∗, i =

25

1, . . . , 9 of the Toggle Switch in such a way that no region is signiﬁcantly over- or under-
represented. Thus, we create large samples of parameters knowing that R(5) will be roughly
represented in the sample as often as the other parameter regions. Having constructed a
large sample of parameters, we can use the techniques presented in this Section to project
each parameter to the square [0, 3]2. For each parameter sample λ ∈ Ξ∗, we are interested in
ﬁnding any saddle node bifurcation that happens along the path r(s) as presented in Section
5.3. We will restrict ourselves to Hill coeﬃcients satisfying 1 ≤ d ≤ 100, since higher Hill
coeﬃcients would give rise to numerical instability.

The ﬁrst visual result we want to present is an overview of parameters that undergo saddle
nodes at diﬀerent Hill coeﬃcients. For this, we ﬁnd saddle nodes with respect to the Hill
coeﬃcient, then project the parameter over the [0, 3]2 square and represent the Hill coeﬃcient
as a heat map. In Figure 5, on the left the projection 17 is used, while the color indicates
the lowest Hill coeﬃcient d for which we could ﬁnd a saddle node at the given parameter
value. On the right Figure, there is a scatter plot of all parameters considered. These includes
information on parameters that never undergo a saddle node, but also on parameters that
undergo more than one saddle node. We will investigate further this class of parameters in
Section 6.

Figure 5: Left: Using the projection presented in Equation 17, a heat map is plotted, indicating
the smallest Hill coeﬃcient undergoing a saddle node. Right: Using the same projection,
parameters are plotted in blue if they don’t undergo any saddle node, in green if they undergo
a sinlge saddle node, in orange if they undergo multiple saddle nodes and in red if the bisection
algorithm found a saddle node that was not numerically conﬁrmed with Equation (7)

At ﬁrst glance, Figure 5 gives an intuition of what we proved in Section 5.4: choosing
parameters in R∗(5) has the highest likelihood of giving us a saddle node for relatively low
Hill coeﬃcient. Looking at this map, we observe that the bottom left of the center region
seems to be the best location for a practical bistable switch, since most parameters in that
section undergo a saddle node at low Hill coeﬃcient, and thus support bistability for most
large Hill coeﬃcients. We notice how there are saddle nodes taking place outside the center
region, but most of them undergo two saddle nodes, thus for high enough Hill coeﬃcient they
again present a unique stable ﬁxed point, as discussed in Section 6.1.

Crucially, this plot supports the claim that saddle-node bifurcations disappear into a cusp
(or other codimension-2) bifurcation along a loop around the points (1, 1) or (2, 2). However,
along a loop around (1, 2) or (2, 1), saddle-node bifurcations seem to disappear “at inﬁnity”.
This is consistent with the observations we obtained from only the combinatorial dynamics

26

0.00.51.01.52.02.53.00.00.51.01.52.02.53.0dsgrn_heat_plot0102030405060700.00.51.01.52.02.53.00.00.51.01.52.02.53.0Figure 6: The network structure for the EMT model associated with the Hill model given in
Equation (18)

using DSGRN, and that we presented at the beginning of this Section.

6.3 A high dimensional example: the EMT model

As a ﬁnal example we demonstrate the ability to reliably identify bistability and ﬁnd saddle-
node bifurcations even in “very high” dimensional parameter models. In [20] the authors study
a model for the Epithelial-Mesenchymal Transition network shown in ﬁgure 6. We identify
the 6 genes in this network with state variables deﬁned by

x1 : TGFβ

x4 : Ovol2

x2 : miR200
x5 : Zeb1

x3 : Snail1
x6 : miR35a

The associated Hill model for this network denoted by f is deﬁned on the state space X :=
[0, ∞)6. As expected the linear part of this model has parameters γ1, . . . , γ6 representing the
linear decay rate of each of the 6 state variables. Under the assumption that all activating
edges correspond to addition in the interaction function and all repressing edges are multiplied,
the nonlinear term denoted by H(x) is deﬁned by











H(x) :=

H −
H −
H +

1,4(x4)
2,5(x5)
3,6(x6)

1,2(x2)H −
2,3(x3)H −
3,1(x1)H −
H −
4,5(x5)
5,3(x3)H −
5,2(x2)H +
H −
6,5(x5)

6,3(x3)H −

H −

5,4(x4)











(18)

H ∗
i,j denotes a Hill function associated to the edge from node i to node j which contributes
4 non-negative parameters. Therefore the associated parameter space for this Hill model is
Λ = (0, ∞)54.

27

123546In order to analyze this model using the tools discussed in this work we ﬁrst implement
this model in DSGRN. The combinatorial parameter space has 10,368,000,000 regions and
we begin by ﬁnding a parameter region PM , which exhibits combinatorial monostability and
has a neighboring region PB exhibiting combinatorial bistability. Considering how widespread
such regions seems to be, we don’t check all possible regions, but stop within the ﬁrst 100.

Since PM and PB are semi-algebraic subset of R42 described by hundreds of polynomial
inequalities, we do not provide a list of these inequalities. However, these parameter regions
have indices 302 and 284 in DSGRN and the interested reader can inspect these inequalities
using the code available at https://github.com/skepley/NDMA/releases/tag/version0.

Due to the dimension of the parameter space and number of the parameter regions in this
example it is not feasible to attempt any sort of statistical analysis of our accuracy. In fact, the
purpose of this example is to demonstrate that we can even ﬁnd saddle-node bifurcations in
this model at all! With this in mind, we consider the reduced Hill model in which we identify
the Hill coeﬃcients for all 12 edges of the network. This is an ODE with 43 parameters, one
of which is the common Hill coeﬃcient which we denote by d.

From the two regions we selected, we are interested in creating a large enough sample of
parameters. One of DSGRN functionalities allows us to assign the appropriate region to a
parameter vector, another allows us to ﬁnd one (non-random) parameter within any given
region. To sample regions PM and PB, we ﬁrst query DSGRN to provide us with one point
in each region, pm and pb. We then create a multivariate Gaussian distribution around the
segment connecting these two parameters. By sampling from this Gaussian distribution we
create a point cloud mostly distributed in PM , PB and overlapping on neighbouring regions.
We could choose a smaller variance to ensure all our samples belongs to the selected regions,
but that would guarantee we are not spanning much of PM and PB either.

Thus, we randomly sampled 10, 000 parameters from this Gaussian distribution. DSGRN
computed that 7772 lie in PM and 1231 lie in PB, the remaining parameters were from outside
both regions.

We can then numerically search for saddle nodes along the curve of increasing Hill co-
eﬃcients for a subsample of these parameters. Due to the computational requests of this
computation, a smaller subsample was considered, where the same number of random param-
eters were selected from the monostable and the bistable region. In this case, we can built a
contingency matrix as discussed in Section 5.4, where we replace R(5) with the bistable region
and its complement with the monostable region. No sample outside of these two regions is
considered. Due to the increased size of the problem, a longer computational time is necessary,
but we computed the following contingency matrix for a subsample of 200 parameters:

M =

(cid:18) 5
194

(cid:19)

,

0
100

where a single parameter could not be determined. Here we can see that roughly 2.5% of
the parameters in the bistable region undergo a saddle node, while none of the parameters in
the monostable region do. The χ-test for this contingency matrix returns a p-value of 0.07.
While it doesn’t breach the traditional threshold of 0.05, we are conﬁdent this should be a
good indication to support our method. The code is presented in EMT chitest.py.

The parameters and computations for both the parameters in Pm and PB are available at

https://github.com/skepley/NDMA/releases/tag/version0.

28

7 Conclusion

The goal of this paper is not only to resolve some dynamical questions on the behaviour of
the Toggle Switch, but most notably to present an initial step towards the integration of
combinatorial and numerical methods in the study of global dynamics. Indeed, using purely
combinatorial information provided by DSGRN we can deduce signiﬁcant information about
the dynamics for any smooth version of the Toggle Switch. These claims are compounded
by the development of NDMA, a library centered around a fast parameter search in smooth
switching systems. A method for reliably ﬁnding all equilibria in systems with sigmoidal
non-linearities is presented, that allows for a reliable and vast saddle node search. While
for the implementation Hill models are used (Section 2), we underline how this was a purely
computational choice, and all the theoretical background and methodology proposed here are
independent of the chosen non-linearity.

Two main examples of the proposed methodology are presented. At ﬁrst, an in-depth
study of the Toggle Switch is carried out. This study not only supports the statement that
the analysis of switching systems provides incredibly useful information for a parameter search,
but highlights some numerically discovered dynamical behaviour in the Toggle Switch: notably
the existence of a codimension-2 cusp bifurcations and the existence of isolas, together with
the disappearance of saddle nodes at inﬁnity.

Having developed this toy problem, we then get our hands on a more complex system:
the EMT model. Here, the high dimensional parameter space, counting 54 parameters, is so
vast that most statistical approaches would not be able to sample it satisfactorily. Using the
information provided by DSGRN on the presence of monostable and bistable regions in the
switching system, we are able to ﬁnd bistability in the smooth system, proven by the existence
of saddle nodes.

Furthermore, we have strong statistical support for the presence of saddle nodes in the
regions selected with DSGRN is statistically signiﬁcantly diﬀerent from their presence in other
regions. This is of great impact in applications: it is now possible to search for parameters
supporting a chosen dynamical signature by using combinatorial information on switching
systems.

References

[1] Carmen Chicone. Ordinary diﬀerential equations with applications, volume 34 of Texts

in Applied Mathematics. Springer, New York, second edition, 2006.

[2] Bree Cummins, Tomas Gedeon, Shaun Harker, Konstantin Mischaikow, and Kafung Mok.
Combinatorial Representation of Parameter Space for Switching Networks. SIAM J. Appl.
Dyn. Syst., 15(4):2176–2212, 2016.

[3] William Duncan, Tomas Gedeon, Hiroshi Kokubu, Konstantin Mischaikow, and Hiroe
Oka. Equilibria and their stability in networks with steep sigmoidal nonlinearities. SIAM
J. Appl. Dyn. Syst., 20(4):2108–2141, 2021.

[4] Marcio Gameiro, Jean-Philippe Lessard, and Alessandro Pugliese. Computation of
smooth manifolds via rigorous multi-parameter continuation in inﬁnite dimensions.
Found. Comput. Math., 16(2):531–575, 2016.

[5] Timothy Gardner, Charles Cantor, and James Collins. Construction of a genetic toggle

switch in escherichia coli. Nature, 403(6767):339–342, 2000.

29

[6] Tom´aˇs Gedeon, Bree Cummins, Shaun Harker, and Konstantin Mischaikow. Identifying

robust hysteresis in networks. PLOS Computational Biology, 14(4):1–23, 2018.

[7] Tom´aˇs Gedeon, Shaun Harker, Hiroshi Kokubu, Konstantin Mischaikow, and Hiroe Oka.
Global dynamics for steep nonlinearities in two dimensions. Phys. D, 339:18–38, 2017.

[8] Michael E. Henderson. Multiple parameter continuation: computing implicitly deﬁned

k-manifolds. Internat. J. Bifur. Chaos Appl. Sci. Engrg., 12(3):451–476, 2002.

[9] Allan Hungria, Jean-Philippe Lessard, and J Mireles James. Rigorous numerics for ana-
lytic solutions of diﬀerential equations: the radii polynomial approach. Mathematics of
Computation, 85(299):1427–1459, 2016.

[10] W. D. Kalies, K. Mischaikow, and R. C. A. M. VanderVorst. An algorithmic approach

to chain recurrence. Found. Comput. Math., 5(4):409–449, 2005.

[11] W. D Kalies, K Mischaikow, and R.C.A.M. Vandervorst. Lattice structures for attractors

II. Found. Comput. Math., 1(2):1–41, 2015.

[12] W. D Kalies, K Mischaikow, and R.C.A.M. Vandervorst. Lattice structures for attractors

III. J Dyn Diﬀ Equat, 2021.

[13] William Kalies, Konstantin Mischaikow, and Robert Vandervorst. Lattice structures for

attractors I. J. of Comp. Dyn., 1(2), 2014.

[14] Shane Kepley, Konstantin Mischaikow, and Lun Zhang. Computing linear extensions
for polynomial posets subject to algebraic constraints. SIAM J. Appl. Algebra Geom.,
5(2):388–416, 2021.

[15] Jean-Philippe Lessard. Rigorous veriﬁcation of saddle-node bifurcations in odes. Indaga-

tiones Mathematicae, 27(4):1013–1026, 2016.

[16] Jean-Philippe Lessard, JD Mireles James, and Julian Ransford. Automatic diﬀerentiation
for fourier series and the radii polynomial approach. Physica D: Nonlinear Phenomena,
334:174–186, 2016.

[17] Laurence M Levasseur, Harry K Slocum, Youcef M Rustum, and William R Greco. Model-
ing of the time-dependency of in vitro drug cytotoxicity and resistance. Cancer Research,
58(24):5749–5761, 1998.

[18] Bree Cummins Marcio Gameiro, Shaun Harker. Dsgrn: Dynamic signatures generated

by regulatory networks. https://github.com/marciogameiro/DSGRN, 2020.

[19] Jan van den Berg, Jean-Philippe Lessard, and Konstantin Mischaikow. Global
smooth solution curves using rigorous branch following. Mathematics of Computation,
79(271):1565–1584, 2010.

[20] Ying Xin, Bree Cummins, and Tom´aˇs Gedeon. Multistability in the epithelial-

mesenchymal transition network. BMC Bioinformatics, 21, 2020.

[21] Bo Yan, Joseph M Chalovich, Bernhard Brenner, et al. Theoretical kinetic studies of
models for binding myosin subfragment-1 to regulated actin: Hill model versus geeves
model. Biophysical Journal, 80(5):2338–2349, 2001.

30

