2
2
0
2

r
p
A
9
2

]
h
p
-
t
n
a
u
q
[

1
v
5
0
0
0
0
.
5
0
2
2
:
v
i
X
r
a

Optically detected magnetic resonance with an open source platform

Hossein Babashah,1 Hoda Shirzad,1 Elena Losero,1 Valentin Goblot,1 Christophe Galland,1 and Mayeul Chipaux1
Institute of Physics, École Polytechnique Fédérale de Lausanne (EPFL), Lausanne CH-1015,
Switzerland
H.S and H.B. contributed equally to this work.

(*Electronic mail: mayeul.chipaux@epﬂ.ch)

(Dated: 3 May 2022)

Localized electronic spins in solid-state environments form versatile and robust platforms for quantum sensing, metrol-
ogy and quantum information processing. With optically detected magnetic resonance (ODMR), it is possible to prepare
and readout highly coherent spin systems, up to room temperature, with orders of magnitude enhanced sensitivities and
spatial resolutions compared to induction-based techniques, allowing single spin manipulations. While ODMR was
ﬁrst observed in organic molecules, many other systems are nowadays intensively being searched for, discovered and
studied. Among them is the nitrogen-vacany (NV) center in diamond. Beyond ODMR it is notably already widely and
successfully used both as a high-resolution high-sensitivity quantum sensors for external ﬁelds and as a qubit. Others
are rare earth ions used as quantum memories and many other color centers trapped in bulk or 2-dimensional materi-
als. In order to allow the broadest possible community of researchers and engineers to investigate and develop novel
ODMR-based materials and applications, we overview here the setting up of ODMR experiments using commercially
available hardware. We also present in detail a dedicated collaborative open-source interface named Qudi and describe
the original features we have added to speed-up data acquisition, relax instrumental requirements and widen its ap-
plicability to individual and ensemble ODMR systems. Associating hardware and software discussions, this article
aims to steepen the learning curve of newcomers in ODMR from a variety of scientiﬁc backgrounds, to optimize the
experimental development time, preempt the common measurement pitfalls, and to provide an efﬁcient, portable and
collaborative interface to explore innovative experiments.

CONTENTS

Introduction

I. Optically Detected Magnetic Resonance

A. Main principles
B. Interactions with external quantities
C. Main ODMR systems and their applications
D. Main ODMR techniques

1. Continuous wave mode
2. Pulse sequences

II. Hardware for continuous and pulsed ODMR

A. Photoluminescence microscopy

1. Light detector and imaging mode
2. Optical components and alignment
3. Light source
4. PL digitization and visualization
5. Scanning in a confocal microscope

B. Microwave instrumentation
C. Pulse generation
D. Bias magnetic ﬁeld

III. Connection and synchronization

A. Photon detection
B. Confocal scanning
C. CW ODMR
D. Pulsed measurements

IV. Qudi, an open-source interface for ODMR

experiments
A. Original and added features
B. Main architecture

1

2
2
3
3
4
4
4

5
5
6
6
8
8
8
10
10
10

11
11
11
12
12

13
14
15

1. Modules
2. Hardware interfaces

C. Installing and conﬁguring Qudi

1. Installation in an appropriate Python

environment

2. Writing a conﬁguration ﬁle
3. Interfacing unsupported instruments
4. Running Qudi

V. Good practices for ODMR measurements: NV

Center characterization
A. Procedure
B. CW ODMR
C. Pulsed experiments

Conclusions and perspectives

Acknowledgments

Author declarations
Conﬂict of Interest
Author Contributions

Data availability

15
16
16

17
17
17
17

18
19
19
19

21

21

21
21
21

21

INTRODUCTION

Spin is a quantum property of elementary particles which
confers them an intrinsic magnetic moment that can be asso-
ciated with a circulating charge ﬂow in their wave function1.
In atoms and ions, while the nuclear spins remain essentially
shielded, the unpaired electrons result in magnetic moments

 
 
 
 
 
 
that are three order of magnitude stronger – of the order of
the Bohr magneton.
It makes electron spins the main con-
tributors to most materials’ magnetic properties. In the mod-
ern context of the second quantum revolution2, electron spins,
such as in quantum dots3,4, color centers in diamond5 or sili-
con carbide6, or rare earth ions7 have been either studied as
individual quantum systems or as ensembles. While elec-
tron spins naturally interact with various external and internal
ﬁelds, they can also be isolated from unwanted perturbations
by experimental design or choice of system8, making them ei-
ther great quantum sensors9 or highly coherent quantum bits
(or qubits) for quantum information processing10,11.

Standard inductive radio- and microwave techniques for
spin resonance measurements suffer from poor sensitivity and
low spatial resolution.
Indeed, under achievable magnetic
ﬁelds electronic spin transition energies typically lie in the
microwave (MW) domain, with associated Boltzmann tem-
peratures of few tens of millikelvin, so that they are very
weakly polarized in ambient conditions. Additionally, sens-
ing MW ﬁelds at the single photon level remains a tremen-
dous challenge12, while this electromagnetic domains is asso-
ciated with wavelengths from millimeters to centimeters, by
far larger than the few tens of nanometers required for directly
probing spin-spin interactions13. Even using magnetic ﬁeld
gradients Magnetic Resonance Imaging (MRI) cannot achieve
spatial resolution below tens of micrometers14. All these lim-
itations affect both the spatial resolutions in quantum sensing
and the scaling of entangled qubits’ networks for useful quan-
tum computing.

Optical Detection of Magnetic Resonance (ODRM)15 of-
fers a powerful solution to these problems. It is applicable to
a range of material systems (see Table I) whose joint optical
and magnetic properties render their electron-spin magnetic
transition detectable in the optical domain. The following in-
gredients are characteristics of ODMR systems: Firstly, the
electronic spin can be polarized by optical pumping to a much
higher degree than under thermal equilibrium. Associated
with naturally low spin-lattice coupling16, certain electronic
spins can maintain long polarization and coherence times even
at elevated temperature17. Together those properties can, to-
tally relax the need for cryogenic conditions. Secondly, the
strength of optical signal (typically absorption or ﬂuorescence
or phosphorescence) must depend on the electronic spin state
or its projection along a quantization axis. Since optical ﬁelds
can routinely be detected at the shot-noise limit, the sensitiv-
ity of magnetic resonance spectroscopy and the ﬁdelity of spin
state readout can be signiﬁcantly increased while spin initial-
ization and readout can be achieved with a much higher spatial
resolution set by the optical wavelength. Finally, these advan-
tages can be translated to nuclear spin spectroscopy through
the use of hyperﬁne coupling18. Together, these features
are placing ODMR at the core of many emerging spin-based
quantum technologies.

Despite the growing number of researchers and engineers
active in this area and the availability of advanced optical
and microwave (MW) equipment, building and operating an
ODMR setup for a speciﬁc purpose usually demands substan-
tial hardware and software developments. Moreover, beyond

2

the apparent simplicity of ODMR measurements, a certain
amount of tacit knowledge is needed to avoid some pitfalls
that can spoil measurement accuracy and reproducibility.
The main goals of this article are (i) to describe the typical
ODMR setups, from its conception and construction to the
optimization of speciﬁc measurements and (ii) to present
the recently developed features that we added to the ODMR
dedicated open source platform Qudi19 for speeding-up
acquisitions, relaxing instrumental requirements, widen its
applications and lowering newcomers’ entry barrier.

In Sec. I, we ﬁrst recall ODMR main principles and mea-
surement techniques and overview of the most studied sys-
tems with their applications. We then present the hardware
conﬁguration needed for ODMR experiments in Sec. II. As-
pects related to optical setup, generation of MWs signals
and pulses and of bias magnetic ﬁelds are discussed. We
show how some ODMR experiments (in continuous wave and
pulsed modes) can be visualized directly with an oscilloscope,
and determine when the use of a computer interface is useful
or required. In Sec. III, we describe how these instruments
are connected together and present the most common strate-
gies for synchronizing ODMR experiments. Both the com-
puter and oscilloscope interfaces are covered. Section IV is
dedicated to the open source platform Qudi, ﬁrst release in
201719, for operating ODMR experiments. With a focus on
the features we added to Qudi, the section is written as a user
guide for getting started and it addresses the main issues re-
lated to interfacing with speciﬁc hardware. Finally, in Sec. V
we give a few practical advice to perform reliable and con-
trasted measurements, in particular accounting for technical
noise and instrument imperfections. We take a speciﬁc focus
on NV center ensembles as an illustrative scenario.

We believe that the software development and technical
guide presented here will help newcomers achieve faster and
better results for their desired application and provide experts
an efﬁcient, portable, and collaborative platform to explore
innovative experiments.

I. OPTICALLY DETECTED MAGNETIC RESONANCE

A. Main principles

ODMR relies on two main features: (i) initialization (i.e.
polarization) of the spin state under optical excitation (spin
pumping) and (ii) spin-state-dependent optical properties,
such as ﬂuorescence, phosphorescence, absorption, or, as
more recently demonstrated, photocurrent20, used for spin
state readout. While feature (i) boosts the spin resonance
signal, feature (ii) allows to advantageously trade low energy
MW photons for much higher energy optical ones in the spin
state measurement. These properties may arise from spin-
orbit coupling (see Fig. 1), a relativistic effect that allows for
Inter-System Crossing (ISC), e.g. transitions between singlet
S = 0 and triplet S = 1 state manifolds21,22. The probability
of ISC may depend on the initial spin state, which in turn may
result in spin-dependent optical properties and spin-dependent

3

FIG. 1. InterSystem Crossing (ISC) based ODMR dynamics when the ground state is singlet (a) or triplet (b).

relaxation pathways. In other systems (see Sec. I C), ODMR
can be achieved under resonant optical pumping such as using
lambda shaped conﬁgurations.

B.

Interactions with external quantities

Spin triplet state undergo speciﬁc interactions. At ﬁrst, if
the systems is not isotropic, a quantization axis emerges. Not-
ing mS the spin quantum number (i.e. the spin projection along
that axis), the dipolar spin-spin interaction lifts the degener-
acy between the states |mS = 0(cid:105) and |mS = ±1(cid:105), by an amount
called Zero-ﬁeld splitting (ZFS), often denoted with D. Fur-
ther degeneracy is lifted between |mS = −1(cid:105) and |mS = +1(cid:105)
by a parameter E when the symmetry is less than axial. The
eigenstates, potentially made of superpositions of pure spin
states, are then often denoted x, y and z. D and E depend on
geometrical aspects and therefore on pressure and tempera-
ture. In addition, Stark and Zeeman effects further separate
the |mS = −1(cid:105) and |mS = +1(cid:105) state which makes ODMR sys-
tems naturally sensitive to magnetic and electric ﬁelds. Fi-
nally, further interactions may occur with other electron or
nuclear spins, resulting in more level splittings, spin dephas-
ing and diffusion, etc.

C. Main ODMR systems and their applications

We can distinguish two main conﬁgurations linked to the
multiplicity of the ground state (see Fig. 1). The ground
state of organic molecules are typically spin singlets, where
all electrons are paired in covalent bonds or lone pairs23.
Photoexcitation followed by ISC may promote the molecule
into a spin triplet state and enable ODMR as in Fig. 1 (a).
Since 196724–26, such process has been exploited to enhance
the detection limit of magnetic resonance23 with a particular
application in photosynthesis research27,28. ODMR from a

single molecule was reported for the ﬁrst time in 1993 inde-
pendently by Wrachtrup et. al.29 and Köhler, et. al.30. Both
experiments relied on the photoexcited metastable triplet state
of a pentacene molecule trapped in a p-terphenyl host crystal.
Pentacene’s spin-dependent optical properties have also been
used inside MW resonators31, such as for demonstrating the
ﬁrst room temperature maser32 or conversely for cooling a
microwave mode33.

The negatively charged Nitrogen-Vacancy center (NV−)
in diamond - hereafter called NV center - belongs to the
second conﬁguration depicted in Fig. 1 (b). Its ground 3A2
and main excited 3E optical states are already spin triplets,
while ISC offers a spin selective relaxation path through a
metastable singlet state. The ﬁrst single NV center ODMR
in 199734. For the
signal was reported by Gruber et. al.
following reasons, NV centers then became the most studied
ODMR system. Firstly, they are highly photostable over a
wide range of temperatures35, pressures35, and biological
conditions . This feature also makes NV-doped nanodia-
monds particularly relevant in biological environment36 when
used as biomarker37–39 or quantum sensors40,41. Besides,
NV centers can exhibit long spin relaxation and coherence
times17 thanks to the low density of nuclear spins in diamond
and the decoupling of spin states from lattice phonons16.
It makes them versatile quantum sensors42 for detection
and imaging of magnetic and electric ﬁelds,
temperature,
strain, currents and associated noises9,43,44, as well as for
microwave ﬁeld imaging45 or spectroscopy46,47. In addition,
NV center ODMR properties can be extended to polarize48–50
and/or detect51–54 other electron or nuclear spins in their
vicinity. In these cases the sensitivity can go down to a single
nuclear spin, orders of magnitude better than conventional
electron paramagnetic resonance (EPR) and nuclear magnetic
resonance (NMR) methods. Finally, thanks to their excellent
coherence properties and couplings to even longer lived
nuclear spins55, NV centers are also promising qubits for

hvhvMWMWhvMW=±sm1=sm0MW=±sm1=sm0Singlet state(Metastable)(a)Triplet stateSinglet statexyzxyz(b)3M3EISCISC3G1E1G1Mquantum information processing11 and fundamental studies
of quantum mechanics56.

Other diamond defects

from the group IV-vacancy
category57 have recently revealed their ODMR signals. This is
for instance the case of the negatively charged silicon-vacancy
center (SiV−)58 and of its neutral form (SiV0)59 as well as
of the Germanium-Vacancy (GeV)60 and of the Tin-Vacancy
(SnV)61 centers. In those cases, the ODMR scheme requires
low temperature operations so to allow resonant optical ad-
dressing differing from the one presented Fig. 1.

4

In other crystals, single defect ODMR signals have re-
cently been reported in silicon carbide6,62,63 or hexagonal
boron nitride64,65. Notably, the so called V1 center in silicon
carbide62 involves a spin quartet S = 3

2 ground state.

Rare earth ions is crystal

lattices are also intensely
studied for long lasting and broadband optical quantum
memories66,67. One can cite Ce3+ in YAG68 or Y b3+69 and
Eu3+70 in Y2SiO5. Semiconductor quantum dots have also
been used in ODMR experiments71,72.

The optical wavelengths and microwave frequencies asso-

ciated to those systems are listed in Table I.

D. Main ODMR techniques

1. Continuous wave mode

ODMR can be performed under continuous wave (CW) op-
tical and MW excitation. A CW-ODMR spectrum is obtained
by recording the optical emission or absorption as function of
the MW frequency that is being swept. When spin resonances
are reached, dips or peaks appear in the recorded optical inten-
sity (see Fig. 2). Typically, this allows to localized the ODMR
resonances frequencies of the system to either measure the
physical parameters that govern it or determine gyromagnetic
ratio of the system itself (EPR spectroscopy). Several param-
eters affect the precision of the spectrum obtained by CW-
ODMR through the change in signal-to-noise ratio and spin
resonance linewidth. These parameters include MW power
(via power broadening76 and sample heating), laser power (via
change in excitation rate, governing spin polarization, optical
emission and photo-ionization rates), MW sweeping method
and pace, etc. Optimization of CW-ODMR signal acquisition
is discussed in Sec. V B.

2. Pulse sequences

Pulsed ODMR has the ﬁrst advantage of mitigating power
broadening by letting the system evolve freely after optical
and MW excitations. It also allows to tune the system for be-
ing speciﬁcally sensitive to certain quantities and insensitive
to unwanted perturbations, taking advantage of decades of de-
velopment in the ﬁeld of magnetic resonance spectroscopy77.
Good practices for optimizing a pulsed ODMR signal are dis-
cussed in Sec. V C. Below, we ﬁrst introduce most common
pulse sequences (in the case of a spin triplet).

FIG. 2. Example of a continuous-wave ODMR spectrum from an
NV-center ensemble under d.c. magnetic ﬁeld, displaying eight res-
onances (hyperﬁne splitting not resolved) with contrasts on the order
of 1%.

Common to most sequences, a ﬁrst laser pulse initializes
the system (e.g.
in state |mS = 0(cid:105)). After a period of spin
manipulation with MW pulses and/or free evolution, a sec-
ond laser pulse interrogates the spin state projection along
the (|mS = 0(cid:105), |mS = +1(cid:105)) basis through the optical emission
or absorption intensity.
It also re-initializes the system for
the subsequent measurement. In the Bloch sphere represen-
tation, a MW π pulse performs a π rotation along a certain
axis, for instance, it can swap the |mS = 0(cid:105) and |mS = +1(cid:105)
(or |mS = −1(cid:105)). A π/2 pulse only performs a quarter turn,
placing an initial |mS = 0(cid:105) state into an equal superposition
(cid:0)|mS = 0(cid:105) + eiφ |mS = +1(cid:105)(cid:1) (or | − 1(cid:105)).
1√
2
Relaxometry – T1 measurement — This sequence, re-
ported in Fig. 3(a), requires no MW ﬁelds. The two initial-
ization and readout optical pulses are separated by a varying
dark time τ. It allows probing the relaxation dynamics from
an initialized pure state to a thermal equilibrium. Interesting
for applications, the relaxation time, or T1, can sense the mag-
netic noise of the local environment78,79 such as the one cre-
ated by free radicals species in living cells40 or by chemical
reactions80.

Rabi sequence – π pulse calibration — In this sequence,
reported in Fig. 3(b), the delay between the optical pulses is
ﬁxed and a MW pulse is applied for a varying duration τ (al-
ternatively, its power can be varied). The measured optical
signal as a function of τ shows Rabi oscillations. From this
measurement the duration of π and π
2 pulses can be inferred
as half and quarter periods of the oscillations, respectively.

Ramsey sequence – T ∗

2 measurement — This sequence,
reported in Fig. 3(c), consists in a pump-probe experiment
where two π/2 pulses are inserted. The ﬁrst π/2, immedi-
ately after the initialization laser pulse, induces spin preces-
sion. After the free evolution time τ the precession is halted
by a second π/2 pulse before the read-out laser pulse is ap-
plied. The optical signal as function of τ presents oscillations
at the difference-frequency between the applied MW ﬁeld and

LaserMWSystem
(host)

Optical pumping Microwave
Off resonance pumping
(On resonance (ZPL))

Zero ﬁeld splitting D (E)
Gyromagnetic ratio {γ}

Organic molecules

Various

D = 500 to 1500 MHz
(E = 0 to 500 MHz)

Green - yellow, e.g. 585 nm D = 1395 MHz
(E = 53 MHz)

5

Comments / Applications

Sensitive EPR spectroscopy23
Photosynthesis73
First a single molecule ODMR signal29,30
First room temperature maser31,32

Pentacene
(p-terphenyl crystal)
NV− center
(Diamond)

Group IV-Vacancy
centers (Diamond)
SiV−
SiV0
GeV
SnV

Green e.g. 515 or 532 nm
(637 nm = 1.945 eV)

D = 2.87 GHz
(cid:8)γ = 28 GHz T−1(cid:9)

Quantum sensing
Quantum computation

(737 nm)
(946 nm)
(612 nm)
(260 nm)

D = 50 GHz
D = 944 GHz
D = 170 GHz

On resonance, Cryogenic temperature.74
Quantum networks75
58

59

60

61

V1 center
PL8 center
(4H-Silicon carbide)

(861 nm)
920 nm
(1007 to 1024 nm)

D = 2 MHz
D = 1.39 GHz E = 4 MHz Room temperature63

Spin quartet62

Unknown defects
(Boron Nitride)

Rare earth ions
Ce3+ (YAG)
Y b3+ (Y2SiO5)
Eu3+ (Y2SiO5)
Quantum dots
(In,Al)As/(AlAs)
CdSe/(Cd,Mn)S

532 nm

D = 0.1 to 2.4 GHz

(460 and 486 nm)
(980 nm)
(580 nm)

< 22.2 GHz
< 2.62 GHz
34.5 and 46.2 MHz

404 nm
405 nm

60 GHz

TABLE I. ODMR systems.

6

64

Quantum memories66,67
68

69

70

71

72

the spin transition being probed. Therefore, this sequence can
be used for DC sensing and offers better sensitivity compared
to the CW-ODMR approach76 by eluding the detrimental ef-
fect of power broadening. Ramsey fringes are damped with a
time constant reﬂecting the spin dephasing time or heteroge-
neous decoherence time called T ∗
2 .
Hahn echo sequence – T2 measurement — This sequence,
reported in Fig. 3(d), uses a π pulse in the middle of the Ram-
sey sequence. This approach mitigates the effect of slowly
ﬂuctuating ﬁelds (such as from the nuclear spin bath) by
canceling in the second half of the evolution the accumulated
phase difference from the ﬁrst half and restoring the original
coherence. The characteristic decay time measured with this
protocol is usually called T2, and can typically be one or
two orders of magnitude longer than T ∗
2 . More and more
complex and faster dynamical decoupling sequences can be
employed to extend T2; yet, it remains bounded by relaxation
time through T2 < 2 · T1. Such echo sequence is particularly
suitable of a.c. ﬁeld sensing as it can ﬁlter a narrow frequency
window9.

Many efforts have been devoted to develop and optimize
pulse sequences for increasing sensitivities to speciﬁc quanti-
ties and frequencies while canceling other noises. A compre-
hensive review dedicated to NV centers can be found in42.

II. HARDWARE FOR CONTINUOUS AND PULSED
ODMR

In this section we review the instrumental requirements for
ODMR measurements in terms of optical setup, MW genera-
tion and biased magnetic ﬁeld. Both CW and pulsed ODMR
measurements are discussed.

A. Photoluminescence microscopy

As mentioned in Sec. I, ODMR relies on monitoring an op-
tical signal such as photoluminescence (PL). It is obtained by
directing a pumping beam (a laser or LED) onto the system
of interest and routing the luminescence signal onto a pho-
todectector (such as an ampliﬁed photodiode, a single photon
counting module or a camera).

The simple optical setup reported in Fig. 4 is analogous to
an epiﬂuorescence microscope. An excitation laser beam is
reﬂected on a dichroic mirror and focused on the sample via
a microscope objective or a simple lens. The sample’s lumi-
nescence is collected by the same lens and sent to a photode-
tector. Alternatively, the sample can be pumped from another
side or by total internal reﬂection81–83, to relax the need of a
dichroic mirror or optimize pump power utilization and spa-

6

by two main aspects:

a.

Single-pixel vs. wide-ﬁeld imaging — In the for-
mer case, a photodetector is sufﬁcient, with appropriate ﬁlters
placed in front of it to discriminate the signal of interest from
the scattered laser light and the possible background lumines-
cence from ODMR-inactive centers85. At the cost of small
loss of transmitted power, spatially ﬁltering the luminescence
signal through a confocal pinhole or an optical ﬁber reduces
the out-of-focus background and collection area (see Fig. 5).
If imaging capability is desired it can be obtained by confocal
scanning (see II A 5 and Fig. 5).

For wide-ﬁeld imaging, a pixel array (camera) is required in
combination with a large and homogeneous illumination area.
Comprehensive reviews about wide-ﬁeld imaging in the par-
ticular case of NV centers can be found in86–88. Besides, ac-
cordingly to the speciﬁc experiments, different cameras (e.g.
CCD or a CMOS) can be preferred89.

b.

Strength of optical signal — It depends on the num-
ber of luminescent centers or molecules being addressed, their
individual quantum yields and the collection + detection ef-
ﬁciency. For the study of single or few emitters, a digital
photon counter (d-PC) is necessary, such as a reverse-biased
avalanche photodiode operated in Geiger mode or a supercon-
ducting nanowire detector. d-PCs generate electrical pulses
(e.g. TTL) upon photon absorption with a quantum efﬁciency
that can exceed 80%, allowing for the study of photon ﬂuxes
down to sub-kHz level, limited by the dark count rate of the
detector.

For measurements on large ensembles, d-PCs typically
saturate at count rates of few tens of MHz (i.e. few picowatts
at visible wavelengths). Above that analog photodectors
(a-PDs) can be used, such as ampliﬁed or avalanche photo-
diodes. In a wide-ﬁeld conﬁguration with a weakly emitting
system, particularly sensitive cameras are required such
as Electron Multiplying CCD (low noise) or phosphorus
intensiﬁed camera (gated).

To enhance the sensitivity in under signiﬁcant background
signal, one can modulate and demodulate the ODMR signal
(e.g.
through the applied MW frequency) with the help of
a lock-in ampliﬁer90. Such methods can be of great help
in the context of biosensing where background emission is
strong39. For wide-ﬁeld imaging, the recently developed ar-
rays for lock-in detector89 may ﬁnd numerous applications in
the upcoming years.

2. Optical components and alignment

When addressing individual emitters, one of the most im-
portant parameters is the microscope objective numerical
aperture (NA) deﬁned as NA = n sin θ , with n the refractive
index of the immersion medium and θ the half cone angle of
collection. For one, for isotropic emission pattern, it limits the
fraction of collected to emitted light to:

FIG. 3. Most common pulse sequences for ODMR: a) Relaxometry
b) Rabi sequence c) Ramsey sequence d) Hahn echo sequence. In
each panel, laser and MW pulses are represented schematically in the
top part. In the bottom part, NV centers’ experimental data obtained
in our set-up from are shown.

tial homogeneity of excitation. An inverted conﬁguration of
the microscope (e.g. where the objective is below the sam-
ple) can be chosen when using liquid immersion objectives,
especially for biological applications84.

FIG. 4. Schematic of a simple OMDR setup.

1. Light detector and imaging mode

The choice of the light detector is probably the most im-
pacting point in the development of a new setup. It is governed

η <

1
2

(1 − cos θ )

(1)

(a)(b)Laser(ms)MW(c)(d)Laser22MW22(μs)(μs)Inteytisn.bra(stinu)2(μs)7

FIG. 5. Schematic of a typical home-build confocal microscope used for low light ODMR experiments. The collimated beam from the laser is
spectrally ﬁltered (to remove broadband spontaneous emission) before being reﬂected on the dichroic mirror and focused on the sample using
a high NA objective lens. Photoluminescence is collected by the same objective, passes through the dichroic mirror and an interference ﬁlter
(band-pass or long-pass) to reject the excitation light, and is optionally spatially ﬁltered using a confocal pinhole or an optical ﬁber before its
intensity is measured by the detector. In order to scan the sample both a scanning mirror or a piezo stage can be used. To study single emitters,
a Hanbury Brown and Twiss interferometer can be added.

with cos θ =

(cid:113)

1 − (NA/n)2.

Through diffraction, it also limits the achievable resolution
rmin deﬁned as the minimum distance at which two objects can
be distinguished. As commonly determined by the Rayleigh
criterion:

rmin =

rAiry
2

= 0.61 ·

λ
NA

(2)

where λ is the wavelength of the optical source and rAiry the
radius of its diffraction pattern on the sample. Similarly, the
axial (depth) resolution is set by:

zmin = 1.4

λ n
NA2

(3)

A larger NA is usually obtained at the cost of a smaller
working distance. As a good compromise, an air objective
with NA up to 0.9 can offer a working distance of 1 mm.

In contrast, in a confocal setting, the magniﬁcation Mob j
of the microscope objective bears no direct relation to spatial
resolution and collection efﬁciency. It matters however for the
design of the excitation and collection optics as well as in the
case of wide-ﬁeld imaging on a pixel array.

To achieve a spatial resolution limited by Abbe's diffrac-
tion and avoid unnecessary light loss, care should be taken to
the following aspects. Firstly, the excitation beam diameter
Φ should match or exceed the back aperture diameter of the
microscope objective given by:

Φ = 2 f (cid:48)

ob j tan θ

(4)

NA/n

with tan θ =

1−(NA/n)2 , f (cid:48)
√

ob j = ltube
Mob j
of the microscope objective, ltube being the tube lens as de-
ﬁned by the microscope supplier (e.g. 180 mm for Olympus,
200 mm for Nikon and Mitutoyo and 165 mm for Zeiss).

the effective focal lens

Secondly, the confocal pinhole of radius rhole (or optical
ﬁber of numerical aperture NA f iber) has to be chosen to match
the diffraction pattern of the photoluminescence beam on the
pinhole (or ﬁber). When the image is sent to inﬁnity after the
objective the total magniﬁcation up to the pinhole (or ﬁber)
equals:

Mtot = Mob j ∗ Mlens = Mob j

f (cid:48)
lens
ltube

(5)

where f (cid:48)
lens is the focal length of the lens used to focus on the
pinhole. So to provide good confocal resolution while avoid-
ing signiﬁcant optical loss, rhole can be chosen to match the
radius of the Airy diffraction pattern:

rhole = 1.22 × Mtot

λPL
NA

(6)

Here, λPL refers to the wavelength of the photoluminescent
signal. The pinhole can also be chosen smaller. This would
enhance the resolution (e.g. reduce rmin) by a factor down to
2/3, at the cost of more optical loss.

If an optical ﬁber is used instead, its numerical aperture can

be taken as:

NA f iber =

NA
Mtot

(7)

In those cases, either the focusing lens, the pinhole or opti-
cal ﬁber can be changed to obtain the desired spatial ﬁlter-
ing. Further details about the basics of confocal microscopy
can be found in91. Finally, many efforts have been de-
voted to surpass the diffraction limit in ODMR using super-
resolution techniques such as stochastic optical reconstruc-
tion microscopy (STORM) and stimulated emission depletion
(STED) microscopy92,93.

3. Light source

For the most studied ODMR systems (Sec. I C), the opti-
cal pumping can be performed off resonance. Consequently,
there is no stringent requirement on temporal coherence and
linewidth of the light source, so that even a white-light LED
can be employed, as long as suitable ﬁlter sets are used to pre-
vent leakage of excitation light into the detector. Transverse
spatial coherence (single mode emission) is however required
in a confocal conﬁguration in order to obtain a diffraction-
limited spot size at the focus. As shown in Fig. 5, a spatial
ﬁlter (pinhole or mono-mode ﬁber) can be introduced in the
excitation path to improve transverse coherence. In this case,
and using large NA, optical powers of milliwatts or less are of-
ten sufﬁcient to saturate the emitter. Therefore, commercially
available solid state lasers are a great and affordable option.
Optionally, neutral density ﬁlters allow to adjust the power
incident on the sample while maintaining the laser at its opti-
mal operating power. In the wide-ﬁeld conﬁguration, the laser
power is diluted over the entire area of interest, requiring high
power lasers up to watts level.

In all cases, temporal ﬂuctuation in laser power represents
the main source of technical noise, which can be mitigated by
adding a feedback control loop or monitoring laser power in
real time through a second detector. Other forms of techni-
cal noises related to pulse measurements are discussed in Sec.
II C.

4. PL digitization and visualization

Depending on the type of signal coming from the pho-
todetectordifferent approaches to measure the its intensity are
used.

Analog photodetectors (a-PDs) deliver an electric signal
proportional to light intensity (temporally averaged over a
given bandwidth) that can be visualized directly on an oscil-
loscope for both continuous and pulsed measurements. Alter-
natively, a computer interfaced acquisition card that embeds
an Analog to Digital Converter (ADC) can be used. In this
context, the most relevant features of these data acquisition
cards (DAQ) are the number of input and output channels and
the maximum sampling rate. The sampling rate sets an upper
limit to the the fastest dynamic that can be measured under
analog acquisition. While the oscilloscope sampling rate can
be chosen up to the GHz range, the DAQ analog inputs are of-
ten limited to a few MHz. It as also to be noted than modern
oscilloscopes can be interfaced on a computer for direct col-
lection of the data temporally stored in the oscilloscope (see
Sec. IV A). In case of pulsed acquisition (see Sec. II C) aver-
aging over several repetition is needed to obtain sufﬁcient sig-
nal to noise ratio and/or to reduce the communication band-
width requirement with the computer. Consequently, it de-
mands a sync pulse for each repetition and limits the averag-
ing strategy to the NP method described in Sec. III D.

Digital photocounters (d-PCs) deliver nanosecond pulses
(e.g. TTL) with sharp rising edge. In such case, the use of
a computer becomes almost unavoidable. Conventionally, a

8

time tagging instrument or counter (e.g.
from Swabian in-
struments or PicoQuant) provides time resolution down to pi-
cosecond range, below the typical timing jitter of the detector.
ODMR however, rarely involves that fast processes. Such a
time precision can then become a disadvantage as the instru-
ment buffer becomes more rapidly saturated by the recorded
time tags.

Alternatively, as discussed in Sec. III A, DAQ cards also
include general purpose timers/counters that can be used for
photon counting with time resolution up to twice their in-
ternal clock rate, up to two orders of magnitude higher than
their analog inputs. If one needs higher temporal resolution,
for example to resolve the PL lifetime (see Sec. V), a ﬁeld-
programmable gate array (FPGA) can be used as a cost ef-
fective alternative to time-tagging instrument, but it requires
dedicated programming skills.

Finally, in the case of a wide-ﬁeld conﬁguration, the cam-
era conventionally embeds its own ADC and directly delivers
a digital image to the computer. In such cases, however, ac-
quisition rates are at best up to hundreds of hertz, often too
slow to resolve the pulse dynamics. When pulses cannot be
isolated from the each others, the averaging possibility is lim-
ited to the NP method described in Sec. III D.

5. Scanning in a confocal microscope

In a confocal microscopy conﬁguration, locating individual
emitters or mapping an area requires scanning the focal spot
over the sample. Two possibilities arise:

• The sample or the microscope objective is mounted on
an xy (or xyz) piezo-based nanopositioning stage so as
to scan their respective position. In such case, the range
is often limited by the stage itself from a few tens to
a couple of hundreds of micrometers.
If moving the
objective, the ﬁeld of view can also be limited by the
shift of its back aperture with respect to the excitation
and collection beams.

• The optical beam is angle-scanned by means of a 2-axis
oscillating mirror and a 4 f relay lens system. In such
case, the ﬁeld of view can be chosen by the 4 f lenses
and is ultimately limited by the ﬁeld number of the mi-
croscope objectives.

While the ﬁrst method is signiﬁcantly less bulky, the second
option is typically more affordable and offers a faster scanning
rate. It can also offer the ﬂexibility of changing the objective
to adjust the ﬁeld of view with respect to the resolution. Note
that stepper motors and slip-stick piezo stages have bad re-
peatably: for accurate mapping and positioning, closed-loop
positions have to be privileged. We also warn that magnetic
materials should be avoided, in particular in the sample stage.
In either case, controlling the scanning device requires a com-
puter program and a DAC interface. Such functions are often
provided via the aforementioned DAQ cards.

Apart from the essential components described in the pre-
vious paragraphs, the setup can be improved to allow addi-

Component

Key specs

Ex. of Brand (and model)

Light source

wavelength
intensity stability
transverse coherence
power (for wide-ﬁeld)
intensity modulation option

any diode laser with TEC
Coherent (OBIS 532 nm)
Labs-electronic (DLnSec 520nm)
Cobolt (06-MLD 515 nm)

9

Price (e)

∼ 3k-7k

Sec.

II A 3

AOM + RF driver

diffraction efﬁciency
switching time (rise/fall)

Gooch & housego (AOMO 3350-199)
AA Opto Electronic (MT350-A0.12-xx)

∼ 4k

II C

Microscope Objective working distance

numerical aperture

Immersion medium (air, oil...)

Dichroic mirror and
ﬂuorescence ﬁlter

cut-on wavelength
absorption losses
extinction outside transm. band

Nikon, Leica, Zeiss, etc.
Mitutoyo (0.6NA 1.3mm WD)
Olympus (LMPLFLN 50X 0.5NA)

depending on the ODMR system
Semroc, Thorlabs, Chroma. etc.

∼ 500-5k

II A 2

∼ 100-500

II A 2

Light detector

Analog (a-PD)

Digital (d-PC)

Camera

Piezo stage or
scanning mirror

MW source

wavelength range
bandwidth
noise equivalent power

quantum efﬁciency
dark count rate
timing jitter

Newport
Thorlabs (APD410A/M)

IDquantique (ID100), (ID120)
Excelitas (SPCM-AQRH)

∼ 1k-2k

∼ 2k-8k

Pixel size/number
Repetition rate, Gating
Quantum Efﬁciency, readout noise

Thorlabs, UEye
Andor, Princeton instruments

∼ 500-1500
∼ 2k-20k

scanning speed
resolution, repeatability
travel range
Closed vs. open loop

frequency range
phase noise
sweep rate
power

Thorlabs (GVS212/M)
MadCityLab (Nano-3D200)
Newport (FMS-300)

Wainvam (Wainvam-e1)
Anritsu (MG3691c), Agilent (n9310a)
Keysight (M9384B)
Rohde&Schwarz (SMB100B)

MW ampliﬁer

frequency range
gain and maximal power

MiniCircuit (ZHL-16W-43-S+)

MW antenna

ﬁeld intensity
bandwidth
spatial homogeneity

Ω-shaped antenna94
wire loop, straight wire
Sasaki et al.95

MW switch

insertion loss
switching time (rise/fall)

Minicircuit ZFSW-2-4,
Minicircuit ZASWA-2-50DRA+,

∼ 500-
50k

∼ 5k

< 10

Acquisition card
(DAQ)

maximum ADC sampling rate
number of i/o channels

Keysight-U2300A
National Instrument (PCIe-6363)

∼ 3k-7k

Pulse generator

Time-tagger

minimum pulse width
number of channels
max. number of pulses

minimum bin width
dead time
timing jitter

Spincore (PulseBlasterESR-PRO)
Zurich Instrument
Swabian Instrument (Pulse streamer 8/2)

∼ 4k

PicoQuant (PicoHarp300),
IDquantique (ID900)

∼ 3k-10k

II A 4

TABLE II. Necessary equipment for a confocal ODMR instrument, with remarks and examples of suitable providers. The cells in gray color
highlight speciﬁc equipment for pulsed experiments. In italic is what we used in our own NV setups.

II A 1

II A 5

II B

II B

II B

II B

II A 4
II A 5

II C

tional characterization features. For example, sending the lu-
minescence to a spectrometer allows to verify its origin and
to quantify the amount of background emission (for example,
for NV centers, emission from NV0 is detrimental to the con-
trast). Moreover, to conﬁrm that a single emitter contributes to
the signal, a Hanbury-Brown and Twiss (HBT) interferometer
can be used to measure the autocorrelation function96–98.

B. Microwave instrumentation

The manipulation of electron spins requires MW radiation.
According to the targeted spin resonances the MW source
should have an appropriate frequency range (See Table I).
Also, the phase (or frequency) noise of the source can be the
limiting factor when studying highly coherent spin transitions.
While a Variable Crystal Oscillator (VCO) can be used as
a very cost effective solution, tabletop MW generators such
as from Rohde & Shwartz or Anritsu are often preferred in
metrology and high-resolution spectroscopy for their spectral
purity and power stability. A key speciﬁcation for CW-ODMR
is the dwell time in frequency sweep, which affects the acqui-
sition time. MW powers above 30 dBm that can be achieved
with standard MW ampliﬁers. An insulator should be placed
after the MW source and/or the ampliﬁer to prevent back re-
ﬂections from damaging the instrument.

MW pulses can be carved out of a CW MW source using
external switches. Some MW generators may also directly
embed an internal switch, which typically offers better per-
formance to measure coherence times less than 100 ns due
to lower phase noise between pulses. Furthermore, the MW
source must be capable of frequency modulation (FM) for
lock-in type measurements. Compatibility between the var-
ious MW components must be carefully examined in order to
ensure a good match.

The MW radiation is delivered to the sample by MW an-
tennas. Working with ensembles may require spatially homo-
geneous MW amplitude over several hundreds of µm2. Sev-
eral designs focusing on optimizing their ﬁeld intensity and
spatial homogeneity can be found in94,95,99–101. Particularly,
a trade-off needs to be found between the power conversion
to the MW magnetic ﬁeld (Rabi oscillation frequency), the
area of ﬁeld homogeneity, and the bandwidth of the antenna
(important when bias magnetic ﬁelds are applied to split the
resonances). When spatial homogeneity is not essential, e.g.
when working with a single spin, a small wire loop or straight
wire can serve as MW antenna102.

C. Pulse generation

For time domain measurements (such the ones described
in Sec. I D) a pulse generator must be included in the setup.
While a minimum of two output channels is required to con-
trol both the MW and the laser, more channels can be useful
for synchronization or for more versatile pulse schemes (such
as rotating the spin around different axes on the Block sphere,
or driving with multiple MW frequencies at once). It is also

10

important that the pulse generator can to provide a minimum
pulse length signiﬁcantly shorter than the minimum coherence
time to be measured. To allow multi-pulse protocols (e.g for
Ramsey fringes), it is also essential that it can ﬁre more than
one pulse in each channel after a single trigger.

Two different options are available to produce optical
pulses, starting with acousto-optic modulators (AOM). For a
wide-ﬁeld illumination, special care should be taken about the
maximum optical admissible beam intensity to prevent any
damage of the device. This is to be considered together with
the desired rise and fall times, since all those parameters de-
pend on the beam diameter on the AOM. As a handy alterna-
tive, laser diodes may embed pulsing capabilities. Unfortu-
nately, overshoot can be present at the beginning of the pulse
and depend on the preceding off state duration (through ther-
mal relaxation). It may cause measurement artifacts, in par-
ticular when the repetition rate of the laser is varied, like in T1
measurement (see Sec. I D). While post treatment mitigation
methods are presented in Sec. V C, the use of an AOM reduces
such artifacts.

D. Bias magnetic ﬁeld

Several applications require a bias d.c. magnetic ﬁeld and
precise controls of its strength and orientation, which allows
to tailor the system eigenstates so that they are most sus-
ceptible to the ﬁeld of interest103,104. For example, when
NV centers are used for magnetometry and temperature sens-
ing, a bias axial magnetic ﬁeld often allows to improve the
sensitivity42,105,106. In addition, applying a ﬁeld parallel to the
quantization axis of the proper magnitude allows to work in
speciﬁc level conﬁgurations such as at the ground state or ex-
ited state-level anti-crossing (GSLAC or ESLAC)107. Cross-
relaxation conditions between different spin systems can be
matched by properly tuning the magnitude of an axial mag-
netic ﬁeld108,109. These conﬁgurations can be particularly
relevant in the context of all optical sensing108,110 or spin
polarization111. Finally, a transverse magnetic ﬁeld can be
relevant in speciﬁc situations, e.g. for electrometry103.

Different options are available and reported in literature to

achieve this:

• Place

permanent magnet

a micrometer
on
a
stage105,112,113.
Controlling the direction, unifor-
mity and intensity of the ﬁeld can be challenging.
Using a pair of permanent magnets mounted on a
rotation stage can be helpful for taking advantage of the
symmetry of the system. Fine calibration is required
for precise magnetic ﬁeld alignment and repeatability.

• Design a system of three Helmholtz coils, each address-
ing one axis114,115. This approach requires more initial
efforts, but leads to higher precision and control. It al-
lows to generate a bias ﬁeld in any possible direction
and to swiftly switch between different bias ﬁelds. In116
a useful numerical model to simulate the magnetic ﬁeld
in the center of the coils for varying parameters can be
found. Moreover, note that if the bias ﬁeld needs to

be modiﬁed during the measurement (as for example in
real time electrometry41,117), this approach is particu-
larly convenient.

• Hybrid solutions, matching the speciﬁc application
requirements110,117–119. It is often not necessary to gen-
erate a bias ﬁeld in any possible directions. Simpler
systems compound of one or a pair of Helmholtz coils
and permanent magnets are often sufﬁcient. Placing the
sample on a rotation stage can offer more convenience
and versatility.

To conclude this Section, we refer to Table II that sum-
marizes hardware requirement for a typical room-temperature
confocal ODMR setup.

III. CONNECTION AND SYNCHRONIZATION

We previously mentioned that the visualization of ODMR
signals can be either performed on an oscilloscope, or through
an acquisition card on a computer and we described when the
second option is necessary. Here we will overview how to
connect and synchronize each laboratory equipment with one
another in either case, focusing on four typical measurements
in ODMR.

A. Photon detection

As mentioned in sec. II A 4, two main types of detectors
(analog photodectors, a-PD vs. digital photon counters, d-PC)
can be employed depending mainly on the signal intensity.
The required connections for each case are illustrated in
Fig. 6.

On the one hand, the analog signal coming from an a-PD,
can be measured either directly with the help of an oscillo-
scope or on a computer after digitization via DAQ. In the
latter case, the a-PD is plugged to an analog input. The analog
acquisition is limited to the clock frequency of the ADC,
fADC, such that the temporal resolution is TSampling = 1/ fADC.
For example, in the case of the NI-6364 card and for single
channel, TSampling = 0.5 µs, increased to nc × TSampling when
nc channels are used.

On the other hand, the output of a d-PC is a train of pulses
(e.g. TTL), each corresponding to one detected photon. A
DAQ can be used to measure this signal. Commonly, one of
its internal counters is conﬁgured to count the number of re-
ceived photons through one of its PFI (Programmable Func-
tion Input). The count is then periodically stored in the DAQ
buffer and reset. As a result, the number of counts per interval
is obtained. In such a case, the sampling rate can be similar to
analog signals.

In order to increase the temporal resolution, which is most
desired in pulsed measurements, three counters of DAQ can
be used for time tagging. Two counters are set at a high data
rate as inputs to count the arriving signal from the d-PC and

11

sync signal which triggers the acquisition. The third counter
is set as output and it generates a periodic TTL signal to in-
ternally reset the other two. Their count are then saved in
the buffer after receiving the TTL reset signal. The reset sig-
nal determines the temporal time-tagging resolution. Know-
ing the relative time difference between sync and signal, the
averaged temporal signal can be reconstructed.

Alternatively, the role of the clock and the d-PC pulses can
be inverted.The count is then increased by one at each pe-
riod of the clock, while each photon, at the instant it is de-
tected, triggers its storage to the buffer. This results in a list
of time-stamped photons. At the cost of more information
saved, which can slow down the computer, this architecture
can achieve a better time resolution. With the same NI-6363
card considered above, one can achieve the temporal resolu-
tion of TSampling = 1/(2 ∗ fcounterclock ) = 5 ns; the factor 2 ac-
counts for both rising and falling edges being counted.

FIG. 6. Hardware connections for monitoring a photoluminescence
signal. The solid and dashed/dotted lines indicate the three hardware
alternatives. The green color refers to the pumping beam and the red
to the sample photoluminescence (PL). DAQ card internal connec-
tions are shown in gray. The analog, digital and oscilloscope-based
acquisition blocks introduced here, are also used in Fig.s 7, 8, and 9
along with the same conventions.

B. Confocal scanning

In confocal microscopy, a scanning device (such as a piezo
stage or a scanning mirror) is controlled while the sample PL
is monitored. Synchronizing the two allows to attribute each
pixels its corresponding PL intensity creating an image. As il-
lustrated in Fig. 7, these controls and PL monitoring are com-
monly performed with a DAQ card in which an analog output
is used for each spatial axes (x), (y) and (z). The measurement
is performed by generating a sync signal of frequency fsync
in the acquisition card and three step-ramp functions ranging
from the lowest to the highest voltage are sent to the con-

trol ports of the scanning device. Each sync period therefore
corresponds to a speciﬁc position of the scanning device for
which the PL is collected. The sync frequency and order of
the generated step ramp functions are eventually used to build
the PL image.

due to frequency-dependent MW heating through the antenna
resonance. In practice, the acquisition speed of a CW-ODMR
spectrum is limited by how fast the MW generation hardware
can switch the output frequency. This values is for example
around 1 ms minimum per step for R&S SMF100A.

12

FIG. 7. Hardware connections and synchronization links for con-
focal scanning. The analog and digital data acquisition blocks are
introduced in Fig. 6.

C. CW ODMR

Continuous wave ODMR spectra are measured in a sim-
ilar way, with the difference that the sweep is applied on the
MW frequency instead of the beam (or sample) position. Each
optical intensity must be attributed to the corresponding MW
frequency. As described in Sec. I D, the plot of the PL versus
MW frequency mirrors the magnetic resonance spectrum. As
reported in Fig. 8 the DAQ sends a TTL sync signal to the MW
source and triggers frequency change while the corresponding
PL signal is recorded simultaneously.

In case of using an oscilloscope for acquisition, the MW
source, set in frequency modulation mode, becomes the syn-
chronization master. It sends either a sweep or a TTL signal
with the same period to a second input of the oscilloscope to
trigger at the begining of each sweep. The horizontal tempo-
ral scale of the oscilloscope can then be adjusted to display the
PL as a function of the frequency. In the case of using a VCO,
the frequency has to be set by an external voltage source, such
as generated by a DAQ. The visualization on an oscilloscope
can be performed in the same way.

Typically, there are two modes to change the microwave
frequency: sweep and list. In the sweep mode, the minimum
and maximum frequency and the step size are deﬁned. As
the MW generator receives a TTL signal, it changes the fre-
quency by the deﬁned step. In the list mode, the list of fre-
quencies are previously stored in the generator, then as a TTL
signal is received, the frequency is changed to the next one
in the list. The list mode allows to perform random sweeping
of the MW frequency mitigating problems such as hysteresis

FIG. 8. Hardware connections and synchronization links for CW-
ODMR, MW connections are shown in orange. Other conventions
are the same as in Fig. 6.

D. Pulsed measurements

As depicted in Fig. 9, pulsed measurements require
synchronizing the laser and MW pulses with the optical
signal acquisition. A pulse generator sends a TTL signal to
command the laser and MW output switch. An additional
TTL signal is also generated within the pulse generator to
trigger the acquisition and set the time reference for each
measurement. This signal is sent to the DAQ or oscilloscope.
For each data point of a pulsed experiment, the optical signal
is analyzed against the change of one variable (e.g., duration
of the MW pulse or wait time between MW and laser pulses,
see Sec.I D).

Averaging strategies — We discuss two different options,
where i ∈ {1; P} labels the value of a parameter (e.g. waiting
time) to be swept among P values and N is the number of
repetition over which the signal is to be averaged.

• A ﬁrst averaging method is denoted as ”NP”, where
each ith pulse sequence is individually repeated N times,
before moving to the next parameter value from the 1st
to the Pth.

• In the second one, denoted as ”PN”, a full series of P se-
quences (consisting of P+1 optical pulses since the ﬁrst
only serves as initial polarization)is sent at once while
the PL is recorded. This sequence is then repeated as N
times to reach the desired signal to noise ratio. In this
method, a slow varying noise similarly affects all sig-
nals corresponding to all parameter values, and is there-
fore averaged out. It also allows to monitor the signal
to noise ratio improving over the successive repetitions.
However, it demands sufﬁcient time resolution to iso-
late signals from each pulse sequence making it hardly
compatible with the use of a camera. It also requires
digitizing and storing the full sequence at once, which
also limits the use of an oscilloscope (see Sec. II A 4).

Synchronization strategies — In either cases, two distinct

synchronization methods are possible:

• ‘Sync method 1’: Only two TTL sync pulses are gen-
erated, at the start and at end of each series of N (or P)
sequences.The incoming optical signal is continuously
recorded between the initial and ﬁnal pulses according
to the sampling rate. The position of each pulse is then
calculated by software (see Sec. V C). This cannot be
done when using an oscilloscope.

• ‘Sync method 2’: A TTL pulse can be sent at the be-
ginning of each pulse to be either timestamped by the
counter with a DAQ card or used to trigger the oscillo-
scope.

Fig. 9b depicts two out of the four possible combinations
of averaging and synchronization strategies in the case of a
Rabi oscillation measurements.

Implementation with a DAQ card — The implementation
of aforementioned methods with an NI card can be elaborated
based on the type of the acquired signal.

• In the analog case, the a-PD signal is sent to an analog
input channel of the DAQ card. As discussed in sec-
tion III A, the ADC captures and save the analog signal
into the buffer until it is read out. With ‘Sync method
1’, the generated sync pulses are transmitted to another
analog channel of the DAQ card and the acquisition
starts as soon as it receives a sync pulse. As a con-
sequence, the optical signal is recorded even when the
laser is off. Identiﬁcation of each pulse then requires
post-processing as described in Sec. V. With Â´Sync
method 2’, the generated sync pulses are sent to a dig-
ital channel of the DAQ card. The channel is adjusted
to acquire the pulses during the laser pulse windows us-
ing start edge trigger and pause trigger protocols of the
DAQ card.

• Acquiring data from a d-PC, however, demands time-
tagging as described in section III A. Similarly,
the
the
‘sync method 1’ records all the photon received.
pulses are found and reconstructed by post-processing.
With ‘sync method 2’ the trigger signals are time-
tagged and mark the beginning of each pulse.

One chooses the synchronization method depending on hard-
ware limitations and desired averaging strategy discussed
above.

13

IV. QUDI, AN OPEN-SOURCE INTERFACE FOR ODMR
EXPERIMENTS

As discussed in Sec.s II and III, the use of a dedicated soft-
ware can be necessary to control a confocal microscope or
It can also automatize the con-
deal with photon counting.
trol of ODMR instruments to speedup the measurements and
ease their reproducibility, be it for fundamental studies or ap-
plication development. Ideally, the software interface should
allow dealing both with single photon counters in low light
conditions and with analog photodetectors, processing con-
focal and wide-ﬁeld images, and freely combining different
measurement parameters and methods.

Several options exist for coding such interface program.
On the one hand, mid-level languages such as C++ or FOR-
TRAN, down to the lower-level ones such as assembly, offer
the best possibilities to optimize computer resources. They
are often the best option for demanding computational physics
and simulations, artiﬁcial intelligence related research, or for
processing of complex or voluminous data120. On the other
hand, higher level programming languages, such as Python
or Java, greatly facilitate design, development and mainte-
nance of codes. They also ensure better portability between
different hardware conﬁgurations. They are therefore particu-
larly appropriate for interfacing laboratory experiments121,122.
A comparison between programming languages including C,
C++, Java and Python can be found in123.

Among others, Labview (for Laboratory Virtual Instru-
ment Engineering Workbench), a proprietary programming
environment developed by National Instruments124, offers a
graphical diagram coding style making it more intuitive to
newcomers in programming. Moreover, it allows to easily in-
terface with laboratory instruments and offers libraries for sig-
nal generation, data acquisition and processing which allow
to rapidly setup basic experiments. However, when the ex-
perimental complexity increases, this graphical programming
style can become difﬁcult to handle. It also remains incom-
patible with versioning and collaborative tools such as Github
for sharing codes and subroutine within a community.

In this context, Python, a high-level programming lan-
guage, offers a great alternative125. Coding environments
and interpreters being open source, it is particularly popular
and used in various domains, including experiment control.
It supports versatile and efﬁcient community-developed li-
braries. Moreover, it offers sufﬁcient level of abstraction to al-
low portability between computers of different conﬁgurations
and making it upgradeable to new functionalities, embeds ef-
ﬁcient multi-threading and signaling capabilities allowing for
parallel operations (data acquisition, processing and display).
In this section we introduce Qudi, an open-source Python
code dedicated to ODMR measurements. First presented in19,
it is an open-source collaborative project shared on Github
and it beneﬁts from a well programmed Python-based archi-

14

FIG. 9. (a) Hardware connections and synchronization links for pulsed experiments. Solid and dashed lines indicate different alternatives
depending on available hardware. (For example, if the laser uses pulsed modulation, the AOM is not required.) (b) Averaging and synchro-
nization strategies in the case of a Rabi measurement. Top: PN strategy with ‘Sync method 1’, Bottom: NP method with ‘Sync method
2’

tecture. In order to improve its performance and extend its
applicability, we added to the original version several features
that we present below. After that, we introduce its architecture
focusing on the notions that are useful for installing, conﬁgur-
ing and using it. It then allows us to guide the newcomer from
getting started up to their speciﬁc needs including conﬁgura-
tion and upgrade for interfacing new instruments.

A. Original and added features

Original Features — Qudi19,126,127, ﬁrst released in
2017, embeds modules to perform ODMR experiments, con-
trolling the instruments and handling the data acquisition and
their processing on the go. It provides useful tools for inter-
facing a scanning confocal microscope by controlling piezo-
based nanopositioning stages or scanning mirrors and collect-
ing the optical emission signal. Fast imaging (or scanning) is
performed by generating beam position sweeps over the sam-
ple while acquiring the luminescence in a synchronous man-
ner. Possibilities include in-plane scanning (xy), z-stack ac-
quisitions (so to obtain 3D images), out of plane (xz) or (yz)
as well as any other direction cuts depending on the wiring
and instrument. Associated to confocal microscope hardware
(see Sec. II A), Qudi can be used to locate individual ODMR
emitters and automatically track them during an acquisition
by interrupting it shortly and re-optimizing the signal, which
allows to compensate for sample drift. This feature is partic-
ularly interesting when dealing with nanoparticles in a liquid
suspension such as in biomedical applications128,129.

Qudi also allows to efﬁciently control the different instru-
ments that are necessary to acquire a CW ODMR spectrum
and to ﬁnd the frequency of the spin resonance. Several com-
mon analytical curves can be ﬁtted in real time on ODMR data
helping to adjust the acquisition parameters and quickly share

the results with collaborators.

In addition to the CW ODMR signal, Qudi is designed
for the study of spin dynamics with pulse sequences such as
for measuring longitudinal spin relaxation curves (T1), Rabi
oscilations, Ramsey (T ∗
2 ) or Hahn Echo (T2) sequences (see
Sec. I D). It can control the pulse generator for triggering
laser and MW pulses (see Sec. II C) in a synchronous manner
with the collection of the photoluminescence (see Sec. III D).
Several tools are available to extract and analyze the pulses
on the go and to automatize the setting of experimental
parameters, which facilitates long measurement sequences
across many different material systems.

Added Features — In its ﬁrst version Qudi was primar-
ily designed for experiments on single quantum emitters, thus
requiring digital single photon counting modules as well as
time tagging electronics in the pulsed measurements. In or-
der to broaden its contextual applicability, we added several
features.

1. We implemented a direct oscilloscope interface (see

Sec. II A 4).

2. We enabled the use of digital inputs of a NI card (or
similar DAQ device) as a relatively fast event counter.
As presented in Sec. III A, the minimum temporal res-
olution is can now be down to half the period of the
card internal clock, which is often more than sufﬁcient
for ODMR experiments. Such using of the same DAQ,
often already required to control the confocal scanning
and monitor analog signals, relaxes the need for more
expensive dedicated time tagging instrumentation.

3. We implemented the two strategies for photon counting

presented in Sec. III A.

Antenna(Pulse modulation mode) PulseTriggerMWOutputLaser(Pulse mode)Laser pulsesDAQ cardClockSynchronizationD-AcqMW pulsesAOMA-AcqsampleSwitch                        a-PDOscilloscopePL PulsesO-AcqPulse generatorMicrowave source1τ2τPτN×N×N×1τ2τPτN×tt(b)(a)15

Module

Original features

Added features

Counting

Confocal

ODMR

Analog acquisition
Digital acquisition

Analog acquisition
Digital acquisition

Analog acquisition
Digital acquisition

Pulsed

Digital acquisition with time
tagging device

Acquisition with oscilloscope
Faster and analog and digital DAQ acquisition

Acquisition with oscilloscope
Control with pulse streamer

Arbitrary/random MW sweep
Acquisition with oscilloscope
Acquisition with Spectrometer
Lock-in detection

Analog acquisition with DAQ
Analog acquisition with oscilloscope
Digital acquisition with DAQ
Pulse extraction improved
New pulse sequences

TABLE III. Summary of Qudi main features in the original release126 and in our upgraded version127. Features in italic are currently under
development.

4. We coded a new logic for the pulsed measurements to
avoid storing data directly in the DAQ during the dark
time between laser pulses. With respect to the orig-
inally programmed one, it enhances the speed of the
pulsed measurements acquisition, in either the digital
and analog cases, especially for measurements where
there is long dark times. This method also relaxes the
need for post treatment pulse extraction as described in
Sec. III D.

5. We equipped Qudi with the capability to perform pulsed
measurements using analog signals (pulsed data could
previously be acquired digitally only). This aspect
makes Qudi compatible with the study of ensembles of
emitters (see Sec. II A 1), and in general with all types
of analog photodiode signals.

6. We improved analog acquisition in CW-ODMR by in-
creasing the sample rate per frequency sweep from one
to the maximum value, which is given by the ratio of the
frequency of the ADC clock and the rate of frequency
sweep of the MW source (see Sec. III A). This achieves
maximum signal-to-noise ratio for a given measurement
time.

7. Further improvement on CW-ODMR has been done
by adding an arbitrary/random MW frequency sweep,
to minimize the thermal effect of the resonator on the
ODMR signal.

9. Finally, with the same goal of improving ODMR acqui-
sition, we are currently developing a lock-in detection
scheme. In this method the signal from the lock-in am-
pliﬁer (e.g. Stanford Instrument) is sent to the DAQ
and the corresponding demodulated ODMR spectrum
is plotted in the software.

The summary of the added features to the Qudi platform is

shown in Table III.

B. Main architecture

Qudi is made of different modules that are loaded and con-
nected together by a manager component. The science mod-
ules responsible for experiment control are divided into three
categories: GUI (graphical user interface), logic, and hard-
ware. As detailed in the following, this division is based on
a clear separation of tasks among the categories and offers
a reliable and ﬂexible software architecture and simultane-
ous (multi-threading) acquisition, data treatment and visual-
ization. Importantly, the setting of those modules and the links
between them is to be deﬁned in a conﬁguration ﬁle. The writ-
ing of such a ﬁle will be discussed in Sec. IV C 2. The impor-
tant notion of hardware interface (higher abstraction level of
hardware module) is also introduced.

1. Modules

8. We extended the ODMR module by adding the op-
tion of acquiring the ODMR signal using an optical
spectrometer. This module uses a user-speciﬁed spec-
tral window and averages the optical intensity over this
spectral band for each MW frequency to calculate the
ODMR signal. The module can be used, for example,
to determine the optimal ﬁlter pass band to maximize
contrast and signal-to-noise ratio.

GUI modules — They create an interactive graphical in-
terface which allows the user to control the experiment and
to visualize the acquired data. In particular, the GUI allows
to start and stop the acquisition, to adjust the experimental pa-
rameters (e.g. MW power, frequency sweep range, acquisition
time...), to save the data and to ﬁt them with pre-deﬁned func-
tions, simply pushing buttons or inserting values into the inter-
active windows. Changes made in the graphic interface, such

16

FIG. 10. Qudi modules and software architectures. Running Qudi experiments requires a conﬁguration ﬁle created exclusively for one set of
experiments. It is accessed by Qudi through core modules while start.py is running. Inputs are read from the conﬁguration ﬁle and passed
to the related scientiﬁc modules (GUI, logic, and hardware). Hardware modules are accessed via interfaces as described in the text.

as a pushed button or a modiﬁed parameter, trigger a broad-
cast signal sent to the related logic modules. Although GUI
modules offer an intuitive and efﬁcient way to interact with
the logic modules, Qudi can also be fully functional without
them via the integrated Ipython console or via a Jupyter note-
book.

Logic modules — They form the basis of every experi-
ment designed in Qudi. Their main function is to coordinate
the different tasks necessary to perform a complete experi-
ment. They serve as a bridge between the two other kinds of
modules. On one side they receive the emitted signals from
the GUI modules and they send others to the hardware mod-
ules to conﬁgure the instruments130. Conversely, they gather
and analyze data coming from the hardware modules and pass
them to the GUI modules for display.

Each experiment depends on a variety of generic tasks that
are common to different types of measurements. This in-
cludes for instance, ﬁtting appropriate curves, saving the data,
etc. Therefore, rather than having a single logic module for
each experiment performing all these tasks, they are divided
in multiple versatile logic modules are implemented. Besides
communication with hardware and GUI modules, each logic
module can receive inputs from and send outputs to other re-
lated logic modules. Note that logic modules are the only ones
allowed to talk to modules of the same category.

Hardware modules — The main task of these modules is
to allow an effective communication between the logic mod-
ules and the speciﬁc hardware. Receiving orders from the
logic modules, they run the equipment drivers (often provided
by the supplier) to act onto the experiment. They also send the
output signals of the instruments to the logic modules, to be
further analyzed, displayed and eventually saved. Moreover,
hardware modules can also work as virtual dummy or mock
hardware, emulating the functionality of a real device. This
possibility can be very helpful for conﬁguring a new setup.

2. Hardware interfaces

Even if a set of instruments have common features for per-
forming similar tasks there is, between different models and
suppliers, a wide difference in command structure, grammar
and connection methods. In order to handle this complexity, a
speciﬁc interface is deﬁned for each category of instruments.
In the context of object oriented programming, hardware mod-
ules are classes that inherit from hardware interfaces. The run-
ning of a laboratory equipment consists in deﬁning and oper-
ating instances (objects) from the instruments-related classes.
The interface therefore consists of a set of functions that each
hardware module within the same category must implement.
Therefore, each instrument used in an experiment should have
its own class compatible with the related interface class in
Qudi. This class needs to control the instrument while respect-
ing constraints on its operation as speciﬁed in its data sheet.
To accomplish this task, the class may use drivers provided
by the instrument’s manufacturer. Various instruments have
already been introduced in Qudi in different categories (such
as spectrometers, cameras, MW generators, pulse generators,
etc.). However, due to the wide variety of systems, applica-
tions suppliers and models available, it may be necessary to
add a new device or modify the class for an instrument whose
model is slightly different from the one deﬁned in the code.
This will be discussed in Sec. IV C 3.

C.

Installing and conﬁguring Qudi

To perform an experiment with Qudi, it is necessary to in-
stall and tune it for a speciﬁc experiment by writing a conﬁg-
uration ﬁle. For installing an equipment that is not yet sup-
ported, it is also necessary to write the corresponding hard-
ware module class. Once these steps are done, it is possible

to run Qudi, adjust experimental parameters and launch the
acquisition through the graphical interface.

1.

Installation in an appropriate Python environment

Installing Qudi is rather straightforward from Qudi Doc-
umentation's instructions131.
It can be cloned from the
original126 or our127 Github. The conda environment in-
stallers for various operating systems can be found in the
folder qudi\tools. After installing the appropriate one, the
user can execute the program by launching start.py in the
conda environment.

A conda environment is a directory for a desired set of
conda packages132.
Installing, removing, or upgrading the
packages in one environment does not affect the other ones.
Therefore, for important coding projects that use many mod-
ules and packages such as Qudi, it is preferable to install all
the dependencies in a speciﬁc environment and launch the
program through it to prevent any conﬂicts with other pro-
grams.

Anaconda is one of most popular tools to manage such
conda environments: it easily allows users to build and switch
between them. Python projects, including Qudi, usually in-
clude a .yml ﬁle that lists all the dependencies of the project
(for Qudi, it can be found in the folder qudi\tools). Ana-
conda builds the environment directly via this ﬁle.

By running start.py, Qudi begins by loading the core
modules. They are responsible for the primary functions of the
process, including reading and loading the conﬁguration ﬁle,
loading and managing modules, and handling error logging
and remote network access. Once the program is executed
with no error, the Qudi task manager GUI will open up. Ini-
tially, when the user runs the program for the ﬁrst time, Qudi
will conﬁgure itself based on the default conﬁguration ﬁle,
located in the address qudi\config\example in the down-
loaded ﬁles. The default conﬁguration ﬁle does not need to
be connected to any real hardware: it uses virtual dummy or
mock hardware, which emulates the functionality of a device,
to offer ﬁrst-time users a demonstration of how different parts
of Qudi should look like. However, to do a real experiment,
one needs to write the conﬁguration ﬁle, as explained in the
following.

17

IP or GPIB address), and the critical hardware constraints are
required. For logic and GUI modules, the connections should
be indicated. Figure 11 presents required modules for the four
typical experiments described in Sec. III and the connections
to be declared in the conﬁguration ﬁle.

To avoid users missing any input, all Qudi module codes
include examples to be copy-pasted into the conﬁguration
ﬁle. Other general examples are also provided in the direc-
tory qudi\config\example. In any case, these have to be
adapted to the user’s own need and conﬁguration. Besides the
speciﬁc modules, the Manager GUI and Tray module should
always be included in a conﬁguration ﬁle. Loading the Tray
module, the Qudi icon appears in the system tray: by clicking
on the icon, the user can quit the software or bring its main
window to the front. The Manager GUI provides access to the
core manager class, resulting in the display of the graphical
user interface. Through this interface, it is possible to activate
or deactivate modules, and switch between conﬁguration ﬁles.

3.

Interfacing unsupported instruments

Interfacing new equipment is likely the most common
upgrade Qudi users may want to perform. As described
in Sec. IV B 2, each category of instrument has its own
hardware interface whose list can be found in the folder
qudi\interfaces. In the simpler case, new equipment be-
longs to an existing category. The task is then to create a new
hardware module class inherited from the corresponding in-
terface. Interface classes contain ‘abstract methods’ in which
only the name and inputs are speciﬁed. The implementation of
the methods belongs to the hardware module classes. There,
the interface class should be imported, and the methods spec-
iﬁed in the interface should be implemented with the same in-
puts and names as the abstract methods. This implementation
then depends on the device itself and the speciﬁc driver given
by the supplier. Even if the device does not have a particular
functionality deﬁned in the interface class, the corresponding
method must still be deﬁned in the hardware class. Yet, it can
be passed without any commands.

For interfacing new instruments that do not belong to an
existing interface class, the user needs to go deeper in the code
to develop it.

2. Writing a conﬁguration ﬁle

4. Running Qudi

The Qudi conﬁguration ﬁle is a text ﬁle listing all required
modules and their connections.
It is written in YAML for-
mat, a data serialization language compatible with all pro-
gramming languages, and provides the software with all the
information necessary to conﬁgure itself for the desired ex-
periment. To let the program work properly, it is necessary
to follow the exact writing style. Inside the conﬁguration ﬁle,
the modules are listed under the three main categories (Hard-
ware, Logic, GUI). In general, the class name and directory
are required for all modules. The other inputs vary by module
type. For every hardware module the connection address (e.g.

When all devices have been introduced to Qudi and all the
necessary modules have been listed in the conﬁguration ﬁle,
we are ready to run the code and perform the experiment.
From the manager window it is possible to adjust the differ-
ent parameters. The results will be displayed in real time in
the GUI. There are several ﬁtting graphs, along with further
data analysis tools that can be helpful when adjusting experi-
mental parameters or reporting results. Moreover, the pulsed
measurement section offers the option of using a predeﬁned
sequence, or of building a new sequence of pulses.

18

FIG. 11. Block diagrams for the software connections of counting, confocal scan, CW ODMR, and pulsed measurement which needs to be
included in a Qudi conﬁguration ﬁle.

In the following chapter, we will focus on the characteri-
zation of an NV center ensemble to propose some practical
advice and discuss good practices when performing typical
ODMR experiments with a home-build confocal microscope
(see Sec. II) controlled using Qudi.

V. GOOD PRACTICES FOR ODMR MEASUREMENTS:
NV CENTER CHARACTERIZATION

As described in Sec. I D the main ﬁgures of merit charac-
terizing an ODMR system are the longitudinal spin relaxation
time T1, dephasing time T ∗
2 and coherence time T2 (the latter
being dependent on the type of echo sequence used to mea-

sure it). In this section, we describe the procedure and meth-
ods to reliably perform these measurements such as presented
in Fig. 3. As an illustration, we characterize a small ensemble
of NV centers in bulk diamond using a single pixel detector in
a confocal geometry (see Sec. II A 1). While an extensive re-
view on optimizing sensitivity with NV centers can be found
in42, we aim here at providing practical advice on how to eas-
ily reach good measurement quality in terms of acquisition
speed, contrast and repeatability.

A. Procedure

The sample is ﬁrst placed in the optical setup and its po-
sition adjusted to match the object focal plane of the objec-
tive. A confocal scan allows to image the sample and iden-
tify the region of interest. At this step, further alignment of
the setup to ensure that maximum signal is emitted by and
collected from the NV centers is possible. According to the
level of brightness of the sample a proper detector (e.g. photon
counter or analog photodiode) and possibly a neutral density
ﬁlter are selected. Then, we use Qudi ODMR interface to per-
form a CW-ODMR scan. The goal of this step is to adjust the
bias magnetic ﬁeld (by monitoring the different resonances in
the spectrum) and to identify the resonance frequency that will
be used for the following pulsed measurements.

One speciﬁcity with NVs is that each center can take one of
the four (111) crystallographic orientations of the diamond
lattice. Considering the two allowed MW transitions from
|ms = 0(cid:105) to |ms = −1(cid:105) and |ms = +1(cid:105), this can lead to eight
distinct resonances (that are further split by hyperﬁne inter-
action) whose frequencies correspond to the projection of the
magnetic ﬁeld along each orientation.
It allows to perform
vectorial magnetometry81,133 with respect to the laboratory
basis, even without biased applied ﬁelds134,135. Certain ap-
plications, may require a speciﬁc magnetic aligning (see Sec.
II D). In this example, we target a bias ﬁeld such that the Zee-
man splitting for at least one NV orientation is different from
all other orientations, i.e at least one pair of transitions in the
spectrum is non-degenerate.

We select a MW frequency resonant with one of these two
transitions (corresponding to either |ms = −1(cid:105) or |ms = +1(cid:105))
and perform pulsed measurements to characterize T1, T2 and
T ∗
2 . To this end, we move to Qudi interface for pulsed Mea-
surement. Rabi oscillations are ﬁrst measured to determine
the duration of a π pulse which is half the oscillation period.
We note in passing that the decay of Rabi oscillations is not
simply related to any of the time constants mentioned above
because increasing the MW pulse duration reduces is spec-
tral bandwidth and thus progressively ﬁlters a smaller set of
NV centers among the inhomogeneously broadened ensem-
ble. Since a good estimate of T ∗
2 can be obtained from the
CW-ODMR linewidth (in the limit of low MW powers) it is
recommended to use sufﬁcient MW power in the pulse se-
quences so that the π pulse is shorter than T ∗
2 in order to ef-
ﬁciently drive all NV centers in the ensemble. The last step
consists in applying each of the dedicated pulse sequences to
extract T1, T2 and T ∗

2 , previously presented in Sec. I D.

B. CW ODMR

In order to perform CW ODMR with highest possible con-
trast and narrow linewidth, a compromise must be reached in
terms of both MW and laser powers, as illustrated in Fig. 12.
While the optical excitation rate must be faster than the 1/T1
relaxation rate to ensure that all spins are well polarized, a
too high rate can decrease the ODMR contrast by compet-
ing with the MW excitation and preventing a large population

19

FIG. 12. (a, c) Contrast and (b, d) FWHM of a single resonance in
the CW ODMR spectrum, versus (a, b) MW Rabi frequency and (c,
d) laser power.

difference between states |ms = 0(cid:105) and |ms = 1(cid:105)136. On the
other hand, while increasing the MW power ﬁrst enhances
the contrast, it then broadens the resonances through power
broadening76.

As practical guidelines (for NV ensembles) the optimal
laser power is the one maximizing contrast and the optimal
MW power is the highest power for which the linewidth re-
main close to the T ∗
2 limit. For further optimization, the op-
timum condition for the laser and MW power can be derived
analytically using a rate equation approach76,136.

C. Pulsed experiments

To improve the quality of a pulsed experiment several fac-
tors should be taken into account. Some are general to all
pulsed protocols, while others are more speciﬁc. Common
requirements for all pulsed experiments are reliable initial-
ization and readout. Laser pulse duration needs to be long
enough to ensure maximum polarization in state |ms = 0(cid:105).
The characteristic time for spin polarization depends on the
optical power and typically ranges from 100 ns to 1 µs. For
NV centers, the initialization pulse must be followed by a
waiting time, typically 1 µs, to allow relaxation of popu-
lation trapped in the singlet state towards the ground state
|ms = 0(cid:105)137. The characteristic polarization time also impacts
the readout phase. Depending on the time resolution of the
hardware (see Sec. II A 4 and III A), it can be convenient to
reduce the laser power, to polarize the spin slower and be able
to resolve it dynamics as in Fig. 13. The duration of the optical
pulse needs to be adjusted accordingly.

In the case of ‘Synchronization method 1’ (see Sec. III D)
in which only the beginning and the end of a sequence is trig-
gered, it is necessary to locate each pulse within the entire
recorded optical signal. In this case, two standard approaches
are implemented in Qudi for pulse recognition. The ﬁrst uses
a threshold value to identify rising and falling edges of a pulse.

(a)(b)(c)(d)ContrastΩ𝑅/2𝜋(MHz)Ω𝑅/2𝜋(MHz)ContrastLaser power(mW)Laser power(mW)20

FIG. 13. Normalized luminescence intensity during the readout laser
pulse, for spins initialized in state |0(cid:105) (blue curve) and |1(cid:105) (orange,
using a π pulse between optical pumping and readout), collected with
NA 0.65 objective and 35 mW incident laser power. The shaded gray
region indicates a good choice of time window for signal integration,
yielding high SNR.

The second relies on a convolution of the signal with a Gaus-
sian distribution and takes its ﬁrst derivative, resulting in a
pulse identiﬁcation signal Sp(t) given by:

Sp(t) =

(cid:20)
Sr(t) ⊗

d
dt

1
√
2π

σ

σ )2(cid:21)
2 ( t

e− 1

(8)

where t represents the time and Sr(t) is the raw signal acquired
during the pulsed measurement; σ is the standard deviation
for Gaussian ﬁlter. Rising and falling edges of pulses corre-
spond to local maxima and minima of Sp(t). The Gaussian
ﬁlter allows to smooth the signal and reduces the possibility
for spurious pulse detection. This second method is thus gen-
erally more robust than the ﬁrst one. Optimal extraction is
achieved by adjusting the parameter σ .

Figure 13 displays the time evolution of luminescence in-
tensity during a laser pulse starting at t = 0, for spins initially
prepared either in |ms = 0(cid:105) or |ms = 1(cid:105). The different levels
of PL in the two cases and the spin polarization dynamics, are
clearly resolved. To obtain a measure of the spin projection
along the quantization axis the PL intensity is integrated over
an early time window marked as gray shaded area, and nor-
malized to the PL intensity integrated at the end of the pulse
(not represented), when spins are polarized again. It allows to
compensate possible slow ﬂuctuations of the laser intensity or
collection efﬁciency.

To maximize the signal to noise ratio, the time window
should start with the laser pulse, where the PL difference be-
tween |ms = 0(cid:105) and |ms = 1(cid:105) is maximal. If the initial time
of a pulse is not properly identiﬁed by the pulse extraction
method for all pulses in the sequence (e.g. due to slow laser
rise time), the resulting timing jitter translates into noise on
the total integrated signal. In this case excluding very early
times of the readout pulse can be beneﬁcial in this case.

Several other sources of noise can affect readout ﬁdelity.
Among them, some are spin-independent, for example due
to NV ionization and NV- recombination caused by the laser
pulse138,139. A powerful solution to suppress this kind of noise
is to repeat the pulsed protocol but inverse the spin state onto

FIG. 14. (a) Pulse protocol for optimized T1 measurement, with the
addition of a π-pulse to extract S1. (b) Bloch sphere representation
of the spin state at times of the pulse protocol indicated in (a). (c) Re-
sulting signal versus delay τ, ﬁtted with an exponential decay (solid
line)

|ms = 1(cid:105) just before readout using a π-pulse as illustrated in
Fig. 14 140. The extracted signals with and without inserted
pi pulse are labeled S1 and S0, respectively. The expectation
value of the spin state projection is linearly related to the dif-
ference signal S0 − S1 from which spin-independent common
noise is removed. The result of this procedure for a T1 mea-
surement is illustrated in Fig. 14.

Another important source of artifacts arises when the
dark time ∆T between consecutive laser pulses is swept.
As mentioned in Sec. II C it can lead to variation in laser
pulse intensities over for the entire sequence.
In most
cases, a simple solution is to keep ∆T constant, adjusting
some waiting times before and after the microwave pulses
accordingly, as long as ∆T (cid:28) T1. It is however not possible
for a T1 measurement. Fortunately, the protocol discussed just
above allows to partially mitigate such artifact by normalizing
the signal by S0 + S1. Such protocol also allows to extract a
relevant signal even when the setup temporal resolution does
not allow to resolve the pulse dynamic, e.g. when using a
camera in a wifeﬁeld conﬁguration.

A ﬁnal knob for optimization of pulsed measurements is
in the deﬁnition of π, π/2 and other pulses. The duration of
such pulses is in principle extracted from the measured period
of Rabi oscillations. However, in practice small deviations can
arise, e.g. due to not perfectly square MW pulses and ﬁtting
errors. It is thus good practice to perform a calibration step.
To this end, we use a Hahn echo sequence with ﬁxed delay and
monitor the echo amplitude for varying initial, central and ﬁ-
nal MW pulses. The result of this procedure is illustrated in
Fig. 15, where the initial and ﬁnal pulses are half the central
pulse. Every second sequence, we also replace the ﬁnal pulse
with a 3π/2-pulse, to apply the above common noise rejec-
tion strategy. The optimum pulse duration corresponds to the
simultaneous maximum echo amplitude when the ﬁnal pulse
is π/2 and minimum when it is 3π/2. This ensures maximum
contrast for a T2 measurement, using the Hahn echo sequence
(Fig. 3(d)). The calibrated π/2-pulse is also used for T ∗
2 mea-

ȁۧ0ȁۧ1Init.Readout(a)|⟩0|⟩1(b)(c)ABCABC(ms)21

of a chip-scale cryo-compatible device, with footprint below
a few square millimeters, and which embeds a d.c. supplied
MW oscillator and antenna, would be a valuable commodity
for ODMR experiments. Such devices have already been de-
veloped in the context of conventional electron and nuclear
spin resonance spectroscopy141.

Regarding MW generation, voltage-controlled oscillators
(VCOs) are inexpensive and compact alternatives to high-
end MW sources, and lowering their phase noise would make
them more useful for advanced measurements. Design of MW
antennas delivering strong and homogeneous driving ﬁelds
over wide areas is still in progress.

For single-emitter ODMR, both the digital single photon
counting modules and the time tagging electronics drive the
costs of the setup higher (typically 5’000 EUR each). As a
cheaper alternative to the latter, FPGAs can be programmed
for photon counting to yield much better temporal resolution
than an NI card. An open-source package based on a com-
monly available FPGA for a do-it-yourself time tagger would
make single emitter measurements more accessible.

For generating complex,

long and low noise pulse se-
quences, NI cards reach their limits. As above, FPGA-based
open-source solutions have the potential to make such exper-
iments accessible at lower costs and with a high degree of
customization for speciﬁc needs.

ACKNOWLEDGMENTS

This project has received funding from the Swiss Na-
tional Science Foundation (grants No. PZ00P2_185824 and
PP00P2_170684), from the European Union's Horizon 2020
research and innovation programme under the Marie Skł
odowska-Curie grant agreement No 754354, and from EPFL
Interdisciplinary Seed Fund.

AUTHOR DECLARATIONS

Conﬂict of Interest

The authors declare no conﬂicts of interest.

Author Contributions

H.S and H.B. contributed equally to this work. All authors

wrote and discussed the manuscript.

DATA AVAILABILITY

The original and updated version of qudi are available on

github126,127.

1H. C. Ohanian, “What is spin?” American Journal of Physics 54, 500
(1998).

FIG. 15.
(a) Hahn echo sequence used for optimization of π and
π/2 pulses.
(c)
(b) Rabi oscillations with cosine ﬁt (solid line).
Echo amplitude versus pulse duration τp. The delay is τ = 500 ns.
Dashed line indicates the π-pulse duration extracted from ﬁt of Rabi
oscillations in (b) which appears not to be optimal.

surement using Ramsey interferometry (Fig. 3(c)).

CONCLUSIONS AND PERSPECTIVES

The preceding chapters provided an overview of currently
available hardware and open-source software for ODMR
and related hybrid MW-optical measurements. In particular,
we showed that a relatively inexpensive acquisition card
equipped with analog-to-digital converter, together with our
upgrades on the Python-based software Qudi, allow anyone
with minimal experimental skills to setup ODMR instrumen-
tation capable of implementing advanced magnetic resonance
pulse sequences and addressing individual optically-active
spin-systems or large ensembles. We believe that our work
will help foster development ODMR studies and applications
to sensing and metrology, quantum technologies, and material
science, while also making ODRM methods more accessible
to non-specialists. We encourage Qudi users to develop new
instrument modules and make them available on GitHub to
participate to wider openness and collaboration in research.
We conclude by mentioning a few envisioned directions for
both hardware and software developments in the coming
years.

As we have shown, performing ODMR at room temper-
ature without space constraints does not present signiﬁcant
hardware challenges anymore. Yet, implementing similar
measurements in conﬁned environments, in ultra-high vac-
uum or at cryogenic temperatures, can rapidly become much
more complex. This may restrict the range of quantum sensing
applications, with NV centers or other systems. While optical
excitation and collection through free space or optical ﬁber
is usually feasible in such circumstances, it can be challeng-
ing to locally provide enough MW power (without spurious
heating) and apply strong enough and precisely oriented bias
magnetic ﬁelds. Therefore, an integrated solution in the form

2232(μs)Normytisnetni .(a)(b)(c)(μs)Norm. intensity22J. P. Dowling and G. J. Milburn, “Quantum technology: the second quan-
tum revolution,” Philosophical Transactions of the Royal Society of Lon-
don. Series A: Mathematical, Physical and Engineering Sciences 361,
1655–1674 (2003).
3L. M. K. Vandersypen, H. Bluhm, J. S. Clarke, A. S. Dzurak, R. Ishihara,
A. Morello, D. J. Reilly, L. R. Schreiber, and M. Veldhorst, “Interfac-
ing spin qubits in quantum dots and donors-hot, dense, and coherent,” npj
Quantum Information 3, 1–10 (2017).
4X. Zhang, , H.-O. Li, , K. Wang, , G. Cao, , M. Xiao, , and G.-P. Guo,
“Qubits based on semiconductor quantum dots*,” Chinese Physics B 27,
020305 (2018).
5H.-C. Chang, W. W.-W. Hsiao, and M.-C. Su, “Color Centers in Dia-
mond,” Fluorescent Nanodiamonds , 37–54 (2018).
6S. Castelletto and A. Boretti, “Silicon carbide color centers for quantum
applications,” Journal of Physics: Photonics 2, 022001 (2020).
7S. Bertaina, S. Gambarelli, A. Tkachuk, I. N. Kurkin, B. Malkin,
A. Stepanov, and B. Barbara, “Rare-earth solid-state qubits,” Nature Nan-
otechnology 2, 39–42 (2007).
8L. C. Camenzind, L. Yu, P. Stano, J. D. Zimmerman, A. C. Gossard,
D. Loss,
and D. M. Zumbühl, “Hyperﬁne-phonon spin relaxation in
a single-electron GaAs quantum dot,” Nature Communications 9, 1–6
(2018).
9C. L. Degen, F. Reinhard, and P. Cappellaro, “Quantum sensing,” Reviews
of modern physics 89, 035002 (2017).

10J. H. Wesenberg, A. Ardavan, G. A. D. Briggs, J. J. Morton, R. J.
Schoelkopf, D. I. Schuster, and K. Mølmer, “Quantum computing with
an electron spin ensemble,” Physical Review Letters 103, 070502 (2009).
11S. Pezzagna and J. Meijer, “Quantum computer based on color centers in

diamond,” Applied Physics Reviews 8, 011308 (2021).

12R. Lescanne, S. Deléglise, E. Albertinale, U. Réglade, T. Capelle,
E. Ivanov, T. Jacqmin, Z. Leghtas, and E. Flurin, “Irreversible Qubit-
Photon Coupling for the Detection of Itinerant Microwave Photons,” Phys-
ical Review X 10, 021038 (2020).

13F. Dolde, V. Bergholm, Y. Wang, I. Jakobi, B. Naydenov, S. Pezzagna,
J. Meijer, F. Jelezko, P. Neumann, T. Schulte-Herbrüggen, J. Biamonte,
and J. Wrachtrup, “High-ﬁdelity spin entanglement using optimal control,”
Nature Communications 5, 1–9 (2014).

14A. Blank, E. Suhovoy, R. Halevy, L. Shtirberg, and W. Harneit, “ESR
imaging in solid phase down to sub-micron resolution: methodology
and applications,” Physical Chemistry Chemical Physics 11, 6689–6699
(2009).

15D. Suter, “Optical detection of magnetic resonance,” Magnetic Resonance

1, 115–139 (2020).

16J. Gugler, T. Astner, A. Angerer, J. Schmiedmayer, J. Majer,

and
P. Mohn, “Ab initio calculation of the spin lattice relaxation time $T_1$
for nitrogen-vacancy centers in diamond,” PHYSICAL REVIEW B 98,
214442 (2018).

17G. Balasubramanian, P. Neumann, D. Twitchen, M. Markham, R. Kolesov,
N. Mizuochi, J. Isoya, J. Achard, J. Beck, J. Tissler, V. Jacques, P. R.
Hemmer, F. Jelezko, and J. Wrachtrup, “Ultralong spin coherence time in
isotopically engineered diamond.” Nature materials 8, 383–387 (2009).
18K. Nishimura, H. Kouno, Y. Kawashima, K. Orihashi, S. Fujiwara,
K. Tateishi, T. Uesaka, N. Kimizuka, and N. Yanai, “Materials chemistry
of triplet dynamic nuclear polarization,” Chem. Commun. 56, 7217–7232
(2020).

19J. M. Binder, A. Stark, N. Tomek, J. Scheuer, F. Frank, K. D. Jahnke,
C. Müller, S. Schmitt, M. H. Metsch, T. Unden, T. Gehring, A. Huck, U. L.
Andersen, L. J. Rogers, and F. Jelezko, “Qudi: A modular python suite
for experiment control and data processing,” SoftwareX 6, 85–90 (2017).
20E. Bourgeois, M. Gulka, and M. Nesladek, “Photoelectric Detection and
Quantum Readout of Nitrogen-Vacancy Center Spin States in Diamond,”
(2020).

21T. J. Penfold, E. Gindensperger, C. Daniel, and C. M. Marian, “Spin-
Vibronic Mechanism for Intersystem Crossing,” Chemical Reviews, 118
(2018), 10.1021/acs.chemrev.7b00617.

22C. M. Marian, “Spin-orbit coupling and intersystem crossing in
molecules,” Wiley Interdisciplinary Reviews: Computational Molecular
Science 2, 187–203 (2012).

23D. Carbonera, “Optically detected magnetic resonance (odmr) of photoex-

cited triplet states,” Photosynthesis research 102, 403–414 (2009).

22

24Kwiram, Alvin L., “Optical detection of paramagnetic resonance in phos-
phorescent triplet states,” Chemical Physics Letters 1, 272–275 (1967).

25J. Schmidt, I. A. Hesselmann, M. S. De Groot,

and J. H. Van der
Waals, “Optical detection of electron resonance transitions in phospho-
rescent quinoxaline,” Chemical Physics Letters 1 (1967), 10.1016/0009-
2614(67)85066-8.

26M. Sharnoff, “ESR-Produced Modulation of Triplet Phosphorescence,”

The Journal of Chemical Physics 46, 3263 (2004).

27G. Giacometti, G. Agostini, S. Santabarbara, and D. Carbonera, “Odmr
spectroscopy of molecular functions in photosynthetic membrane pro-
teins,” Applied Magnetic Resonance 31, 179–191 (2007).

28A. Kwiram and J. Ross, “Optical detection of magnetic resonance in bi-
ologically important molecules,” Annual Review of Biophysics and Bio-
engineering 11, 223–249 (1982).

29J. Wrachtrup, C. v. Borczyskowski, J. Bernard, M. Orrit, and R. Brown,
“Optically detected spin coherence of single molecules,” Physical Review
Letters 71, 3565 (1993).

30J. Köhler, J. A. J. M. Disselhorst, M. C. J. M. Donckers, E. J. J. Groenen,
J. Schmidt, and W. E. Moerner, “Magnetic resonance of a single molecular
spin,” Nature 1993 363:6426 363, 242–244 (1993).

31D. M. Arroo, N. M. N. Alford, and J. D. Breeze, “Perspective on room-
temperature solid-state masers,” Applied Physics Letters 119, 140502
(2021).

32M. Oxborrow, J. D. Breeze, and N. M. Alford, “Room-temperature solid-

state maser,” Nature 2012 488:7411 488, 353–356 (2012).

33H. Wu, S. Mirkhanov, W. Ng, and M. Oxborrow, “Bench-Top Cooling of a
Microwave Mode Using an Optically Pumped Spin Refrigerator,” Physical
Review Letters 127, 053604 (2021).

34A. Gruber, A. Dräbenstedt, C. Tietz, L. Fleury, J. Wrachtrup, and C. V.
Borczyskowski, “Scanning Confocal Optical Microscopy and Magnetic
Resonance on Single Defect Centers,” Science 276, 2012–2014 (1997).
35G. Q. Liu, X. Feng, N. Wang, Q. Li, and R. B. Liu, “Coherent quantum
control of nitrogen-vacancy center spins near 1000 kelvin,” Nature Com-
munications 2019 10:1 10, 1–8 (2019).

36M. Chipaux, K. J. v. d. Laan, S. R. Hemelaar, M. Hasani, T. Zheng, and
R. Schirhagl, “Nanodiamonds and Their Applications in Cells,” Small 14,
1704263 (2018).

37S. Haziza, N. Mohan, Y. Loe-Mie, A. M. Lepagnol-Bestel, S. Massou,
M. P. Adam, X. L. Le, J. Viard, C. Plancon, R. Daudin, P. Koebel, E. Do-
rard, C. Rose, F. J. Hsieh, C. C. Wu, B. Potier, Y. Herault, C. Sala,
A. Corvin, B. Allinquant, H. C. Chang, F. Treussart, and M. Simon-
neau, “Fluorescent nanodiamond tracking reveals intraneuronal transport
abnormalities induced by brain-disease-related genetic risk factors,” Na-
ture Nanotechnology 12 (2017), 10.1038/nnano.2016.260.

38S. Hemelaar, P. De Boer, M. Chipaux, W. Zuidema, T. Hamoh, F. P. Mar-
tinez, A. Nagl, J. Hoogenboom, B. Giepmans, and R. Schirhagl, “Nanodi-
amonds as multi-purpose labels for microscopy,” Scientiﬁc reports 7, 1–9
(2017).

39B. S. Miller, L. Bezinge, H. D. Gliddon, D. Huang, G. Dold, E. R. Gray,
J. Heaney, P. J. Dobson, E. Nastouli, J. J. Morton, et al., “Spin-enhanced
nanodiamond biosensing for ultrasensitive diagnostics,” Nature 587, 588–
593 (2020).

40A. Morita, A. C. Nusantara, F. P. P. Martinez, T. Hamoh, V. G. Damle,
K. J. van der Laan, A. Sigaeva, T. Vedelaar, M. Chang, M. Chipaux, and
R. Schirhagl, “Quantum monitoring the metabolism of individual yeast
mutant strain cells when aged, stressed or treated with antioxidant,”
(2020).

41T. Zhang, G. Pramanik, K. Zhang, M. Gulka, L. Wang, J. Jing, F. Xu, Z. Li,
Q. Wei, P. Cigler, et al., “Toward quantitative bio-sensing with nitrogen–
vacancy center in diamond,” ACS sensors 6, 2077–2107 (2021).

42J. F. Barry, J. M. Schloss, E. Bauch, M. J. Turner, C. A. Hart, L. M. Pham,
and R. L. Walsworth, “Sensitivity optimization for NV-diamond magne-
tometry,” Reviews of Modern Physics 92, 15004 (2020).

43R. Schirhagl, K. Chang, M. Loretz, and C. L. Degen, “Nitrogen-vacancy
centers in diamond: nanoscale sensors for physics and biology,” Annual
review of physical chemistry 65, 83–105 (2014).

44L. Rondin, J.-P. Tetienne, T. Hingant, J.-F. Roch, P. Maletinsky,

and
V. Jacques, “Magnetometry with nitrogen-vacancy defects in diamond,”
Reports on progress in physics 77, 056503 (2014).

45L. Shao, R. Liu, M. Zhang, A. V. Shneidman, X. Audier, M. Markham,
and M. Lonˇcar, “Wide-
H. Dhillon, D. J. Twitchen, Y.-F. Xiao,
Field Optical Microscopy of Microwave Fields Using Nitrogen-
Vacancy Centers in Diamonds,” Advanced Optical Materials
(2016),
10.1002/adom.201600039.

46M. Chipaux, L. Toraille, C. Larat, L. Morvan, S. Pezzagna, J. Meijer, and
T. Debuisschert, “Wide bandwidth instantaneous radio frequency spectrum
analyzer based on nitrogen vacancy centers in diamond,” Applied Physics
Letters 107, 233502 (2015).

47J. Meinel, V. Vorobyov, B. Yavkin, D. Dasari, H. Sumiya, S. Onoda,
J. Isoya, and J. Wrachtrup, “Heterodyne sensing of microwaves with a
quantum sensor,” Nature Communications 2021 12:1 12, 1–8 (2021).
48A. J. Healey, L. T. Hall, G. A. L. White, T. Teraji, M.-A. Sani, F. Separovic,
J.-P. Tetienne, and L. C. L. Hollenberg, “Polarization Transfer to External
Nuclear Spins Using Ensembles of Nitrogen-Vacancy Centers,” Physical
Review Applied 10, 54052 (2021).

49R. Rizzato, F. Bruckmaier, K. S. Liu, S. J. Glaser, and D. B. Bucher,
“Polarization Transfer from Optically Pumped Ensembles of N-V Centers
to Multinuclear Spin Baths,” PHYSICAL REVIEW APPLIED 17, 24067
(2022).

50X. Gao, S. Vaidya, K. Li, P. Ju, B. Jiang, Z. Xu, A. E. L. Allcca, K. Shen,
T. Taniguchi, K. Watanabe, et al., “Nuclear spin polarization and control
in a van der waals material,” arXiv preprint arXiv:2203.13184 (2022).
51H. J. Mamin, M. H. Sherwood, and D. Rugar, “Detecting external electron
spins using nitrogen-vacancy centers,” Physical Review B - Condensed
Matter and Materials Physics 86, 1–8 (2012).

52T. Staudacher, F. Shi, S. Pezzagna, J. Meijer, J. Du, C. a. Meriles, F. Rein-
hard, and J. Wrachtrup, “Nuclear magnetic resonance spectroscopy on a
(5-nanometer)3 sample volume.” Science (New York, N.Y.) 339, 561–3
(2013).

53A. O. Sushkov, I. Lovchinsky, N. Chisholm, R. L. Walsworth, H. Park,
and M. D. Lukin, “Magnetic resonance detection of individual proton
spins using quantum reporters,” Physical Review Letters 113 (2014),
10.1103/PhysRevLett.113.197601.

54I. Lovchinsky, A. O. Sushkov, E. Urbach, N. P. De Leon, S. Choi,
K. De Greve, R. Evans, R. Gertner, E. Bersin, C. Muller, L. McGuin-
ness, F. Jelezko, R. L. Walsworth, H. Park, and M. D. Lukin, “Nuclear
magnetic resonance detection and spectroscopy of single proteins using
quantum logic,” Science 351, 836–841 (2016).

55C. E. Bradley, J. Randall, M. H. Abobeih, R. C. Berrevoets, M. J. Degen,
M. A. Bakker, M. Markham, D. J. Twitchen, and T. H. Taminiau, “A
Ten-Qubit Solid-State Spin Register with Quantum Memory up to One
Minute,” Physical Review X 9, 031045 (2019).

56B. Hensen, H. Bernien, A. E. Dréau, A. Reiserer, N. Kalb, M. S. Blok,
J. Ruitenberg, R. F. Vermeulen, R. N. Schouten, C. Abellán, W. Amaya,
V. Pruneri, M. W. Mitchell, M. Markham, D. J. Twitchen, D. Elkouss,
S. Wehner, T. H. Taminiau, and R. Hanson, “Loophole-free Bell inequality
violation using electron spins separated by 1.3 kilometres,” Nature 526,
682–686 (2015).

57C. Bradac, W. Gao, J. Forneris, M. E. Trusheim, and I. Aharonovich,
“Quantum nanophotonics with group iv defects in diamond,” Nature Com-
munications 10, 1–13 (2019).

58B. Pingault, D. D. Jarausch, C. Hepp, L. Klintberg, J. N. Becker,
M. Markham, C. Becher, and M. Atatüre, “Coherent control of the silicon-
vacancy spin in diamond,” Nature Communications 8 (2017), 10.1038/n-
comms15579.

59Z.-H. Zhang, P. Stevenson, G. Thiering, B. C. Rose, D. Huang, A. M.
Edmonds, M. L. Markham, S. A. Lyon, A. Gali, and N. P. De Leon, “Op-
tically Detected Magnetic Resonance in Neutral Silicon Vacancy Centers
in Diamond via Bound Exciton States,” PHYSICAL REVIEW LETTERS
125, 237402 (2020).

60P. Siyushev, M. H. Metsch, A. Ijaz, J. M. Binder, M. K. Bhaskar, D. D.
Sukachev, A. Sipahigil, R. E. Evans, C. T. Nguyen, M. D. Lukin, P. R.
Hemmer, Y. N. Palyanov, I. N. Kupriyanov, Y. M. Borzdov, L. J. Rogers,
and F. Jelezko, “Optical and microwave control of germanium-vacancy
center spins in diamond,” Physical Review B 96, 081201 (2017).

61T. Iwasaki, Y. Miyamoto, T. Taniguchi, P. Siyushev, M. H. Metsch,
F. Jelezko, and M. Hatano, “Tin-Vacancy Quantum Emitters in Diamond,”
Physical Review Letters 119 (2017), 10.1103/PhysRevLett.119.253601.

23

62R. Nagy, M. Widmann, M. Niethammer, D. B. Dasari, I. Gerhardt, Ã. O.
Soykal, M. Radulaski, T. Ohshima, J. Vuˇckovi´c, N. T. Son, I. G. Ivanov,
S. E. Economou, C. Bonato, S. Y. Lee, and J. Wrachtrup, “Quantum Prop-
erties of Dichroic Silicon Vacancies in Silicon Carbide,” Physical Review
Applied 9 (2018), 10.1103/PhysRevApplied.9.034022.

63F.-F. Yan, A.-L. Yi, J.-F. Wang, Q. Li, P. Yu, J.-X. Zhang, A. Gali, Y. Wang,
J.-S. Xu, X. Ou, C.-F. Li, and G.-C. Guo, “Room-temperature coherent
control of implanted defect spins in silicon carbide,” npj Quantum Infor-
mation 2020 6:1 6, 1–6 (2020).

64H. L. Stern, Q. Gu, J. Jarman, S. Eizagirre Barker, N. Mendelson,
D. Chugh, S. Schott, H. H. Tan, H. Sirringhaus, I. Aharonovich, and
M. Atatüre, “Room-temperature optically detected magnetic resonance of
single defects in hexagonal boron nitride,” Nature Communications 2022
13:1 13, 1–9 (2022).

65F. F. Murzakhanov, G. V. Mamin, S. B. Orlinskii, U. Gerstmann,
W. G. Schmidt, T. Biktagirov, I. Aharonovich, A. Gottscholl, A. Sper-
lich, V. Dyakonov,
and V. A. Soltamov, “Electron-nuclear coherent
coupling and nuclear spin readout through optically polarized vb-spin
states in hbn,” Nano Letters 22, 2718–2724 (2022), pMID: 35357842,
https://doi.org/10.1021/acs.nanolett.1c04610.

66T. Zhong and P. Goldner, “Emerging rare-earth doped material platforms

for quantum nanophotonics,” Nanophotonics 8, 2003–2015 (2019).

67M. Grimm, A. Beckert, G. Aeppli, and M. Müller, “Universal quantum
computing using electronuclear wavefunctions of rare-earth ions,” PRX
Quantum 2, 010312 (2021).

68K. Xia, R. Kolesov, Y. Wang, P. Siyushev, R. Reuter, T. Kornher,
N. Kukharchyk, A. D. Wieck, B. Villa, S. Yang, et al., “All-optical prepa-
ration of coherent dark states of a single rare earth ion spin in a crystal,”
Physical review letters 115, 093602 (2015).

69X. Zhou, H. Liu, Z. He, B. Chen, and J. Wu, “Investigation of the elec-
tronic structure and optical, epr, and odmr spectroscopic properties for
171yb3+-doped y2sio5crystal: A combined theoretical approach,” Inor-
ganic Chemistry 59 (2020), 10.1021/acs.inorgchem.0c01430.

70A. Ortu, A. Holzäpfel, J. Etesse, and M. Afzelius, “Storage of photonic
time-bin qubits for up to 20 ms in a rare-earth doped crystal,” npj Quantum
Information 8, 1–7 (2022).

71V. Y. Ivanov, T. S. Shamirzaev, D. R. Yakovlev, A. K. Gutakovskii,
L. Owczarczyk, and M. Bayer, “Optically detected magnetic resonance
of photoexcited electrons in (In,Al)As/AlAs quantum dots with indirect
band gap and type-I band alignment,” PHYSICAL REVIEW B 97, 245306
(2018).

72D. O. Tolmachev, V. Yu. Ivanov, D. R. Yakovlev, E. V. Shornikova,
Bartłomiej Witkowski, Sushant Shendre, Furkan Isik, Savas Delikani,
H. Volkan Demir,
and Manfred Bayer, “Optically detected magnetic
resonance in CdSe/CdMnS nanoplatelets,” Nanoscale 12, 21932–21939
(2020).

73A. Agostini, L. Nicol, N. Da Roit, M. Bortolus, R. Croce, and D. Carbon-
era, “Altering the exciton landscape by removal of speciﬁc chlorophylls in
monomeric LHCII provides information on the sites of triplet formation
and quenching by means of ODMR and EPR spectroscopies,” Biochimica
et Biophysica Acta (BBA) - Bioenergetics 1862, 148481 (2021).

74J. N. Becker and E. Neu, “Chapter seven - the silicon vacancy center in dia-
mond,” in Diamond for Quantum Applications Part 1, Semiconductors and
Semimetals, Vol. 103, edited by C. E. Nebel, I. Aharonovich, N. Mizuochi,
and M. Hatano (Elsevier, 2020) pp. 201–235.

75D. Chen, N. Zheludev, and W.-b. Gao, “Building blocks for quantum
network based on group-iv split-vacancy centers in diamond,” Advanced
Quantum Technologies 3, 1900069 (2020).

76a. Dréau, M. Lesik, L. Rondin, P. Spinicelli, O. Arcizet, J.-F. F. Roch, and
V. Jacques, “Avoiding power broadening in optically detected magnetic
resonance of single NV defects for enhanced dc magnetic ﬁeld sensitivity,”
Physical Review B - Condensed Matter and Materials Physics 84, 195204
(2011).

77L. M. Vandersypen and I. L. Chuang, “Nmr techniques for quantum control

and computation,” Reviews of modern physics 76, 1037 (2005).

78J.-P. Tetienne, T. Hingant, L. Rondin, A. Cavaillès, L. Mayer, G. Dantelle,
T. Gacoin, J. Wrachtrup, J.-F. Roch, and V. Jacques, “Spin relaxometry
of single nitrogen-vacancy defects in diamond nanocrystals for magnetic
noise sensing,” Physical Review B 87, 235436 (2013).

79M. Rollo, A. Finco, R. Tanos, F. Fabre, T. Devolder, I. Robert-Philip, and
V. Jacques, “Quantitative study of the response of a single nv defect in
diamond to magnetic noise,” Physical Review B 103, 235418 (2021).
80J. Barton, M. Gulka, J. Tarabek, Y. Mindarava, Z. Wang, J. Schimer,
H. Raabova, J. Bednar, M. B. Plenio, F. Jelezko, M. Nesladek,
and
P. Cigler, “Nanoscale Dynamic Readout of a Chemical Redox Process Us-
ing Radicals Coupled with Nitrogen-Vacancy Centers in Nanodiamonds,”
ACS Nano (2020), 10.1021/acsnano.0c04010.

81M. Chipaux, A. Tallaire, J. Achard, S. Pezzagna, J. Meijer, V. Jacques,
J.-F. Roch,
and T. Debuisschert, “Magnetic imaging with an ensem-
ble of nitrogen-vacancy centers in diamond,” Eur. Phys. J. D 69 (2015),
10.1140/epjd/e2015-60080-1.

82T. Wolf, P. Neumann, K. Nakamura, H. Sumiya, T. Ohshima, J. Isoya, and
J. Wrachtrup, “Subpicotesla diamond magnetometry,” Physical Review X
5, 041001 (2015).

83H. Clevenson, M. E. Trusheim, C. Teale, T. Schröder, D. Braje, and D. En-
glund, “Broadband magnetometry and temperature sensing with a light-
trapping diamond waveguide,” Nature Physics 11, 393–397 (2015).

84J. L. Webb, L. Troise, N. W. Hansen, C. Olsson, A. M. Wojciechowski,
J. Achard, O. Brinza, R. Staacke, M. Kieschnick, J. Meijer, et al., “De-
tection of biological signals from a live mammalian muscle using an early
stage diamond quantum sensor,” Scientiﬁc reports 11, 1–11 (2021).

85J. Jonkman, C. M. Brown, G. D. Wright, K. I. Anderson, and A. J. North,
“Tutorial: guidance for quantitative confocal microscopy,” Nature Proto-
cols, 15 (2020), 10.1038/s41596-020-0313-9.

86E. V. Levine, M. J. Turner, P. Kehayias, C. A. Hart, N. Langellier,
R. Trubko, D. R. Glenn, R. R. Fu, and R. L. Walsworth, “Principles and
techniques of the quantum diamond microscope,” Nanophotonics 8, 1945–
1973 (2019).

87S. Nomura, “Wide-ﬁeld imaging using ensembles of nv centers in dia-

mond,” in Hybrid Quantum Systems (Springer, 2021) pp. 27–42.

88S. C. Scholten, A. J. Healey, I. O. Robertson, G. J. Abrahams, D. A. Broad-
way, and J. P. Tetienne, “Wideﬁeld quantum microscopy with nitrogen-
vacancy centers in diamond: Strengths,
(2021).

limitations, and prospects,”

89A. M. Wojciechowski, M. Karadas, A. Huck, C. Osterkamp, S. Jankuhn,
J. Meijer, F. Jelezko, and U. L. Andersen, “Contributed review: Camera-
limits for wide-ﬁeld magnetic resonance imaging with a nitrogen-vacancy
spin sensor,” Review of Scientiﬁc Instruments 89, 031501 (2018).

90A. Kuwahata, T. Kitaizumi, K. Saichi, T. Sato, R. Igarashi, T. Ohshima,
Y. Masuyama, T. Iwasaki, M. Hatano, F. Jelezko, et al., “Magnetome-
ter with nitrogen-vacancy center in a bulk diamond for detecting mag-
netic nanoparticles in biomedical applications,” Scientiﬁc reports 10, 1–9
(2020).

91W. G. Jerome and R. L. Price, Basic confocal microscopy (Springer, 2018).
92W. W.-W. Hsiao, Y. Y. Hui, P.-C. Tsai, and H.-C. Chang, “Fluorescent
nanodiamond: a versatile tool for long-term cell tracking, super-resolution
imaging, and nanoscale temperature sensing,” Accounts of chemical re-
search 49, 400–407 (2016).

93D. Jin, P. Xi, B. Wang, L. Zhang, J. Enderlein,

and A. M. van Oi-
jen, “Nanoparticles for super-resolution microscopy and single-molecule
tracking,” Nature methods 15, 415–423 (2018).

94O. R. Opaluch, N. Oshnik, R. Nelz, and E. Neu, “Optimized planar mi-
crowave antenna for nitrogen vacancy center based sensing applications,”
Nanomaterials 11, 2108 (2021).

95K. Sasaki, Y. Monnai, S. Saijo, R. Fujita, H. Watanabe, J. Ishi-Hayase,
K. M. Itoh, and E. Abe, “Broadband, large-area microwave antenna for
optically detected magnetic resonance of nitrogen-vacancy centers in dia-
mond,” Review of Scientiﬁc Instruments 87, 053904 (2016).

96I. Aharonovich, S. Castelletto, D. Simpson, C.-H. Su, A. Greentree, and
S. Prawer, “Diamond-based single-photon emitters,” Reports on progress
in Physics 74, 076501 (2011).

97S. D. Tchernij, T. Herzig, J. Forneris, J. Kupper, S. Pezzagna, P. Traina,
E. Moreva, I. Degiovanni, G. Brida, N. Skukan, et al., “Single-photon-
emitting optical centers in diamond fabricated upon sn implantation,” ACS
photonics 4, 2580–2586 (2017).

98D. G. Monticone, K. Katamadze, P. Traina, E. Moreva, J. Forneris, I. Ruo-
Berchera, P. Olivero, I. P. Degiovanni, G. Brida, and M. Genovese, “Beat-
ing the abbe diffraction limit in confocal microscopy via nonclassical pho-
ton statistics,” Physical review letters 113, 143602 (2014).

24

99E. Abe and K. Sasaki, “Tutorial: Magnetic resonance with nitrogen-
vacancy centers in diamond-microwave engineering, materials science,
and magnetometry,” Journal of Applied Physics 123, 161101 (2018).
100J. Herrmann, M. A. Appleton, K. Sasaki, Y. Monnai, T. Teraji, K. M. Itoh,
and E. Abe, “Polarization-and frequency-tunable microwave circuit for se-
lective excitation of nitrogen-vacancy spins in diamond,” Applied Physics
Letters 109, 183111 (2016).

101K. Bayat, J. Choy, M. Farrokh Baroughi, S. Meesala, and M. Loncar,
“Efﬁcient, uniform, and large area microwave magnetic coupling to nv
centers in diamond using double split-ring resonators,” Nano letters 14,
1208–1213 (2014).

102H. Zheng, J. Xu, G. Z. Iwata, T. Lenz, J. Michl, B. Yavkin, K. Naka-
mura, H. Sumiya, T. Ohshima, J. Isoya, J. Wrachtrup, A. Wickenbrock,
and D. Budker, “Zero-Field Magnetometry Based on Nitrogen-Vacancy
Ensembles in Diamond,” 11, 1 (2019).

103F. Dolde, H. Fedder, M. W. Doherty, T. Nöbauer, F. Rempp, G. Balasubra-
manian, T. Wolf, F. Reinhard, L. C. Hollenberg, F. Jelezko, et al., “Electric-
ﬁeld sensing using single diamond spins,” Nature Physics 7, 459–463
(2011).

104J. Michl, J. Steiner, A. Denisenko, A. Bülau, A. Zimmermann, K. Naka-
mura, H. Sumiya, S. Onoda, P. Neumann, J. Isoya, et al., “Robust and
accurate electric ﬁeld sensing with solid state spin ensembles,” Nano let-
ters 19, 4904–4910 (2019).

105E. Moreva, E. Bernardi, P. Traina, A. Sosso, S. D. Tchernij, J. Forneris,
F. Picollo, G. Brida, Ž. Pastuovi´c, I. Degiovanni, et al., “Practical appli-
cations of quantum sensing: A simple method to enhance the sensitivity
of nitrogen-vacancy-based temperature sensors,” Physical Review Applied
13, 054057 (2020).

106H. Kraus, V. Soltamov, F. Fuchs, D. Simin, A. Sperlich, P. Baranov,
G. Astakhov, and V. Dyakonov, “Magnetic ﬁeld and temperature sens-
ing with atomic-scale spin defects in silicon carbide,” Scientiﬁc reports 4,
1–8 (2014).

107V. Ivády, H. Zheng, A. Wickenbrock, L. Bougas, G. Chatzidrosos,
K. Nakamura, H. Sumiya, T. Ohshima, J. Isoya, D. Budker, et al., “Pho-
toluminescence at the ground-state level anticrossing of the nitrogen-
vacancy center in diamond: A comprehensive study,” Physical Review B
103, 035307 (2021).

108D. A. Broadway, J. D. Wood, L. T. Hall, A. Stacey, M. Markham, D. A.
Simpson, J.-P. Tetienne, and L. C. Hollenberg, “Anticrossing spin dy-
namics of diamond nitrogen-vacancy centers and all-optical low-frequency
magnetometry,” Physical Review Applied 6, 064001 (2016).

109R. Lazda, L. Busaite, A. Berzins, J. Smits, F. Gahbauer, M. Auzinsh,
D. Budker, and R. Ferber, “Cross-relaxation studies with optically de-
tected magnetic resonances in nitrogen-vacancy centers in diamond in ex-
ternal magnetic ﬁeld,” Physical Review B 103, 134104 (2021).

110A. Wickenbrock, H. Zheng, L. Bougas, N. Leefer, S. Afach, A. Jar-
mola, V. M. Acosta,
and D. Budker, “Microwave-free magnetometry
with nitrogen-vacancy centers in diamond,” Applied Physics Letters 109,
053505 (2016).

111V. Jacques, P. Neumann, J. Beck, M. Markham, D. Twitchen, J. Mei-
jer, F. Kaiser, G. Balasubramanian, F. Jelezko, and J. Wrachtrup, “Dy-
namic polarization of single nuclear spins by optical pumping of nitrogen-
vacancy color centers in diamond at room temperature,” Physical review
letters 102, 057403 (2009).

112E. Bauch, C. A. Hart, J. M. Schloss, M. J. Turner, J. F. Barry, P. Ke-
hayias, S. Singh, and R. L. Walsworth, “Ultralong dephasing times in
solid-state spin ensembles via quantum control,” Physical Review X 8,
031025 (2018).

113C. A. Hart, J. M. Schloss, M. J. Turner, P. J. Scheidegger, E. Bauch,
and R. L. Walsworth, “N-v–diamond magnetic microscopy using a double
quantum 4-ramsey protocol,” Physical Review Applied 15, 044020 (2021).
114J. Choi, “Quantum many-body dynamics of a disordered electronic spin

ensemble in diamond,” (2019).

115C. Zhang, H. Yuan, N. Zhang, L. Xu, J. Zhang, B. Li, and J. Fang, “Vec-
tor magnetometer based on synchronous manipulation of nitrogen-vacancy
centers in all crystal directions,” Journal of Physics D: Applied Physics 51,
155102 (2018).

116M. Crosser, S. Scott, A. Clark, and P. Wilt, “On the magnetic ﬁeld near
the center of helmholtz coils,” Review of Scientiﬁc Instruments 81, 084701
(2010).

117B. Yang, T. Murooka, K. Mizuno, K. Kim, H. Kato, T. Makino, M. Ogura,
S. Yamasaki, M. E. Schmidt, H. Mizuta, et al., “Vector electrometry in a
wide-gap-semiconductor device using a spin-ensemble quantum sensor,”
Physical Review Applied 14, 044049 (2020).

118J. L. Webb, L. Troise, N. W. Hansen, J. Achard, O. Brinza, R. Staacke,
M. Kieschnick, J. Meijer, J.-F. Perrier, K. Berg-Sørensen, et al., “Opti-
mization of a diamond nitrogen vacancy centre magnetometer for sensing
of biological signals,” Frontiers in Physics 8, 430 (2020).

119F. M. Stürner, A. Brenneis, T. Buck, J. Kassel, R. Rölver, T. Fuchs, A. Sav-
itsky, D. Suter, J. Grimmel, S. Hengesbach, et al., “Integrated and portable
magnetometer based on nitrogen-vacancy ensembles in diamond,” Ad-
vanced Quantum Technologies 4, 2000111 (2021).

120G. R. Mirams, C. J. Arthurs, M. O. Bernabeu, R. Bordas, J. Cooper,
A. Corrias, Y. Davit, S.-J. Dunn, A. G. Fletcher, D. G. Harvey, et al.,
“Chaste: an open source c++ library for computational physiology and
biology,” PLoS computational biology 9, e1002970 (2013).

121D.-S. Cao, Q.-S. Xu, Q.-N. Hu, and Y.-Z. Liang, “Chemopy: freely avail-
able python package for computational biology and chemoinformatics,”
Bioinformatics 29, 1092–1094 (2013).

122B. Chapman and J. Chang, “Biopython: Python tools for computational

biology,” ACM Sigbio Newsletter 20, 15–19 (2000).

123L. Prechelt, “An empirical comparison of seven programming languages,”

Computer 33, 23–29 (2000).

124R. Bitter, T. Mohiuddin, and M. Nawrocki, LabVIEW: Advanced program-

ming techniques (Crc Press, 2006).

125M. H. Cahn and M. F. Russo, “Python and automated laboratory system
control,” JALA: Journal of the Association for Laboratory Automation 12,
46–55 (2007).

126“Qudi original github,” https://github.com/Ulm-IQO/qudi.
127“Qudi

new version,”

https://github.com/

the

for
github
QexSoftware/qudi.

128L. P. McGuinness, Y. Yan, A. Stacey, D. A. Simpson, L. T. Hall,
D. Maclaurin, S. Prawer, P. Mulvaney, J. Wrachtrup, F. Caruso, and oth-
ers, “Quantum measurement and orientation tracking of ﬂuorescent nan-
odiamonds inside living cells,” Nature nanotechnology 6, 358–363 (2011).
129A. Sigaeva, A. Hochstetter, S. Bouyim, M. Chipaux, M. Stejfova, P. Cigler,
and R. Schirhagl, “Single-particle tracking and trajectory analysis of ﬂuo-
rescent nanodiamonds in cell-free environment and live cells,” with Small
(2022), 1.

25

130“Signals and slots in qt documentation,” https://doc.qt.io/qt-5/

signalsandslots.html.

131“Qudi

installation,”

https://ulm-iqo.github.io/

qudi-generated-docs/html-docs/installation.html.

132“Conda

environments

in conda documentation,” https://docs.

conda.io/projects/conda/en/latest/user-guide/concepts/
environments.html.

133B. J. Maertz, A. P. Wijnheijmer, G. D. Fuchs, M. E. Nowakowski, and
D. D. Awschalom, “Vector magnetic ﬁeld microscopy using nitrogen va-
cancy centers in diamond,” Applied Physics Letters 96, 092504 (2010),
https://doi.org/10.1063/1.3337096.

134T. Lenz, A. Wickenbrock, F. Jelezko, G. Balasubramanian, and D. Budker,
“Magnetic sensing at zero ﬁeld with a single nitrogen-vacancy center,”
Quantum Science and Technology 6, 034006 (2021).

135N. Wang, C.-F. Liu, J.-W. Fan, X. Feng, W.-H. Leong, A. Finkler,
A. Denisenko, J. Wrachtrup, Q. Li, and R.-B. Liu, “Zero-ﬁeld magnetom-
etry using hyperﬁne-biased nitrogen-vacancy centers near diamond sur-
faces,” Phys. Rev. Research 4, 013098 (2022).

136K. Jensen, V. Acosta, A. Jarmola,

and D. Budker, “Light narrowing
of magnetic resonances in ensembles of nitrogen-vacancy centers in di-
amond,” Physical Review B 87, 014115 (2013).

137L. Robledo, H. Bernien, T. Van Der Sar, and R. Hanson, “Spin dynamics
in the optical cycle of single nitrogen-vacancy centres in diamond,” New
Journal of Physics 13, 025013 (2011).

138N. Aslam, G. Waldherr, P. Neumann, F. Jelezko, and J. Wrachtrup, “Photo-
induced ionization dynamics of the nitrogen vacancy defect in diamond
investigated by single-shot charge state detection,” New Journal of Physics
15, 013064 (2013).

139R. Giri, F. Gorrini, C. Dorigoni, C. E. Avalos, M. Cazzanelli, S. Tambalo,
and A. Bifone, “Coupled charge and spin dynamics in high-density ensem-
bles of nitrogen-vacancy centers in diamond,” Phys. Rev. B 98, 045401
(2018).

140A. Jarmola, V. Acosta, K. Jensen, S. Chemerisov,

and D. Budker,
“Temperature-and magnetic-ﬁeld-dependent longitudinal spin relaxation
in nitrogen-vacancy ensembles in diamond,” Physical review letters 108,
197601 (2012).

141A. V. Matheoud, N. Sahin, and G. Boero, “A single chip electron spin
resonance detector based on a single high electron mobility transistor,”
Journal of Magnetic Resonance 294, 59–70 (2018).

