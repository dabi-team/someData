Integrated Home Care Staﬃng and Capacity Planning: Stochastic
Optimization Approaches

Ridong Wanga,, Karmel S. Shehadehb,, Xiaolei Xiea,, Lefei Lia,

aDepartment of Industrial Engineering, Tsinghua University, Beijing, China
bDepartment of Industrial and Systems Engineering, Lehigh University, Bethlehem, PA, USA

2
2
0
2

r
a

M
8
2

]

C
O
.
h
t
a
m

[

1
v
0
3
4
4
1
.
3
0
2
2
:
v
i
X
r
a

Abstract

We propose stochastic optimization methodologies for a staﬃng and capacity planning problem

arising from home care practice. Speciﬁcally, we consider the perspective of a home care

agency that must decide the number of caregivers to hire (staﬃng) and the allocation of hired

caregivers to diﬀerent types of services (capacity planning) in each day within a speciﬁed

planning horizon. The objective is to minimize the total cost associated with staﬃng (i.e.,

employment), capacity allocation, over-staﬃng, and under-staﬃng. We propose two-stage

stochastic programming (SP) and distributionally robust optimization (DRO) approaches to

model and solve this problem considering two types of decision-makers, namely an everything in

advance decision-maker (EA) and a ﬂexible adjustment decision-maker (FA). In the EA models,

we determine the staﬃng and capacity allocation decisions in the ﬁrst stage before observing

the demand. In the FA models, we decide the staﬃng decisions in the ﬁrst stage. Then, we

determine the capacity allocation decisions based on demand realizations in the second stage.

We derive equivalent mixed-integer linear programming (MILP) reformulations of the proposed

nonlinear DRO model for the EA decision-maker that can be implemented and eﬃciently solved

using oﬀ-the-shelf optimization software. We propose a computationally eﬃcient column-and-

constraint generation algorithm with valid inequalities to solve the proposed DRO model for

the FA decision-maker. Finally, we conduct extensive numerical experiments comparing the

operational and computational performance of the proposed approaches and discuss insights

and implications for home care staﬃng and capacity planning.

Keywords: OR in service industries, staﬃng and capacity planning, uncertainty, integer

programming, stochastic optimization

1. Introduction

Home care is the provision of providing services to people at their homes, such as nursing,

wound treatment, personal care assistance, and lifestyle support for the elderly. Home care

can improve the quality of life for customers, especially elderly customers, as caregivers meet

Preprint submitted to arXiv

March 29, 2022

 
 
 
 
 
 
their needs at their homes. Moreover, it leads to cost-saving for the entire health system by

mitigating the need for hospitalization, among others (Lanzarone & Matta, 2014; Restrepo

et al., 2020). The home care service industry has been rapidly growing worldwide due to

the aging population, outspread of chronic and infectious diseases, emergent changes in family

structures, work obligations, and extended work hours. In particular, COVID-19 pandemic has

led to unprecedented increases in the demand for home healthcare, in particular to support

vulnerable and high-risk populations. In Canada, it’s estimated that the number of Canadians

with home care needs will increase by 615,479 to just over 1.7 million by 2031 (Deloitte, 2021).
As pointed out by Zhan et al. (2021), the United States spends about $82 billion on various
forms of home healthcare services and $300 billion on home repairs and maintenance, and these

numbers are rapidly growing. In 2018, the global home service market was valued at around
$282 billion and is expected to reach $1133.4 billion by 2026 (Tsang & Shehadeh, 2021).

The demand for home care is associated with increased demand for cross-trained caregivers

who can provide multiple service types. Poo (2021) shows that the demand for home care

will create more than one million new home care jobs. Unfortunately, however, the home care

industry faces a signiﬁcant shortage of caregivers.

In addition, Washington (2018) recently

reported that labor shortages would worsen in the next twenty years in Washington State.

The state estimates that nearly 77,000 additional home care aides will be needed to by 2030.

When the high turnover rate is taken into account, the number of additional home care aides

needed surges to 125,000.

The increase in demand for home care is also associated with an increase in service costs.

According to the newly released Genworth cost of care survey (Genworth, 2022), the cost of

home health aides, who provide personal assistance with activities such as bathing, dressing

and eating, grew by 12.5 % in 2020. Accordingly, the development of computationally eﬃcient

optimization tools for homecare staﬃng and capacity allocation is essential to support decision-

making in all areas of the home care industry to meet the growing demand, improve service

quality, and reduce costs.

In this paper, we propose stochastic optimization methodologies for a staﬃng and capacity

planning problem arising from home care practice. Speciﬁcally, we consider the perspective of a

home care agency that must decide the number of (cross-trained ) caregivers to hire (staﬃng)

within a speciﬁed planning horizon and the allocation of hired caregivers to diﬀerent types

of services in each day in the planning horizon (capacity allocation). Customers demand

and durations for diﬀerent types of services are random. The distribution of these random

parameters may be unknown. The objective is to ﬁnd employment/staﬃng and capacity

allocation decisions that minimize total employment cost, capacity allocation cost, and penalty

cost for daily over-staﬃng and under-staﬃng. We call this problem the home care staﬃng and

2

capacity planning (HSCP ) problem.

Unfortunately, the HSCP problem is a challenging stochastic optimization problem for sev-

eral reasons. First, it is a complex combinatorial optimization problem that requires deciding

the number of diﬀerent (cross-trained) caregivers to be hired and allocating (i.e., assigning)

the capacity of hired caregivers to diﬀerent types of services simultaneously. Second, there is

signiﬁcant variability in demand for home care services and service duration. In addition, our

analysis of real-life data from a home care service provider suggest that there is a wide range of

possible probability distributions for modeling the variability in the demand, indicating distri-

butional ambiguity, i.e., uncertainty in probability distribution (see this analysis in Section 2).

Such uncertainty and distributional ambiguity increase the complexity of modeling and solving

the HSCP problem. However, ignoring uncertainty may lead to sub-optimal decisions and the

inability to meet customer demand and high costs, among other disappointing consequences

of adopting deterministic solutions. Failure to meet customer demand, in particular, may lead

to adverse outcomes, especially in healthcare, as it impacts population health. It also impacts

customers’ satisfaction and thus the reputation of the home service providers.

Motivated by these important issues and motivated by our collaboration with a home service

provider in Beijing, in this paper, we propose new stochastic optimization approaches for

modeling and solving the HSCP problem under uncertainty. Speciﬁcally, given sets of service

types, days in the planning horizon, and caregivers and their types (i.e., training), our models

solves the following decisions problems simultaneously (a) a staﬃng problem that determines

the number of caregivers to hire within the planning horizon, and (b) an allocation problem

that determines the allocation of caregivers capacities (i.e., daily service hours) to service

types during the planning horizon. We consider two types of decision-makers: Everything

in Advance (EA) and Flexible Adjustment (FA) decision-makers. The (EA) decision-maker

decides the number of caregivers to hire and their daily capacity allocation to service types

at the start of the planning horizon before the demand and service time are realized.

In

contrast, the (FA) decision-maker decides the number of caregivers to hire at the beginning

of the planning horizon. Then, s/he allocates the hired caregivers to service types once the

demand is realized.

To address uncertainty, we propose and analyze two-stage stochastic programming (SP)

and distributionally robust optimization (DRO) models for both decision-makers, assuming

known and ambiguous distribution, respectively. We obtain near-optimal solutions of our SP

models using sample average approximation (SAA). We derive a mixed-integer linear program-

ming (MILP) reformulation of our proposed DRO model for the (EA) decision-maker that can

be implemented and eﬃciently solved using oﬀ-the-shelf optimization software. We propose

a computationally eﬃcient column-and-constraint generation (C&CG) method to solve our

3

proposed DRO model for the (FA) decision-maker. In addition, we derive valid inequalities to

accelerate the C&CG convergence.

We conduct extensive computational experiments comparing the proposed methodologies’

computational and operational performances demonstrating where signiﬁcant performance im-

provements can be gained. Additionally, we derive several managerial insights relevant to

practice. To the best of our knowledge, and according to our literature review in Section 3,

our paper is the ﬁrst to propose stochastic optimization models and methods to model and

solve the HSCP problem under uncertainty considering both (EA) and (FA) decision-makers.

The remainder of this paper is organized as follows. In Section 2, we present a motivating

example for modeling uncertainty and distributional ambiguity. In Section 3, we review the

relevant literature. In Section 4 we formally deﬁne the HSCP problem. In Sections 5-6, we

present our proposed SP and DRO models. In Section 7, we present our C&CG algorithm

and strategies to speed convergence. In section 8, we present our computational results and

managerial implications. Finally, we draw conclusions and discuss future directions in Section

9.

2. Motivations

This paper is based on our research with Pinetree Care, one of China’s leading home care

agencies. Pinetree Care provides more than 5 million care sessions to over 600,000 families

through a network of more than 10,000 caregivers. One of the main challenges that Pinetree

Care and other home care companies face when making staﬃng and capacity allocation de-

cisions is the uncertainty in service demand and duration. To analyze this uncertainty, we

use data from Pinetree Care collected electronically from June 2017 through December 2019,

representing ∼205 K care sessions in Beijing.

In the top panel of Figure 1, we present the empirical and ﬁtted probability distributions

for actual demands for rehabilitation nursing and health status assessment, and in Appendix

A we present the associated the goodness-of-ﬁt metrics (e.g., Negative of the Log-Likelihood

(NLogL), Akaike Information Criterion (AIC), and Bayesian Information Criterion (BIC)). In

the bottom panel of Figure 1, we present demand distributions during the fourth quarter of

2017 and the fourth quarter of 2018.

We make the following observations from these results. First, Figures 1a-1b show signiﬁcant

variability in demand for the same service type and across service types. Furthermore, these

ﬁgures, along with goodness-of-ﬁt metrics, demonstrate that a wide range of distributions

can represent uncertainty in demand, suggesting distributional ambiguity (i.e,. uncertainty

in distribution). Figures 1c –1d show that demand variability and distributions are quite

4

(a) Rehabilitation nursing

(b) Health status assessment

(c) Rehabilitation nursing (fourth quarter of
2017)

(d) Rehabilitation nursing (fourth quarter of
2018)

Figure 1. The empirical and ﬁtted probability distributions for actual demands.

diﬀerent between the fourth quarters of 2017 and 2018 (see also Figure A.1 in Appendix A).

Indeed, future uncertainty is often not distributed in the past. These results support prior

numerical studies that show that diﬀerent distributions can typically explain raw data of

uncertain parameters, indicating distributional ambiguity. Finally, these results motivate us

to adopt a DRO approach to obtain robust decisions that could hedge against distributional

ambiguity.

3. Literature Review

Operations research in home care service can be divide into three decision levels: strategical

level, tactical level and operational level (Restrepo et al., 2020).

In this section, we focus

primarily on the literature in tactical level which our problem lies in, i.e., papers that apply

stochastic optimization to address HSCP problems similar to ours. For comprehensive recent

surveys of operations research methods applied to decisions in home health care, we refer

readers to Guti´errez & Vidal (2013), Fikar & Hirsch (2017), Grieco et al. (2021) and Di Mascolo

et al. (2021). We also refer to Michael (2018) for a comprehensive survey of scheduling theory,

applications and methods.

5

100200300400500600Daily Demand00.01Probability Densityempiricalgeneralized extreme valueloglogisticlognormalbirnbaumsaundersinverse gaussiangamma121416182022242628Daily Demand00.10.20.3Probability Densityempiricalgeneralized paretogeneralized extreme valueinverse gaussianbirnbaumsaunderslognormalloglogistic140160180200220240260Daily Demand00.010.020.03Probability Densityempiricalgeneralized extreme valueweibullextreme valuenakagamiriciannormal300400500600Daily Demand00.010.02Probability Densityempiricalgeneralized extreme valueextreme valuetlocationscaleweibulllogisticnormalExisting stochastic home care service staﬃng and capacity planning models often consider

the demand uncertainty only. SP approaches for HSCP include Rodriguez et al. (2015), Re-

strepo et al. (2020) and Zheng et al. (2021). Rodriguez et al. (2015) proposed a two-stage

stochastic programming (SP) approach to solve the staﬀ dimensioning problem in home care

services considering random demand. In their two-stage approach, the ﬁrst stage calculates

(near-)optimal levels of resources for possible demand scenarios, while the second stage com-

putes the optimal number of caregiver for each profession. Notably, Restrepo et al. (2020) is

the ﬁrst to study integrated staﬃng and scheduling problem in the context of home health-

care. They considered staﬃng and scheduling decisions in the ﬁrst stage and the temporary

reallocation of caregivers to neighboring districts in the second stage. Their study show that

the total cost presents an increase when there is less ﬂexibility associated with the allocation

of schedules.

The recent work of Zheng et al. (2021) is closely related to ours. Speciﬁcally, Zheng et al.

(2021) considered a multi-resource and multi-demand network matching problem in which they

assume deterministic service duration and that the demands of services follow a fully known

probability distribution. Accordingly, Zheng et al. (2021) proposed a two-stage stochastic

MILP which seeks the optimal service authorization and capacity planning decision in ﬁrst

stage, then the service resource allocation in the second stage.

In their model, the goal is

to maximize the total expected revenue netted by the authorization cost, payment and the

penalty cost of service shortage. However, they do not incorporate the penalty cost of over-

staﬃng in the objective, which is an important source of operational expenses (Restrepo et al.,

2020). In addition, ignoring random service duration may lead to sub-optimal solutions.

These SP models assume that the decision-makers are risk-neutral and have complete

knowledge about the underlying uncertainty through a known probability distribution (Shapiro

et al., 2014). Hence, the applicability of the SP approach is limited to the case in which the

decision-makers have suﬃcient data to model the distribution of random parameters which is

implausible in practice. Given the distributional ambiguity (see our analysis in Section 2), if

we calibrate a model to a misspeciﬁed distribution, the resulting optimal SP decisions may

have a disappointing out-of-sample performance under the true distribution which is termed

the optimizer’s curse (Smith & Winkler, 2006).

Robust optimization (RO) is alternative technique to model, analyze and optimize decisions

under uncertainty and ambiguity (where the distributions are unknown).

It assumes that

the decision maker is risk-averse and has no distributional knowledge about the underlying

uncertainty, except for its support (partial information), and the model minimizes the worst-

case cost over an uncertainty set (Ben-Tal et al., 2009). In home care service area, several

studies propose robust approaches to address the uncertainty (Carello & Lanzarone, 2014;

6

Cappanera et al., 2018; Shi et al., 2019; Cappanera & Scutell`a, 2021). Notably, Cappanera

et al. (2018) addressed uncertainty of patient demand over a multiple-day time horizon and

jointly studied the assignment, scheduling and routing decisions via a non-standard cardinality-

constrained robust approach. Shi et al. (2019) proposed a robust model for both uncertain

service and travel time and discuss the heuristic solution approaches to ﬁnd the optimal route

for each caregiver and appointment time for each patient.

Although RO is a powerful technique in dealing with uncertainty in optimization, its so-

lutions can be too conservative (Thiele, 2010; Roos & den Hertog, 2020). Additionally, RO

does not fully utilize any distributional information of uncertainty. Hence, RO may yield poor

expected performance and sub-optimal decisions for other more-likely scenarios. For compre-

hensive recent surveys of robust optimization, we refer to Bertsimas et al. (2011), Gabrel et al.

(2014) and Gorissen et al. (2015).

Distributionally robust optimization (DRO) is another approach for modeling uncertainty

that bridges the gap between the conservatism of robust optimization and the speciﬁcity of

stochastic programming (Goh & Sim, 2010). In DRO, we assume only partial distributional

information is known. Then, we model the distribution of uncertainty as a decision variable

that belongs to an ambiguity set (i.e., a family of distributions characterized through certain

known properties of the unknown data-generating distribution, Esfahani & Kuhn, 2018). Op-

timization is based on the worst-case distribution within the ambiguity set. And we can use

easy to compute information such as the mean and range of random parameters to construct

the ambiguity sets and build DRO models. We refer to Rahimian & Mehrotra (2019) for a

comprehensive survey on DRO techniques.

DRO has the following striking beneﬁts. First, it adopts a worst-case approach regularizing

the optimization problem and thereby mitigating the optimizer’s curse characteristic for SP.

Second, DRO avoids the well-known over-conservatism and the poor expected performance of

RO. Finally, DRO models are often more computationally tractable than SP and RO (Esfahani

& Kuhn, 2018). We observe that despite the potential advantages, only one study, Tsang &

Shehadeh (2021), using DRO approach to hedge against uncertainty in home care service area.

However, their study focus on the routing and appointment scheduling problem for a single-

provider. To the best of our knowledge, there is no DRO approach for the speciﬁc HSCP

problem that we address in this paper.

In this work, we develop two DRO models to consider the realistic lack of distributional

information and compare these models to SP models. We compare our work with Zheng et al.

(2021) and Restrepo et al. (2020), which are recent studies relevant to our work. First, the

three papers both address stochastic demand. However, Zheng et al. (2021) and Restrepo

et al. (2020) assumed that the service time is deterministic and do not address the potential

7

distributional ambiguity of demand which is captured by real world data (see our analysis

in Section 2). As mentioned earlier, this may lead to sub-optimal and unrealistic solutions.

In contrast to them, we extend the considered problem by incorporating uncertainty and

distributional ambiguity for demand and service duration. Second, we propose diﬀerent SP

and DRO models for two types of decision-makers (EA and FA). Third, Zheng et al. (2021)

and Restrepo et al. (2020) assumed that the caregivers have single skill. In contrast to these

papers, we consider cross-trained caregivers representing ﬂexible capacity. To the best of our

knowledge, our work is the ﬁrst to consider cross-training in the HSCP problem.

4. Problem Description

Let us now start to introduce our HSCP problem. Suppose that there is a home care

company that provides L diﬀerent types of home care services (e.g., rehabilitation nursing,

health status assessment, etc.). The decision-maker of this company wants to determine the

number of caregivers to hire within an arbitrary planning horizon of T days to provide home

care services to customers. Suppose that there are K types of caregivers to hire. Depending

on their training, skills, and qualiﬁcations, each caregiver of type k ∈ [K] := {1, 2, . . . , K}, can

provide a subset Rk ⊂ [L] of services. In addition, the daily service capacity for type k ∈ [K]
caregivers is hk. The ﬁxed cost of hiring type k caregiver is ck.

The demand, dl,t, for service type l ∈ [L] in each day t ∈ [T ] is random. Service time,
sl,t, for each service type l ∈ [L] in each day t ∈ [T ] is also random. Due to the uncertainty
of demand and service time, one or multiple of the following scenario can happen: (1) over-

staﬃng, or and, (2) under-staﬃng (i.e., failure to meet customers demand). The over-staﬃng
and under-staﬃng unitary penalty costs are respectively co
l,t, for all l ∈ [L] and t ∈ [T ].

l,t and cu

A complete listing of the problem parameters can be found in Table 1.

Given T , K, and L, our models determine the number of caregivers to hire and the capacity

of type k caregivers allocated to type l ∈ [L] in each day t ∈ [T ]. In particular, we consider

two types of decision-makers. The ﬁrst decides the number of caregivers to hire of each type

and their daily capacity allocation to service types at the beginning of the planning horizon

before the demand and service time are realized. We call this decision-maker Everything in

Advance (EA) decision-maker. The second decision-maker decides the number of caregivers

to hire before realizing the demand (i.e., at the beginning of the planning horizon). S/he then

allocates these caregivers to service types once the demand is realized. We call this decision

maker Flexible Adjustment (FA) decision-maker.

In the next sections, we propose two-stage SP and DRO models for (EA) and (FA), consid-

ering the case of known and unknown distributions of demand and service time, respectively.

8

Table 1. Notation.

index of service types, l ∈ [L]
index of days, t ∈ [T ]
index of caregivers types, k ∈ [K]

Indices
l
t
k
Parameters and sets
L
T
K
Rk
ck
ck,l,t
cu
l,t
co
l,t
w
w
hk
Scenario-dependent Parameters
dl,t
sl,t

number of service types
number of days in the planning horizon
number of caregiver types
the skills set of type k caregivers
the ﬁxed cost for hire type k full-time caregivers
the unitary service cost of type k full-time caregivers for serve type l customers in day t
the unitary penalty cost due to shortage of service capacity of type l service
the unitary penalty cost due to over-staﬃng of service capacity of type l service
the upper bound number of full-time caregivers
the lower bound number of full-time caregivers
the service capacity (service hours) of one type k full-time caregiver in one day

the demand quantity for service type l in day t
the service time for service type l of caregiver in day t

In the ﬁrst stage of the (EA) model, we decide the number of caregivers to hire from each

type k ∈ [K] and their capacity allocation to service type l ∈ [L] in each day t ∈ [T ]. And

in the second stage, after the demand and service time are realized, we compute over-staﬃng

and under-staﬃng. The objective is to minimize the total costs: ﬁxed staﬃng (or hiring) and

allocation (assignment) costs and a weighted sum of random costs related to over-staﬃng and

under-staﬃng. In the ﬁrst stage of the (FA) model, we decide the number of caregivers to hire,

and in the second stage we decide capacity allocation and compute over-staﬃng and under-

staﬃng. The objective of this model is to minimize the total costs: ﬁxed hiring cost and a

weighted sum of the random cost related to capacity allocation (assignment) cost, over-staﬃng

cost, and under staﬃng cost.
Additional notation: For a ∈ Z, we deﬁne [a] := {1, 2, ..., a}. For a, b ∈ Z, U [a; b] refers to

uniform distribution over the interval [a; b]. We use boldface notation to denote vectors, e.g.,
d := [d1, d2, ..., dN ]T . Table 1 summarizes other notations.

5. Models for the (EA) Decision-maker

5.1. Two-stage SP for (EA)

In this section, we present our proposed two-stage formulation of the HSCP problem con-

sidering the (EA) decision-maker. This model (E-SP), assumes that we know the distribution
P of uncertain parameters ξ := [d, s](cid:62). First, let us deﬁne the variables deﬁning our E-SP

model. Let integer decision variables xk represent the number of type k caregivers hired, for
all k ∈ [K]. Let continuous decision variables yk,l,t represent the capacity of type k caregivers
allocated for type l service in day t, for all k ∈ [K], l ∈ [L], t ∈ [T ]. Let continuous decision

9

variables ol,t and ul,t represent over-staﬃng and under-staﬃng for type l service in each day t,
for all l ∈ [L], t ∈ [T ]. Our E-SP model can now be stated as follows:
(cid:41)

(E-SP) min

ckxk +

(cid:40) K
(cid:88)

K
(cid:88)

L
(cid:88)

T
(cid:88)

k=1

k=1

l=1

t=1

s.t. w ≤

K
(cid:88)

k=1

xk ≤ w,

(cid:88)

yk,l,t ≤ xkhk,

l∈Rk
xk ∈ Z+, yk,l,t ∈ R+,

ck,l,tyk,l,t + EP [Q(x , y ,ξ)]

∀k ∈ [K], t ∈ [T ],

(1a)

(1b)

(1c)

∀k ∈ [K], l ∈ [L], t ∈ [T ],

(1d)

where for each feasible decision x, y and a joint realization of uncertain parameters ξ := [d, s](cid:62),

our second-stage (recourse) formulation is as follows:

Q(x , y , ξ) := min

T
(cid:88)

L
(cid:88)

(co

l,tol,t + cu

l,tul,t)

l=1

t=1
(cid:88)

yk,l,t + ul,t − ol,t = dl,tsl,t, ∀l ∈ [L], t ∈ [T ],

s.t.

(2a)

(2b)

k:l∈Rk
ol,t, ul,t ∈ R+,

∀l ∈ [L], t ∈ [T ].

(2c)

Formulation (1) seeks to ﬁnd staﬃng and allocation decisions (x, yx, yx, y) that minimize the sum

of (1) ﬁxed employment and assignment costs (ﬁrst two terms), and (2) expectation of the
second stage (recourse) random cost Q(x , y , ξ) (third term) subject to uncertainty ξ ∼ P.

The second stage recourse function minimize the random over-staﬃng (ﬁrst-term) and under-

staﬃng (second-term) costs. Constraints (1b) ensure that the total number of staﬀ is at least

w and at most w (these can be adjusted by the decision-maker depending on relevant practical

constraints). Constraints (1c) ensure that capacity allocations to service types does not exceed

the available capacity. Constraints (1d) speciﬁes feasible ranges of the decision variables.

Second stage constraint (2b) computes the over-staﬃng and under-staﬃng.

5.2. DRO model for (EA)

In this section, we present our proposed two-stage DRO formulation of the HSCP with

(EA) decision-maker, which does not assume that the probability distributions of demand and

service durations are known. We, however, assume that we know the mean and support of

these random parameters.

(Recall that these parameters can be estimated based on, e.g.,

expert knowledge, where support could represent the dispersion or range of variability that we

seek protection against). First, let us deﬁne some additional parameters, sets, and notations
deﬁning our ambiguity set and DRO model. We let µd
l,t respectively represent the
mean value of dl,t and sl,t, for all l ∈ [L] and t ∈ [T ]. The random vector ξ is a measurable

l,t and µs

10

function ξ : Ω → U with a measurable space (Ω, F), where U = U d ×U s is the bounded support
of ξ. U d and U s are respectively the support set of ddd and sss deﬁned as follows:

U d := {ddd ≥ 0 : dl,t ≤ dl,t ≤ dl,t, ∀l ∈ [L], t ∈ [T ]},
U s := {sss ≥ 0 : sl,t ≤ sl,t ≤ sl,t, ∀l ∈ [L], t ∈ [T ]}.

(3)

(4)

We deﬁne P(U) as the set of probability distributions supported on U, and EP as the
expectation under P. Finally, we donate µ := EP[ξ] = [µd, µs](cid:62). Using this notation, we

construct the following mean-support ambiguity set:
(cid:82)
U dP = 1
EP[ξ] = µ

(cid:12)
(cid:12)
P ∈ P(U)
(cid:12)
(cid:12)
(cid:12)

F(U, µ) :=

(cid:40)

(cid:41)

.

(5)

Using the ambiguity set F(U, µ), we formulate our DRO model of the HSCP with (EA)

decision-maker (denoted as E-DHSCP) as follow:

(E-DHSCP) min

(x,y)∈X

(cid:40) K
(cid:88)

ckxk +

K
(cid:88)

L
(cid:88)

T
(cid:88)

k=1

k=1

l=1

t=1

ck,l,tyk,l,t + sup

EP[Q(x , y , ξ)]

(6)

P∈F (U ,µ)

(cid:41)
,

where X := {(x, y): (1a)-(1d)} is the feasible region of ﬁrst stage decision variables. For-

mulation (6) seeks ﬁrst stage decisions x and y that minimizes the summation of ﬁxed hiring

cost (ﬁrst term), the capacity allocation cost (second term) and the worst-case (maximum)

expectations of the second-stage operational cost (third term), where the expectation is taken

over all distributions residing in F(U, µ).

5.2.1. Reformulation

Recall that Q(·) is deﬁned by a minimization problem; hence, in (6), we have an inner

max-min problem. As such, it is not straightforward to solve (6) in its presented form. In this

section, we derive an equivalent formulation of the min-max model (6) that is solvable. First,

in Proposition 1, we present an equivalent reformulation of the inner maximization problem

sup
P∈F (U ,µ)

EP[Q(x , y , ξ)] in (6) (see Appendix B for a detailed proof).

Proposition 1. For any (x, y) ∈ X , problem sup

EP[Q(x, y, ξ)] in (6) is equivalent to.

P∈F (U ,µ)

(E − DHSCP) min
α,β

(cid:40) L
(cid:88)

T
(cid:88)

l=1

t=1

µd

l,tαl,t +

L
(cid:88)

T
(cid:88)

l=1

t=1

µs

l,tβl,t

(cid:110)

Q(x, y, ξ) −

+ max
(d,s)∈U

L
(cid:88)

T
(cid:88)

l=1

t=1

(dl,tαl,t + sl,tβl,t)

(cid:111)

(cid:41)
.

(7)

Again, the problem in (7) involves an inner max-min problem that is not straightforward

to solve in its presented form. Next, we use the structural properties of the recourse Q(·) to

derive an equivalent linear programming reformulation of the inner maximization problem in

11

(7). Note that for ﬁxed x, y, ξ, Q(x , y , ξ) is a linear program (LP). The dual formulation of

Q(x , y , ξ) is as follows:

Q(x , y , ξ) = max

ρ

L
(cid:88)

T
(cid:88)

(dl,tsl,t −

(cid:88)

yk,l,t)ρl,t

(8a)

l=1
s.t. − co

t=1
l,t ≤ ρl,t ≤ cu
l,t,

k:l∈Rk

∀l ∈ [L], t ∈ [T ].

(8b)

where ρl,t is the dual variables associated with constraints (2b). In view of the dual formula-
in (7) is
t=1(dl,tαl,t + sl,tβl,t)
tion in (8), the inner problem max(d,s)∈U
equivalent to problem (9) in Proposition 2 (see Appendix C for a detailed proof).

(cid:110)
Q(x, y, ξ) − (cid:80)L

(cid:80)T

l=1

(cid:111)

Proposition 2. For ﬁxed x, y, α, and β, problem max
(d,s)∈U

is equivalent to.

(cid:110)

Q(x, y, ξ)−

L
(cid:80)
l=1

T
(cid:80)
t=1

(dl,tαl,t +sl,tβl,t)

(cid:111)

min
ηηη

s.t.

L
(cid:88)

T
(cid:88)

ηl,t

t=1
l=1
ηl,t ≥ dl,tsl,tcu

l,t −

(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(9b)

(9a)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

(9c)

(9d)

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(9e)

k:l∈Rk
(cid:88)

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(9f)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(9g)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

k:l∈Rk

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ].

(9h)

(9i)

Replacing the inner problem max
(d,s)∈U

{·} in (7) with its equivalent reformulation in (9),

then combining with the outer minimization problems in (7) and (6), we derive the following

equivalent MILP reformulation of the E-DHSCP model.

(cid:110) K
(cid:88)

min

ckxk +

K
(cid:88)

L
(cid:88)

T
(cid:88)

ck,l,tyk,l,t +

k=1

k=1

l=1

t=1

L
(cid:88)

T
(cid:88)

l=1

t=1

µd

l,tαl,t +

L
(cid:88)

T
(cid:88)

l=1

t=1

µs

l,tβl,t +

L
(cid:88)

T
(cid:88)

(cid:111)

ηl,t

l=1

t=1

s.t.

(x, y) ∈ X , α ∈ R, β ∈ R,

12

(10a)

(10b)

(9b) − (9i).

(10c)

6. Models for the (FA) Decision-maker

6.1. Two-stage SP for (FA)

In this section, we present our proposed two-stage SP formulation of the HSCP problem

considering the (FA) decision-maker. Speciﬁcally, we keep xk, ∀k ∈ [K] as ﬁrst stage decisions,
and move yk,l,t to the second-stage, for all k ∈ [K], l ∈ [L], t ∈ [T ]. In addition, we deﬁne non-
negative continuous variables ok,t representing the capacity surplus of type k ∈ [K] caregiver
in day t ∈ [T ]. This is to account scenarios where the total capacity of hired caregivers is larger

than the total realized demand. Accordingly, our F-SP model can now be stated as follows:

(F-SP) min

K
(cid:88)

k=1

ckxk + E (cid:2)QA(x , ξ)(cid:3)

s.t. w ≤

K
(cid:88)

xk ≤ w,

k=1
xk ∈ Z+,

∀k ∈ [K],

(11a)

(11b)

(11c)

where for each feasible decision x and a joint realization of uncertain parameters ξ := [d, s](cid:62),

our second-stage (recourse) formulation is as follows:

QA(x , ξ) =min

K
(cid:88)

L
(cid:88)

T
(cid:88)

ck,l,tyk,l,t +

K
(cid:88)

T
(cid:88)

k=1

t=1

co
k,tok,t+

L
(cid:88)

T
(cid:88)

l=1

t=1

cu
l,tul,t

l=1

t=1

k=1
(cid:88)

s.t.

yk,l,t + ok,t = xkhk,

∀k ∈ [K], t ∈ [T ],

l∈Rk
(cid:88)

yk,l,t + ul,t = dl,tsl,t,

∀l ∈ [L], t ∈ [T ],

(12a)

(12b)

(12c)

k:l∈Rk
yk,l,t, ok,t, ul,t ∈ R+,

∀k ∈ [K], l ∈ [L], t ∈ [T ].

(12d)

Formulation (11) seeks to ﬁnd staﬃng decisions (xxx) that minimize the sum of (1) ﬁxed

employment cost (ﬁrst term), and (2) expectation of the second stage (recourse) random cost
Q(x, ξ) (second term) subject to uncertainty ξ ∼ P. The second stage recourse function min-

imize the random assignment cost (ﬁrst-term), over-staﬃng (second-term) and under-staﬃng

(third term) costs. Constraints (12b) compute the over-staﬃng. Constraints (12c) compute

the under-staﬃng.

6.2. DRO model for (FA)

In this section, we present our proposed two-stage DRO formulation of the HSCP with

(FA) decision-maker. Using the ambiguity set F(U, µ) deﬁned in (5), we formulate our DRO

13

model of the HSCP with (FA) decision-maker (denoted as F-DHSCP) as follow:
(cid:40) K
(cid:88)

EP[QA(x , ξ)]

(cid:41)
,

(F-DHSCP) min
x∈X2

ckxk + sup

P∈F (U ,µ)

k=1

(13)

where X2 := {(11b) − (11c)} is the feasible region of ﬁrst stage decision variables. Formulation
(13) seeks the ﬁrst stage decisions x that minimize the sum of ﬁxed employment cost (ﬁrst

term) and the worst-case (maximum) expectations of the second-stage operational cost (second

term), where the expectation is taken over all distributions residing in F(U, µ).

Using the same techniques in Proposition 1, we derive the following equivalent reformulation

of the inner maximization problem supP∈F (U ,µ)

EP[QA(x , ξ)] in (13).

(F-DHSCP) min
α,β

(cid:40) T

(cid:88)

L
(cid:88)

t=1

l=1

(µd

l,tαl,t + µs

l,tβl,t) + max
(d,s)∈U

(cid:110)

QA(x, ξ) −

L
(cid:88)

T
(cid:88)

l=1

t=1

(dl,tαl,t + sl,tβl,t)

(cid:41)

(cid:111)

.

(14)

Note that it is not straightforward to solve formulation (14) in its presented form due to

the inner max-min problem. Therefore, our goal is to derive an equivalent formulation of (14)
that is solvable. As a ﬁrst step, we re-write the recourse QA(x, ξ) using its equivalent dual
formulation as (note that for ﬁxed x and ξ, QA(x, ξ) is a bounded LP):

QA(x , ξ) = max

ρ

T
(cid:88)

(cid:40) L
(cid:88)

t=1

l=1

dl,tsl,tρl,t +

(cid:41)

λk,txkhk

(cid:88)

k∈K

(15a)

s.t. ρl,t + λk,t ≤ ck,l,t,

∀t ∈ [T ], k ∈ [K], l ∈ Rk,

(15b)

ρl,t ≤ cu
l,t,
λk,t ≤ co

k,t,

∀t ∈ [T ], l ∈ [L],

∀t ∈ [T ], k ∈ [K],

(15c)

(15d)

where ρl,t and λk,t is the dual variables associated with constraints (12b) and (12c). Replacing
QA(·) in (14) with its dual formulation in (15), we derive the following equivalent reformulation

of (14).

where

(F-DHSCP) min
α,β

(cid:40) T

(cid:88)

L
(cid:88)

t=1

l=1

(µd

l,tαl,t + µs

l,tβl,t) + max
(d,s)∈U

(cid:41)

h(x, d, s, α, β)

,

(16)

h(x, d, s, α, β) := max
(ρ,λ)∈P

T
(cid:88)

(cid:40) L
(cid:88)

t=1

l=1

dl,tsl,tρl,t +

(cid:88)

k∈K

λk,txkhk −

L
(cid:88)

l=1

(cid:41)

(dl,tαl,t + sl,tβl,t)

.

(17)

P := {(15b) − (15d)} is the feasible region of variables ρ and λ. Again, the problem in

(16) is not straightforward to solve in its presented form due to the inner maximization

max
(d,s)∈U
max
(d,s)∈U

h(x, d, s, α, β). However, next, in Proposition 3, we present an equivalent MILP of

h(x, d, s, α, β) that is solvable (see Appendix D for a detailed proof).

14

Proposition 3. Let ∆dl,t = dl,t − dl,t and ∆sl,t = sl,t − sl,t, for all l ∈ [L] and t ∈ [T ]. Then,
h(x, d, s, α, β) is equivalent to solving the following MILP:
ﬁxed x, α, and β, solving max
(d,s)∈U

T
(cid:88)

(cid:40) K
(cid:88)

t=1

k=1

max
ρ,λ,g,z,
v,r,q,e

xkhkλk,t −

L
(cid:88)

l=1

[dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t + ∆sl,t zl,tβl,t]

(cid:2)dl,tsl,tρl,t + ∆sl,tdl,trl,t + ∆dl,tsl,tql,t + ∆dl,t∆sl,tel,t

(cid:3)

(cid:41)

+

L
(cid:88)

l=1

s.t.

(15b) − (15d),

ρl,t ≥ ρ

l,t

,

vl,t − gl,t ≤ 0,

vl,t ≥ 0,

vl,t − zl,t ≤ 0,

vl,t − gl,t − zl,t ≥ −1,

el,t − ρ

l,t

vl,t ≥ 0,

el,t − cu

l,tvl,t ≤ 0,

(18a)

(18b)

∀l ∈ [L], t ∈ [T ],

(18c)

∀l ∈ [L], t ∈ [T ],

(18d)

∀l ∈ [L], t ∈ [T ],

(18e)

∀l ∈ [L], t ∈ [T ],

(18f)

el,t − ρl,t + ρ

l,t

(1 − vl,t) ≤ 0,

el,t − ρl,t + cu

l,t(1 − vl,t) ≥ 0, ∀l ∈ [L], t ∈ [T ],

(18g)

ql,t − ρ

l,t

gl,t ≥ 0,

ql,t − cu

l,tgl,t ≤ 0,

∀l ∈ [L], t ∈ [T ],

(18h)

ql,t − ρl,t + ρ

l,t

(1 − gl,t) ≤ 0,

ql,t − ρl,t + cu

l,t(1 − gl,t) ≥ 0, ∀l ∈ [L], t ∈ [T ],

(18i)

rl,t − ρ

l,t

vl,t ≥ 0,

rl,t − cu

l,tvl,t ≤ 0,

∀l ∈ [L], t ∈ [T ],

(18j)

rl,t − ρl,t + ρ

l,t

(1 − vl,t) ≤ 0,

rl,t − ρl,t + cu

l,t(1 − vl,t) ≥ 0, ∀l ∈ [L], t ∈ [T ],

(18k)

gl,t, zl,t ∈ {0, 1}, vl,t, rl,t, ql,t, el,t, ρl,t ∈ R

∀l ∈ [L], t ∈ [T ].

(18l)

Note that McCormick inequalities (18f)–(18k) in formulation (18) involve big-M coeﬃcients

ρ

l,t

, for all l ∈ [L] and t ∈ [T ], that can undermine computational eﬃciency if they are set too

large. Therefore, in Proposition 4, we derive tight lower bounds (i.e., ρ

) on variables ρl,t to

l,t

strengthen the MILP reformulation (see Appendix D for a detailed proof).

Proposition 4. ρ

l,t

= min
k:l∈Rk

t ∈ [T ].

(ck,l,t − co

k,t) is a valid lower bounds on ρl,t, for all l ∈ [L] and

Replacing max
(d,s)∈U

h(x, d, s, α, β) in (16) with (18), then combining the inner problem in the

form of (17) with the outer minimization problem in the F-DHSCP model in (13), we derive

the following equivalent reformulation of the F-DHSCP model:

(F-DHSCP)

min
x∈X2,α,β

(cid:40) K
(cid:88)

k=1

T
(cid:88)

L
(cid:88)

ckxk +

(µd

l,tαl,t + µs

l,tβl,t) +

(cid:41)

T
(cid:88)

t=1

δt

(19a)

s.t.

δt ≥ max

xkhkλk,t −

ρt,λt,gt,zt,
vt,rt,qt,et

L
(cid:88)

(cid:104)

l=1

dl,tαl,t + ∆dl,tgl,tαl,t

l=1

t=1
(cid:40) K
(cid:88)

k=1

15

+ sl,tβl,t + ∆sl,tzl,tβl,t + dl,tsl,tρl,t + ∆sl,tdl,trl,t
(cid:41)

+ ∆dl,tsl,tql,t + ∆dl,t∆sl,tel,t

(cid:105)

: (18b) − (18l)

,t ∈ [T ].

(19b)

7. Solution approach

In this section, we present a Monte Carlo Optimization algorithm to obtain near-optimal

solutions to the SP models (Section 7.1), and a column-and-constraint generation (C&CG)

algorithm to solve the F-DHSCP model (Section 7.2). Note that the E-DHSCP model can be

implemented and solved directly using oﬀ-the-shelf optimization software.

7.1. Monte Carlo Optimization

Note that it is diﬃcult to obtain an exact optimal solution to the two-stage SP models in

(1) and (11). Hence, we ﬁrst present a Monte Carlo approach base on Homem-de Mello &

Bayraksan (2014), Kleywegt et al. (2002) and Shehadeh et al. (2021) to obtain near-optimal

solutions. We replace the distribution of random parameters with a empirical distribution N

independent and identically distributed (i.i.d) samples of services demands and durations at

ﬁrst and then we solve the sample average approximation (SAA) formulations of (1) and (11)

in Appendix G.

Algorithm 2 in Appendix G summarizes the Monte Carlo Optimization (MCO) algorithm.

We start with a small initial sample size. In ﬁrst step, we will solve the SAA formulation with
designated sample size N and evaluate the solution xk
N by Monte Carlo simulation with the
generated N (cid:48) random samples and record the objective value vk
N (cid:48) of Monte Carlo
simulation. We will run step 1 with K replicates. In second step, we calculate the average
of vk
N (cid:48) as vN and vN (cid:48). According to Mak et al. (1999), vN and vN (cid:48) are statistical
lower and upper bound of the optimal value of original formulation. In step 3, we calculate
the approximate optimality index as |AOIN = vN (cid:48) −vN
|. AOIN approximately estimate the
optimality gap of lower bound and upper bound of original formulation. Therefore, if AOIN is
smaller than the very small predetermined termination tolerance (cid:15) (note that (cid:15) can be zero),

N of SAA and vk

N and vk

vN (cid:48)

the algorithm will terminate and output the termination sample size N , objective value vN ,
vN (cid:48) and approximate optimality index AOIN . Otherwise, we will increase the sample size
(N ← 2N ) then go to step 1.

7.2. Column-and-constraint generation algorithm

The F-DHSCP formulation (19) involves a maximization problem in constraints (19b) and

thus we cannot solve it directly using standard techniques. In this section, we develop a C&CG

16

algorithm to solve the F-DHSCP model (19). The motivation of this algorithm is as follows.
h(x, d, s, α, β), the optimal d∗ ∈ U d would

Considering the inner maximization problem max
(d,s)∈U
only take value ddd or ddd. Similarly, the optimal s∗ ∈ U s would only take value sss or sss. Thus,

the inner maximization over (d, s) ∈ U could be taken over all the combination of ddd and sss.

However, only a few critical scenarios of d and s play a role in deriving an optimal solution

to the F-DHSCP model. As such, instead of solving a problem with exponentially many

constraints, we use C&CG to identify these scenarios and obtain an optimal solution.

Algorithm 1 presents our C&CG algorithm which is based on the original C&CG of Zeng

& Zhao (2013) and is implemented in a master-sub problem framework. The master problem

(20) employs scenario-based constraints (20d)-(20f) and the sub-problem generates demand

and service time scenarios and optimality cuts from the worst-case distribution. The algorithm

proceeds as follows. At each iteration, we ﬁrst solve the master problem, which includes only

a subset of demand and service time scenarios, and obtain the optimal solution (i.e., hiring

decisions). Thus, by considering a subset of demand and service time scenarios, the master

problem is a relaxation of the original problem and thus provides a lower bound on the optimal

value of F-DHSCP. Then, given the optimal solution from the master problem, we identify
demand d∗d∗d∗ and service time s∗s∗s∗ scenarios by solving the sub-problem. Note that solutions of

the master problem are feasible to the original problem, then by solving the sub-problem using

these solutions, we obtain an upper bound. Third, we pass the identiﬁed demand and service

time scenarios to the master problem on an as-needed basis, along with introducing relevant

second-stage variables and constraints. Then, we solve the master problem again with the new

information (a larger set of scenarios O) from the sub-problems. This process continues until

the gap between the lower and upper bound on the optimal value of the problem obtained in

each iteration satisﬁes a predetermined termination tolerance (note that we set this tolerance

to 0.02). Recall that the F-DHSCP formulation’s recourse (second-stage) problem is feasible

for every feasible ﬁrst-stage decision and ((d, s) ∈ U). Thus, we do not need to add any

feasibility cuts (Zeng & Zhao, 2013). Moreover, we only have a ﬁnite number of scenarios.

Thus, the algorithm terminates in a ﬁnite number of iterations (see Zeng & Zhao, 2013 for

detailed proofs).

7.2.1. Valid inequalities

Although C&CG theoretically provides a good way to solve our problem, it sometimes does

not perform well from a computational viewpoint. In this section, we aim to incorporate more

second-stage information into the master problem by exploiting the properties of the recourse

problem.

(1) Valid lower bound (LB) inequalities

17

Algorithm 1 Column-and-constraint generation (C&CG).
Step 1. Initialization. Set LB = 0, U B = +∞, N = 0, O = ∅
Step 2. Master Problem. Solve the following master problem:

Z = min

x,α,β,δ

(cid:40) K
(cid:88)

T
(cid:88)

L
(cid:88)

ckxk +

k=1

t=1

l=1

(µd

l,tαl,t + µs

l,tβl,t) +

(cid:41)

T
(cid:88)

t=1

δt

s.t. x ∈ X2,
K
(cid:88)

δt ≥

L
(cid:88)

k=1

l=1

ck,l,tyn

k,l,t +

K
(cid:88)

k=1

k,ton
co

k,t +

L
(cid:88)

l=1

l,tun
cu

l,t −

L
(cid:88)

l=1

(20a)

(20b)

(dt,n

l αl,t + st,n

l βl,t),∀t ∈ [T ], ∀n ∈ O,

(cid:88)

l∈Rk
(cid:88)

k,l,t + on
yn

k,t = xkhk,

∀k ∈ [K], t ∈ [T ], n ≤ N,

k,l,t + un
yn

l,t = dn

l,tsn
l,t,

∀l ∈ [L], t ∈ [T ], n ≤ N,

k:l∈Rk
k,l,t, on
yn

k,t, un

l,t ∈ R+,

∀k ∈ [K], l ∈ [L], t ∈ [T ], n ≤ N.

(20c)

(20d)

(20e)

(20f)

Record an optimal solution (x∗, α∗, β∗, δ∗) and set LB = Z ∗.
Step 3: Solve sub-problem.

3.1 With (x, α, β) ﬁxed to be (x∗, α∗, β∗), solve the following problem (21) for all t ∈ [T ].

(cid:40) K
(cid:88)

Wt = max

ρt,λt,gt,zt,
vt,rt,qt,et

k=1

xkhkλk,t −

L
(cid:88)

(cid:104)

l=1

dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t + ∆sl,tzl,tβl,t

(cid:105)

(cid:104)
dl,tsl,tρl,t + ∆sl,tdl,trl,t + ∆dl,tsl,tql,t + ∆dl,t∆sl,tel,t

(cid:105)

: (18b) − (18l)

(cid:41)
.

+

L
(cid:88)

l=1

(21)

3.2 Record the optimal solution (ρ∗
3.3 Update U B = min{U B, (cid:80)T
3.4 If U B−LB

t=1 W ∗

t , g∗

t , z∗
t , λ∗
t + (LB − (cid:80)T

t=1 δ∗

t )}.

t ) and optimal value W ∗
t .

U B ≤ ε stop and return x∗ as the optimal solution of (13); else go to step 4.

Step 4. Column-and-Constraint Generation Routine

l,t = dl,t + (dl,t − dl,t)g∗

l,t and z∗

l,t to compute sN +1

l,t = sl,t + (sl,t − sl,t)z∗
l,t,

, oN +1
k,t

, ∀k ∈ [K], l ∈ [L], t ∈ [T ], and the following constraints to the

4.1 Use g∗

l,t to compute dN +1
for all l ∈ [L] and t ∈ [T ].
k,l,t , uN +1

4.2 Add variables yN +1
master problem:

l,t

δt ≥

(cid:88)

K
(cid:88)

L
(cid:88)

k=1
l=1
yt,N +1
kl

ck,l,tyN +1

k,l,t +

K
(cid:88)

k=1

k,toN +1
co

k,t +

L
(cid:88)

l=1

l,tuN +1
cu
l,t

−

L
(cid:88)

l=1

+ ot,N +1
k

= xkhk,

l∈Rk
(cid:88)

k,l,t + uN +1
yN +1

l,t = dN +1

l,t

sN +1
l,t

,

k:l∈Rk
k,l,t , oN +1
yN +1

k,t

, uN +1

l,t ∈ R+,

update N ← N + 1, O ← O ∪ {N + 1} and go to step 2.

18

(dN +1

l,t αl,t + sN +1

l,t βl,t),

∀t ∈ [T ],

∀k ∈ [K], t ∈ [T ],

∀l ∈ [L], t ∈ [T ],

∀k ∈ [K], l ∈ [L], t ∈ [T ].

Observe that the Dirac measure on µµµ lies in F(U, µµµ). Therefore, we have

sup
P∈F (U ,µ)

EP[QA(x , ξ)] ≥ QA(x , µ) =: L,

(22)

where the lower bound is a deterministic problem with a single scenario ξξξ = µ. This means

we can impose the following constraint

δt +

L
(cid:88)

l=1

(dl,tαl,t + sl,tβl,t) ≥ L,

(23)

which serves as a global lower bound on the objective of the DRO model. Second, from

(22), for any given ﬁrst-stage decision, the recourse value with ξξξ = µ provides a lower bound.

Therefore, in the initialization step of the C&CG method, we could include the scenario ξξξ = µ.

(2) Valid upper and lower bound of variables α and β

According to the structure of (16), we propose valid upper and lower bounds on variables α

and β in Proposition 5 (see Appendix F for a detailed proof). In Section 8.4, we demonstrate

the computational advantages gained by incorporating these valid inequalities.

Proposition 5. αl,t and βl,t are respectively valid upper bound on variables αl,t and βl,t. αl,t
, deﬁned in (24), are respectively valid lower bound on variables αl,t and βl,t.
and β

l,t

αl,t = sl,tcu

l,t, αl,t = −sl,t|ρ

|,

βl,t = dl,tcu
l,t,

β

l,t

= −dl,t|ρ

l,t

|.

(24)

l,t

8. Computational experiments

In this section, we compare the computational and operational performance of the proposed

models for each decision maker and derive insights into the HSCP problem. In Section 8.1, we

describe the set of test instances that we constructed and discuss other experimental setups.

In Section 8.2, we obtain near-optimal solutions to the E-SP and F-SP via their SAA formu-

lations. In Section 8.3, we compare solution times of the proposed models. In Section 8.4, we

demonstrate eﬃciency of the proposed valid inequalities for the F-DHSCP model. In Section

8.5, we compare optimal solutions of the E-SP and E-DHSCP models and their out-of-sample

performance. Finally, we compare the optimal solutions of the F-DHSCP and F-SP models

and their out-of-sample performance in Section 8.6.

8.1. Description of Experiments

To the best of our knowledge, there are no standard benchmark instances in the literature

for the HSCP problem. Therefore, we construct 15 HSCP instances based on the same param-

eters settings and assumptions made in recent related literature (see e.g. Lanzarone & Matta,

2014; Rodriguez et al., 2015; Zhan & Wan, 2018; Zhan et al., 2021; Zheng et al., 2021). Each

19

of these instances is characterized by the number of service types (L ∈ {4, 6} as in Mankowska

et al. (2014); Rodriguez et al. (2015); Rodriguez-Verjan et al. (2018); Zheng et al. (2021)), care-

givers types (K ∈ {4, 6, 8}), days in the planning horizon T ∈ {30, 90, 180}. We summarize

these instances in Table H.1 in Appendix H.

We set the caregivers’ standard work hours hk to 480 minutes (i.e., 8 hours, see, e.g., Zhan
& Wan (2018)). We generate the monthly ﬁxed cost for employing one full-time caregivers,

ck, from U [3000, 6000] (Rodriguez-Verjan et al., 2018). We generate the quarterly and semi-
annual cost, ck, from U [9000, 18000] and U [18000, 36000], respectively. Given that multi-skills
(cross-trained) caregivers are more costly, we generated their additional monthly cost from

U [500, 1000]. To ensure that the (FA) models will allocate caregivers capacity to diﬀerent
service types, we have cu
k,t > ck,l,t for all k, l and t. This is because it is always optimal
to set yk,l,t = 0 when cu
k,t < ck,l,t.

l,t + co
l,t + co

We followed the same procedures in the stochastic scheduling, home care service, and

DRO literature to generate random parameters as follows. We generate the mean values of
the demand, µd
l,t is
generated from U [0.5, 1], for each l ∈ [L] and t ∈ [T ]. Similarly, we generate the mean service
time µs

l,t, from U [40; 60] and set the standard deviation σd

l,t, where γd

l,t from U [40; 60] and set σs

l,t, for each l ∈ [L] and t ∈ [T ].

l,t = γd

l,t = γs

l,tµd

l,tµs

For each instance, we sample N scenarios of dn

L,T , for n = 1, . . . , N , by following
lognormal (LogN) distributions with the generated µµµd and σσσd. We truncated these scenarios

1,1, . . . , dn

on basic demand range [d, d]=[40, 60] (Rodriguez et al., 2015; Rodriguez-Verjan et al., 2018).
Similarly, for each instance, we generated N scenarios of sn
L,T , for n = 1, . . . , N , by
following LogN distributions with the generated µµµs and σσσs. We truncated these scenarios

1,1, . . . , sn

on [s, s]=U[20, 80]. We round each generated parameter to the nearest integer (Tsang &

Shehadeh, 2021). We chose the LogN distribution to generate the in-sample data because it

is typically used to model service time and demand in the home care, scheduling, and other

literature (Cayirli et al., 2006; Jiang et al., 2019; Tsang & Shehadeh, 2021).

According to staﬃng standards for various types of elderly care institutions in China, the

minimum staﬀs number for serving less than 100 customers is three or ﬁve. Hence, we set

the minimum number of caregivers, w, to 3. We implement all models and solution methods

using the Python 3.8.8 programming language calling Gurobi V9.1.2 as a solver with default

settings. We ran all experiments on a computer with Intel(R) Xeon(R) E3-1231-v3 processor

with two 3.40GHz CPUs and 32 GB shared RAM memory.

8.2. Obtaining near-optimal solutions to the SP models

For each instance in Table H.1, we implemented the MCO algorithm in Section 7.1 with
No = 10, N (cid:48) = 1000 and K = 10. Table I.1 in Appendix I and Table J.1 in Appendix J present

20

the approximate optimality index (AOIN = vN (cid:48) −vN
vN (cid:48)
of the statistical lower and upper bounds (vN and vN (cid:48), receptively) on the objective values of
the E-SP and F-SP models for each instance under (cu
k,t)) = (20, 2) and truncated LogN
distribution. We observe similar results under diﬀerent choices of these cost parameters. In

) and the 95% conﬁdence intervals (95%CI)

l,t, co

l,t(co

the next section, we present and analyze the ranges of solution time of the SAA formulations.

Herein we summarize the key ﬁndings of the MCO algorithm. Clearly, N = 320 and N = 100

scenarios of the demand and service duration are suﬃcient to obtain a near-optimal solution to

the E-SP and F-SP models via their SAA formulations, respectively. First, AOIN at N = 320
and N = 100 ranges from 0 to 0.0098 and from 0 to 0.0055 for the E-SP and F-SP models,
respectively. Second, the 95%CI of vE
N ) and vE
N (cid:48)) with N = 320 (100) are very tight
(i.e., have a small variance). These results qualify vE
N as tight statistical estimates for
the lower and upper bounds on the optimal value of each instance, respectively. In addition,

N (cid:48) (vF
N and vF

N (vF

we also use truncated normal distribution and uniform distribution to generate the sample

data. We obtain similar conclusion for these distributions (see Appendix I and Appendix J).

It is worth mentioning that solving these models with larger N resulted in longer solution

times without consistent and signiﬁcant improvements in the relative approximation gaps.

However, as shown in Appendix I–Appendix J, solution times are still reasonable under

N = 500 scenarios. And the AOIN is close to the value at termination sample size.

8.3. CPU time and computational details

In this section, we analyze the solution times of the proposed SP and DRO models. In

addition to the based range of the demand described in Section 8.1, we consider another range

[40, 100], which corresponding to a higher amound of demand and variation level. For each

of the 15 instances in Table H.1 and demand range, we generated and solved 10 instances as

described in Section 8.1 for a total of 300 random instances. Then, we solved these instances

using the proposed models for each decision-maker.

Let us ﬁrst compare the computational performance of the E-SP and E-DHSCP models.

Table 2 presents the minimum (Min), average (Avg), and maximum (Max) CPU time (in

seconds) for these models. We ﬁrst observe that the computational eﬀort tend to increase

with the scale (L × K × T ). Second, both models can quickly solve all of the instances to

optimality. However, the E-DHSCP model takes a shorter time than the E-SP model to solve

each instance. These results are consistent under both ranges of the demand.

Next, we compare the solution times of the F-SP and F-DHSCP models presented in Ta-

ble 3. We make the following observations from this table. First, it is clear that solution

times of these models are much longer than the E-SP and E-DHSCP models. For example,

the average solution time of instance 15 (largest instance) using the E-SP and F-SP models

21

Table 2. CPU times in seconds for EA model

Demand range: [40, 60]

Inst

E-DHSCP

E-SP

Demand range: [40, 100]
E-SP

E-DHSCP

Min Avg Max Min Avg Max
2.4
0.1
6.8
0.3
13.5
0.7
2.5
0.1
6.8
3.7
16.0
2.5
2.3
0.1
6.8
0.3
14.0
0.7
3.0
0.1
8.9
0.5
19.4
0.9
2.8
0.1
11.4
0.4
18.6
0.9

1.8
5.9
12.1
1.9
5.9
13.3
2.1
6.4
12.5
2.8
8.7
18.1
2.7
8.5
17.8

2.1
6.2
12.8
2.2
6.3
14.4
2.1
6.6
13.0
2.9
8.8
18.6
2.7
9.1
18.1

0.1
0.3
0.8
0.1
4.0
2.8
0.1
0.3
0.7
0.1
0.5
1.0
0.1
0.4
1.0

0.1
0.4
0.9
0.2
4.4
3.2
0.1
0.4
0.9
0.2
0.5
1.0
0.2
0.5
1.0

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Table 3. CPU times in seconds for FA model

Demand range: [40, 60]

Inst

F-DHSCP

Min Avg Max Min
2.8
0.5
16.0
1.4
52.2
2.8
2.9
1.8
12.8
2.2
41.5
3.0
5.8
1.0
36.7
3.4
139.6
3.8
5.4
1.8
32.8
2.7
114.8
4.1
5.6
1.0
27.5
4.8
86.2
4.7

0.5
1.6
2.8
1.9
2.2
3.1
1.0
3.5
3.9
1.8
2.8
4.2
1.0
4.9
4.8

0.6
1.9
2.9
1.9
2.2
3.3
1.1
3.6
4.0
1.9
2.8
4.3
1.1
5.1
5.0

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

F-SP
Avg Max
3.3
3.0
21.3
17.9
61.0
55.9
3.1
3.0
13.7
13.2
45.5
43.6
6.8
6.1
45.6
41.4
159.8
148.4
5.5
5.4
43.2
35.3
141.1
127.5
6.0
5.8
30.2
28.6
94.3
90.3

Min Avg Max Min Avg Max
2.4
0.1
7.3
0.3
14.7
0.6
2.3
0.1
6.4
0.2
14.1
0.5
2.5
0.1
6.9
0.4
14.5
0.8
3.0
0.1
9.1
0.5
19.2
1.0
2.8
0.1
9.1
0.3
20.4
0.8

2.2
6.3
13.4
2.1
6.0
13.6
2.3
6.7
14.0
2.8
8.9
17.5
2.7
8.9
18.7

2.0
6.0
12.5
2.0
5.7
12.9
2.1
6.5
13.7
2.8
8.8
16.7
2.7
8.6
17.4

0.1
0.3
0.7
0.1
0.3
0.6
0.1
0.4
0.8
0.1
0.5
1.0
0.1
0.4
0.9

0.1
0.4
0.8
0.1
0.3
0.7
0.1
0.4
0.9
0.1
0.5
1.2
0.1
0.4
1.0

F-DHSCP

Demand range: [40, 100]
F-SP
Avg Max
3.3
3.0
20.7
18.3
62.4
59.3
3.4
3.3
17.2
16.0
58.1
52.6
6.2
5.5
35.6
34.3
116.5
112.2
5.4
5.3
34.6
33.7
127.3
119.2
6.5
6.2
32.9
32.1
112.3
105.0

Min Avg Max Min
2.8
0.9
16.6
1.3
55.7
4.0
3.2
1.3
15.0
5.0
48.2
40.5
5.1
1.2
31.7
3.6
104.9
69.2
5.2
1.1
32.6
1.9
111.1
4.0
6.1
0.7
31.4
8.5
101.0
10.4

0.9
1.5
4.1
1.4
5.2
41.0
1.2
3.7
70.3
1.1
2.0
4.1
0.7
8.6
10.5

1.0
1.7
4.2
1.5
5.3
42.1
1.3
3.7
71.1
1.2
2.1
4.1
0.8
8.7
10.6

under demand range [40,60] are 18.1 and 90.3 seconds, respectively. And the average solution

time of this instance using the E-DHSCP and F-DHSCP models are 1 and 4.8 seconds, respec-

tively. Since the (EA) and (FA) models have diﬀerent structures (i.e., decision variables and

objectives), these results make sense. Note that the F-SP model has a larger second stage than

the E-SP model. In addition, we solve the E-DHSCP directly using Groubi, but we employ

C&CG to solve the E-DHSCP model. Second, again the DRO model (F-DHSCP) can solve

each instance faster than the SP model (F-SP). Solution times of the F-SP and F-DHSCP

ranges from 2.8-159.8 and 0.5-71.1 seconds, respectively.

Overall, these results demonstrate the computational eﬃciency of the proposed approaches.

To conﬁrm our conclusion for the scenario-based SAA models, we solve the SAA formulations

of E-SP and F-SP models with 500 samples. We solve 6 instances with L = 6 under these

22

(a) LB values

(b) Gap values

Figure 2. Comparisons of lower bound and gap values with and without valid inequality (23)–(24)

settings and present solution times in Tables I.3 (see Appendix I) and Table J.3 (see Appendix

J). Clearly, the E-SP model can solve these instances within 30 seconds, and the F-SP model

can solve all of them within 30 minutes.

8.4. Eﬃciency of valid inequalities

In this section, we investigate the eﬃciency of the proposed valid inequalities (23)–(24)

for the E-DHSCP and C&CG in Section 7.2.1. Given that we observe similar results for all

instances, for brevity and illustrative purposes, we use Instance 15 (L = 6, K = 8, T = 180) in

this experiment. We separately solve the E-DHSCP model via C&CG with (w/) and without

(w/o) inequalities (23)–(24). We ﬁrst note the algorithm takes hundreds of iterations and a

longer time until convergence w/o inequalities (23)–(24). Therefore, in Figure 2, we present

the lower bound and gap values w/ and w/o inequalities (23)–(24) from the ﬁrst 50 iterations.

It is obvious that both the lower bound and gap values converge faster when we introduce

inequalities (23)–(24) into the master problem. Moreover, because of the better bonding eﬀect,

the algorithm converges to the optimal solution in fewer iterations and shorter solution times.

For example, the algorithm takes 531 seconds and 19 iterations to solve this instance w/

inequalities (23)–(24) and terminates at the speciﬁed time limit (i.e., 7200 seconds) with gap

99.95% w/o these inequalities.

8.5. Analysis of results of EA models

In this section, we analyze the optimal staﬃng patterns of the E-SP and E-DHSCP models

(Section 8.5.1) and their out-of-sample performances (Section 8.5.2). For illustrative purposes

and brevity, we present results for Instance 7 (L = 4, K = 8, T = 30) and Instance 10 (L =

6, K = 6, T = 30), which corresponds to middle-sized instances. In addition, we consider the

following types of caregivers. In Instance 7 (which consists of K = 8 types of caregivers), we let

caregivers types k ∈ {1, . . . , 4} represent specialized caregivers, meaning they can only provide

23

                     , W H U D W L R Q V                      / R Z H U  E R X Q G  H  Z  R  , Q H T           Z  , Q H T                               , W H U D W L R Q V                      * D S Z  R  , Q H T           Z  , Q H T          (a) co

l,t = 1

(b) cu

l,t = 10

Figure 3. Total number of caregivers hired by E-SP and E-DHSCP models for Instance 10.

one type of service. And we let type k ∈ {5, . . . , 8} represents cross-trained caregivers who are

trained or qualiﬁed for two types of services. In Instance 10 (which consist of K = 6 types of

caregivers), all caregivers are cross-trained.

8.5.1. Optimal staﬃng patterns of EA models

In this section, we compare the optimal staﬃng pattern (i.e., the optimal number of hired
caregivers) of the E-SP and E-DHSCP models under diﬀerent values of the under-staﬃng cu
l,t
and over-staﬃng co
l,t penalty costs. First, in Figure 3a, we present the optimal number of
hired caregivers under demand range 1 ([40, 60]) and range 2 ([40, 100]) with co
l,t = 1 and
cu
l,t ∈ {1, 5, 10, 15, 20, 25} for Instance 10. We observe the same staﬃng patterns for Instance 7
(see Figure K.1 in Appendix K).

We observe the following from Figure 3a. First, both models hire more caregivers under

range 2 than range 1. This makes sense because, in range 2, both the volume and variability of

the demand are higher. Second, it is clear that both models hire more caregivers as the under-

staﬃng cost increases from 1 to 25. However, the number of hired caregivers stabilize after
l,t = 10. Third, when cu
cu
l,t ≤ 5 (i.e., low under-staﬃng cost), both models hire approximately
the same number of caregivers. In contrast, when cu
l,t > 5, the E-DHSCP models hire more
caregivers than the E-SP model to mitigate excessive under-staﬃng. These results indicate
that cu
l,t = 10 may be a suitable penalty cost of under-staﬃng for (EA) decision-makers. We
l,t = 10 and increase the penalty for over-staﬃng co
observe a diﬀerent pattern when we ﬁx cu
l,t
from 1 to {5, 10, 15, 20, 25}. Speciﬁcally, as shown in Figure 3b both models hire less caregivers
as increasing co

l,t = 10.
Next, we analyze the detailed staﬃng patterns under cost structure (cu

l,t. And the number of hired caregivers stabilize after co

l,t) = (10, 1)
presented in Figure K.2 (see Appendix K). First, if there are only cross-trained caregivers (In-

l,t, co

stance 10), all models tend to hire all types of caregivers. Second, if there are both specialized

and cross-trained caregivers (Instance 7), the E-SP model tend to hire specialized caregivers

24

           3 H Q D O W \  I R U  X Q G H U  V W D I I L Q J  cult                7 R W D O  Q X P E H U  R I  F D U H J L Y H U V (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H   (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H             3 H Q D O W \  I R U  R Y H U  V W D I I L Q J  colt                  7 R W D O  Q X P E H U  R I  F D U H J L Y H U V (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H   (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H  under both demand ranges while the E-DHSCP model hire a mixture of specialized and cross-

trained caregivers. In addition, the E-DHSCP model hire more cross-trained caregivers under

demand range 2 than under demand range 1. This could indicate that cross-trained caregivers

are more favorable under a higher variation level.

8.5.2. Out-of-sample performance of EA model

In this section, we compare the operational performance of the optimal solutions of the

E-DHSCP and E-SP via out-of-sample simulation. We test the out-of-sample performance

(i.e., the objective value obtained by simulating the optimal solution of a model under a

larger unseen data) as follows. First, we solve each instance and obtain the optimal ﬁrst-stage

decisions. Second, we ﬁx the obtained ﬁrst-stage decisions, then re-optimize the second stage
of the SP using the following sets of N (cid:48) = 10, 000 out-of-sample data to compute the second

stage cost (i.e., under-staﬃng plus over-staﬃng costs). We compute the out-of-sample total

cost as ﬁrst-stage cost plus the out-of-sample second-stage cost.

Set 1. We assume that we have perfect distributional information. That is, we use the same

distributions (LogN) and parameter settings that we use for generating the N data in
the optimization to generate N (cid:48) data. This is to simulate the performance when the true

distribution is the same as the one used in the optimization.

Set 2. In this set, we assume that we have used misspeciﬁed distributions of the demand and

service duration in the optimization (motivated by our analysis in Section 2). We follow

a similar out-of-sample simulation testing procedure described in Shehadeh (2020) and

Wang et al. (2020) and perturb the support of the random demand and service durations

by a parameter ∆ and used parameterized uniform distribution U [(1 − ∆) lower bound,
(1+∆) upper bound] to generate the N (cid:48) = 10, 000 data. We apply ∆ ∈ {0, 0.1, 0.25, 0.5}.

A higher ∆ corresponds to a higher variation level.

For brevity, we focus on Instance 10 and present results under (cu

l,t) = (10, 1). We
observe similar results for Instance 7 (see Appendix L.2). First, let us analyze simulation

l,t, co

results under Set 1 (i.e., perfect distributional information case). Figure L.1 in Appendix L.1

presents histograms of the out-of-sample total cost, second-stage costs, and under-staﬃng. It

is clear from this ﬁgure that the E-DHSCP model yields a higher total cost and lower second-

stage cost than the E-SP model on average and at all quantiles. This makes sense because,

as we discussed in Section 8.5.1, the E-DHSCP tends to hire more caregivers to hedge against

under-staﬃng (reﬂected by signiﬁcantly lower under-staﬃng on average and all quantile than

the E-SP model in Figure L.1c). However, this results in a higher ﬁxed cost associated with

hiring more caregivers.

25

(a) ∆ = 0

(b) ∆ = 0.25

(c) ∆ = 0.5

Figure 4. Out-of-sample second stage cost for Instance 10, demand range 1 under Set 2

We observe the following from simulation results under Set 2 (i.e., misspeciﬁed distri-

butional information case) with demand range 1 presented in Figures 4 (see Figure L.2 in

Appendix L.1 for results with range 2). Notably, the E-DHSCP model consistently outper-

forms the E-SP model under all levels of variation (∆) and across the criteria of mean and

all quantiles of the second-stage costs under the two ranges of the demand. In particular, as

shown in Figure L.3 (see Appendix L.1), the E-DHSCP yield signiﬁcantly lower under-staﬃng

cost than the E-SP model. Note that a lower second-stage and under-staﬃng cost indicates

better operational performance (i.e., lower shortage and meeting greater demand) and thus

has a signiﬁcant practical impact, especially in healthcare. Second, the E-DHSCP solutions

appear to be more stable with a signiﬁcantly smaller standard deviation (i.e., variations) in

the total and second-stage costs than the E-SP solutions. The superior performance of the

DRO model reﬂects the value of modeling uncertainty and distributional ambiguity.

Next, we investigate the value of distributional robustness from the perspective of out-of-

sample disappointment, which measures the extent to which the out-of-sample cost exceeds the

model’s optimal value (Van Parys et al., 2021; Wang et al., 2020). Following Shehadeh (2020)

(cid:110)

0, Vout−Vopt
Vopt

(cid:111)

×

and Wang et al. (2020), we deﬁne the out-of-sample disappointment as max

100%, where Vopt and Vout are as the model’s optimal value and the out-of-sample objective
value, respectively. A disappointment of zero indicates that the model’s optimal value is equal

to or larger than the out-of-sample (actual) cost, suggesting that the model is more conservative

and avoids underestimating costs. In contrast, a larger disappointment implies a higher level of

over-optimism because, in this case, the actual cost (Vout) of implementing the optimal solution
of a model is larger than the estimated cost (Vopt).

Figure 5 presents histograms of the out-of-sample disappointment.

It is clear from this

ﬁgure that the E-DHSCP solutions yield substantially smaller out-of-sample disappointments

on average and at all quantiles than the E-SP model. In particular, the disappointment of the

E-SP model signiﬁcantly increases under higher variation, exceeding 100% under ∆ = 0.5. In

contrast, the E-DHSCP model can control disappointment with a smaller and stable range.

26

                      6 H F R Q G  V W D J H  F R V W  H                             1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                                 6 H F R Q G  V W D J H  F R V W  H        1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                   6 H F R Q G  V W D J H  F R V W  H                 1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.25

(c) ∆ = 0.5

Figure 5. Out-of-sample disappointment for Instance 10 with demand range 1 under Set 2.

These results conﬁrm that the DRO model provides a more robust estimate of the actual cost

that we will incur in practice.

In a decision-making context where the goal is to minimize

expenses, disappointments are more harmful than positive surprises (overestimated costs).

8.6. Analysis of results of FA models

In this section, we analyze the optimal staﬃng patterns of the F-SP and F-DHSCP models

(Section 8.6.1) and their out-of-sample performance (Section 8.6.2). We present the results for

Instance 7 and Instance 10 as deﬁned in Section 8.5.

8.6.1. Optimal staﬃng patterns of FA models

In this section, we compare the optimal staﬃng patterns of the F-SP and F-DHSCP under
l,t and over-staﬃng co
k,t penalty costs. In Figure 6a, we
k,t = 1
l,t ∈ {2, 3, 4, 5, 6, 7} for Instance 10. We observe the same staﬃng patterns for Instance 7

diﬀerent values of the under-staﬃng cu
present the optimal number of hired caregivers under demand range 1 and range 2 with co
and cu

(see Figure M.1 in Appendix M).

We observe the following from Figure 6. First, both models hire more caregivers under
l,t = 5.
l,t ≤ 3, both models hire approximately the same number of caregivers.
In
l,t > 3 the F-DHSCP models hire more caregivers than the E-SP models.
l,t = 5 may be a suitable penalty cost of under-staﬃng for the
l,t = 5 and increase the
k,t from 2 to {3, 4, 5, 6, 7}. Speciﬁcally, as shown in Figure 6b both
k,t increases. And the number of hired caregivers stabilize after

demand range 2 than under range 1 and the number of hired caregivers stabilize after cu
Second, when cu
contrast, when cu
These results indicate that cu
(FA) decision-makers. We observe a diﬀerent pattern when we ﬁx cu
penalty for over-staﬃng co
models hire less caregivers as co
co
k,t = 3.

Next, we analyze the detailed staﬃng patterns under cost structure (cu

k,t) = (5, 2)
presented in Figure M.2 (see Appendix M). Compared with EA models, both F-SP and F-

l,t, co

DHSCP models prefer cross-trained caregivers under two demand ranges for Instance 7.

27

                    ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3                       ' L V D S S R L Q W P H Q W                                 1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3                              ' L V D S S R L Q W P H Q W                                 1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3(a) co

k,t = 1

(b) cu

l,t = 5

Figure 6. Total number of caregivers hired by F-SP and F-DHSCP models for Instance 10.

8.6.2. Out-of-sample performance of FA model

In this section, we compare the operational performance of the optimal solutions of the

F-DHSCP and F-SP via out-of-sample simulation. Using the same methods in Section 8.5.2,
we generate two sets of N (cid:48) = 10, 000 out-of-sample data (Set 1-2). For brevity, we focus on
Instance 10 and present results under (cu
k,t) = (5, 2) (see Appendix N.2 for results related

l,t, co

to Instance 7).

We observe the following from the simulation results under Set 2, ∆ = 0 (i.e., misspeciﬁed

distributional information case) with demand range 1 presented in Figure 7 (see Figure N.1 in

Appendix N.1 for results with range 2). The F-DHSCP model outperforms the F-SP model

under all levels of variation (∆) and across the criteria of mean and all quantiles of the second-

stage costs and under-staﬃng under the two ranges of the demand (see Figure N.2–N.3 in

Appendix N.1). Speciﬁcally, as shown in Figure 7a, the F-DHSCP model yields a lower total

cost than the F-SP model on average and at all quantiles. This makes sense because F-DHSCP

make more ﬂexible capacity allocation, which reduce the number of hired caregivers then the

ﬁxed cost associated with hiring more caregivers.

Finally, it is clear from Figure 8 that the F-DHSCP solutions yield smaller out-of-sample

disappointments on average and at all quantiles than the F-SP solutions under all levels of

variation (∆). Notably, the disappointment of the F-DHSCP solutions is smaller than 50%

under a higher variation ∆ = 0.5. These results conﬁrm that the F-DHSCP model provides a

more robust estimate of the actual cost that we will incur in practice.

9. Conclusion

In this paper, we proposed stochastic optimization methodologies for the HSCP problem,

which seeks to ﬁnd the number of caregivers to hire and their allocation decisions to diﬀerent

types of services in each day within a speciﬁed planning horizon. The objective is to minimize

28

       3 H Q D O W \  I R U  X Q G H U  V W D I I L Q J  cult             7 R W D O  Q X P E H U  R I  F D U H J L Y H U V )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H   )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H         3 H Q D O W \  I R U  R Y H U  V W D I I L Q J  cokt             7 R W D O  Q X P E H U  R I  F D U H J L Y H U V )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H   )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H  (a)

(b)

(c)

Figure 7. Out-of-sample performance of FA models for Instance 10, demand range 1 under Set 2,
∆ = 0

(a) ∆ = 0

(b) ∆ = 0.25

(c) ∆ = 0.5

Figure 8. Out-of-sample disappointment for Instance 10, demand range 1 under Set 2

the total cost associated with staﬃng (i.e., employment), capacity allocation, over-staﬃng, and

under-staﬃng. To address uncertainty in service duration and the demand for home service, we

proposed and analyzed SP and DRO models considering two types of decision-makers, namely

everything in advance decision-maker (for which we proposed E-SP and E-DHSCP models) and

a ﬂexible adjustment decision-maker (FA) (for which we proposed (F-SP and F-DHSCP). We

derive equivalent MILP reformulations of the proposed nonlinear E-DHSCP model for the EA

decision-maker that can be implemented and eﬃciently solved using oﬀ-the-shelf optimization

software. We propose a computationally eﬃcient column-and-constraint generation algorithm

with valid inequalities to solve the proposed F-DHSCP model for the FA decision-maker.

Finally, we conduct extensive numerical experiments comparing the operational and com-

putational performance of the proposed approaches and discuss insights and implications for

home care staﬃng and capacity planning. The results demonstrate (1) the DRO models tend

to hedge against uncertainty and ambiguity by hiring more caregivers and thus have a higher

ﬁxed cost but signiﬁcantly lower operational (i.e., under-staﬃng) costs than the SP models, (2)

the DRO solutions are more robust under various distributions with substantially lower dis-

appointments and thus higher reliability than the SP models, (3) the computational eﬃciency

of the proposed approaches, indicating their applicability in practice. We also derive insights

29

                                     7 R W D O  F R V W  H                                      1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                                 6 H F R Q G  V W D J H  F R V W  H                                      1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                            $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                       1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3               ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3                   ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3                            ' L V D S S R L Q W P H Q W                                 1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3into the HSCP under diﬀerent settings. In particular, we show how one can use the proposed

models to obtain staﬃng and capacity allocation decisions under diﬀerent cost structures that

the decision-maker can easily change in the models. These results address the primary ob-

jective of this paper. That is, to investigate the value of SP and DRO approaches for this

speciﬁc HSCP problem. More broadly, our results motivate the need for considering diﬀerent

approaches when modeling uncertainty and draw attention to the need to model the distri-

butional ambiguity of uncertain problem data in strategic real-world stochastic optimization

problems such as the HSCP problem.

We suggest the following areas for future research. First, we want to extend our approach by

incorporating other multi-modal sources of uncertainty (e.g., travel time). Second, our models

can be considered as the ﬁrst step toward building data-driven and robust home care service

planning including the creating routing plans for caregivers and assigning appointment times

for customers, among other important considerations. Finally, we aim to incorporate other

aspects, such as the possibility of hiring part-time caregivers and the unexpected availability

of the hired full-time caregivers on the day of service.

Acknowledgment

We want to thank all of our colleagues who have contributed signiﬁcantly to the related liter-

ature. Dr. Karmel S. Shehadeh dedicates her eﬀort in this paper to every little dreamer in the

whole world who has a dream so big and so exciting. Believe in your dreams and do whatever

it takes to achieve them–the best is yet to come for you.

References

References

Ben-Tal, A., El Ghaoui, L., & Nemirovski, A. (2009). Robust optimization. Princeton university press.

Bertsimas, D., Brown, D. B., & Caramanis, C. (2011). Theory and applications of robust optimization.

SIAM review , 53 , 464–501.

Boyd, S., Boyd, S. P., & Vandenberghe, L. (2004). Convex optimization. Cambridge university press.

Cappanera, P., & Scutell`a, M. G. (2021). Addressing consistency and demand uncertainty in the home

care planning problem. Flexible Services and Manufacturing Journal , (pp. 1–39).

Cappanera, P., Scutell`a, M. G., Nervi, F., & Galli, L. (2018). Demand uncertainty in robust home care

optimization. Omega, 80 , 95–110.

Carello, G., & Lanzarone, E. (2014). A cardinality-constrained robust model for the assignment problem

in home care services. European Journal of Operational Research, 236 , 748–762.

Cayirli, T., Veral, E., & Rosen, H. (2006). Designing appointment scheduling systems for ambulatory

care services. Health care management science, 9 , 47–58.

30

Deloitte (2021). Canada’s elder care crisis: Addressing the doubling demand. https://www.cma.ca/
sites/default/files/pdf/health-advocacy/activity/CMA-LTC-Deloitte-Report-EN.pdf.

Di Mascolo, M., Martinez, C., & Espinouse, M.-L. (2021). Routing and scheduling in home health care:
A literature survey and bibliometric analysis. Computers & Industrial Engineering, (p. 107255).

Esfahani, P. M., & Kuhn, D. (2018). Data-driven distributionally robust optimization using the wasser-
stein metric: Performance guarantees and tractable reformulations. Mathematical Programming,
171 , 115–166.

Fikar, C., & Hirsch, P. (2017). Home health care routing and scheduling: A review. Computers &

Operations Research, 77 , 86–95.

Gabrel, V., Murat, C., & Thiele, A. (2014). Recent advances in robust optimization: An overview.

European journal of operational research, 235 , 471–483.

Genworth (2022). Cost of care survey.

https://www.genworth.com/aging-and-you/finances/

cost-of-care.html.

Goh, J., & Sim, M. (2010). Distributionally robust optimization and its tractable approximations.

Operations research, 58 , 902–917.

Gorissen, B. L., Yanıko˘glu, ˙I., & den Hertog, D. (2015). A practical guide to robust optimization.

Omega, 53 , 124–137.

Grieco, L., Utley, M., & Crowe, S. (2021). Operational research applied to decisions in home health
care: A systematic literature review. Journal of the Operational Research Society, 72 , 1960–1991.

Guti´errez, E. V., & Vidal, C. J. (2013). Home health care logistics management problems: A critical
review of models and methods. Revista Facultad de Ingenier´ıa Universidad de Antioquia, (pp. 160–
175).

Jiang, R., Ryu, M., & Xu, G. (2019). Data-driven distributionally robust appointment scheduling over

wasserstein balls. arXiv preprint arXiv:1907.03219 , .

Kleywegt, A. J., Shapiro, A., & Homem-de Mello, T. (2002). The sample average approximation method

for stochastic discrete optimization. SIAM Journal on Optimization, 12 , 479–502.

Lanzarone, E., & Matta, A. (2014). Robust nurse-to-patient assignment in home care services to

minimize overtimes under continuity of care. Operations Research for Health Care, 3 , 48–58.

Mak, W.-K., Morton, D. P., & Wood, R. K. (1999). Monte carlo bounding techniques for determining

solution quality in stochastic programs. Operations research letters, 24 , 47–56.

Mankowska, D. S., Meisel, F., & Bierwirth, C. (2014). The home health care routing and scheduling

problem with interdependent services. Health care management science, 17 , 15–30.

Homem-de Mello, T., & Bayraksan, G. (2014). Monte carlo sampling-based methods for stochastic

optimization. Surveys in Operations Research and Management Science, 19 , 56–85.

Michael, L. P. (2018). Scheduling: theory, algorithms, and systems. Springer.

Poo, A.-J. (2021). Care is essential. https://ndwa2020.domesticworkers.org/wp-content/uploads/

2021/04/Care_Is_essential_UPDATE_4_02_21-copy.pdf. Accessed March 19, 2022.

Rahimian, H., & Mehrotra, S. (2019). Distributionally robust optimization: A review. arXiv preprint

31

arXiv:1908.05659 , .

Restrepo, M. I., Rousseau, L.-M., & Vall´ee, J. (2020). Home healthcare integrated staﬃng and schedul-

ing. Omega, 95 , 102057.

Rodriguez, C., Garaix, T., Xie, X., & Augusto, V. (2015). Staﬀ dimensioning in homecare services with

uncertain demands. International Journal of Production Research, 53 , 7396–7410.

Rodriguez-Verjan, C., Augusto, V., & Xie, X. (2018). Home health-care network design: Location and

conﬁguration of home health-care centers. Operations research for health care, 17 , 28–41.

Roos, E., & den Hertog, D. (2020). Reducing conservatism in robust optimization. INFORMS Journal

on Computing, 32 , 1109–1127.

Shapiro, A., Dentcheva, D. et al. (2014). Lectures on Stochastic Programming: Modeling and Theory

volume 16. SIAM.

Shehadeh, K. S. (2020). Distributionally robust optimization approaches for a stochastic mobile facility

routing and scheduling problem. arXiv preprint arXiv:2009.10894 , .

Shehadeh, K. S., Cohn, A. E., & Jiang, R. (2021). Using stochastic programming to solve an outpatient
appointment scheduling problem with random service and arrival times. Naval Research Logistics
(NRL), 68 , 89–111.

Shi, Y., Boudouh, T., & Grunder, O. (2019). A robust optimization for a home health care routing and
scheduling problem with consideration of uncertain travel and service times. Transportation Research
Part E: Logistics and Transportation Review , 128 , 52–95.

Smith, J. E., & Winkler, R. L. (2006). The optimizer’s curse: Skepticism and postdecision surprise in

decision analysis. Management Science, 52 , 311–322.

Thiele, A. (2010). A note on issues of over-conservatism in robust optimization with cost uncertainty.

Optimization, 59 , 1033–1040.

Tsang, M. Y., & Shehadeh, K. S. (2021). Stochastic optimization models for a home service rout-
ing and appointment scheduling problem with random travel and service times. arXiv preprint
arXiv:2105.01725 , .

Van Parys, B. P., Esfahani, P. M., & Kuhn, D. (2021). From data to decisions: Distributionally robust

optimization is optimal. Management Science, 67 , 3387–3402.

Wang, S., Chen, Z., & Liu, T. (2020). Distributionally robust hub location. Transportation Science,

54 , 1189–1210.

Washington, S. (2018). Washington state plan on aging.

https://www.dshs.wa.gov/altsa/

state-plan-aging.

Zeng, B., & Zhao, L. (2013). Solving two-stage robust optimization problems using a column-and-

constraint generation method. Operations Research Letters, 41 , 457–461.

Zhan, Y., & Wan, G. (2018). Vehicle routing and appointment scheduling with team assignment for

home services. Computers & Operations Research, 100 , 1–11.

Zhan, Y., Wang, Z., & Wan, G. (2021). Home service routing and appointment scheduling with

stochastic service times. European Journal of Operational Research, 288 , 98–110.

32

Zheng, C., Wang, S., Li, N., & Wu, Y. (2021). Stochastic joint homecare service and capacity planning

with nested decomposition approaches. European Journal of Operational Research, .

33

Integrated Home Care Staﬃng and Capacity Planning: Stochastic

Optimization Approaches (Appendices)

Ridong Wang, Karmel S. Shehadeh, Xiaolei Xie, Lefei Li

Appendix A. Candidate Probability Distributions for demands

In this section, we ﬁrst show the ﬁtting distributions for demands and their goodness of

ﬁt metrics; Negative of the Log Likelihood (NLogL), Akaike Information Criterion (AIC), and

Bayesian Information Criterion (BIC). Then, in Figure A.1, we show the rehabilitation service

demand range change in diﬀerent quarters.

Table A.1. Candidate probability distributions for demands of rehabilitation nursing service

Distribution name
generalized extreme value
loglogistic
lognormal
birnbaumsaunders
inverse gaussian
gamma
weibull
nakagami
rayleigh
rician
generalized pareto
tlocationscale
logistic
exponential
normal
extreme value

NLogL
4951.50
4967.45
4968.68
4989.83
4991.17
4994.32
5029.16
5043.96
5058.13
5058.13
5068.65
5104.24
5153.31
5169.56
5171.11
5336.91

BIC
9923.02
9948.24
9950.71
9992.99
9995.69
10001.97
10071.66
10101.26
10122.93
10129.60
10157.31
10228.49
10319.95
10345.80
10355.56
10687.17

AIC
9909.01
9938.90
9941.37
9983.65
9986.35
9992.63
10062.32
10091.92
10118.26
10120.26
10143.30
10214.49
10310.61
10341.13
10346.22
10677.83

34

Table A.2. Candidate probability distributions for demands of health status assessment service

Distribution name
generalized pareto
generalized extreme value
inverse gaussian
birnbaumsaunders
lognormal
loglogistic
gamma
nakagami
logistic
rician
tlocationscale
normal
weibull
rayleigh
extreme value
exponential

NLogL
297.65
321.55
333.13
333.24
333.33
335.70
337.40
342.40
346.23
348.16
345.89
348.79
352.38
380.76
379.28
451.12

BIC
609.69
657.49
675.85
676.08
676.25
680.99
684.40
694.40
702.06
705.91
706.18
707.17
714.35
766.32
768.14
907.03

AIC
601.31
649.10
670.25
670.48
670.66
675.40
678.80
688.81
696.47
700.32
697.79
701.58
708.76
763.52
762.55
904.23

Figure A.1. Rehabilitation service demand range in time series

35

     B      B      B      B      B      B      B      B      B      B      B  < H D U B 4 X D U W H U                   ' H P D Q G  U D Q J H 0 H D QAppendix B. Proof of Proposition 1

Proof. For ﬁxed x and y, we can formulate problem supP∈F (U ,µ)
linear optimization problem.

EP[Q(x , y, ξ)] as following

max
P≥0

s.t.

(cid:90)

U
(cid:90)

U
(cid:90)

U
(cid:90)

U

[Q(x , y, ξ)]dP

dl,tdP = µd

l,t, ∀l ∈ [L], t ∈ [T ], αl,t

sl,tdP = µs

l,t, ∀l ∈ [L], t ∈ [T ], βl,t

dP = 1

θ

(B.1a)

(B.1b)

(B.1c)

(B.1d)

standard assumptions that µd

Note that U is compact, and the recourse is a continuous function in d and s. Under
l,t belongs to the interior of set { (cid:82)
U dl,tdQ : Q is a probability
distribution over U } for all l ∈ [L] and t ∈ [T ] and that sl,t belongs to the interior of set {
(cid:82)
U sl,tdQ : Q is a probability distribution over U } for all l ∈ [L] and t ∈ [T ] , slater condition
will hold (Boyd et al., 2004). Then, strong duality holds and the worst-case expectation equals:

(cid:40) L
(cid:88)

T
(cid:88)

µd

l,tαl,t +

(cid:41)

µs

l,tβl,t + θ

L
(cid:88)

T
(cid:88)

l=1

t=1

(B.2a)

min
α,β,θ

s.t.

t=1

l=1
T
(cid:88)

L
(cid:88)

(dl,tαl,t + sl,tβl,t) + θ ≥ Q(x, y , ξ), ∀(d, s) ∈ U

(B.2b)

l=1

t=1

where αl,t, βl,t and θ are the dual variables associated with constraints (B.1b), (B.1c), and
(B.1d). Note that we can rewrite constraint (B.2b) as follows:

(cid:40)

θ ≥ max
(d,s)∈U

Q(x, y , ξ) −

(cid:41)

(dl,tαl,t + sl,tβl,t)

L
(cid:88)

T
(cid:88)

l=1

t=1

Given that we are minimizing θ in (B.2a), we can rewrite formulation (B.2) as follows:

(cid:41)(cid:41)

(dl,tαl,t + sl,tβl,t)

L
(cid:88)

T
(cid:88)

l=1

t=1

min
α,β

(cid:40) L
(cid:88)

T
(cid:88)

l=1

t=1

µd

l,tαl,t +

L
(cid:88)

T
(cid:88)

l=1

t=1

(cid:40)

µs

l,tβl,t + max
(d,s)∈U

Q(x, y , ξ) −

36

Appendix C. Proof of Proposition 2

Proof. Not that problem Q(x , y , ξ) in (8) is separable by each t and l. Therefore, w.l.o., we
can rewrite Q(x , y , ξ) = (cid:80)
t Ql,t(x , y , dl,t, sl,t), where for ﬁxed xxx, yyy, l, t, dl,t ∈ [dl,t, dl,t],
l
and sl,t ∈ [sl,t, sl,t].

(cid:80)

Ql,t(x , y , dl,t, sl,t) = max
ρl,t

(cid:110)

(dl,tsl −

(cid:88)

(cid:111)

yk,l,t)ρl,t

s.t. Pl,t := {−co

k:l∈Rk
l,t ≤ ρl,t ≤ cu

l,t}.

(C.1a)

(C.1b)

Accordingly,

(cid:40)

max
(d,s)∈U

Q(x, y, ξ) −

L
(cid:88)

T
(cid:88)

l=1

t=1

(cid:41)

(dl,tαl,t + sl,tβl,t)

≡

L
(cid:88)

T
(cid:88)

l=1

t=1

max
dl,t∈[dl,t,dl,t]
sl,t∈[sl,t,sl,t]

(cid:110)

Ql,t(x , y , dl,t, sl,t)

− dl,tαl,t − sl,tβl,t

(cid:111)
,

L
(cid:88)

T
(cid:88)

≡

l=1

t=1

max
dl,t∈[dl,t,dl,t]
sl,t∈[sl,t,sl,t]

hl,t(dl,t, sl,t, yl,t, αl,t, βl,t),

where

hl,t(dl,t, sl,t, yl,t, αl,t, βl,t) := max
ρl,t∈Pl,t






dl,tsl,tρl,t −

(cid:88)

k:l∈Rk

yk,l,tρl,t − dl,tαl,t − sl,tβl,t

(C.2)






.

(C.3)

It is straightforward to verify that for ﬁxed xxx, yyy, dl,t ∈ [dl,t, dl,t], and sl,t ∈ [sl,t, sl,t] function
(C.3) is convex in variable ρl,t. Hence, problem (C.3) is a convex maximization problem. It
follows from the fundamental convex analysis (see Boyd et al. (2004)) that here exists an
optimal solution ˆρl,t at one of the extreme points of polyhedron Pl,t := {−co
l,t}. In
any extreme point, constraint −co
l,t is binding at either the lower bound or upper
bound. Thus, given that dl,t ∈ [dl,t, dl,t], and sl,t ∈ [sl,t, sl,t], it is easy to verify that the optimal

l,t ≤ ρl,t ≤ cu

l,t ≤ ρl,t ≤ cu

37

value η∗

l,t of problem

hl,t(dl,t, sl,t, yl,t, αl,t, βl,t) in (C.2) equals to:

max
dl,t∈[dl,t,dl,t]
sl,t∈[sl,t,sl,t]


η∗
l,t = max




dl,tsl,tcu
−dl,tsl,tco
−dl,tsl,tco
dl,tsl,tcu
dl,tsl,tcu
dl,tsl,tcu
−dl,tsl,tco
−dl,tsl,tco

l,t − (cid:80)
l,t + (cid:80)
l,t + (cid:80)
l,t − (cid:80)
l,t − (cid:80)
l,t − (cid:80)
l,t + (cid:80)
l,t + (cid:80)

k:l∈Rk

k:l∈Rk

k:l∈Rk

k:l∈Rk

k:l∈Rk

k:l∈Rk

k:l∈Rk

k:l∈Rk

yk,l,tcu
yk,l,tco
yk,l,tco
yk,l,tcu
yk,l,tcu
yk,l,tcu
yk,l,tco
yk,l,tco

l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t
l,t − dl,tαl,t − sl,tβl,t






(C.4)

Hence, max

dl,t∈[dl,t,dl,t]
sl,t∈[sl,t,sl,t]

hl,t(dl,t, sl,t, y, αl,t, βl,t) is equivalent to the following minimization problem.

min ηl,t

s.t.

ηl,t ≥ dl,tsl,tcu

l,t −

(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t,

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t,

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

k:l∈Rk
(cid:88)

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

k:l∈Rk

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t,

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t.

(C.5a)

(C.5b)

(C.5c)

(C.5d)

(C.5e)

(C.5f)

(C.5g)

(C.5h)

(C.5i)

Replacing max h(·) in C.2 with its equivalent reformulation in (C.5) and summing over all

l ∈ [L] and t ∈ [T ], we derive the following equivalent reformulation.

min
ηηη

s.t.

L
(cid:88)

T
(cid:88)

ηl,t

t=1
l=1
ηl,t ≥ dl,tsl,tcu

l,t −

(cid:88)

k:l∈Rk

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(C.6b)

(C.6a)

38

ηl,t ≥ −dl,tsl,tco

l,t +

ηl,t ≥ −dl,tsl,tco

l,t +

(cid:88)

k:l∈Rk
(cid:88)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

(C.6c)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

(C.6d)

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

ηl,t ≥ dl,tsl,tcu

l,t −

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(C.6e)

k:l∈Rk
(cid:88)

k:l∈Rk
(cid:88)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(C.6f)

yk,l,tcu

l,t − dl,tαl,t − sl,tβl,t,

∀l ∈ [L], t ∈ [T ],

(C.6g)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

ηl,t ≥ −dl,tsl,tco

l,t +

k:l∈Rk
(cid:88)

k:l∈Rk

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ],

(C.6h)

yk,l,tco

l,t − dl,tαl,t − sl,tβl,t, ∀l ∈ [L], t ∈ [T ].

(C.6i)

39

Appendix D. Proof of Proposition 3

Proof. Not that problem QA(x , ξ) in (15) is separable by each t. Therefore, w.l.o., we can
rewrite QA(x , ξ) = (cid:80)

t (x , dt, st), where for ﬁxed xxx, t, dt ∈ [dt, dt], and st ∈ [st, st]

t QA

QA

t (x , ξ) = max
ρt

(cid:40) L
(cid:88)

l=1

dl,tsl,tρl,t +

(cid:41)

λk,txkhk

(cid:88)

k∈K

s.t. ρl,t + λk,t ≤ ck,l,t,

∀k ∈ [K], l ∈ Rk,

ρl,t ≤ cu
l,t,
λk,t ≤ co

k,t,

Accordingly,
(cid:40)

max
(d,s)∈U

QA(x, ξ) −

L
(cid:88)

T
(cid:88)

l=1

t=1

(cid:41)

(dl,tαl,t + sl,tβl,t)

≡

≡

T
(cid:88)

t=1

T
(cid:88)

t=1

max
dt∈[dt,dt]
st∈[st,st]

max
dt∈[dt,dt]
st∈[st,st]

∀l ∈ [L],

∀k ∈ [K].

(cid:40)

QA

t (x , dt, st) −

L
(cid:88)

l=1

(dl,tαl,t + sl,tβl,t)

,

ht(x, dt, st, αt, βt),

(D.2)

(D.1a)

(D.1b)

(D.1c)

(D.1d)

(cid:41)

where

ht(x, dt, st, αt, βt) := max
ρt∈Pt

(cid:40) L
(cid:88)

l=1

dl,tsl,tρl,t +

(cid:88)

k∈K

λk,txkhk −

L
(cid:88)

l=1

(cid:41)

(dl,tαl,t + sl,tβl,t)

.

(D.3)

and Pt := {(D.1b) − (D.1d)}. Problem (D.3) is not solvable directly due to the trilinear terms
between the dual variables ρt, dt, and st. Note that we could ﬁrst perform maximization over
dt and st, i.e.,

ht(x, ρt, λt, αt, βt) := max
dt,st

(cid:40) L
(cid:88)

l=1

dl,tsl,tρl,t +

(cid:88)

k∈K

λk,txkhk −

L
(cid:88)

l=1

(cid:41)

(dl,tαl,t + sl,tβl,t)

(D.4a)

s.t. dl,t ≤ dl,t ≤ dl,t,

sl,t ≤ sl,t ≤ sl,t,

∀l ∈ [L],

(D.4b)

∀l ∈ [L].

(D.4c)

The above problem is separable in l. Thus, it is easy to verify that the optimal dl,t is
attained at either dl,t = dl,t or dl,t = dl,t, and the optimal sl,t is attained at either sl,t = sl,t or
sl,t = sl,t. Accordingly, we deﬁne binary variables gl,t = 1 if dl,t = dl,t and gl,t = 0 if dl,t = dl,t.
And for all ∈ [L], we deﬁne binary variables zl,t = 1 if sl,t = sl,t and zl,t = 0 if sl,t = sl,t. Then,
we have:

d∗
l,t = dl,t + (dl,t − dl,t)gl,t,
s∗
l,t = sl,t + (sl,t − sl,t)zl,t,

(D.5)

(D.6)

40

With (D.5) and (D.6), we drive the following equivalent reformulation of ht(x, dt, st, αt, βt)

as (D.7).

K
(cid:88)

k=1

max
ρt,λt,
gt,zt

xkhkλk,t −

L
(cid:88)

l=1

(cid:110)

∆sl,tzl,tβl,t + dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t

(cid:111)

+

L
(cid:88)

l=1

(cid:110)

dl,tsl,tρl,t + ∆sl,tdl,tzl,tρl,t + ∆dl,tsl,tgl,tρl,t + ∆dl,t∆sl,tgl,tzl,tρl,t

(cid:111)

(D.7a)

(D.7b)

∀l ∈ [L],

(D.7c)

∀l ∈ [L],

(D.7d)

s.t. ρt ∈ Pt,

gl,t ∈ {0, 1},

zl,t ∈ {0, 1},

where ∆dl,t = dl,t − dl,t and ∆sl,t = sl,t − sl,t.

Then, we deﬁne variables vl,t = gl,tzl. And we introduce the following McCormick inequal-

ities for variables vl,t.

vl,t − gl,t ≤ 0,

vl,t − zl,t ≤ 0,

vl,t ≥ 0,

vl,t − gl,t − zl,t ≥ −1.

(D.8a)

(D.8b)

Accordingly, we can derive the following mixed integer quadratic programming (MIQP)

reformulation of (D.3):

max
ρt,λt,gt,
zt,vt

K
(cid:88)

k=1

xkhkλk,t −

L
(cid:88)

l=1

(cid:8)dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t + ∆sl,tzl,tβl,t

(cid:9)

+

L
(cid:88)

l=1

(cid:8)dl,tsl,tρl,t + ∆sl,tdl,tzl,tρl,t + ∆dl,tsl,tgl,tρl,t + ∆dl,t∆sl,tvl,tρl,t

(cid:9)

s.t.

(D.1b) − (D.1d), (D.7b) − (D.7d),

(D.8a) − (D.8b),

(D.9a)

(D.9b)

.

(D.9c)

In formulation D.9, there are three bilinear terms in objective function (D.9a). To linearize

the problem, we introduce three decision variables el,t = zl,tρl,t, ql,t = gl,tρl,t, rl,t = vl,tρl,t and
the following McCormick inequalities for them.

el,t − ρ

l,t

vl,t ≥ 0,

el,t − cu

l,tvl,t ≤ 0

el,t − ρl,t + ρ

l,t

(1 − vl,t) ≤ 0,

el,t − ρl,t + cu

l,t(1 − vl,t) ≥ 0,

ql,t − ρ

l,t

gl,t ≥ 0,

ql,t − cu

l,tgl,t ≤ 0,

ql,t − ρl,t + ρ

l,t

(1 − gl,t) ≤ 0,

ql,t − ρl,t + cu

l,t(1 − gl,t) ≥ 0,

rl,t − ρ

l,t

vl,t ≥ 0,

rl,t − cu

l,tvl,t ≤ 0,

(D.10a)

(D.10b)

(D.10c)

(D.10d)

(D.10e)

41

rl,t − ρl,t + ρ

l,t

(1 − vl,t) ≤ 0,

rl,t − ρl,t + cu

l,t(1 − vl,t) ≥ 0,

(D.10f)

where ρ

l,t

is a big-M coeﬃcient. Hence, max

ht(x, dt, st, αt, βt) is equivalent to the fol-

dt∈[dt,dt]
st∈[st,st]

lowing MILP problem.

max
ρt,λt,gt,zt,
vt,rt,qt,et

K
(cid:88)

k=1

xkhkλk,t −

L
(cid:88)

l=1

{ dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t + ∆sl,tzl,t βl,t }

+

L
(cid:88)

l=1

(cid:8)dl,tsl,tρl,t + ∆sl,tdl,trl,t + ∆dl,tsl,tql,t + ∆dl,t∆sl,tel,t

(cid:9)

(D.11a)

s.t. ρl,t ≥ ρ

l,t

,

(D.1b) − (D.1d), (D.7b) − (D.7d),

(D.8a) − (D.8b), (D.10a) − (D.10f).

∀l ∈ [L],

(D.11b)

(D.11c)

(D.11d)

Replacing max h(·) in D.2 with its equivalent reformulation in (D.11) and summing over

all t ∈ [T ], we derive the following equivalent reformulation.

T
(cid:88)

(cid:40) K
(cid:88)

t=1

k=1

max
ρ,λ,g,z,
v,r,q,e

xkhkλk,t −

L
(cid:88)

(cid:104)

l=1

dl,tαl,t + ∆dl,tgl,tαl,t + sl,tβl,t + ∆sl,tzl,tβl,t

(cid:105)

(cid:2)dl,tsl,tρl,t + ∆sl,tdl,trl,t + ∆dl,tsl,tql,t + ∆dl,t∆sl,tel,t

(cid:3)

(cid:41)

(D.12a)

+

L
(cid:88)

l=1

s.t. ρl,t ≥ ρ

l,t

,

(D.1b) − (D.1d), (D.7b) − (D.7d),

(D.8a) − (D.8b), (D.10a) − (D.10f)

∀l ∈ [L], t ∈ [T ],

(D.12b)

∀t ∈ [T ],

(D.12c)

∀t ∈ [T ].

(D.12d)

42

Appendix E. Proof of Proposition 4

Proof. According to (15b), we have ρl,t ≤ ck,l,t − λk,t, ∀k ∈ [K], l ∈ Rk. Hence, we have (E.1).

ρl,t ≤ min
k:l∈Rk

(ck,l,t − λk,t)

(E.1)

As we consider a maximization problem in (15) and dl,tsl,t > 0 always holds, it is always
optimal to increase ρl,t in the feasible region. Hence, we have ρ∗
(ck,l,t − λk,t) or
l,t = cu
ρ∗
l,t.

l,t = min
k:l∈Rk

Then, according to constraints (15d), we have ck,l,t − λk,t ≥ ck,l,t − co
(ck,l,t − co

k,t). As we assume cu

l,t + co

k,t. This leads to
k,t > ck,l,t, we have

(ck,l,t − λk,t) ≥ min
k:l∈Rk

ρ∗
l,t = min
k:l∈Rk
(ck,l,t − co
min
k:l∈Rk

k,t) ≤ cu
l,t.
Finally. we have that ρl,t ≥ min
k:l∈Rk

(ck,l,t − co

k,t) in the optimal solution.

43

Appendix F. Proof of Proposition 5

Proof. Observe from the objective of problem (16) that variable αl,t are multiplied by pa-
rameters µd
l,t and variables dl,t, for all l ∈ [L], t ∈ [T ]. And so, for ﬁxed β and x, the joint

contribution α and d to the objective of problem (16) equals:

(cid:88)

(cid:88)

t∈[T ]

l∈[L]

µd

l,tαl,t +

(cid:88)

t∈[T ]

max
dl,t∈[dl,t,dl,t]

(cid:88)

l∈[L]

dl,t(sl,tρl,t − αl,t) + K,

(F.1)

where K is a non-negative term that equal to:

(cid:88)

(cid:88)

t∈[T ]

l∈[L]

µs

l,tβl,t +

(cid:88)

t∈[T ]

max
sl,t∈[sl,t,sl,t]

(cid:88)

l∈[L]

−sl,tβl,t.

(F.2)

First, we suppose that αl,t > 0. If αl,t > sl,tcu

optimal solution of d∗
problem (16) by (µs
l,t < (µs
(µs
that without loss of optimality αl,t = sl,tcu

l,t will be dl,t.
l,t − dl,t)αl,t. Let α(cid:48)
l,t −dl,t)αl,t, i.e., α(cid:48)

l,t −dl,t)α(cid:48)

l,t where cu

l,t is the upper bound of ρl,t. The
In this case, αl,t contributes to the objective value of
l,t = αl,t − (cid:15) with (cid:15) > 0. Since (µs
l,t − dl,t) > 0, then
l,t improves the objective value of problem (16). It follows

l,t is valid upper bound on variables αl,t.

Second, we suppose that αl,t < 0. If αl,t < −sl,t|ρ

optimal solution of d∗
problem (16) by (µs
l,t < (µs
(µs

l,t − dl,t)α(cid:48)

l,t

| which leads to sl,tρl,t − αl,t ≥ 0, the
l,t always is dl,t. In this case, αl,t contributes to the objective value of
l,t = αl,t + (cid:15) with (cid:15) > 0. Since (µs
l,t − dl,t) ≤ 0, then
l,t improves the objective value of problem (16). It follows
| is valid lower bound on variables αl,t.

l,t − dl,t)αl,t. Let α(cid:48)
l,t − dl,t)αt

l, i.e., α(cid:48)

that without loss of optimality αl,t = −sl,t|ρ

l,t

Follow the same proof process, we can prove the βl,t and β

l,t

, deﬁned in (24), are respectively

valid upper and lower bounds on variable βl,t.

44

Appendix G. Sample average approximation

First, we solve the sample average approximation (SAA) formulations of (1) as formulation

(G.1) and (11) as formulation (G.2) which are mixed-integer linear programs (MILP).

min

K
(cid:88)

k=1

ckxk +

K
(cid:88)

L
(cid:88)

T
(cid:88)

k=1

l=1

t=1

ck,l,tyk,l,t +

1
N

N
(cid:88)

n=1

Qn(x , y, ξn)

s.t.

(1b) − (1d),

(cid:88)

k,l,t + un
yn

l,t − on

l,t = dn

l,tsn
l,t,

k:l∈Rk
l,t, un
on

l,t ∈ R+,

min

s.t.

K
(cid:88)

k=1

ckxk +

1
N

N
(cid:88)

n=1

QA,n(x , ξn)

(11a) − (11c),
(cid:88)
k,l,t + on
yn

k,t = xkhk,

l∈Rk
(cid:88)

k,l,t + un
yn

l,t = dn

l,tsn
l,t,

k:l∈Rk
k,l,t, on
yn

k,t, un

l,t ∈ R+,

(G.1a)

(G.1b)

(G.1c)

∀l ∈ [L], t ∈ [T ],

∀l ∈ [L], t ∈ [T ], n ∈ [N ].

(G.1d)

(G.2a)

(G.2b)

(G.2c)

(G.2d)

∀k ∈ [K], t ∈ [T ], n ∈ [N ],

∀l ∈ [L], t ∈ [T ], n ∈ [N ],

∀k ∈ [K], l ∈ [L], t ∈ [T ], n ∈ [N ].

(G.2e)

In formulation (G.1) and (G.2), we replace all scenario-dependent parameters, variables
and constraints with scenario index n ∈ [N ]. Parameters dl,t and sl,t are replaced by dn
l,t and
sn
l,t to represent the realized services demands and duration in scenario n ∈ [N ]. And we use
variables yn
l,t to represent the second stage decision variables under scenarios

l,t, and un

k,l,t, on

n ∈ [N ].

According to Law of Large Number, the optimal objective values of formulation (G.1) will

converge to the optimal values of formulation (1) with probability one as N → ∞ (Homem-

de Mello & Bayraksan, 2014; Shehadeh et al., 2021). However, the computational eﬀort and

solution time of the SAA formulations will increase when we increase the sample size. Hence, we

use Algorithm 2 to determine an appropriate sample size N and obtain near-optimal solutions

of our model via SAA formulation.

In Algorithm 2, we start with a small initial sample size. In ﬁrst step, we will solve the

SAA formulation with designated sample size. In step 1.1, we generate N random samples

of demands and service durations. Then, in step 1.2, we will solve the SAA formulation with
samples generated in step 1.1 and record its optimal objective value vk
N . In

N and solution xk

45

step 1.3, we generate N (cid:48) random samples of demands and service duration. We evaluate the
solution xk
N by Monte Carlo simulation with the generated N (cid:48) random samples and record
the objective value vk
N (cid:48). We will run step 1 with K replicates. All results are recorded. In
second step, we calculate the average of vk
N and vk
N (cid:48) as vN and vN (cid:48). According to Shehadeh
et al. (2021), vN and vN (cid:48) are statistical lower and upper bound of the optimal value of original
formulation. In step 3, we calculate the approximate optimality index as AOIN = vN (cid:48) −vN
.
AOIN approximately estimate the optimality gap of lower bound and upper bound of original
formulation. Therefore, if AOIN is smaller than the predetermined termination tolerance (cid:15),
we believe the optimality gap is small enough. The algorithm will terminate and output the

vN (cid:48)

termination sample size N , objective value vN , vN (cid:48) and approximate optimality index AOIN .
Otherwise, we will increase the sample size then go to step 1.

In Appendix I and Appendix J, we present the result of Approximate Optimality Index and

95% Conﬁdence Interval of the statistical lower bound and upper bound on the objective value,

termination sample size and CPU time for 15 random generated instances with lognormal,

normal and uniform distributions.

46

Algorithm 2 Monte Carlo optimization (MCO) Method

1: Initial sample size N0(10), the number of replicates K(10), the number of scenarios in the

monte carlo simulation step, N (cid:48)(1000), and a termination tolerance (cid:15)(0.01).

2: The sample size of SAA N , lower bound vN and upper bound vN (cid:48) and the approximate

optimality index AOIN .

3: AOI0 ←− 1;
4: N ←− N0/2;
5: while |AOIN | > (cid:15) do
6: N ←− 2N ;
7:

Step 1: MCO Procedure;
for k = 1, ..., K do

8:

9:

10:

11:

12:

13:

14:

15:

Step 1.1 Scenario Generation

Generate N i.i.d scenarios of d, s for all t ∈ [T ], k ∈ [K], l ∈ [L].

Step 1.2 Solving the SAA formulation

Solve the SAA formulation with the scenarios generated in Step 1.1 and record the

corresponding optimal objective value vk
Step 1.3 Cost Evaluation using Monte Carlo Simulation

N and optimal staﬃng number (x)k
N .

Generate N (cid:48) i.i.d scenarios of d, s for all t ∈ [T ], k ∈ [K], l ∈ [L].
Use (x)k

N and d, s to solve N (cid:48) second stage optimization problems and evaluate the

objective value vk

N (cid:48) as:

vk
N (cid:48) =

1
N (cid:48)

N (cid:48)
(cid:88)

n(cid:48)=1

vk
n(cid:48)

16:

17:

end for
Step 2: Compute vN and vN (cid:48)

vN =

1
K

K
(cid:88)

k

vk
N

vN (cid:48) =

1
K

K
(cid:88)

k

vk
N (cid:48)

18:

Step 3: Compute the Approximate Optimality

AOIN =

vN (cid:48) − vN
vN (cid:48)

19: end while

47

Appendix H. HSCP Instances

Table H.1. HSCP Instances

Instance L K T

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

4
4
4
4
4
4
4
4
4
6
6
6
6
6
6

4
4
4
6
6
6
8
8
8
6
6
6
8
8
8

30
90
180
30
90
180
30
90
180
30
90
180
30
90
180

48

Appendix I. Convergence Results of model for EA decision maker at the Termi-

nation Sample Size

In this section, we show the convergence results of SAA formulation (G.1). without spacial
mention, we will use the termination MIP Gap 1 % (We allowed all instances to run for one
day, however, the MIP Gaps of some instances remained at around 1 %). And if there are
more than 50000 iterations with no MIP Gap improvement, the Gurobi will also terminate.

Table I.1. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand and service duration are both truncated lognormal distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
160
160
160
80
160
160
160
160
160
160
160
160
160
160
160

95 %CI vE
N

95 %CI vE
N (cid:48)

[1305223, 1310901]
[4025209, 4042119]
[8145422, 8181920]
[1332869, 1341384]
[3878104, 3892090]
[8144640, 8177446]
[1318371, 1326795]
[4024278, 4031950]
[8133427, 8148144]
[1930063, 1938342]
[5996573, 6022297]
[12161825, 12190077]
[1994892, 2006005]
[5997995, 6027363]
[12209479, 12249137]

[1314541, 1318775]
[4051562, 4062731]
[8193853, 8227162]
[1346114, 1352009]
[3889652, 3894498]
[8178239, 8211080]
[1323659, 1327991]
[4049433, 4060713]
[8139783, 8153705]
[1951127, 1953218]
[6032443, 6059512]
[12236514, 12275592]
[2011921, 2020811]
[6028977, 6055946]
[12274856, 12314217]

|AOI|

0.0065
0.0058
0.0057
0.0088
0.0018
0.0041
0.0024
0.0066
0.0007
0.0092
0.0060
0.0065
0.0079
0.0049
0.0053

49

Table I.2. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both truncated lognormal distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
160
160
160
80
160
160
160
160
160
160
160
160
160
160
160

CPU time mean (s) CPU time range (s)

0.7
2.18
4.74
0.36
2.39
4.77
0.8
2.53
5.4
1.13
3.69
7.97
1.2
3.6
7.64

[0.64, 0.77]
[2.08, 2.26]
[4.51, 4.98]
[0.33, 0.39]
[2.29, 2.57]
[4.54, 4.91]
[0.75, 0.83]
[2.4, 2.77]
[5.1, 6.06]
[1.05, 1.3]
[3.45, 3.89]
[7.67, 8.46]
[1.1, 1.34]
[3.49, 3.89]
[7.24, 8.16]

Table I.3. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both truncated lognormal distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

3.89
11.53
24.38
4.46
12.71
25.46

[3.65, 4.11]
[11.2, 11.98]
[23.17, 26.97]
[4.11, 4.67]
[11.91, 13.48]
[24.57, 27.09]

|AOI|
0.0021
0.0025
0.0025
0.0018
0.0020
0.0006

Table I.4. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand is uniform distribution and service duration is normal distribution.

Instance

1
2
3
4
5
6
7

Termination

sample size
80
160
160
80
160
80
80

95 %CI vE
N

95 %CI vE
N (cid:48)

[1381556, 1388663]
[3966419, 3982868]
[8348880, 8374187]
[1348343, 1354935]
[3976175, 3985779]
[8342528, 8393709]
[1380734, 1389435]

[1394684, 1401987]
[3990798, 3998740]
[8389175, 8412060]
[1362006, 1364680]
[3996330, 3999179]
[8432410, 8468796]
[1394946, 1399992]

|AOI|

0.0095
0.0050
0.0047
0.0086
0.0042
0.0098
0.0089

50

8
9
10
11
12
13
14
15

80
160
160
160
160
160
80
80

[3945443, 3971844]
[8373784, 8385241]
[1998803, 2007622]
[6140490, 6161328]
[12514482, 12542256]
[2056244, 2071048]
[6123108, 6147422]
[12521793, 12572312]

– continued from previous page
0.0093
0.0041
0.0071
0.0050
0.0052
0.0064
0.0095
0.0086

[3987209, 4004585]
[8408210, 8420127]
[2015306, 2019747]
[6173546, 6189661]
[12581618, 12606323]
[2072046, 2081958]
[6179068, 6208607]
[12629120, 12682200]

Table I.5. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both truncated normal distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
80
160
160
80
160
80
80
80
160
160
160
160
160
80
80

CPU time mean (s) CPU time range (s)

0.35
2.14
4.57
0.36
2.29
2.45
0.41
1.24
6.7
1.13
3.53
7.49
1.22
1.87
4.09

[0.33, 0.41]
[2.08, 2.19]
[4.43, 4.72]
[0.33, 0.39]
[2.19, 2.42]
[2.35, 2.58]
[0.38, 0.44]
[1.21, 1.31]
[6.12, 7.04]
[1.05, 1.19]
[3.46, 3.64]
[7.13, 7.93]
[1.11, 1.38]
[1.79, 2.0]
[3.82, 5.17]

Table I.6. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both truncated normal distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

3.73
11.69
22.98
3.95
11.61
23.45

[3.59, 3.91]
[11.4, 11.94]
[22.46, 23.59]
[3.83, 4.17]
[11.38, 11.85]
[23.01, 24.09]

|AOI|
0.0017
0.0021
0.0021
0.0014
0.0018
0.0018

51

Table I.7. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand and service duration are both uniform distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
80
80
80
80
80
80
80
80
80
80
80
80
80
80
80

95 %CI vE
N

95 %CI vE
N (cid:48)

[977155, 983918]
[3068198, 3073211]
[6177607, 6185352]
[962606, 967277]
[3050475, 3055750]
[6115238, 6138472]
[1003086, 1008106]
[3014248, 3026031]
[6136129, 6161040]
[1469014, 1477824]
[4546500, 4560592]
[8915235, 8926078]
[1538918, 1545766]
[4427922, 4432286]
[8876987, 8885097]

[984647, 989363]
[3093554, 3095096]
[6221865, 6225124]
[969887, 971768]
[3071758, 3072860]
[6148787, 6177390]
[1009733, 1011627]
[3034057, 3046354]
[6171792, 6193458]
[1482836, 1490789]
[4584809, 4597373]
[8985911, 8998265]
[1551418, 1557400]
[4462700, 4465527]
[8941807, 8945098]

|AOI|

0.0066
0.0076
0.0068
0.0061
0.0062
0.0059
0.0050
0.0066
0.0055
0.0090
0.0082
0.0079
0.0078
0.0076
0.0070

52

Table I.8. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both uniform distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
80
80
80
80
80
80
80
80
80
80
80
80
80
80
80

CPU time mean (s) CPU time range (s)

0.44
1.33
2.75
0.46
1.42
3.08
0.45
1.49
3.44
0.73
2.15
4.38
0.82
2.23
4.67

[0.39, 0.56]
[1.28, 1.44]
[2.57, 3.36]
[0.41, 0.63]
[1.33, 1.68]
[2.76, 3.56]
[0.44, 0.49]
[1.39, 1.77]
[2.96, 4.14]
[0.61, 1.07]
[2.01, 2.54]
[4.2, 4.48]
[0.66, 1.38]
[2.05, 2.7]
[4.31, 5.92]

Table I.9. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both uniform distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

5.85
15.88
31.78
4.57
13.43
27.48

[5.62, 6.38]
[14.25, 18.09]
[26.83, 34.83]
[4.41, 4.92]
[13.03, 14.23]
[25.97, 31.86]

|AOI|
0.0013
0.0012
0.0010
0.0010
0.0009
0.0009

53

Appendix J. Convergence Results of model for FA decision maker at the Termi-

nation Sample Size

In this section, we show the convergence results of SAA formulation (G.2). Without spacial

mention, we will use the termination MIP Gap 0.1 % (We allowed all instances to run for one

day, however, the MIP Gaps of some instances remained at around 0.1 %). And if there are

more than 50000 iterations with no MIP Gap improvement, the Gurobi will also terminate.

Table J.1. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand and service duration are both truncated lognormal distribution.

Instance

1
3
5
7
9
11
13
15
17
19
21
23
25
27
29

Termination

sample size
10
10
10
10
10
10
10
10
10
20
10
10
10
10
10

95 %CI vF
N

95 %CI vF
N (cid:48)

[797757, 819500]
[2476877, 2515034]
[4802916, 4845726]
[902648, 930749]
[2719304, 2759871]
[5454537, 5504424]
[825863, 847786]
[2495168, 2533598]
[4832324, 4876883]
[1136585, 1156616]
[3329970, 3376483]
[6778415, 6833764]
[1305861, 1336127]
[3674874, 3730706]
[7434423, 7497220]

[808593, 810567]
[2497294, 2501413]
[4826203, 4829671]
[909915, 912329]
[2731831, 2743086]
[5489562, 5506422]
[837489, 842430]
[2516358, 2520467]
[4851456, 4856927]
[1142789, 1147654]
[3357607, 3367852]
[6799658, 6841951]
[1325533, 1331182]
[3705872, 3709887]
[7470434, 7477952]

|AOI|

0.0012
0.0014
0.0007
0.0061
0.0008
0.0034
0.0037
0.0016
0.0001
0.0012
0.0028
0.0022
0.0055
0.0014
0.0011

54

Table J.2. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both truncated lognormal distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
10
10
10
10
10
10
10
10
10
20
10
10
10
10
10

CPU time mean (s) CPU time range (s)

0.39
0.96
2.77
0.23
0.68
1.53
0.37
1.19
2.92
0.69
1.08
2.69
0.39
1.34
3.02

[0.16, 0.67]
[0.5, 1.41]
[1.94, 3.56]
[0.19, 0.29]
[0.63, 0.71]
[1.43, 1.81]
[0.33, 0.44]
[1.11, 1.36]
[2.43, 3.55]
[0.63, 0.75]
[1.05, 1.19]
[2.51, 3.06]
[0.36, 0.47]
[1.27, 1.53]
[2.87, 3.17]

Table J.3. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both truncated lognormal distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

100.7
1201.48
1021.57
78.22
487.06
353.69

[76.8, 122.77]
[933.6, 1520.07]
[877.25, 1239.94]
[69.67, 87.12]
[472.21, 518.52]
[301.54, 395.47]

|AOI|
0.0004
0.0062
0.0010
0.0005
0.0004
0.0006

Table J.4. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand and service duration are both truncated normal distribution.

Instance

1
2
3
4
5
6
7

Termination

sample size
10
10
10
10
10
10
10

95 %CI vF
N

95 %CI vF
N (cid:48)

[893882, 913589]
[2766925, 2800500]
[5282073, 5325175]
[989657, 1003856]
[3075881, 3105107]
[5844939, 5888534]
[884214, 904160]

[903220, 905948]
[2783988, 2786829]
[5304111, 5308345]
[995193, 997365]
[3089870, 3093619]
[5859421, 5874568]
[893870, 896854]

|AOI|

0.0009
0.0006
0.0005
0.0005
0.0004
0.0000
0.0013

55

8
9
10
11
12
13
14
15

10
10
20
10
10
10
10
10

[2798140, 2829687]
[5309894, 5351091]
[1280817, 1300915]
[3686181, 3722289]
[7436500, 7510222]
[1402538, 1426072]
[4016029, 4066268]
[8440223, 8499236]

– continued from previous page
0.0023
[2812171, 2828840]
0.0004
[5329231, 5335519]
0.0033
[1284966, 1288345]
0.0039
[3707673, 3729439]
0.0017
[7471978, 7499459]
0.0041
[1418141, 1422015]
0.0007
[4041444, 4046779]
0.0022
[8444406, 8458554]

Table J.5. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both truncated normal distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
10
10
10
10
10
10
10
10
10
20
10
10
10
10
10

CPU time mean (s) CPU time range (s)

0.34
0.58
1.87
0.25
0.71
1.51
0.4
1.32
4.24
0.8
1.34
2.89
0.41
1.37
2.83

[0.17, 0.89]
[0.55, 0.61]
[1.28, 5.33]
[0.22, 0.38]
[0.66, 0.77]
[1.41, 1.58]
[0.36, 0.47]
[1.03, 2.26]
[3.0, 6.91]
[0.72, 0.86]
[1.12, 1.64]
[2.64, 3.17]
[0.36, 0.44]
[1.3, 1.45]
[2.69, 3.19]

Table J.6. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both truncated normal distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

103.3
763.9
539.09
64.86
472.58
361.29

[99.91, 108.59]
[672.18, 898.69]
[348.71, 1040.81]
[58.01, 73.57]
[426.11, 531.31]
[301.67, 424.21]

|AOI|
0.0008
0.0009
0.0010
0.0028
0.0005
0.0005

56

Table J.7. The Approximate Optimality Index between the statistical lower bound and upper bound
on the objective value and 95 % Conﬁdence interval (95% CI) at the terminated sample size. The
distribution of demand and service duration are both uniform distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
10
10
10
10
10
10
10
10
10
10
10
10
10
10
10

95 %CI vF
N

95 %CI vF
N (cid:48)

[878450, 897084]
[2623308, 2648105]
[5574262, 5624156]
[978637, 998742]
[2914379, 2940861]
[6151851, 6188425]
[866115, 884066]
[2640531, 2665741]
[5587834, 5637298]
[1320896, 1343043]
[3847830, 3896153]
[7399004, 7453099]
[1372670, 1398602]
[4189521, 4244430]
[8099272, 8149726]

[888420, 894034]
[2636686, 2646287]
[5573696, 5578969]
[995634, 998667]
[2934246, 2942536]
[6169999, 6174902]
[877110, 882576]
[2655277, 2664965]
[5587666, 5594447]
[1338610, 1340305]
[3881127, 3887101]
[7431801, 7440199]
[1390656, 1392612]
[4235522, 4242783]
[8148273, 8156607]

|AOI|

0.0039
0.0022
0.0041
0.0085
0.0037
0.0004
0.0054
0.0026
0.0038
0.0056
0.0031
0.0013
0.0043
0.0052
0.0034

Table J.8. The range of CPU time at the Termination Sample Size. The distribution of demand and
service duration are both uniform distribution.

Instance

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Termination

sample size
10
10
10
10
10
10
10
10
10
10
10
10
10
10
10

CPU time mean (s) CPU time range (s)

[0.17, 0.72]
[0.52, 1.95]
[1.2, 1.39]
[0.23, 0.33]
[1.09, 3.9]
[3.72, 14.43]
[0.39, 8.84]
[1.17, 93.71]
[2.95, 4.72]
[0.34, 1.23]
[1.08, 2.05]
[2.65, 5.89]
[0.37, 7.72]
[1.23, 8.98]
[3.05, 30.12]

0.34
0.82
1.32
0.25
1.89
8.91
2.35
13.95
3.57
0.5
1.35
3.41
1.14
3.64
12.94

57

Table J.9. CPU time of SAA formulation with sample size = 500 and L = 6. The distribution of
demand and service duration are both uniform distribution.

K T CPU time mean (s) CPU time range (s)

6

8

30
90
180
30
90
180

88.04
671.75
588.94
579.79
733.06
3157.05

[83.63, 91.42]
[650.71, 688.06]
[310.25, 1189.11]
[287.39, 830.13]
[599.18, 1170.73]
[2001.41, 4666.1]

|AOI|
0.0005
0.0005
0.0002
0
0
0

58

Appendix K. Results of optimal staﬃng patterns for EA models

(a) co

l,t = 1

(b) cu

l,t = 10

Figure K.1. Total number of caregivers hired by E-SP and E-DHSCP models for Instance 7.

(a) Instance 10, demand range 1

(b) Instance 10, demand range 2

(c) Instance 7, demand range 1

(d) Instance 7, demand range 2

Figure K.2. Staﬃng patterns of EA decision-makers under cost structure (cu

l,t, co

l,t) = (10, 1).

59

           3 H Q D O W \  I R U  X Q G H U  V W D I I L Q J  cult                  7 R W D O  Q X P E H U  R I  F D U H J L Y H U V (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H   (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H             3 H Q D O W \  I R U  R Y H U  V W D I I L Q J  colt              7 R W D O  Q X P E H U  R I  F D U H J L Y H U V (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H   (  6 3   G H P D Q G  U D Q J H   (  ' + 6 & 3   G H P D Q G  U D Q J H         & D U H J L Y H U  W \ S H V              1 X P E H U (  6 3 (  ' + 6 & 3       & D U H J L Y H U  W \ S H V                                 1 X P E H U (  6 3 (  ' + 6 & 3         & D U H J L Y H U  W \ S H V      1 X P E H U (  6 3 (  ' + 6 & 3         & D U H J L Y H U  W \ S H V          1 X P E H U (  6 3 (  ' + 6 & 3Appendix L. Out-of-sample performance of EA models

Appendix L.1. Out-of-sample performance of EA models for Instance 10

(a)

(b)

(c)

Figure L.1. Out-of-sample performance for Instance 10, demand range 1 under Set 1

(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure L.2. Out-of-sample second stage cost for Instance 10, demand range 2 under Set 2

60

                7 R W D O  F R V W  H                                      1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                         6 H F R Q G  V W D J H  F R V W  H                                      1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H         1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                   6 H F R Q G  V W D J H  F R V W  H        1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                                     6 H F R Q G  V W D J H  F R V W  H                          1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                      6 H F R Q G  V W D J H  F R V W  H                 1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3      6 H F R Q G  V W D J H  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure L.3. Out-of-sample under-staﬃng for Instance 10, demand range 1 under Set 2

Appendix L.2. Out-of-sample performance of EA models for Instance 7

(a) Total cost

(b) Second stage cost

(c) Average daily under-staﬃng

Figure L.4. Out-of-sample performance for Instance 7, demand range 1 under Set 1

61

                      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H        1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3        $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                          1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                   $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H          1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                      7 R W D O  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3      6 H F R Q G  V W D J H  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                                 $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure L.5. Out-of-sample second stage cost for Instance 7, demand range 1 under Set 2

(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure L.6. Out-of-sample under-staﬃng for Instance 7, demand range 1 under Set 2

62

        6 H F R Q G  V W D J H  F R V W  H                    1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                6 H F R Q G  V W D J H  F R V W  H                          1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                      6 H F R Q G  V W D J H  F R V W  H         1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                                     6 H F R Q G  V W D J H  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                   $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H           1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3                         $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                             1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                                  1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3         $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H           1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure L.7. Out-of-sample performance for Instance 7 demand range 1 under Set 2

63

                          ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3                     ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3                       ' L V D S S R L Q W P H Q W                             1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3                                ' L V D S S R L Q W P H Q W                             1 R U P D O L ] H G  K L V W R J U D P (  6 3 (  ' + 6 & 3Appendix M. Results of optimal staﬃng patterns for FA models

(a) co

l,t = 1

(b) cu

l,t = 10

Figure M.1. Total number of caregivers hired by F-SP and F-DHSCP models for Instance 7.

(a) Instance 10, demand range 1

(b) Instance 10, demand range 2

(c) Instance 7, demand range 1

(d) Instance 7, demand range 2

Figure M.2. Staﬃng patterns of FA decision-makers under cost structure (cu

l,t, co

k,t) = (5, 2).

64

       3 H Q D O W \  I R U  X Q G H U  V W D I I L Q J  cult                7 R W D O  Q X P E H U  R I  F D U H J L Y H U V )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H   )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H         3 H Q D O W \  I R U  R Y H U  V W D I I L Q J  cokt                  7 R W D O  Q X P E H U  R I  F D U H J L Y H U V )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H   )  6 3   G H P D Q G  U D Q J H   )  ' + 6 & 3   G H P D Q G  U D Q J H         & D U H J L Y H U  W \ S H V      1 X P E H UF  6 3F  ' + 6 & 3       & D U H J L Y H U  W \ S H V          1 X P E H U )  6 3 )  ' + 6 & 3         & D U H J L Y H U  W \ S H V       1 X P E H UF  6 3F  ' + 6 & 3         & D U H J L Y H U  W \ S H V          1 X P E H UF  6 3F  ' + 6 & 3Appendix N. Out-of-sample performance of FA models

Appendix N.1. Out-of-sample performance of FA models for Instance 10

(a)

(b)

(c)

Figure N.1. Out-of-sample performance of FA models for Instance 10, demand range 2 under Set 2,
∆ = 0

(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure N.2. Out-of-sample second-stage cost of FA models for Instance 10, demand range 1 under
Set 2

65

                      7 R W D O  F R V W  H                                      5 H O D W L Y H  ) U H T X H Q F \ )  6 3 )  ' + 6 & 3                      6 H F R Q G  V W D J H  F R V W  H                                      5 H O D W L Y H  ) U H T X H Q F \ )  6 3 )  ' + 6 & 3                          $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H                                      5 H O D W L Y H  ) U H T X H Q F \ )  6 3 )  ' + 6 & 3                                 6 H F R Q G  V W D J H  F R V W  H                                      1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                   6 H F R Q G  V W D J H  F R V W  H                    1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                            6 H F R Q G  V W D J H  F R V W  H        1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                         6 H F R Q G  V W D J H  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure N.3. Out-of-sample under-staﬃng for Instance 10, demand range 1 under Set 2

Appendix N.2. Out-of-sample performance of FA models for Instance 7

(a)

(b)

(c)

Figure N.4. Out-of-sample performance of FA models for Instance 7, demand range 1 under Set 2,
∆ = 0

66

                            $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                       1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3       $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                          1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3         $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H           1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                   $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H       1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                             7 R W D O  F R V W  H                 1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                         6 H F R Q G  V W D J H  F R V W  H                 1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                          1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.25

(c) ∆ = 0.5

Figure N.5. Out-of-sample disappointment for Instance 7, demand range 1 under Set 2

(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure N.6. Out-of-sample performance of FA models for Instance 7, demand range 1 under Set 2

67

                  ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3                   ' L V D S S R L Q W P H Q W                      1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3                            ' L V D S S R L Q W P H Q W                                 1 R U P D O L ] H G  K L V W R J U D PF  6 3F  ' + 6 & 3                         6 H F R Q G  V W D J H  F R V W  H                 1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                                 6 H F R Q G  V W D J H  F R V W  H                       1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                   6 H F R Q G  V W D J H  F R V W  H          1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                6 H F R Q G  V W D J H  F R V W  H                             1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3(a) ∆ = 0

(b) ∆ = 0.1

(c) ∆ = 0.25

(d) ∆ = 0.5

Figure N.7. Out-of-sample under-staﬃng for Instance 7, demand range 1 under Set 2

68

                      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                          1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3                      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                                  1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3      $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H                    1 R U P D O L ] H G  K L V W R J U D P  H  (  6 3 (  ' + 6 & 3        $ Y H U D J H  G D L O \  X Q G H U  V W D I I L Q J   P L Q X W H   H         1 R U P D O L ] H G  K L V W R J U D P  H F  6 3F  ' + 6 & 3