manuscript No.
(will be inserted by the editor)

Model-Free Continuation of Periodic Orbits in Certain Nonlinear
Systems Using Continuous-Time Adaptive Control

Yang Li · Harry Dankowicz

Received: date / Accepted: date

Abstract This paper generalizes recent results by the au-
thors on noninvasive model-reference adaptive control de-
signs for control-based continuation of periodic orbits in pe-
riodically excited linear systems with matched uncertainties
to a larger class of periodically excited nonlinear systems
with matched uncertainties and known structure. A candi-
date adaptive feedback design is also proposed in the case
of scalar problems with unmodeled nonlinearities. In the for-
mer case, rigorous analysis shows guaranteed performance
bounds for the associated prediction and estimation errors.
Together with an assumption of persistent excitation, there
follows asymptotic convergence to periodic responses deter-
mined uniquely by an a priori unknown periodic reference
input and independent of initial conditions, as required by
the control-based continuation paradigm. In particular, when
the reference input equals the sought periodic response, the
steady-state control input vanishes. Identical conclusions fol-
low for the case of scalar dynamics with unmodeled nonlin-
earities, albeit with slow rates of convergence. Numerical
simulations validate the theoretical predictions for individ-
ual parameter values. Integration with the software package
COCO demonstrate successful continuation along families of
stable and unstable periodic orbits with a minimum of pa-
rameter tuning. The results expand the envelope of known
noninvasive feedback strategies for use in experimental model
validation and engineering design.

Keywords Control-based continuation · Model reference
adaptive control · Persistent excitation

This work is supported by Agriculture and Food Research Initiative
Competitive Grant no. 2014-67021-22109 from the USDA National
Institute of Food and Agriculture.

Yang Li · Harry Dankowicz
Department of Mechanical Science and Engineering
University of Illinois at Urbana-Champaign
E-mail: danko@illinois.edu

1 Introduction

Control-based continuation provides a model-free approach
for tracking periodic orbits of periodically excited nonlin-
ear dynamical systems, independently of their orbital stabil-
ity, under variations in experimentally accessible parame-
ters p [3,4,6,8,13,15,19,23,25,28,32,33]. More advanced
implementations also support tracking of special classes of
periodic responses, e.g., those with vanishing phase lag rela-
tive to the excitation or corresponding to fold points in one-
parameter bifurcation diagrams [1,21,22,24,29]. The ap-
proach embeds the experiment in a feedback control loop
with control input u, parameterized by an experimentally
accessible reference signal r and designed such that the re-
sponse to zero control input (u = 0) is that of the original
system. Provided that the closed-loop dynamics (including
in the control input) exhibit asymptotic convergence to limit
cycle dynamics for initial conditions in some region C , pe-
riodic reference signals in some set R, and parameter values
in some region P, control-based continuation seeks to de-
termine r ∈ R and p ∈ P such that limt→∞ u(t) = 0 given
an initial condition in C . If such can be found, then the cor-
responding steady-state dynamics must coincide with a pe-
riodic orbit of the original system, albeit with orbital stabil-
ity properties determined by the feedback control design. A
feedback control design that supports such a determination
is said to be non-invasive, since it leaves the family of peri-
odic orbits unchanged [5,9,30].

In an abstract sense, setting aside any concerns about
accuracy and precision, the control-based continuation ap-
proach is thus straightforward to implement (but see [7,26,
27]). Firstly, formulate a non-invasive feedback control de-
sign, preferably with some a priori understanding of how
to interpret the relationship between the sought reference
input and the desired, but unknown, limit cycle dynamics.
Secondly, while maintaining dynamics in C , perform iter-

2
2
0
2

p
e
S
0
3

]

C
O
.
h
t
a
m

[

4
v
6
0
3
0
1
.
3
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
2

Yang Li, Harry Dankowicz

ative updates on r and p until the control input approaches
0 asymptotically. Of course, in order to result in a ﬁnite-
dimensional problem, the latter must be preceded by dis-
cretization of the periodic reference input and a suitably cho-
sen ﬁnite-time approximation of the periodic, steady-state
control input.

In practice, the construction of a non-invasive feedback
control design may necessitate some a priori knowledge of
the dynamics near the sought periodic orbits, particularly in
order to ensure exponentially asymptotically stable limit cy-
cle dynamics for the closed-loop system. This is the case
for non-adaptive linear feedback control, for which the gains
must be chosen to ensure that all associated Floquet multi-
pliers lie inside the unit circle [1,9]. Additionally, particu-
lar feedback designs may fail to maintain dynamics in C or
even guarantee bounded response of the closed-loop system
with potentially disastrous consequences. The latter is true
for linear feedback control. Finally, even as a non-invasive
design may have been found for a particular parameter re-
gion P, it may need to be retuned repeatedly to accommo-
date larger variations in p.

Once one moves beyond non-adaptive linear feedback
control, a theoretical analysis is often restricted to particu-
lar classes of problems. In two recent papers [17,18], the
present authors investigated the use of adaptive feedback
control to overcome the challenges outlined in the previ-
ous paragraph, speciﬁcally for tracking of ﬁxed points in
a class of single-input-single-output discrete-time dynami-
cal systems and periodic orbits in a class of linear systems
with matched uncertainties. As shown there, provable per-
formance bounds were accompanied by a signiﬁcant reduc-
tion in tuning effort. This came at the expense, however, of
non-exponential rates of convergence, as well as a require-
ment that the frequency content of the reference input be suf-
ﬁciently rich to result in persistent excitation of the closed-
loop dynamics.

In this paper, we consider tracking of periodic orbits us-
ing adaptive feedback control for a larger class of dynam-
ical systems than in our previous work, assuming nonlin-
earities of known structure in the case of problems of ar-
bitrary dimension, and restricting attention to scalar prob-
lems in the case of uniformly bounded, unmodeled nonlin-
earities with uniformly bounded ﬁrst-order partial deriva-
tives. In both cases, we assume matched uncertainty, i.e.,
that an appropriately chosen control input could cancel the
inﬂuence of parameter uncertainty. We rely on versions of
the model-reference adaptive control approach and, in the
case of nonlinearities of known structure, derive guaranteed
performance bounds and demonstrate robustness to addi-
tive uniformly bounded disturbances. Integration with the
COCO continuation package shows successful tracking of
stable and unstable periodic orbits with a minimum of man-
ual tuning. In the case of unmodeled nonlinearities, it also

highlights practical challenges associated with slow rates of
convergence of the closed-loop dynamics.

The remainder of this paper is organized as follows. The
class of nonlinear systems of initial interest is deﬁned in
Section 2, which also includes a discussion of a correspond-
ing non-invasive, non-adaptive, linear feedback control de-
sign. Section 3 describes a proposed non-invasive model-
reference adaptive control algorithm and associated perfor-
mance bounds. Numerical simulations in Section 4 illustrate
the performance of the controller at a ﬁxed parameter value,
while its use for control-based continuation is explored in
Section 5 using an implementation in the COCO software
package [10]. Robustness of the control design under un-
modeled, uniformly bounded, additive disturbances is con-
sidered in Section 6. For a class of scalar systems, Section 7
relaxes the assumption that the structure of the nonlinearity
be known to the control design and demonstrates the appli-
cation of a proposed model-reference adaptive control de-
sign for parameter continuation. A brief concluding discus-
sion follows in Section 8.

2 Problem formulation

2.1 Model class

Following the discussion in [18] for a class of linear systems,
consider the dynamical system,

˙q = Aq + b (cid:0)θ TQ(t, q) + σ (cid:1) ,

(1)

where A ∈ Rn×n is a known constant Hurwitz matrix, b is a
known constant vector, θ ∈ Rm is an unknown constant vec-
tor, σ is a known periodic function of period T , and Q(t, q)
represents a known nonlinear function of t and q that is pe-
riodic in t with period T . The model form (1) reduces to that
in [18] when Q(t, q) ≡ q. For other choices of Q(t, q), (1)
captures problems with a one-dimensional nonlinearity of
arbitrary known complexity and with additional disturbance
σ along the same direction as the nonlinearity. In the case
that Q does not depend explicitly on t (this is the case con-
sidered in the numerical example in Section 4), the response
is driven by the known signal σ .

For n = 2,
(cid:18) 0
−ω 2

1
0 −2ζ ω0

A =

(cid:19)

and b =

(cid:19)

(cid:18)0
1

(2)

(1) models a single-degree of freedom oscillator with natu-
ral frequency ω0 and damping constant ζ that is acted upon
by an additional nonlinearity and periodic excitation with
angular frequency 2π/T . We may imagine the experimental
determination of families of periodic responses under vari-
ations in T as one goal of the control-based continuation
analysis.

Model-Free Continuation of Periodic Orbits in Certain Nonlinear Systems Using Continuous-Time Adaptive Control

3

For mechanical systems with more than one degree of
freedom, the form of (1) limits consideration to problems
with only one source of nonlinearity and an excitation that
is “parallel” to the nonlinearity. An example is given by the
parametrically excited two-degree-of-freedom model [34] ob-
tained with




is also periodic with period T and identically equal to 0 for
r ≈ q∗ if and only if r = q∗. By deﬁnition, the periodic func-
tion x∗ = q∗ − r satisﬁes (7) and is locally asymptotically
stable if all eigenvalues of Φ(T ) are inside the unit circle in
the complex plane. In the special case that r = q∗, it follows
that x∗(t) is identically equal to 0.

We consider the introduction of a matched scalar control






(3)

input u as shown below,
˙q = Aq + b (cid:0)u + θ TQ (t, q) + σ (cid:1) ,

(9)

A =

−






0
k01,lin+k12
m1
0
k12
m2

1
− c01+c12
m1
0
c12
m2

0
k12
m1
0
− k02+k12
m2

0
c12
m1
1
− c02+c12
m2

in terms of the linear stiffness coefﬁcients k02, k12, and k01,lin
and damping coefﬁcients c02, c12, and c01,




b = (cid:0)0 1 0 0(cid:1)T

and θ = −



(4)

1
m1



k01,nlin
kPE,1,lin
kPE,1,nlin

in terms of the unknown stiffness coefﬁcients k01,nlin, kPE,1,lin,
and kPE,1,nlin,
Q(t, q) = (cid:0)q3

1 q1 cos ΩPEt q3

1 cos ΩPEt(cid:1)T

(5)

in terms of the excitation frequency ΩPE, and σ ≡ 0. Here,
m1 and m2 are two lumped masses along a clamped-free can-
tilever beam such that a harmonic current running through
a coil imposes a time-varying, restoring force on the ﬁrst
mass that is nonlinear in displacement. Again, we may con-
sider experimental continuation of periodic responses under
variations in ΩPE.

2.2 Control objectives

Suppose that there exists a locally unique periodic (but a
priori unknown) solution q∗ of period T to (1). Due to the
nonlinearity, q∗(t) generally contains frequencies other than
ω = 2π/T . The stability of q∗ is determined by the eigenval-
ues (the Floquet multipliers of q∗) of the monodromy matrix
Φ(T ), obtained from
˙Φ = (cid:0)A + bθ TQq(t, q∗(t)))(cid:1) Φ, Φ(0) = I,

(6)

where the subscript q denotes the Jacobian with respect to
q. As long as these eigenvalues lie inside the unit circle in
the complex plane, then q∗ is locally asymptotically stable.
Asymptotic stability is not assumed, however, as we seek
to use control-based continuation to locate and track such
periodic solutions, even if unstable.

Let r(t) be a reference periodic function of period T and

deﬁne x = q − r. It follows that

˙x = Ax + bθ T (Q(t, x + r) − Q(t, r)) + g,

where
g = −˙r + Ar + b (cid:0)θ TQ(t, r) + σ (cid:1)

(7)

(8)

with the aim of having u determined by q and r, such that
u converges to a periodic steady-state signal that is uniquely
determined by r and equal to 0 for r ≈ q∗ and q(0) ≈ q∗(0)
if and only if r = q∗, in which case q(t) → q∗(t) as t → ∞.
We refer to such a control design as non-invasive along the
sought periodic orbit. By deﬁnition of x, we obtain

˙x = Ax + bθ T (Q(t, x + r) − Q(t, r)) + bu + g

(10)

and it follows that the construction of a non-invasive design
along the sought periodic orbit needs to ensure that u(t) → 0
for r ≈ q∗ and x(0) ≈ 0 if and only if g(t) ≡ 0, and that
x(t) → 0 in this case.

2.3 Proportional feedback

As an example, let

u = −kT (Q(t, q) − Q(t, r))

(11)

for some to-be-determined constant vector k. Substitution
yields

˙x = Ax + b(θ − k)T (Q(t, x + r) − Q(t, r)) + g.

(12)

It follows that u(t) → 0 for r ≈ q∗ and x(0) ≈ 0 if g(t) ≡ 0
provided that all the eigenvalues of the monodromy matrix
Φ(T ) lie inside the unit circle, where Φ(t) in this case is
governed by
˙Φ = (cid:0)A + b(θ − k)TQq(t, r)(cid:1) Φ, Φ(0) = I,

(13)

and that x(t) → 0 in this case. The control design in (11)
is clearly non-invasive along the periodic orbit in the case
when k = θ . Importantly, given the local character of this
control law, there is no a priori degree of closeness that will
guarantee the convergence of x and u, nor are bounds avail-
able on transient deviations from 0.

It is clear that x(t) cannot converge to 0 if g (cid:54)= 0 under
the control law (11). Under exceptional circumstances, it is
still possible that u(t) → 0 if Q(t, x + r) − Q(t, r) converges
to a signal in the orthogonal complement of k, in violation of
our articulated objective. This possibility may be excluded
on a case-by-case basis or, in the case of (11), eliminated
entirely by requiring that x(t) → 0 if and only if g(t) ≡ 0.

4

Yang Li, Harry Dankowicz

3 Model-reference adaptive control strategy

It follows that

In the absence of knowledge about θ , the selection of k in
(11) such that all Floquet multipliers have magnitude less
than 1 is, at best, trial-and-error. As an alternative, we con-
sider a form of model-reference adaptive control [14] that
relies on an adaptive estimate of θ to achieve the stated ob-
jective. We show that this is non-invasive along the sought
periodic orbit under generic conditions. As a side beneﬁt,
we obtain guaranteed bounds on the transient and steady-
state dynamics.

3.1 Control design

To this end, consider the control law

u = − ˆθ T (Q(t, q) − Q(t, r)) ,

(14)

where ˆθ (t) denotes a time-dependent estimate of θ , such
that
˙ˆθ = −Γ eTPbQ(t, q),

(15)

deﬁnes the adaptive dynamics in terms of the adaptation
gain Γ > 0. As usual, P is a positive deﬁnite matrix that
satisﬁes the algebraic Lyapunov equation PA + ATP = −S
for some positive deﬁnite matrix S. The prediction error
e = xm − x is deﬁned in terms of the reference state xm gov-
erned by the differential equation

˙xm = Axm + b ˜θ TQ(t, r) + g,

where ˜θ = ˆθ − θ is the estimation error. It follows that

˙e = Ae + b ˜θ TQ(t, q).

(16)

(17)

Notably, while ˜θ appears explicitly in (16), terms involving
θ cancel out of the sum of the last two terms, ensuring that
(15) and (16) are implementable.

3.2 Lyapunov analysis

Now let B denote a ball of Euclidean radius R such that
θ ∈ B, and assume that the initial conditions are chosen so
that xm(0) = x(0), i.e., e(0) = 0, and ˆθ (0) ∈ B. Then, the
Lyapunov function

(cid:107)e(t)(cid:107)2 ≤

2R
(cid:112)λmin(P)Γ

,

where λmin(P) is the smallest eigenvalue of P, and

(cid:107) ˜θ (t)(cid:107)2 ≤ 2R.

(21)

(22)

Since Q(t, r) and g(t) are also uniformly bounded, it follows
from (16) and the fact that A is Hurwitz that xm is bounded,
and consequently, that x and q are bounded. Equation (14)
then implies that u is bounded.

By the above analysis, e and ˙e are both bounded. This
implies that ¨V is bounded and, by Barbalat’s lemma [14],
that ˙V (t) → 0, which in turn implies that e(t) → 0, i.e., that
xm(t) → x(t) and, consequently, ˙˜θ (t) → 0. Moreover, since
¨e is bounded, it follows that ˙e(t) → 0 and, consequently,
˜θ T(t)Q(t, q) → 0.

3.3 Persistent excitation

In order to conclude that ˜θ (t) → 0, suppose that the refer-
ence input r is chosen so that the signal Q(t, q) is persistently
exciting [12,20], i.e., that the smallest eigenvalue of the (at
least positive semi-deﬁnite) matrix

(cid:90) t+T

t

Q(τ, q(τ))QT(τ, q(τ)) dτ

(23)

is bounded from below by a positive number α for all t. Al-
though we cannot conﬁrm the persistence of excitation of
the signal Q(t, q) a priori, we may consider the integral ob-
tained by replacing q(t) with r(t) in (23), since r is assumed
to be close to q∗ in practice. Since the integrand then be-
comes periodic, it sufﬁces to compute its value for t = 0.

It now follows from the mean-value theorem and the ob-
servation that ˙˜θ (t) → 0 that for every τ ∈ [t,t + T ], there ex-
ists a σ ∈ [t,t + T ] such that ˜θ (τ) − ˜θ (t) = τ ˙˜θ (σ ) ≤ T M(t)
for some function M(t) → 0 as t → ∞. Consequently,

(cid:90) t+T

t

˜θ T(τ)Q(τ, q(τ))QT(τ, q(τ)) ˜θ (τ) dτ

= ˜θ T(t)

(cid:18)(cid:90) t+T

t

Q(τ, q(τ))QT(τ, q(τ)) dτ

(cid:19)

˜θ (t) + ε(t),

V = eTPe +

1
Γ

˜θ T ˜θ

satisﬁes

˙V = −eTSe ≤ 0,

and, consequently,

(18)

where ε(t) → 0 as t → ∞. Consequently,

(cid:90) t+T

(19)

t

˜θ T(τ)Q(τ, q(τ))QT(τ, q(τ)) ˜θ (τ) dτ − ε(t)

≥ α(cid:107) ˜θ (t)(cid:107)2
2.

(24)

(25)

V (t) ≤ V (0) =

1
Γ

(cid:107) ˜θ (0)(cid:107)2

2 ≤

4R2
Γ

.

(20)

Since the left-hand side converges to 0 and the right-hand
side is bounded from below by 0, it follows that ˜θ (t) → 0.

Model-Free Continuation of Periodic Orbits in Certain Nonlinear Systems Using Continuous-Time Adaptive Control

5

Since ˜θ (t) → 0 and ˙˜θ is bounded, the classical result of
Desoer [11] and Solo [31] applied to the governing equation

˙x = Ax − b ˜θ T (Q(t, x + r) − Q(t, r)) + g

(26)

implies that x(t) and, consequently, u(t) both converge to
periodic steady-state responses that are uniquely determined
by g, and that x(t) → 0 if and only if g ≡ 0. We conclude that
the model-reference adaptive control design is non-invasive
along the sought periodic orbit. Generically, we again expect
that u(t) (cid:57) 0 when g (cid:54)= 0.

4 Numerical simulations

In this section, we explore the predictions from Section 3
regarding the boundedness of the prediction and estimation
errors, as well as the convergence of ˜θ (t) to 0 under suitable
conditions on the reference input r.

As an example, consider the dynamical system (1) with

Fig. 1 The steady-state responses of x(t) and u(t) under the proposed
model-reference adaptive control strategy with r(t) given in (30).

A =

(cid:18) 0

(cid:19)

1

−1.5 −0.5

, b =

(cid:19)

(cid:18)0
1

, θ =





0.5
0.4
−0.04



 ,

(27)

1

(cid:1)T

Q(t, q) = (cid:0)q1 q2 q3
, and σ = sin ωt. This corresponds to a
harmonically excited Dufﬁng oscillator in which the damp-
ing, stiffness, and nonlinearity coefﬁcients are assumed un-
known to the control design. For ω = 1, there exists a peri-
odic steady-state response q∗ given by

q∗
1(t) ≈ −0.9928 cost + 2.9876 sint + 0.0336 cos 3t

− 0.0255 sin 3t − 0.0005 cos 5t + 0.00002 sin 5t,

(28)

q∗
2(t) ≈ 2.9876 cost + 0.9928 sint − 0.0765 cos 3t

− 0.1008 sin 3t + 0.0001 cos 5t + 0.0025 sin 5t.

(29)

It is easy to check that Q(t, q∗) is persistently exciting since
the integral in (23) is independent of t and positive deﬁnite
with smallest eigenvalue approximately equal to 3.2.

Without loss of generality, we restrict attention to func-
tions r(t) chosen so that ˙r − Ar is parallel to b for all time,
since this must be true of the desired reference input for
which g ≡ 0. Consider the two choices of r(t) = q∗(t) and

r(t) =

(cid:18)cost + sint
cost − sint

(cid:19)

.

(30)

The steady-state solution to ˙x = Ax + g is then given by
x(t) = 0 and the periodic function shown in Fig. 1, respec-
tively. The nonlinearity Q(t, x + r) is persistently exciting
also in the latter case, since the smallest positive eigenvalue
of the integral (23) is again independent of t and equal to
1.0.

Suppose that q(0) = 0 and ˆθ (0) = 0, and let
(cid:18)8/3 1/3
1/3 5/3

, Γ = 1.

(cid:19)

P =

(31)

The system response under the proposed model-reference
adaptive control strategy with r(t) = q∗(t) up to the ﬁfth har-
monic is shown in Fig. 2. It is seen that (cid:107)e(t)(cid:107) and (cid:107) ˜θ (t)(cid:107)
both go to 0 as t → ∞. Similarly, to within the resolution of
the ﬁrst ﬁve harmonics, (cid:107)x(t)(cid:107) and (cid:107)u(t)(cid:107) also converge to
0.

The system response with r(t) given in (30) is shown
in Fig. 3. It is seen that again, (cid:107)e(t)(cid:107) and (cid:107) ˜θ (t)(cid:107) both con-
verge to 0 as t → ∞. Since r deviates from a periodic steady-
state response of the system, (cid:107)x(t)(cid:107) and (cid:107)u(t)(cid:107) converge to
nonzero periodic responses, as predicted by the analysis in
the previous section.

For each of these two cases, Fig. 4 shows the time histo-
ries of the smallest eigenvalue of the integral in (23). Since
these are bounded below by some positive numbers (and, in-
deed, converge to the predicted values obtained by substitut-
ing q = x + r with x being the unique solution to ˙x = Ax + g),
Q(t, q) is persistently exciting in both cases. This is also con-
sistent with the general theory that ensures persistent exci-
tation provided that the frequency content exceeds a multi-
ple of the system dimension. Here, this is guaranteed by the
nonlinearity.

5 Control-based continuation

The theoretical treatment in Section 3 shows that we may
identify an a priori unknown periodic response q∗ by the

200210220230240250-2-1012x1x2200210220230240250t-1-0.500.511.5Steady-stateresponseu6

Yang Li, Harry Dankowicz

Fig. 2 The system response under the proposed model-reference adap-
tive control strategy with r(t) ≈ q∗(t) given by the up-to-ﬁfth-harmonic
approximation in (28)-(29). The predicted bounds on (cid:107)e(t)(cid:107)2 and
(cid:107) ˜θ (t)(cid:107)2 approximately equal 1.28 and 1.03, respectively.

Fig. 3 The system response under the proposed model-reference adap-
tive control strategy with r(t) given in (30). The predicted bounds on
(cid:107)e(t)(cid:107)2 and (cid:107) ˜θ (t)(cid:107)2 approximately equal 1.28 and 1.03, respectively.

fact that u(t) → 0 as t → ∞ provided that the reference in-
put r happens to equal q∗. In this section, we use Newton’s
method to iteratively improve upon the reference input in or-
der for the steady-state control input to fall within a thresh-
old distance from 0, thereby obtaining an approximation of
q∗. As in the previous section, we restrict attention to r cho-

Fig. 4 The smallest eigenvalue of the integral in (23) as a function of
t, with r(t) ≈ q∗(t) given by the up-to-ﬁfth-harmonic approximation
in (28)-(29) and (30), respectively, under the model reference adaptive
control.

sen so that ˙r − Ar is parallel to b, i.e., such that r may be
parameterized by a scalar periodic function of the same di-
mension as the control input. We proceed to use simulations
of the closed-loop dynamics to estimate the coefﬁcients of
a truncated Fourier series of the steady-state control input
and their derivatives with respect to the corresponding coef-
ﬁcients of r and modify the coefﬁcients of r accordingly.

We combine the application of Newton’s method with
a pseudo-arclength continuation algorithm [10] in order to
trace q∗ under variations in a model parameter, say ω in the
example in Section 4, also past geometric folds where the
assumption of existence and local uniqueness of q∗ for ﬁxed
ω would fail. Here, an approximation to the tangent line of
the graph of (ω, q∗) at a particular point on this graph is used
to construct a predictor (ω, r) some distance h from (ω, q∗)
along the tangent line. We proceed to require that all subse-
quent iterates of Newton’s method lie on a line perpendicu-
lar to the tangent and intersecting the tangent at the predic-
tor. We initialize the overall algorithm at some point (ω, q∗)
obtained for example using forward simulation in the case
that the corresponding q∗ is asymptotically stable. Impor-
tantly, convergence of the Newton iterations is independent
of the open-loop stability of q∗. Also, since r remains close
to q∗, g is close to 0 for all iterations and the adaptive control
strategy ensures the desired convergence.

Consistent with the implementation of the continuation
algorithm in a physical experiment, we assume no direct
control over the state q, for example its value at any moment
in time. Other than the ﬁrst simulation of the closed-loop
dynamics, we initialize q at its terminal value in the preced-
ing simulation. We similarly initialize ˆθ for each simulation
at its terminal value in the preceding simulation, thus ensur-
ing close tracking by x of the reference state xm, since θ is
assumed to vary smoothly with the model parameter.

02040608000.20.40.60.8kek2k~3k2020406080t0510Systemresponsekxk2kuk202040608000.20.40.60.8kek2k~3k2020406080t01234Systemresponsekxk2kuk2050100150t0123456Smallesteigenvaluer=q$r6=q$Model-Free Continuation of Periodic Orbits in Certain Nonlinear Systems Using Continuous-Time Adaptive Control

7

Since it is not possible to obtain an exact match of r and
q∗, given the presence of harmonics of all orders, we select a
truncation order that (empirically) yields sufﬁcient informa-
tion about q∗ while also ensuring that Q(t, q) is persistently
exciting. We avoid aliasing by applying the discrete Fourier
transform to a ﬁne sample of a period of the steady-state
control input.

Figure 5 shows the successful application of the control-
based continuation algorithm, implemented in the software
package COCO [10], to the example in Section 4 under vari-
ations in ω and with control parameters P and Γ as given
there. Throughout continuation, we approximate u by its
truncated Fourier series up to the ﬁfth harmonic and iter-
atively update the corresponding coefﬁcients of r. In each
iteration, and when approximating derivatives with respect
to the Fourier coefﬁcients of r, the Matlab integrator ode45
(with relative tolerance 10−8 and absolute tolerance 10−10)
is used to simulate the closed-loop transient dynamics for 10
periods, followed by a sampling of the control input during
one additional period of simulation. We consider r to have
converged to q∗ when the norm of the Fourier coefﬁcients
of the steady-state control input is smaller than 10−6. The
step size along the graph (ω, q∗) is adaptively determined
by COCO using default settings. As seen in the ﬁgure, the al-
gorithm is able to trace out the solution branch independent
of the open-loop stability of the periodic solutions (which
are unstable along the middle branch in the range of coex-
isting periodic solutions).

Fig. 5 A comparison between branches of periodic solutions of the
harmonically excited nonlinear Dufﬁng oscillator obtained using up-
ward and downward sweeps in the excitation frequency ω (represented
by (cid:107)q∗
1(ω)(cid:107)L∞ ), and those obtained using the control-based continu-
ation algorithm with the proposed model reference adaptive control
strategy (represented by (cid:107)r1(ω)(cid:107)L∞ ).

6 Robustness

In practice, the presence of unmodeled disturbances may
limit the utility of the proposed methodology, both in terms
of the expected convergence of u(t) to 0 as t → ∞ when the
reference signal r is chosen appropriately, and in terms of
any guarantees on a bounded response.

Consider, for example, the introduction in the closed-
loop dynamics of an additive, uniformly bounded, unknown
disturbance h(t, q):
˙q = Aq + b (cid:0)u + θ TQ (t, q) + σ (cid:1) + h(t, q),

(32)

where u is given in (14). With x = q − r, e = xm − x, and xm
again governed by
˙xm = Axm + b ˜θ TQ(t, r) − ˙r + Ar + b (cid:0)θ TQ(t, r) + σ (cid:1) ,

(33)

it then follows that

˙e = Ae + b ˜θ TQ (t, q) − h(t, q).

(34)

Given the Lyapunov function in (18), the adaptation law (15)
implies that

˙V = −eTSe + 2eTPh(t, q).

(35)

Because of the second term on the right-hand side, we can
no longer claim that ˙V ≤ 0 or e → 0 as t → ∞. It is still the
case that e is bounded, however. Indeed, if hb denotes an
upper bound for (cid:107)h(t, q)(cid:107), then

˙V (t) ≤ −λmin(S)(cid:107)e(cid:107)2 + 2(cid:107)e(cid:107)λmax(P)hb.

Consequently, ˙V < 0 when

(cid:107)e(cid:107) > 2

λmax(P)
λmin(S)

hb.

(36)

(37)

While this implies that (cid:107)e(cid:107) is eventually upper bounded by
the right hand side of (37), boundedness of ˆθ does not fol-
low. To achieve this, and by implication the boundedness of
x, q, and u, we may modify the adaptation law using a pro-
jection operator [14]

˙ˆθ = Γ ProjB

(cid:0) ˆθ , −eTPbQ (t, q)(cid:1) , ˆθ (0) = ˆθ0.

(38)

With this modiﬁcation, the proposed model-reference adap-
tive control design guarantees a bounded response given a
uniformly bounded additive disturbance h(t, q), a reassuring
prediction for any actual implementation in a physical ex-
periment.

In the special case that h(t, q) is periodic in t with period
T , the unique, locally attractive limit cycle dynamics of the
closed-loop system obtained when h ≡ 0 and r ≈ q∗ persist
for sufﬁciently small (cid:107)h(cid:107)∞. In this case, if r is chosen so that

˙r = Ar + b (cid:0)θ TQ(t, r) + σ (cid:1) + h(t, r)

(39)

00.511.522.5!01234567kq$1(!)kL1;kr1(!)kL1UpwardsweepDownwardsweepMRACYang Li, Harry Dankowicz

Indeed, for ˆk(0) > 0, |x(t)| cannot exceed max{gb, |x(0)|},
since |x(t∗)| > gb at some instant t∗ implies that ˙V (t∗) < 0
and, consequently, that x(t∗) ˙x(t∗) < 0. If, instead, ˆk(0) < 0,
b, x2(0)} + ˆk2(0)/Γ and the
then V cannot exceed max{g2
a2 + b2 ≤ |a|+|b|. Since
bound follows from the inequality
r is bounded, this is also true of q.

√

If gq=r(t) does not vanish identically, ˆk must grow with-
out bounds. In this case, x(t), ˙x(t) → 0 (due to the bounded-
ness of g and its partial derivatives with respect to q and t)
and, consequently, that q(t) → r(t) and u(t) → −gq=r(t) as
t → ∞, independently of initial conditions. The same conclu-
sions follow if gq=r(t) ≡ 0 although, in this case, ˆk saturates
at some ﬁnite positive value.

These predictions are conﬁrmed by the results of nu-
merical simulations shown in Figs. 6 and 7 obtained with
r(t) given by the right-hand side of (42) and r(t) = cos(t) +
sin(t), respectively. In each case, Γ = 100 and q(0) = ˆk(0) =
0.

8

then

˙x = Ax − b ˜θ T (Q(t, x + r) − Q(t, r))
+ h(t, x + r) − h(t, r)

(40)

and we conclude that x(t) ≡ 0 along the perturbed limit cycle
and q → r locally if and only if r is chosen in this way.

In the case that h is not periodic in t, we cannot expect
local persistence. In this case, the control-based continua-
tion algorithm fails to trace out the solution branch, since it
is no longer the case that u(t) converges to 0 as t → ∞ when
r = q∗ if the disturbance persists. Given additional informa-
tion about the disturbance, it may be possible to substitute
the requirement that u(t) → 0 with a condition on a suitably
ﬁltered version of u(t). In either case, bounded performance
is guaranteed.

7 Systems with unmodeled nonlinearities

In this section, we attempt to relax the expectation that the
form of the nonlinearity be known to the control design and
accessible to the feedback law. As a ﬁrst step in this direc-
tion, consider the example system

˙q = −q + sin q + sin ωt + u, q ∈ R.

(41)

When u = 0, there exists a periodic solution q∗(t) for ω = 1
given by

q∗(t) ≈ −0.9849 cost + 0.1160 sint + 0.0053 cos 3t
+ 0.0115 sin 3t + 0.0002 cos 5t − 0.0003 sin 5t.

(42)

Next, let x = q − r and u = −ˆkx, and consider the closed-

loop dynamics of the system
˙x = −(1 + ˆk)x + g, ˙ˆk = Γ x2

where

g = sin q + sin ωt − ˙r − r

(43)

(44)

for some periodic reference input r. We note that x ≡ 0 is
a solution of this system provided that g|q=r ≡ 0, i.e., that
r is a periodic solution of the open-loop dynamics. Indeed,
when this is not the case, ˆk is non-decreasing and must grow
beyond all bounds as t → ∞. Given the Lyapunov function

Fig. 6 Time histories of ˆk(t), x(t), u(t), and u(t) + g(t) of the system
deﬁned in (41) at ω = 1 under the proposed model-reference adaptive
control strategy, where r(t) ≈ q∗(t) given by the up-to-ﬁfth-harmonic
approximation in (42).

V = x2 +

1
Γ

ˆk2,

it follows that

˙V (t) = −2x2 + 2xg.

(45)

(46)

Let gb denote an upper bound on the magnitude of g. Then,
since ˆk is a non-decreasing function of time,

|x(t)| ≤ max{gb, |x(0)|} + |ˆk(0)|/

Γ .

√

(47)

The observations for the example system (41) generalize

to a scalar system of the form

˙q = aq + b (kq + f (t, q) + σ + u) ,

(48)

where a < 0 and b (cid:54)= 0 are known constants, k is an un-
known constant, and f (t, q) represents a uniformly bounded,
unmodeled nonlinearity with uniformly bounded ﬁrst-order
partial derivatives. This reduces to the example system in
(41) when a = −1, b = 1, k = 0, and f (t, q) = sin q.

00.511.522.53024681012^k00.511.522.53t-4-202Systemresponsexuu+gModel-Free Continuation of Periodic Orbits in Certain Nonlinear Systems Using Continuous-Time Adaptive Control

9

with respect to the Fourier coefﬁcients of r, the Matlab in-
tegrator ode45 (with relative tolerance 10−8 and absolute
tolerance 10−10) is used to simulate the closed-loop tran-
sient dynamics for 10 periods, followed by a sampling of
the control input during one additional period of simulation.
We consider r to have converged to q∗ when the norm of
the Fourier coefﬁcients of the steady-state control input is
smaller than 10−3. The step size along the graph (ω, q∗) is
adaptively determined by COCO using default settings. The
result is shown in Fig. 8.

Fig. 7 Time histories of ˆk(t), x(t), u(t), and u(t) + g(t) of the system
deﬁned in (41) at ω = 1 under the proposed model-reference adaptive
control strategy, where r(t) = cos(t) + sin(t).

With the introduction of a control input u = −ˆkx in terms

of the deviation x = q − r, it follows that

˙x = (a − b˜k)x + g,

where ˜k = ˆk − k and

g = (a + bk)r + b ( f (t, q) + σ ) − ˙r.

If we let

˙ˆk = Γ bx2

and deﬁne the Lyapunov function

V = x2 +

1
Γ

˜k2,

it follows by the same argument as for the example that
|x(t)| ≤ max{−gb/a, |x(0)|} + (cid:12)

(cid:12)ˆk(0) − k(cid:12)
(cid:12) /

Γ ,

√

(49)

(50)

(51)

(52)

(53)

where gb denotes the upper bound for |g|∞. By the uniform
boundedness of f and its partial derivatives, we again con-
clude that x(t), ˙x(t) → 0 and, consequently, q(t) → r(t) and
u(t) → −gq=r(t) as t → ∞.

We proceed to consider the application of the control-
based continuation paradigm to the system (41) with Γ = 1.
Here, the initial value of the adaptation parameter ˆk(0) is
set to 0 in each simulation. Throughout continuation, we ap-
proximate u by its truncated Fourier series up to the ﬁfth har-
monic and iteratively update the corresponding coefﬁcients
of r. In each iteration, and when approximating derivatives

Fig. 8 A comparison between the branch of periodic solutions of
the scalar system deﬁned in (43) obtained using an upward sweep
in ω (represented by (cid:107)q∗(ω)(cid:107)L∞ ), and that obtained using control-
based continuation under the proposed model-reference adaptive con-
trol strategy (represented by (cid:107)r(ω)(cid:107)L∞ ).

Notably, the convergence criterion tolerance is here set
orders of magnitude larger than the COCO default (which
is 10−6). Indeed, we observe that x(t) remains close to 0
throughout continuation, resulting in slow dynamics of the
adaptation parameter ˆk and, consequently, slow rates of con-
vergence of u(t) to −g(t), as required by the control-based
continuation paradigm. Although we might be able to im-
prove upon this state of affairs by setting ˆk(0) to a larger
number, this would likely produce large transient dynam-
ics, including in the control input, making this impractical
in physical experiments.

8 Conclusion

As shown in the previous sections, although adaptive con-
trol designs may be proposed for control-based continua-
tion of periodic orbits, signiﬁcant effort may be required
to prove their non-invasiveness and ensure bounded perfor-
mance and robustness to disturbances, if at all possible. Nev-
ertheless, the beneﬁts over non-adaptive control designs may

02040608010001020304050^k020406080100t-4-20246Systemresponsexuu+g10

Yang Li, Harry Dankowicz

be equally signiﬁcant, especially in examples where the lin-
earized dynamics near the sought periodic orbits vary greatly
over the parameter range of interest.

It may be reasonably argued that a great number of chal-
lenges must be overcome in order to fully realize the po-
tential of control-based continuation already without con-
sidering the complexity of self-tuning feedback control de-
signs. Indeed, recent work by Renson, Barton, Sieber, and
their collaborators has explored the merger of control-based
continuation techniques with data-based approaches such as
Gaussian process regression [21,26] for estimating the lo-
cal manifold geometry and adaptive ﬁlters [2] that update
the reference input on the ﬂy. The development of the CON-
TINEX toolbox [27] for COCO also highlighted the many
challenges associated with continuation in the presence of
measurement noise. It would be worthwhile to consider if
algorithms for data-based adaptive accommodation of noise
and uncertainty along families of periodic orbits could be
co-designed with the adaptive feedback control used to lo-
cate individual orbits in order to improve overall perfor-
mance.

For those inclined to explore more general classes of
nonlinear problems, for example multi-dimensional systems
with unmodeled nonlinearities, we refer to preliminary work
described in Chapter 5 of the ﬁrst author’s doctoral disserta-
tion [16]. There, promising numerical results and guaranteed
boundedness of the closed-loop system response (for some
proposed choices of adaptive feedback designs) do not com-
pensate for the lack of proofs of the existence of asymptot-
ically stable limit cycle dynamics, nor the independence of
the steady-state control input from initial conditions. Much
work remains to be done.

References

1. Abeloos, G., M¨uller, F., Ferhatoglu, E., Scheel, M., Collette, C.,
Kerschen, G., Brake, M., Tiso, P., Renson, L., Krack, M.: A
consistency analysis of phase-locked-loop testing and control-
based continuation for a geometrically nonlinear frictional sys-
tem. Mechanical Systems and Signal Processing 170 (2022). DOI
10.1016/j.ymssp.2022.108820

2. Abeloos, G., Renson, L., Collette, C., Kerschen, G.: Stepped
and swept control-based continuation using adaptive ﬁltering.
Nonlinear Dynamics 104(4), 3793–3808 (2021). DOI 10.1007/
s11071-021-06506-z

3. Barton, D.: Control-based continuation: Bifurcation and stability
analysis for physical experiments. Mechanical Systems and Signal
Processing 84, 54–64 (2017). DOI 10.1016/j.ymssp.2015.12.039
4. Barton, D., Burrow, S.: Numerical continuation in a physical ex-
periment: Investigation of a nonlinear energy harvester. Journal
of Computational and Nonlinear Dynamics 6(1) (2011). DOI
10.1115/1.4002380

5. Barton, D., Mann, B., Burrow, S.: Control-based continuation for
investigating nonlinear experiments.
Journal of Vibration and
Control 18(4), 509–520 (2012). DOI 10.1177/1077546310384004
6. Barton, D., Sieber, J.: Systematic experimental exploration of bi-
furcations with noninvasive control. Physical Review E - Sta-

tistical, Nonlinear, and Soft Matter Physics 87(5) (2013). DOI
10.1103/PhysRevE.87.052916

7. Beregi, S., Barton, D., Rezgui, D., Neild, S.: Robustness of nonlin-
ear parameter identiﬁcation in the presence of process noise using
control-based continuation. Nonlinear Dynamics 104(2), 885–900
(2021). DOI 10.1007/s11071-021-06347-w

8. Bureau, E., Schilder, F., Elmeg˚ard, M., Santos, I., Thomsen,
J., Starke, J.: Experimental bifurcation analysis of an impact
oscillator-determining stability. Journal of Sound and Vibration
333(21), 5464–5474 (2014). DOI 10.1016/j.jsv.2014.05.032
9. Bureau, E., Schilder, F., Ferreira Santos, I., Juel Thomsen, J.,
Starke, J.: Experimental bifurcation analysis of an impact oscilla-
tor - tuning a non-invasive control scheme. Journal of Sound and
Vibration 332(22), 5883–5897 (2013). DOI 10.1016/j.jsv.2013.
05.033

10. Dankowicz, H., Schilder, F.: Recipes for Continuation, vol. 11.

SIAM (2013)

11. Desoer, C.: Slowly varying system ˙x = a(t)x. IEEE Transactions
on Automatic Control 14(6), 780–781 (1969). DOI 10.1109/TAC.
1969.1099336

12. Jenkins, B., Annaswamy, A., Lavretsky, E., Gibson, T.: Conver-
gence properties of adaptive systems and the deﬁnition of ex-
ponential stability. SIAM Journal on Control and Optimization
56(4), 2463–2484 (2018). DOI 10.1137/15M1047805

13. Kleyman, G., Paehr, M., Tatzko, S.: Application of control-based-
continuation for characterization of dynamic systems with stiff-
ness and friction nonlinearities. Mechanics Research Communi-
cations 106 (2020). DOI 10.1016/j.mechrescom.2020.103520
14. Lavretsky, E., Wise, K.: Robust and Adaptive Control: With
Aerospace Applications. Advanced Textbooks in Control and Sig-
nal Processing. Springer London (2012)

15. Lee, K., Barton, D., Renson, L.: Model identiﬁcation of a ﬂut-
tering aerofoil using control-based continuation and normal form
analysis. In: Proceedings of the International Conference on Noise
and Vibration Engineering, ISMA 2020, and the International
Conference on Uncertainty in Structural Dynamics, USD 2020,
Leuven, Belgium, pp. 261–268 (2020)

for enhanced performance of de-
16. Li, Y.: Adaptive control
Ph.D. thesis, University of Illinois at
vices and algorithms.
Urbana-Champaign (2019). URL http://hdl.handle.net/
2142/106152

17. Li, Y., Dankowicz, H.: Adaptive control designs for control-based
continuation in a class of uncertain discrete-time dynamical sys-
Journal of Vibration and Control 26(21-22), 2092–2109
tems.
(2020). DOI 10.1177/1077546320913377

18. Li, Y., Dankowicz, H.: Adaptive control designs for control-based
continuation of periodic orbits in a class of uncertain linear sys-
tems. Nonlinear Dynamics 103(3), 2563–2579 (2021). DOI
10.1007/s11071-021-06216-6

19. Misra, S., Dankowicz, H., Paul, M.: Event-driven feedback track-
ing and control of tapping-mode atomic force microscopy. Pro-
ceedings of the Royal Society A: Mathematical, Physical and En-
gineering Sciences 464(2096), 2113–2133 (2008). DOI 10.1098/
rspa.2007.0016

20. Narendra, K., Annaswamy, A.: Persistent excitation in adaptive
systems. International Journal of Control 45(1), 127–160 (1987).
DOI 10.1080/00207178708933715

21. Renson, L.: Identiﬁcation of backbone curves and nonlinear fre-
quency responses using control-based continuation and local gaus-
sian process regression. In: Conference Proceedings of the Soci-
ety for Experimental Mechanics Series, pp. 83–85 (2021). DOI
10.1007/978-3-030-47626-7 13

22. Renson, L., Barton, D., Neild, S.: Experimental tracking of limit-
point bifurcations and backbone curves using control-based con-
International Journal of Bifurcation and Chaos 27(1)
tinuation.
(2017). DOI 10.1142/S0218127417300026

Model-Free Continuation of Periodic Orbits in Certain Nonlinear Systems Using Continuous-Time Adaptive Control

11

Competing Interests The authors have no relevant ﬁnancial
or non-ﬁnancial interests to disclose.

Author Contributions The authors contributed equally to the
conception and design of this research, and to the writing of
the manuscript. Implementation of algorithms in code and
generation of numerical results was performed by Yang Li.
Both authors read and approved the ﬁnal manuscript.

Data Availability Datasets generated and analyzed during
this study are available upon request from the authors. Mat-
lab scripts sufﬁcient to generate this data will be posted to
an open-source archive.

23. Renson, L., Ehrhardt, D., Barton, D., Neild, S., Cooper, J.: Con-
necting nonlinear normal modes to the forced response of a geo-
metric nonlinear structure with closely spaced modes. In: Proceed-
ings of the International Conference on Noise and Vibration Engi-
neering, ISMA 2016, and the International Conference on Uncer-
tainty in Structural Dynamics, USD 2016, Leuven, Belgium, pp.
2775–2784 (2016)

24. Renson, L., Gonzalez-Buelga, A., Barton, D., Neild, S.: Robust
identiﬁcation of backbone curves using control-based continua-
tion. Journal of Sound and Vibration 367, 145–158 (2016). DOI
10.1016/j.jsv.2015.12.035

25. Renson, L., Shaw, A., Barton, D., Neild, S.: Application of
control-based continuation to a nonlinear structure with harmoni-
cally coupled modes. Mechanical Systems and Signal Processing
120, 449–464 (2019). DOI 10.1016/j.ymssp.2018.10.008

26. Renson, L., Sieber, J., Barton, D., Shaw, A., Neild, S.: Numerical
continuation in nonlinear experiments using local gaussian pro-
cess regression. Nonlinear Dynamics 98(4), 2811–2826 (2019).
DOI 10.1007/s11071-019-05118-y

27. Schilder, F., Bureau, E., Santos, I., Thomsen, J., Starke, J.: Exper-
imental bifurcation analysis - continuation for noise-contaminated
Journal of Sound and Vibration 358, 251–266
zero problems.
(2015). DOI 10.1016/j.jsv.2015.08.008

28. Schwartz, I., Carr, T., Triandaf, I.: Tracking controlled chaos:
Theoretical foundations and applications. Chaos 7(4), 664–679
(1997). DOI 10.1063/1.166285

29. Sieber, J., Gonzalez-Buelga, A., Neild, S., Wagg, D., Krauskopf,
B.: Experimental continuation of periodic orbits through a
fold. Physical Review Letters 100(24) (2008). DOI 10.1103/
PhysRevLett.100.244101

30. Sieber, J., Krauskopf, B.: Using feedback control and Newton
iterations to track dynamically unstable phenomena in experi-
ments. IFAC Proceedings Volumes 42(7), 211–216 (2009). DOI
10.3182/20090622-3-UK-3004.00041

31. Solo, V.: On the stability of slowly time-varying linear systems.
Mathematics of Control, Signals, and Systems 7(4), 331–350
(1994). DOI 10.1007/BF01211523

32. Song, M., Renson, L., Moaveni, B., Kerschen, G.: Bayesian model
updating and class selection of a wing-engine structure with non-
linear connections using nonlinear normal modes. Mechanical
Systems and Signal Processing 165 (2022). DOI 10.1016/j.ymssp.
2021.108337

33. Tartaruga, I., Barton, D., Rezgui, D., Neild, S.: Experimental bi-
furcation analysis of a wing proﬁle. In: Proceedings of the Interna-
tional Forum on Aeroelasticity and Structural Dynamics, IFASD
2019, Savannah, Georgia, USA (2019)

34. Zaghari, B., Kniffka, T., Levett, C., Rustighi, E.: Parametrically
excited nonlinear two-degree-of-freedom electromechanical sys-
tems. Journal of Physics: Conference Series 1264(1) (2019). DOI
10.1088/1742-6596/1264/1/012024

Statements and Declarations

Funding This work is supported by Agriculture and Food
Research Initiative Competitive Grant no. 2014-67021-22109
from the USDA National Institute of Food and Agriculture.
Part of the editing of this paper was performed while the sec-
ond author served at the National Science Foundation. Any
opinion, ﬁndings, and conclusions or recommendations ex-
pressed in this material are those of the authors and do not
necessarily reﬂect the views of the National Science Foun-
dation.

