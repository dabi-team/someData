Haptic Sensation-Based Scanning Probe Microscopy

Haptic Sensation-Based Scanning Probe Microscopy: Exploring
Perceived Forces for Optimal Intuition-Driven Control

M. Freeman,1 R. Applestone,1 W. Behn,1 and V. Brar1
Department of Physics, University of Wisconsin-Madison, Madison, Wisconsin 53706,
United States

(*Electronic mail: vbrar@wisc.edu)

(Dated: August 29, 2022)

We demonstrate a cryogenic scanning probe microscope (SPM) that has been modiﬁed to be controlled
with a haptic device, such that the operator can ‘feel’ the surface of a sample under investigation. This
system allows for direct tactile sensation of the atoms in and on top of a crystal, and allows the operator
to perceive, by using different SPM modalities, sensations that are representative of the relevant atomic
forces and tunneling processes controlling the SPM. In particular, we operate the microscope in modes
of (1) conventional STM feedback, (2) energy-dependent electron density imaging, (3) q-plus AFM
frequency shift based force sensing, and (4) atomic manipulation/sliding. We also use software to
modify the haptic feedback sensation to mimic different interatomic forces, including covalent bond-
ing, Coulomb repulsion, Van der Waals repulsion and a full Lennard-Jones potential. This manner of
SPM control creates new opportunities for human-based intuition scanning, and it also acts as a novel
educational tool to aid in understanding materials at an atomic level.

I.

INTRODUCTION

Scanning probe microscopy (SPM),

including
scanning tunneling microscopy (STM) and atomic
force microscopy (AFM), is a powerful imaging tech-
nique that can be used to visualize the atomic struc-
ture of materials and the wavefunctions of elec-
trons, as well as to manipulate individual atoms
and molecules on the surfaces of materials.1–3 These
imaging methods work by using piezoelectric motors
with sub-Å resolution to manipulate the position of an
atomically sharp tip across a smooth material surface,
where tip-surface contact is maintained using a feed-
back loop based on tunneling current, oscillation fre-
quency shifting, or other measurable parameters that
change with tip-sample separation. Under standard
operating conditions, the tip is raster scanned slowly
across a surface and a full image is developed over the
course of minutes to hours, depending on the speciﬁc
imaging modality. More rapid, but less visual, mea-
surements can be performed by continually scanning
across the same path on the sample as some param-
eter is varied, or the tip can be simply parked over a
speciﬁc spot of a surface to monitor changes as they
happen in real time. During manipulation procedures,
however, the tip is carefully lowered into the surface
to either change its surface structure, or to pick up
atoms/molecules or trap them beneath it.4,5 Subse-
quent movement of atoms/molecules is performed by
dragging them along the surface while moving the tip
along a ﬁxed path.6–8

In all of the above operational modes, live infor-
mation about the tip height and feedback parameters
can be monitored by the operator by inputting their
values into an oscilloscope. This allows for instan-
taneous changes in the tip or sample to be observed,
and it also permits for precise placement of the tip

relative to some surface feature by ‘blindly’ moving
the tip in sub-Å steps and monitoring — for exam-
ple — the tip height as it is altered by individual sur-
face atoms. This later capability allows for manipu-
lation to be performed without ﬁrst obtaining sub-Å
resolved images, which would be prohibitively time
consuming. During manipulation itself, a live feed of
the scanning parameters is necessary for assessing if
an atom/molecule is on the tip — which appears as a
change in height — or if an atom/molecule is follow-
ing the tip — which can be known by observing the
current noise; while an oscilloscope can be used for
such observations, it is more common to convert the
tunneling parameters into an audible sound with, for
example, the tip height and tunneling current repre-
sented by a particular pitch.9,10 This approach is of-
ten more intuitive and, in some cases, can provide a
clearer picture of the tip and sample conditions.

Recently, commercial haptic feedback technolo-
gies have proliferated as a effective way in which to
interact with a virtual space. Haptic feedback arms
allow a user to move a cursor in a simulated 3D
space, where contact with a virtual object results in
a force imparted on the hand of the operator. These
devices are used extensively as tools for designing 3D
virtual objects, performing robot-assisted surgeries,
training for medical and dental operations, control-
ling robot arms in dangerous environments, and other
applications.11 They can be interfaced with any tool
that exhibits motor-controlled xyz motion and pro-
vides some positional feedback.

Shortly after the innovation of piezo-controlled
SPMs, efforts were made by several groups to inter-
face them with haptic control arms as a way to ‘feel’
the surfaces being probed.12–16 Those experiments,
which included both STMs and AFMs, allowed users
to feel coarse features on the surfaces of materials,

2
2
0
2

g
u
A
5
2

]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[

3
v
7
9
1
0
1
.
7
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
Haptic Sensation-Based Scanning Probe Microscopy

2

including protruding quantum dots and step edges,
with characteristic heights as small as 2nm. Subse-
quent demonstrations showed that haptic-controlled
AFMs could be used to sense and manipulate carbon
nanotubes and large biomolecules, such as viruses,
ﬁbrin, and DNA.15,17–22 These experiments allowed
the sensing of both lateral and vertical tip-sample
forces as small as 1nN.19 Later implementations also
showed how haptic-controlled AFMs could be used
to precisely position micron-sized beads,23–26 sense
semiconductor devices,23 and sense the distance de-
pendence of AFM tip-surface interactions. These
later experiments were particularly useful for instruc-
tional purposes as the correlation between tip-surface
and pen-hand interactions made it easier for students
to understand forces between material interfaces.27–30
Most early haptic-SPM experiments were per-
formed in ambient conditions, where it is difﬁcult to
maintain consistent tip and sample conditions, and
where surface adhesion forces introduced from inter-
facial molecules can be signiﬁcant. Haptic experi-
ments using optical tweezers provided a means of by-
passing those challenges, with demonstrations show-
ing reliable manipulation of trapped beads near and
around barriers, and force sensing down to 1pN.31–33
More recently, ultra-high vacuum (UHV) STM mea-
surements — where surface impurities were elimi-
nated — that included haptic arm control were per-
formed on atomically smooth Au(111) surfaces with
adsorbed C60 molecules.34 That work demonstrated
that when STM feedback is controlled with tunnel-
ing current rather than tip-sample forces, the tunnel-
ing current could reliably be used to set the haptic arm
force, allowing the operator to feel atomic step edges,
and to even manipulate C60 molecules. Other UHV
experiments used camera tracking of hand movement
to control an STM/AFM tip to manipulate PTCDA
molecules on an Ag(111) surface.35,36 Those experi-
ments lacked force-feedback, but they demonstrated
the effectiveness of hand-control in choosing optimal
SPM tip trajectories.

Here we expand on those previous works by inte-
grating a haptic feedback arm with a cryogenic, UHV
SPM equipped with a quartz tuning fork sensor that
can be used for both operation as a frequency modu-
lated AFM and STM. The ultra low temperature envi-
ronment of the surface enables highly stable scanning
conditions that we utilize to demonstrate several op-
erational modes, including the linking of the haptic
force to (1) tunneling current, (2) changes in tuning
fork frequency and (3) local electron density. We also
explore the use of different feedback-force (‘feeling’)
functions, which create different tactile sensations
that can be used to mimic different atomic forces, and
to optimize the ease of operation. Additionally, we
demonstrate the ability to manipulate the positions of
individual CO molecules with atomic resolution, such
that the operator can feel as the molecules skip be-
tween atomic lattice sites.

II. METHODS

A. Hardware and Software

All measurements were performed in a commer-
cial SPM (CreaTec GmbH) with Nanonis (SPECS
GmbH) electronics and software. The SPM is oper-
ated in UHV conditions at 4.5K using a qPlus quartz
tuning fork sensor with a conductive PtIr wire tip that
allows for dual AFM/STM imaging. A Touch X hap-
tic device (also called a haptic pen) from 3D Systems
was used for all experiments. The device is operated
via device drivers, calibration software, and the Open-
Haptics 3.5 application programming interface (API)
for the C/C++ languages. It possesses a workspace of
160 W × 120 H × 120 D mm, a maximum force out-
put of 7.9 N, and a positional resolution of 1100 dots
per inch (dpi) — nearly double the resolution of hap-
tic devices used in previous experiments.34 Such high
resolution is ideal for obtaining smoother-feeling sur-
faces and forces.

There are three interconnected software compo-
nents that allow the haptic device to communicate
with the STM/AFM: (1) The Nanonis SPM control
system, which is controlled through a LabVIEW-
accessible API, and allows signal values (e.g., tip po-
sitional data, current, and oscillation frequency shift)
and control parameters (e.g., tip position, tip bias) to
be both read and controlled in LabVIEW; (2) a cus-
tom dynamic-link library developed using the Open-
Haptics API, and coded in C++, which allows posi-
tional and force parameters to be read and written to
the haptic device via LabVIEW; and (3) a LabVIEW
GUI program used to interface the two, processing
signals from each device. The LabVIEW GUI and
dynamic link library can be found at www.github.
com/HapticSPM.

The synthesis of these hardware and software com-
ponents results in the complete haptic controller, as
shown in Fig. 1.

B. Operational Basics

In read mode,

There are two general modes of operation with
which experiments were performed: read mode and
write mode.
the haptic pen only
controls the tip motion in the horizontal xy plane,
while the tip height is controlled via conventional
STM/AFM feedback. The force on the haptic pen is
then determined by reading a signal of interest (e.g.,
tip z-position, LDOS, cantilever frequency shift, etc.)
while the feedback is on and referencing it to the
z-position of the haptic pen; if the pen travels be-
low a virtual, scaled version of the sample deﬁned
by the signal, it is pushed upwards. For example, if
the feedback-determined tip-height is chosen as the
signal, then the relative value of the actual SPM tip-

Haptic Sensation-Based Scanning Probe Microscopy

3

Figure 1. The operational setup used for the haptic-SPM controller. The haptic device, controlled via a dynamic-link library
written in C/C++, and the Nanonis control hardware, controlled via Nanonis’s SPM control software, both connect to a
desktop computer. Both of these interface via a LabVIEW program on the computer, which handles signal processing and
the main GUI. The user moves the pen, and the xyz-positional data from the haptic device is mapped to control the xyz-
position of the pen. Meanwhile, signals like the tip z-position, tunneling current, or cantilever frequency shift are converted
into a force, applied to the haptic device, and felt by the user.

height and the virtual tip height is used to set the force
on the pen. The ‘feel’ of the sample (i.e., force as a
function of distance) is determined by a function of
the form

f (zpen) =

(cid:26) k|zpen − aS f b|

0

zpen ≤ aS f b
zpen > aS f b

,

(1)

where S f b is the signal of interest with feedback on, a
is the gain setting controlled in LabVIEW, and zpen
is the z-position of the haptic pen in mm. When
the haptic pen is held ‘above’ aS f b, it experiences no
force, but as the position of the pen hits aS f b and then
goes below it, it experiences a spring force with an
adjustable stiffness k. It is important to note, how-
ever, that the force-distance relation described in Eq.
1 need not be linear; the overall ‘feeling’ of the sam-
ple can be changed by altering the form of this func-
tion as described later in Sec. IV. This mode of oper-
ation is similar to the ‘augmented reality mode’ used
in previous haptic-AFM implementations.19,37

In write mode, the haptic pen controls the horizon-
tal xy-position, as well as the vertical z-position of
the tip. The force on the haptic pen is determined
by the function f (S), which is entirely dependent on
the signal of interest S without feedback, with the tip
height set by the position of the pen. As an example,
if the tunneling current is chosen as the signal of in-
terest, then as the pen (and thus, tip) moves downward
and approaches the surface, the tunneling current in-
creases; this current is converted to an upwards force,
which the user interprets as a hard surface.

The force functions discussed above are varied de-
pending on the signal of interest, and are described
explicitly in the next sections.

In normal use, a square region of interest is cho-

sen on the surface of the sample using the standard
Nanonis SPM control software. This region’s loca-
tion and size are then used by the haptic device to
convert the millimeter-scale horizontal movement of
the pen to the angstrom-scale horizontal movement
of the tip. The workspace of the pen is conﬁned using
hard-coded, vertical walls to a 16 cm × 16 cm hori-
zontal area in the middle of the pen’s range of motion.
This effectively conﬁnes the user of the haptic device
to the square region of interest on the sample. The
sample surface is often slanted relative to the axes of
movement of the scanning probe, and thus a planing
algorithm must be used to ‘ﬂatten’ the surface, such
that the horizontal movement of the pen is mapped to
tip movement along the plane of the surface. This al-
gorithm is implemented by having the user choose 3
points and ﬁtting a plane to the force-deﬁning signal
at each of those points.

In both modes, it is possible to conﬁgure the per-
ceived height of features on the surface by chang-
ing the desired level of positional scaling, which al-
lows the user to feel differently-sized surface fea-
tures. Thus, larger surface features like step-edges
and smaller features like individual molecules/atoms
are able to be felt in a more user-friendly way, without
sacriﬁcing the ability to feel only one or the other.

Finally, a drag force was implemented to smoothen
the user’s movements in an attempt to eliminate all
but deliberate pen motions. This force was deter-
mined by the function Fdrag = −cv, where v is the
velocity of the haptic device cursor and c is an arbi-
trary constant. As an additional safety measure, the
maximum speed of the STM/AFM tip could be con-
ﬁgured such that the tip is only allowed to travel at
less than a given speed. Beyond limiting unwanted
rapid motions of the STM/AFM and the haptic de-

Haptic Sensation-Based Scanning Probe Microscopy

4

vice, this feature was found to be essential for ﬁne-
grained operations like molecular manipulation.

III. MODES OF OPERATION

We tested our haptic-SPM controller on an atomi-
cally ﬂat Cu(111) surface cleaned by repeated cycles
of sputtering with Ar ions (500 V, 7 µA) for 10 min-
utes and annealing around 400 C for ten minutes. The
crystal was allowed to cool after annealing cycles and
before each sputtering cycle. After loading the sam-
ple into the SPM, carbon monoxide molecules were
deposited on the sample in situ via a UHV leak valve.
The sample was analyzed using a variety of different
haptic-SPM conﬁgurations, described below.

A. STM Topography-Based Force

Figure 2. An example of both ‘STM topography-based’
(top) and ‘STM current-based’ (bottom) operations.
In
(a) and (c) the pen position is plotted in three dimensions
alongside the corresponding STM imagery. Linecuts that
compare zstm and zF
pen as well as the force on the pen for
topography-based operations are shown in (b). Linecuts
comparing the current vs. pen force as the tip traverses a
molecule in current-based mode is shown in (d)

Thus, zF
pen is used to distinguish the case in which the
user is applying a constant ﬁnite downward force on
the pen and the pen height would closely correspond
to the surface topology.

Fig.

2a shows the three-dimensional path of
the haptic device zF
pen(xpen, ypen) acquired using this
mode of operation while transiting a carbon monox-
ide (CO) molecule on Cu(111). The data is plotted
alongside the STM surface topography, and Fig. 2b
directly compares a linecut of the STM topography to
zF
pen(xpen, ypen), showing good agreement. This indi-
cates that the haptic pen is able to reliably feel sub-
nanometer features.

There are a noticeable discrepancies between the
actual STM topography and the user-perceived sur-
face, which originate from different sources. First,
the STM topographic data contains a slope that is rep-
resentative of the actual slope of the sample, while
the path of the haptic pen is ﬂat. This is due to the
slope correction algorithm described in Section II B.
Second, there is a 1 - 20 ms delay between when the
STM signal value changes and when the haptic de-
vice writes the corresponding force. This delay is
combined with a delay caused by the reaction time
of the user, causing the haptic pen and SPM tip to be
out-of-sync. Third, in order for zF
pen to match zST M
the user must maintain a constant force on the pen
during the entire movement, and small deviations are
inevitable. Finally, piezo drift differently affects the
zstm and zF
pen proﬁles, since the former is obtained at
a constant scan speed, and the latter’s scan speed is
controlled by the user, and generally non-constant.

B. STM Current-Based Force

The next method of operation we describe imple-
ments a current-based force, where the STM feedback
is turned off and the haptic controller is operated in
write mode, meaning the pen controls the tip posi-
tion in all dimensions. The arm produces an upwards
force proportional to the tip tunneling current, which
increases with decreasing tip-sample separation. The
force function used is

f (Itun) = Itun/Iset

(2)

In this operational mode, the STM feedback con-
troller remains on, adjusting the z-position of the tip
to maintain a constant ‘setpoint’ current. The hap-
tic controller is operated in read mode, such that the
haptic pen controls only the xy-position of the STM
tip. The force exerted on the pen is determined by
Eq. 1 with S f b = zstm, where zstm is the height of the
tip relative to the plane of best ﬁt in nm. azstm can be
understood as the STM tip height read and projected
into the virtual haptic space.

Since the pen can move above azstm, its z-position
may or may not correspond to the surface topography.

where Itun is the tunneling current, Iset is an arbitrary
current chosen by the user, which the pen tends to
maintain during use.

We found setting the tip force directly to the tun-
neling current created difﬁcult operating conditions
when feeling large features, where small changes in
tip height led to large changes in force that the hap-
tic arm could not produce at sufﬁcient rates to main-
tain stable tunneling; it was also difﬁcult to avoid tip
crashes since the maximum force of the haptic pen
could easily be reached with small changes in the tip
height. To mitigate these problems, the vertical z-

Haptic Sensation-Based Scanning Probe Microscopy

position of the pen was further processed using the

equation

zstm(zpen) =

(cid:26) b(exp ( 1
zpen

b [zpen − zthresh]) − 1) + zthresh

zpen ≤ zthresh
zpen > zthresh

5

(3)

where b is a scaling constant (nm), and zthresh (nm)
is the z-position at which the tunneling current sur-
passes a predetermined current threshold (chosen to
be about 20 pA in experiments shown here). Eq. 3
acts as a conﬁgurable ‘ﬂoor’ past which the STM tip
can only travel a few tens of picometers, regardless of
how much further the haptic pen position zpen travels.
This prevents problems feeling large features by dra-
matically decreasing the degree to which the haptic
arm moves the pen towards the surface after a cer-
tain threshold height is met. This correction also as-
sists the operator in maintaining a constant tip height
at zthresh, since the transition to different functional
forms on either side of zthresh can be easily felt by
the user. When the composition of Equations 2 and
3 is considered, force as a function of pen height is
at ﬁrst exponential, then becomes linear as the force
approaches the maximum force.

A representative contour of zF

pen(xpen, ypen) ob-
tained using a current-based force is shown in Fig. 2c,
along with the corresponding topography obtained
using standard STM imaging. We ﬁnd that the to-
pography is less-well reproduced in comparison to
using the topography-based force described in the
previous section, and we attribute that difference to
the 1 - 20ms communication delay between the hap-
tic pen and STM, which makes it difﬁcult for the
user to maintain a perfectly constant current. Fig.
2c, meanwhile, compares the force on the haptic pen
against the tunneling current as the user traverses the
tip across an individual CO molecule. Here we ﬁnd
good agreement, with the current/force decreasing as
the tip moves into the CO-deﬁned dip (due to the tip
moving further from the surface as it goes off an edge)
and increasing as it moves out.

mode the tip z-position is controlled via electronic
feedback, which is unaffected by user-error, and can
quickly correct for changes in tunneling conditions
(the typical feedback time constant is 30µs). An ad-
ditional caveat of the current-based mode is that it is
necessary to know some approximate parameters of
the signal of interest (i.e. how the signal varies with
tip-sample separation) before operation in order to ap-
propriately scale the position and force mapping —
this is not necessary when operating in topography-
based mode.

Despite the above drawbacks, current-based force
imaging is signiﬁcantly more useful when a 4-
dimensional understanding of the signal of interest is
desired (x, y, z, and Itun(x, y, z,V )); the topography-
based mode is only able to provide information about
a single, 3-dimensional contour of the signal of in-
terest (x, y, and zstm), and is thus more limited in its
capacity to convey information about the surface. For
example, current-based imaging could allow the op-
erator to feel changes in the electron decay constant
associated with different bands38 or different molec-
ular orbitals.39–44

Fig. 3 shows a comparison of force as a function of
zpen when lowering the pen into the surface (taken to
be at zpen = 0 mm). The current-based force exhibits
a relationship initially indicative of the tunneling cur-
rent’s exponential dependence on surface proximity
and then becomes linearized at zpen = zthresh = 0 mm
due to Eq. 3, while the topography-based force ex-
hibits a simple, linear relationship.

It is found that the topography-based mode de-
scribed in Section III A is easier to control and ac-
quires better data than the current-based mode.
In
both modes, the user attempts to maintain a constant
downward force on the pen, establishing a feedback
loop between the human, the haptic device, and the
STM. However, in the current-based mode, human
errors and inefﬁciencies in this loop affect the tip z-
position and, by extension, the signal that sets the
force, which can feel erratic. Such processes include
slow reaction times of the user, random hand move-
ments, communication delay between the haptic pen
and the STM, and microscopic changes to the SPM
tip or sample. On the other hand, in topography-based

Figure 3. Force as a function of zpen for the (a) STM
topography-based force and the (b) STM current-based
force.

Haptic Sensation-Based Scanning Probe Microscopy

6

C. STM LDOS-Based Force

The tip-sample distance in an STM is typically
maintained by using the tunneling current as the feed-
back parameter, however, the force on the haptic arm
can be deﬁned by any measurable value. For example,
the energy dependent local density of electronic states
(LDOS) is one property that is commonly measured
in STM experiments to provide direct visualization of
electron wavefunctions and interference patterns. The
LDOS at any particular point of the sample is pro-
portional to the tip-sample conductance at the tunnel-
ing voltage, and is commonly measured using a lock-
in ampliﬁer. By converting the lock-in signal to a
force written to the haptic controller operating in read
mode, the user is able to feel the voltage-dependent
local electron density as it varies across the sample.

This mode of operation uses Eq. 1 with S f b =
LDOSstm(V ), and the gain variable a having units of
mm/V (the lock-in outputs a voltage that is propor-
tional to the sample conductance). Thus, the contour
felt by the operator, zF
pen(xpen, ypen), is deﬁned by the
local sample conductance, which depends on the tun-
neling bias. An example is shown in Fig. 4a, where
zF
pen(xpen, ypen) of a particular path is plotted on top
of an LDOS image of the Cu(111) surface, which re-
veals standing waves created by the interference pat-
tern of the copper surface state. Fig. 4b, meanwhile,
directly compares the trajectory of the haptic pen with
the corresponding linecut of the LDOS image, show-
ing excellent agreement.

We note that, unlike STM-derived topography, the
LDOS changes dramatically with the applied bias,
and those changes reveal the rich behavior of the
electrons in the material.
In the case of Cu(111),
LDOS images taken at higher/lower sample biases
reveal shorter/longer wavelength standing wave pat-
terns due to the different momenta of the participating
electrons.45 Moreover, LDOS images of molecules
can reveal
the internal structure of the different
molecular orbitals.46–49 These properties are all ac-
cessible to haptic force based sensing.

Figure 4. An example of the LDOS-based mode in which
the haptic pen was operated. The pen position is plotted in
three dimensions alongside corresponding LDOS imagery
is shown in (a); a direct linecut comparison is shown in (b).

Figure 5. An example of the three AFM-based modes in
which the haptic pen was operated. The pen position plot-
ted in three dimensions alongside the corresponding AFM
imagery is shown in (a) and (c); a direct linecut comparison
is shown in (b) and (e), while (d) compares frequency shift
and force.

D. AFM Topography-Based Force

In this mode of operation, the feedback of the sys-
tem remains on, and the tip-sample distance is main-
tained at a constant height by linking the feedback
to the frequency shift of the AFM cantilever (∆ f ),
which changes depending on the tip-sample distance,
and the speciﬁc tip-sample interactions (i.e. electro-
static, Van der Walls, etc...). The haptic controller is
operated in read mode, with x and y positions of the
AFM tip controlled directly via the pen, and the force
on the pen is set by Eq. 1, where S f b = za f m. The
cantilever oscillation phase was 2.47 degrees, and the
oscillation excitation voltage was 2.97 mV.

Figure 5(a) shows the three-dimensional path of
the haptic pen with constant force zF
pen(xpen, ypen) ac-
quired using an AFM topography based force while
transiting over a CO molecule on Cu(111). The data
is plotted atop the associated AFM image, and Fig.
5(b) directly compares zF
pen(xpen, ypen) to a linecut of
the topography.

This mode of operation performs similarly to the
STM topography-based mode described in Sec. III A,
however, the perceived properties are fundamentally
different since the STM is sensitive to conductivity
and the AFM is sensitive to interatomic forces. These

Haptic Sensation-Based Scanning Probe Microscopy

7

differences are apparent in the measurements of CO
molecules:
they are felt as protrusions in AFM to-
pography mode since they physically protrude from
the surface and interact with the AFM tip, while they
are perceived as dips in STM topography mode since
the locally lower the surface conductivity.

E. AFM ∆ f -Based Force

In this conﬁguration, the pen was operated in write
mode, using a force based on the frequency-shift of
the AFM cantilever. The function used was

f (∆ f ) =

(cid:26) 0

k log (∆ f /∆ fset point )

∆ f ≤ ∆ fset point
∆ f > ∆ fset point

,

(4)
where ∆ f is the measured frequency-shift of the can-
tilever, ∆ fset point
is a value chosen by the user at
which the pen begins to feel a force, and k is a scalar
which sets the gain. We note that if the force on the
pen is linked directly to ∆ f , the applied force on the
pen is maxed out too quickly and the operator can
easily crash the tip. Using the logarithmic, step-like
form shown in Eq. 4 makes it easy to hold the tip at
a particular setpoint, while still enabling tip-sample
force perception as the tip is lowered further.

Force perception obtained while transiting a
molecule in this mode is shown in Fig. 5c, while Fig.
5d directly compares the perceived force to ∆ f . The
major beneﬁt of this mode of operation is that the pen
force is directly linked to the actual physical force be-
tween the tip and sample (which establishes ∆ f ). This
allows the user to feel the different forces that deter-
mine the AFM tip-sample interaction; this ability has
previously been shown to be valuable in educational
settings.27–30

It is found that the comparative usefulness between
the AFM topography-based mode and the AFM ∆ f -
based mode is identical to the corresponding STM
modes, as discussed at the end of Section III B. In
particular, topography-based operation is more sta-
ble, while ∆ f -based scanning provides more oppor-
tunities for studying the surface properties via tactile
sensation.

F. AFM ∆ f -Based Force at Constant Height

The last mode of operation we demonstrate is
frequency-shift based, for which controller feedback
was turned off, but the tip is ﬁxed to move in a
ﬂat plane that is established by ﬁtting topographic
data obtained ﬁrst by imaging the surface in stan-
dard feedback mode. Local changes in surface topol-
ogy raise or lower the frequency shift from reso-
nance of the AFM cantilever and this signal was
converted to a force on the haptic device in read
mode. This method of imaging — which is espe-

cially effective when ∆ f is a non-monotonic function
of za f m — has been shown to be effective in obtaining
atomically-resolved images of surfaces and, for CO
functionalized tip, in imaging atomic bonds withing
molecules.50–52

The force on the haptic pen transiting two CO
molecules in this mode is shown in Fig. 5e, plotted
atop the associated direct measurement of ∆ f from
the Nanonis software. We note that here we plot the
raw value of ∆ f rather than the absolute value, which
would reveal peaks instead of dips.

Table I. The speciﬁc functions used to conﬁgure how the
surface feels. The constants ρ, τ, σ , and ε were all cho-
sen to provide the a force curve conﬁned to a 30 mm range
between zero force and the maximum force (3 N).

Force

Linear

Covalent

Coulomb

ϕ(r)

ρr

exp(ρr − τ) − ε

σ

(ρr−τ)2 − ε

Van der Waals

Lennard-Jones

−4ε

σ

(ρr−τ)7 − ε
(cid:16) 6σ 6
(ρr−τ)7 − 12σ 12

(ρr−τ)13

(cid:17)

Figure 6. Force as a function of zpen for each force in-
vestigated, including (a) linear force, (b) covalent bonding
force, (c) Coulomb force, (d) Van der Waals force, and (e)
Lennard-Jones force. All curves are shifted such that the
surface is at zpen = 0 mm.

Haptic Sensation-Based Scanning Probe Microscopy

8

Figure 7. An example of the forces experienced while transiting a CO molecule using different ’feeling functions’. A linecut
of the molecule imaged using conventional STM is shown in (a); a comparable path was taken with the haptic pen applying
a (b) linear force, (c) covalent bonding force, (d) Coulomb force, (e) Van der Waals force, and (f) Lennard-Jones force. The
subjective feel corresponding each function is written under each plot.

IV. FEELING FUNCTIONS

Determining how the surface feels when using the
haptic controller is an important parameter that is
decided by the subjective preference of the operator
and/or a distance-dependent SPM signal. In absolute
terms, the feel, or ’feeling function’ ( f (zpen)), is set
by how the force exerted by the haptic pen depends
on the pen height, but that dependence can be var-
ied over a wide range of parameter space. In sections
III A, III C, and III D, f (zpen) was set to be linear and
spring-like, and independent of the actual SPM sig-
nal dependence on height; Meanwhile, in Secs. III B,
III E, and III F f (zpen) was directly linked to the raw
SPM signal, or a logarithmic/exponential function of
it. There is, however, substantial leeway in choosing
a ’feeling function’ that is engineered to impart sen-
sations that deviate from the SPM signal vs. height
function, with the only technical constraint being that
it must prevent drastic force vs. tip height dependen-
cies which can lead to unstable operation. Otherwise,
it can be chosen to either provide the best feel to the
user, or to mimic a particular interatomic force. In the
later case, the force felt on the pen would represent
the forces that a theoretical atom or molecule would
feel if scanned across the surface.

The idea of exploring different feeling functions is
also motivated by studies that show that the psycho-
metric function for compliance discrimination (i.e.,
perceived stiffness as a function of the actual stiff-
ness) is roughly logarithmic, and on the order of
N/mm.53 This seems to suggest that force-functions
will yield signiﬁcantly different perceptions than
what might be initially predicted; just because force

as a function of distance is exponential, for example,
does not mean the surface will ‘feel exponential’ to
the user.

To investigate the effect of modifying f (zpen) on
the haptic pen operation, we used different ‘feeling
functions’ while probing the properties of an individ-
ual CO molecule. All measurements were performed
in the mode of STM Topography-Based Force (Sec.
III A), with Eq. 1 modiﬁed to mimic different inter-
atomic forces. The ‘feeling functions’ used were of
the form:

f (r) =

(cid:26) ϕ(r)
0

r ≥ 0
r < 0

,

(5)

where r ≡ azstm − zpen is deﬁned to be the penetra-
tion distance, and ϕ(r) takes on the various forms
as described in Table I. These feeling functions im-
pose sensations on the hand of the operator that sim-
ulate the forces experienced by different species of
molecules interacting with the surface, depending on
the valence state, bond structure, charge, and size.
These different functions also modify the user’s abil-
ity to control the haptic pen as they change the appar-
ent shape and ‘hardness’ of surface features, which
affects the user’s reaction time.

In order understand the effect of these different
feeling functions, we plot the the force experienced
by the user as a function of pen height in Fig. 6 for
each individual functional form. In Figure 7 we plot
the perceived force using each function while tran-
siting a CO molecule. We note that while the mag-
nitude of force ﬂuctuations is similar between differ-
ent feeling functions, the tactile sensation are differ-

Haptic Sensation-Based Scanning Probe Microscopy

9

Figure 8. An example of controlled manipulation of CO on Cu(111) using the haptic device. Shown is (a) an illustration of
a CO molecules being laterally dragged over the Cu(111) lattice by an STM tip (b) linecuts of zF
pen and zstm obtained during
the lateral dragging process, which show atomic corrugations due the preferred binding of the CO molecule to the top of the
Cu atoms, and (c) before and after images of the same area, in which CO molecules were moved to spell out ‘hi’ in Uniﬁed
English Braille.

ent, as described in the ﬁgure. For example, using a
full Lennard-Jones type potential holds the haptic pen
in place, allowing the user to feel competing repul-
sive and attractive forces as they transit the surface.
The spherical Coulomb potential, meanwhile, which
mimics the force between two charged point parti-
cles, creates a ‘soft’ sensation, with minimal push-
back from the surface. In general, the description of
these forces is necessarily both subjective and quali-
tative in nature and all provided stable operation.

V. MANIPULATION

The

atoms

controlled manipulation of

and
molecules with an SPM is a powerful capabil-
ity that enables the atom-by-atom engineering of
nanosystems.10,54–56 Haptic SPM control
is espe-
cially useful for such a use case, as the operator can
ﬁnd the target atom/molecule, perform manipulation
and interrogate the resulting structure without having
to conduct a time-intensive raster scan after each
manipulation attempt. To demonstrate this capability,
to manipulate the
we used haptic SPM control
positions of CO molecules on a Cu(111) surface.
In these experiments, the system was operated in
’STM topography-based force’ mode, as described
in Sec.
III A. The STM tip is ﬁrst positioned on
top of an individual CO molecule, and the lateral
control of the haptic arm is momentarily paused to
minimize uncontrolled movements. Next, the STM
tip is brought close to the molecule by increasing
the setpoint current of the feedback and lowering the

tunneling bias, with typical values of 10nA and 1mV,
respectively. Concurrently, the z-position of the tip
is monitored for ﬂuctuations, which indicate that
the molecule is partially bound to the tip.10 Lateral
movement is then re-enabled, and the user can ‘drag’
the molecule to the desired location upon which the
tip is raised by increasing the bias and lowering the
setpoint current to typical values of 50mV and 1nA,
leaving the molecule on the surface.

An example of this manipulation process is shown
in Figure 8, where we plot zF
pen during the lateral slid-
ing process of CO molecule. During the movement,
the atomic lattice of the underlying fcc Cu(111) sur-
face (with a lattice constant of 3.597 Å57) becomes
resolved in STM measurements and can be perceived
by the haptic pen due to the preferentially binding of
the tops of the Cu atomic compared to the hollow
site, which causes the CO to ’skip’ between atomic
sites.8,10,54 This process causes the CO molecule to
dynamically alter the local conductivity during the
sliding process, allowing the atomic lattice to be felt
by the operator. We found the process of manipu-
lation to be reliable, and it was used to manipulate
many molecules with high rates of success. Images
before and after the manipulation of 5 CO molecules
are shown in Fig. 8c, with the latter spelling out ‘hi’
in Uniﬁed English Braille. We note that one distinct
advantage of haptic-SPM is that during the manipu-
lation process, it is easy to ’feel’ around the surface
to ﬁnd molecules, without needing to re-scan the ar-
eas or to search for atoms by monitoring the height
of the SPM tip visually. This makes atomic manip-
ulation less time consuming and more intuitive than

Haptic Sensation-Based Scanning Probe Microscopy

10

conventional SPM operation.

teracting with such instruments more ergonomic and
more accessible to the layperson.

VI. DISCUSSION AND OUTLOOK

In general, the performance of our haptic-SPM was
constrained by a number of factors, which we discuss
as following.

One limitation of the speciﬁc haptic device used
in this work is its relatively small range of motion in
the xy plane. Operations were limited to a 16 cm ×
16 cm area, meaning that, for a large enough area of
interest, small surface features were scaled down sig-
niﬁcantly and were more difﬁcult to feel. A haptic
device with a larger range of motion could address
this issue by keeping the scale of horizontal move-
ment constant, and increasing/decreasing the allowed
range of motion for larger/smaller areas of interest,
respectively. This would effectively allow the user to
feel both large and small surface features at the same
time, without sacriﬁcing movement range for surface
scale.

Another limitation is the discrepancy in the operat-
ing frequency of the Nanonis control software and the
haptic pen. While the haptic pen updates at a rate of 1
kHz, the Nanonis control software is only capable of
sending values to LabVIEW at a rate of 100 Hz. This
results in the pen moving over many points before re-
freshing, limiting the pen from fully taking advantage
of its 0.02 mm positional resolution. A faster con-
trol software operating frequency would yield signif-
icantly smoother operation, allowing larger areas and
features to be felt at higher resolutions and speed. Ul-
timately, the control software’s refresh rate is limited
by the time constant of the feedback controller (typ-
ically 30µs), meaning there is a maximal resolution
capable of being achieved.

Regardless of these technological limitations, our
results show that the haptic controller described in
this work provides a useful and intuitive way of in-
teracting with a cryogenic, UHV STM/AFM. The va-
riety of modes in which the device was successfully
operated exempliﬁes the wide range of possible use-
cases, and shows that the haptic SPM controller is
an effective way to feel, simulate, and interact with
nanoscale surfaces and features.

Such a control system could be especially useful
for educational and accessibility purposes. Tactile
feedback can help develop more intuition about the
operational principles of SPM technology than tra-
ditional sight-based methods, primarily due to the
high correlation between tip-surface and pen-hand
interactions. Haptic operations also provide near-
instantaneous feedback when compared to obtaining
time-intensive raster scans, facilitating ﬁne-grained
operations like molecular manipulation. Scanning
probe microscopy is essential for the study and engi-
neering of nanoscale systems, and further reﬁnement
of haptic-SPM controllers will only serve to make in-

ACKNOWLEDGMENTS

Work by M. F. and R. A. was supported by the
National Science Foundation (NSF), Division of Ma-
terials Research (RAISE DMR) under Award No.
1839199. Work by W. A. B. and V. W. B. was sup-
ported by the Ofﬁce of Naval Research under Award
No. N00014-20-1-235.

AUTHOR DECLARATIONS

Conﬂict of Interest

The authors have no conﬂicts to disclose.

Author Contributions

M. Freeman and R. Applestone: data curation,
investigation, methodology, software, visualization,
writing - original draft, writing - review and edit-
ing. W. Behn: data curation, investigation, super-
vision. V. Brar: conceptualization, funding acqui-
sition, project administration, supervision, writing -
original draft, writing - review and editing.

VII. DATA AVAILABILITY

The data that support the ﬁndings of this study are
available from the corresponding author upon reason-
able request or from:
https://github.com/HapticSPM/data.

REFERENCES

1K. Bian, C. Gerber, A. J. Heinrich, D. J. Müller, S. Scheuring,
and Y. Jiang, Nature Reviews Methods Primers 1, 1 (2021).
2G. Binnig and H. Rohrer, reviews of modern physics 59, 615
(1987).
3J. Chen, Introduction to Scanning Tunneling Microscopy Third
Edition, Vol. 69 (Oxford University Press, USA, 2021).
4J. A. Stroscio and D. Eigler, Science 254, 1319 (1991).
5J. Foster, J. Frommer, and P. Arnett, Nature 331, 324 (1988).
6I.-W. Lyo and P. Avouris, Science 253, 173 (1991).
7D. M. Eigler, C. Lutz, and W. Rudge, Nature 352, 600 (1991).
8M. Ternes, C. P. Lutz, C. F. Hirjibehedin, F. J. Giessibl, and A. J.
Heinrich, Science 319, 1066 (2008).
9P. S. Weiss and S. J. Stranick, Science 322, 190 (2008).
10J. A. Stroscio and R. J. Celotta, Science 306, 242 (2004).
11T. B. Sheridan, Telerobotics, automation, and human supervisory

control (MIT press, 1992).

12Y. Hatamura and H. Morishita, in IEEE Proceedings on Micro
Electro Mechanical Systems, An Investigation of Micro Struc-
tures, Sensors, Actuators, Machines and Robots. (IEEE, 1990)
pp. 203–208.

Haptic Sensation-Based Scanning Probe Microscopy

11

13R. Hollis, S. Salcudean, and D. Abraham, in IEEE Proceedings
on Micro Electro Mechanical Systems, An Investigation of Micro
Structures, Sensors, Actuators, Machines and Robots. (1990) pp.
115–119.

14R. Taylor, J. Chen, S. Okimoto, N. Llopis-Artime, V. Chi,
F. Brooks, M. Falvo, S. Paulson, P. Thiansathaporn, D. Glick,
S. Washburn, and R. Superﬁne, in Proceedings. Visualization
’97 (Cat. No. 97CB36155) (1997) pp. 467–470.

15M. Falvo, G. Clary, A. Helser, S. Paulson, R. Taylor, V. Chi,
F. Brooks, S. Washburn, and R. Superﬁne, Microscopy and Mi-
croanalysis 4, 504–512 (1998).

16M. Sitti and H. Hashimoto, in Proceedings. 1998 IEEE/RSJ
International Conference on Intelligent Robots and Systems.
Innovations in Theory, Practice and Applications (Cat. No.
98CH36190), Vol. 3 (IEEE, 1998) pp. 1739–1746.

17M. Guthold, M. Falvo, W. Matthews, S. Paulson, J. Mullin,
S. Lord, D. Erie, S. Washburn, R. Superﬁne, F. Brooks, and
R. Taylor, Journal of molecular graphics & modelling 17,
187—197 (1999).

18M. Reiner, Interactive Learning Environments 7, 31 (1999),

https://doi.org/10.1076/ilee.7.1.31.3598.

19M. Guthold, M. Falvo, W. Matthews, S. Paulson, S. Washburn,
D. Erie, R. Superﬁne, F. Brooks, and R. Taylor, IEEE/ASME
Transactions on Mechatronics 5, 189 (2000).

20F. J. Rubio-Sierra, R. W. Stark, S. Thalhammer,

and W. M.

Heckl, Applied Physics A 76, 903 (2003).

21M. Sitti and H. Hashimoto, IEEE/ASME transactions on mecha-

tronics 8, 287 (2003).

22M. Jobin, R. Foschia, S. Grange, C. Baur, G. Gremaud, K. Lee,
L. Forró, and A. Kulik, Review of Scientiﬁc Instruments 76,
053701 (2005), https://doi.org/10.1063/1.1891346.

23Y.-A. Lim, C. G. Lee, J.-P. Kim, and J. Ryu, in 2009 IEEE Inter-
national Symposium on Industrial Electronics (IEEE, 2009) pp.
983–988.

24H. Xie, D. S. Haliyo,

and S. Régnier, Nanotechnology 20,

215301 (2009).

25J. Hou, L. Liu, Z. Wang, Z. Wang, N. Xi, Y. Wang, C. Wu,
Z. Dong, and S. Yuan, IEEE Transactions on Automation Sci-
ence and Engineering 10, 285 (2013).

26A. Schmid, R. Yechangunja, S. Thalhammer, and M. A. Srini-
vasan, in 2012 IEEE Haptics Symposium (HAPTICS) (2012) pp.
517–522.

27F. Marchi, S. Marlière, D. Urma, J.-L. Florens, J. Chevalier,
C. Cadoz, and A. Luciani, in mICTE2005 (2005) pp. 510–515.
28B. Tse, W. Harwin, A. Barrow, B. F. A. Quinn, M. J. Cox, et al.,
in Haptics: Generating and Perceiving Tangible Sensations: In-
ternational Conference, Eurohaptics 2010, Amsterdam, July 8-
10, 2010. Proceedings (Springer Berlin Heidelberg, 2010) pp.
101–108.

29A. Bolopion, G. Millet, C. Pacoret,

and S. Régnier, Re-
views of Human Factors and Ergonomics 9, 57 (2013),
https://doi.org/10.1177/1557234X13503293.

30G. Millet, A. Lécuyer, J.-M. Burkhardt, S. Haliyo, and S. Reg-
nier, International journal of human-computer studies 71, 608
(2013).

31C. Pacoret, R. Bowman, G. Gibson, S. Haliyo, D. Carberry,
A. Bergander, S. Régnier, and M. Padgett, Optics express 17,
10259 (2009).

32C. Pacoret, A. Bergander, and S. Régnier, in International Con-
ference on Human Haptic Sensing and Touch Enabled Computer
Applications (Springer, 2010) pp. 333–338.

33C. Pacoret and S. Regnier, Review of Scientiﬁc Instruments 84,

081301 (2013).

34L. M. A. Perdigão and A. Saywell, Review of Scientiﬁc Instru-
ments 82, 073704 (2011), https://doi.org/10.1063/1.3600572.
35M. F. Green, T. Esat, C. Wagner, P. Leinen, A. Grötsch, F. S.
Tautz, and R. Temirov, Beilstein journal of nanotechnology 5,
1926 (2014).

36P. Leinen, M. F. Green, T. Esat, C. Wagner, F. S. Tautz, and
R. Temirov, JoVE (Journal of Visualized Experiments) , e54506
(2016).

37W. Vogl, B. K.-L. Ma, and M. Sitti, IEEE transactions on nan-

otechnology 5, 397 (2006).

38J. A. Stroscio, R. Feenstra, and A. Fein, Physical review letters

57, 2579 (1986).

39J. A. Stroscio, D. T. Pierce, A. Davies, R. Celotta, and M. Wein-

ert, Physical Review Letters 75, 2960 (1995).

40F. Calleja, A. Arnau, J. Hinarejos, A. V. De Parga, W. Hofer,
and R. Miranda, Physical review letters 92,

P. Echenique,
206101 (2004).

41A. Picone, G. Fratesi, A. Brambilla, P. Sessi, F. Donati,
S. Achilli, L. Maini, M. Trioni, C. S. Casari, M. Passoni, et al.,
Physical Review B 81, 115450 (2010).

42A. Tange, C. Gao, B. Y. Yavorsky, I. Maznichenko, C. Etz,
A. Ernst, W. Hergert, I. Mertig, W. Wulfhekel, and J. Kirschner,
Physical Review B 81, 195410 (2010).

43T. Woolcot, G. Teobaldi, C. Pang, N. Beglitis, A. Fisher,
and G. Thornton, Physical Review Letters 109,

W. Hofer,
156105 (2012).

44Y. Takahashi, T. Miyamachi, K. Ienaga, N. Kawamura, A. Ernst,
and F. Komori, Physical Review Letters 116, 056802 (2016).
45M. Crommie, C. P. Lutz, and D. Eigler, Nature 363, 524 (1993).
46W.-H. Soe, C. Manzano, A. De Sarkar, N. Chandrasekhar, and

C. Joachim, Physical review letters 102, 176102 (2009).
47J. Repp, G. Meyer, S. M. Stojkovi´c, A. Gourdon,
C. Joachim, Physical Review Letters 94, 026803 (2005).

and

48J. Itatani, J. Levesque, D. Zeidler, H. Niikura, H. Pépin, J.-C.
Kieffer, P. B. Corkum, and D. M. Villeneuve, Nature 432, 867
(2004).

49X. Lu, M. Grobis, K. Khoo, S. G. Louie, and M. Crommie,

Physical Review Letters 90, 096802 (2003).

50L. Gross, F. Mohn, N. Moll, P. Liljeroth, and G. Meyer, Science

325, 1110 (2009).

51F. J. Giessibl, Review of Scientiﬁc Instruments 90, 011101

(2019).

52F. J. Giessibl, Reviews of modern physics 75, 949 (2003).
53L. A. Jones and H. Z. Tan, IEEE transactions on haptics 6, 268

(2012).

54L. Bartels, G. Meyer, and K.-H. Rieder, Physical Review Letters

79, 697 (1997).

55M. F. Crommie, C. P. Lutz, and D. M. Eigler, Science 262, 218

(1993).

56D. M. Eigler and E. K. Schweizer, Nature 344, 524 (1990).
57W. P. Davey, Physical Review 25, 753 (1925).

