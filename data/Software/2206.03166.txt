2
2
0
2

n
u
J

7

]
T
S
.
h
t
a
m

[

1
v
6
6
1
3
0
.
6
0
2
2
:
v
i
X
r
a

A NOVEL STATISTICAL APPROACH FOR TWO-SAMPLE TESTING BASED
ON THE OVERLAP COEFFICIENT

BY ATSUSHI KOMABA1,a HISASHI JOHNO1,b AND KAZUNORI NAKAMOTO2,c

1Department of Radiology, Faculty of Medicine, University of Yamanashi , aﬁveseven.lambda@gmail.com;
bjohnoh@yamanashi.ac.jp

2Center for Medical Education and Sciences, Faculty of Medicine, University of Yamanashi , cnakamoto@yamanashi.ac.jp

Here we propose a new nonparametric framework for two-sample test-
ing, named as the OVL-q (q = 1, 2, . . .). This can be regarded as a natural
extension of the Smirnov test, which is equivalent to the OVL-1. We speciﬁ-
cally focus on the OVL-2, implement its fast algorithm, and show its superi-
ority over other statistical tests in some experiments.

1. Introduction. The overlap coefﬁcient (OVL) is a measure of the similarity between
two probability distributions, deﬁned as the common area under their density functions. Pre-
viously, we have developed a nonparametric method to estimate the OVL [6].

Based on the OVL estimation, here we propose a new statistical approach for two-sample
testing, named as the OVL-q (q = 1, 2, . . .). Furthermore, we describe algorithms for the
OVL-q, and experimentally compare the statistical power of the OVL-1 and OVL-2, for ex-
ample, with that of other statistical tests.

In this paper, we start with preliminaries and basic results in Section 2. The algorithms for
the OVL-q are described in Section 3. Experimental results are shown in Section 4, and the
conclusion follows in Section 5. The proofs of Theorems 2.6 and 3.9 are given in Sections 6
and 7, respectively.

A system to perform the OVL-1 and OVL-2 is available at https://fiveseven-

lambda.github.io/ovl-test/ along with its source code.

a

NOTATION. Throughout this paper, we denote by Z, N, N+, Q, and R the sets of integers,
nonnegative integers, positive integers, rational numbers, and real numbers, respectively. If
, [a, b) =
≤
}
as (extended) real
. For a set A, #A

and if there is no confusion, we write [a, b] =

, (a, b] =
x : a < x
{
N+, we deﬁne Rq

b
≤ ∞
≤
−∞ ≤
x < b
x : a
}
{
≤
intervals. For q
∈
denotes the cardinality of A.

x : a
{
x : a < x < b
}
{
Rq : v1 ≤ · · · ≤
vq

b
}
(v1, . . . , vq)
{

, and (a, b) =

≤
≤ =

≤

∈

x

}

b

2. Analytical framework.

2.1. Estimation of the OVL.

DEFINITION 2.1. On a probability space (Ω, A, P ), let X1, . . . , Xm be real random
variables with a continuous distribution function F0, Y1, . . . , Yn be those with F1, and
X1, . . . , Xm, Y1, . . . , Yn be mutually independent. The empirical distribution functions cor-

MSC2020 subject classiﬁcations: Primary 62G10; secondary 62-04.
Keywords and phrases: overlap coefﬁcient, nonparametric statistics, two-sample testing.

1

 
 
 
 
 
 
2

responding to

X1, . . . , Xm
{

}

and

F0,m(x) =

(1)

1
m

Y1, . . . , Yn
{
m

are given by

}

1(−∞,x](Xi)

R),

(x

∈

i=1
X
n

1(−∞,x](Yi)

R),

(x

∈

F1,n(x) =

1
n

i=1
X

respectively, where 1 denotes the indicator function. Put F0(
F1,n(

) = 1 and F0(

) = F0,m(

) = F1,n(

) = F1(

) = F1(
) = 0.

) = F0,m(

∞

) =

∞

∞

−∞

−∞

−∞

∞
−∞

DEFINITION 2.2. For a real function g on a set A and x, y

g(x). For v = (v1, . . . , vq)

∈

Rq

≤, deﬁne

A, we write g

∈

y
x = g(y)
|

−

(2)

(3)

q

r(v) =

min

i=0
X
q

vi+1
vi

F0|
(cid:8)

vi+1
vi

, F1|

,

(cid:9)

rm,n(v) =

min

F0,m

vi+1
vi
|

, F1,n

vi+1
vi
|

,

where v0 =
We also deﬁne

−∞

and vq+1 =

∞

i=0
X
. Note that 0

(cid:8)

≤

r(v)

≤

1 and 0

≤

(cid:9)
rm,n(v)

1 for all v

≤

Rq
≤.

∈

(4)

ρq,m,n = min
v∈Rq
≤

rm,n(v)

[0, 1],

∈

which exists because rm,n takes at most ﬁnitely many values.

REMARK 2.3. Note that ρq,m,n is measurable on Ω, because rm,n(v) is obviously mea-
Qq

≤ in (4) can be replaced by its countable subset Rq

≤ and Rq
Rq

surable for each v
∈
(since F0,m and F1,n are right continuous).

≤ ∩

DEFINITION 2.4. Suppose ξ is a random variable on (Ω, A, P ) taking values in a sepa-
ξ′
are two sequences of random
rable metric space (E, d);
i,j : i, j
{
variables on (Ω, A, P ) into E. Then we say that
converge almost surely to ξ
ξi
{
if

N+}
ξ′
i,j}
{

ξi : i
{

N+}

∈
and

and

∈

}

P

P

(cid:16)n

ω

Ω : lim
i→∞

∈

ξi(ω) = ξ(ω)

= 1,

ω

∈

Ω :

lim
i,j→∞

o(cid:17)
ξ′
i,j(ω) = ξ(ω)

= 1,

(cid:27)(cid:19)

respectively.

(cid:18)(cid:26)

REMARK 2.5.

If F0 and F1 are differentiable on R with continuous derivatives f0 and

f1, respectively, then the OVL between the two distributions is given by

(5)

ρ =

∞

−∞

min

f0(x), f1(x)
}
{

dx.

Z

∈

R a coincidence point between f0 and f1 if f0(x) = f1(x); x
R a crossover
We call x
point between f0 and f1 if there exists a neighborhood V of x such that for any a, b
V ,
f1(b)] > 0. The set of crossover
(a
points and that of coincidence points are denoted by C(f0, f1) and C ′(f0, f1), respectively.
Note that C(f0, f1)

x) > 0 if and only if [f0(a)

C ′(f0, f1).

f1(a)][f0(b)

x)(b

−

−

−

−

∈

∈

⊂

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

THEOREM 2.6.
#C(f0, f1) = N <

Suppose f0 and f1 are as in Remark 2.5, #C ′(f0, f1) <
. Then ρN,m,n converges almost surely to ρ as m, n

.

→ ∞

∞

3

, and

∞

See Section 6 for the proof of Theorem 2.6.
Hereafter, F0 and F1 are only assumed to be continuous, unless otherwise noted.

2.2. The OVL-q test. For q

N+, we deﬁne the OVL-q test statistic as ρq,m,n. Under the

null hypothesis H0 : F0 = F1, the p-value of ρq,m,n is given by pq,m,n(ρq,m,n) where

∈

(6)

and the lower limit of a 100(1

−

ω
pq,m,n(x) = P (
{

Ω : ρq,m,n(ω)

)
}
α)% conﬁdence interval (0 < α < 1) of ρq,m,n is

(x

≤

∈

∈

x

R),

(7)

lq,m,n(α) = sup

x
{

∈

R : pq,m,n(x) < α
.
}

2.3. The Smirnov test.

(See [2] for reference.) The Smirnov (or the two-sample

Kolmogorov-Smirnov) test statistic is deﬁned as

Dm,n = max
x∈R |

F0,m(x)

F1,n(x)
|

.

−

PROPOSITION 2.7.

(See [4, Section 3.2] for reference.) The relation ρ1,m,n = 1

holds.

PROOF. We have

ρ1,m,n = min
v∈R

rm,n(v)

= min
v∈R

min

F0,m

v
−∞, F1,n
|

v
−∞
|

+ min

F0,m
{

∞
v , F1,n
|

= min
v∈R

(cid:0)
(min

(cid:8)
F0,m(v), F1,n(v)
}
{

(cid:9)
+ min

1

{

−

F0,m(v), 1

∞
v }
|
(cid:1)
F1,n(v)
}

−

)

Dm,n

−

= min
v∈R

(min

F0,m(v), F1,n(v)
}
{

+ 1

−

max

F0,m(v), F1,n(v)
}

)

{

= min
v∈R

(1

F0,m(v)

− |

)
F1,n(v)
|

−

= 1

= 1

−

−

max
v∈R |

F0,m(v)

F1,n(v)
|

−

Dm,n

ω
pm,n(x) = P (
{

∈

Ω : Dm,n(ω)

by deﬁnition.

Let

The p-value of Dm,n under H0 : F0 = F1 is given by
by Proposition 2.7, we have

e

x

)
}

(x

R).

≥
∈
pm,n(Dm,n). Since Dm,n = 1

pm,n(x) = P (
{

ω

∈

Ω : ρ1,m,n(ω)

1

x

e

) = p1,m,n(1
}

−

−

≤

x)

R).

(x

∈

ρ1,m,n

−

Hence

pm,n(Dm,n) is equivalent to the p-value of ρ1,m,n under H0 because

e

e

pm,n(Dm,n) = p1,m,n(1

−

Dm,n) = p1,m,n(ρ1,m,n).

Therefore, the OVL-1 is equivalent to the Smirnov test.

e

4

3. Algorithms for the OVL-q.

3.1. Basic principles.

∈

−

N+, let Γk =

DEFINITION 3.1. For k

N1(γ) for γ = (γ1, . . . , γk)

k
i=1 γi and
N0(γ) = k
where e is the empty sequence,
∈
P
and deﬁne N0(e) = N1(e) = 0. Deﬁne γi:j = (γi+1, . . . , γj) for γ = (γ1, . . . , γk)
Γk
∈
(i < j), and γi:i = e for γ
(k
. Let
0, . . . , k
≥
}
N+, deﬁne
Γk,l =
(8)

k and deﬁne N1(γ) =
0, 1
}
{
Γk. Let Γ0 =

}
Γk+l : N0(γ) = k, N1(γ) = l

0) and i
≥
Γm,n and q

∈
rγ(j1, . . . , jq),

∈
N. For γ

1) and i, j

ρq(γ) =

0, . . . , k

∈ {
∈

for k, l

e
}
{

Γk (k

γ
{

∈ {

∈

∈

}
min
0≤j1≤···≤jq≤m+n

where

(9)

(10)

b

q

b

rγ(j1, . . . , jq) =

min

F0,γ

b

F0,γ(i) =

i=0
X
N0(γ0:i)
m

,

ji+1
ji
|

,

F1,γ

ji+1
ji
|

,

o

b
N1(γ0:i)
n

,

n

b

F1,γ(i) =

j0 = 0, and jq+1 = m + n. Note that 0
(11)

b

rγ (j1, . . . , jq)
b
ρq(γ)

1.

≤
0

1, and hence

≤

≤

≤
b

b

Let

Ω be the set of all ω

Ω such that X1(ω), . . . , Xm(ω), Y1(ω), . . . , Yn(ω) are all dis-

tinct. Since F0 and F1 are continuous, we can see that
(12)

= 1.

Ω

P

b

∈

Hence we can put
Z1, . . . , Zm+n
{
}
most surely. We also put Z0 = Z1 −
0
1

γj =

(

=
(cid:0)
b
1. Now deﬁne

with Z1 <
X1, . . . , Xm, Y1, . . . , Yn
}
{
γm+n)
γ1, . . . ,

γ = (

(cid:1)

· · ·
Γm,n on

< Zm+n al-
Ω by

∈

if Zj
if Zj

b

,
X1, . . . , Xm
}
.
Y1, . . . , Yn
}

b

∈ {
∈ {

b

b

F0,bγ(i) = F0,m(Zi) and

F1,bγ(i) = F1,n(Zi) for

Ω) = Γm,n and
−1
b

b
γ(

b
(cid:19)

REMARK 3.2. By (1) and (10), we have
.

0, . . . , m + n

all i

∈ {

}

b

b

REMARK 3.3. Under the null hypothesis H0 : F0 = F1, we have

ω
P (
{

∈

Ω :

γ(ω) = γ

) = (#Γm,n)−1 =
}

for all γ

Γm,n.

∈

b

b

PROPOSITION 3.4. For q

N+,

ρq(

γ) = ρq,m,n

[0, 1].

∈

∈

m + n
m

(cid:18)

PROOF. By (4) and (8), we have

ρq(

γ) =

b

b
min
0≤j1≤···≤jq≤m+n

rbγ(j1, . . . , jq)

b

b

=

min
0≤j1≤···≤jq≤m+n

rm,n(Zj1, . . . , Zjq)
b

=

min
(v1,...,vq)∈Rq
≤

rm,n(v1, . . . , vq)

= ρq,m,n

[0, 1],

∈

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

5

noting that

q

rbγ (j1, . . . , jq) =

min

F0,bγ

ji+1
ji

,

F1,bγ

ji+1
ji

b

i=0
X
q

n

=

min

(cid:12)
(cid:12)
b
F0,m

(cid:12)
(cid:12)
b
, F1,n

o

Zji+1
Zji
(cid:12)
(cid:12)

o

Zji+1
Zji
(cid:12)
(cid:12)

i=0
X

n
= rm,n(Zj1, . . . , Zjq)

by (3) and (9) and Remark 3.2, where j0 = 0 and jq+1 = m + n.

THEOREM 3.5. Under the null hypothesis H0 : F0 = F1, we have
γ
{

pq,m,n(x) =

Γm,n :

ρq(γ)

(x

#

≤

∈

x

}

R)

∈

#Γm,n
b

for q

N+.

∈

PROOF. This is obvious from (6) and (12), Remark 3.3, and Proposition 3.4.

With this theorem, we can naively perform the OVL-q (see Section 2.2). Let us call this al-
gorithm the naive OVL-q. If q = 2 and m = n, a faster algorithm can be applied, as described
in the next subsection. An optimized algorithm for the OVL-1 (equivalent to the Smirnov
test; see Section 2.3) has been previously proposed [8].

3.2. A faster algorithm to calculate p2,n,n. Throughout this subsection, we assume that

m = n and H0 : F0 = F1 hold.

PROPOSITION 3.6. For any γ

ρq(γ) = k/n.

Γn,n and q

∈

∈

N+, there exists k

0, . . . , n

∈ {

}

such that

PROOF. It follows from (8), (9) and (11) that

b

ρq(γ) =

min
0≤j1≤···≤jq≤m+n

i=0
X
where j0 = 0 and jq+1 = m + n. Noting that

b

n

b

q

min

F0,γ

min

F0,γ

ji+1
ji
|

,

F1,γ

ji+1
ji
|

by (10), we obtain the claim.

n

b

b

0,

(cid:26)

∈

o

ji+1
ji
|

,

F1,γ

ji+1
ji
|

[0, 1]

∈

o

b

1
n

,

2
n

, . . .

(cid:27)

REMARK 3.7. We can see from Proposition 3.6 that the distribution function pq,n,n in

Theorem 3.5 is uniquely determined by the values pq,n,n(k/n) for k = 0, . . . , n.

DEFINITION 3.8. Deﬁne a sequence

Qi(x)
}
{

of polynomials in x inductively by

Q1(x) = Q0(x) = 1,

Qi+2(x) = Qi+1(x)

xQi(x)

(i

−

N).

∈

We denote by Q′
i(x) the derivative of Qi(x). Note that Q0(x), Q1(x), . . . can be regarded as
formal power series. For a formal power series Q(x), we denote by [xk]Q(x) the coefﬁcient
of xk in Q(x), and by 1/Q(x) the multiplicative inverse of Q(x) (if it exists).

6

We can ﬁnd

Qi(x)
}
{

we can easily see that [x0]Qi(x) = 1, and hence 1/Qi(x) exists.

in [10] as a variation of the Fibonacci polynomials. For each i

N,

∈

THEOREM 3.9. For k = 0, . . . , n, we have

(13)

#

γ

Γn,n :

ρ2(γ)

∈

(cid:27)
See Section 7 for the proof of Theorem 3.9.

(cid:26)

b

1

≥

−

k
n

= [xn]

Q′
k+1(x)
Qk(x) −

Q′
k+2(x)
Qk+1(x)

.
(cid:19)

(cid:18)

REMARK 3.10. For k = 0, . . . , n, Theorem 3.5 and Proposition 3.6 imply

p2,n,n

k
n

(cid:18)

(cid:19)

= 1

= 1

−

−

#

γ

(cid:8)

#

γ

∈

∈

(cid:8)

Γn,n :

ρ2(γ) > k
n

#Γn,n
b
ρ2(γ)

Γn,n :

(cid:9)
k+1
n

≥

#Γn,n
b
Q′
n−k(x)
Qn−k−1(x) −

,

(cid:9)

where

#

γ

Γn,n :

ρ2(γ)

∈

k + 1
n

≥

= [xn]

(cid:27)

(cid:18)

(cid:26)

Q′
n−k+1(x)
Qn−k(x)

(cid:19)

b

if k

n

1, by Theorem 3.9. It is obvious that p2,n,n(n/n) = 1.

−

≤
Remarks 3.7 and 3.10 imply that we can calculate p2,n,n with the use of

. Let us
call this algorithm the fast OVL-2. In Section 4.1, we will numerically compare the compu-
tation times of the naive and fast OVL-2.

Qi(x)
}
{

4. Numerical experiments.

∈ {

10, 12, 14, 16
}

4.1. Computation times of the naive and fast OVL-2. We performed the following bench-
mark test on a personal computer with min 2200 MHz – max 5083 MHz CPU (AMD Ryzen
9 5950X 16-Core Processor), 62.8 GiB RAM, and Linux 5.16.14 (Arch Linux). For each
, we compared the mean computation times of the naive and fast OVL-2
n
(averaged over 10 computations for the naive; 100000 computations for the fast) to calcu-
late p2,n,n(1/2). We further measured the mean computation time of the fast OVL-2 (aver-
aged over 10 computations) to calculate p2,n,n(1/2) with n
. The
source code used here was written in Rust (2021 edition, rustc 1.58.1), and is published at
https://github.com/fiveseven-lambda/fast-OVL-benchmark/.

500, 1000, 5000, 10000
}

∈ {

TABLE 1

Mean computation time [ms]
fast OVL-2
naive OVL-2
0.026
9
0.026
135
0.028
2153
0.023
34361
12
–
49
–
1865
–
8027
–

n
10
12
14
16
500
1000
5000
10000

Table 1 shows the result of the benchmark test. As can be seen, the fast OVL-2 was
much faster than the naive OVL-2 (e.g., more than one million times faster to compute

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

7

p2,16,16(1/2)). The calculation of p2,n,n(1/2) with n
was com-
putationally difﬁcult for the naive OVL-2 but easy for the fast OVL-2 (e.g., the fast OVL-2
could compute p2,10000,10000(1/2) in around eight seconds).

500, 1000, 5000, 10000
}

∈ {

4.2. The statistical power of the OVL-2 test.

In this experiment, we focused on the case
m = n and simulated X1, . . . , Xn, Y1, . . . , Yn in Deﬁnition 2.1, with f0 and f1 in Remark 2.5
being speciﬁc functions (described in the next paragraph). The random samples were sub-
jected to the OVL-1, OVL-2, and other statistical tests (i.e., the Welch t [12], two-tailed
F [11, Section 6.12], Mann-Whitney U [7], and two-sample Cramér-von Mises test [1])
to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial (from
the generation of 2n random samples) was repeated 20000 times independently for each
, and the statistical power (or equivalently the rejection ratio) of each test
n
was calculated. The source code used here was written in Rust (2021 edition, rustc 1.58.1)
and Python (version 3.9), and is published at https://github.com/fiveseven-
lambda/OVL-q-test-comparison.

22, 23, . . . , 212

∈ {

}

As probability density functions, we used

Normalµ,σ (x) =

1
√2πσ

exp

with µ

∈

R and σ > 0 for normal distributions;

(x

µ)2

−
2σ2

(cid:19)

R)

(x

∈

−

(cid:18)

for a trapezoidal distribution;

(x + 2)/2
(2
(
−
0

√2)/2
−
x + 2)/2

Trapezoidal (x) = 


(x + √6)/6
(
−
0

Triangular (x) = 


x + √6)/6

√2,
√2,

2
x
≤
√2 < x

if
−
if
−
if √2 < x
if x <

≤ −
≤
2,
2 or 2 < x

≤

−

√6
−
0 < x

if
if
if x <

0,

x
≤
√6,

≤
≤
√6 or √6 < x

−

for a triangular distribution;



Mixed (x) =

1
2

(Normal−0.8,0.6 + Normal0.8,0.6) (x)

R)

(x

∈

for a mixed normal distribution. As a control function, we ﬁxed f0 = Normal0,1.

Figures 1 to 5 show the experimental results:

• In the case f1 = Normal0,1.1 where f0 and f1 were the densities of two normal distribu-
tions with identical means and different variances, the power of the F test was the highest,
followed by the OVL-2, Cramér-von Mises, OVL-1, and then Welch t or Mann-Whitney
U test (Figure 1).
where f0 and f1 were the densities of
• In the case f1 ∈ {
two different distributions with identical means and variances, the power of the OVL-2 test
was the highest, followed by the OVL-1 or Cramér-von Mises, Welch t or Mann-Whitney
U , and then F test (Figures 2 to 4).

Trapezoidal, Triangular, Mixed

}

• In the case f1 = Normal0.2,1 where f0 and f1 were the densities of two normal distribu-
tions with different means and identical variances, the power of the Welch t test was the
highest, followed by the Mann-Whitney U , Cramér-von Mises, OVL-1, OVL-2, and then
F test (Figure 5).

8

y
t
i
s
n
e
d

y
t
i
l
i

b
a
b
o
r
p

r
e
w
o
p

l

a
c
i
t
s
i
t
a
t
s

Nor al0, 1

Nor al0, 1.1

−4

−3

−2

−1

0

1

2

3

4

0.4

0.3

0.2

0.1

0.0

1.0

OVL-1

0.8

OVL-2

Welch t

0.6

F

Mann-Whitney U

Cramér-von Mises

0.4

0.2

0.0

1

10

2

3

10

10

sa ple size (n)

FIG 1. The random variables X1, . . . , Xn, Y1, . . . , Yn were realized with f0 = Normal0,1 and f1 =
Normal0,1.1, and subjected to the statistical tests (the OVL-1, OVL-2, Welch t, F , Mann-Whitney U , and Cramér-
von Mises test) to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial was repeated
20000 times independently for each n ∈ {22, 23, . . . , 212}, and the statistical power of each test was evaluated.
Note that Normal0,1 has mean 0 and variance 1, while Normal0,1.1 has mean 0 and variance 1.21.

y
t
i
s
n
e
d

y
t
i
l
i

b
a
b
o
r
p

r
e
w
o
p

l

a
c
i
t
s
i
t
a
t
s

Normal0, 1

Trapezoidal

−4

−3

−2

−1

0

1

2

3

4

0.4

0.3

0.2

0.1

0.0

1.0

OVL-1

0.8

OVL-2

Welch t

0.6

F

Mann-Whitney U

Cramér-von Mises

0.4

0.2

0.0

1

10

2

3

10

10

sample size (n)

FIG 2. The random variables X1, . . . , Xn, Y1, . . . , Yn were realized with f0 = Normal0,1 and f1 =
Trapezoidal, and subjected to the statistical tests (the OVL-1, OVL-2, Welch t, F , Mann-Whitney U , and Cramér-
von Mises test) to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial was repeated
20000 times independently for each n ∈ {22, 23, . . . , 212}, and the statistical power of each test was evaluated.
Note that Normal0,1 and Trapezoidal have mean 0 and variance 1.

 
 
 
 
TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

9

y
t
i
s
n
e
d

y
t
i
l
i

b
a
b
o
r
p

r
e
w
o
p

l

a
c
i
t
s
i
t
a
t
s

Normal0, 1

Triangular

−4

−3

−2

−1

0

1

2

3

4

0.4

0.3

0.2

0.1

0.0

1.0

OVL-1

0.8

OVL-2

Welch t

0.6

F

Mann-Whitney U

Cramér-von Mises

0.4

0.2

0.0

1

10

2

3

10

10

sample size (n)

FIG 3. The random variables X1, . . . , Xn, Y1, . . . , Yn were realized with f0 = Normal0,1 and f1 =
Triangular, and subjected to the statistical tests (the OVL-1, OVL-2, Welch t, F , Mann-Whitney U , and Cramér-
von Mises test) to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial was repeated
20000 times independently for each n ∈ {22, 23, . . . , 212}, and the statistical power of each test was evaluated.
Note that Normal0,1 and Triangular have mean 0 and variance 1.

y
t
i
s
n
e
d

y
t
i
l
i

b
a
b
o
r
p

r
e
w
o
p

l

a
c
i
t
s
i
t
a
t
s

Nor al0, 1

Mixed

−4

−3

−2

−1

0

1

2

3

4

0.4

0.3

0.2

0.1

0.0

1.0

OVL-1

0.8

OVL-2

Welch t

0.6

F

Mann-Whitney U

Cramér-von Mises

0.4

0.2

0.0

1

10

2

3

10

10

sa ple size (n)

FIG 4. The random variables X1, . . . , Xn, Y1, . . . , Yn were realized with f0 = Normal0,1 and f1 = Mixed,
and subjected to the statistical tests (the OVL-1, OVL-2, Welch t, F , Mann-Whitney U , and Cramér-von Mises
test) to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial was repeated 20000
times independently for each n ∈ {22, 23, . . . , 212}, and the statistical power of each test was evaluated. Note
that Normal0,1 and Mixed have mean 0 and variance 1.

 
 
 
 
10

y
t
i
s
n
e
d

y
t
i
l
i

b
a
b
o
r
p

r
e
w
o
p

l

a
c
i
t
s
i
t
a
t
s

Nor al0, 1

Nor al0.2, 1

−4

−3

−2

−1

0

1

2

3

4

0.4

0.3

0.2

0.1

0.0

1.0

OVL-1

0.8

OVL-2

Welch t

0.6

F

Mann-Whitney U

Cramér-von Mises

0.4

0.2

0.0

1

10

2

3

10

10

sa ple size (n)

FIG 5. The random variables X1, . . . , Xn, Y1, . . . , Yn were realized with f0 = Normal0,1 and f1 =
Normal0.2,1, and subjected to the statistical tests (the OVL-1, OVL-2, Welch t, F , Mann-Whitney U , and Cramér-
von Mises test) to verify the null hypothesis H0 : F0 = F1 with 95% conﬁdence interval. This trial was repeated
20000 times independently for each n ∈ {22, 23, . . . , 212}, and the statistical power of each test was evaluated.
Note that Normal0,1 has mean 0 and variance 1, while Normal0.2,1 has mean 0.2 and variance 1.

5. Conclusion. Based on the OVL estimation, we have devised a novel statistical frame-
N+), which can be regarded as a natural ex-
work for two-sample testing: the OVL-q (q
∈
tension of the Smirnov test (since the OVL-1 is equivalent to the Smirnov test). We have
explained and implemented the algorithms for the OVL-q (in particular, the fast OVL-2 algo-
rithm). Furthermore, we have demonstrated the superiority of the OVL-2 over conventional
statistical tests in some experiments.

≥

One limitation is that we are currently unable to rapidly perform the OVL-2 if m

= n or
the OVL-q if q
3. To overcome this, we should explore the possibility of expanding fast and
exact algorithms for the OVL-q, or should investigate the asymptotic distribution of ρq,m,n
) to approximate the OVL-q in future works. The treatment of ties (which may
(as m, n
occur in Ω
Ω if F0 or F1 is practically discontinuous) is also an important topic of research.
In addition, it is meaningful to further evaluate the statistical power of the OVL-q both in
simulations and in real observations.

→ ∞
\

b

6. Proof for Theorem 2.6.

DEFINITION 6.1.

In the setting of Deﬁnition 2.4, we say that

converges completely

ξi
{

}

to ξ if

for any ǫ > 0.

∞

i=1
X

P (

ω
{

∈

Ω : d (ξi(ω), ξ(ω)) > ǫ

) <

}

∞

 
 
6
TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

11

REMARK 6.2.
to ξ if and only if

(See [5] for reference.) It is well known that

converges almost surely

ξi
{

}

∞

lim
l→∞

P

for any ǫ > 0. Note that if
to ξ.

ξi
{

}

ω
{

∈

Ω : d (ξi(ω), ξ(ω)) > ǫ

= 0

}!

[i=l
converges completely to ξ, then

converges almost surely

ξi
{

}

THEOREM 6.3.

(The Glivenko-Cantelli theorem. See [9, Theorem A, Section 2.1.4] for

the proof.) As m

→ ∞

and n

,

→ ∞
F0,m(x)

sup
x∈R |

,
F0(x)
|

F1,n(x)

sup
x∈R |

F1(x)
|

−

−

converge completely to 0, respectively.

LEMMA 6.4.

(See [6, Lemma A.12] for the proof.) If x, y, z, w

R, then

∈

(a)
(b)

max
min

max
min

x, y
{
x, y
{

z, w
{
z, w
{

x
}| ≤ |
x
}| ≤ |

z
−
z
−

|

+
|
+

y
|
y
|

|
|

} −
} −

−
−
In accordance with Theorem 2.6, let F0 and F1 be differentiable on R with continuous
with c1 <

, C(f0, f1) =

derivatives f0 and f1, respectively, #C ′(f0, f1) <
, and cN +1 =

< cN , c = (c1, . . . , cN ), c0 =

c1, . . . , cN
{

}

|

,

w
|
.
w

· · ·

−∞

∞
.
∞

REMARK 6.5.

It follows from (5) and Deﬁnition 2.2 that r(c) = ρ.

DEFINITION 6.6. For q

∈

N+, deﬁne

q = arg min

v∈Rq
≤

r(v),

q,m,n = arg min

v∈Rq
≤

rm,n(v),

V

V

∈

q =

(ci1 , . . . , ciq ) : 1
{

≤

C

i1 <

· · ·

< iq

N

.
}

≤

REMARK 6.7.

and

V

q,m,n

=

∅

It follows from (4), Theorems 6.9 and 6.13, and Corollary 6.12 that
N =

N+. It is obvious that

if q > N .

q =

and

for all q

=

q

V

∅

C

c
{

LEMMA 6.8.

Suppose q

vi < cs < vi+1 for some i

N+, v = (v1, . . . , vq)
and s

∈
1, . . . , N

∈
0, . . . , q

∈ {

}

∈ {

}

∅

}
C
Rq
≤, v0 =
, then r(v) > ρ.

−∞

, and vq+1 =

. If

∞

, there is an open interval U

(vi, vi+1) with U

PROOF. Since #C ′(f0, f1) <
, so that [f0(a)

}

cs
{

∞
f1(a)][f0(b)

∩
C ′(f0, f1) =
U with a < cs < b.
Now ﬁx such a and b. Without loss of generality, we assume that f0(a) < f1(a) and
f0(b) > f1(b). If F0|
ρ
−
q

⊂
f1(b)] < 0 for all a, b

vi+1
vi ≤

−
vi+1
vi

F1|

, then

r(v)

−

∈

vj+1

vj+1

vj+1

=

min

j=0  
X

vj

(Z
vi+1

f0(x) dx,

f1(x) dx

vj

Z

vi+1

vj

Z

) −
vi+1

min

f0(x), f1(x)
}
{

dx

!

min

≥

vi

(cid:26)Z

f0(x) dx,

f1(x) dx

vi

Z

−

(cid:27)

vi

Z

min

f0(x), f1(x)
}
{

dx

 
6
6
12

vi+1

=

Z

vi

b

(f0(x)

min

) dx
f0(x), f1(x)
}
{

−

(f0(x)

−

f1(x)) dx

cs

≥

Z
> 0.

We can similarly prove that r(v)

ρ > 0 if F0|
THEOREM 6.9. The minimum of r on RN

−

vi+1

vi > F1|

vi+1
vi

.

≤ is ρ, which is uniquely attained at c.

PROOF. If v = (v1, . . . , vN )

for some s, hence
vi < cs < vi+1 for some i as in the assumption of Lemma 6.8, so that r(v) > ρ = r(c) (note
Remark 6.5).

= c, then cs /

v1, . . . , vN

≤ with v

∈ {

∈

}

RN

THEOREM 6.10.

If q

1, . . . , N

∈ {

and v

1
}

−

∈

Rq

≤, then r(v) > r(c).

PROOF. Since q < N , cs /

v1, . . . , vq

∈ {

for some s. The proof is similar as that of Theo-

}

rem 6.9.

If q
THEOREM 6.11.
w = (cj1, . . . , cjq ) with 1

1, . . . , N
∈ {
j1 ≤ · · · ≤
≤
Rq

∈
η(v) = #

−
jq

1
}
≤

, then for any v = (v1, . . . , vq)
N such that r(w)

r(v).

≤

Rq

≤, there exists

∈

PROOF. Let v = (v1, . . . , vq)

≤, v0 =

−∞
1, . . . , q

, vq+1 =

, and

∞

: vi /
∈

.
C(f0, f1)
}

}

i
{

∈ {

}

and s

1, . . . , q

1, . . . , N

The statement obviously holds when η(v) = 0. Hence suppose η(v) > 0. Then we can choose
cs < vi < cs+1.
satisfying cs−1 < vi < cs
vi+1 or vi−1 ≤
i
∈ {
∈ {
vi+1, as the other is similar. Without loss of
We will only prove the case cs−1 < vi < cs
cs
generality, we may assume that f0 ≤
vi <
cs−1 < F1|
vi , since #C ′(f0, f1) <
vi
cs
F1|
vi−1
vi
vi−1 .
and (II) F0|
vi−1 > F1|
vi
vi−1 ≤

f1 on (cs−1, cs), so that F0|

cs−1 and F0|
vi
F1|
vi−1 ≤

(I) Suppose F0|

≤

≤

}

vi

vi

vi

. In the following, we consider the cases (I) F0|
∞
vi
vi−1 . Then
F1|
cs
F0|
vi−1 < F1|
cs
Fj
vi−1 = Fj
|
vi+1
cs = Fj
|

cs
vi−1,
vi
vi−1 + Fj
|
vi+1
vi −
|

(j = 0, 1),

(j = 0, 1),

cs
vi
|
cs
vi
|

Fj

Fj

hence

min
j

Fj

cs
vi−1 + min
|

j

Fj

Fj

cs
vi )
|
vi+1
vi −
|
vi+1
vi −
|

Fj

cs
vi )
|
cs
F0|
vi

vi+1
cs = F0|
|
= F0|
F0|
≤
= F0|
= min
j

cs
vi−1 + min

j

(Fj

vi+1
vi −
|

vi

vi

vi−1 + F0|
vi−1 + F0|
vi
vi−1 + min

j

cs
vi + min

(Fj

cs
vi + min

Fj

j

j

Fj

vi+1
vi
|

Fj

vi
vi−1 + min
|

j

Fj

vi+1
vi
|

,

6
TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

and setting v′ = (v1, . . . , vi−1, cs, vi+1, . . . , vq)
r(v).

Rq

≤ results in η(v′) < η(v) and r(v′)

∈

vi

vi−1 > F1|

cs−1

vi

vi−1 . Since f0 ≤

vi−1 . (II-i) First consider the case F0|

f1 on (cs−1, cs), we can see that vi−1 < cs−1 <
vi+1
F1|
cs−1 <

. Then F0|

vi+1
vi ≤

vi+1
vi

(II) Suppose F0|
vi+1
cs−1, hence

vi and F0|
F1|

vi−1 > F1|

cs−1

13

≤

vi+1
cs−1

vi

cs−1 + F0|
cs−1 + F0|

vi

vi+1
vi

vi+1
vi

vi+1
vi

cs−1

cs−1

cs−1

vi−1 + F0|
vi−1 + F0|
vi−1 + F1|
vi−1 + F0|
Fj

vi

j

Fj

Fj

min
j

cs−1
vi−1 + min
|

vi+1
cs−1 = F1|
|
= F1|
< F1|
= F1|
= min
j
and setting v′ = (v1, . . . , vi−1, cs−1, vi+1, . . . , vq)
r(v). (II-ii) Next consider the case F0|
vi+1
such that F0|
F1|
x
≤
(v1, . . . , vi−1, x, vi+1, . . . , vq)

vi+1
x

vi+1

, then F0|
Rq
∈
r(v) = min
Fj

r(v′′)

−

j

,

x

Fj

vi+1
vi
|

vi−1 > F1|

. (II-ii-a) If there is x

vi
vi−1 + min
|
Rq
≤ results in η(v′) < η(v) and r(v′) <
∈
vi+1
vi > F1|
(cs−1, vi)
vi
vi−1 , hence the case (II-i) applies to v′′ =
x
≤, where η(v′′) = η(v) and
x
vi−1 + min
|
vi−1 + F0|
vi−1 + F1|

vi+1
x −
|
vi
F1|
vi−1 −
vi
F1|
vi−1 −

vi+1
x −
vi+1
x −

vi
vi−1 −
|

F1|
F1|

vi+1
vi
|

min
j

min
j

vi+1
vi

vi+1
vi

Fj

Fj

Fj

∈

x

x

j

vi+1

(II-ii-b) If F0|
(v1, . . . , vi−1, cs−1, vi+1, . . . , vq)

x > F1|

r(v′)

−

r(v) = min

j

∈

for any x
Rq

vi+1
(cs−1, vi), then F0|
cs−1 ≥
≤ results in η(v′) < η(v) and
vi+1
vi
cs−1 −
vi−1 −
|
|
vi
F1|
vi−1 −

∈
cs−1
vi−1 + min
|
vi−1 + F1|

vi+1
cs−1 −

min
j

F1|

vi+1
vi

cs−1

Fj

Fj

Fj

j

F1|

vi+1
cs−1, and setting v′ =

min
j

Fj

vi+1
vi
|

Taken together, for any v
and r(v′)

∈

≤

Rq

≤ with η(v) > 0, there exists v′

Rq

≤ such that η(v′) < η(v)

∈

r(v). The statement follows by induction.

COROLLARY 6.12.

inf

r(v) : v
{

∈

Rq

≤}

If q

1
}
. Furthermore, r(c′) > r(c).

1, . . . , N

∈ {

−

, then there exists c′

q such that r(c′) =

∈ C

PROOF. Since there are only ﬁnitely many choices for w

can choose w′ = (ci1, . . . , ciq )
r(w′)
r(v) for all v
and there exists A′ =
c′ = (cj1, . . . , cjq ), we have c′
min

∈
cj1, . . . , cjq}
{
∈ C

Rq

Rq

≤

∈

r(v) : v
{

∈

≤}

≤. Suppose w′ /

Rq

≤ in Theorem 6.11, we
∈
arg minw r(w), where w ranges over the choices. Then
. Then #A < q,
ci1 , . . . , ciq }
{
N . Putting
< jq
j1 <
⊂
· · ·
≤
r(w′) by deﬁnition. Hence r(c′) = r(w′) =

q and put A =
A′ and 1

such that A

q and r(c′)

∈ C

≤

. Furthermore, r(c′) > r(c) by Theorem 6.10.

≤

THEOREM 6.13. For q = N + 1, N + 2, . . ., the minimum of r on Rq

≤ is ρ.

PROOF. Since

c1, . . . , cN
{
lows by Remark 6.5 and Lemma 6.8.

} ⊂ {

v1, . . . , vq

implies r(c) = r(v1, . . . , vq), the claim fol-

}

j

= F1|
F1|
≤
= 0.
vi+1
x

= F1|
= 0.

14

REMARK 6.14. For some q

N =

c
(Note that
{
example for the case where N = 3, q = 2, and
by

N =

∈ {

1, . . . , N

q does not necessarily imply v
q.
1
}
∈ C
by Theorem 6.9 and
.) Here we give an
=
C
· · ·
V2 6⊂ C2. Assume that f0 and f1 are deﬁned

, v
∈ V
N +1 =

N +2 =

−

V

C

C

}

∅

f0(x) =

1−cos x
4π

0

(

4π),

x
(0
(otherwise),

≤

≤

f1(x) =

1+cos x
4π

0
(

5π),

x
(π
(otherwise).

≤

≤

Then (3π/2, 11) is in
that 7π/2 = 10.995 . . . < 11.)

V2 but not in

C2 =

(3π/2, 5π/2), (3π/2, 7π/2), (5π/2, 7π/2)
}
{

. (Note

THEOREM 6.15. For q

N+, supv∈Rq

rm,n(v)

≤ |

r(v)
|

−

converges almost surely to 0 as

∈

m, n

.

→ ∞

PROOF. For v

Rq

≤, we have

∈

q

rm,n(v)

|

r(v)

| ≤

−

≤

min

F0,m

i=0
X
q

(cid:12)
(cid:12)

(cid:8)

vi+1
vi
|

, F1,n

vi+1
vi
|

−

(cid:9)

F0,m

vi+1
vi −
|

vi+1
vi

F0|

+

F1,n

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

min

vi+1
vi

F0|

vi+1
vi

, F1|

(cid:9)(cid:12)
(cid:12)

(cid:8)

vi+1
vi −
|

vi+1
vi

F1|

(cid:12)
(cid:17)
(cid:12)
(cid:12)

F0,m(vi)
|

−

F0(vi)
|

F0,m(vi+1)

≤ |

−
F0,m(x)

2 sup
x∈R |

≤

+

F0(vi+1)
|
,

F0(x)
|

−

F1,n(vi+1)

≤ |

−
F1,n(x)

2 sup
x∈R |

≤

F1,n(vi)
|

−

F1(vi)
|

+

F1(vi+1)
|
,

F1(x)
|

−

by deﬁnition and Lemma 6.4. Since

i=0 (cid:16)(cid:12)
X
(cid:12)
(cid:12)

vi+1
vi −
|

vi+1
vi

F0|

F0,m
(cid:12)
(cid:12)
(cid:12)

F1,n

vi+1
vi −
|

vi+1
vi

F1|

(cid:12)
(cid:12)
(cid:12)

we obtain

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

sup
v∈Rq
≤

rm,n(v)
|

−

r(v)

| ≤

2(q + 1)

F0,m(x)

sup
x∈R |

(cid:18)

F0(x)
|

−

+ sup
x∈R |

F1,n(x)

F1(x)
|

−

,

(cid:19)

whose right side converges almost surely to 0 as m, n

by Remark 6.2 and Theorem 6.3.

→ ∞

The measurability of supv∈Rq

rm,n(v)

≤ |

r(v)
|

−

on Ω can be proved by the same argument

as in Remark 2.3.

DEFINITION 6.16. Let (A, d) be a metric space. We deﬁne a discrepancy of A1 ⊂

A

from A2 ⊂

A by

D(A1, A2) = sup

a1∈A1 (cid:18)

inf
a2∈A2

d(a1, a2)

.

(cid:19)

If the metric space is Rq (q

∈

N+) with the Euclidean metric, we write Dq in place of D.

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

15

LEMMA 6.17. Let (A, d) be a metric space. Let g and gi,j (i, j

∈
on A such that min
A
}
and Ti,j = arg mint∈A gi,j(t). Suppose g is continuous on A, supt∈A |
i, j

, and there is a compact set K

gi,j(t) : t
{

g(t) : t
{

A such that

and min

N+) be real functions
exist. Put T = arg mint∈A g(t)
0 as

gi,j(t)

A
}

g(t)

| →

−

∈

∈

→ ∞

min

g(t) : t
{

∈

< inf

{

g(t) : t

A

K

.

}

\

∈

⊂
A
}

.

Then D(Ti,j, T )

0 as i, j

→ ∞
→
PROOF. If T ′ = arg maxt∈A (
i,j = Ti,j, hence D(Ti,j, T ) = D(T ′
T ′
gi,j, respectively).
g and

−

−

−

g(t)) and T ′
i,j, T ′)

gi,j(t)), then T ′ = T and
i,j = arg maxt∈A (
0 by [6, Lemma A.15] (replace g and gi with

−

→

LEMMA 6.18. There exists a compact set K

min

r(v) : v

RN
≤

∈

< inf

RN

≤ such that

⊂
r(v) : v

RN

≤ \

∈

K

.

PROOF. By Theorem 6.9 and Corollary 6.12, there exist

(cid:8)

(cid:9)

(cid:8)

(cid:9)

Mq = min

r(v) : v

Rq
≤

(q = 1 . . . , N )

∈

M1, . . . , MN −1}
{

R with α < β such that Fj(α) < ǫ and 1

and M = min
α, β
creasing functions with limx→−∞ Fj(x) = 0 and limx→∞ Fj(x) = 1. Let K = [α, β]N
and v = (v1, . . . , vN )

MN )/3. We can take
Fj(β) < ǫ (j = 0, 1), since Fj are nonde-
RN
≤

K. Then v1 < α or vN > β holds.

o
n
> MN . Choose ǫ > 0 with ǫ < (M

RN

−

−

∈

∩

Suppose v1 < α and put v′ = (v2, . . . , vN ). Using Lemma 6.4, we obtain

∈

≤ \

r(v)

−

r(v′)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

=

min
j
(cid:12)
(cid:12)
(cid:12)
min
(cid:12)
j
(cid:12)
(cid:12)
(cid:12)
< ǫ +
(cid:12)

≤

= ǫ +

< 3ǫ.

Fj

v1
−∞ + min
|

j

Fj

v2
v1 −
|

min
j

Fj

v2
−∞
|

(cid:12)
(cid:12)
(cid:12)
v2
(cid:12)
−∞
|

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Fj

v1
−∞
|

+

min
j

Fj

v2
v1 −
|

min
j

Fj

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
v2
F0|
(cid:12)
(cid:12)
−∞
+

+

v2
−∞

v2
v1 −

v2
v1 −
v1
−∞

F1|

F0|
(cid:12)
(cid:12)
F0|
(cid:12)
(cid:12)
(cid:12)
(cid:12)
+ r(v) < 3ǫ + r(v). We can similarly prove that M <

F1|
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
v1
(cid:12)
−∞

F1|

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

r(v′)
Hence M
−
3ǫ + r(v) for the case vN > β.

r(v′)

≤ |

≤

r(v)
|

Therefore M < 3ǫ + r(v) for all v

holds. This is the claim.

MN < M

−

∈
3ǫ

RN

≤ \
inf

≤

K, so that

r(v) : v
{

∈

RN

≤ \

K

}

THEOREM 6.19. As m, n

, DN (

N,m,n,

N ) converges almost surely to 0.

→ ∞
PROOF. In Lemma 6.17, let (A, d) be the subspace RN

≤ of the Euclidean metric space
RN , g = r (which is continuous on RN
≤ ), and gi,j = ri,j. Then by Remark 6.7, Theo-
rem 6.15, and Lemma 6.18, the assumptions in Lemma 6.17 are satisﬁed almost surely, hence
DN (

N ) converges almost surely to 0 as m, n

N,m,n,

V

V

.

V

V

→ ∞

16

The measurability of DN (

V

N,m,n,

V

N ) will be proved at the end of this section.

COROLLARY 6.20. As m, n

, vm,n

∈ V

→ ∞

N,m,n converges almost surely to c.

PROOF. Since

V

N =

c
{
DN (

V

}
N,m,n,

by Theorem 6.9, we have

N ) = sup

v∈VN,m,n

V

d(v, c)

≥

d(vm,n, c).

Hence the claim follows from Theorem 6.19.

We cannot guarantee that vm,n is necessarily measurable. We mean by “vm,n converges
with
}
. If (Ω, A, P )

almost surely to c” that there exists a measurable set A
P (A) = 1. In fact, we can take A =
is complete, we have P (
ω
{

∈
Ω : limm,n→∞ DN (
V
) = 1.
}

Ω : limm,n→∞ vm,n = c
N ) = 0
N,m,n,
}

Ω : limm,n→∞ vm,n = c

ω
{

⊂ {

∈

∈

ω

V

THEOREM 6.21. As m, n

→ ∞

, ρN,m,n converges almost surely to ρ.

PROOF. Let vm,n = (v1, . . . , vN )
Lemma 6.4, and Theorem 6.9, we have

∈ V

N,m,n, v0 =

, and vN +1 =

∞

−∞

. By Deﬁnition 2.2,

where

and

ρN,m,n

|

=

ρ
|

−

|

rm,n(vm,n)

r(c)
|

−

N

≤

i=0 (cid:16)(cid:12)
X
(cid:12)
(cid:12)

F0,m

vi+1
vi −
|

ci+1
ci

F0|

+

F1,n

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

vi+1
vi −
|

ci+1
ci

F1|

,

(cid:17)

(cid:12)
(cid:12)
(cid:12)

vi+1
vi −
|

ci+1
ci

F0|

F0,m
(cid:12)
(cid:12)
(cid:12)

F1,n

vi+1
vi −
|

ci+1
ci

F1|

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

=

F0,m(vi+1)
|
F0,m(vi+1)

≤ |

−
F0,m(vi)

+

|

F0,m(vi)

−

−
+

F0(ci+1) + F0(ci)
|
F0(ci+1)
|

F0(vi+1)
|
F0(vi)
|

−

+

F0(vi+1)
|
F0(vi)
|

−

−
F0(ci)
|

=

F1,n(vi+1)
|
F1,n(vi+1)

≤ |

−
F1,n(vi)

+

|

F1,n(vi)

−

−

F1(vi+1)
|

F1(vi)
|

−

+

+

F1(ci+1) + F1(ci)
|
F1(ci+1)
|

F1(vi+1)

|
F1(vi)
|

−
F1(ci)
|

.

−

Now recall that we are considering the probability space (Ω, A, P ). By Remark 6.2 and The-
A with P (A1) = 1 such that for each ω
orem 6.3, there exists A1 ∈
F0,m(x)

∈
F1(x)

F1,n(x)

F0(x)

A1,

0,

0

−

| →

−

| →

sup
x∈R |

sup
x∈R |

as m, n
→ ∞
surely as m, n
each ω

A2,

∈

. Since F0 and F1 are continuous on R and vm,n = (v1, . . . , vN )

c almost
A with P (A2) = 1 such that for

→

→ ∞

by Corollary 6.20, there exists A2 ∈

Fk(vi)
|
−
as m, n
. Put A = A1 ∩
exist integers N1(ω), N2(ω) such that m, n

Fk(ci)

→ ∞

| →

0

A2. Then P (A) = 1. For each ω

A and for any ǫ > 0, there

∈

N1(ω) implies

≥

(k = 0, 1; i = 1, . . . , N )

F0,m(x)

sup
x∈R |

F0(x)
|

−

< ǫ,

F1,n(x)

sup
x∈R |

F1(x)
|

−

< ǫ

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

17

and m, n

≥

N2(ω) implies

hence m, n

≥

for i = 0, . . . , N , and therefore

Fk(vi)
|
N (ω) = max

< ǫ

Fk(ci)
−
|
N1(ω), N2(ω)
}
{
vi+1
+
vi −
|

F0|

ci+1
ci

(cid:12)
(cid:12)
(cid:12)

F0,m

(cid:12)
(cid:12)
(cid:12)

(k = 0, 1; i = 1, . . . , N ),

implies

F1,n

vi+1
vi −
|

ci+1
ci

F1|

N

(cid:12)
(cid:12)
(cid:12)

< 8ǫ

(cid:12)
(cid:12)
(cid:12)

8ǫ = 8(N + 1)ǫ.

ρN,m,n(ω)
|

ρ
|

−

<

i=0
X

Since ǫ was arbitrary, ρN,m,n

→

ρ almost surely as m, n

.

→ ∞

Note that Theorem 6.21 is exactly Theorem 2.6.
Hereafter, we prove that DN (

N,m,n,

V

V

N ) is measurable on Ω (related to Theorem 6.19).

· · ·

= vm+n, and

Zm+n and γ1 +

DEFINITION 6.22. Let

=
+ γm+n = n,
+ tl = m + n, Rm+n

(Z1, γ1), . . . , (Zm+n, γm+n)
{
}
with Z1 ≤ · · · ≤
. . . , (Yn, 1)
}
(t1, . . . , tl) of positive integers with t1 +
tuples (v1, . . . , vm+n) with v1 =
· · ·
t1 /
S(t1,...,tl) =
0, 1
{
}
. For t
0, 1
}
{
ω
{

· · ·
t-th symmetric product of
Rm+n
, Ωt,s =
t
[Zi, Zi+1) for i = 1, . . . , m + n where Zm+n+1 =
(j1, . . . , jN ) of integers with 0
I(j1,...,jN ) = (Ij1 × · · · ×

∼ × · · · × {
and s
∈ T
Ωt : (γ1, . . . , γm+n) corresponds to s
}

= vt1 < vt1+1 =
· · ·
tl /
0, 1
∼
}
t, let Ωt =

j1 ≤ · · · ≤

≤
RN
≤ .

IjN )

∈ S

. Denote by

· · ·

jN

≤

∈

∩

}

T

(X1, 0), . . . , (Xm, 0), (Y1, 1),
{
be the set of tuples
(t1,...,tl) the set of real m + n-
< vt1+···+tl−1+1 =
denotes the

· · ·
t/
0, 1
{
}
∼
Ω : (Z1, . . . , Zm+n)
∈

= vt1+t2 <
, where
ω
{
. Put I0 = (

∈
, Z1) and Ii =
−∞
the set of N -tuples
, deﬁne

∞
m + n. For (j1 . . . , jN )

J

∈ J

implies that Ω =

are measurable and pairwise disjoint for t

REMARK 6.23. Since Rm+n
t
t∈T Rm+n
In addition, Rm+n
≤ =
t
t. Besides, for any t
union of Ωt,s
∈ S
∈
such that, on the event Ωt, RN
≤ equals the disjoint union of Ij (
and s

A over s
∈ T
S
S
t, consider the event Ωt,s. Then rm,n is constant on Ij for any j

, so are Ωt.
t∈T Ωt, where Ωt equals the disjoint
, there exists a nonempty set
) over j

t,
since it depends only on the rank statistics of X1, . . . , Xm, Y1, . . . , Yn. Furthermore, there
rm,n(v) equals the disjoint
exists a nonempty set
union of Ij (

N,m,n = arg minv∈RN

J
) over j

t such that

⊂ J
t,s.

For t

⊂ J

∈ J

∈ J

∈ S

∈ T

∈ T

=

=

t,s

t.

J

V

∅

t

≤

∅

∈ J

THEOREM 6.24. DN (

V

N,m,n,

V

N ) is measurable on Ω.

A over t
N,m,n,

PROOF. Let t
and s

and s

t. Since Ω equals the disjoint union of Ωt,s

V

∈ T

∈ S

∈ S

, Z1)

N,m,n,

N,m,n,

∈
∈
t by Remark 6.23, it sufﬁces to prove the measurability of DN (
N )
V
N ) to Ωt,s, which gives

T
on each Ωt,s. In the rest of the proof, we restrict DN (
DN (

((
−∞
that DN (

N ) = maxj∈Jt,s DN (Ij,

V
If there exists j = (j1, . . . , jN )
Ij2 × · · · ×
N ) =
∞
V

c
).
{
}
t,s such that j1 = 0 or jN = m + n, then Ij =
∈ J
RN
≤ or Ij = (Ij1 × · · · ×
≤ , so
IjN )
IjN −1 ×
(the measurability is obvious).
t,s with 1
jN
m + n
j1 ≤ · · · ≤
−
RN
≤ . Since Ij
=
∩
Zji, Zji+1}
Ij : vi

Next, let j = (j1, . . . , jN )
∈ J
sure Ij of Ij equals ([Zj1, Zj1+1]
Zj1+1, . . . , ZjN < ZjN +1. Put Vj =
We can see that Ij is the convex hull of the ﬁnite vertex set Vj , so that supv∈Ij

1. Then the clo-
, we have Zj1 <
.
}
d(v, c) =

× · · · ×
(v1, . . . , vN )
{

∅
for i = 1, . . . , N

[ZjN , ZjN +1])

×
N,m,n,

[Zm+n,

RN

∈ {

∞

≤

≤

))

∩

∩

∈

V

V

V

V

6
6
6
18

maxv∈Vj d(v, c) since Ij
dius maxv∈Vj d(v, c) contains Ij . Noting that supv∈Ij d(v, c) = supv∈Ij
) = maxv∈Vj d(v, c). Since d(v, c) for each v
DN (Ij,
}
Ωt,s, DN (Ij,

Vj by deﬁnition and the closed ball with center c and ra-
d(v, c), we obtain
Vj is obviously measurable on

N ) are measurable on Ωt,s.

N,m,n,

c
{

⊃

∈

c
{

) and also DN (
}

V

V

7. Proof for Theorem 3.9. Here we assume the same setting as in Section 3.2. We de-
note by R[x] and R[[x]] the rings of polynomials and formal power series in x over a ring R,
respectively.

DEFINITION 7.1. For γ

∈
δγ (i) = N0(γ0:i)
+

−
δγ (i)
|
Note that δγ (0) = δγ(2k) = 0,

δγ (i)
|
|

dγ(i, j) =

Γk,k (k

∈
N1(γ0:i)

N), deﬁne

δγ(j)
|

+

δγ (j)
|
|

−

(i = 0, . . . , 2k),

(i, j = 0, . . . , 2k).

(14)

and

(15)

δγ(i) = k

F0,γ (i)

F1,γ (i)

(k > 0),

−

(cid:16)

(cid:17)

b
b
dγ(i, j) = dγ(j, i)

by deﬁnition.

LEMMA 7.2. For all γ

Γn,n,

∈
ρ2(γ) = 1

1
2n

−

max
0≤j1,j2≤2n

dγ (j1, j2).

PROOF. Let us put

b

2

sγ(j1, j2) =

max

F0,γ

i=0
X
where j0 = 0, j3 = 2n. Then

b

n

b

sγ(j1, j2) +

rγ(j1, j2)

ji+1
ji
|

,

F1,γ

ji+1
ji
|

b

o

(0

j1 ≤

j2 ≤

≤

2n),

2

b
=

b
max

F0,γ

ji+1
ji
|

,

F1,γ

ji+1
ji
|

n

b
ji+1
ji
|

i=0 (cid:16)
X
2

=

F0,γ

i=0 (cid:16)
X

= 2.

b

On the other hand, by (14),

b
ji+1
ji
|

(cid:17)

+

F1,γ

b

+ min

F0,γ

o

n

b

ji+1
ji
|

,

F1,γ

ji+1
ji
|

b

o(cid:17)

sγ(j1, j2)

−

rγ(j1, j2)

2

b
=

b
max

F0,γ

n

b
ji+1
ji −
|

i=0 (cid:16)
X
2

=

F0,γ

i=0 (cid:12)
X
(cid:12)
(cid:12) b

ji+1
ji
|

,

F1,γ

ji+1
ji
|

b
ji+1
ji
|

(cid:12)
(cid:12)
(cid:12)

F1,γ

b

−

o

min

F0,γ

n

b

ji+1
ji
|

,

F1,γ

ji+1
ji
|

b

o(cid:17)

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

19

δγ (ji+1)
|

δγ (ji)
|

−

2

1
n

i=0
X
dγ (j1, j2)
n

.

rγ (j1, j2) = 1

dγ (j1, j2)
2n

,

−

b

ρ2(γ) = min

0≤j1≤j2≤2n

rγ(j1, j2)

b

= 1

= 1

1
2n
1
2n

−

−

b
max
0≤j1≤j2≤2n

dγ(j1, j2)

max
0≤j1,j2≤2n

dγ (j1, j2)

=

=

Hence we have

so that

by (15).

DEFINITION 7.3. For γ

Γk,k (k

N), deﬁne

∈
δγ = max
0≤i≤2k

∈
δγ (i),

δγ = min
0≤i≤2k

δγ(i).

Note that δγ ≤

0

≤

δγ since δγ (0) = 0.

LEMMA 7.4. For all γ

Γn,n,

∈

max
0≤i,j≤2n

dγ (i, j) = 2

δγ

(cid:0)

δγ

.

−

(cid:1)

PROOF. Denote δγ,i,j = max

δγ,i,j + δγ,i,j = δγ (i) + δγ (j) and δγ,i,j
If δγ (i) > 0 and δγ (j) > 0, then

−

δγ (i), δγ (j)
}
{
δγ,i,j =

and δγ,i,j = min
δγ (j)
|

δγ (i)
|

−

δγ (i), δγ (j)
{
}
.

. Note that

dγ (i, j) = δγ (i) + δγ(j) +

δγ (i)
|

δγ(j)
|

−
δγ,i,j

−

= δγ,i,j + δγ,i,j + δγ,i,j

= 2δγ,i,j

2δγ

≤

≤
If δγ (i) < 0 and δγ (j) < 0, then

2

δγ

δγ

.

−

(cid:0)

(cid:1)

dγ (i, j) =

=

=

−

−

−

≤ −
2

≤

δγ(i)

δγ (j) +

−
δγ,i,j + δγ,i,j

δγ (i)
|
+ δγ,i,j

−

δγ (j)
|
δγ,i,j

−

(cid:1)

2δγ,i,j
(cid:0)

2δγ

δγ

−

δγ

.

(cid:0)

(cid:1)

20

If δγ (i)δγ (j)

0, then

≤

δγ (i)
dγ (i, j) = 2
|
2

δγ

δγ (j)
|

−
δγ

.

≤
δγ

(cid:0)
δγ
−

−
in general. On the other hand, if δγ(i) = δγ

(cid:1)

Taken together, we have dγ(i, j)

and δγ (j) = δγ , then

2

≤

(cid:0)

dγ(i, j) =

δγ

+

(cid:1)
δγ

δγ

−
δγ

+

δγ

(cid:12)
(cid:12)
−

(cid:12)
δγ
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)
= δγ +
(cid:12)
(cid:12)
δγ
= 2

(cid:12)
δγ
(cid:12)
−
δγ
.

(cid:0)
−

(cid:1)

This completes the proof.

(cid:0)

(cid:1)

THEOREM 7.5. For all γ

Γn,n,

∈

ρ2(γ) = 1

δγ

δγ

.

−
n

−

PROOF. This follows immediately from Lemmas 7.2 and 7.4.

b

The following arguments (from Deﬁnition 7.6 to Theorem 7.15) refer to [3, Section I].

DEFINITION 7.6. A combinatorial class is a set
is ﬁnite for all k
α
|
|

is deﬁned so that
∈ A
say a class instead of a combinatorial class.

α
{

= k

}

:

A
∈

N
on which a size function
N. Unless confusion arises, we simply

A →

| · |

:

Any subset
ak
{

sequence

}

B ⊂ A
of
A

is deﬁned by

is also a class with its size function deﬁned as in

. The counting

A

and the ordinary generating function (OGF) A(x)

ak = #

α
{

= k

:

α
|
|

}

∈ A

(k

∈
Z[[x]] of

N),

is by

A

∈

A(x) =

∞

Xk=0

akxk.

B

and

and
=

be two classes. A map φ :

DEFINITION 7.7. Let
if

A
phism between
α
|
|
A
call φ an isomorphism, say that

A → B
A ∼=
their counting sequences,
and A(x) and B(x) their OGFs, respectively. We can easily see that the following three
statements are equivalent:

is called a homomor-
. If, in addition, φ is bijective, then we
.

for all α
are isomorphic, or write

B
φ(α)
|
|
and
B
A

REMARK 7.8. Let

be two classes,

ak
{

bk
{

∈ A

and

and

A

B

B

}

}

A ∼=

1.
.
B
2. ak = bk for all k
3. A(x) = B(x).

N.

∈

DEFINITION 7.9. The neutral class

#

Z

= 1,

ε
|
|

= 0 (ε

∈ E

), and

ζ
|

|

= 1 (ζ

E
∈ Z

and the atomic class
).

Z

are classes with #

=

E

REMARK 7.10. The OGFs of

and

Z

E

are 1 and x in Z[[x]], respectively.

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

21

DEFINITION 7.11. Let
=

I, α

∈
the combinatorial sum (or simply the sum) of

Ai
{
is also a class with its size function deﬁned by
}

be a set of classes, where i runs over some index set I. If
,
α
|
|
i. In
k.

is always a class, and we may write

and write
=

∈ A

{A

}

}

i

i

(i, α) : i
B
{
then we call
particular, if I =

B

(i, α)
=
|
|
=
i∈I A
B
+
A1 +
· · ·
F

A

1, . . . , k
{

}

, then

B

B

DEFINITION 7.12. The Cartesian product (or simply the product)

A

k is the class
=

classes
A1, . . . ,
(α1, . . . , αk) : α1 ∈ A1, . . . , αk
{
is deﬁned by
.
(α1, . . . , αk)
αk
+
α1|
+
|
|
|
|
|
k instead of
N+, we may write
and k
For a class
A
i exists, then we call
=
ε
}
{
= SEQ(

A
. If a class
).

∈
=

· · ·

i∈N

A

B

B

A

F

E
B

k of k
A1 × · · · × A
whose size function

∈ A

k

}

A × · · · × A
a sequence class of

(k times). Let

0 =
A
, and write

A

REMARK 7.13.
then the OGFs of
A1(x)

· · ·

Ak(x), respectively.

If A1(x), . . . , Ak(x) are the OGFs of classes
A1 + . . . +

A1 × · · · × A

A1, . . . ,
k are A1(x) +

k and

A

A
· · ·

k, respectively,
+ Ak(x) and

THEOREM 7.14.

of a class

A

. Then SEQ(

A

(See [3, Section I.2.1] for reference.) Let
) exists if and only if a0 = 0.

be the counting sequence

ai
{

}

THEOREM 7.15.

(See [3, Section I.2.2, Theorem I.1] for the proof.) Let A(x) be the OGF

of a class

A

and assume that SEQ(

A

) exists. Then the OGF of SEQ(

A

) is 1/(1

A(x)).

−

DEFINITION 7.16. Deﬁne a class

G

N, let
For k, l
∈
γ = (γ1, . . . , γ2i)

γ
k,l =
{
Γi,i (i

G
∈

γ
|

|
k
:
∈ G
1), deﬁne

−

by

∞

G

=

i=0
[

= i

Γi,i,

(γ

δγ , δγ

≤

≤

∈
l

Γi,i).

and Gk,l(x) be the OGF of

k,l. For

G

}

≥
λ+(γ) = (0, γ1, . . . , γ2i, 1)
λ−(γ) = (1, γ1, . . . , γ2i, 0)

Γi+1,i+1,

∈

Γi+1,i+1.

∈
Γ1,1 for e

Γ0,0. Note that λ+ and λ− are

∈

Put λ+(e) = (0, 1)
injective on

.

G

Γ1,1 and λ−(e) = (1, 0)

∈

∈

LEMMA 7.17. For any

PROOF. Since

(γ, ζ)
|
|
λ+(

ν+ :
λ+(
homomorphism, hence

|
H × Z →
H
). Similarly, the bijection ν− :
H × Z →
H
H × Z ∼= λ−(
H
If H(x) is the OGF of

).

COROLLARY 7.18.
are both equal to xH(x).

,

H ⊂ G

) ∼= λ−(

H × Z ∼= λ+(
H
λ+(γ)
γ
, the bijection
+ 1 =
=
∈ H × Z
|
|
|
) deﬁned by ν+(γ, ζ) = λ+(γ) is a homomorphism, hence
H × Z ∼=
) deﬁned by ν−(γ, ζ) = λ−(γ) is a
λ−(

for all (γ, ζ)

γ
|

ζ
|

H

+

=

).

|

|

H

, then the OGFs of λ+(

H

) and λ−(

H

)

H ⊂ G

PROOF. By Remark 7.8 and Lemma 7.17, the OGFs of λ+(
, which equals xH(x) by Remarks 7.10 and 7.13.

that of

) and λ−(

H

) are equal to

H

H × Z

22

LEMMA 7.19. For all k, l
k+1,l+1 ∼= SEQ(λ−(
G
PROOF. Deﬁne a map σ :

∈
k,0) + λ+(

G

k+1,0 ∼= SEQ(λ−(
N,
G
G
G0,l)).
k+1,0 →
G

SEQ(λ−(
G

(λ−(
G

k,0))0, and by

k,0)),

G0,l+1 ∼= SEQ(λ+(

G0,l)), and

k,0)) by σ(e) = (0, ε) where ε

=

∈ E

σ(γ) =

j0, . . . , jp
{

p, (γj0:j1, . . . , γjp−1:jp)
(cid:17)
(cid:16)
where
: δγ (j) = 0
0, . . . , 2i
}
}
}
∈ {
for all γ
γ
σ(γ)
from deﬁnition that σ is bijective and
=
|
|
|
|
k,0)). We can similarly show that
phism, i.e.,
G0,l)).
and

j
{
k+1,0 ∼= SEQ(λ−(
G
k,0) + λ+(

and 0 = j0 <

∈ G

(γ

=

∈

G

G

k+1,l+1 ∼= SEQ(λ−(
G
LEMMA 7.20. For all k, l

Γi,i; i

1)

≥

< jp = 2i. It follows
· · ·
k+1,0, so that σ is an isomor-
G0,l+1 ∼= SEQ(λ+(
G0,l))

N+,
Qk+1(x)Ql+1(x)

∈

x2Qk−1(x)Ql−1(x) = Qk+l+1(x).

PROOF. Since Q2(x) = Q1(x)

Qk+1(x)Q2(x) = Qk+1(x)

x by Deﬁnition 3.8, we have

−
xQk+1(x)

−
xQ0(x) = 1

−

= Qk+1(x)

−

−

x(Qk(x)
xQk−1(x))
−
xQk(x) + x2Qk−1(x)

= Qk+1(x)
−
= Qk+2(x) + x2Qk−1(x)
= Qk+2(x) + x2Qk−1(x)Q0(x),

(16)

(17)

hence (16) holds for l = 1. We also have

Qk+1(x)Q3(x) = Qk+1(x)(Q2(x)

xQ1(x))

−

−

xQk+1(x)

= Qk+1(x)Q2(x)
= Qk+2(x) + x2Qk−1(x)
= Qk+3(x) + x2Qk−1(x)
= Qk+3(x) + x2Qk−1(x)Q1(x)

−

xQk+1(x)

by (17), hence (16) holds for l = 2.

By Deﬁnition 3.8, we have Qj+1(x) = RQj(x) for all j

N, where

Qi(x) =

Qi(x)
Qi+1(x)
(cid:18)
N+ and l = i + 1, or equivalently

, R =

(cid:18)

(cid:19)

∈
0 1
x 1

−

.
(cid:19)

Qk+1(x)Qi+1(x)

x2Qk−1(x)Qi−1(x) = Qk+i+1(x)

−

If (16) holds for l = i

∈

holds, then

Qk+1(x)Qi+2(x)

−

= Qk+1(x)RQi+1(x)

x2Qk−1(x)Qi(x)

−
= R(Qk+1(x)Qi+1(x)
= RQk+i+1(x)
= Qk+i+2(x),
hence (16) holds for l = i + 2. The claim follows by induction.

−

x2Qk−1(x)RQi−1(x)
x2Qk−1(x)Qi−1(x))

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

23

LEMMA 7.21. For all k

N,

∈

Qi(x)Qk−i−1(x) =

X0≤i<k

PROOF. Deﬁne Q(x, t)

(Z[x])[[t]] as

∈

∞

Q′

k+1(x).

−

Since

we have

(1

−

Q(x, t) =

Qk(x)tk.

Xk=0

Q(x, t) = Q0(x) + Q1(x)t +

Qk(x)tk,

∞

tQ(x, t) = Q0(x)t +

∞

Xk=2
Qk−1(x)tk,

xt2Q(x, t) = x

Xk=2
Qk−2(x)tk,

∞

Xk=2

t + xt2)Q(x, t) = Q0(x) + Q1(x)t

Q0(x)t

−

Qk−1(x) + xQk−2(x))tk

−

∞

+

(Qk(x)

Xk=2

= 1

by Deﬁnition 3.8, hence

(18)

Therefore

Q(x, t) =

1
t + xt2 .

1

−

Q′

k(x)tk =

∂
∂x

Q(x, t) =

∞

Xk=0

t2
t + xt2)2

−

(1

−

∞

t2(Q(x, t))2 =

=

−

−

Xk=0 

X0≤i<k

Qi(x)Qk−i−1(x)

!

tk+1,

which implies the claim.

PROPOSITION 7.22. For all k

N,

∈

(19)

Gk,0(x) = G0,k(x) =

Qk(x)
Qk+1(x)

.

PROOF. Since G0,0(x) = 1 = Q0(x)/Q1(x), (19) holds for k = 0.
Suppose (19) holds for some k

N. Since

k+1,0 ∼= SEQ(λ−(
G
G

∈

have

k,0)) by Lemma 7.19, we

Gk+1,0(x) =

1

xGk,0(x)

1

−

=

Qk+1(x)

Qk+1(x)

xQk(x)

−

=

Qk+1(x)
Qk+2(x)

24

by Deﬁnition 3.8, Theorem 7.15, and Corollary 7.18. Similarly, since
by Lemma 7.19, we obtain

G0,k+1 ∼= SEQ(λ+(

G0,k))

G0,k+1(x) =

Qk+1(x)
Qk+2(x)

.

Therefore, (19) holds for k + 1 in place of k, and the proof is complete.

PROPOSITION 7.23. For all k, l

N,

∈

(20)

Gk,l(x) =

Qk(x)Ql(x)
Qk+l+1(x)

.

PROOF. If k = 0 or l = 0, then (20) holds by Proposition 7.22.
k−1,0) + λ+(
Suppose k

1. Since

1 and l

k,l ∼= SEQ(λ−(
G

G

≥

≥

we have

G0,l−1)) by Lemma 7.19,

Gk,l(x) =

1

−

1
xGk−1,0(x)

xG0,l−1(x)

−

by Remark 7.13, Theorem 7.15, and Corollary 7.18, where

Gk−1,0(x) =

Qk−1(x)
Qk(x)

,

G0,l−1(x) =

Ql−1(x)
Ql(x)

by Proposition 7.22. Hence

Gk,l(x) =

Qk(x)Ql(x)

−

Qk(x)Ql(x)
xQk−1(x)Ql(x)

xQk(x)Ql−1(x)

−
Qk(x)Ql(x)

=

=

=

(Qk(x)

−

xQk−1(x))(Ql(x)
Qk(x)Ql(x)

−

xQl−1(x))

−

x2Qk−1(x)Ql−1(x)

x2Qk−1(x)Ql−1(x)

Qk+1(x)Ql+1(x)
Qk(x)Ql(x)
Qk+l+1(x)

−

by Deﬁnition 3.8 and Lemma 7.20.

PROPOSITION 7.24. For k

∈

N, the OGF of

: δγ

δγ ≤

k

}

−

is

G

γ
k =
∈ G
{
Q′
k+2(x)
Qk+1(x)

.

Q′
k+1(x)
e
Qk(x) −

Gk(x) =

Since

PROOF. For i, j
G0,j,
G0,j =
e

N, let

∈
i,j ∼=
G

e
i,j =
G
i−1,j +
e

G

k

Gk(x) =

e
Gi,k−i(x)

:

γ
{
∈ G
i,j if i
G

≥

i = δγ, δγ
k =

−
1, and

G

j

}
≤
k
i=0

G

i,j.
Gi,j be the OGF of
and
i,k−i by deﬁnition, we have

G

e

e

F

e

e

e

i=0
X

e
= G0,k(x) +

(Gi,k−i(x)

Gi−1,k−i(x))

−

X1≤i<k+1
Gi,k−i(x)

−

=

X0≤i<k+1

Gi,k−i−1(x)

X0≤i<k

TWO-SAMPLE TESTING BASED ON THE OVERLAP COEFFICIENT

25

=

=

Qi(x)Qk−i(x)

Qk+1(x) −

X0≤i<k+1
Q′
k+1(x)
Qk(x) −

Q′
k+2(x)
Qk+1(x)

Qi(x)Qk−i−1(x)
Qk(x)

X0≤i<k

by Remark 7.13, Lemma 7.21, and Proposition 7.23.

THEOREM 7.25. For k = 0, . . . , n, we have

#

γ

(cid:26)

∈

Γn,n :

ρ2(γ)

1

−

≥

PROOF. We have

b

#

γ

(cid:26)

∈

Γn,n :

ρ2(γ)

1

−

≥

b

k
n

(cid:27)

k
n

(cid:27)

= [xn]

(cid:18)

Q′
k+1(x)
Qk(x) −

Q′
k+2(x)
Qk+1(x)

.
(cid:19)

= #

γ
{

∈

Γn,n : δγ

δγ ≤

k

}

−

= n

}

= #

γ
{
= [xn]

= [xn]

k :

γ
|

|

G
∈
Gk(x)
e
Q′
k+1(x)
Qk(x) −

e
(cid:18)

Q′
k+2(x)
Qk+1(x)

(cid:19)

by Theorem 7.5 and Proposition 7.24.

Note that Theorem 7.25 is exactly Theorem 3.9.

Acknowledgements. This study was partially supported by JSPS KAKENHI Grant

Numbers JP21K15762, JP15K04814, and JP20K03509.

REFERENCES

[1] ANDERSON, T. W. (1962). On the distribution of the two-sample Cramér-von Mises criterion. Ann. Math.

Statist. 33 1148–1159. MR145607

[2] BERGER, V. W. and ZHOU, Y. (2014). Kolmogorov–Smirnov Test: Overview In Wiley StatsRef: Statistics

Reference Online. John Wiley & Sons, Ltd.

[3] FLAJOLET, P. and SEDGEWICK, R. (2009). Analytic Combinatorics. Cambridge University Press, Cam-

bridge. MR2483235

[4] HAND, D. J. (2012). Assessing the performance of classiﬁcation methods. Int. Stat. Rev. 80 400–414.

MR3006153

[5] HSU, P. L. and ROBBINS, H. (1947). Complete convergence and the law of large numbers. Proc. Nat. Acad.

Sci. U.S.A. 33 25–31. MR19852

[6] JOHNO, H. and NAKAMOTO, K. (2021). Decision tree-based estimation of the overlap of two probability

distributions. https://arxiv.org/abs/2103.02922.

[7] MANN, H. B. and WHITNEY, D. R. (1947). On a test of whether one of two random variables is stochasti-

cally larger than the other. Ann. Math. Statistics 18 50–60. MR22058

[8] SCHRÖER, G. and TRENKLER, D. (1995). Exact and randomization distributions of Kolmogorov-Smirnov

tests: two or three samples. Comput. Statist. Data Anal. 20 185–202. MR1353786

[9] SERFLING, R. J. (1980). Approximation Theorems of Mathematical Statistics. Wiley Series in Probability

and Mathematical Statistics. John Wiley & Sons, Inc., New York. MR595165

[10] SLOANE, N. J. A. and THE OEIS FOUNDATION INC. (2022). Entry A115139 in the On-Line Encyclopedia

of Integer Sequences. https://oeis.org/A115139.

[11] SNEDECOR, G. W. and COCHRAN, W. G. (1989). Statistical Methods, Eighth ed. Iowa State University

Press, Ames, IA. MR1017246

[12] WELCH, B. L. (1947). The generalization of ‘Student’s’ problem when several different population vari-

ances are involved. Biometrika 34 28–35. MR19277

