The on-ground data reduction and calibration pipeline for
SO/PHI-HRT

J. Sinjan1, D. Calchetti1, J. Hirzberger1, D. Orozco Su´arez2, K. Albert1, N. Albelo Jorge1,
T. Appourchaux3, A. Alvarez-Herrero4, J. Blanco Rodr´ıguez5, A. Gandorfer1, D. Germerott1,
L. Guerrero1, P. Gutierrez Marquez1, F. Kahil1, M. Kolleck1, S.K. Solanki1,10, J.C. del Toro
Iniesta2, R. Volkmer6, J. Woch1, B. Fiethe7, J.M. G´omez Cama8, I. P´erez-Grande9, E. Sanchis
Kilders5, M. Balaguer Jim´enez2, L.R. Bellot Rubio2, M. Carmona8, W. Deutsch1,
G. Fernandez-Rico1,9, A. Fern´andez-Medina4, P. Garc´ıa Parejo4, J.L. Gasent Blesa5,
L. Gizon1,11, B. Grauf1, K. Heerlein1, A. Lagg1, T. Lange7, A. L´opez Jim´enez2, T. Maue6,
R. Meller1, H. Michalik7, A. Moreno Vacas2, R. M¨uller1, E. Nakai6, W. Schmidt6, J. Schou1,
J. Sch¨uhle1, J. Staub1, H. Strecker2, I. Torralbo9, and G. Valori1

1Max-Planck-Institut f¨ur Sonnensystemforschung, Justus-von-Liebig-Weg 3, 37077 G¨ottingen,
Germany
2Instituto de Astrof´ısica de Andaluc´ıa (IAA-CSIC), Apartado deCorreos 3004, E-18080
Granada, Spain
3Univ. Paris-Sud, Institut d’Astrophysique Spatiale, UMR 8617,CNRS, Bˆatiment 121, 91405
Orsay Cedex, France
4Instituto Nacional de T´ecnica Aeroespacial, Carretera de Ajalvir, km 4, E-28850 Torrej´on de
Ardoz, Spain
5Universitat de Val`encia, Catedr´atico Jos´e Beltr´an 2, E-46980 Paterna-Valencia, Spain
6Leibniz-Institut f¨ur Sonnenphysik, Sch¨oneckstr. 6, D-79104 Freiburg, Germany
7Institut f¨ur Datentechnik und Kommunikationsnetze der TU Braunschweig,
Hans-Sommer-Str. 66, 38106 Braunschweig, Germany
8University of Barcelona, Department of Electronics, Carrer de Mart´ıi Franqu`es, 1 - 11, 08028
Barcelona, Spain
9Instituto Universitario ”Ignacio da Riva”, Universidad Polit´ecnicade Madrid, IDR/UPM,
Plaza Cardenal Cisneros 3, E-28040 Madrid, Spain
10School of Space Research, Kyung Hee University, Yongin, Gyeonggi-Do, 446-701, Korea
11Institut f¨ur Astrophysik, Georg-August-Universit¨at G¨ottingen, Friedrich-Hund-Platz 1,
37077 G¨ottingen, Germany

ABSTRACT

The ESA/NASA Solar Orbiter space mission has been successfully launched in February 2020. Onboard is the
Polarimetric and Helioseismic Imager (SO/PHI), which has two telescopes, a High Resolution Telescope (HRT)
and the Full Disc Telescope (FDT). The instrument is designed to infer the photospheric magnetic ﬁeld and
line-of-sight velocity through diﬀerential imaging of the polarised light emitted by the Sun. It calculates the
full Stokes vector at 6 wavelength positions at the Fe I 617.3 nm absorption line. Due to telemetry constraints,
the instrument nominally processes these Stokes proﬁles onboard, however when telemetry is available, the raw
images are downlinked and reduced on ground. Here the architecture of the on-ground pipeline for HRT is
presented, which also oﬀers additional corrections not currently available on board the instrument. The pipeline
can reduce raw images to the full Stokes vector with a polarimetric sensitivity of 10−3 · Ic or better.

Further author information: (Send correspondence to J.Sinjan)
J.Sinjan: E-mail: sinjan@mps.mpg.de

2
2
0
2

g
u
A
1
3

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
4
0
9
4
1
.
8
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
Keywords: Solar Orbiter, space observatory, solar physics, spectropolarimetry, data pipelines, data processing,
image processing

1. INTRODUCTION

The Solar Orbiter (SO) is the ﬁrst selected medium-class mission from ESA’s Cosmic Vision 2015-2025 Program.
It is a collaborative eﬀort with NASA, and the spacecraft was launched on February 10th 2020.1 Its primary
goal is to study the Sun and the inner heliosphere. To achieve this, the spacecraft carries a scientiﬁc payload
of 10 instruments, 6 remote sensing and 4 in-situ. The Polarimetric and Helioseismic Imager (PHI) is one of
the remote sensing instruments and it retrieves the continuum intensity, the vector magnetic ﬁeld, and the
line-of-sight velocity, both in the Sun’s photosphere.2 It does this by sampling four linear combinations of the
four Stokes parameters of the magnetically sensitive Fe I absorption line at 617.3 nm at 6 wavelength positions.
These samples are later transformed to the aforementioned physical quantities by inverting the radiative transfer
equation for polarized light in the presence of a magnetic ﬁeld.

The instrument has two telescopes: the Full Disc Telescope (FDT) and the High Resolution Telescope (HRT).3
The FDT can capture the full solar disc, while the HRT is designed to capture photospheric features in more
spatial detail. During normal operations to conserve telemetry, the raw images from the two telescopes are
reduced onboard using ﬁeld-programmable gate array (FPGA) computers, producing the data products which
are downlinked to Earth.4, 5

However there are occasions during the nominal and extended mission phases when telemetry rates will
be favourable such that raw images can be downloaded and reduced on-ground. The ability to reduce data on-
ground provides more opportunities for ﬁne-tuning the data reduction process, and therefore for producing higher
quality data products. Furthermore it allows for the additional processing when the HRT’s stabilisation system
is switched oﬀ. Since launch the spacecraft has been in its cruise phase until 27th November 2021, when the
nominal mission phase began.6 During the cruise phase, predominantly raw images from HRT were downloaded
and reduced on-ground, to allow for in-ﬂight testing and investigate the instrument’s performance. This paper
outlines the current state of the on-ground pipeline for the HRT (V1.4 June 2022), written in Python3, which is
used to reduce and calibrate these raw images. Finally early in-ﬂight data reduced with this pipeline is presented
and the telescope’s high polarimetric sensitivity is shown.

2.1 The Instrument

2. SO/PHI-HRT

A simpliﬁed description of the key optical components of the HRT is presented, following the optical path
shown in Fig. 1.2, 3 The HRT is a Ritchey-Chr´etien telescope with a decentred pupil. The HRT has a Heat
Rejection Entrance Window (HREW) that allows in only 4% of the incoming solar light power. The HRT uses
its own Polarisation Modulation Package (PMP), consisting of Liquid Crystal Variable Retarders (LCVR) and
a polariser to modulate the light in order to obtain the polarisation characteristics of the incoming light.7 Once
modulated, the light is split and a portion enters the Correlation Tracker Camera (CTC). The CTC is part of
the Image Stabilisation System (ISS) which works to track a speciﬁc feature on the solar surface, calculating
from the CTC images the steering signal for the M2 (tip-tilt) mirror, to accurately track the desired feature.8, 9
The ISS is also used to compensate for eﬀects such as spacecraft jitter. After the beam splitter the light goes
through the HRT Refocus Mechanism (HRM) and passes through the Feed Select Mechanism (FSM), which is
used to switch between FDT and HRT, and towards the Filtergraph (FG). The FG contains two pre-ﬁlters and
a tunable LiNbO3 Fabry-Perot etalon, an interferometer, which together allow for a transmission window with a
mean full-width-half-maximum (FWHM) of (106 ± 5) m˚A and free spectral range of 3.0 ˚A.3, 10 The resultant light
then illuminates an Active Pixel Sensor (APS) which reads out images with 2048 × 2048 pixels. The re-imaging
optics in the Focal Plane Assembly (FPA) provides a plate scale on the sensor of 0.5(cid:48)(cid:48) per pixel which corresponds
to 102 km at 0.28 AU distance.

Figure 1. Schematic of the optics unit of SO/PHI-HRT. SO/PHI-FDT is located in the same optics unit but is not shown
for clarity.

The imaging cadence is controlled by the modulation accumulation scheme in the PMP. While the HRT has
the operational capability of a 60 second cadence, during the cruise phase a 96 second cadence was used. This
was done using a PMP scheme of [4, 5]. At each wavelength position, 4 frames are taken for each modulation
state, and this is cycled through each modulation state 5 times, resulting in 20 total frames for each modulation
state at each wavelength position. The minimum number of frames to achieve the desired signal to noise ratio
of 10−3 is 16.2

2.2 Flat-Field Acquisition

A critical reduction process of the science data requires a ﬂat-ﬁeld. The ﬂat-ﬁeld contains the diﬀerence in gain
of a given pixel with respect to the others, as well as information of other imperfections such as dust grains in
the ﬁeld of view (FOV). The HRT ﬂat-ﬁelds are not acquired using oﬀ-pointing of the spacecraft.11 Instead,
the solar surface evolution, is used to introduce diﬀerences between subsequent images, such that localised
solar features are averaged out with enough acquisitions. Over a period of approximately 8 hours, 1500 images
are accumulated at each polarisation state and wavelength. These ﬂat-ﬁelds are acquired during every major
campaign, to ensure the science data can be properly calibrated. However polarimetric structures remain in
the ﬂat-ﬁeld that are smeared horizontally due to the solar rotation. This horizontal smearing leaves unwanted
artefacts when applying the ﬂat-ﬁeld correction to the scientiﬁc data. Therefore an additional ﬂat-ﬁeld processing
procedure was implemented as part of the pipeline: unsharp masking, which is described in Sec. 3.2.

3.1 Pipeline Overview

3. SO/PHI-HRT ON GROUND PIPELINE

The on-ground pipeline is developed in Python3 and reduces the raw data received from the SO/PHI-HRT
instrument. The raw ﬁles downloaded from the instrument are classed Level 0 (L0) data. They become Level
1 (L1) data once necessary metadata are added, the data are scaled to the correct units (to account for the
compression scheme used) and reﬂected in the Y axis to match the solar orientation convention. This on-ground
pipeline converts the L1 data, into L2 data. This process is described in Fig. 2.

Figure 2. Flowchart of the on-ground pipeline, reducing Level 1 data to the Level 2 physical quantities. The dark ﬁeld
correction and ﬁeld stop application has been omitted for brevity. ‘Polcal’ refers to the on-ground polarisation calibration
campaign prior to launch.

L1Science DataL1 Flat FieldsL2Physical QuantitiesPolcal DataDemodulation MatrixFlat Field CorrectionDemodulateNormalisation and I  Q,U,V ➔Cross TalkRTE InversionUnsharp Masked FlatsLimb Detection L2Stokes FiltergramsPrefilterPrefilter CorrectionPrefilter CorrectionISS on?NoYesModulation AlignmentISS on?YesNoV  Q,U➔ Cross TalkWavelength AlignmentThe inputs to the pipeline are the science data, raw ﬂat-ﬁelds, and demodulation matrices (for each operating
PMP temperature) from the polarisation calibration campaign performed prior to launch. The science data and
ﬂat-ﬁelds are ﬁrst dark-corrected to remove the dark current (not shown in Fig. 2 for brevity). A key capability
of the pipeline is the option to unsharp mask the ﬂat-ﬁelds (see Sec. 3.2), however the width of the Gaussian
distribution to be used must be known beforehand. The pipeline has the functionality to reduce multiple datasets
at once, with the same ﬂat-ﬁeld, provided the image dimensions, PMP temperature and continuum position of
all datasets agree. The pipeline is built to work with any cropped dataset provided the input is square. The
pipeline can also reduce images when the ISS is locked to track the solar limb, using an automatic limb detection
algorithm to account for limb darkening eﬀects when normalising the Stokes parameter and applying the cross-
talk correction. Furthermore additional steps are implemented to account for the case when the ISS is not
operating. The output quantities are indicated with the dotted outlines in Fig. 2.

3.2 Unsharp Masking

Due to the method of ﬂat-ﬁeld acquisition as described in Sec. 2.2, horizontal polarisation elements exist in
the ﬂat-ﬁelds, which would contaminate the data. To remove this contamination unsharp masking is performed
on the ﬂat-ﬁelds. This is achieved by convolving the demodulated ﬂat-ﬁelds with a 2D Gaussian distribution.
The width of the Gaussian distribution was optimised such that the horizontal stripes were removed, but that
any larger scale information was retained. The width of the Gaussian is a function of Solar distance and PMP
temperature. For example, at a distance of 0.526 AU, a width of 59 pixels was used, while at 0.801 AU, 49 pixels
was the appropriate width to be used. An example of the unsharp masking process is shown in Fig. 3.

Figure 3. A Stokes V image in the line wing on 23 February 2021 17:00 UTC, taken at a Sun-spacecraft distance of 0.526
AU: a) result when using a ﬂat-ﬁeld without unsharp masking, b) result when unsharp masking is applied. The region
outside the ﬁeld stop is set to black for clarity.

3.3 Flat-Field Correction

From in-ﬂight testing it was determined that a polarisation state dependent, and wavelength dependent ﬂat-ﬁeld
must be applied to the science data. This is done in order to remove a polarimetric ghost that was detected,
likely to originate from a reﬂection between the inner panel of the HREW and the highly reﬂective etalon. With
an optical path of this nature, with many parallel optical surfaces, several measures were taken to suppress
ghosts; however it was not possible to eliminate all of them. In particular those produced by the HREW, which
is not mounted on the instrument but instead is a component of the heat shield of the spacecraft is prone to

have large margins in the mechanical alignment. Nevertheless, with the proper treatment of the ﬂat-ﬁelds, we
are capable of removing the contribution from the detected ghost to below the noise requirement level. Finally,
to correct for the cavities within the etalon, the ﬂat-ﬁeld must be normalised over the wavelength range, so that
the spectral line proﬁle is removed. This also has the eﬀect of removing the solar rotation to at least ﬁrst order.
Thus the ﬂat-ﬁelded data, If f , is calculated as follows:

If f (x, y, s, λ) =

Idf (x, y, s, λ)
If lat(x, y, s, λ)

,

(1)

where Idf is the dark-corrected data, x and y are the spatial dimensions in the FOV, s is the polarization state
and λ denotes the wavelength.

3.4 Demodulation

The raw images must be demodulated to remove the modulation applied by the PMP in the image acquisition
process. This is obtained with the demodulation matrix: d11−44, for a given pixel:






d11
...
d41

. . .
. . .






d14

d44







If f 1(x, y, s, λ)
If f 2(x, y, s, λ)
If f 3(x, y, s, λ)
If f 4(x, y, s, λ)







=













S1
S2
S3
S4

,

(2)

where I1...4f f are the ﬂat-ﬁelded intensities and S1...4 are the Stokes parameters: I, Q, U, V . The demodulation
matrices acquired during the on-ground testing before launch, resulted in large gradients across the ﬁeld of view
in the Stokes parameters, an example of which are portrayed in Fig. 4. Averaging the central 1024 × 1024 region
of the demodulation matrix results in a demodulation matrix that removes the large scale FOV variations that
were introduced using the matrix measured during the on-ground polarisation campaign.

Figure 4. A Stokes V image in the ling wing on 23rd February 2021 17:00 UTC, with a distance of 0.526 AU and PMP
temperature of 50 ◦C: a) result when using the original demodulation matrix; b) result after using an averaged matrix.

3.5 Limb Detection and Normalisation

For datasets where the limb is in the FOV, such as when the spacecraft is oﬀ-pointing to the poles, certain
additional steps are needed. From the World Coordinate System (WCS) information in the ﬁts header, the

pointing (North, South, East, West) is determined, such that a limb ﬁtting algorithm can accurately detect the
limb. First a mask is created, ensuring that all pixels outside the solar disc are set to 0 in the ﬁnal data products.
To prevent limb darkening from aﬀecting the normalisation, the edge and radius of the limb are calculated. For
limb images, the average of Stokes I at the continuum wavelength position is used as the Stokes normalisation
factor, making sure to only include pixels which are less than 80% of the solar radius in distance from disc centre.
Under disc centre pointing, the average from the central 1024 × 1024 region is found and used as Ic.

3.6 Cross-Talk Correction

Cross-talk between the Stokes parameters arises from three main sources: spacecraft jitter, imperfect instrument
calibration, and modulation from the LCVRs. The strongest cross-talk, is that from Stokes I to the other Stokes
parameters, as the absolute value of Stokes I is much greater than that of Q, U, V .12 Due to cross-talk from
sources described earlier, an ad-hoc correction is applied to the data.13, 14 A linear ﬁt of Q, U, V against I
is performed separately, on the continuum wavelength image, to ﬁnd the gradient and oﬀset parameters of the
cross-talk from I to Q, U, V . When applying the cross-talk correction at each of the 6 diﬀerent wavelength
positions, the parameters are weighted by the respective averaged Stokes I value, relative to the continuum value.
The cross-talk parameters from in-ﬂight data are of the order of 1% or lower, indicating that the ISS ensures
there are no major contributions from the spacecraft jitter, the instrument calibration is accurate and that the
demodulation matrices used are eﬀective. After this step, provided the ISS is operational, the pipeline produces
the L2 ‘Stokes’ ﬁltergrams.

3.7 Special Case: ISS Oﬀ

The ISS of the instrument, as explained in Sec. 2.1, tracks features on the Sun and compensates for the spacecraft
jitter. The latter is important for two reasons: it removes the cross-talks induced by the jitter and keep the 24
raw frames aligned between each other during the acquisition. In some occasions the ISS has to be turned oﬀ
and three procedures have been implemented to compensate for the absence of this subsystem.

3.7.1 Modulation Alignment

The ﬁrst procedure is the modulation alignment just before the demodulation of the data (see Fig. 2). For
each wavelength we consider the ﬁrst polarimetric modulation as a reference; the remaining three polarimetric
modulations are then aligned to the chosen reference. This is performed by computing the gradient of the images,
selecting a sub-region of 512 × 512 pixels, and evaluating the cross correlation between them with sub-pixel
accuracy.15 This registration has to be performed before the demodulation in order to avoid the combination
of pixels from diﬀerent regions on the Sun. Figure 5 shows the eﬀect of the spacecraft jitter on the data and
the removal of the noise pattern with the modulation alignment step. The Stokes V noise level decreases from
2.4 × 10−3 to 1.4 × 10−3.

3.7.2 V to Q,U Cross-Talk Correction

The spacecraft jitter is responsible for increasing the cross-talk both from I to Q, U, V and from V to Q, U .
Similar to the correction of cross-talk from Stokes I (Sec. 3.6), this procedure performs a linear ﬁt of Stokes
Q and U against Stokes V immediately after the cross-talk correction from Sec. 3.6 is applied. The diﬀerence
between the two methods is that here we consider points from all the wavelengths while computing the linear
ﬁt, so the parameters are not weighted by the continuum value. Despite the cross-talk parameters from I to
Q, U, V being of the order of 1%, the parameters from V to Q, U can be up to 7%.

Figure 5. A Stokes V image in the line wing on 7 March 2022 00:00 UTC, at a Sun-spacecraft distance of 0.501 AU and
PMP temperature of 50◦C: a) result when using the standard pipeline procedure, b) result when using the modulation
alignment step.

3.7.3 Wavelength Alignment

The last step before producing the L2 ‘Stokes’ ﬁltergrams is the alignment of the frames at diﬀerent wavelengths.
Similar to that described in Sec. 3.7.1, we use the continuum Stokes I image as a reference, and after computing
the gradient, we align the other frames to this reference. The only exception is for the line core wavelength image,
for which a line wing image is used as a reference. This alignment has to be performed before the Radiative
Transfer Equation is inverted to create cohesive Stokes proﬁles, where the diﬀerent wavelength samples in a
particular Stokes proﬁle, come from the same spatial location on the Sun.

3.8 Radiative Transfer Equation Inversion

To infer the physical quantities from the Stokes maps, a Radiative Transfer Equation (RTE) inversion is per-
formed. Similar to the inversion code used by the HMI vector magnetic ﬁeld pipeline,16, 17 a code assuming a
Milne-Eddington (ME) atmosphere is used.12, 18 A ME model assumes that the physical properties of the atmo-
sphere remain constant with geometrical height, while the source function scales linearly with optical depth.

This pipeline uses the CMILOS code written in C, which utilises analytical response functions.19 This code
is the same as that used by the FPGA devices onboard20 and it works by minimizing the diﬀerence between the
observed and synthetic proﬁles it produces, iterating the atmosphere’s parameters until convergence of the two
proﬁles is achieved. The CMILOS code has three operating modes:

• RTE with default starting conditions

• RTE with Classical Estimates as starting conditions

• Classical Estimates only

With Classical Estimates (CE) enabled, either in CE only mode, or together with RTE, it estimates the line-
of-sight magnetic ﬁeld and velocity using the centre of gravity method.21, 22 The transverse component of the
magnetic ﬁeld is estimated using the weak-ﬁeld approximation.18 The CMILOS inversion code produces the
following L2 data products: full magnetic vector, Dopplergram and continuum intensity. The azimuth is deﬁned
as the counter-clockwise rotation from the positive direction of the detector y-axis. However, the intrinsic 180◦
ambiguity of the Zeeman eﬀect is not removed at this stage.

4.1 February 2021

4. EARLY IN-FLIGHT DATA

We ﬁrst introduce reduced data from 23 February 2021 17:00 UTC, during the short term planning period (STP)
136. This data captured the quiet Sun at disk centre, allowing us to characterise the noise level well, given the
lack of strong magnetic ﬁeld signals. The distance of the spacecraft to the Sun was 0.526 AU, and the PMP
temperature was set to 50 ◦C. At this distance, the (two-pixel) spatial resolution is 382 km.

Figure 6. Stokes ﬁltergram in the red line wing on 23 February 2021 17:00 UTC: a) Stokes I/Ic, b) Stokes Q/Ic, c)
Stokes U/Ic, d) Stokes V /Ic.

The Stokes ﬁltergrams in Fig. 6 display high uniformity and low linear polarimetric signal as expected for a
quiet Sun. This demonstrates the high eﬀectiveness of the ﬂat-ﬁeld correction and additional cross-talk removal.
The photospheric magnetic ﬁeld network appears clearly in the Stokes V /Ic image. In Stokes U/Ic the remnants
of a polarimetric ghost edge is present in the lower right corner. This ghost is most likely due to a reﬂection oﬀ
the HREW (see Sec. 3.3). The ﬂat-ﬁeld correction removes the ghost to a large extent but the edge remains.
From analysis of histograms of the four quadrants, the diﬀerence of the lower right corner distribution from the
others is below the 10−3 · Ic noise level. Figure 7 displays the derived quantities from these Stokes ﬁltergrams.

Figure 7. Derived physical quantities from data of 23 February 2021 17:00 UTC: a) continuum intensity, b) magnetic ﬁeld
strength, c) inclination relative to line-of-sight, d) azimuth relative to direction of rotation, e) Dopplergram, f) line-of-sight
magnetogram. The region outside the ﬁeld stop is set to black for clarity.

As expected by the uniformity of the ﬁltergrams, the physical quantities in Fig. 7 display equal uniformity
and low magnetic ﬁeld strengths due to the quiet Sun being void of active regions. The edge of a polarimetric
ghost is visible in the lower right corner of the azimuth due to the absence of signal. The continuum intensity
map exhibits the granular structure of the photosphere. The inclination is centred on 90 degrees, and due to the
very low linear polarisation signal, the azimuth contains mainly noise.

The Gaussian ﬁt to the Stokes V histogram in Fig. 8 a) indicates that a polarimetric accuracy of < 10−3 · Ic
is achieved, illustrating the high performance of the HRT instrument.
It is also important to note that due
to the tight telemetry budget, raw images from SO/PHI are compressed before download. The compression
procedure, in this case to 6 bits/pixel (down from 32), increases the noise of the ﬁltergrams: for example, data
from the commissioning phase, which was downloaded without compression, had a Stokes noise level of 8.5×10−4.
Furthermore, using the same method as Liu et al. (2012),23 the line-of-sight magnetogram has an estimated
noise level of 6.6 G, very similar to the noise level of the 720 second magnetogram images from HMI, but with
almost eight times the cadence: 96 seconds.

Figure 8. Histograms from data on 23 February 2021 1700 UTC: a) Stokes V /Ic at the continuum wavelength position,
with a Gaussian ﬁt (dashed red curve), b) the line-of-sight magnetogram, with a Gaussian ﬁt.

4.2 November 2021

We present a reduced dataset of a sunspot captured by HRT, taken during the inferior conjunction in November
2021. The spacecraft was ﬂying close to Earth, with a distance to the Sun of 0.858 AU, a PMP temperature
set to 40 ◦C and was pointing to disc centre. At this distance the (two-pixel) spatial resolution is 624 km, and
almost half the solar disk is within the FOV. As shown in Fig. 9 there are clear signals in Stokes Q/Ic and
U/Ic that capture the linear polarisation from the sunspot, which highlights the instrument’s sensitivity. The
45 degree oﬀset in the signal pattern between Stokes Q/Ic and U/Ic is also ﬁnely highlighted.

Figure 10 displays the physical quantities computed from the Stokes ﬁltergrams plotted in Fig. 9. Selecting
the umbra region with a continuum upper threshold of 0.6, the mean magnetic ﬁeld strength in the umbra is
1420 G. This is somewhat low for an umbra and may reﬂect straylight, or that the large Zeeman splitting within
the umbra is not caught that well by the placement of the wavelength points in PHI. The azimuth is of particular
interest with a strong signal. The line-of-sight velocity displays the expected redshift on the limb side of the
spot, with the corresponding blueshift towards disc centre (Evershed ﬂow).24

Figure 9. Stokes ﬁltergram in the red line wing on 5 November 2021 20:21 UTC: a) Stokes I/Ic b) Stokes Q/Ic c) Stokes
U/Ic d) Stokes V /Ic.

Figure 10. Derived physical quantities from data of 5 November 2021 20:21 UTC : a) continuum intensity, b) magnetic
ﬁeld strength, c) inclination relative to line-of-sight, d) azimuth relative to direction of rotation, e) Dopplergram, f)
line-of-sight magnetogram. The region outside the ﬁeld stop is set to black for clarity.

4.3 Magnetogram Noise

Several datasets with diﬀerent modulation schemes were acquired during a campaign in early November 2021
to test the cadence of the schemes. The noise from the line-of-sight magnetograms of these datasets at diﬀerent
cadences is presented in Fig. 11. The total number of frames per image is found from the multiplication of the
two numbers in the accumulation scheme. A clear trend is visible: as the accumulation scheme changes from
[4, 5] to [16, 1], less frames are being accumulated for each image, and therefore as expected the magnetogram
noise increases from 6.8 G to 8.3 G. The last grouping, was the fastest the [4, 5] scheme could be executed by
the instrument, with a cadence of 96 seconds. It is also clear that the higher the cycles of the modulation states
(the second value in the accumulation scheme), the lower the magnetogram noise. It must also be noted that
like the data from February 2021, the compression acts as the main driver of the noise.

Figure 11. Noise from the central region of the magnetogram plotted against time. The diﬀerent combinations of ‘cad’
(cadence) and ‘accu’ (PMP modulation accumulation scheme, see Sec. 2.1) are denoted by their marker colours. The
vertical dashed line signiﬁes the change in time from November 6th to November 8th.

5. CONCLUSION

An on-ground pipeline has been developed to reduce raw data from the HRT instrument to produce high quality
data with a polarimetric accuracy 10−3 · Ic and infer physical parameters from the polarised light. The 96 second
cadence line-of-sight magnetograms are shown to have an excellent low level of noise, only 6.6 G, similar to
the noise level of the HMI 720 second magnetograms. This was achieved by calibrating the ﬂat-ﬁelds to remove
unwanted artefacts from the acquisition process by use of unsharp masking. As a a result of the analysis presented
here, the unsharp masking procedure will be implemented onboard the spacecraft, such that the in-ﬂight data

will also produce data of the highest quality. The absence of the ISS has also been taken care by three more steps.
Despite the increase in data quality, as shown in Fig. 5, noise levels remain slightly higher than in the standard
conﬁguration because of the spacecraft jitter. This pipeline will be embedded into a software tool which will
automatically process all the SO/PHI science data that will arrive on ground and store them on the appropriate
databases.

ACKNOWLEDGMENTS

This work was carried out in the framework of the International Max Planck Research School (IMPRS) for Solar
System Science at the Max Planck Institute for Solar System Research (MPS). Solar Orbiter is a space mission
of international collaboration between ESA and NASA, operated by ESA. We are grateful to the ESA SOC and
MOC teams for their support. The German contribution to SO/PHI is funded by the BMWi through DLR and
by MPG central funds. The Spanish contribution is funded by FEDER/AEI/MCIU (RTI2018-096886-C5), a
“Center of Excellence Severo Ochoa” award to IAA-CSIC (SEV-2017-0709), and a Ram´on y Cajal fellowship
awarded to DOS. The French contribution is funded by CNES.

REFERENCES

[1] M¨uller, D., St. Cyr, O. C., Zouganelis, I., Gilbert, H. R., Marsden, R., Nieves-Chinchilla, T., Antonucci,
E., Auch`ere, F., Berghmans, D., Horbury, T. S., Howard, R. A., Krucker, S., Maksimovic, M., Owen, C. J.,
Rochus, P., Rodriguez-Pacheco, J., Romoli, M., Solanki, S. K., Bruno, R., Carlsson, M., Fludra, A., Harra,
L., Hassler, D. M., Livi, S., Louarn, P., Peter, H., Sch¨uhle, U., Teriaca, L., Del Toro Iniesta, J. C., Wimmer-
Schweingruber, R. F., Marsch, E., Velli, M., De Groof, A., Walsh, A., and Williams, D., “The Solar Orbiter
mission - Science overview,” Astronomy & Astrophysics 642, A1 (10 2020).

[2] Solanki, S. K., Del Toro Iniesta, J. C., Woch, J., Gandorfer, A., Hirzberger, J., Alvarez-Herrero, A., Ap-
pourchaux, T., Mart´ınez Pillet, V., P´erez-Grande, I., Sanchis Kilders, E., Schmidt, W., G´omez Cama, J. M.,
Michalik, H., Deutsch, W., Fernandez-Rico, G., Grauf, B., Gizon, L., Heerlein, K., Kolleck, M., Lagg, A.,
Meller, R., M¨uller, R., Sch¨uhle, U., Staub, J., Albert, K., Alvarez Copano, M., Beckmann, U., Bischoﬀ,
J., Busse, D., Enge, R., Frahm, S., Germerott, D., Guerrero, L., L¨optien, B., Meierdierks, T., Oberdorfer,
D., Papagiannaki, I., Ramanath, S., Schou, J., Werner, S., Yang, D., Zerr, A., Bergmann, M., Bochmann,
J., Heinrichs, J., Meyer, S., Monecke, M., M¨uller, M. F., Sperling, M., ´Alvarez Garc´ıa, D., Aparicio, B.,
Balaguer Jim´enez, M., Bellot Rubio, L. R., Cobos Carracosa, J. P., Girela, F., Hern´andez Exp´osito, D.,
Herranz, M., Labrousse, P., L´opez Jim´enez, A., Orozco Su´arez, D., Ramos, J. L., Barandiar´an, J., Bastide,
L., Campuzano, C., Cebollero, M., D´avila, B., Fern´andez-Medina, A., Garc´ıa Parejo, P., Garranzo-Garc´ıa,
D., Laguna, H., Mart´ın, J. A., Navarro, R., N´u˜nez Peral, A., Royo, M., S´anchez, A., Silva-L´opez, M., Vera,
I., Villanueva, J., Fourmond, J. J., De Galarreta, C. R., Bouzit, M., Hervier, V., Le Clec’h, J. C., Szwec, N.,
Chaigneau, M., Buttice, V., Dominguez-Tagle, C., Philippon, A., Boumier, P., Le Cocguen, R., Baranjuk,
G., Bell, A., Berkefeld, T., Baumgartner, J., Heidecke, F., Maue, T., Nakai, E., Scheiﬀelen, T., Sigwarth,
M., Soltau, D., Volkmer, R., Blanco Rodr´ıguez, J., Domingo, V., Ferreres Sabater, A., Gasent Blesa, J. L.,
Rodr´ıguez Mart´ınez, P., Osorno Caudel, D., Bosch, J., Casas, A., Carmona, M., Herms, A., Roma, D.,
Alonso, G., G´omez-Sanjuan, A., Piqueras, J., Torralbo, I., Fiethe, B., Guan, Y., Lange, T., Michel, H.,
Bonet, J. A., Fahmy, S., M¨uller, D., and Zouganelis, I., “The Polarimetric and Helioseismic Imager on Solar
Orbiter,” Astronomy and Astrophysics 642, A11 (10 2020).

[3] Gandorfer, A., Grauf, B., Staub, J., Bischoﬀ, J., Woch, J., Hirzberger, J., Solanki, S. K., ´Alvarez-Herrero, A.,
Parejo, P. G., and Schmidt, W., “The High Resolution Telescope (HRT) of the Polarimetric and Helioseismic
Imager (PHI) onboard Solar Orbiter,” in [Space Telescopes and Instrumentation 2018: Optical, Infrared,
and Millimeter Wave ], 10698, 106984N, International Society for Optics and Photonics (2018).

[4] Lange, T., Fiethe, B., Michel, H., Michalik, H., Albert, K., and Hirzberger, J., “On-board processing using
reconﬁgurable hardware on the solar orbiter PHI instrument,” 2017 NASA/ESA Conference on Adaptive
Hardware and Systems, AHS 2017 , 186–191 (9 2017).

[5] Albert, K., Hirzberger, J., Kolleck, M., Jorge, N. A., Busse, D., Rodr´ıguez, J. B., Carrascosa, J. P. C., Fiethe,
B., Gandorfer, A., Germerott, D., Guan, Y., Guerrero, L., Gutierrez-Marques, P., Exp´osito, D. H., Lange,
T., Michalik, H., Su´arez, D. O., Schou, J., Solanki, S. K., Iniesta, J. C. d. T., and Woch, J., “Autonomous

on-board data processing and instrument calibration software for the Polarimetric and Helioseismic Imager
on-board the Solar Orbiter mission,” https://doi.org/10.1117/1.JATIS.6.4.048004 6, 048004 (12 2020).
[6] Zouganelis, I., De Groof, A., Walsh, A. P., Williams, D. R., M¨uller, D., St Cyr, O. C., Auch`ere, F.,
Berghmans, D., Fludra, A., Horbury, T. S., Howard, R. A., Krucker, S., Maksimovic, M., Owen, C. J.,
Rodr´ıguez-Pacheco, J., Romoli, M., Solanki, S. K., Watson, C., Sanchez, L., Lefort, J., Osuna, P., Gilbert,
H. R., Nieves-Chinchilla, T., Abbo, L., Alexandrova, O., Anastasiadis, A., Andretta, V., Antonucci, E.,
Appourchaux, T., Aran, A., Arge, C. N., Aulanier, G., Baker, D., Bale, S. D., Battaglia, M., Bellot Rubio,
L., Bemporad, A., Berthomier, M., Bocchialini, K., Bonnin, X., Brun, A. S., Bruno, R., Buchlin, E.,
B¨uchner, J., Bucik, R., Carcaboso, F., Carr, R., Carrasco-Bl´azquez, I., Cecconi, B., Cernuda Cangas, I.,
Chen, C. H., Chitta, L. P., Chust, T., Dalmasse, K., D’Amicis, R., Da Deppo, V., De Marco, R., Dolei,
S., Dolla, L., Dudok De Wit, T., Van Driel-Gesztelyi, L., Eastwood, J. P., Espinosa Lara, F., Etesi, L.,
Fedorov, A., F´elix-Redondo, F., Fineschi, S., Fleck, B., Fontaine, D., Fox, N. J., Gandorfer, A., G´enot, V.,
Georgoulis, M. K., Gissot, S., Giunta, A., Gizon, L., G´omez-Herrero, R., Gontikakis, C., Graham, G., Green,
L., Grundy, T., Haberreiter, M., Harra, L. K., Hassler, D. M., Hirzberger, J., Ho, G. C., Hurford, G., Innes,
D., Issautier, K., James, A. W., Janitzek, N., Janvier, M., Jeﬀrey, N., Jenkins, J., Khotyaintsev, Y., Klein,
K. L., Kontar, E. P., Kontogiannis, I., Kraﬀt, C., Krasnoselskikh, V., Kretzschmar, M., Labrosse, N., Lagg,
A., Landini, F., Lavraud, B., Leon, I., Lepri, S. T., Lewis, G. R., Liewer, P., Linker, J., Livi, S., Long, D. M.,
Louarn, P., Malandraki, O., Maloney, S., Martinez-Pillet, V., Martinovic, M., Masson, A., Matthews, S.,
Matteini, L., Meyer-Vernet, N., Moraitis, K., Morton, R. J., Musset, S., Nicolaou, G., Nindos, A., O’Brien,
H., Orozco Suarez, D., Owens, M., Pancrazzi, M., Papaioannou, A., Parenti, S., Pariat, E., Patsourakos,
S., Perrone, D., Peter, H., Pinto, R. F., Plainaki, C., Plettemeier, D., Plunkett, S. P., Raines, J. M.,
Raouaﬁ, N., Reid, H., Retino, A., Rezeau, L., Rochus, P., Rodriguez, L., Rodriguez-Garcia, L., Roth, M.,
Rouillard, A. P., Sahraoui, F., Sasso, C., Schou, J., Sch¨uhle, U., Sorriso-Valvo, L., Soucek, J., Spadaro, D.,
Stangalini, M., Stansby, D., Steller, M., Strugarek, A., ˇStver´ak, Susino, R., Telloni, D., Terasa, C., Teriaca,
L., Toledo-Redondo, S., Del Toro Iniesta, J. C., Tsiropoula, G., Tsounis, A., Tziotziou, K., Valentini, F.,
Vaivads, A., Vecchio, A., Velli, M., Verbeeck, C., Verdini, A., Verscharen, D., Vilmer, N., Vourlidas, A.,
Wicks, R., Wimmer-Schweingruber, R. F., Wiegelmann, T., Young, P. R., and Zhukov, A. N., “The Solar
Orbiter Science Activity Plan - Translating solar and heliospheric physics questions into action,” Astronomy
& Astrophysics 642, A3 (10 2020).

[7] Alvarez-Herrero, A., Garc´ıa Parejo, P., Laguna, H., Villanueva, J., Barandiar´an, J., Bastide, L., Reina, M.,
S´anchez, A., Gonzalo, A., Navarro, R., Vera, I., and Royo, M., “Polarization modulators based on liquid
crystal variable retarders for the Solar Orbiter mission,” in [Polarization Science and Remote Sensing VII],
9613(September 2015), 96130I (2015).

[8] Volkmer, R., Bosch, J., Feger, B., Gomez, J. M., Heidecke, F., Schmidt, W., Scheiﬀelen, T., Sigwarth,
M., and Soltau, D., “Image stabilisation system of the photospheric and helioseismic imager,” in [Space
Telescopes and Instrumentation 2012: Optical, Infrared, and Millimeter Wave ], 8442, 84424P, SPIE (9
2012).

[9] Carmona, M., G´omez, J. M., Roma, D., Casas, A., L´opez, M., Bosch, J., Herms, A., Sabater, J., Volkmer,
R., Heidecke, F., Maue, T., Nakai, E., and Schmidt, W., “System model of an image stabilization system,”
in [Modeling, Systems Engineering, and Project Management for Astronomy VI], 9150, 91501U, SPIE (8
2014).

[10] Dominguez-Tagle, C., Appourchaux, T., Ruiz de Galarreta, C., Fourmond, J.-J., Philippon, A., Le Clec’h, J.-
C., Bouzit, M., Bommier, V., Le Cocguen, R., Crussaire, D., and Malherbe, J.-M., “Optical characterization
of the breadboard narrowband preﬁlters for Solar Orbiter PHI,” Space Telescopes and Instrumentation 2014:
Optical, Infrared, and Millimeter Wave 9143, 91435G (8 2014).

[11] Kuhn, J. R., Lin, H., and Loranz, D., “Gain calibrating nonuniform image-array data using only the image

data,” Publications of the Astronomical Society of the Paciﬁc 103(668), 1097 (1991).

[12] Del Toro Iniesta, J. C., [Introduction to Spectropolarimetry], Cambridge University Press (3 2003).
[13] Sanchez Almeida, J., Lites, B. W., Sanchez Almeida, J., and Lites, B. W., “Observation and Interpretation

of the Asymmetric Stokes Q, U, and V Line Proﬁles in Sunspots,” ApJ 398, 359 (10 1992).

[14] Schlichenmaier, R. and Collados, M., “Spectropolarimetry in a sunspot penumbra. Spatial dependence of

Stokes asymmetries in Fe I 1564.8 nm,” Astronomy and Astrophysics 381, 668–682 (1 2002).

[15] Guizar-Sicairos, M., Thurman, S. T., and Fienup, J. R., “Eﬃcient subpixel image registration algorithms,”

Optics Letters 33, 156 (1 2008).

[16] Hoeksema, J. T., Liu, Y., Hayashi, K., Sun, X., Schou, J., Couvidat, S., Norton, A., Bobra, M., Centeno, R.,
Leka, K. D., Barnes, G., and Turmon, M., “The Helioseismic and Magnetic Imager (HMI) Vector Magnetic
Field Pipeline: Overview and Performance,” Solar Physics 289, 3483–3530 (9 2014).

[17] Borrero, J. M., Tomczyk, S., Kubo, M., Socas-Navarro, H., Schou, J., Couvidat, S., and Bogart, R., “VFISV:
Very Fast Inversion of the Stokes Vector for the Helioseismic and Magnetic Imager,” Solar Physics 273,
267–293 (2 2011).

[18] Landi Degl’Innocenti, E. and Landolﬁ, M., [Polarization in spectral lines], Kluwer Academic Publishers

(2005).

[19] Su´arez, D. O. and Del Toro Iniesta, J. C., “The usefulness of analytic response functions,” Astronomy and

Astrophysics 462, 1137–1145 (2 2007).

[20] Cobos Carrascosa, J. P., Aparicio del Moral, B., Ramos Mas, J. L., Balaguer, M., L´opez Jim´enez, A. C., and
del Toro Iniesta, J. C., “The RTE inversion on FPGA aboard the solar orbiter PHI instrument,” Software
and Cyberinfrastructure for Astronomy IV 9913, 991342 (7 2016).

[21] Semel, M., “Contribution `a l’´etude des champs magn´etiques dans les r´egions actives solaires,” Annales

d’Astrophysique 30, 513–551 (1967).

[22] Rees, D. E.; Semel, M. D., “Line formation in an unresolved magnetic element-A test of the centre of gravity

method,” Astronomy and Astrophysics 74(4), 1–5 (1979).

[23] Liu, Y., Hoeksema, J. T., Scherrer, P. H., Schou, J., Couvidat, S., Bush, R. I., Duvall, T. L., Hayashi,
K., Sun, X., and Zhao, X., “Comparison of Line-of-Sight Magnetograms Taken by the Solar Dynamics
Observatory/Helioseismic and Magnetic Imager and Solar and Heliospheric Observatory/Michelson Doppler
Imager,” Solar Physics 279, 295–316 (7 2012).

[24] Evershed, J., “Radial movement in sun-spots,” The Observatory 32, 291–292 (1909).

