2
2
0
2

p
e
S
7

]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[

1
v
7
5
4
3
0
.
9
0
2
2
:
v
i
X
r
a

A derivation of the electric ﬁeld inside MAPS detectors
from beam-test data and limited TCAD simulations

A. Santraa,1, N. Tal Hoda,2

aDepartment of Particle Physics and Astrophysics,Weizmann Institute of
Science,Rehovot,7610001, Israel

Abstract

Solid semiconductor sensors are used as detectors in high-energy physics ex-
periments, in medical applications, in space missions and elsewhere. A pre-
cise knowledge of the electric ﬁeld inside the basic cells of these sensors is
highly important for their characterization and performance understanding.
The ﬁeld governs the charge propagation processes and ultimately determines
the size and quality of the electronic signal of the cell. Hence, the simulation
of these sensors relies strongly on the electric ﬁeld knowledge. For a certain
voltage applied to the cell, the ﬁeld depends on the speciﬁcs of the device’s
growth and fabrication. The information about these is often commercially
protected or otherwise very diﬃcult to encode in state-of-the-art technology
computer-aided-design (TCAD) software. It is therefore practically impos-
sible to obtain the ﬁeld without some minimal knowledge. In this work, we
show that combining public beam-test data and a very limited public TCAD-
based knowledge, we are able to eﬀectively reconstruct the 3D electric ﬁeld
function in the pixel cell of one important and widely used example, namely
the ALPIDE sensor, a monolithic active pixel sensor (MAPS). Despite its
broad usage worldwide, the ALPIDE ﬁeld is not available to the community
as it is under proprietary restriction. We provide the 3D eﬀective ﬁeld func-
tion of the ALPIDE sensor and comment on the process by which it is derived
with the help of the Allpix2 software. We also comment on how starting from
the same grounds, similar work can be performed for other devices.

Keywords: ALPIDE, Pixel, TCAD, E-Field, Charge, Allpix2

1arka.santra@weizmann.ac.il
2noam.hod@weizmann.ac.il

Preprint submitted to Nucl. Instr. Meth. A

September 9, 2022

 
 
 
 
 
 
1. Introduction

Solid semiconductor sensors are used for imaging, tracking and calorime-
try in diﬀerent disciplines. These detectors may have diﬀerent level of tol-
erance for damage caused by diﬀerent radiation types and doses, depending
on the application. When an ionizing particle traverses the elementary cell
of the sensor (pixel, strip, pad, etc.), an electric current pulse is produced
at the collection node of that cell (the electronic signal). This current is in
eﬀect produced from electrons or holes (charge carriers), which are created
in pairs along the trajectory of the ionizing traversing particle. The collected
charges are processed by the front-end electronics and a “hit” is formed if
the collected charge is above certain threshold. The number of charge carri-
ers and the way these propagate to the collection node depend therefore on
the speciﬁcs of the sensor material. The electronic signal depends in turn
strongly on the material, but it also depends on a number of other parameters
such as the sensor fabrication processes, the sensor geometry, the external
voltage applied to the sensor, the damage the sensor may have suﬀered due
to continuous exposure to radiation, etc.

A key ingredient in the characterization and understanding charge car-
riers’ propagation in the cell is the electric ﬁeld inside it. The ﬁeld governs
this propagation process and ultimately determines the size and quality of the
electronic signal output of the cell. Hence, the simulation of these sensors re-
lies strongly on the electric ﬁeld knowledge. An important task in the overall
design process of a sensor is the implementation of the corresponding tech-
nology computer-aided-design (TCAD) simulation of the device. This can
be done using “Sentaurus” software from Synopsys [1] or “Atlas” software
from Silvaco [2]. One of the outputs of such TCAD simulation is the ﬁne-
grained 3D electric ﬁeld mesh inside the cell, which is later used to simulate
the charge propagation. Hence, the ﬁeld is an essential piece in the charac-
terization of the device performance. Implementing the device’s growth and
fabrication procedures in TCAD is an extremely complicated task. Moreover,
the information about these procedures is usually protected commercially. In
some cases, the ﬁeld may be one dimensional, e.g., (cid:126)E = Ez (with z being
the coordinate along the depth of the cell). Furthermore, this single com-
ponent may be modeled to a good approximation as a simple function of
In these cases, the absence of a detailed TCAD mesh description
z only.

2

of the ﬁeld is not a limiting factor for the simulation chain of the device.
However, in other cases, the ﬁeld may be highly non-linear and generally, it
may have non-trivial components also in the transverse (x, y) coordinates,
i.e., (cid:126)E = (Ex, Ey, Ez). The three components can themselves depend non-
trivially on all three coordinates, i.e., Ei = fi(x, y, z), where i = x, y, z and
fi is some 3D function that is not necessarily analytical.

This is particularly important for new monolithic active pixel sensors
(MAPS) [3], which are used more and more extensively in recent years thanks
to the development of sub-micron capabilities in diﬀerent foundries world-
wide. Unlike in hybrid sensors, the readout circuitry of MAPS is integrated
in the same substrate as the sensing volume. Consequently, the material bud-
get may be substantially reduced, the production costs can also be reduced
and the production yield can be higher. MAPS are now becoming popular,
e.g., for the next-generation high-energy physics experiments (for tracking,
vertexing and calorimetry) and elsewhere.

In some of these cases it may happen that users of a speciﬁc sensor do
not have access to the TCAD mesh of the non-trivial ﬁeld. This poses a
serious problem for these users, who eﬀectively lack the ﬁrst building block
of the device simulation and therefore cannot properly simulate its response.
To overcome this limitation, we show that combining public beam-test data
and a very limited public TCAD-based knowledge, we are able to eﬀectively
reconstruct the 3D electric ﬁeld function in the pixel cell of one important
and widely used example, namely the ALPIDE monolithic silicon sensor [4,
5, 6, 7, 8]. The ALPIDE (ALice PIxel DEtector) sensor was developed by and
for the ALICE [9] experiment at the LHC together with TowerJazz [10]. The
inner tracking system (ITS) of ALICE [11] has been upgraded successfully
in 2021 with this new technology and it is now the largest pixel detector
ever built. The successful ALPIDE technology is also being used elsewhere
in other experiments/facilities like LUXE [12], sPHENIX [13, 14], DESY’s
beam-test facility [15], the CSES-2 satellite mission [16]) in space, Proton
Computed Tomography (pCT) [17, 18], and more. However, despite its wide
usage, the TCAD sampling points (referred to hereafter as “mesh”) are not
available to the community as it is under proprietary restriction.

In this work, we discuss how the 3D eﬀective ﬁeld function (denoted
EFF hereafter) in the ALPIDE pixel sensor is derived. We use the Allpix2
software [19, 20] to compare the performance in simulation between two cases,
once starting from our 3D EFF and once starting from public results that are

3

using the actual TCAD mesh, which remains unknown to us. The two cases
are denoted hereafter as Allpix2+EFF and Allpix2+TCAD, respectively. For
the comparison, we take help of the Allpix2+TCAD results shown in [21].
The authors of [21] go further to compare their Allpix2+TCAD simulation
with data collected in a beam-test [22]. The results in [21] and [22] are
obtained using a prototype of the ALPIDE sensor, called “Investigator”. The
pixel design of the Investigator sensor is close to that of the ALPIDE design,
except for the pitch (the Investigator has square pixel pitch of diﬀerent sizes).
The performance of the three scenarios is shown to be very similar. This
agreement gives conﬁdence in our EFF as the cornerstone for further simu-
lation campaigns, where the ALPIDE sensor is used. We comment on the
derivation process and provide the EFF as a set of ROOT [23] TFormula-
compatible strings. We provide the code that produces our EFF such that
further ﬁne-tuning may be done, and such that similar work can be started
for other sensors. We also provide the Allpix2 conﬁguration ﬁles used in our
Allpix2+EFF simulation. Our EFF generation code and Allpix2 conﬁgura-
tions are available in [24].

2. The Allpix2 setup

The Allpix2 software [19, 20] is a lightweight C++ framework that sim-
ulates the processes triggered inside diﬀerent semiconductor devices when
ionizing particles traverse these. Particularly, it simulates the electron-hole
pair creation, the drift or diﬀusion of these charge carriers given some electric
ﬁeld, the charge collection by the electrodes and ﬁnally the digitization of
collected charge along with the electronic noise in the front-end electronics.
The task of simulating the energy deposition process by the ionizing particles
(an input for the charge carriers generation) is external to Allpix2. Usually
this is done by Geant4 [25, 26, 27], which is interfaced directly to Allpix2 for
convenience, but this can also be provided from other sources. The Allpix2
simulation ﬂow is implemented using several modules, accessed sequentially
using a conﬁguration ﬁle. While for a full description the reader is referred to
the Allpix2 user manual [20], we brieﬂy summarize the most relevant modules
related to the purpose of this work:

• GeometryBuilderGeant4: constructs the Geant4 geometry given
the description of the sensors and their arrangement (dimension, posi-
tion and orientation).

4

• DepositionGeant4: implements the simulation of energy deposition

by ionizing particles in the active volume of the detector.

• ElectricFieldReader: implements the electric ﬁeld inside the sensor
volume. The ﬁeld can be applied using several methods. These in-
clude TCAD mesh input ﬁles, simple built-in functions (constant, lin-
ear, parabolic), and most importantly for this work, any user-deﬁned
analytic functions in the form of ROOT TFormula-compatible strings.

• GenericPropagation:

simulates the propagation of electrons and

holes in the sensor volume given the electric ﬁeld.

• DefaultDigitizer: translates the collected charge into a digitized sig-
nal proportional to the input charge. The noise in the electronics is
also simulated here.

These modules are called sequentially in the simulation chain. The output of
the chain contains the ﬁred pixels, i.e., pixels which have a collected charge
passing some predeﬁned threshold. It is important to stress that an induced
charge generation in adjacent pixels (to the pixel where the ionizing particle
passes through) is also simulated by Allpix2. The list of ﬁred pixels can then
be used in a subsequent analysis, which depends on the speciﬁc application.
This analysis may include, e.g., calibrating the charge to the energy-loss,
counting of hits, clustering of the pixels, tracking, etc.

The Allpix2 simulation conﬁguration for this work is kept as close as
possible to that of [21]. This is necessary for the validation of the EFF by
comparing the Allpix2+EFF and Allpix2+TCAD performances. Therefore,
the total thickness of the sensor in our Allpix2+EFF runs is taken to be
100 µm, with a depletion depth of 25 µm, like the sensor used in [21]. The
pixel pitch of the Investigator sensor used is 28 × 28 µm2 in x × y. While we
conﬁgure our code that generates the 3D EFF to have the same parameters
as for the Investigator sensor, we make sure that it is easy to reconﬁgure
these parameters using the production version of the ALPIDE. For example,
the pixel pitch is deﬁned as a global parameter in the code and hence, it can
be simply re-set at one place such that the EFF would scale naturally.

A simulated π+ beam particles with an energy of 120 GeV is set to hit
the detector. This is similar to the beam condition of the beam-test setup
of [22]. The beam axis is deﬁned as the positive z direction, normal to the

5

sensor plane. After the π+ beam particles deposit energy and generate the
electron-hole pairs along their trajectory in the sensor, the charge carriers are
propagated by Allpix2 towards the electrodes along the electric ﬁeld lines. In
the upper part of the sensor (within depletion depth of 25 µm), both drift
and diﬀusion are the preferred modes of charge carrier motion, whereas in
the region beyond the depletion depth, only diﬀusion occurs due to the lack
of electric ﬁeld in that region. The charges reaching the electrodes within a
time window of 22.5 ns (as in [21]) are collected. Finally, the collected charge
is converted into a digital signal. Equivalent electronic noise is added to the
signal by randomly drawing from a Gaussian distribution with a width of
10 e and mean of 0 e. Diﬀerent charge collection thresholds are checked in
the range between 40 e and 700 e. A threshold smearing option is also added
to the simulation by sampling from a Gaussian distribution with width 5 e
and mean 0 e. While we mention some key simulation parameters explic-
itly above, there are in fact more parameters required for the process. All
parameters are kept as in [21].

The bias voltage applied to the ALPIDE p-well in [21] and [22] is −6 V.
A voltage of +0.8 V is applied to the collection electrode. When using the
TCAD mesh, the voltage settings are dictated by that. In the user-deﬁned
function case, however, the settings are completely set by the function’s
normalization. This normalization can be capped very roughly by ∼ −6 V,
when integrating the EFF along the depletion region, but it strongly depends
on the shape as well.

3. The process of deriving the eﬀective ﬁeld function

As mentioned before, the detailed TCAD mesh of the electric ﬁeld inside
the ALPIDE sensor is unavailable publicly. However, its magnitude, (cid:112)ΣE2
i
(with i = x, y, z), in the x − z plane for y = 0 is shown in ﬁgure 4 of [21]. The
ﬁeld lines in this plane are also overlaid in this ﬁgure. The magnitude of the
ﬁeld at the faces of the pixel in three-dimensions are shown in ﬁgure 3 of [21].
As discussed above, due to various restrictions, these two ﬁgures are given
without axes scale-labels. The meaning of the colors in these ﬁgures can be
loosely interpreted from the ﬁeld of a similar “investigator” chip shown in
ﬁgures 8.4 and 8.5 of an older work from 2018 [28]. This work used the CLIC
Tracker Detector (CLICTD), a monolithic chip [29] which is also produced in

6

a 180 nm imaging CMOS3 process on a high-resistivity epitaxial layer like the
ALPIDE. The extensive TCAD studies in [28] show a similar ﬁeld behavior
to the one of the ALPIDE, where unlike [21], more details are provided,
in particular the scale of the color map. This information was also used
to deﬁne our EFF. As it can be seen in the ﬁgures mentioned above, the
ﬁeld’s magnitude shape is highly non-linear and the EFF cannot be easily
deciphered from the available information. At this step, we therefore only
have a very rough idea on how the magnitude of the 3D EFF should look
like in a few slices of the pixel. We also know that besides mimicking the
shape visually, its components’ normalizations should result in a voltage of
∼ −6 V when integrated along z in the upper 25 µm of the sensor.

This information is clearly not enough to derive the ﬁeld, even not ef-
fectively. However, we do have another few indirect pieces of invaluable
information from [21] detailing the performance of the sensor with the π+
particle beam discussed above. This includes the charge distributions (ﬁg-
ure 9), the cluster size distributions (ﬁgures 10 and 11) and the position
residual distributions in x (ﬁgure 15), all given for a speciﬁc threshold. The
behavior for diﬀerent thresholds can be seen in the cluster size graphs (ﬁg-
ure 13), the spatial resolution graphs in x and y (ﬁgure 16) and the eﬃciency
graphs (ﬁgure 18). With this, we can iteratively plug in one EFF ansatz at
a time such that

1. its 3D magnitude, (cid:112)ΣE2

i (with Ei = fi(x, y, z) and i = x, y, z), visually
resembles the magnitude of the TCAD ﬁeld shape in the slices from
ﬁgures 3-4 of [21] including the ﬁeld lines,

2. it results in an integral − (cid:82) (cid:126)E · d(cid:126)(cid:96) (cid:39) −6 V, where (cid:126)(cid:96) runs along the
negative z-axis direction at the top 25 µm of the sensor in its center
(x = y = 0), and

3. it gives a good agreement with the performance ﬁgures 9-18 of [21] after

simulating the same scenarios with our Allpix2+EFF setup.

For step 1 above, we add the main features of the ﬁeld, one by one and plot
the ﬁeld magnitude in 3D and a few 2D slices, similar to the ones available
from TCAD. This is done initially with simple functional shapes (sphere,
arcs, stripes, Gaussian and exponential shapes, etc.). Upon adding a new
feature, we verify that it merges properly with the existing features in terms

3Complementary metal-oxide-semiconductor.

7

of the relative normalization and the smoothness in the transition regions. In
some cases, adding a new prominent feature may lead to irregularities in the
transition regions. In these cases, one can add new, compensating, features
limited to the relevant regions to remove these irregularities. Regardless of
the ﬁeld magnitude, in case the ﬁeld lines are also available from TCAD
in some 2D slices, they must always match in direction. This is adjusted
by changing both the feature’s relative normalization and sign in all three
components.

For step 3 above, we initially simulate 1000 primary π+ beam particles to
see if the cluster charge and size distributions roughly agree with those in ﬁg-
ures 9-10 of [21] for a nominal threshold of 120 e. If these agree, we continue
to check a wider range of thresholds (40-700 e) with larger statistics (20,000
primary π+ beam particles) and check the agreement with ﬁgures 9-18 of [21].
For the comparison, we digitize the ﬁgures from [21] using the ‘WebPlotDig-
itizer’ software [30] to get the distributions/graphs and their uncertainties
wherever applicable. A good agreement in that respect is therefore judged
according to the ratio between our Allpix2+EFF and the Allpix2+TCAD
simulation taking into account the uncertainties.

The iterative process of adding ﬁeld features to the EFF ansatz and test-
ing the performance (per ansatz) may be stopped when all three criteria
above are satisﬁed to a large extent, noting that the ﬁrst two are only qual-
itative tests. Speciﬁcally for the ALPIDE sensor, more than a hundred of
such iterations were needed in order to arrive at a satisfactory EFF. The
ﬁnal EFF string generated automatically by our code [24], using a set of
parametric logical expressions, has ∼ 2600 characters for the z component
and ∼ 5700 characters for each of the x and y components. This gives a
rough idea about how highly-complex the EFF is and particularly in the
transverse direction.

The procedure discussed above can be regarded as generic as long as there
is at least (i) a very basic knowledge on the ﬁeld’s shape and (ii) reference
data for the comparison of the sensor performance with simulation.

4. The eﬀective ﬁeld function of the ALPIDE sensor

The results shown in this section are given after the full rigorous procedure
described in section 3. The resulting EFF magnitude of the ALPIDE sensor
is seen in ﬁgures 1, 2. These plots should be compared with ﬁgures 4 and 3

8

of [21]. It can be seen that while the EFF magnitude shape is not identical
to the TCAD mesh magnitude shape, it captures all important features.

The integral − (cid:82) (cid:126)E · d(cid:126)(cid:96) with (cid:126)(cid:96) running along the negative z-axis direction
at the top 25 µm of the sensor in its center (x = y = 0) results in a bias
voltage of -6.08 V, as expected.

The analytical expression (in the form of a ROOT TFormula-compatible
string) is too complex and long to be included in this manuscript and hence
it is saved in [24]. In addition, the code producing the EFF as well as all the
plots below can be found in [24].

Figure 1: Left: the 3D EFF magnitude, (cid:112)ΣE2
i (with Ei = fi(x, y, z) and i = x, y, z), at
the ALPIDE pixel sensor faces (sides and top). Right: the EFF magnitude in the z vs x
plane sliced at y = 0 overlaid with the ﬁeld lines shown as white arrows (the arrows are
positioned at the bin centers). All shapes are given for the upper 25 µm of the sensor,
where the EFF is non-zero. These plots should be compared with ﬁgures 4 and 3 of [21],
respectively.

5. Sensor performance with the eﬀective ﬁeld function

The Allpix2 results shown in this section are using the EFF discussed
in section 4. The Allpix2+EFF results are compared with the ones of the
Allpix2+TCAD and the beam-test data from [21]. The comparison is done at
the level of a pixels-cluster in terms of the cluster’s charge, size and position.
The clustering of ﬁred pixels (pixels with charge above threshold) follow a
simple “packman” algorithm, where all adjacent ﬁred pixels (in both x and
y directions) are added together to form a cluster. In this simple algorithm,
no pixel sharing is allowed between two clusters. The same algorithm is used

9

Magnitude of the 3D E-field (sliced at y=0)0.01-0.005-00.0050.01x [mm]0.01-0.005-00.0050.01z [mm]210310410Magnitude of the 3D E-field [V/cm]Magnitude of the 3D E-field (sliced at y=0)Figure 2: The 3D EFF magnitude, (cid:112)ΣE2
i (with Ei = fi(x, y, z) and i = x, y, z), at the
ALPIDE pixel faces overlaid with the ﬁeld lines (clockwise from top left: the bottom face
of the pixel, its top face, its y face and its x face). All shapes are given for the upper
25 µm of the pixel where the EFF is non-zero.

also in [21]. The cluster size is simply the number of pixels associated with
it. Likewise, the cluster charge is the sum of all pixels’ charges associated
with it. The cluster position in x − y is obtained as a charge-weighted mean
from the positions of all pixels of the cluster. This can be compared with
the truth position of the incoming π+ beam particles to obtain the residuals.
Finally, the detection eﬃciency can be deﬁned in terms of the fraction of
truth-matched clusters (i.e. clusters matched with true incident π+ beam
particles) from all clusters formed. A successful matching is achieved when
the maximum distance between the cluster position and the true incident
particle position is smaller than three times the pixel pitch in each dimension.
For the comparison, we use a wide range of thresholds, between 40 e and

10

210310410Magnitude of the 3D E-field [V/cm]Magnitude of the 3D E-field (sliced at z=bot)0.01-0.005-00.0050.01x [mm]0.01-0.005-00.0050.01y [mm]Magnitude of the 3D E-field (sliced at z=bot)210310410Magnitude of the 3D E-field [V/cm]Magnitude of the 3D E-field (sliced at z=top)0.01-0.005-00.0050.01x [mm]0.01-0.005-00.0050.01y [mm]Magnitude of the 3D E-field (sliced at z=top)210310410Magnitude of the 3D E-field [V/cm]Magnitude of the 3D E-field (sliced at x=right)0.01-0.005-00.0050.01y [mm]0.01-0.005-00.0050.01z [mm]Magnitude of the 3D E-field (sliced at x=right)210310410Magnitude of the 3D E-field [V/cm]Magnitude of the 3D E-field (sliced at y=front)0.01-0.005-00.0050.01x [mm]0.01-0.005-00.0050.01z [mm]Magnitude of the 3D E-field (sliced at y=front)700 e, where the nominal threshold is of 120 e. The number of primary
π+ beam particles used for the Allpix2+EFF results below is 20,000 for the
nominal as well as the other thresholds. This gives a low enough statistical
error which allows to clearly see the main trends.

Whenever the statistical uncertainties are available in the Allpix2+TCAD
results of [21], we use those in the ratio plots shown in the bottom panels.
Otherwise, the errors in the ratio panel represent the statistical uncertainty
of our Allpix2+EFF simulation alone. Furthermore, the systematic uncer-
tainty bands for the Allpix2+TCAD plots shown in [21] are not overlaid here
because it was not possible to decipher these from the source. However, we do
comment qualitatively on the compatibility between the Allpix2+TCAD and
Allpix2+EFF results with respect to the systematic uncertainties from [21].
These uncertainties should be identical between the two simulations, leading
2 for the comparison. This
to an overall uncertainty higher by a factor of
statement is true as long as one excludes systematic variations of the ﬁeld
function itself, a study which we leave for future work.

√

The cluster charge and size distributions for the nominal threshold are
shown in ﬁgure 3. The most probable value (MPV) resulting from a ﬁt
of the Allpix2+EFF charge distribution to a convolution of a Landau and a
Gaussian functions is 1.48, whereas the MPV result for the Allpix2+TCAD is
1.42. A good agreement is also seen in the two ratio plots. The distributions
of the cluster size in x and y, and the residuals in x are checked as well
for the nominal threshold in ﬁgures 4 and 5. A similar conclusion about
the good agreement can be drawn in these cases as well. Particularly, using
ﬁgure 5 and following the exact procedure given in [21] to calculate the
resolution, we ﬁnd that it is σx = 3.34 µm for Allpix2+EFF at a threshold of
120 e, compared with 3.60 ± 0.01(stat)+0.24
−0.13(syst) µm for Allpix2+TCAD. As
mentioned earlier, since the procedures are identical, the overall uncertainty
√
for our comparison will be a factor of

2 higher.

Finally, we also see a good agreement when scanning the thresholds in
the range mentioned above and plotting the mean cluster size, the detection
eﬃciency and the spatial resolution in x and y vs the threshold. These
results are shown in ﬁgures 6 and 7. We take the systematic uncertainties of
the Allpix2+TCAD results from [21] qualitatively and note again that these
should be identical to those of our Allpix2+EFF simulation.

The largest discrepancy between the two results is seen in the spatial
resolution at low thresholds, (cid:46) 150 e. This discrepancy is nevertheless within
the uncertainty for the resolution in y (5%-15% in 40-120 e), while for x, the

11

Figure 3: The comparison of the cluster charge (left) and cluster size (right) distributions
between our Allpix2+EFF simulation and the Allpix2+TCAD simulation (and the beam-
test data) from [21]. The bottom panels show the ratio of the Allpix2+TCAD (red) or
data (grey) results to the Allpix2+EFF results. The cluster charge distribution for the
data either does not have statistical uncertainties at the source or the errors are too
small for the digitizer software [30] to decipher. The systematic uncertainty band for the
Allpix2+TCAD charge plot shown in [21] is not overlaid here because it was not possible
to decipher it from the original plot. However, as one can see in [21], the uncertainty
on the Allpix2+TCAD histogram is as high as 1-10% in the region where the statistics
are high enough. The Allpix2+EFF uncertainties should be identical to that (giving an
overall uncertainty higher by a factor of
2).

√

two results are compatible within the uncertainties (∼ 7% in 40-200 e) only
above (cid:39) 80 e. This lies well below the nominal projected working range
of the sensors. The second-largest discrepancy is evident in the eﬃciency
graph at the highest thresholds, (cid:38) 600 e. This discrepancy is well within the
systematic uncertainty (∼ 1 − 2% above 600 e) and also here, it is manifested
in a range that is much above the nominal projected working range of the
sensors.

The performance plots given here show a comprehensive set of tests in
a wide range of values each, indicating a good compatibility between our
Allpix2+EFF results and the Allpix2+TCAD results and particularly for the
relevant range of operation. These two sets of simulation results also show
the same level of compatibility with the data.

12

0.0050.010.0150.020.0250.030.0350.040.045Normalized entriesData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix00.511.522.533.54Cluster charge (ke)0.511.52Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2Allpix0.10.20.30.40.50.6Normalized entriesData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0246810Cluster size (pixel)0.511.52Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2AllpixFigure 4: The comparison of the cluster size in x (left) and in y (right) distributions
between our Allpix2+EFF simulation and the Allpix2+TCAD simulation (and the beam-
test data) from [21]. The bottom panels show the ratio of the Allpix2+TCAD (red)
or data (grey) results to the Allpix2+EFF results. The data histograms either do not
have statistical uncertainties at the source or the errors are too small for the digitizer
software [30]. The source also does not have systematic uncertainties for these plots.

6. Conclusions and outlook

We show that a carefully constructed EFF may replace a highly detailed
TCAD mesh in the simulation chain of semiconductor sensors. This is shown
for the highly non-linear and non-trivial ﬁeld of the ALPIDE sensor, where
the TCAD mesh is not available publicly. Our EFF shape resembles the
one from [21] and moreover, it reproduces the same performance to a very
good extent for several quantities in a wide range of values. The procedures
discussed can be regarded as general as long as there is at least (i) a very basic
knowledge on the ﬁeld’s shape and (ii) reference data for the comparison of
the sensor performance with simulation, e.g.
from beam-tests, radioactive
sources, cosmic muons, etc. We point out that, while our EFF (available
in [24]) can be already used now, it may also be further optimized to reach
an even better agreement with the TCAD-based results of [21].
In that
sense, the decision where to stop the optimization process is purely driven
by pragmatic considerations, depending on the speciﬁc application.

Our work allows the many ALPIDE users worldwide, who do not have
access to the TCAD mesh, to use our EFF as an important input for their

13

0.10.20.30.40.50.60.70.80.91Normalized entriesData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0246810Cluster size in x (pixel)0.511.52Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2Allpix0.10.20.30.40.50.60.70.80.91Normalized entriesData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0246810Cluster size in y (pixel)0.511.52Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2AllpixFigure 5: The comparison of the cluster position residuals distribution in x between our
Allpix2+EFF simulation and the Allpix2+TCAD simulation (and the beam-test data)
from [21]. The bottom panel show the ratio of the Allpix2+TCAD (red) or data (grey) re-
sults to the Allpix2+EFF result. The three resolutions reported are calculated in the same
way discussed in [21]. The histograms from [21] either do not have statistical uncertainties
at the source or the errors are too small for the digitizer software [30]. The systematic
uncertainty band for the Allpix2+TCAD shown in [21] is not overlaid here because it was
not possible to decipher it from the original plot.

simulation. In fact, the tracking detector simulation of the LUXE experi-
ment [12], which is to be built from the production version of the ALPIDE
sensors, is already using our EFF. The production version of the ALPIDE
has diﬀerent dimensions compared to the “investigator” chip used in [21].
Namely the pixel size is 29.24 × 26.88 µm2 in x × y and 50 µm deep in z

14

4-103-102-101-101Normalized entriesm)m=3.29 sData (Dannheim et al., m)m=3.60 s+TCAD (Dannheim et al., 2Allpixm)m=3.89 s+EFF (2Allpix40-30-20-10-010203040m)m (cluster - xtrackx01234Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2AllpixFigure 6: Left: the comparison of the mean cluster size behavior for diﬀerent thresh-
olds between our Allpix2+EFF simulation and the Allpix2+TCAD simulation (and the
beam-test data) from [21]. Right: the same comparison for the detection eﬃciency. The
bottom panels show the ratio of the Allpix2+TCAD (red) or data (black) results to the
Allpix2+EFF results. The graphs from [21] either do not have statistical uncertainties
at the source or the errors are too small for the digitizer software [30]. The systematic
uncertainty band for the Allpix2+TCAD shown in [21] is not overlaid here because it was
not possible to decipher it from the original plots. However, as one can see in [21], the
uncertainty on the Allpix2+TCAD is as high as 5-15% for the mean cluster size plot and
1-2% for the eﬃciency plot. The Allpix2+EFF uncertainties should be identical to those
(giving an overall uncertainty higher by a factor of

2).

√

with a depletion depth of 25 µm. The EFF for this version may therefore be
scaled naturally by changing the dimensions of the pixel, where eﬀectively
only the pitch very slightly changes and where the change in thickness has no
impact on the ﬁeld since it is only deﬁned within the depletion depth. The
diﬀerent thickness does impact, however, the performance that is checked
with the Allpix2 software, but this change is unrelated to the EFF. Finally,
we note that although we use the Allpix2 software extensively for the deriva-
tion and validation of our EFF, the resulting function can be interfaced also
with other software like [31] and it is not linked speciﬁcally to Allpix2.

15

0100200300400500600700Threshold (e)0.511.522.533.544.55Mean cluster sizeData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0100200300400500600700Threshold (e)0.9511.051.1Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2Allpix0100200300400500600700Threshold (e)0.80.850.90.9511.051.1EfficiencyData (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0100200300400500600700Threshold (e)0.9511.051.1Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2AllpixFigure 7: Left: the comparison of the resolution in x behavior for diﬀerent thresholds be-
tween our Allpix2+EFF simulation and the Allpix2+TCAD simulation (and the beam-test
data) from [21]. Right: the same comparison for the resolution in y. The bottom panels
show the ratio of the Allpix2+TCAD (red) or data (black) results to the Allpix2+EFF
results. The graphs from [21] either do not have statistical uncertainties at the source or
the errors are too small for the digitizer software [30]. The systematic uncertainty band
for the Allpix2+TCAD shown in [21] is not overlaid here because it was not possible to
decipher it from the original plots. However, as one can see particularly at the low end
of the thresholds range, (cid:46) 150 e, the uncertainty on the Allpix2+TCAD is as high as
5-15% in y. In x, at the same threshold range, the uncertainty is approximately constant
at ∼ 7%. The Allpix2+EFF uncertainty should be identical to that (giving an overall
uncertainty higher by a factor of
2). Hence, while the results in y are fully compatible
throughout the full threshold range, the results in x are compatible only above 80 e.

√

16

0100200300400500600700Threshold (e)34567m]mResolution in x [Data (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0100200300400500600700Threshold (e)11.21.4Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2Allpix0100200300400500600700Threshold (e)34567m]mResolution in y [Data (Dannheim et al.)+TCAD (Dannheim et al.)2Allpix+EFF2Allpix0100200300400500600700Threshold (e)11.21.4Ratio+EFF2Data/Allpix+EFF2+TCAD/Allpix2AllpixAcknowledgments

We wish to thank the colleagues from the ALICE ITS project for useful
discussions and help related to the ALPIDE sensors. We would like to es-
pecially thank Luciano Musa, Gianluca Aglieri Rinella, Antonello Di Mauro,
Magnus Mager, Corrado Gargiulo, Felix Reidt, Ivan Ravasenga, and Ruben
Shahoyan. We also wish to thank Simon Spannagel and Paul Sch¨utze for the
detailed and dedicated help and for the useful discussions about Allpix2 and
especially the work in [21].

This work is supported by a research grant from the Estate of Dr. Moshe
Gl¨uck, the Minerva foundation with funding from the Federal German Min-
istry for Education and Research, the ISRAEL SCIENCE FOUNDATION
(grant No. 708/20), the Anna and Maurice Boukstein Career Development
Chair, the Yeda-Sela SABRA (Supporting Advanced Basic Research) fund.

References

[1] Synopsys, Oﬃcial website, https://www.synopsys.com/company.html

(2022).

[2] Silvaco, Oﬃcial website, https://silvaco.com/tcad/ (2022).

[3] W. Snoeys, Monolithic pixel detectors for high energy physics, Nucl.
Instrum. Meth. A 731 (2013) 125–130. doi:10.1016/j.nima.2013.05.
073.

[4] M. Mager, ALPIDE, the Monolithic Active Pixel Sensor for the ALICE
ITS upgrade, Nucl. Instrum. Meth. A 824 (2016) 434–438. doi:10.
1016/j.nima.2015.09.057.

[5] ALICE Collaboration, Expression of Interest for an ALICE ITS Upgrade

in LS3, ALICE-PUBLIC-2018-013 (2018).

[6] G. Aglieri Rinella, The ALPIDE pixel sensor chip for the upgrade of
the ALICE Inner Tracking System, Nucl. Instrum. Meth. A 845 (2017)
583–587. doi:10.1016/j.nima.2016.05.016.

[7] S. Kushpil, F. Krizek, A. Isakov, Recent Results From Beam Tests of
the ALPIDE Pixel Chip for the Upgrade of the ALICE Inner Tracker,

17

IEEE Trans. Nucl. Sci. 66 (11) (2019) 2319–2323. doi:10.1109/TNS.
2019.2945234.

[8] S. Senyukov, J. Baudot, A. Besson, G. Claus, L. Cousin, A. Dorokhov,
W. Dulinski, M. Goﬀe, C. Hu-Guo, M. Winter, Charged particle detec-
tion performances of CMOS pixel sensors produced in a 0.18νm process
with a high resistivity epitaxial layer, Nucl. Instrum. Meth. A 730 (2013)
115–118. arXiv:1301.0515, doi:10.1016/j.nima.2013.03.017.

[9] ALICE Collaboration, The ALICE experiment at the CERN LHC,
JINST 3 (2008) S08002. doi:10.1088/1748-0221/3/08/S08002.

[10] TowerJazz, Oﬃcial website, https://towersemi.com/ (2022).

[11] B. Abelev, et al., Technical Design Report for the Upgrade of the ALICE
Inner Tracking System, J. Phys. G 41 (2014) 087002. doi:10.1088/
0954-3899/41/8/087002.

[12] LUXE Collaboration, Conceptual design report for the LUXE experi-
ment, Eur. Phys. J. ST 230 (11) (2021) 2445–2560. arXiv:2102.02032,
doi:10.1140/epjs/s11734-021-00249-z.

[13] sPHENIX Collaboration, An Upgrade Proposal from the PHENIX Col-

laboration (1 2015). arXiv:1501.06197.

[14] C. Dean, The sPHENIX experiment at RHIC, PoS ICHEP2020 (2021)

731. doi:10.22323/1.390.0731.

[15] DESY, The ALPIDE-based new telescope at DESY’s beam-teast facility

(TO APPEAR SOON) (2022).

[16] R. Iuppa, S. Beol´e, S. Coli, G. Gebbia, E. Ricci, S. Ricciarini, E. Serra,
P. Zuccon, L. de Cilladi, The innovative particle tracker for the HEPD
space experiment onboard the CSES-02, PoS ICRC2021 (2021) 070.
doi:10.22323/1.395.0070.

[17] G. Tambave, et al., Characterization of monolithic CMOS pixel sen-
sor chip with ion beams for application in particle computed tomogra-
phy, Nucl. Instrum. Meth. A 958 (2020) 162626. doi:10.1016/j.nima.
2019.162626.

18

[18] J. Alme, et al., A High-Granularity Digital Tracking Calorime-
in Physics 8 (2020).

ter Optimized for Proton CT, Frontiers
doi:10.3389/fphy.2020.568243.
URL
2020.568243

https://www.frontiersin.org/articles/10.3389/fphy.

[19] S. Spannagel, K. Wolters, D. Hynds, N. Alipour Tehrani, M. Benoit,
D. Dannheim, N. Gauvin, A. N¨urnberg, P. Sch¨utze, M. Vicente Bar-
reto Pinto, Allpix2: A Modular Simulation Framework for Silicon Detec-
tors, Nucl. Instrum. Meth. A 901 (2018) 164–172. arXiv:1806.05813,
doi:10.1016/j.nima.2018.06.020.

[20] P. Sch¨utze, S. Spannagel, K. Wolters, Allpix2 user manual, version
https://project-allpix-squared.web.cern.ch/usermanual/allpix-

v2.3.1,
manual.pdf (2022).

[21] D. Dannheim, K. Dort, D. Hynds, M. Munker, A. N¨urnberg, W. Snoeys,
S. Spannagel, Combining TCAD and Monte Carlo Methods to Simulate
CMOS Pixel Sensors with a Small Collection Electrode using the Allpix2
Squared Framework, Nucl. Instrum. Meth. A 964 (2020) 163784. arXiv:
2002.12602, doi:10.1016/j.nima.2020.163784.

[22] D. Dannheim, et al., Comparison of small collection electrode CMOS
pixel sensors with partial and full lateral depletion of the high-resistivity
epitaxial layer, Nucl. Instrum. Meth. A 927 (2019) 187–193. doi:10.
1016/j.nima.2019.02.049.

[23] R. Brun, F. Rademakers, P. Canal, A. Naumann, O. Couet, L. Moneta,
V. Vassilev, S. Linev, D. Piparo, G. GANIS, B. Bellenot, E. Guiraud,
G. Amadio, wverkerke, P. Mato, TimurP, M. Tadel, wlav, E. Tejedor,
J. Blomer, A. Gheata, S. Hageboeck, S. Roiser, marsupial, S. Wunsch,
O. Shadura, A. Bose, CristinaCristescu, X. Valls, R. Isemann, root-
project/root: v6.18/02, 10.5281/zenodo.3895860 (Aug. 2019).
URL https://doi.org/10.5281/zenodo.3895860

[24] A. Santra, N. Tal Hod, Code for the generation of the eﬀective ﬁeld
function of the alpide sensor, https://github.com/noamhod/ALPIDE.
EField (2022).

[25] S. Agostinelli, et al., GEANT4–a simulation toolkit, Nucl. Instrum.
Meth. A 506 (2003) 250–303. doi:10.1016/S0168-9002(03)01368-8.

19

[26] J. Allison, et al., Geant4 developments and applications, IEEE Trans.

Nucl. Sci. 53 (2006) 270. doi:10.1109/TNS.2006.869826.

[27] J. Allison, et al., Recent developments in Geant4, Nucl. Instrum. Meth.

A 835 (2016) 186–225. doi:10.1016/j.nima.2016.06.125.

[28] R. M. Muenker, Test beam and simulation studies on High Resistivity

CMOS pixel sensors, Ph.D. thesis, U. Bonn (main) (2018).
URL https://inspirehep.net/literature/1782549

[29] I. Kremastiotis, R. Ballabriga, K. Dort, N. Egidos, M. Munker,
CLICTD: A monolithic HR-CMOS sensor chip for the CLIC silicon
tracker, PoS TWEPP2019 (2020) 039. arXiv:2004.02537, doi:10.
22323/1.370.0039.

[30] A. Rohtagi, Webplotdigitizer: Version 4.5, https://automeris.io/

WebPlotDigitizer (2021).

[31] M. ˇSulji´c, P. Camerini, J. W. van Hoorne, Monte Carlo simulation of
charge collection processes in Monolithic Active Pixel Sensors for the
ALICE ITS upgrade, Nucl. Instrum. Meth. A 950 (2020) 162882. doi:
10.1016/j.nima.2019.162882.

20

