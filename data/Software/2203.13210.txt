2
2
0
2

r
a

M
4
2

]
E
M

.
t
a
t
s
[

1
v
0
1
2
3
1
.
3
0
2
2
:
v
i
X
r
a

A comparison of two frameworks for multi-state
modelling, applied to outcomes after hospital
admissions with COVID-19

Christopher H. Jackson1, Brian D. M. Tom1, Peter D. Kirwan1,2, Sema
Mandal2, Shaun R. Seaman1, Kevin Kunzmann1, Anne M. Presanis1,
and Daniela De Angelis1,2

1MRC Biostatistics Unit, University of Cambridge
2Public Health England

Abstract

We compare two multi-state modelling frameworks that can be used to rep-
resent dates of events following hospital admission for people infected during an
epidemic. The methods are applied to data from people admitted to hospital with
COVID-19, to estimate the probability of admission to ICU, the probability of
death in hospital for patients before and after ICU admission, the lengths of stay in
hospital, and how all these vary with age and gender. One modelling framework
is based on deﬁning transition-speciﬁc hazard functions for competing risks. A
less commonly used framework deﬁnes partially-latent subpopulations who will
experience each subsequent event, and uses a mixture model to estimate the prob-
ability that an individual will experience each event, and the distribution of the
time to the event given that it occurs. We compare the advantages and disadvan-
tages of these two frameworks, in the context of the COVID-19 example. The
issues include the interpretation of the model parameters, the computational ef-
ﬁciency of estimating the quantities of interest, implementation in software and
assessing goodness of ﬁt. In the example, we ﬁnd that some groups appear to be
at very low risk of some events, in particular ICU admission, and these are best
represented by using “cure-rate” models to deﬁne transition-speciﬁc hazards. We
provide general-purpose software to implement all the models we describe in the
flexsurv R package, which allows arbitrarily-ﬂexible distributions to be used
to represent the cause-speciﬁc hazards or times to events.

1

Introduction

For emerging infectious diseases such as coronavirus disease 2019 (COVID-19), the se-
vere acute respiratory illness following infection with the SARS-CoV-2 virus, a prompt
understanding of disease severity and healthcare resource use are essential to inform-
ing government response. Of particular interest are the probability that a person just

1

 
 
 
 
 
 
admitted to hospital will be admitted to an intensive care unit (ICU), the probability of
death in hospital before or after ICU admission, and the predicted length of stay in hos-
pital, or average times between these events. Accurate estimates of these quantities are
required both for direct policy-making, and to include in larger models that combine
these estimates with other sources of data (e.g. on transmission and risk of hospitalisa-
tion) to predict outcomes for wider populations De Angelis and Presanis [2019], Birrell
et al. [2020].

These quantities can typically be estimated from data on people hospitalised with
the infection. These data usually consist of dates of admission, discharge, and in-
hospital events such as admission to ICU. The follow-up is commonly incomplete, i.e.
it ends while patients are still in hospital, and even during follow-up, the occurrence
of events and their dates may be incompletely recorded. This form of data is generally
described as multi-state data, in which a set of individuals, sharing the same starting
state, are followed up through time. For each individual, we might observe the time and
state of their next transition, or observe that they have remained in the same state up
to a particular time. In the latter case, the time of the next transition is right-censored
and the state they next move to is unknown. After a transition is observed, there may
be onward transitions to further states observed in the same manner.

Two different modelling frameworks have been used to represent this kind of data.
The most commonly used method to represent transitions in multi-state data is based on
cause-speciﬁc hazards of competing risks Prentice et al. [1978], Andersen et al. [2002],
Andersen and Keiding [2002]. These models are deﬁned by hazards or intensities
λrs(t) representing the risk of transition to state s for a person in state r at a time
t. These can be interpreted as deﬁning distributions for latent times Ts to competing
events s for an individual, with the minimum of the Ts deﬁning the transition that
happens. Putter et al. Putter et al. [2007] present a tutorial for nonparametric and
semi-parametric competing risks and multi-state models, while Crowther and Lambert
Crowther and Lambert [2017] describe a ﬂexible framework for multi-state modelling
based on a range of parametric distributions. Ieva et al. Ieva et al. [2017] present a case
study of multi-state modelling of hospital admission data using both semi-parametric
and Weibull parametric models.

A less common approach is based on mixture models. This was used by Ghani et al.
Ghani et al. [2005] and Donnelly et al. Donnelly et al. [2003] in a context that is similar
to our application, to estimate probabilities of death and recovery, and times to these
events, for people with an infectious disease. Each individual’s next state is assumed to
be s with probability ps, where s = 1, 2 represent death and recovery, so that p1 is the
case fatality ratio, and p1 + p2 = 1. Then for each s, a parametric model is speciﬁed
for the time Ts until the event, given that s is the event that occurs. Since the next
state is unknown for individuals whose transition time is right-censored, the likelihood
for the ps and the parameters of the time-to-event models takes the form of a mixture
model with partially-known component membership. This model was described in
more generality by Larson and Dinse Larson and Dinse [1985], who represented S
states, and included covariates both on the event probabilities and on the models for
times to events. These models include our quantities of interest as explicit parameters,
and have been used with ﬂexible component-speciﬁc distributions [Lau et al., 2011],
though have not been used, as far as we know, to represent multi-state models with

2

onward transitions following the ﬁrst transition.

These approaches to competing risks were contrasted by Cox Cox [1959] (with
two events and exponentially-distributed times) who suggested either approach could
be used to construct an arbitrarily-ﬂexible model. However they have not been com-
pared in practice in the context of general fully-parametric multi-state models. Lau et
al. Lau et al. [2009] advocated mixture models, compared to semiparametric propor-
tional cause-speciﬁc hazard models, for describing the associations of covariates with
the risk of competing outcomes, but did not consider fully-parametric cause-speciﬁc
hazard models. In our application, we focus on parametric models, to stabilise esti-
mation in periods where the data are sparse, enable short-term extrapolation beyond
the end of the data, and to provide explicitly parametric inputs for epidemic models,
based on Bayesian evidence synthesis, that are designed to inform policy for wider
populations De Angelis and Presanis [2019], Birrell et al. [2020].

In this paper, we compare the practical use of these two different frameworks for
fully-parametric multi-state modelling, in the context of an application to COVID-19
hospital admissions. We consider their interpretation, the ease of model speciﬁcation,
their computational efﬁciency, implementation in software, and assessing their good-
ness of ﬁt to the data. A novel modiﬁcation to the likelihood in both frameworks was
required to represent partially-observed ﬁnal outcomes, where patients are known to
be alive but with unknown hospitalised status. We develop the ﬁrst general-purpose
software implementation of the mixture multi-state model, in the flexsurv package
for R Jackson [2016], and facilities in that package for multi-state models with cause-
speciﬁc hazards are extended, e.g.
to handle different distribution families for each
transition Crowther and Lambert [2017].

A feature of our data is that there are subsets of patients who appear to be at very
small risks of particular events. These are handled naturally by the mixture model,
which is parameterised by probabilities of events. To characterise these data within the
cause-speciﬁc hazards framework, we use cure (also known as mixture cure) distribu-
tions to represent one or more of the latent event times Tk. Originating from Boag Boag
[1949], these are used to describe populations with a disease (typically cancer) where
a latent proportion are cured and never die from the disease. They are typically ﬁtted
to data where either the time of death or a right-censoring date is observed, but cure or
time to cure cannot be observed directly Farewell [1982], Jakobsen et al. [2020]. The
cured fraction and distribution of the time to death among the non-cured fraction are
estimated jointly. As in Conlon et al. Conlon et al. [2014], we use cure distributions as
cause-speciﬁc hazards in a competing risks model. Note the distinction from the mix-
ture multi-state model of Larson and Dinse Larson and Dinse [1985], in which the time
of achieving “immunity” from death (e.g. recovery or cure) can be observed, and the
model aims to describe this time, as well as the probability of the event. While Ghani
et al. Ghani et al. [2005] referred to their model as a “cure” model, it is an example
of the mixture multi-state model rather than the Boag Boag [1949] model, since both
competing events (death and recovery) were observable.

In Section 2 we describe the motivating COVID-19 hospital admissions dataset.
Section 3 sets out the theoretical deﬁnitions of the two alternative multi-state modelling
frameworks and how the quantities of interest are deﬁned and computed. The models
are applied to the COVID-19 hospital data in Section 4, and the ﬁt and interpretations

3

of the best of both types of parametric model are compared. While the mixture model
is simpler to interpret and involved less computation to obtain the the quantities of
interest, the ﬁt in the COVID-19 example was best for the cause-speciﬁc hazards model
with mixture-cure distributions. Section 5 concludes the paper with a discussion of the
merits of the two frameworks and the open issues.

2 CHESS: hospital admissions data from COVID-19

patients

Data were extracted from the COVID-19 Hospitalisation in England Surveillance Sys-
tem (CHESS), established and managed by Public Health England (PHE) [Public Health
England, 2020a]. CHESS began in mid-March 2020 and aims to monitor the impact
of severe COVID-19 infection on the population and on health services and provide
real-time data to forecast and estimate disease burden and health service use. CHESS
is a mandatory data collection system [Public Health England, 2020b] and captures
individual-level data on all patients admitted to ICU or HDU (high dependency unit)
with COVID-19 at National Health Service (NHS) Trusts in England, in addition to
data from all hospital admissions with COVID-19 from the 22 out of 107 trusts that
were designated as “sentinel” trusts, representing 26% of hospital admissions. Col-
lected data include patient demographics, risk factors, clinical information on severity,
and outcome. CHESS data covering the period from 15 March to 2 August 2020 were
extracted at PHE and linked using NHS number to the Ofﬁce for National Statistics
(ONS) deaths register to obtain complete information for deaths occurring both within
and outside of hospital.

There are 5544 hospital admission records from sentinel trusts in CHESS from peo-
ple known to have tested positive for COVID-19 infection up to 2 days after admission,
who are assumed to have been infected outside hospital. People who were infected with
COVID-19 while in hospital for another condition are excluded, as there is insufﬁcient
information to determine how much of their hospital stay was due to COVID-19. From
the 5544 records, we excluded 74 patients, including those with missing or inconsis-
tent dates of ICU admission, or missing information on age or gender, leaving 5470
hospital admissions. The ﬁnal outcomes from these patients, and whether they were
admitted to ICU, are counted in Table 1. In around 10% of cases, whether the patient
died in hospital care, or was discharged, is not yet observed or unknown, noting that
people recorded as “transferred” are still in hospital care. The people with “unknown”
ﬁnal outcome are known to be still alive, and it is assumed that if they went to ICU
then this was recorded, but it is not known whether they are still in hospital at the date
of data extraction.

The data on the next event following hospital admission are illustrated further by
age and gender in Figure 1 and Figure 2. Figure 1 illustrates the proportions expe-
riencing each next event, while Figure 2 shows the distribution of the times to each
kind of observed event after admission, the times to right-censoring for those known
to be still in hospital, and the times from admission to data extraction for those with
unknown outcome. Note that a substantial number of people are still in hospital care

4

Admitted to ICU Died Discharged Still in unit

Transferred Unknown

Total

Yes

No

Total

418

476

1221

2780

1639
(30%)

3256
(59%)

39

138

104

198

ﬁnal
outcome
32

83

177 (3%)

302 (6%)

115 (2%)

1069
(19%)
4420
(81%)
5489

Table 1: Summary of events in CHESS data

after around 50 days in hospital, which is extreme compared to the distributions of the
times to the observed events. The probabilities and average times of events could be in-
ferred directly from these summaries, but the estimates would be biased as they would
ignore the information from the censored times, which indicate longer hospital stays,
and people with unknown outcome. Therefore likelihood-based statistical models are
constructed.

3 Multi-state modelling frameworks

A parametric, continuous-time, semi-Markov multi-state model is used with four states,
represented in Figure 3. This comprises two submodels representing “competing risks”
of the next event: one for the event following hospital admission, and another for the
event following ICU admission. Note that in practice, individuals will be discharged
from ICU to a hospital ward, but since dates of leaving ICU are only partially recorded
in this dataset, we simply combine the ICU state with the state of being in a hospital
ward after leaving ICU, so the “ICU” state represents “in hospital, and has been ad-
mitted to ICU”, rather than “in hospital and currently in ICU”. Individual i’s transition
intensity from state r to state s, at a time t after entering state r, is denoted by λi,r,s(t).
Note the common Markov assumption has been relaxed, thus the intensities are allowed
to depend on how long a person has spent in the current state. Two alternative model
parameterisations are used, termed cause-speciﬁc hazards and mixture model formula-
tions. These differ in how the transition intensities are deﬁned, but they can both be
used to estimate our principal quantities of interest, which are:

1. The next-state probability πrs: the probability that the next state visited after

state r is state s.

2. The distribution of the conditional length of stay Sr,s, the time to state s for
a person who has just entered state r, given that a transition to state s occurs.
The mean of this distribution might be used to describe expected total hospital
resource usage for a population. The variability between individuals in length of
stay could be described by quantiles of the distribution of Sr,s.

5

Figure 1: Distribution of next event following hospital admission, or following ICU
admission, by age group and gender, as a simple summary of the data.

6

After hospital admissionAfter ICU admissionFemaleMale[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+02505007500250500750Age groupNumber of admissionsNext eventDeathDischargeICUStill in hospital careUnknown final outcomeFigure 2: Distribution of times to next event following hospital admission, by age group
and gender, as a standard histogram of the data, including times to right-censoring for
those still in hospital, or times to data extraction for those with unknown outcome.

7

Unknown final outcomeICUStill in hospital careDeathDischarge020406080100120020406080100120[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Days since hospital admissionStill in hospital careUnknown final outcomeDeathDischarge020406080100120020406080100120[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Days since ICU admission3. The ultimate-outcome probabilities π(U )

, the probability that the the ultimate
s
outcome for a person just admitted to hospital is state s, which can only be death
or discharge (the absorbing states of the model).

4. The distribution of the conditional time to ultimate outcome Us, the time to an

ultimate outcome s of death or discharge, given that this outcome occurs.

In general, any summary of the distribution of state transitions and times to events

can be computed by simulation, but some quantities will be available analytically.

1. Hospital

2. ICU

3. Death

4. Dis-
charge

Submodels

From hospital

From ICU

Figure 3: Multi-state model. Permitted instantaneous transitions between states indi-
cated by arrows.

3.1 Cause-speciﬁc hazards model

In a competing risks model speciﬁed through cause-speciﬁc hazardsPrentice et al.
[1978], Andersen and Keiding [2002], Putter et al. [2007] at time t after entering state
r, an individual is subject to a risk of transition to any state s allowed by the model
structure, so that λi,r,s(t) > 0 only if s is in the set Sr of potential next states after
state r (indicated by the arrows in Figure 3). For example, a person currently in ICU
could either die or be discharged at any time, but may not return to the “hospital” state.
The transition intensity λi,r,s(t) can be interpreted as the hazard function of a paramet-
ric distribution that governs a (latent) time Tr,s from state r entry until the transition
to state s. Only one of these competing transitions will actually happen, that is, the
one that happens ﬁrst, to state s(∗)
r = argminu∈Sr {Tru}. In this formulation, the
quantities of interest are deﬁned as follows.

Conditional length of stay This is

Srs = (Trs|s(∗)

r = s) = (Trs|minu∈Sr {Tru} = Trs)

the random variable whose distribution is the conditional distribution of Trs given that
the transition from state r to state s occurs.

8

Next-state probabilities πrs are determined by considering the implicit “compet-
ing risks” submodels that deﬁne the full multi-state model, one submodel governing
each state that a person can transition from.
In Figure 3 there are two submodels,
one governing the next state after hospital admission, and one for the next state after
ICU admission. These are indicated by dashed lines and dotted lines respectively. In
the hospital submodel, death before ICU, ICU admission and discharge before ICU
are treated as “absorbing” states (which individuals cannot leave), while in the ICU
submodel, the absorbing states are death and hospital discharge folllowing ICU admis-
sion. Then the continuous-time transition probabilities of the full multi-state model
and a particular submodel (labelled M ) are deﬁned respectively as:

• pr,s(t), the probability that an individual in state r occupies state s at a time t

after entering state r

• p(M )

r,s (t), the probability that an individual currently in state r of submodel M is
in state s of the submodel at at time t later — i.e. the probability that a person
has experienced the competing risk s, or, that they have entered the equivalent
state of the full multi-state model some time in the past.

In the COVID-19 example, we have probabilities p(H)
r,s (t) for the states at time
t after hospital and ICU admission within the hospital and ICU submodels respectively.
The next-state probabilities after r = hospital are then πr,s(t) = limt→∞p(H)
r,s (t), and
the probabilities for the next state after r = ICU are πr,s(t) = limt→∞p(I)
r,s (t).

r,s (t), p(I)

Ultimate outcomes Similarly, the ultimate-state probabilities are determined from
the transition probabilities of the full multi-state model as π(U )
s = limt→∞pr,s(t) for
r = Hospital. The conditional time Us to an ultimate outcome s, conditionally on
this outcome occuring, is deﬁned by ﬁrst identifying all pathways P through the states
that end in outcome s. In this example, there are only two pathways from hospital to
death or discharge: where ICU was visited or wasn’t visited. Us is then deﬁned by
s = (cid:80)
calculating the total time taken to travel each pathway, U (P)
(r,s(cid:48))∈P Sr,s(cid:48), then
averaging with respect to the probability of each pathway: Us = (cid:80)
P U (P )
s P r(P).

Computation of quantities of interest The next-state probabilities are calculated as
follows. The transition probabilities for the two sub-models are related to the transition
intensities through the Kolmogorov forward equation:

dP (H)(t)
dt

= P (H)(t)Q(H)(t),

dP (I)(t)
dt

= P (I)(t)Q(I)(t)

where P (H)(t), P (I)(t) are the matrices with r, s entry p(H)
r,s (t), respectively,
and Q(H)(t) and Q(I)(t) are the transition intensity matrices of the hospital and ICU
submodels, with r, s entry given by λi,r,s(t) for r (cid:54)= s, where r and s index the states
in each submodel. The diagonal entries of the intensity matrix are then deﬁned so that
the rows sum to zero. The initial condition for the equation in each case is a transition
probability matrix deﬁned by the identity matrix at t = 0. The Kolmogorov forward

r,s (t), p(I)

9

equation is solved numerically using the R package deSolve [Soetaert et al., 2010],
giving estimates of all p(H)
r,s (t), hence (by choosing a very large value of t)
estimates of πr,s.

r,s (t) and p(I)

s

The distribution of the conditional lengths of stay Sr,s, the ultimate-outcome prob-
abilities π(U )
, and the distribution of the conditional times to ultimate outcome Us, are
all determined by simulation. State transition histories (until death or discharge) are
simulated from the ﬁtted model for a large population, and the resulting sample is sum-
marised to give the quantities of interest. The next event and the time to this event for
a person in state r is simulated by generating latent times Trs from each cause-speciﬁc
distribution s implied by the hazards λrs(t), with the minimum of the competing times
deﬁning the one that happens.

3.2 Mixture multi-state model

In the “mixture” competing risks model [Larson and Dinse, 1985], extended here to a
general multi-state model, each individual i in state r makes a transition to a destination
state s that is determined randomly at time 0. Thus their transition intensity at time t
after state r entry is deﬁned by

λi,r,s(t) =

i,r,s(t)

(cid:26) λ∗
0

if Ii,r = s
if Ii,r (cid:54)= s

s∈Sr

πr,s = 1. The transition intensity λ∗

where Ii,r is a latent categorical variable that determines which transition will happen
next for an individual i in state r, governed by probabilities πr,s = P (Ii,r = s), with
(cid:80)
i,r,s(t) is deﬁned by the hazard function of a
parametric distribution that governs the time Sr,s from state r entry until the transition
to state s, given that this is the transition that occurs. Unlike in the cause-speciﬁc
hazards model, we do not model the times to events that don’t occur.

3.3 Data and likelihoods

Observations of the event times or censoring times from individual i are indexed by j.
Each observation is one of three types, indicated by a “status” δi,j.

• exact transition time: Yi,j = {yi,j, ri,j, si,j, δi,j = 1}, where a transition to

state si,j is known to occur at a time yi,j after entry to state ri,j.

• right censoring Yi,j = {yi,j, ri,j, δi,j = 2}, where an individual’s follow-up
ends while they are in state ri,j, at time yi,j after entering this state, thus the next
state and the time of transition to it are unknown.

• partially-known outcomes Yi,j = {yi,j, ri,j, δi,j = 3}, from individuals known
to be alive, where it is assumed known whether or not they went to ICU, but it is
unknown whether they are still in hospital at time yi,j after entry to state ri,j, or
were discharged at some time before yi,j.

10

Cause-speciﬁc hazards model We use the likelihood as in Prentice et al. Prentice
et al. [1978], extended to handle partially-known outcomes. To construct this, ﬁrst
write the r → s transition intensity for individual i as λi,r,s(t) = hr,s(t|θ, zi), where
zi is a vector of individual-speciﬁc, time-constant covariates, θ is a vector including
all parameters of the parametric distribution with hazard of the form hr,s(t) and ef-
fects of covariates on the parameters, and θr,s indicates the speciﬁc elements of θ
that pertain to the r, s transition. The likelihood is constructed without reference to
latent event times Trs, thus does not assume, e.g. that these are independent. Denote
the corresponding probability density function and cumulative distribution function as
fr,s(t), Fr,s(t) respectively (omitting the conditioning for clarity). Then the jth obser-
vation from individual i contributes the following term li,j to the likelihood:

• For exact transition times, δi,j = 1,

li,j = fri,j ,si,j (yi,j|θri,j ,si,j )

(cid:89)

(cid:0)1 − Fri,j ,u(yi,j|θri,j ,u)(cid:1).

u∈Sri,j ,u(cid:54)=si,j

The ﬁrst term represents the transition that was observed at yi,j, and the second
term represents the knowledge that the individual was at risk of transition to the
competing states u, but these transitions didn’t happen by time yi,j. In other
words, there are right-censored times of transition to each of these states u.

• For observations of right-censoring, δi,j = 2,

(cid:89)

li,j =

(cid:0)1 − Fri,j ,u(yi,j|θri,j ,u)(cid:1)

u∈Sri,j

representing the knowledge that the individual was at risk of all potential transi-
tions from state ri,j, but none of these happened by time yi,j.

• For individuals with partially-known outcomes, where it is known they are alive
and it is known whether they went to ICU or not, the times to death or discharge
are right-censored. Since we do not know whether they have been discharged
before time yi,j, or if they are still in hospital (thus with discharge time right-
censored at yi,j), they do not provide any information about the distribution of
(potential) discharge times. Therefore, their likelihood contribution is

li,j = 1 − Fr,u(yi,j|θr,u)

where r denotes either a transition from hospital or a transition from ICU, and
u = death.

The full likelihood is l(θ|Y) = (cid:81)

i,j li.j(θ|Yi,j) over all individuals i and obser-
vations j, where Y is the complete data. To facilitate computation, however, we write
the full likelihood as a product of terms speciﬁc to each r, s transition Andersen and
Keiding [2002].

11

l(θ|Y) =

l∗
r,s(θr,s|Y)

(cid:89)

r,s

This is possible since, for each r, s transition, we use parametric models with distinct
parameters θr,s (and potentially also different distributional forms). The full multi-
state model can then be ﬁtted by maximising each of the transition-speciﬁc likelihoods
independently, using separate calls to a survival modelling function.

Mixture multi-state model The likelihood presented by Larson and Dinse Larson
and Dinse [1985] for competing risks can be extended easily to a full multi-state model.
Firstly deﬁne again πr,s as the probability that the next transition for someone in state
r is to state s. Then we specify a parametric distribution with density fr,s(|θr,s) (and
CDF Fr,s()) for the time of transition to state s for a person in state r, conditionally on
this transition being the one that occurs. Therefore, for an exact time of transition to a
known state si,j, i.e. δi,j = 1, the likelihood contribution is simply

li,j = πri,j si,j fri,j ,si,j (yi,j|θri,j ,si,j )

For observations j of right-censoring at yi,j, the state that the person will move to,
and the time of that transition, is unknown. Thus it is unknown which of the distribu-
tions fr,s the transition time will obey, and the likelihood contribution is of the form of
a mixture model:

li,j =

(cid:88)

s∈Sr

πri,j s(1 − Fri,j ,s(yi,j|θri,j ,s))

For patients with partial outcomes, the likelihood is as for right-censoring, except
that the term for s = Discharge is simply πri,j ,s, as there is no information about
discharge times for these patients.

The full likelihood is L(π, θ|Y) = (cid:81)

i,j li,j, where π includes all the next-state
probabilities πr,s, and θ includes the parameters of the time-to-transition distributions,
which may include the effects of covariates. The πr,s may further depend on covariates,
e.g. through a multinomial logistic regression model Larson and Dinse [1985].

3.4 Parametric distributions and implementation

The cause-speciﬁc hazards models can be ﬁtted in standard survival modelling soft-
ware. We use the flexsurv package in R, extending it to handle different distribu-
tion familes for different transitions. Similar facilities are available in Stata Crowther
and Lambert [2017, 2014]. The flexsurv package was also extended here to imple-
ment the likelihood for the mixture multi-state model. Note that the mixture likelihood
needs to be maximised over many more parameters than the likelihood of a compara-
ble cause-speciﬁc hazards model, since it does not factorise into independent terms for
each component. An EM algorithm Larson and Dinse [1985] was used to maximise the

12

likelihood, which was found to be more efﬁcient than direct maximisation. An imple-
mentation of the mixture model, restricted to two competing events and with a limited
choice of distributions, is also available in the R package RISCA Foucher et al. [2020].
Each model formulation requires the choice of a parametric model for the time to
an event. A wide range of ﬂexible distributions are used in practice and are available
in flexsurv, which also allows users to implement new distributions. Covariates
may be included on any parameter of any distribution through a linear model (on the
log scale if the parameter is deﬁned to be positive). A particularly useful form is the
generalized gamma distribution, which, in the parameterisation from Prentice Prentice
[1974], includes the log-normal, Weibull and gamma distributions as special cases. The
cumulative distribution function is

F (t|µ, σ, Q) =

FG(exp(Qw)/(Q2) | 1/Q2, 1)
1 − FG(exp(Qw)/(Q2) | 1/Q2, 1)
FL(t | µ, σ)

(Q > 0)
(Q < 0)
(Q = 0)

where w = (log(t)−µ)/σ, FG(t|a, b) is the CDF of the gamma distribution with shape
a and rate b, FL(t|µ, σ) is the CDF of the log-normal distribution with log-scale mean
µ and standard deviation σ, µ, Q are unrestricted, and σ is positive.

For the data in this example, we also use mixture cure distributions Boag [1949].
These are deﬁned by extending a standard parametric time-to-event distribution F (t|θ)
to include a probability p that the event never occurs, obtaining a model

P r(T ≤ t|p, θ) = (1 − p)F (t|θ)

This model may be extended to include covariates that explain the “cure” probability
p, through logistic regression. The flexsurvcure package Amdahl [2020] is used
to facilitate the implementation of the cure model in flexsurv.

3.5 Model selection

For both the mixture model and the cause-speciﬁc hazards / competing risks model, a
well-ﬁtting parametric model was selected by the following procedure, on the basis of
Akaike’s information criterion (AIC).

In the mixture models, all models included age group and gender as additive co-
variate effects on the (multinomial) logit component membership probability. The
component-speciﬁc time-to-event model was selected by starting with a generalised
gamma distribution with constant parameters, then comparing against simpler gamma,
Weibull and log-normal models, and against more complex models where one or more
of the generalised gamma parameters also depended on age and gender.

In the cause-speciﬁc hazards models, we started with generalised gamma distribu-
tions for each cause-speciﬁc hazard, with a location parameter that depended on age
and gender. This model was then compared with simpler gamma, Weibull and log-
normal models, and more complex models where the second or third parameter of the
generalised gamma also depended on age and gender. Models with a “cure fraction”
(potentially depending on age and gender) were also investigated to describe a pro-
portion of people at negligible risk of ICU admission or death. A cure fraction for

13

Transition
From hospital:
To ICU
To death
To discharge
From ICU:
To death
To discharge
Total AIC

Cause-speciﬁc hazards
Distribution

Mixture multistate

Covariates on Distribution

Covariates on

(AIC 37463)

Log-normal cure
Generalised gamma cure
Generalised gamma

(AIC 8355)

Generalised gamma cure
Generalised gamma

p
p, µ
µ, σ

p, µ
µ

(AIC 38514)
µ
Log-normal
Generalised gamma µ
Generalised gamma µ
(AIC 8348)
Generalised gamma µ
Generalised gamma µ

45817 (58 parameters)

46862 (52 parameters)

Table 2: Selected parametric assumptions for the cause-speciﬁc hazards and mixture
multistate models. All mixture multistate models also include age and gender covari-
ates on the probabilities πrs.

discharge as well was judged to be implausible, so that while some people will never
go to ICU or die from their current infection, all survivors are assumed to eventually
leave hospital.

Interactions between age and gender were also investigated in both frameworks.

4 Application of the models to the COVID-19 hospital

data

4.1 Model checking

The best-ﬁtting among the mixture models and cause-speciﬁc hazards models, judging
from AIC, are described in Table 2. The best ﬁtting cause-speciﬁc hazards model has
a lower AIC compared to the best-ﬁtting mixture model, which is driven by the better
ﬁt of the cause-speciﬁc model for the events following hospital. After investigating for
interactions, effects of age and sex were included as additive in all models.

The ﬁt of the models can also be compared for speciﬁc subgroups of the data. Table
3 shows the difference between the log-likelihood of the cause speciﬁc hazards model
and the likelihood of the mixture model, for each age/sex subgroup of the data, and
for the hospital and ICU-speciﬁc submodels and both combined. The better ﬁt of the
cause-speciﬁc hazards model overall is due to its better ﬁt in the the hospital-speciﬁc
submodel, while the two models ﬁt similarly well for transitions from ICU. In the hos-
pital submodel, within each subgroup, the log-likelihood of the cause-speciﬁc hazards
model is greater, showing better ﬁt. While these subgroup-speciﬁc comparisons do not
account for the difference in model complexity (as in AIC), there is no evidence that
the mixture model should be preferred for describing any particular age/sex subgroup.
The ﬁt of the models can be checked against nonparametric estimates in various
ways. Note that nonparametric estimates are only available up to the maximum ob-
served follow-up in the data, while the parametric models allow extrapolation beyond
that time.

14

Sex
Female

Age group
44 and under
44 and under Male
45-64
45-64
65-74
65-74
75-84
75-84
85+
85+

Female
Male
Female
Male
Female
Male
Female
Male

From hospital
24.7
46.2
54.6
196.1
32.4
89.3
7.4
46.8
9.4
24.5

From ICU Combined
-1.27
-0.14
-0.37
-0.87
-0.44
-0.21
-0.05
-0.61
0.35
0.31

23.4
46.1
54.2
195.2
32
89.1
7.4
46.2
9.8
24.8

Table 3: Relative ﬁt of the cause-speciﬁc hazards model compared to the mixture
model, deﬁned as the log likelihood of the cause-speciﬁc hazards model minus the
log likelihood of the mixture model, by age/sex subgroup, for the hospital submodel,
the ICU submodel and both combined. Positive values indicate better ﬁt for the cause-
speciﬁc hazards model.

Checking mixture and cause-speciﬁc hazard models together The goodness-of-
ﬁt of all of the parametric models can be checked by comparing estimates of the
continuous-time transition probability (or “cumulative incidence”) p(H)
r,s (t) with
the standard nonparametric estimates Aalen and Johansen [1978]. Figure 4 shows these
by age and gender, comparing subgroup-speciﬁc Aalen-Johansen estimates against the
estimates from the mixture and competing risks models, the upper panel showing the
models for p(H)
r,s (t), governing the event following hospital admission, and the lower
panel showing the models for the event following ICU admission, p(I)
r,s (t). The para-
metric estimates largely agree with the Aalen-Johansen estimates, except for some dis-
agreement for the mixture model among the oldest and youngest ages, though note the
estimates for the events following ICU admission for the older age groups are based on
a small sample of ICU admissions for these groups (see Figure 2).

r,s (t), p(I)

Check of cause-speciﬁc hazard models The cause-speciﬁc hazard models can be
checked against Kaplan-Meier estimates of the distribution of the time to each latent
competing event, since they are standard parametric survival models for the time to the
cause of interest, with the occurrence of other causes treated as censoring (Figure 5).

The Kaplan-Meier estimates show a characteristic ﬂattening out for the time from
hospital admission to death and ICU admission, implying that only a proportion of
patients experience these events by a certain time, after which the hazard of those
events becomes small. This pattern is consistent with the “cure” models that provided
the best ﬁt among the cause-speciﬁc models for these events.

For the times from hospital to discharge, the Kaplan-Meier estimates show that
the majority of (“latent”) discharge times have occurred by around 50 days, if deaths
and ICU admissions are considered as right-censoring for these “latent” times. We
disregarded “cure” models for this transition, assuming that the survival curve for time

15

Figure 4: Probabilities of having experienced each competing next state following hos-
pital admission, against time since admission, by age group and gender, comparing
non-parametric (Aalen-Johansen) and two alternative parametric models. Top: events
following hospital admission, bottom: events following ICU admission.

16

[0,45)[45,65)[65,75)[75,85)85+FemaleMale020406002040600204060020406002040600.000.250.500.751.000.000.250.500.751.00Days after hospital admissionProbability of next eventModelAalen−JohansenCompeting risksMixtureStateDeathDischargeHospitalICU[0,45)[45,65)[65,75)[75,85)85+FemaleMale01020304050010203040500102030405001020304050010203040500.000.250.500.751.000.000.250.500.751.00Days after ICU admissionProbability of next eventModelAalen−JohansenCompeting risksMixtureStateDeathDischargeICUFigure 5: Check of cause-speciﬁc hazard models against Kaplan-Meier estimates of
the distribution of the time to each latent competing event, by age and gender

to discharge will eventually decrease to zero. However there is a tail of people who
have been in hospital for very long periods, particularly from the older age groups (see
also Figure 2). Therefore we might expect some uncertainty in estimating the upper
tail of the distribution of the length of stay.

Check of mixture models
In the mixture models, the ﬁt of the distribution of the
time to each event conditionally on that event occurring can be checked, to some extent,
against histograms of the observed times. This ignores the contribution of the censored
data to the ﬁtted models, which comprise 10% of the observations and include people
with longer hospital stays. Figure 6 shows these comparisons for the model for events
following hospital admission, by age and gender. Estimated densities are overlaid on
histograms of the times to each event for people who were observed to have that event.

17

Hospital − DeathHospital − DischargeHospital − ICU0501000501000501000.000.250.500.751.00DaysProbability free of eventICU − DeathICU − Discharge0501000501000.000.250.500.751.00DaysProbability free of event[0,45),Female[0,45),Male[45,65),Female[45,65),Male[65,75),Female[65,75),Male[75,85),Female[75,85),Male85+,Female85+,MaleModelKaplan−MeierParametricThe shapes of the ﬁtted densities for beyond 50 days of observed follow-up are inﬂu-
enced by the parametric model form, and are difﬁcult to check against the censored and
incomplete data (shown in Figure 2, but not in Figure 6) that contribute to the estimates
for these times.

4.2 Estimated probabilities and times of next events

Figure 7 shows the probabilities governing the next event following hospital admission,
compared between the two parametric models. There are only moderate differences be-
tween the estimates from the mixture and cause-speciﬁc hazards models. The mortality
rates, both before and after ICU admission, increase with age and are higher for men.
Rates of ICU admission are higher for younger people, which is largely a consequence
of hospital policy rather than disease severity.

Figure 8 shows the mean times to events (in red) with 95% conﬁdence intervals
(representing uncertainty) and the median and 90% quantile intervals (in blue, rep-
resenting between-person variability) for the time-to-event distributions, under both
models. These conﬁdence intervals, and all others presented, are obtained by simulat-
ing a sample of alternative parameter values from the asymptotic normal distribution of
the maximum likelihood estimates Mandel [2013]. Note that some of the conﬁdence
intervals around the means are too narrow to be seen. The estimated medians agree
between the models, however the estimated upper tails of the distributions are sensitive
to the model choice. The mixture models estimate longer mean times to death (and
upper quantiles of this distribution) for those who die in hospital without going to ICU.
This is a plausible consequence of using a cure distribution for time to death in the
cause-speciﬁc hazard models — where if a person survives longer than a certain time,
the model infers that they belong to the “cured” fraction who will never die in hospital.
Whereas under the mixture models, those observed to be still in hospital are estimated
to be still at non-zero risk of death, so that longer, but ﬁnite, times to death are more
plausible under the mixture models considered here.

Estimated times to discharge are slightly higher under the cause-speciﬁc hazards
models, which could be explained by artefacts of how the different parametric assump-
tions extrapolate the time of the eventual event for those who are still in hospital (see
also the Kaplan Meier plots of time from hospital to discharge in Figure 5). The models
both agree on the time from hospital to ICU admission being distributed tightly around
a mean of about 2 days, and on the distributions of the times to events following ICU
admission.

4.3 Estimates for ultimate events after hospital admission

The models for the events following hospital admission and events following ICU ad-
mission can be coupled to provide predictions of the probability that a person just
admitted to hospital will die in hospital, and the distributions of the time to death in
hospital or discharge alive (Figure 9). The estimated probabilities are again slightly
different between the two models, but both show the same increasing trend with age,
and higher mortality for men, from around 0.07 for men and women aged under 45 to
0.4 for women over 85 years of age, and 0.5 for men over 85.

18

Figure 6: Check of ﬁtted time-to-event densities from the mixture model against his-
tograms of observed times to each alternative next event following hospital admission,
by gender and age group

19

[0,45)[45,65)[65,75)[75,85)85+DeathDischargeICU01020304050010203040500102030405001020304050010203040500.000.050.100.150.000.050.100.150.000.050.100.15Days since hospital admissionDensityMale[0,45)[45,65)[65,75)[75,85)85+DeathDischargeICU01020304050010203040500102030405001020304050010203040500.000.050.100.150.000.050.100.150.000.050.100.15Days since hospital admissionDensityFemaleFigure 7: Probabilities of next event after hospital or ICU admission, estimated from
mixture and competing risks models.

20

FemaleMaleDeathICU0.00.20.40.00.20.4[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Probability of next event after hospital admissionModelCompeting risksMixtureFemaleMale0.000.250.500.751.000.000.250.500.751.00[0,45)[45,65)[65,75)[75,85)85+Probability of death in hospital after ICU admissionModelCompeting risksMixture21

Figure 8: Times to the next event after hospital admission and the next event after ICU
admission: means and 95% conﬁdence intervals in red, and median and 90% quantile
intervals (in blue)

llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFemaleMaleDeathDischargeICU050100050100[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Days after hospital admissionModelCompeting risksMixturellllmeanquantilellllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFemaleMaleDeathDischarge0408012004080120[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Days after ICU admissionModelCompeting risksMixturellllmeanquantileFigure 9: Probabilities of death in hospital, and times from hospital admission to death
in hospital or discharge, averaged over people who are admitted to ICU and people
who aren’t.

22

FemaleMale0.000.250.500.751.000.000.250.500.751.00[0,45)[45,65)[65,75)[75,85)85+Probability of death in hospital after hospital admissionModelCompeting risksMixturellllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFemaleMaleDeathDischarge02550751000255075100[0,45)[45,65)[65,75)[75,85)85+[0,45)[45,65)[65,75)[75,85)85+Days after hospital admissionModelCompeting risksMixturellllmeanquantileThe differences between models in the estimated distribution of times to ultimate
events reﬂect the differences seen in Figure 8, with medians that agree between the
models (at around 10 days for times to death and discharge), but longer mean times to
death under the mixture model, and longer mean times to discharge under the compet-
ing risks model.

While the cause-speciﬁc hazards model ﬁtted the observed data better overall (judg-
ing by AIC), inference from the ﬁtted mixture model is more computationally efﬁ-
cient. Computing the quantities of interest is practically instant given the ﬁtted mixture
model. Computing them given the competing risks model requires two levels of sim-
ulation: over S individuals to determine the sampling distribution of the minimum,
and over B alternative parameter values to represent parameter uncertainty. Using
S = 100000 and B = 100 to simulate the required quantities in this application took
around 8 minutes on a single computer processor, though the computation would be
simple to parallelise.

5 Discussion and comparison of modelling frameworks

We have obtained estimates of probabilities of events following hospital admission, and
estimates of the distribution of times to those events, for people admitted to hospital
with COVID-19 infection, using two different frameworks for multi-state modelling.
The estimates of event probabilities and median times to events did not depend sub-
stantially on the model assumptions. However, due to limited follow up, and despite
the fact that only about 10% of event times were censored, some uncertainty remained
in the upper tails of the distributions of the times to death and discharge. The paramet-
ric assumptions can only be checked against the data observed in the follow-up period,
where a cause-speciﬁc hazard model with “cure” fractions was found to ﬁt best, based
on AIC and comparisons with nonparametric estimates. To make longer-term predic-
tions we must make substantive assumptions about what will happen after the end of
follow up. In this example, we assumed “cure” fractions for ICU and death were plausi-
ble in the cause-speciﬁc hazards model, that is, a proportion of people never experience
these events, but everyone will eventually be discharged from hospital.

Both mixture modelling and cause-speciﬁc hazards are useful frameworks for fully-
parametric multi-state modelling. With the flexsurv R package, they can both be
applied to general multi-state data with a wide range of ﬂexible parametric distributions
and covariate dependencies. While ﬁtting the mixture model is more demanding due
to the need to maximise over a larger number of parameters, easily-interpretable quan-
tities, such as probabilities of and and times to observed events, are easier to compute
under the mixture model. Fit of both models can be checked against nonparametric
estimates.

As discussed by Cox Cox [1959], in theory, either model framework can represent
the exact mechanism if the transition-speciﬁc parametric distributions are speciﬁed
correctly. A third framework, “vertical” modelling, was also proposed by Nicolaie et
al. Nicolaie et al. [2010], based on modelling P (time)P (event|time), rather than
P (event)P (time|event) as in the mixture model. Though in practice, very ﬂexible
model families and large samples would often be required for the best-ﬁtting model

23

among different frameworks to give substantively identical inferences. For example,
suppose there were two competing latent event times T1, T2 with cause-speciﬁc haz-
ards distributed as Gamma(a1, b1) and Weibull(a2, b2) respectively, then the equivalent
mixture model would be speciﬁed by the conditional distributions of T1|T1 < T2 and
T2|T1 > T2, which wouldn’t have a standard form. In principle, splines Royston and
Parmar [2002], Crowther and Lambert [2014], Kom´arek et al. [2005] might be used
to construct arbitrarily-ﬂexible time-to-event models — there is general-purpose soft-
ware for these, though identiﬁability and computational challenges may constrain the
ﬂexibility they allow in practice.

Either model framework might be used in situations where some people are at neg-
ligible risk of particular events, as in “cure” models where a fraction of people do not
die from a disease. We clariﬁed the difference between the “mixture cure” distributions
of Boag Boag [1949] and the “mixture competing risks” models of Larson and Dinse
Larson and Dinse [1985] — in the former, the “cure” event that competes with death is
not observable, and in the latter, it is. We extended the mixture competing risks model
to a full multi-state model, and developed accessible software to implement it, while
we used the mixture cure distribution to deﬁne cause-speciﬁc hazards in the competing
risks framework. This provided the best ﬁt to the COVID-19 hospital data, judging
by AIC. This might have been because the “mixture competing risks” model does not
assume that a person in one mixture component is “immune” from the events deﬁning
the other components — because the components are simply deﬁned by which event
among a set of competing events will occur before the others. In our application, the
cause-speciﬁc cure model, where a proportion of people are at zero risk of ICU admis-
sion and death in hospital, ﬁtted better than the mixture model where everyone still in
hospital is assumed to be still at risk of these events.

In our application, policy-makers required estimates of average outcomes for mixed
populations deﬁned by age groups and gender. Therefore there were only two categor-
ical covariates in our model. Models with more covariates, including continuous co-
variates, would be required to determine predictors of outcomes for individuals, or to
investigate disease aetiology. Under the mixture model, covariate effects on probabili-
ties of, or times to, observable events can be estimated directly, e.g. as log odds ratios,
hazard ratios or time acceleration factors. While hazard ratios from a cause-speciﬁc
hazard model can be argued to more closely represent the mechanisms of how risks
of events are determined at the biological level, compared to effects on probabilities
[Pintilie, 2006], they are harder to interpret in terms of average outcomes compared
between populations. Non-proportional hazards, or other ﬂexible models for covari-
ate dependencies, are available in software (e.g. flexsurv), and any quantity of
interest can be computed and contrasted between speciﬁc covariate values, however
this may require expensive simulation. Another approach to obtaining “average ef-
fects” of speciﬁc covariates involves regression on the cumulative incidence function,
which is possible in a fully parametric framework [Lambert et al., 2017], as well as
semi-parametrically [Fine and Gray, 1999]. With continuous covariates or many co-
variates, goodness of ﬁt checking would also be more challenging, compared to our
model where we simply compared model predictions with stratiﬁed nonparametric es-
timates. Also with many covariates, the computational advantages of the cause-speciﬁc
hazards model, in terms of ﬁtting, would become more apparent — since the cause-

24

speciﬁc likelihood factorises into independent components, compared to the mixture
model which involves a joint likelihood over all competing events.

In routinely-collected data on people hospitalised with an infection, other chal-
lenges might arise, such as more severe kinds of incomplete observation. Addressing
these challenges would be important for decision-making at the start of an epidemic,
where data are sparser. In earlier versions of the dataset that we studied, ﬁnal survival
status and ICU admission histories were missing for substantial numbers of patients,
and many event dates were interval-censored over wide ranges. Such partial obser-
vations are hard to handle without strong assumptions such as the Markov assump-
tion and piecewise-constant hazards [Kalbﬂeisch and Lawless, 1985], and even with a
ﬂexible model, untestable assumptions about whether missingness is informative may
be required. Routinely-collected data are also subject to selection biases which may
make inference for wider populations difﬁcult. These challenges further emphasise the
need for strong infrastructures for data collection in preparation for future public health
emergencies.

Code to implement the analyses in the paper is included as an online supplementary
document in R Markdown format, together with a simulated dataset of the same form
as the data used in the paper.

Acknowledgements This work was supported by the Medical Research Council pro-
grammes MRC MC UU 00002/11, MRC MC UU 00002/10 and MRC MC UU 00002/2.
We are grateful to the Joint Modelling Cell and Epidemiology Cell at Public Health
England for providing and discussing the CHESS data.

References

O. O. Aalen and S. Johansen. An empirical transition matrix for non-homogeneous
Markov chains based on censored observations. Scandinavian Journal of Statistics,
pages 141–150, 1978.

J. Amdahl. ﬂexsurvcure: Flexible Parametric Cure Models, 2020. URL https:
//CRAN.R-project.org/package=flexsurvcure. R package version
1.1.0.

P. K. Andersen and N. Keiding. Multi-state models for event history analysis. Statisti-

cal Methods in Medical Research, 11(2):91–115, 2002.

P. K. Andersen, S. Z. Abildstrom, and S. Rosthøj. Competing risks as a multi-state

model. Statistical Methods in Medical Research, 11(2):203–215, 2002.

P. Birrell, X.S. Zhang, A. Corbella, E. van Leeuwen, N. Panagiotopoulos, K. Hoschler,
A.J. Elliot, M. McGee, S. de Lusignan, A.M. Presanis, M. Baguelin, M. Zambon,
A. Charlett, R.G. Pebody, and D. De Angelis. Forecasting the 2017/2018 seasonal
inﬂuenza epidemic in England using multiple dynamic transmission models: a Case
Study. BMC Public Health, 20(488), 2020.

25

J. W. Boag. Maximum likelihood estimates of the proportion of patients cured by
cancer therapy. Journal of the Royal Statistical Society. Series B (Methodological),
11(1):15–53, 1949.

A. S. C. Conlon, J. M. G. Taylor, and D. J. Sargent. Multi-state models for colon
cancer recurrence and death with a cured fraction. Statistics in Medicine, 33(10):
1750–1766, 2014.

D. R. Cox. The analysis of exponentially distributed life-times with two types of fail-
ure. Journal of the Royal Statistical Society: Series B (Methodological), 21(2):
411–421, 1959.

M. J. Crowther and P. C. Lambert. A general framework for parametric survival anal-

ysis. Statistics in Medicine, 33(30):5280–5297, 2014.

M. J. Crowther and P. C. Lambert. Parametric multistate survival models: ﬂexible
modelling allowing transition-speciﬁc distributions with application to estimating
clinically useful measures of effect differences. Statistics in Medicine, 36(29):4719–
4742, 2017.

D. De Angelis and A. M. Presanis. Handbook of Infectious Disease Data Analysis,
chapter Analysing Multiple Epidemic Data Sources, page 477. Chapman and Hall /
CRC, 2019.

C. A. Donnelly, A. C. Ghani, G. M. Leung, A. J. Hedley, C. Fraser, S. Riley, L. J.
Abu-Raddad, L.-M. Ho, T.-Q. Thach, P. Chau, K.-P. Chan, T.-H. Lam, L.-Y. Tse,
T. Tsang, S.-H. Liu, J.H.B. Kong, E.M.C. Lau, N.M. Ferguson, and R.M. Anderson.
Epidemiological determinants of spread of causal agent of severe acute respiratory
syndrome in Hong Kong. The Lancet, 361(9371):1761–1766, 2003.

V. T. Farewell. The use of mixture models for the analysis of survival data with long-

term survivors. Biometrics, pages 1041–1046, 1982.

J. P. Fine and R. J. Gray. A proportional hazards model for the subdistribution of a
competing risk. Journal of the American Statistical Association, 94(446):496–509,
1999.

Y. Foucher, F. Le Borgne, E. Dantan, F. Gillaizeau, A. Chatton, and C. Combes-
cure. RISCA: causal inference and prediction in cohort-based analyses, 2020.
URL https://CRAN.R-project.org/package=RISCA. R package ver-
sion 0.8.2.

A.C. Ghani, C.A. Donnelly, D.R. Cox, J.T. Grifﬁn, C. Fraser, T.H. Lam, L.M. Ho,
W.S. Chan, R.M. Anderson, A.J. Hedley, and G.M. Leung. Methods for estimating
the case fatality ratio for a novel, emerging infectious disease. American Journal of
Epidemiology, 162(5):479–486, 2005.

F. Ieva, C. H. Jackson, and L. D. Sharples. Multi-state modelling of repeated hos-
pitalisation and death in patients with heart failure: the use of large administrative
databases in clinical epidemiology. Statistical Methods in Medical Research, 26(3):
1350–1372, 2017.

26

C. H. Jackson. ﬂexsurv: a platform for parametric survival modeling in R. Journal of

Statistical Software, 70, 2016.

L. H. Jakobsen, T. M.-L. Andersson, J. L. Biccler, L. Ø. Poulsen, M. T. Severinsen,
T. C. El-Galaly, and M. Bøgsted. On estimating the time to statistical cure. BMC
Medical Research Methodology, 20(1):1–13, 2020.

J.D. Kalbﬂeisch and J.F. Lawless. The analysis of panel data under a Markov assump-

tion. Journal of the American Statistical Association, 80(392):863–871, 1985.

Arnoˇst Kom´arek, Emmanuel Lesaffre, and Joan F Hilton. Accelerated failure time
model for arbitrarily censored data with smoothed error distribution. Journal of
Computational and Graphical Statistics, 14(3):726–745, 2005.

P. C. Lambert, S. R. Wilkes, and M. J. Crowther. Flexible parametric modelling of the
cause-speciﬁc cumulative incidence function. Statistics in Medicine, 36(9):1429–
1446, 2017.

M. G. Larson and G. E. Dinse. A mixture model for the regression analysis of compet-
ing risks data. Journal of the Royal Statistical Society: Series C (Applied Statistics),
34(3):201–211, 1985.

B. Lau, S. R. Cole, and S. J. Gange. Competing risk regression models for epidemio-

logic data. American Journal of Epidemiology, 170(2):244–256, 2009.

B. Lau, S. R. Cole, and S. J. Gange. Parametric mixture models to evaluate and sum-
marize hazard ratios in the presence of competing risks with time-dependent hazards
and delayed entry. Statistics in Medicine, 30(6):654–665, 2011.

M. Mandel. Simulation-based conﬁdence intervals for functions with complicated

derivatives. The American Statistician, 67(2):76–81, 2013.

M. A. Nicolaie, H. C. van Houwelingen, and H. Putter. Vertical modeling: a pat-
tern mixture approach for competing risks modeling. Statistics in Medicine, 29(11):
1190–1205, 2010.

M. Pintilie. Competing risks: a practical perspective, volume 58. John Wiley & Sons,

2006.

R. L. Prentice. A log gamma model and its maximum likelihood estimation.

Biometrika, 61(3):539–544, 1974.

R. L. Prentice, J. D. Kalbﬂeisch, A. V. Jr. Peterson, N. Flournoy, V. T. Farewell, and
N. E. Breslow. The analysis of failure times in the presence of competing risks.
Biometrics, pages 541–554, 1978.

Public

Health

England.

systems.
publications/national-covid-19-surveillance-reports/
sources-of-covid-19-systems, 2020a.

URL:

surveillance
COVID-19
Sources
https://www.gov.uk/government/

of

27

require

submission

SGSS and CHESS data:

to
relating
CHESS

Public Health England.
the

tice
land
and
about-nhs-digital/corporate-information-and-documents/
directions-and-data-provision-notices/
data-provision-notices-dpns/sgss-and-chess-data, 2020b.

Data Provision No-
from Public Health Eng-
SGSS
from the
https://digital.nhs.uk/

data
hospitalisation,

surveillance

of
and

systems.

URL:

to

H. Putter, M. Fiocco, and R. B. Geskus. Tutorial in biostatistics: Competing risks and

multi-state models. Statistics in Medicine, 26(8):2389–2430, 2007.

P. Royston and M. Parmar. Flexible parametric proportional-hazards and proportional-
odds models for censored survival data, with application to prognostic modelling
and estimation of treatment effects. Statistics in Medicine, 21(1):2175–2197, 2002.

K. Soetaert, T. Petzoldt, and R. W. Setzer. Solving differential equations in R: package
ISSN 1548-7660.

deSolve. Journal of Statistical Software, 33(9):1–25, 2010.
URL http://www.jstatsoft.org/v33/i09.

28

