Astronomy&Astrophysicsmanuscript no. automation˙paper
September 8, 2022

© ESO 2022

TDCOSMO XI. Automated Modeling of 9 Strongly Lensed Quasars
and Comparison Between Lens Modeling Software
S. Ertl1,2, S. Schuldt1,2, S. H. Suyu1,2,3, T. Schmidt4, T. Treu4, S. Birrer5,6,7, A. J. Shajib8,4, and D. Sluse9

1 Max-Planck-Institut f¨ur Astrophysik, Karl-Schwarzschild Straße 1, 85748 Garching, Germany

e-mail: ertlseb@mpa-garching.mpg.de

2 Technische Universit¨at M¨unchen, Physik-Department, James-Franck-Straße 1, 85748 Garching, Germany
3 Academia Sinica Institute of Astronomy and Astrophysics (ASIAA), 11F of ASMAB, No.1, Section 4, Roosevelt Road, Taipei

10617, Taiwan

4 Physics and Astronomy Department, University of California, Los Angeles, CA 90095, USA
5 Kavli Institute for Particle Astrophysics and Cosmology and Department of Physics, Stanford University, Stanford, CA 94305, USA
6 SLAC National Accelerator Laboratory, Menlo Park, CA, 94025, USA
7 Department of Physics and Astronomy, Stony Brook University, Stony Brook, NY 11794, USA
8 Department of Astronomy & Astrophysics, University of Chicago, Chicago, IL 60637, USA
9 STAR Institute, Quartier Agora - All´ee du six Aoˆut, 19c B-4000 Liege, Belgium

Received –; accepted –

ABSTRACT

To use strong gravitational lenses as an astrophysical or cosmological probe, models of their mass distributions are often needed.
We present a new, time-eﬃcient automation code for uniform modeling of strongly lensed quasars with GLEE, a lens modeling
software, for high-resolution multi-band data. By using the observed positions of the lensed quasars and the spatially extended surface
brightness distribution of the lensed quasar host galaxy, we obtain a model of the mass distribution of the lens galaxy. We apply this
uniform modeling pipeline to a sample of nine strongly lensed quasars with HST WFC 3 images. The models show in most cases
well reconstructed light components and a good alignment between mass and light centroids. We ﬁnd that the automated modeling
code signiﬁcantly reduces the user input time during the modeling process. The preparation time of required input ﬁles is reduced
signiﬁcantly. This automated modeling pipeline can eﬃciently produce uniform models of extensive lens system samples which can
be used for further cosmological analysis. A blind test through a comparison with the results of an independent automated modeling
pipeline based on the modeling software Lenstronomy reveals important lessons. Quantities such as Einstein radius, astrometry, mass
ﬂattening and position angle are generally robustly determined. Other quantities depend crucially on the quality of the data and the
accuracy of the PSF reconstruction. Better data and/or more detailed analysis will be necessary to elevate our automated models to
cosmography grade. Nevertheless, our pipeline enables the quick selection of lenses for follow-up monitoring and further modeling,
signiﬁcantly speeding up the construction of cosmography-grade models. This is an important step forward to take advantage of the
orders of magnitude increase in the number of lenses expected in the coming decade.

Key words. gravitational lensing: strong

methods: data analysis

−

−

galaxies: elliptical and lenticular, cD

quasars: general

−

1. Introduction

Gravitational lensing describes the eﬀect of the gravitational po-
tential of a massive object on the light of a background source.
In the case of strong lensing (SL), the light is deﬂected such that
multiple images of the source are observed.

it

is a powerful tool

Because SL is sensitive to both luminous and dark mat-
ter (DM),
to probe the total galaxy
mass distribution and thus give insight to the DM distribu-
tion of galaxies (e.g., Dye & Warren 2004; Barnab`e et al. 2012;
Sonnenfeld et al. 2015; Schuldt et al. 2019; Shajib et al. 2021).
Mass clumps in the lensing galaxy aﬀect the image magniﬁ-
cation, and substructures can be detected by analyzing ﬂux-
ratio anomalies of point-like sources (e.g., Dalal & Kochanek
2001; Moustakas & Metcalf 2002; Nierenberg et al. 2014;
Nierenberg et al. 2017; Hsueh et al. 2020; Nierenberg et al.
2020; Gilman et al. 2020) or distortions in the arcs formed
by lensing of spatially-extended background galaxies (e.g.,
Koopmans 2005; Vegetti et al. 2010; Vegetti et al. 2012).
Clumps below a mass of 108 solar masses can be detected that
way. With models we can also analyze the structural parameters

of early-type lens galaxies such as the average slope of the to-
tal mass density proﬁle or the DM fraction (e.g., Gavazzi et al.
2007; Auger et al. 2010; Lagattuta et al. 2010; Barnab`e et al.
2011; Shu et al. 2015).

In addition,

the magnifying eﬀect of SL can be used
to observe the earliest galaxies and quasars in the Universe
(e.g., Kneib et al. 2004; Bradley et al. 2008; Coe et al. 2013;
Salmon et al. 2020). Modeling these high redshift objects en-
ables us to study, e.g., their rotation curves and masses (e.g.,
Jones et al. 2010; Chiriv`ı et al. 2020; Rizzo et al. 2020). This
helps our understanding of galaxy evolution and structure for-
mation in the early Universe, which is, despite major progress in
the last years, a research ﬁeld with many open questions.

Another important application of SL is the measurement
of cosmological parameters such as the Hubble constant H0
(e.g., Suyu et al. 2017; Wong et al. 2019; Shajib et al. 2019a;
Chen et al. 2020; Millon et al. 2020c; Birrer et al. 2020). This
parameter, which gives the current expansion rate of the
Universe, is of great interest because early-universe measure-
ments from the cosmic microwave background (CMB) give a

1

2
2
0
2

p
e
S
7

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
4
9
0
3
0
.
9
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

±

±

1 Mpc−

0.54 km s−

1.04 km s−

1 (Planck Collaboration et al.
1 Mpc−
value of 67.36
2018), whereas local measurements from the SH0ES project
(Riess et al. 2021) based on the cosmic distance ladder us-
ing Cepheids and Type Ia supernovae (SNe) obtain a higher
1. This 5σ disagreement
value of 73.04
is commonly known as the Hubble tension and could hint to
physics beyond ﬂat ΛCDM, which is currently the standard
cosmological model. To resolve this debate, independent meth-
ods including megamasers (e.g., Pesce et al. 2020), standard
sirens (e.g., Abbott et al. 2017), surface brightness ﬂuctuations
(e.g., Khetan et al. 2020), expanding photospheres of super-
novae (e.g., Schmidt et al. 1994), and gravitational lensing are
necessary.

To measure H0 with SL, one needs a strongly lensed vari-
able background source like a quasar or a SN. Because of the
diﬀerent path length and the gravitational potential diﬀerences
on the way of the photons, the characteristic brightness ﬂuctua-
tions reach the observer at diﬀerent times. We can measure this
time delay in the light curves by monitoring the multiple images
and comparing these ﬂux variations with respect to each other
(e.g., Millon et al. 2020a,b).

Apart from an accurate measurement of the time delays,
the lens potential is required to determine H0, which is ob-
tained by modeling the observed lensing system. Major progress
has been made in this ﬁeld in recent decades, in part because
of the development of advanced modeling software such as
GLEE (Gravitational Lens Eﬃcient Explorer; Suyu & Halkola
2010; Suyu et al. 2012) and Lenstronomy (Birrer et al. 2015;
Birrer & Amara 2018). Such modeling software allow us to con-
strain the model parameters of the lens and the source, such as
their position and radial mass proﬁle. A downside of this ap-
proach is that we need at least weeks to model a lens system with
spatially extended sources since sampling the parameter space,
e.g. with Markov chain Monte Carlo (MCMC) methods, is time
consuming and the modeling process itself is interactive. In ad-
dition, the input ﬁles required by GLEE (e.g. point spread func-
tion (PSF), error map) have to be obtained manually from the
available data in some cases.

the

Euclid

upcoming

(Laureijs et al.

With the increasing number of wide-ﬁeld imaging surveys,
including the Hyper Suprime-Cam (HSC, Aihara et al. 2018),
Dark Energy Survey (DES, Dark Energy Survey Collaboration
2016),
2011;
Scaramella et al. 2021) and Rubin Observatory Legacy Survey
of Space and Time (LSST, Ivezi´c et al. 2019), the number of
known strong lensing systems is growing rapidly. Even though
the number of detected lenses per square degree lies between
0.5 and 10 (Li et al. 2020) depending on the image depth, the
number of lens candidates will increase strongly thanks to
large survey areas. For example, the LSST will cover a total of
20,000 deg2 in multiple bandpasses over its planned ten year
∼
run time (Tyson 2002, Lochner et al. 2021). We expect new
images of billions of galaxies, of which of the order of 100,000
are strong lensing systems (Collett 2015). To be able to keep up
with the increasing sample size, we need techniques to automate
the lens modeling process. By automating the creation of the in-
put ﬁles, the calculation of the starting values of lens parameters
and image positions, and the optimization and sampling of the
parameter space, we can save many hours of user interaction
during the modeling process. Several projects in recent years
have already demonstrated successfully the automation of lens
modeling especially to obtain initial estimates of the lens mass
distribution, (e.g., Shajib et al. 2019b; Nightingale et al. 2021).
There are also techniques being developed based on machine
learning (e.g., Hezaveh et al. 2017; Perreault Levasseur et al.

2

2017; Park et al. 2021; Schuldt et al. 2021; Schuldt et al. 2022),
although the modeling of strongly lensed quasars via neural
networks has yet to be tested on real data instead of mock
data. Another method is the massive parallelization of Graphics
Processing Units (Gu et al. 2022) to speed up the lens modeling.
All these approaches cannot yet replace the detailed, manual
is necessary to produce models
lens-by-lens analysis that
that are accurate enough for time-delay cosmography, (e.g.
Suyu et al. 2010, 2013; Birrer et al. 2018; Wong et al. 2019;
Shajib et al. 2019a; Rusu et al. 2020), but rather serve as a
ﬁrst step towards them and provide important information for
follow-up observations.

In this paper, we present a new, user-time-eﬃcient automated
procedure for uniform modeling of strongly lensed quasars with
the lens modeling software GLEE. We develop a pipeline that
works with minimal user input. Providing only high-resolution
imaging data and marking important regions in the ﬁeld, the
user can model with GLEE in a nearly fully automated way.
The automated modeling can be done with single-band, as
well as with multi-band data. We focus on lensed quasars to
model the lens mass distribution with an isothermal or power-
law proﬁle, and the source brightness distribution on a grid
of pixels. To test our code, we uniformly model a sample of
nine strongly lensed quasars observed with the Hubble Space
Telescope (HST). Furthermore, we predict the time delays and
Fermat potential diﬀerences between the multiple images of the
quasar. We emphasize that our approach diﬀers from that of pa-
pers aimed at deriving cosmological parameters from individual
lenses, because we are prioritizing speed over accuracy. Owing
to the adopted shortcuts (e.g. we do not iteratively correct the
PSF and usually model only the images in ﬁlters with visible arcs
from the host galaxy) and the uneven quality of the data, we do
not expect in general our results to be cosmography grade. The
output of this pipeline is aimed as a ﬁrst step towards cosmog-
raphy grade models, and to assist in prioritization of follow-up
monitoring and further modeling.

Schmidt et al. (2022, hereafter S22) have also developed an
automated modeling pipeline using Lenstronomy and applied
to a sample of 30 lensed quasars. Our sample of 9 is a subset of
the systems in S22, allowing us to do a direct comparison of the
results between the two modeling pipelines as a blind test, since
the lead modelers of the two teams obtained their lens models in-
dependently and only compared the results after the models were
completed. We note that our approach and that of S22 are similar
but not identical. Important diﬀerences include the modeling of
the point spread function, which is known to be crucially impor-
tant (Shajib et al. 2022), and the strategy adopted to cope with
insuﬃcient data quality (S22 imposed informative priors, while
we do not). Therefore we do not expect the two eﬀorts to agree
within the formal uncertainties, which are only a representation
of the statistical error and not of the systematics, which are no-
toriously dominant. Thus, this should be kept in mind when in-
terpreting the comparison results. Nevertheless, as we will see,
important lessons can be gleaned from it.

The outline of the paper is as follows: in Sec. 2 we describe
the steps in modeling a strong lensing system with our GLEE
automated code. We brieﬂy describe each system and the obser-
vational data in Sec. 3. The modeling results are presented in
Sec. 4. The performance of the automated modeling compared
to manual modeling, together with a comparison to the models
obtained with Lenstronomy of the same systems (S22), is dis-
cussed in Sec. 5. In Sec. 6 we summarize our results.

Throughout the paper, we adopt a ﬂat ΛCDM cosmol-
ΩΛ =

ogy with H0 = 70 km s−

1 and ΩM = 1

1 Mpc−

−

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

0.3. Parameter estimates are given by the median of its one-
dimensional marginalized posterior probability density function,
and the quoted uncertainties show the 16th and 84th percentiles
(corresponding to a 68% credible interval).

2. Modeling process of GLEE automation code

In this section we describe in detail the steps of modeling a
strongly lensed quasar with GLEE and how they are conducted
in our automation code. We adopt diﬀerent mass and light pro-
ﬁles and use the Bayesian framework of MCMC sampling and
simulated annealing (Kirkpatrick et al. 1983) provided by GLEE.
The goal is to model the lens mass distribution by ﬁrst using the
source and image positions, and then by reconstructing the sur-
face brightness distribution of the lens and background source
galaxies. Fig. 1(a) shows as an example the strongly lensed
quasar J2100
4452. We see the lens galaxy in the image cen-
ter, four multiple images of the background quasar, and the arc,
which is the lensed light of the quasar host galaxy. The code
models the mass distribution of the lens galaxy and the light
components of the system (i.e., lens, satellite galaxies of the lens,
lensed quasar, and arc light). The modeled constituents of the
lensing system are labeled in Fig. 1(a).

−

Since the modeling usually is ﬁrst done in a single ﬁlter
and possible further bands are included after the model has sta-
bilized, we present in Sec. 2.1 an automation code dedicated
for the single band modeling. We then introduce the automa-
tion code for the multiband modeling in Sec. 2.2 and ﬁnally the
prediction of the time delays between the multiple images of
strongly lensed quasars in Sec. 2.3.

2.1. Single-bandmodeling

In this section we discuss the automated modeling of a lensing
system with single-band data. We describe the semi-automated
preparation of required input ﬁles, as well as each modeling step
and their substeps in the following subsections. An overview of
the basic modeling procedure is shown as a ﬂowchart in Fig. 2
and summarized in Table 1. In particular, Table 1 shows the vary-
ing and ﬁxed parameters in each modeling step.

2.1.1. Preparation

To model a strong lensing system with GLEE using our newly
developed automated modeling codes, the user needs to provide
information about the position and approximate light structure
of the lens, the quasar images and satellites. In addition, several
input ﬁles (see Table 2) are needed. The creation of each input
ﬁle is conducted in separate codes that are described in the fol-
lowing.

Science image cutout We start by creating a cutout of the lens-
ing system from the preprocessed, reduced data that includes the
immediate environment (. 10′′) to be taken into account during
the modeling. In the automated pipeline, the user creates a DS9
(Joye & Mandel 2003) region ﬁle containing the cutout area in
the ﬁeld, as well as the positions of the lens, satellite galaxies,
and the quasar images. Optionally, the background ﬂux is sub-
tracted by calculating the average ﬂux of an empty patch in the
ﬁeld. The modeling code then creates the cutout, which is used
for the subsequent modeling process, and calculates starting val-
ues for the lens mass and light parameters and image positions
from the region information.

(a) Image cutout of J2100
which are modeled with our automation code.

−

4452 to illustrate its diﬀerent components

user region
for arc mask
user region
for lens mask

(b) Image cutout of J2100
create the masks.

−

4452 with regions provided by the user to

Fig. 1. Overview of the components of the lensing system that are
modeled by the GLEE automation code, and the required regions to
create arc and lens mask of the lensing system given as example. The
region to create the arc mask, which covers the light of the lensed
quasar and arcs, is colored in red. For the lens mask, the user provides
the region(s) of surrounding, luminous objects (shown in green in the
image), containing the pixels that are ignored by the model.

Error map The error map accounts for both background noise
and Poisson noise. The background noise σbackground is approxi-
mated as a constant that is set to be the standard deviation from a
small patch in the science image without astrophysical sources.
The Poisson noise σpoisson is computed from the weight image
(exposure time map) and the science image. For images in units

3

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Step Description

Section Criteria

Lens mass parameters

Lens light

Source light

proﬁles

ext. shear

quasar

host

modeling of the lens light

modeling of the quasar light

source position modeling

image position modeling with external shear

modeling of the arc light + SSB distribution
reconstruction

2.1.2

2.1.3

2.1.4

2.1.4

2.1.5

1)

(cid:9)2 (χ2
red ≤
(cid:9)2 (∆logP
≤
(cid:9)1 (χ2 < 5)
(cid:9)2 (χ2 < 5,
∆ logP
5)
(cid:9)2 (∆logP

≤

≤

modeling of the arc light + SSB distribution
reconstruction

2.1.5

(cid:9)2 (∆logP

≤

5)

2)

2)

×

×
X

X

X

X

×

×

×
X

X

X

X

(cid:13)

(cid:13)

(cid:13)

(cid:13)

X

×
X

(cid:13)

(cid:13)

XA

(cid:13)

×

×

×

×

X

X

1

2

3

4

5a

5b

Symbols:

(cid:9)1: optimizing cycle with simulated annealing
(cid:9)2: optimizing and sampling cycle with simulated annealing and MCMC
XA: only amplitude varying

X: parameters varying
: parameters ﬁxed
: parameters not included

(cid:13)
×

Table 1. Overview of the individual modeling steps conducted in the single-band modeling code. Each step is described brieﬂy in the second
column with the corresponding subsection in the third column. The modeling technique and stopping criteria are given in the fourth column. The
cycle runs until the stopping criteria in the parentheses are met. The remaining columns show which parameters are varying, ﬁxed, or not
included.

Input ﬁle

Description

Image cutout
Error map

PSF
Arc mask
Lens mask

Cutout of the lensing system
1σ uncertainty of pixel intensity in the cutout, ac-
counting for background and Poisson noise
Image of point-spread function
Region of arc light (red area in Fig. 1(b))
Region for masking neighboring objects (green
area in Fig. 1(b))

Table 2. Overview and description of required input ﬁles for modeling
a strong gravitational lens with our GLEE automation code.

of counts per second we calculate

σ2

poisson,i =

di

×

ti

(cid:12)(cid:12)(cid:12)(cid:12)

,

G (cid:12)(cid:12)(cid:12)(cid:12)

σ2

poisson,i =

.

di

G (cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

with di the observed intensity*, ti the exposure time for pixel
i, and G the charge coupled device (CCD) gain for the speciﬁc
ﬁlter. In the case of data units of counts, we have

We add σpoisson in quadrature to the background noise level if
σpoisson > 2
σbackground. We check this condition for each pixel
i to obtain the ﬁnal error map:

×

σ2
background,i + σ2
σ2

background,i

poisson

if σpoisson > 2
otherwise.

×

σbackground;

(3)

σ2

tot,i =





Point spread function If the PSF is not directly provided with
the science image, the PSF can be created with our PSF code.
For this, the user marks several, non-saturated stars in the ﬁeld,
2.5 arc minutes in the case of the HST
which spans

2.5

∼

×

(1)

(2)

×

WFC3 data we use. The PSF code will then automatically create
cutouts of these stars which are centered at the brightest pixel.
Since the star is not necessarily located exactly at the center
of the brightest pixel, the PSF code interpolates and shifts the
cutout within fractions of a pixel to center it in the cutout. In
particular, the proﬁle is shifted such that the brightness of the
pixels to the left and to the right of the brightest pixel is within
a margin of 10%, and similarly for the pixels above and below
the brightest pixel. This results in the central 3
3 region being
roughly symmetric. To obtain the PSF, the recentered stars are
normalized, then stacked by calculating the median per pixel
among the cutouts, and renormalized such that the sum of all
pixel values is 1. In addition, the GLEE automation code requires
two PSFs, one for modeling the light of the lensed quasar, and
one for the extended source. The ﬁrst one includes the diﬀrac-
tion spikes as that PSF image is used directly as the spatial pro-
ﬁle for the quasar images. The second one is cropped at the ﬁrst
diﬀraction minimum of the Airy disc, because it is used for the
convolution of the parameterized light distribution and arcs and
the computation time increases signiﬁcantly with increasing size
of the used PSF. The cropped PSF is also used to model the lens
light. Subsampling of these two PSFs are required when the pixel
sizes are large relative to the PSF’s full width at half maximum,
in order to avoid numerical inaccuracies due to undersampled
PSF.† The PSF code subsamples the PSF by a custom factor n
such that its pixel scale is 1
n of the original pixel size. Both sub-
sampled PSFs are renormalized by the PSF code.

Masks GLEE requires two masks for the modeling. The so-
called arc mask contains the region of the lensed quasar and its
host (red regions in Fig. 1(b)). It is used during the modeling of
the lens light to exclude quasar and host light from the modeling,
and later it gives the region of pixels that is used for reconstruct-
ing the source surface brightness (SSB) distribution. The lens
mask speciﬁes the pixels of the light of surrounding, luminous
objects such as neighboring stars (green areas in Fig 1(b)). GLEE

*Using the observed image instead of the model intensity may in-

duce biases at low signal-to-noise ratios (Horne 1986).

†This is the case for the HST-IR F160W ﬁlter that is used. In prac-

tice, we subsample the PSF when the pixel size is greater than 0.05′′.

4

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Preparation
(see Sec. 2.1.1)

Lens light
modeling
(see Sec. 2.1.2 / Fig. 2)

Quasar light
modeling
(see Sec. 2.1.3)

Source position
modeling

Image position
modeling

Lens mass distribution 
modeling with
source/image positions
(see Sec. 2.1.4 / Fig. 3)

Arc light modeling +
SSB distribution
reconstruction

Lens mass distribution 
modeling with
surface brightness 
distribution
(see Sec. 2.1.5 / Fig. 4)

Fig. 2. Overview ﬂowchart for single-band modeling of a strongly
lensed quasar system with our new GLEE automation code. The
modeling consists of two main steps, the lens mass distribution
modeling with source/image positions and with source surface
brightness (SSB; which is the unlensed light distribution of the quasar
host galaxy) reconstruction. Each step is divided into smaller modeling
steps. Details are described in ﬂowcharts for each step and in the
corresponding subsection, as referenced in the ﬂowchart.

will sequentially ﬁt the pixels of the lens light excluding regions
of the arc mask and neighboring objects speciﬁed by the lens
mask, as we describe in the following subsections. The masks
are created by the user marking the corresponding regions, sav-
ing the DS9 region ﬁle of the marked areas, and running a mask
generation code on these DS9 region ﬁles.

2.1.2. Lens light modeling

The ﬁrst modeling step is to reconstruct the light of the lens
galaxy and the multiple quasar images in order to subtract their
contribution and reveal more prominently the underlying arc
light. We model the lens light with the S´ersic proﬁle (S´ersic
1963) which is parametrized as

IS(x, y) = AS exp

q

k

( 

" −

(x

−

xS)2 +
reﬀ

(cid:16)

y

yS
−
qS

2

1
ns

(cid:17)

!

1

.
)#

−

(4)

An overview of the parameters in the S´ersic proﬁle and their pri-
ors used in the automated modeling is provided in Table 3. The
constant k normalizes reﬀ such that reﬀ is the half-light radius in
the direction of the semi-major axis.

The Gaussian prior on the centroid coordinates is used to
stabilize the optimization during lens light modeling, and is

changed to a ﬂat prior later when the code models the light of
the arc (Sec. 2.1.5). The prior range on the axis ratio qS and
S´ersic index nS are relaxed during multi-band modeling as more
constraints are available when adding additional ﬁlters. As de-
scribed in Sec. 2.1.1, we do not subsample the PSF for images
with pixels smaller than 0.05′′ and use the cropped and subsam-
pled PSF for images with a pixel scale greater than 0.05′′.

The parameters are ﬁtted to the observed intensity value Iobs
i
SB of the surface brightness (SB)

of pixel i by minimizing the χ2

χ2
SB =

Np

Xi=1

Iobs
i −

|

PSF
σ2

tot,i

IS,i

2

|

,

⊗

(5)

⊗

where Np is the number of pixels in the cutout that are not
masked, σ2
tot,i is the total noise of pixel i from Eq. (3), and the
symbol
represents the convolution of the PSF with the pre-
dicted S´ersic intensity IS,i of pixel i. The modeling code will run
cycles that consist of one simulated annealing in the beginning
and afterwards one MCMC chain using a sampling covariance
matrix obtained from the previous chain, which is updated after
every cycle. To obtain the uncertainties and optimized parameter
values, we sample the parameter space with MCMC. Each chain
samples 100,000 points, and the code removes the burn-in phase,
which we conservatively set to be the ﬁrst 50% of the points in
the chain. The modeling runs until two criteria are met. The ﬁrst
criterion is

χ2
red =

χ2
SB
DOF ≤

1,

with the degrees of freedom

DOF = # of pixels in the cutout
# of free parameters.

−

# of masked pixels

−

The number of masked pixels is the sum of all pixels inside the
arc mask and of nearby objects masked with the lens mask. The
second criterion is approximate convergence of the chain, i.e.,

∆logP

5.

≤

(8)

This is the diﬀerence in the log-likelihood between the median
of the ﬁrst 2000 points in the chain after burn-in is removed and
the median of the last 2000 points. We visualize the lens light
modeling steps with a ﬂowchart in Figure 3.

In case the chain of the lens light model with one S´ersic
proﬁle (approximately) converges (i.e., fulﬁlling Eq. 8) without
reaching the χ2
red threshold in Eq. (6), the code checks if a point
source at the center of the lens improves the model given the
possibility of an active galactic nucleus (AGN) within the lens
galaxy. The light distribution of a point source is represented by
the PSF. For this, the code checks how diﬀerent point sources in
an amplitude range between 0.01 and 100 change the χ2
SB of the
model. If χ2
SB is lowered by more than 10, a point source com-
ponent with the corresponding amplitude is added to the model.
This is motivated by the Bayesian information criterion (BIC,
following Rusu et al. 2019): the point source adds one additional
parameter (the amplitude). A χ2
SB decrease by 10 ensures that the
BIC does not increase. The model is subsequently optimized and
sampled until the criterion in Eq. (8) is fulﬁlled.

When the criterion deﬁned with Eq. (8) is met, the code
checks the criterion of Eq. (6). If the latter is fulﬁlled, the code
stops the lens light modeling, or, in case of satellites in the cutout
ﬁeld, goes on to model the light of the satellites. If the criterion
of Eq. (6) is not fulﬁlled, one additional S´ersic proﬁle with the

5

(6)

(7)

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Add Sersic proﬁle
to model

input ﬁles
(Sec. 2.1.1)

Optimizing/
sampling
cycle until

No

D
so

No

Yes

Add point source
proﬁle

O

c

A
Se

O

c

Yes

No

Yes

No

Quasar light
modeling

(Sec. 2.3.1)

No

No

Add third
Sersic proﬁle?
Reﬁne masks?
(user input)

Yes

Yes

Fig. 3. Flowchart showing the decision-tree for the lens light modeling. The modeling code obtains the best conﬁguration of S´ersic and
point-source proﬁles to ﬁt the primary lens light. The quality check is done with a χ2
values. In addition, the code also has the option to model the light of satellite lens galaxies.

red approach and a criterion for stability in the posterior

6

   
 
Component

Parameter Description

Prior

Prior range / value

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

xS [′′]

yS [′′]

qS
φS [◦]
AS
reﬀ [′′]
nS

S´ersic

x-centroid

Gaussian, ﬂat prior in SSB reconstruction

y-centroid

Gaussian, ﬂat prior in SSB reconstruction

axis ratio
position angle
amplitude
eﬀective radius
S´ersic index

ﬂat
ﬂat
ﬂat
ﬂat
ﬂat

centered on starting value, Gaussian σ =
0.3
centered on starting value, Gaussian σ =
0.3
single-band: [0.3, 1], multi-band: [0.1, 1]
[0, 360]
[0.01, 10]
[0.01, 10]
single-band: [0.5, 6], multi-band: [0.4,9]

Table 3. Overview of S´ersic parameters and their priors. The S´ersic parameters are varied during lens light modeling and the modeling of the arc
light with SSB reconstruction. The position angle is measured counterclockwise from the positive x-axis (East of North).

same centroid is added to the model for the primary lens light.
The code runs optimizing and sampling cycles until the criterion
deﬁned with Eq. (8) is met. We model the light of the satellites
with S´ersic proﬁles once the chain of the model for the primary
lens light has converged according to Eq. (8). The user is queried
to replace the masks such that the satellites are not masked any-
more. The model is then optimized and sampled until the crite-
rion in Eq. (8) is fulﬁlled. If this converged model of the primary
lens light and of the satellite galaxies’ light still does not fulﬁll
Eq. (6), the user is asked to either add a third S´ersic proﬁle, re-
ﬁne the masks, or continue with the next modeling step directly.
In the ﬁrst two cases the code again runs an optimizing/sampling
cycle until the ∆logP criterion (Eq. 8) is met.

2.1.3. Quasar light modeling

After the lens light modeling procedure (see Sec. 2.1.2 and
Fig. 3), i.e., when we have obtained a good ﬁt for the lens and
the satellite light, the code continues by modeling the light of
the lensed quasar. Now we mask only the luminous objects sur-
rounding the lens system, i.e., we remove the arc mask such that
the model now includes the lensed quasars and arcs. For each
quasar image, we add a point-like light component, which is
represented by the PSF and initially centered on the positions
given by the user. The PSF used here is subsampled for images
4′′ to include the diﬀrac-
with pixels >0.05′′and extends
∼
tion spikes. We only allow the quasar positions and amplitudes
to vary; the S´ersic lens light parameters are ﬁxed. To infer the
best-ﬁt parameters for the quasar images, we use again simu-
lated annealing and MCMC with a sampling covariance matrix
obtained from an earlier MCMC chain. We stop the quasar light
modeling when approximate convergence of the chain (Eq. 8) is
achieved.

4′′×

2.1.4. Lens mass distribution modeling with source/image

positions

With the quasar image positions obtained from the quasar
light modeling (see Sec. 2.1.3), we can model the mass dis-
tribution of the lens galaxy using the mapped source posi-
tions and subsequently the image positions. The modeling code
queries the user for the choice of the lens mass proﬁle. Our
automated modeling code supports both a Pseudo Isothermal
Elliptical Mass Distribution (PIEMD; Kassiola & Kovner 1993)
and a Singular Power-law Elliptical Mass Distribution (SPEMD;
Barkana 1998). The steps conducted in the modeling of the lens
mass distribution with source and image positions are visualized
in Fig. 4.

The dimensionless surface mass density (or convergence) of

the SPEMD proﬁle is given by

2 ˜γPL

κSPEMD(x, y) = (1

−

˜γPL) 

θE
xm)2 + (y

ym)2
−
qm

qm(x

−

q







,

(9)

∇

where (xm, ym) is the lens mass centroid, qm is the axis ratio of
the elliptical mass distribution, rc is the core radius which we
1)/2 is the radial proﬁle slope
set to 1
(where γPL is the power-law slope of the three-dimensional mass
density ρ(r)

4, and ˜γPL = (γPL −
r−

γPL ).

10−

×

The convergence κ is related to the lens potential ψ(~θ) via
2ψ(~θ) = 2κ. The scaled deﬂection angle for computing the
∇
deﬂection of light rays is the gradient of the lens potential:
α(~θ) =

ψ(~θ).

∝

An overview of the mass parameters and their priors is
shown in Table 4. The isothermal PIEMD proﬁle is a special
case of the SPEMD proﬁle, where ˜γPL=0.5 holds (although with
slightly diﬀerent parameterizations for the κ) in Eq. (9). In case
of the SPEMD proﬁle, our uniform modeling pipeline ﬁrst keeps
the power-law index ﬁxed to the isothermal case ˜γPL=0.5. Only
later when the code models the light of the arc (Sec. 2.1.5), we
allow ˜γPL to vary between 0.3 and 0.7.

Constraining the lens mass parameters is ﬁrst done by mod-
eling a source position that reproduces the observed image posi-
tions of the quasars. First, the position of the source is obtained
by using the lens equation

~βi = ~θi

−

~αi(~θi),

i = 1, ..., Nim,

(10)

where the image positions ~θi = (xQSO,i, yQSO,i) are mapped back
to the source plane with the scaled deﬂection angle ~αi(~θi). Nim is
the image multiplicity of the system. The lens mass parameters
~η are then varied to minimize the quantity

χ2
sr =

Nim

Xi=1

~βi(~η, ~θi)
|

~βmod(~η, ~θi)

−
( σi
√µi

)2

2

|

,

(11)

with ~βi the mapped source position for image i, ~βmod the modeled
source position (i.e., the mean of the mapped source positions,
weighted by the magniﬁcation), σi the positional uncertainty on
the image plane (we use 0.004′′), and µi the magniﬁcation of
image i. We use simulated annealing to optimize the parameters
until χ2

Given the model obtained by minimizing the χ2

sr, which is
based on the mapped source positions, the parameter values are
further optimised by using the image positions as constraints.

sr < 5.

7

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Component

Parameter Description

Prior

xm [′′]

x-centroid

Gaussian; ﬂat prior in SSB reconstruction

primary

deﬂector
(PIEMD/
SPEMD)

satellite
deﬂector(s)
(SIS)

external
shear

ym [′′]

qm
φm [◦]
θE [′′]
rc [′′]
˜γPL

xm,sat [′′]
ym,sat [′′]
qm,sat
φm,sat [◦]
θE,sat [′′]
rc,sat [′′]
˜γsat

γext
φext [◦]

y-centroid

Gaussian; ﬂat prior in SSB reconstruction

axis ratio
position angle
Einstein radius
core radius
power-law index (SPEMD)

ﬂat
ﬂat
ﬂat
exact
exact; ﬂat in SSB modeling

x-centroid
y-centroid
axis ratio
position angle
Einstein radius
core radius
power-law index

magnitude
position angle

exact
exact
exact
exact
ﬂat
exact
exact

ﬂat
ﬂat

Prior range / value

centered on starting value, Gaussian
σ = 0.3
centered on starting value, Gaussian
σ = 0.3
[0.3, 1]
[0, 360]
[0.5, 3]
4
10−
0.5; [0.3, 0.7]

ﬁxed to satellite light centroid
ﬁxed to satellite light centroid
1
0
[0.01, 3]
4
10−
0.5

[0, 0.6]
[0, 360]

Table 4. Overview of lens mass parameters and their priors throughout the modeling process. The position angles φm, φm, sat, and φext are
measured counterclockwise from the positive x-axis (East of North). In case of the centroid coordinates, the modeling code starts with a Gaussian
prior centered on the starting value obtained from the user input, which is removed after lens light modeling. The power-law index ˜γPL is ﬁxed to
0.5 (isothermal) in the beginning and changed to a ﬂat prior during arc light modeling and SSB reconstruction.

In the case of a satellite galaxy close to the lensing system, we
can model its mass distribution with a singular isothermal sphere
(SIS) proﬁle. The satellite mass centroid is ﬁxed to the satellite
light centroid obtained in Sec. 2.1.2. In addition, the user can
choose to add an external shear proﬁle to the model after the
code has constrained the lens mass parameters with the modeled
source position. This accounts for the tidal gravitational ﬁeld of
objects surrounding the lensing system. The shear magnitude is
ext,1 + γ2
γ2
calculated by γext =
ext,2, with γext,1 and γext,2 the
components of the shear matrix. The parameters ~η are varied to
minimize

q

χ2
im =

~θobs
i −
|

Nim

Xi=1

(~η, ~βmod)

~θpred
i
σ2
i

2

|

,

(12)

i

and ~θpred
i

with ~θobs
the observed and the predicted position for
image i, respectively. Again, the code optimizes with simulated
annealing until χ2
im < 5. Afterwards it samples with MCMC
chains until approximate convergence (∆logP

5).

≤

2.1.5. Lens mass distribution modeling with surface

brightness distribution

Once the lens mass distribution is modeled by using the mul-
tiple quasar image positions, we proceed to constrain the lens
mass parameters by modeling the SB distribution of the unlensed
source and the light of the arc, which is the lensed light of the
quasar host galaxy. We illustrate the following modeling steps
with a ﬂowchart in Fig. 5.

Our automated modeling pipeline uses GLEE to reconstruct
the most probable SSB distribution on a pixelated grid through
a linear inversion of the pixel
intensities in the arc mask
(Suyu et al. 2006). The optimizing/sampling of the posterior
probability distribution includes both the χ2
SB term in Eq. (5) and
a prior term that acts on the source pixels with a quadratic reg-
ularizing function. The SSB distribution is then mapped back to

8

the image plane to reconstruct the arc light. We use the proper-
ties of the arc light to further constrain the lens mass parame-
ters. The inferred quasar light intensity in the image cutout (see
Sec. 2.1.3) is a superposition of the real quasar amplitude and
a roughly constant contribution from the lensed host light. To
reconstruct the light of the host galaxy, we lower the parameter
value of the quasar amplitude. The new amplitudes are deter-
mined such that the condition

Icirc,avrg = 3

Iarc,avrg

×

(13)

is fulﬁlled, where Icirc,avrg is the average intensity in a circle with
a radius of 4 pixels around the center of the quasar after the
quasar and lens light is removed, and Iarc,avrg is the average inten-
sity of a region provided by the user that contains a small patch
of arc light. The factor of 3 is chosen empirically such that the
ﬂux is continuous across the arc. Our automation code then ad-
justs each quasar amplitude such that the criterion in Eq. (13) is
met. For the optimizing/sampling process, we ﬁrst allow the lens
mass parameters, including now also the power-law index ˜γPL of
the SPEMD proﬁle, and the quasar amplitudes to vary, while ﬁx-
ing all the parameters of the lens/satellite light proﬁles and the
quasar centroids. From this point on, we remove the Gaussian
prior of the lens galaxy centroids in the lens mass and S´ersic
proﬁles.

To sample the parameter space eﬃciently, we use EMCEE,
an ensemble sampler based on MCMC chains that is highly
parallelizable (Foreman-Mackey et al. 2013). With EMCEE, we
obtain a sampling covariance matrix for the parameter space,
which makes the subsequent sampling with Metropolis-Hastings
MCMC more eﬃcient. We consider this modeling part success-
ful, when the Metropolis-Hastings chain has approximately con-
verged, now with a stricter requirement:

∆logP

2.

(14)

≤
The quasar images are much brighter than the light of the
arc, and residuals of quasar light ﬁtting with imperfect PSF can
often overwhelm the signal in the arcs. Therefore, we allow for

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

PIEMD or
SPEMD?

Source position
modeling
(simulated annealing)

No

Yes

Add external
shear?
(user input)

Image position
modeling
(simulated annealing)

No

Yes

MCMC sampling
until

Arc light modeling +
SSB distribution
reconstruction
(see Sec. 2.1.5 / Fig. 5)

Fig. 4. Flowchart showing the decision tree for the lens mass
distribution modeling with source/image positions. After the user
speciﬁes a lens mass proﬁle (PIEMD or SPEMD), the code models the
lens mass distribution ﬁrst by using the modeled source position, and
then by using the positions of the multiple quasar images with the
option to include an external shear component to the model. Both steps
use simulated annealing until the respective χ2 is below 5. The image
position modeling is completed after an approximately converged
MCMC chain is achieved. After this, the code continues the lens mass
modeling with the arc light modeling and reconstruction of the SSB
distribution.

Lower quasar amplitudes

Optimize lens mass
parameters
and quasar amplitudes

Model from
source/image position
modeling

EMCEE to obtain
sampling
covariance matrix

Optimizing/sampling
cycle until

EMC

cova

Optim

Full
convergence?

No

Optimizing/sampling
cycle

Fig. 5. Flowchart for arc light modeling and SSB reconstruction. In the
ﬁrst stage, the quasar amplitudes are lowered, and in the second stage,
the error map is boosted in the bright quasar regions, in order to model
the light of the arc. The lens mass parameters are allowed to vary in
this modeling step. In a ﬁnal step, the code runs optimizing and
sampling cycles until full convergence of the chain is achieved.

±

bigger uncertainties in the quasar image areas by boosting the
error map in these regions. The user marks the areas dominated
by quasar light, and the code will boost all the pixels of the error
map within this region such that their normalized residuals are
1σ. The error map can also be boosted in the satellite
within
galaxy region if the user chooses to do so. This can be neces-
sary if the satellite galaxy is very close to the arc of the lensing
system. In the next modeling step, now including the boosted
error map, we ﬁx all quasar light parameters and allow the lens
mass and the lens light parameters to vary. If the uncertainties
in the satellite region are not boosted the satellite light parame-
ters are varied as well. We use EMCEE again to obtain a sampling
covariance matrix and optimize/sample with simulated anneal-
ing/MCMC until approximate convergence of the chain (Eq. 14)
is achieved. In a last step, the code checks the model for full con-

9

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

vergence by analyzing the discrete power spectrum of the chain
(following Dunkley et al. 2005). If full convergence is not yet
achieved, the code runs optimizing and sampling cycles with an
increased chain length by now sampling 200,000 points. When
full convergence is achieved, the code stops and the modeling is
completed.

2.2. Multi-bandmodeling

In addition to the single-band automation code described in
Sec. 2.1, we developed a code to model simultaneously systems
with strongly lensed quasars using multi-band data. The model-
ing procedure is in most parts analogous to the single-band case
and described in Table 5. We present an overview ﬂowchart in
Fig. 6.

Single(cid:14)(cid:15)(cid:16)(cid:17)d
models

Alignment
of ﬁlters

L(cid:0)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)sar
l(cid:7)(cid:8)(cid:9)(cid:10) (cid:11)(cid:12)(cid:13)eling
(see Sec. 2.1.2 / 2.1.3)

Image position
modeling
(see Sec. 2.1.4)

Arc light modeling +
SSB distribution
reconstruction
(see Sec. 2.1.5)

Fig. 6. Overview ﬂowchart for multi-band modeling of a lensed quasar
system with the multi-band GLEE automation code. Details are
described in ﬂowcharts for each step and in the corresponding
subsections, as referenced in the ﬂowchart.

Once we obtain a single-band lens mass model in one band
(the reference band) and a lens and quasar light model in the
other bands with the pipeline described in Sec. 2.1, we proceed
to model jointly the lens and quasar light in all the considered
bands. We choose the F160W band as our reference band un-
less otherwise speciﬁed, because the arc light is most prominent
in this wavelength. We use the modeled quasar positions of the
individual bands to align the multiple ﬁlters. The lens mass dis-
tribution model in the reference ﬁlter serves as a starting model
for the multi-band modeling.

In the ﬁrst step, we pair the reference ﬁlter with one of the ad-
ditional ﬁlters and model the lens and quasar light together with
MCMC chains. We ﬁx the amplitudes of the lens light compo-
nents in the reference ﬁlter and force the lens light amplitudes in

10

the other ﬁlter to follow the same ratio of light amplitudes as in
the reference ﬁlter. In addition, we link the remaining lens light
parameters (centroid, axis ratio, position angle, eﬀective radius,
and S´ersic index) between the ﬁlters. The quasar light centroids
are linked as well, while the quasar amplitudes vary indepen-
dently. After a MCMC chain is approximately converged with
∆logP
5, we ﬁx the lens light amplitudes of this ﬁlter and add
the next ﬁlter which is modeled together with the reference ﬁl-
ter in the same way as the ﬁlter before. We let the quasar light
parameters of the previous ﬁlters vary too.
Once approximate convergence (∆logP

5) is achieved for
all pairs, we model the lens and quasar light parameters of all
ﬁlters simultaneously and allowing now all lens light amplitudes
to vary independently while keeping the remaining lens light pa-
rameters and quasar light centroids linked.

≤

≤

Like in the single-band modeling, the modeled quasar posi-
tions are then used for image position modeling (see Sec. 2.1.4)
to constrain the lens mass parameters. In the last step, the light of
the arc and the SSB distribution are reconstructed analogous to
the single-band modeling case described in Sec. 2.1.5. Finally,
we run additional MCMC chains to achieve full convergence of
our lens model parameters.

2.3. Time delayestimates

Strong lensing time-delay cosmography requires time-delay
measurements and thus observational programs that monitor the
lensed quasars. To facilitate the scheduling of the monitoring,
estimations of the time delays of new quasar systems are use-
ful. Furthermore, a comparison of the (blind) prediction of the
time delays to the subsequently measured time delays provides
a crash test of mass modeling procedures (Treu et al. 2016).

Once we obtain a good model for the lens potential ψ(~θ) of
the system from the previous subsections, we can use it to com-
pute the relative time delays between the diﬀerent images. If the
redshifts of the lens (zd) and of the source (zs) are available, then
we can calculate the time-delay distance

D∆t = (1 + zd)

DdDs
Dds

(15)

by assuming a cosmological model. The distances on the right-
hand side Dd, Ds and Dds are, respectively, the angular diameter
distance to the deﬂector/lens galaxy, to the source galaxy, and
between the deﬂector and source galaxy. With the time-delay
distance, GLEE can calculate the time delays between the quasar
images i and j:

∆ti j =

1
c

D∆t∆τi j,

(16)

where

∆τi j =

1
2

"

(~θi

−

~β)2

−

ψ(~θi)

# − "

1
2

(~θ j

−

~β)2

ψ(~θ j)

#

−

(17)

is the Fermat potential diﬀerence between quasar images i and j
which is obtained from the ﬁnal lens mass model. We have a sep-
arate code, that calculates the time-delay distance from Eq. (15)
and the relative time delays from Eq. (16) including 1σ uncer-
tainties by using the ﬁnal MCMC chain of the model parameters
from the modeling code and the cosmological parameters pro-
vided by the user.

 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Step Description

Section

Criteria

Lens mass parameters

Lens light

Source light

proﬁles

ext. shear

quasar

host

1

2

3

4a

4b

pair each band with reference ﬁlter and model lens
+ quasar light together

modeling of lens + quasar light with all bands at
once

image position modeling with external shear

modeling of arc light + SSB distribution recon-
struction

modeling of arc light + SSB distribution recon-
struction

2.1.2/
2.1.3,
2.2

2.1.2/
2.1.3,
2.2

2.1.4,
2.2

2.1.5,
2.2

2.1.5,
2.2

(cid:9)2 (χ2

red ≤

1)

(cid:9)2 (∆logP

5)

≤

(cid:9)1 (χ2 < 5,
∆logP
5)
(cid:9)2 (∆logP

≤

≤

(cid:9)2 (∆logP

≤

2)

2)

(cid:13)

(cid:13)

X

X

X

(cid:13)

(cid:13)

X

X

X

X

X

(cid:13)

(cid:13)

X

X

X

(cid:13)

XA

(cid:13)

×

×

×

X

X

Symbols:

(cid:9)1: optimizing cycle with simulated annealing
(cid:9)2: optimizing and sampling cycle with simulated annealing and MCMC
XA: only amplitude varying

X: parameters varying
: parameters ﬁxed
: parameters not included

(cid:13)
×

Table 5. Overview of the diﬀerent modeling steps conducted in the multi-band modeling code. Each step is described brieﬂy in the second
column. The modeling technique and stopping criteria are given in the third column with the symbols described under the table. The cycle runs
until the stopping criteria in the parentheses are met. The remaining columns show which parameters are varying, ﬁxed, or not included.

3. Observations

−

−

−
−

3814 (Schechter et al.

Our sample consists of the nine strongly lensed quasars DES
2105
J0029
in prep), DES J0214
(Agnello & Spiniello 2019; Lee et al. 2019), DES J0420
4037
(Ostrovski et al. in prep), PS J0659+1629 (Delchambre et al.
2019), 2M1134
2103 (Lucey et al. 2018; Rusu et al. 2019),
3010 (Lemon et al. 2019; Delchambre et al. 2019;
J1537
2333 (Lemon et al. 2018), PS
Stern et al. 2021), PS J1606
−
J1721+8842 (Lemon et al. 2018), and DES J2100
4452
(Agnello & Spiniello 2019). A detailed description of the obser-
vations and the peculiarities of each lensing system are presented
by S22. In Fig. 7 we show a color image that was created with
the three HST bands F160W, F475X, and F814W used as the
red, blue, and green channels, respectively.

−

−

4. Modeling results

In this section, we describe the modeling results of our sam-
ple of lensing systems obtained with our autonomous modeling
pipeline presented in Sec. 2. The input ﬁles for each lensing sys-
tem, i.e., PSF, error map, and masks, were obtained by following
Sec. 2.1.1. Each system is modeled with a SPEMD proﬁle and
external shear. The lens light is modeled with two S´ersic proﬁles
unless speciﬁed otherwise in the following subsections. For two
systems (J0659+1629 and J1606
2333) we additionally model
the light and mass distribution of a close-by satellite galaxy. We
decide which bands to include by visual inspection of the residu-
als after modeling lens and quasar light, i.e., the remaining light
from the arcs, which are the lensed host galaxy of the quasar.
If there is signiﬁcant arc light in one wavelength band, then we
include that band in the ﬁnal multi-band model.

−

In Table 6 we present ﬁgures of the modeled light and re-
constructed source for each of the nine lensing system in our
sample. We show the observed image (third column), the mod-
eled light and critical curves (fourth column), and the normal-
5σ and 5σ (ﬁfth column).
ized residuals in a range between

−

For each pixel, the normalized residuals show the diﬀerence be-
tween data and model, normalized by the estimated standard de-
viation. We show cropped images instead of the full cutout used
for modeling for better visibility and indicate 1′′ with a white
line. The panels are oriented such that North is up and East is
left. The sixth column shows the reconstructed SSB distribution
of the quasar host galaxy on the image plane. The seventh col-
umn shows the SSB distribution on the source plane with plotted
caustic curves in red, and the mean, weighted source position of
the quasar as a blue star. We show rulers with length of 0.5′′ in
x- and y-direction because the pixel size can be diﬀerent in those
directions.

In Table A.1, we present the median parameter values of the
lens mass distribution together with their 1σ uncertainties from
the ﬁnal chain of each multi-band model. We also show the best-
ﬁt lens and satellite light parameters in the F160W band (the
reference ﬁlter). The centroid coordinates are with respect to the
bottom-left corner of the image cutout. The light parameters in
the F475X and F814W bands are presented in Tables B.1 and
B.2, respectively.

κ)2 + γ2

In Table 7 we summarize the single-band χ2

red of each mod-
eled band, and a total χ2
red,tot, which is the sum of the independent
single-band χ2 divided by the DOF of the multi-band model. We
exclude pixels masked in the lens mask and the boosted quasar
light regions in computing the DOF via eq. (7). In Table A.2 we
present the convergence κ, total shear strength γtot, and magniﬁ-
cation µ = 1/((1
tot) at the (modeled) image positions.
In addition, we calculate the Fermat potential diﬀerences at
the multiple, modeled image positions, and predict the relative
time delays for each system. We use the redshifts mentioned in
0.5
Sec. 3. If the redshifts are not available yet, we assume zd ≡
and zs ≡
2. The results are shown in Tables A.3 and A.4.
Since the lens light is described by multiple S´ersic compo-
nents, we calculated the second brightness moments of the pri-
mary lens light model to compare the median centroid, axis ra-
tio, and position angle to that of the mass distribution. The result

−

11

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Fig. 7. Color images for each of the nine lenses in our sample created with the three HST bands F160W (red), F475X (blue), and F814W (green).

is shown in Fig. 8. The mass and light centroid align well in
most cases within one pixel (0.08′′) with the exception of PS
J0659+1629 which shows a big oﬀset in the x-centroid. The po-
sition angle of mass and light agree mostly well within
10° for
5/9 systems. The biggest oﬀset is also reached for J0659+1629
with
50◦. For the axis ratio, the models do not follow the 1:1
relation so closely. Five models tend to be more elliptical in mass
compared to the light where four of them either have a satellite or
are highly sheared which could explain the low mass axis ratio.

∼

∼

Individual modeling details for each lensing system are dis-

cussed further in the following subsections.

12

4.1. DES J0029-3814

This lensing system was modeled solely in the IR F160W band.
In the remaining bands suﬃcient arc light from the host galaxy
could not be identiﬁed by eye . We used two S´ersic proﬁles and
a central point source component for the primary lens light. The
PSF was estimated by selecting two stars in the ﬁeld. The best-
ﬁt parameters in Table A.1 show that the centers of the mass
and light distribution are oﬀset by
0.04′′ in x-direction and by
0.2
∼
with a low position angle (14◦), which is possibly due to the
overdense environment to the North of the lensing system.

0.02′′ in y-direction. We obtain a high shear magnitude of

∼

∼

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

4.2. DES J0214-2105

We modeled this system in all three considered bands (F160W,
F475X, and F814W) and noticed a strong underﬁtting of the
quasar amplitudes in the F475X band after step 5(a) (see Table
5). This can be due to the faint arc light and an imperfect PSF
model resulting in higher residuals in the multiple quasar im-
age regions. The underﬁtting is not directly obvious from the
residuals because the missing quasar amplitude is compensated
by high source intensity values in a single pixel. To avoid neg-
ative impact of this band on the lens mass model, we present
the F160W single-band model. The PSF was approximated with
one star from the ﬁeld in the F160W band, and 2 stars in each
of the F475X and F814 bands. The centers of the mass and light
distribution are very well aligned with an oﬀset within
0.01′′.

∼

4.3. DES J0420-4037

−

This lensing system was modeled in all three bands. As in the
case of J0214
2105, the quasar amplitudes in the F475X band
are strongly underﬁtted. We present the F160W single-band
model results. We approximated the PSF in the F160W band by
choosing two stars in the ﬁeld; for the F475X and F814 bands,
we used one star. Mass and light show a small oﬀset of < 0.01′′
in the x-direction and
0.01′′ in the y-directions. The modeling
residuals indicate the presence of several light clumps near or in
the arc. We conﬁrmed two of them to be counter images, which
hints at the presence of a second, lensed background source.

∼

4.4. PS J0659+1629

This lensing system was modeled in the IR F160W band because
of insuﬃcient arc light in the other bands. We also include an SIS
proﬁle for the satellite mass and a S´ersic proﬁle for the satellite
light. The satellite is very close to the northern-most quasar im-
age, thus we boost the error map in the satellite region in the
same way as the quasar images in the last modeling step. The
PSF was estimated with four stars from the ﬁeld. We found two
very faint light clumps in the residuals, which are at positions
that suggest them to be counter images of a second, lensed back-
ground source at a similar redshift as the ﬁrst source. The dark
region in the source light reconstruction at the satellite position
does not have an eﬀect on the mass model since its counter im-
age lies outside the reconstruction region (arc mask). Also for
this system the quasar amplitudes are underﬁtted after step 5(a)
(see Table 1) which might have an eﬀect on the lens mass model.
This is diﬃcult to overcome with automated modeling proce-
dures, and require individual tweaks that are deferred to future
work for cosmographic analysis. This system shows the biggest
diﬀerence between mass and light in our sample, with an oﬀset
0.05′′ in y-direction. Furthermore,
of
∼
the modeled lens mass distribution is much more elliptical with
∆q = qS −
45°.
This could be due to the presence of the satellite galaxy close to
image D.

0.4 and the position angle is oﬀset by

0.1′′ in x-direction and

qm ∼ −

−

∼

4.5. 2M1134-2103

This system has a faint lens and very bright quasar images,
which makes an exact modeling of the lens light and spectro-
scopic redshift of the lens diﬃcult to obtain. We performed the
modeling in the F160W and F814W bands. The PSF for the
F160W band was estimated by using ﬁve stars. We chose three
stars to build the PSF in the F814W band. The median mass and

light centroid align very well with an oﬀset of less than
0.01′′ in
x-direction and
0.01′′ in y-direction. This system has the high-
est external shear magnitude γext of the sample which is consis-
tent with the elongated shape and the overdense environment in
the ﬁeld of view of this system (Rusu et al. 2019).

∼

∼

4.6. J1537-3010

This system was modeled in all three bands. In each band, we
chose ﬁve stars from the ﬁeld to approximate the PSF. The cen-
ters of the mass and light distribution align very well within
0.01′′. In the model residuals shown in Table 6 we ﬁnd a small
∼
oﬀset between the quasar images and the arc in the bands F475X
and F814W. A possible explanation for this oﬀset is that these
two bands are in the rest-frame UV of the quasar host galaxy and
thus are likely dominated by light from speciﬁc star-forming re-
0.3 hits the
gions in the host galaxy. The power-law slope ˜γPL ∼
lower bound of the prior, which could be due to our imperfect
PSF models in the F475X and F814W models. As we will see
in Sec. 5.2, the PSF has a signiﬁcant eﬀect on ˜γPL. This system
has one of the most prominent arcs in all three HST ﬁlters in our
sample, which is ideal for future cosmographic analysis.

4.7. PS J1606-2333

This lensing system was modeled in the F160W band with two
S´ersic proﬁles and a central point source component for the pri-
mary lens light. Although we initially included the other bands
because they show signiﬁcant arc light, the source reconstruc-
tion shows no visible source (above the noise level) in these
bands. We exclude these bands and optimize only the single-
band model. For this lensing system, the PSF was stacked from
5 neighboring stars. There is a bright light clump in the South be-
low image B which is embedded in a faint, extended structure.
We assume this clump to be a satellite at the same redshift as
the lens galaxy and include an SIS proﬁle for the satellite mass
and a S´ersic proﬁle for the satellite light. The error map was
boosted at the satellite position in the last modeling step because
of its proximity to the arc. Mass and light align very well within
0.01′′. The power-law slope of this system is close to the lower
∼
0.31. Again, this could be due to
bound of the prior with ˜γPL ∼
an imperfect PSF model.

4.8. PS J1721+8842

This is an unusual and interesting lens system with 6 quasar im-
ages. It is composed of two quasar sources at the same redshift,
with one quasar lensed into a quad (images A, B, C, and D) and
the other one lensed into a double (images E and F) (Lemon et al.
2021). Most of the arc light in this system comes from the dou-
ble system, so we only include these regions for the arc light
modeling and SSB reconstruction. We modeled this system in
all three considered bands with two S´ersic proﬁles and a central
point source component for the primary lens light. We picked
three stars from the ﬁeld to approximate the PSF in the F160W
band, and one star in each of the F475X and F814W bands. The
second source component was added manually since the current
version of the automation code does not support an automated
detection of multiple source components. It is represented as a
green star in the source reconstruction plot in Table 6. Quasar
image F is oﬀset relative to the arc’s peak SB, possibly due to the
quasar being kicked out of its host galaxy (Mangat et al. 2021).
We use F475X as the reference band, because image F is not

13

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

clearly distinct from the arc in the F160W band where the arc
is the brightest. The oﬀset introduces a challenge to the quasar
and arc light modeling. We see negative source intensity at the
position of the second source component. The mass and light
centroids are oﬀset by
0.04′′ in the x-direction and align very
well within

0.01′′ in the y-direction.

∼

∼

4.9. DES J2100-4452

The ﬁnal model of this system includes only the F160W band.
The F475X and F814W bands show small hints of arc light,
but including these bands in the model lead to no visible source
reconstruction. The PSF was created by using ﬁve stars. There
seems to be a dust lane crossing the lens galaxy from North to
South whose inﬂuence on the model needs to be investigated in
future work. The dust lane can be seen best in the bluest band (in
our case the F475X band) and given its rest frame wavelength of
1.3 microns in the F160W band the eﬀect on the model should
be minimal. The mass is oﬀset relative to the light by
0.04′′ in
x-direction and by

0.06′′ in y-direction.

∼

∼

14

System

Filter

Observed

Model

Normalized
residuals

Reconstructed
arc

Reconstructed
source

DES J0029

−

3814

F160W

DES J0214

−

2105

F160W

DES J0420

−

4037

F160W

1"

1"

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

N

E

N

E

N

E

1"

1"

1"

N

E

0.5"

N

E

0.5"

N

E

0.5"

0.045

0.030

0.015

0.000

0.015

0.030

0.24

0.20

0.12

0.04

0.00

0.4

0.2

0.0

0.2

0.4

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

Table 6. Lens modeling results of the nine systems in HST ﬁlters where the arcs are visible, as indicated in the ﬁrst two columns. Column (3): the observed HST image. Column (4): reconstructed
image from our most probable model with critical curves (blue, solid lines). Column (5): normalised image residuals, i.e., the diﬀerence between (3) and (4), normalised by the estimated 1σ
uncertainties. Column (6): reconstructed intensity distribution of the lensed quasar host galaxy. Column (7): reconstructed quasar-host intensity distribution on a grid of pixels with caustic curves
(red, dashed lines) and mean, weighted source position of the quad (blue star) and double (green star) quasar systems. We show cropped images instead of the full cutout used for modeling for
better visibility. The horizontal white line shows 1” for each system and the ﬁgures are oriented such that North is up and East is left. The white lines in the source reconstruction indicate lengths of
0.5” in x- and y-direction.

1
5

0
(cid:18)
(cid:19)
(cid:20)
(cid:21)
(cid:22)
(cid:23)
(cid:24)
(cid:25)
(cid:26)
(cid:27)
(cid:28)
(cid:29)
(cid:30)
(cid:31)
 
!
"
#
$
%
&
’
(
)
*
+
,
-
1
6

System

Filter

Observed

Model

Normalized
residuals

Reconstructed
arc

Reconstructed
source

PS J0659+1629

F160W

2M1134

−

2103

F160W

F814W

J1537

−

3010

F160W

Table 6 continued.

1"

1"

1"

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

N

E

N

E

N

E

N

E

1"

1"

1"

1"

0.5"

N

E

N

E

0.5"

N

E

0.5"

N

E

0.5"

0.20

0.15

0.10

0.05

0.00

0.05

0.10

0.15

3.0

2.4

1.2

0.0

0.45

0.30

0.15

0.00

0.15

0.30

0.45

2.1

1.5

1.2

0.3

0.0

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

.
/
1
2
3
4
5
6
7
8
9
:
;
<
=
>
?
@
A
B
C
D
E
F
G
System

Filter

Observed

Model

Normalized
residuals

Reconstructed
arc

Reconstructed
source

F475X

F814W

PS J1606

−

2333

F160W

PS J1721+8842

F160W

Table 6 continued.

1
7

1"

1"

1"

1"

N

E

1"

N

E

1"

N

E

N

E

1"

1"

N

E

1"

N

E

1"

N

E

1"

N

E

1"

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

N

E

N

E

N

E

N

E

1"

1"

1"

1"

N

E

0.5"

N

E

0.5"

0.5"

N

E

N

E

0.5"

0.45

0.30

0.15

0.00

0.40

0.32

0.24

0.00

3.0

2.4

1.2

0.0

45

30

15

0

15

30

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

H
I
J
K
M
N
O
P
Q
R
S
T
U
V
W
X
Y
Z
[
\
]
^
_
‘
a
b
c
d
f
g
h
i
j
k
m
n
o
p
q
r
1
8

System

Filter

Observed

Model

Normalized
residuals

Reconstructed
arc

Reconstructed
source

F475X

F814W

DES J2100

−

4452

F160W

Table 6 continued.

1"

1"

1"

N

E

1"

N

E

1"

N

E

N

E

1"

1"

N

E

1"

N

E

1"

5

4

3

2

1

0

5

4

3

2

1

0

5

4

3

2

1

0

1

2

3

4

5

1

2

3

4

5

1

2

3

4

5

N

E

N

E

N

E

1"

1"

1"

N

E

0.5"

N

E

0.5"

N

E

0.5"

0.045

0.030

0.015

0.000

0.015

0.030

0.20

0.12

0.04

0.00

0.04

0.5

0.4

0.3

0.2

0.1

0.0

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

s
t
u
v
w
x
y
z
{
|
}
~
(cid:127)
(cid:128)
(cid:129)
(cid:130)
(cid:131)
(cid:132)
(cid:133)
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

System

J0029

−

χ2

red,160
0.80

3814

2103

2105
J0214
−
J0420
4037
−
J0659+1629
2M1134
−
3010
J1537
−
J1606
2333
−
J1721+8842
4452
J2100

−

0.74
0.56
1.08
2.76
1.62
1.36
0.51
0.94

χ2

red,475

χ2

red,814

−

−
−
−
−
1.08

−
1.16

−

−

−
−
−
1.62
1.18

−
0.96

−

χ2

red,tot
0.80

0.74
0.56
1.08
1.84
1.18
1.36
0.94
0.94

Table 7. χ2

red for each individual band with total χ2

red,tot.

5. Discussion

5.1. Comparison of automated modelingto manual modeling

with GLEE

In this section we compare the automated modeling with our
automation code and the manual modeling of a lensing system
with GLEE based on the total time the user actively spends on
modeling a lensing system.

∼

∼

∼

∼

2 hours to

We report a signiﬁcant reduction of preparation time for the
15
input ﬁles. The creation of the image cutout is sped up from
minutes to
5 minutes in the automated modeling. The time for
creating the error map stays roughly the same, because this was
already automated prior to this work. The mask regions are in
both cases obtained by eye and marked manually, but the cre-
ation of the masks from the region ﬁles is now fully automated.
This automation halves the user input time from roughly 1 hour
in the manual case to
30 minutes when using the automation
code. The time for creating the PSF is signiﬁcantly reduced from
15 minutes in case of the automated modeling.
∼
When using the PSF code, the only step the user has to conduct
in order to obtain the PSF is to ﬁnd suitable stars in the ﬁeld and
save their positions. The time-consuming, technical steps like
saving the region ﬁle, stacking them together, subsampling if re-
quested, and normalizing to create the PSF are fully automated.
For the actual lens modeling process, we can also report a
signiﬁcant time reduction. The initial setup of the GLEE con-
ﬁguration ﬁle, which also includes estimations for the starting
values of the parameters, is of the order of an hour when mod-
eling manually. In the automated case, the user only has to pro-
vide a region ﬁle which can be created within 10 minutes. The
setup of the conﬁguration ﬁle and the estimations for the start-
ing values is fully automated, so it is not necessary for the user
to learn how to use GLEE (e.g., how to set up the GLEE conﬁgura-
tion ﬁle). Quality control and modiﬁcations to the conﬁguration
ﬁle between diﬀerent modeling steps are also fully automated,
yielding a time saving again of the order of hours over the full
modeling process. Also, there is no waiting time between the
multiple MCMC chains and the code obtains the optimal sam-
pling parameters automatically. Together with short interaction
between the user and the code, and the inspection of the output,
we estimate an average of 1 hour of total user time per lens-
ing system for the automated modeling process. Table 8 gives a
comparison between user input time in the automated and in the
manual modeling case.

The computational time for the arc light modeling and SSB
distribution reconstruction depends mainly on the arc mask and
PSF size. The optimizing and sampling cycles with simulated
annealing and MCMC chains use one core at a time. We used

∼

∼

EMCEE, which is highly parallelizable, to obtain an initial sam-
pling covariance matrix at the beginning of the last modeling
steps (5(a) and 5(b) in single-band, and 4(a) and 4(b) in multi-
band modeling) with a chain length of 400,000 on a cluster with
Intel Xeon E5-2640 v4 CPU using 30 cores. The average com-
putation time on the cluster for each EMCEE chain is
5 hours.
Because of typical overhead in parallel computing we estimate
the single core computation time for each EMCEE chain of
100
hours. EMCEE sampling is used twice in the automated model-
ing procedure, and thus we have a total EMCEE computation time
of
200 hours per core. With this setup and modeling speciﬁca-
tions we estimate the average computation time per core per lens
system for each modeling step described in Sec. 2 and summa-
rize them in Table 9. The computationally expensive step of arc
light modeling and SSB distribution reconstruction takes 15 to
20 days with a single core. Because of parallelization of EMCEE
the eﬀective computation time ranges between 7 to 14 days.
When only approximate (and not full) convergence of a chain
is suﬃcient, models can already be expected after 5 to 7 days.
These models don’t diﬀer much from the ﬁnal model that is fully
converged and can be used for tentative analysis. We expect the
computation time to be roughly the same in both the manual and
the automated modeling.

∼

5.2. Comparison of lens modelingresults between GLEEand

Lenstronomy

5.2.1. Blind comparison

All nine systems of our sample are part of a more extensive sam-
ple of 30 quads that were modeled independently by S22 with
a similiar, automated pipeline based on the lens modeling soft-
ware Lenstronomy. Both modeling frameworks are dedicated
for high-resolution images of lensed quasars and thus use similar
modeling assumptions for the lenses: the lens mass distribution
is modeled with a power-law proﬁle with external shear, and the
lens light distribution is modeled with S´ersic proﬁles.

There are important diﬀerences between the two proce-
dures that need to be taken into account. First, the two soft-
wares have diﬀerent implementation for the SSB reconstruc-
tion: GLEE uses a pixelated grid of source intensity distribu-
tion, whereas Lenstronomy uses circular S´ersic proﬁles with
optional shapelet components in addition. Second, S22 always
model the three available bands of HST images while in this
work we focus only on those where the arcs are clearly visi-
ble by eye, typically F160W. Even though those are the most
informative bands in our 9 system sample, they do not capture
the full information, especially since the resolution is better in
the UV/visible (UVIS) data. Third, diﬀerent priors have been
chosen for some of the key parameters. S22 adopted informa-
tive priors from the SLACS sample (Bolton et al. 2006, 2008;
Auger et al. 2010) on the radial slope of the mass density pro-
ﬁle and the ellipticity of the mass distribution in order to avoid
unphysical solutions when the parameters are poorly constrained
by the data. In this study we opted to adopt uniform priors within
some bounds to constrain the parameters solely by the data at
hand. In the best cases the priors should not matter because the
likelihood should dominate the posterior, but in practice, as we
will see, many of the systems are poorly constrained by the data
and therefore the priors matter. Fourth, S22 adopted an itera-
tive scheme to improve the PSF estimate based on the multiple
images of the quasar, sampled at the scale of the reduced data.
In contrast, in this work we used an subsampled PSF estimated
from images of stars in the ﬁeld, without additional corrections.

19

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

0.10

0.05

J0029-3814

J0214-2105

J0420-4037

J0659+1629

0.00

2M1134-2103

)
c
e
s
c
r
a
(

y
Δ

J1537-3010

J1606-2333

J1721+8842

J2100-4452

−0.05

−0.10

−0.10 −0.05 0.00 0.05 0.10 0.15

Δ x (arcsec)

1.0

0.9

0.8

q

0.7

t
h
g

i
l

0.6

0.5

0.4

0.3

)
s
e
e
r
g
e
d
(
A
P

200

175

150

125

100

t
h
g

i
l

75

50

25

0

0 25 50 75 100 125 150 175 200

0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0

mass PA (degrees)

mass q

Fig. 8. Top: Diﬀerence between the median mass and light centroid of our automated GLEE models, with ∆x = xS −
ym. Bottom
left: Comparison between the median mass and light position angle. Bottom right: Comparison between the median mass and light axis ratio. The
dashed lines show lines of no centroid oﬀset (top), and lines of equal position angle/axis ratio (bottom left)/(bottom right).

xm and ∆y = yS −

Task

User time for manual modeling User time for automated modeling

Creation of image cutout
Creation of error map
Creation of masks
Creation of PSF
Modeling process

∼
∼

15 minutes
10 minutes
1 hour
∼
2 hours
∼
10 hours
∼

5 minutes
∼
10 minutes
∼
30 minutes
∼
15 minutes
∼
1 hour

∼

Table 8. Comparison between user input time for each task in the manual and in the automated modeling of a lensing system. This does not
include computation time, which is summarized in Table 9.

As shown by Shajib et al. (2022) the PSF is a crucial ingredient
for cosmography grade inference.

Keeping the caveats in mind, we compare the lens mass pa-
rameters, external shear parameters, convergence and total shear
at the quasar image positions, image magniﬁcations, Fermat po-
tential diﬀerences, and predicted time delays. The adopted cos-
mology is the same as in S22. We plot in Fig. 9 the results of the
two modeling codes together with a line showing the identity.
In addition, we present the diﬀerence of the median values of
both modeling codes against the GLEE parameter values to better
illustrate the absolute diﬀerences between the ﬁnal results.

20

We ﬁnd excellent agreement in the Einstein radius of the pri-
mary lens galaxy, where the median values agree within 4% for
8/9 systems. This is expected and reassuring that strong lens-
ing provides robust masses enclosed within the Einstein radius.
An apparent outlier is J0659+1629 with a diﬀerence of
0.2′′,
which is due to the presence of a satellite galaxy whose mass is
degenerate with that of the primary lens. We calculated a value
for the “eﬀective” Einstein radius that includes the satellite mass
and compare it to the one that was obtained by S22 for this pur-
pose. Our value of θE,eﬀ,GLEE = 2.368+0.02
0.02′′ matches very well
θE,eﬀ,Lenstronomy = 2.368+0.01
′′ for J0659+1629 (the distribution

∼

−

0

−

 
 
 
 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Modeling step

Section Average computation time

Lens light modeling
Quasar light modeling
Lens mass modeling with source/image positions
Arc light modeling and SSB distribution reconstruction

2.1.2
2.1.3
2.1.4
2.1.5

∼

1 day
∼
1 day
∼
1 minute
∼
15

20 days

−

Table 9. Estimates of average computation time per core per lensing system for each step conducted by the automated modeling code. Note that
the last and most time expensive step is partly parallelized and is thus eﬀectively and notably shorter (

14 days).

7

∼

−

for θE,eﬀ,Lenstronomy is heavily skewed such that the median co-
incides with the 16th percentile). We thus conclude that for all
systems we recover the same Einstein radius to within a root-
mean-square (r.m.s.) scatter of 1.6%, once the proper accounting
for satellites is considered.

Flattening, position angle of the mass distribution, and exter-
nal shear magnitude and direction are strongly degenerate with
each other (and to some extent with the slope) and should there-
fore be looked at holistically. For 6/9 systems the position angles
of the lens mass distribution match within the errors (1 or 2 σ at
most). The outliers are: J0659+1629 for which GLEE converges
to a mass distribution that is highly ﬂattened, more than the light
distribution, and therefore likely not fully correct, while S22 –
driven by the prior – converges to a much rounder distribution;
4037, for which the discrepancy is due
J0214
to a combination of diﬀerences in ﬂattening, PA, and external
shear. We note that for this system the slope of the mass density
proﬁle is poorly constrained without prior, suggesting that the
information content of the data is not suﬃcient.

2105 and J0420

−

−

∼

The mass ﬂattening parameter agrees within

0.1 (larger
than the formal uncertainty, which is therefore underestimated)
except for two cases: i) J0659+1629 discussed above; and ii)
J0029+3814 for which S22 ﬁnds more ﬂattening than GLEE,
perhaps driven by the prior on the axis ratio of the light dis-
tribution. The inferred external shear magnitudes agree within
0.05 (again larger than the formal uncertainty); the two most
discrepant systems are J1537
4452 which are
cases where the slope of the mass density proﬁle is relatively
poorly constrained without prior and therefore are likely to suf-
fer from poor information content of the data. Reassuringly, for
the two systems with the highest shear magnitude we ﬁnd a good
match of the shear position angle.

3010 and J2100

−

−

As mentioned above, a major source of diﬀerence is due to
the prior of the power-law slope ˜γPL, which reverberates through
the other parameters. Not surprisingly, the inferred power-law
slope ˜γPL of the Lenstronomy models obtained by S22 fol-
lows their imposed Gaussian prior that is centered on a close-
to-isothermal value of ˜γPL = 0.54. In contrast, the GLEE models
have slope values spanning the uniform prior range of [0.3,0.7]
with values closer to the bounds than to an isothermal value. As
we discuss before, the diﬀerence arises from a combination of
two factors: diﬀerences in the PSF and insuﬃcient information
in the data to constrain the slope.

Not surprisingly, given the diﬀerences highlighted above, the
inferred quantities κ, γtot, and µ at the image positions show sig-
niﬁcant deviations (see Fig. C.1). We calculate the average rela-
tive scatter of these quantities for each lensing system and ﬁnd
3% to >100%, and the statistical uncertain-
that it ranges from
∼
ties are underestimated in nearly all cases.

The relative Fermat potential diﬀerences and predicted time
delays (also shown in Fig. C.1) follow overall the 1:1 line al-
though they often do not agree within the statistical uncertain-
ties. For these two quantities we removed the outlier image

System

Image pair

δ(∆τ)/

∆τGLEE|

|

δ(∆τiso)/

∆τGLEE,iso|

|

DES J0029

−

3814 DA
DB
DC

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

BA
CA
DA

CA
CB
DC

CA
CB
DC

BA
CB
DB

BA
CA
DA

BA
CA
DA

DA
DB
DC

DES J2100

−

4452 DA
DB
DC

0.69±0.16
0.74±0.18
0.70±0.18

0.38±0.21
0.34±0.20
0.36±0.23

0.22±0.12
0.34±0.12

0.33±0.12

−
0.06±0.06
0.42±0.03
0.45±0.17

0.19±0.02
0.17±0.02

−
−
0.12±0.02

0.58±0.03

−
1.02±0.04

0.54±0.03

0.45±0.08
0.46±0.05
0.46±0.05

0.09±0.02
0.1±0.02
0.09±0.02

0.62±0.11
0.66±0.12
0.54±0.14

−

−
−
−

−
−
−

−
−
−

0.20±0.20
0.23±0.21
0.20±0.21

0.31±0.27
0.27±0.26
0.29±0.28

0.56±0.16
0.71±0.17

0.69±0.17

−

−

0.46±0.10

−
0.1±0.05

1.24±0.26

0.07±0.03
0.04±0.03
0.02±0.02

−
−
−
0.07±0.02
0.19±0.03
0.09±0.02

0.03±0.08
0.03±0.05
0.03±0.06

0.07±0.03
0.06±0.03
0.07±0.03

0.05±0.16
0.03±0.17
0.1±0.18

∆τGLEE|

for each lensing system. The fourth column shows the

Table 10. Relative deviation of Fermat potential diﬀerences
δ(∆τ)/
same comparison but with the rescaled values retrieved when assuming
an isothermal mass proﬁle. The relative statistical uncertainty is
underpredicted in the majority of cases.

|

C of J0659+1629 for better visibility in the plot, because its
time delay is one order of magnitude larger than all other im-
ages. We show in Table 10 the relative deviation in Fermat
with δ(∆τ) = ∆τGLEE −
∆τGLEE|
potential diﬀerences δ(∆τ)/
∆τLenstronomy. We estimated the statistical uncertainties on these
relative deviations by symmetrizing the uncertainties on the
GLEE and Lenstronomy parameter values (e.g., on ∆τGLEE and
∆τLenstronomy) and assuming that they follow Gaussian distribu-
tions.

|

that

This comparison shows us

for only 1 system
(J1721+8842) the relative Fermat potential diﬀerences and pre-
dicted time delays are within 10%. For 7/9 systems we see on
average a 30% or more deviation of the relative Fermat potential
diﬀerences of the multiple images. Therefore, for most systems
more detailed modeling and/or better data is needed to bring all

21

J0029-3814

J0214-2105

2.25

J0420-4037

J0659+1629

2.00

2M1134-2103

J1537-3010

J1606-2333

J1721+8842

J2100-4452

]
"
[

y
m
o
n
o
r
t
s
n
e
L
,
E

θ

1.75

1.50

1.25

1.00

0.75

]
"
[

E

Δ

θ

0.25

0.20

0.15

0.10

0.05

0.00

y
m
o
n
o
r
t
s
n
e
L
,
L
P

γ

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0.0

L
P

Δ

γ

−0.1

−0.2

−0.3

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

y
m
o
n
o
r
t
s
n
e
L
q

1.0

0.9

0.8

0.7

0.6

0.5

0.4

0.4

0.2

0.0

q
Δ

−0.2

−0.4

200

150

100

50

0

30

20

10

0

∘10

∘20

∘30

]
∘
[

y
m
o
n
o
r
t
s
n
e
L
,

m

ϕ

]
∘
[

m

Δ

ϕ

0.75 1.00 1.25 1.50 1.75 2.00 2.25

0

50

100

150

200

0.4 0.5 0.6 0.7 0.8 0.9 1.0

θ

E, GLEE ["]

qGLEE

ϕ

m, GLEE [∘]

y
m
o
n
o
r
t
s
n
e
L
,
t
x
e

γ

0.5

0.4

0.3

0.2

0.1

0.0

0.10

0.05

0.00

t
x
e

γ

Δ

−0.05

175

150

125

100

75

50

25

0

0

∘20

∘40

∘60

]
∘
[

y
m
o
n
o
r
t
s
n
e
L
,
t
x
e

ϕ

]
∘
[

t
x
e

Δ

ϕ

0.3

0.4

0.5

0.6

0.7

0

25 50 75 100 125 150 175

0.0

0.1

0.2

0.3

0.4

0.5

γ

PL, GLEE

γ

ext, GLEE

ϕ

ext, GLEE [∘]

Fig. 9. Direct comparison of lens mass parameter and external shear values between our models and Lenstronomy models from Schmidt et al.
(submitted).

these models to cosmography-grade level. In some cases, the
UVIS exposures may provide further constraints on the mass and
light proﬁle parameters, even though the source contribution is
fainter than in the IR, especially since the resolution is twice as
high in the UVIS.

5.2.2. Post-blind analysis

Having completed the blind comparison between the results we
turn to eﬀorts that have been made after unblinding to understand
the origin of the discrepancies.

22

To test the inﬂuence of the power-law slope ˜γPL on the phys-
ical quantities κ and ∆τ, we rescale the GLEE and Lenstronomy
∆τ/2 ˜γPL (e.g., Suyu 2012) and cal-
values of ∆τ with ∆τiso ≃
culate new κiso values with Eq. (9) and ˜γPL = 0.5, thus as-
suming isothermal mass proﬁles. In this case, we get overall
a much better agreement between the two modeling results, as
shown in Fig. C.1. With these assumptions, all κ values agree
now within 20%, with 5/9 systems having a
10% scatter. The
trend is similar for the relative Fermat potential diﬀerences at the
multiple image positions, where 6/9 systems agree within
20%
(see the last column δ(∆τiso)/
in Table 10). Two sys-
4037 and J0659+1629, have a higher relative devi-
tems, J0420

∆τGLEE,iso|

∼

≤

|

−

 
 
 
 
̃
̃
̃
 
 
1.4

1.2

1.0

0.8

]
"
[

y
m
o
n
o
r
t
s
n
e
L
,
E

θ

0.6

0.04

0.02

0.00

−0.02

−0.04

]
"
[

E

Δ

θ

0.65

0.60

y
m
o
n
o
r
t
s
n
e
L
,
L
P

γ

0.55

0.50

0.45

0.40

0.35

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

0.75

0.70

y
m
o
n
o
r
t
s
n
e
L
q

0.65

0.60

0.55

0.50

0.45

0.40

0.08

0.06

q
Δ

0.04

0.02

J1606-2333 (GLEE PSF)

J1606-2333 (Lenstronomy PSF)

0.00

J2100-4452 (GLEE PSF)

J2100-4452 (Lenstronomy PSF)

−0.02

−0.04

100

]
∘
[

y
m
o
n
o
r
t
s
n
e
L

ϕ

90

80

70

60

1

0

]
∘
[

Δ

ϕ

∘1

∘2

∘3

∘4

0.6

0.8

1.0

1.2

1.4

60

70

80

90

100

0.40 0.45 0.50 0.55 0.60 0.65 0.70 0.75

θ

E, GLEE ["]

qGLEE

ϕ

GLEE [∘]

0.150

0.125

0.100

0.075

0.050

0.025

y
m
o
n
o
r
t
s
n
e
L
,
t
x
e

γ

0.30

0.000

0.00

−0.05

0.10

L
P

Δ

γ

−0.10

−0.15

−0.20

−0.25

−0.30

t
x
e

Δ

γ

0.05

0.00

]
∘
[

y
m
o
n
o
r
t
s
n
e
L
,
t
x
e

ϕ

]
∘
[

t
x
e

∘

ϕ

150

125

100

75

50

25

0

100

80

60

40

20

0

0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65

0.00

0.05

0.10

0.15

0

25

50

75 100 125 150

γ

PL, GLEE

γ

ext, GLEE

ϕ

ext, GLEE [∘]

Fig. 10. Change in lens mass parameter and external shear values when using the Lenstronomy PSF with our GLEE automation code for
J1606

2333 and J2100

4452.

−

−

ation among the multiple images now, but their absolute values
of Fermat potential diﬀerences are small. Therefore, most of the
discrepancy in κ and ∆τ between the two independent models are
due to the diﬀerent power-law slope values. It is not a surprise
that the two modeling pipelines yield diﬀerent slope values, as
discussed above, due to diﬀerences in priors and PSFs.

To disentangle the two eﬀects (priors and PSF), we use the
ﬁnal PSF of the Lenstronomy modeling by S22 in our GLEE
automated modeling procedure. The creation of the PSF of SS22
is diﬀerent than in our pipeline because it includes iterative PSF
correction, while our PSF is simply constructed from stars in
the ﬁeld (see Sec. 2.1.1). Also, the GLEE PSF is subsampled by

a factor of 3 compared to the pixel scale of the data, while the
Lenstronomy PSF uses the original data’s pixel size.

−

2333 and J2100

To ensure the information content is suﬃcient (and thus the
prior is less important), the two teams focused for this com-
parison on two systems with high SNR data and visible arcs:
J1606
4452. We remodel both systems in the
F160W (IR) band with our GLEE-based pipeline but using the
not subsampled Lenstronomy PSF and compare the results with
those based on the GLEE PSF. We show the comparison in Fig. 10
and Fig. C.2. In both ﬁgures, we present the GLEE blind results
as presented in this work and the new post-blind results using
the Lenstronomy PSF. In most cases, the values obtained with

−

23

 
 
 
 
̃
̃
̃
 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

−

the Lenstronomy PSF are closer to the modeling results of S22.
The Einstein radius of J1606
2333 is lower with the new PSF
because it is degenerate with the Einstein radius of the satellite,
which is larger now. The eﬀective Einstein radius of this sys-
tem remains unchanged. The inﬂuence on the power-law slope
is evident, as the slope values move much closer to the val-
ues of S22, and closer to isothermal, without imposing a prior.
This also leads to a better agreement of other quantities such
as κ or the Fermat potential diﬀerences to the Lenstronomy
modeling results, as shown in C.1. We conclude from this that
for data with suﬃciently high signal-to-noise ratio, the PSF is
a crucial ingredient to infer accurately the power-law slope,
and thus the Fermat potential. Crucially, the PSF can be recon-
structed directly from the data, thus improving the accuracy of
cosmographic analysis. This result reinforces the necessity of
PSF reconstruction, which has become best practice in recent
years for cosmographic analysis using GLEE and Lenstronomy
by members of our team and collaborators (e.g., Wong et al.
2019; Birrer et al. 2018; Shajib et al. 2019b; Chen et al. 2019)
The counterpoint is that data of insuﬃcient quality should not
be used for cosmographic analysis, unless one has an accurate
and informative prior.

We conducted the same test with a subsampled version of
the Lenstronomy PSF. It is subsampled in the same way as the
GLEE PSF. The modeling results do not agree as well with the
Lenstronomy values and are closer to the GLEE values. This
comparison shows that although subsampling in the IR band is
important (Suyu et al. 2012, Shajib et al. 2022), the modeling re-
sults depend on the way the PSF is subsampled. It should be
done during the PSF reconstruction process, and not as a simple
interpolation after the corrections of the PSF.

To conclude, we remind the reader that the goal of this work
was not to produce cosmography-ready models but to automate
the modeling procedure for a wide range of lens morphologies
that can subsequently enable the construction of cosmography-
grade models; thus diﬀerences in the results of the two modeling
teams are expected. Our analysis shows that the origin of the
diﬀerences can generally be understood and that the two most
signiﬁcant factors are data quality and accuracy of PSF model-
ing.

5.3. Comparison of astrometry

To assess the precision of our astrometry we compare the rel-
ative positions of the multiple quasar images from our model
with the modeled positions from S22 and Luhtaru et al. (2021),
and the measured positions from the Gaia satellite data release
3 (Brown et al. 2021). Like in our pipeline, S22 obtained po-
sitions by modeling the surface brightness distribution, while
Luhtaru et al. (2021) used geometric properties in the image
plane. The comparison with S22 and Luhtaru et al. (2021) is
done for all 9 systems in our sample, the comparison with Gaia
for 7/9 systems. For the remaining 2 systems, there is no Gaia
data available.

In all comparisons, J1721+8842 has the biggest oﬀsets for
all four images of the quad, which is not suprising, given its com-
plexity (see Sec. 4.8). Excluding this system, we get the follow-
ing results w.r.t. S22: We have a r.m.s. scatter of
6 milli-arcsec
∼
(mas) in x-direction (RA) and
5 mas in y-direction (dec). The
∼
comparison with Luhtaru et al. (2021) reveals an r.m.s. scatter of
1.7 mas in x- and y-directions. The r.m.s. scatter for the Gaia
∼
comparison is 1.7 mas in x- and 2.3 mas in y-direction. The top
panel of Fig. 11 shows the diﬀerence in quasar image positions
for the comparison with S22, Luhtaru et al. (2021), and Gaia for

24

all systems that are in all three samples (7 systems). The images
of J1721+8842 are marked in orange as the mentioned outlier.
The bottom panel shows the diﬀerence in quasar images posi-
tions for all systems that are common in Luhtaru et al. (2021)
and Gaia. To give an idea of how small the diﬀerences are, we in-
clude a box centered around zero oﬀset with dimensions
5mas.
The vast majority of points lie within this box. Despite not hav-
ing performed PSF reconstruction in our automated modelling
pipeline, we have recovered the astrometry of the quasar images
within
2 mas of the Gaia measurements (which are the most
precise/accurate since Gaia was designed to measure astrome-
try).

±

∼

∼

∼

Birrer & Treu (2019) provide an estimate on how the astro-
metric uncertainties translate into the uncertainty on the H0 in-
2 mas rms oﬀset to Gaia in our analysis translates
ference. The
0.2 mas oﬀset in the source plane, which leads to uncer-
to a
tainties on H0 well below 5%, which is chosen by Birrer & Treu
(2019) as an estimate of the total uncertainties (i.e., from mod-
eling the lens mass potential and the contribution from the mass
along the line of sight). Thus the astrometric uncertainties in this
work are not a signiﬁcant contribution to the cosmographic error
budget, demonstrating that our automated pipeline can meet the
astrometric requirements.

5.4. Possible improvementsof the automatedlens modeling

pipeline

To further improve the automated, uniform modeling in combi-
nation with detailed cosmographic analyses of lenses, we plan to
implement several additions to the code.

For the uniform modeling approach, we reconstruct the PSF
from several stars in the ﬁeld. This approach introduces inac-
curacies that are negligible for uniform modeling but need to be
minimized for detailed analysis, as discussed in Sec. 5.2. We will
automate a method to iteratively update the initial PSF using the
multiple lensed quasar images. This PSF correction might also
resolve the tendency of the power-law slope parameter ˜γPL to
move to the boundaries of the prior.

To make the modeling procedure faster and more conve-
nient, we can automate the detection of extended structures in
the cutout, e.g., the positions of multiple quasar images and ob-
jects that need to be masked. Other automated modeling codes
already show that an accurate detection in the scope of uniform
modeling is often possible (e.g., Savary et al. 2021, Rojas et al.
2021). These papers also showed that sometimes objects will
be misidentiﬁed and the automated modeling has to be stopped.
Our current approach with manually identifying objects is thus
a compromise to ensure very high accuracy. This works best for
a medium-size sample (e.g., few dozen) but is not applicable for
samples of the order of hundred lenses or more.

The initial background subtraction of the data can be made
more accurate by allowing for the selection of multiple sky re-
gions. This is especially important for systems that show a gradi-
ent in background ﬂux. Another improvement can be the usage
of a p-value threshold for the lens light modeling (Sec. 2.1.2 and
2.2). This would decrease the probability that the χ2
red criterion
(Eq. 6) is met only due to speciﬁc noise realisations.

Other modeling teams have shown that optimizing methods
that are based on gradient descent and can be heavily paral-
lelized are superior to conventional methods in terms of com-
putation time, e.g., GIGA-Lens (Gu et al. 2022). These are di-
rections worth exploring for future developments of automated
lens modeling.

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

0.04

0.02

]
"
[

y
Δ

0.00

−0.02

Luh aru e  al. (2021)

Schmid  e  al. (submi  ed)

Gaia

J1721+8842 (Schmid )

J1721+8842 (Luh aru)

J1721+8842 (Gaia)

−0.04

−0.02

0.00

0.02

0.04

0.06

0.08

0.10

Δx ["]

−0.04

0.015

0.010

Gaia

Schmidt et al. (submitted)

Luhtaru et al. (2021)

0.005

]
"
[

y
Δ

0.000

−0.005

−0.010

−0.015

−0.015 −0.010 −0.005 0.000

0.005

0.010

0.015

Δx ["]

Fig. 11. Relative diﬀerence in quasar image positions between our
results and Schmidt et al. (submitted, squares), Luhtaru et al. (2021,
circles) or Gaia (triangles) for systems that overlap in the multiple
samples. The image positions of the outlier J1721+8842 are marked in
orange (top) or are excluded (bottom).

6. Conclusions

We presented a new automated modeling code for the uni-
form modeling of strongly lensed quasars in galaxy-scale sys-
tems with high-resolution data based on the well-tested software
GLEE. We additionally developed several codes that create neces-
sary input ﬁles (i.e., PSF, error map, and masks) which are used
for the modeling. The modeling of the lens mass distribution of
the system is done in two steps. In the ﬁrst step, the modeling
code uses the predicted source position and the observed image
positions to constrain the lens mass distribution parameters. In
the second step, the light distributions of the lens, the multiple
lensed quasar images and their host galaxy are modeled. The lat-
ter is used to reconstruct the surface brightness distribution of the
source. With the SSB distribution, the code models the light of
the arc to further constrain the lens mass parameters. The mod-
eling code and the creation of input ﬁles are nearly fully auto-
mated, requiring only minimal user input. Quality control and
technical steps in the modeling process are fully automated.

We tested the modeling code on a sample of nine strongly
lensed quasars and obtained a good light ﬁt and a good align-
ment of the mass and light distributions. The current automated

pipeline is versatile enough to model a variety of lens systems
in a uniform manner to obtain lens mass models. The models
provide robust estimates of Einstein radii and astrometry of the
quasar images. The accuracy of parameters such as the power-
law slope depends crucially on the data quality and on the de-
tails of the modeling. This is highlighted by a blind comparison
of our models with those of an automated modeling framework
from S22, based on the lens modeling code Lenstronomy. The
two approaches are similar in the choice of parametrization and
philosophy but have a few crucial diﬀerences: the description
of the lensed galaxy light (pixellated vs S´ersic+shapelets), the
number of modeled bands (user choice vs all available bands),
priors (uniform vs informative), and the PSF (initial guess based
on stars vs corrections based on the QSO images for S22).
Despite the diﬀerences, Einstein radii and mass ﬂattening are in
good agreement between the two studies, with a few exceptions
that can be traced to inadequacy of the data or the PSF model-
ing. Other quantities like convergence and image magniﬁcations
show diﬀerences that are generally larger than the estimated for-
mal statistical uncertainties, but still encouraging in amplitude,
considering the automated approach.

The diﬀerences arise primarily from two eﬀects as shown
by our post-blind analysis. First, when the data are of insuﬃ-
cient quality to constrain the slope of the power-law mass den-
sity proﬁle, the S22 results are driven by the prior, while our
current results tend to be more uncertain and constrained by the
bounds of the uniform prior. We show that if the same power-
law slope is imposed the agreement between the codes improves
signiﬁcantly. Second, the reconstruction of the PSF is a key fac-
tor in determining the slope and other parameters for data of
suﬃcient quality. We illustrate this point by modeling two high
quality systems with the same PSF as S22, and ﬁnding much bet-
ter agreement. We conclude that, for system with high SNR, the
PSF can be reconstructed directly from the data and the power-
law slope can be stably inferred, conﬁrming the results obtained
via detailed modeling by Wong et al. (2019); Birrer et al. (2019);
Shajib et al. (2019b); Chen et al. (2019); Shajib et al. (2022).

In terms of our automated modeling pipeline, we conclude
that models are a good starting point, but more work, particularly
PSF corrections, and in some cases better data, are needed to
bring them to cosmography grade. Nonetheless, these automated
modeling results provide important information about the lens
systems such as the approximate time delays to help schedule
the monitoring of the system. The lensing systems modeled with
our automated pipeline are being follow-up observationally to
acquire, e.g., redshift and velocity dispersion of the lens, time
delays, and environment properties. We can use the modeling
results that are presented here, as well as models from lensing
systems that are obtained with the automation code in the future,
as input models for more detailed modeling, in a fraction of the
user’s time compared to conventional modeling.

Acknowledgements. We thank P. Schechter for data on the astrometric com-
parison and for helpful discussions. This research is based on observations
made with the NASA/ESA Hubble Space Telescope obtained from the Space
Telescope Science Institute, which is operated by the Association of Universities
for Research in Astronomy, Inc., under NASA contract NAS 5-26555. These ob-
servations are associated with programs HST-GO-15320 and HST-GO-15652.
Support for the two programs was provided by NASA through a grant from
the Space Telescope Science Institute, which is operated by the Association
of Universities for Research in Astronomy, Inc., under NASA contract NAS 5-
26555.

SE, SS, and SHS thank the Max Planck Society for support through the Max

Planck Research Group for SHS.

This project has received funding from the European Research Council
(ERC) under the European Union’s Horizon 2020 research and innovation pro-
gramme (LENSNOVA: grant agreement No 771776; COSMICLENS: grant

25

 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

agreement No 787886). This research is supported in part by the Excellence
Cluster ORIGINS which is funded by the Deutsche Forschungsgemeinschaft
(DFG, German Research Foundation) under Germany’s Excellence Strategy –
EXC-2094 – 390783311.

TS and TT acknowledge support by the the National Science Foundation
through grant NSF-AST-1906976 and NSF-AST-1907396 ”Collaborative
Research: Toward a 1% measurement of the Hubble Constant with gravitational
time delays”. TT acknowledges support by the Packard Foundation through a
Packard Research Fellowship.

References

Abbott, B. P., Abbott, R., Abbott, T. D., et al. 2017, Nature 2017 551:7678, 551,

85

Agnello, A. & Spiniello, C. 2019, Monthly Notices of the Royal Astronomical

Society, 489, 2525

Aihara, H., Arimoto, N., Armstrong, R., et al. 2018, PASJ, 70, S4
Auger, M. W., Treu, T., Bolton, A. S., et al. 2010, Astrophysical Journal, 724,

511

Barkana, R. 1998, The Astrophysical Journal, 502, 531
Barnab`e, M., Czoske, O., Koopmans, L. V. E., Treu, T., & Bolton, A. S. 2011,

Monthly Notices of the Royal Astronomical Society, 415, 2215

Barnab`e, M., Dutton, A. A., Marshall, P. J., et al. 2012, Monthly Notices of the

Royal Astronomical Society, 423, 1073

Birrer, S. & Amara, A. 2018, Physics of the Dark Universe, 22, 189
Birrer, S., Amara, A., & Refregier, A. 2015, Astrophysical Journal, 813, 102
Birrer, S., Shajib, A. J., Galan, A., et al. 2020, Astronomy and Astrophysics, 643
Birrer, S. & Treu, T. 2019, Monthly Notices of the Royal Astronomical Society,

489, 2097

Birrer, S., Treu, T., Rusu, C. E., et al. 2019, Monthly Notices of the Royal

Astronomical Society, 484, 4726

Birrer, S., Treu, T., Rusu, C. E., et al. 2018, Monthly Notices of the Royal

Astronomical Society, 484, 4726

Bolton, A. S., Burles, S., Koopmans, L. V. E., et al. 2008, The Astrophysical

Journal, 682, 964

Bolton, A. S., Burles, S., Koopmans, L. V. E., Treu, T., & Moustakas, L. A. 2006,

The Astrophysical Journal, 638, 703

Bradley, L. D., Bouwens, R. J., Ford, H. C., et al. 2008, ApJ, 678, 647
Brown, A. G., Vallenari, A., Prusti, T., et al. 2021, Astronomy & Astrophysics,

649, A1

Chen, G. C. F., Fassnacht, C. D., Suyu, S. H., et al. 2019, Monthly Notices of the

Royal Astronomical Society, 490, 1743

Chen, G. C. F., Fassnacht, C. D., Suyu, S. H., et al. 2020, Astronomy and

Astrophysics, 652

Chiriv`ı, G., Yıldırım, A., Suyu, S. H., & Halkola, A. 2020, Astronomy and

Astrophysics, 643

Coe, D., Zitrin, A., Carrasco, M., et al. 2013, Astrophysical Journal, 762, 32
Collett, T. E. 2015, The Astrophysical Journal, 811, 20
Dalal, N. & Kochanek, C. S. 2001, ApJ, 572, 25
Dark Energy Survey Collaboration. 2016, Monthly Notices of the Royal

Astronomical Society, 460, 1270

Delchambre, L., Krone-Martins, A., Wertz, O., et al. 2019, Astronomy &

Astrophysics, 622, A165

Dunkley, J., Bucher, M., Ferreira, P. G., Moodley, K., & Skordis, C. 2005,

Monthly Notices of the Royal Astronomical Society, 356, 925

Dye, S. & Warren, S. 2004, The Astrophysical Journal, 623, 31
Foreman-Mackey, D., Hogg, D. W., Lang, D., & Goodman, J. 2013, Publications

of the Astronomical Society of the Paciﬁc, 125, 306

Gavazzi, R., Treu, T., Rhodes, J. D., et al. 2007, The Astrophysical Journal, 667,

176

Gilman, D., Birrer, S., & Treu, T. 2020, Astronomy and Astrophysics, 642, A194
Gu, A., Huang, X., Sheu, W., et al. 2022
Hezaveh, Y. D., Perreault Levasseur, L., & Marshall, P. J. 2017, Nature, 548, 555
Horne, K. 1986, Publications of the Astronomical Society of the Paciﬁc, 98, 609
Hsueh, J. W., Enzi, W., Vegetti, S., et al. 2020, Monthly Notices of the Royal

Astronomical Society, 492, 3047

Ivezi´c, ˇZ., Kahn, S. M., Tyson, J. A., et al. 2019, The Astrophysical Journal, 873,

111

Jones, T. A., Swinbank, A. M., Ellis, R. S., Richard, J., & Stark, D. P. 2010,

Monthly Notices of the Royal Astronomical Society, 404, 1247

Joye, W. & Mandel, E. 2003, 295, 489
Kassiola, A. & Kovner, I. 1993, The Astrophysical Journal, 417, 450
Khetan, N., Izzo, L., Branchesi, M., et al. 2020, Astronomy and Astrophysics,

647

Kirkpatrick, S., Gelatt, C. D., & Vecchi, M. P. 1983, Science, 220, 671
Kneib, J.-P., Ellis, R. S., Santos, M. R., & Richard, J. 2004, The Astrophysical

Journal, Volume 607, Issue 2, pp. 697-703., 607, 697

26

Koopmans, L. V. 2005, Monthly Notices of the Royal Astronomical Society, 363,

1136

Lagattuta, D. J., Auger, M. W., & Fassnacht, C. D. 2010, ApJL, 716, L185
Laureijs, R., Amiaux, J., Arduini, S., et al. 2011
Lee, C.-H., Lee, & Chien-Hsiu. 2019, AJ, 157, 14
Lemon, C., Millon, M., Sluse, D., et al. 2021, arXiv, arXiv:2109.01144
Lemon, C. A., Auger, M. W., & McMahon, R. G. 2019, Monthly Notices of the

Royal Astronomical Society, 483, 4242

Lemon, C. A., Auger, M. W., McMahon, R. G., & Ostrovski, F. 2018, Monthly

Notices of the Royal Astronomical Society, 479, 5060

Li, R., Napolitano, N., Tortora, C., et al. 2020, arXiv:2004.02715
Lochner, M., Scolnic, D., Almoubayyed, H., et al. 2021, arXiv e-prints,

arXiv:2104.05676

Lucey, J. R., Schechter, P. L., Smith, R. J., & Anguita, T. 2018, Monthly Notices

of the Royal Astronomical Society, 476, 927

Luhtaru, R., Schechter, P. L., & de Soto, K. M. 2021, The Astrophysical Journal,

915, 4

Mangat, C. S., McKean, J. P., Brilenkov, R., et al. 2021, Monthly Notices of the

Royal Astronomical Society: Letters, 508, L64

Millon, M., Courbin, F., Bonvin, V., et al. 2020a, Astronomy and Astrophysics,

642, 19

Millon, M., Courbin, F., Bonvin, V., et al. 2020b, Astronomy & Astrophysics,

640, A105

Millon, M., Galan, A., Courbin, F., et al. 2020c, Astronomy and Astrophysics,

639, A101

Moustakas, L. A. & Metcalf, R. B. 2002, Monthly Notice of the Royal

Astronomical Society, Volume 339, Issue 3, pp. 607-615., 339, 607

Nierenberg, A. M., Gilman, D., Treu, T., et al. 2020, Monthly Notices of the

Royal Astronomical Society, 492, 5314

Nierenberg, A. M., Treu, T., Brammer, G., et al. 2017, Monthly Notices of the

Royal Astronomical Society, 471, 2224

Nierenberg, A. M., Treu, T., Wright, S. A., Fassnacht, C. D., & Auger, M. W.

2014, MNRAS, 442, 2434

Nightingale, J. W., Hayes, R. G., Kelly, A., et al. 2021, Journal of Open Source

Software, 6, 2825

Park, J. W., Wagner-Carena, S., Birrer, S., et al. 2021, ApJ, 910, 39
Perreault Levasseur, L., Hezaveh, Y. D., & Wechsler, R. H. 2017, ApJ, 850, L7
Pesce, D. W., Braatz, J. A., Reid, M. J., et al. 2020, The Astrophysical Journal

Letters, 891, L1

Planck Collaboration, Aghanim, N., Akrami, Y., et al. 2018, Astronomy and

Astrophysics, 641

Riess, A. G., Casertano, S., Yuan, W., et al. 2021, The Astrophysical Journal

Letters, 908, L6

Rizzo, F., Vegetti, S., Powell, D., et al. 2020, Nature, 584, 201
Rojas, K., Savary, E., Cl´ement, B., et al. 2021
Rusu, C. E., Berghea, C. T., Fassnacht, C. D., et al. 2019, Monthly Notices of

the Royal Astronomical Society, 486, 4987

Rusu, C. E., Wong, K. C., Bonvin, V., et al. 2020, Monthly Notices of the Royal

Astronomical Society, 498, 1440

Salmon, B., Coe, D., Bradley, L., et al. 2020, ApJ, 889, 189
Savary, E., Rojas, K., Maus, M., et al. 2021
Scaramella, R., Amiaux,

J., Mellier, Y., et al. 2021, arXiv e-prints,

arXiv:2108.01201

Schmidt, B. P., Kirshner, R. P., Eastman, R. G., et al. 1994, ApJ, 432, 42
Schmidt, T., Treu, T., Birrer, S., et al. 2022, arXiv e-prints, arXiv:2206.04696
Schuldt, S., Ca˜nameras, R., Shu, Y., et al. 2022
Schuldt, S., Chiriv`ı, G., Suyu, S. H., et al. 2019, A&A, 631, A40
Schuldt, S., Suyu, S. H., Meinhardt, T., et al. 2021, A&A, 646, A126
S´ersic, J. 1963, Boletin de la Asociacion Argentina de Astronomia La Plata

Argentina

Shajib, A. J., Birrer, S., Treu, T., et al. 2019a, Monthly Notices of the Royal

Astronomical Society, 494, 6072

Shajib, A. J., Birrer, S., Treu, T., et al. 2019b, Monthly Notices of the Royal

Astronomical Society, 483, 5649

Shajib, A. J., Treu, T., Birrer, S., & Sonnenfeld, A. 2021, MNRAS, 503, 2380
Shajib, A. J., Wong, K. C., Birrer, S., et al. 2022
Shu, Y., Bolton, A. S., Brownstein, J. R., et al. 2015, Astrophysical Journal, 803,

1

Sonnenfeld, A., Treu, T., Marshall, P. J., et al. 2015, ApJ, 800, 94
Stern, D., Djorgovski, S. G., Krone-Martins, A., et al. 2021, The Astrophysical

Journal, 921, 42

Suyu, S. H. 2012, MNRAS, 426, 868
Suyu, S. H., Auger, M. W., Hilbert, S., et al. 2013, ApJ, 766, 70
Suyu, S. H., Bonvin, V., Courbin, F., et al. 2017, Monthly Notices of the Royal

Astronomical Society, 468, 2590

Suyu, S. H. & Halkola, A. 2010, Astronomy & Astrophysics, 524, A94
Suyu, S. H., Hensel, S. W., McKean, J. P., et al. 2012, The Astrophysical Journal,

750, 10

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

Suyu, S. H., Marshall, P. J., Auger, M. W., et al. 2010, ApJ, 711, 201
Suyu, S. H., Marshall, P. J., Hobson, M. P., & Blandford, R. D. 2006, Monthly

Notices of the Royal Astronomical Society, 371, 983

Treu, T., Brammer, G., Diego, J. M., et al. 2016, The Astrophysical Journal, 817,

60

Tyson, J. A. 2002, in Survey and Other Telescope Technologies and Discoveries,

ed. J. A. Tyson & S. Wolﬀ, SPIE Proceedings (SPIE), 10

Vegetti, S., Koopmans, L. V., Bolton, A., Treu, T., & Gavazzi, R. 2010, Monthly

Notices of the Royal Astronomical Society, 408, 1969

Vegetti, S., Lagattuta, D. J., McKean, J. P., et al. 2012, Nature, 481, 341
Wong, K. C., Suyu, S. H., Chen, G. C. F., et al. 2019, Monthly Notices of the

Royal Astronomical Society, 498, 1420

27

2
8

Appendix A: Final modeling results

Parameter
description

Parameter

lens mass (SPEMD)

x-centroid

y-centroid

axis-ratio

position angle

Einstein radius

power-law index

satellite mass (SIS)

x-centroid

y-centroid

Einstein radius

external shear

xm [′′]

ym [′′]

qm

φm [°]

θE [′′]

˜γPL

xm,sat [′′]

ym,sat [′′]

θE,sat [′′]

magnitude

position angle

γext

φext [°]

primary lens light (2 S´ersic & point source)

x-centroid

y-centroid

S´ersic#1
axis ratio

position angle

amplitude

eﬀective radius

S´ersic index

xS [′′]

yS [′′]

qS,1

φS,1 [°]

AS,1

reﬀ,1 [′′]

nS,1

DES J0029

−

3814

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

DES J2100

−

4452

Lensing system

3.253+0.009
0.008
−
3.199+0.004
0.004
−

0.93+0.03
0.04
−
121.3+24.5
9.4
−
0.75+0.01
0.01
−
0.35+0.06
0.04
−

−

−

−

0.23+0.04
0.02
−
14.4+0.7
0.6
−

3.209+0.002
0.002
−
3.177+0.002
0.002
−

0.59+0.02
0.02
−
135.5+1.7
1.6

−
0.016+0.003
0.002
−
2.0+0.2
0.2
−
5.6+0.3
0.4
−

4.012+0.005
0.004
−
3.994+0.005
0.005
−

0.73+0.05
0.07
−
166.6+3.7
2.8

−
0.855+0.004
0.004
−
0.6+0.1
0.1
−

−

−

−

0.07+0.01
0.02
−
45.3+4.8
13.4
−

4.006+0.001
0.001
−
3.985+0.001
0.001
−

−

0.89+0.02
0.02
−
142.0+4.8
5.3
0.63+0.09
0.09
−
0.37+0.04
0.03
−
5.8+0.2
0.3
−

3.218+0.003
0.003
−
3.227+0.002
0.002
−

0.92+0.02
0.02
−
97.9+6.8
8.4
−
0.831+0.002
0.002
−

0.65+0.03
0.05
−

−

−

−

0.052+0.005
0.007
−
53.2+3.0
2.4
−

5.12+0.01
0.02
−
5.178+0.009
0.008
−

0.43+0.02
0.02
−
85.5+2.1
1.8
−
2.35+0.03
0.02
−
0.69+0.01
0.01
−

4.80

6.83

0.14+0.03
0.04
−

6.030+0.002
0.001
−
5.960+0.002
0.002
−

0.52+0.01
0.01
−
52.6+0.5
0.5
−
1.252+0.003
0.003
−
0.666+0.004
0.003
−

−

−

−

0.116+0.006
0.006
−

132.8+1.7
2.3

−

0.397+0.004
0.003
−

135.0+0.1
0.1

−

3.2221+0.0006
0.0006
−
3.2385+0.0006
0.0006
−

5.2210+0.0007
0.0007
−
5.2297+0.0007
0.0008
−

0.51+0.01
0.01
−
113.0+1.0
1.0

−
9.8+0.2
0.4
−
0.158+0.004
0.003
−
5.9+0.1
0.1
−

0.81+0.01
0.01
−
37.8+0.9
0.9
−
0.064+0.006
0.007
−
2.9+0.1
0.1
−
1.8+0.1
0.1
−

6.02666+0.00002
0.00002
−
5.97334+0.00002
0.00002
−

0.18+0.01
0.01
−
42.4+0.5
0.5
−
0.00059+0.00008
0.00007
−
186.8+9.4
22.1

−
2.3+0.1
0.1
−

3.9947+0.0007
0.0007
−

3.925+0.001
0.001
−
0.848+0.004
0.004
−

124.8+0.5
0.5

−
1.427+0.001
0.001
−
0.301+0.001
0.001
−

3.994+0.006
0.006
−
3.986+0.005
0.004
−

0.59+0.03
0.03
−
74.4+2.2
1.3
−
0.689+0.009
0.009
−

0.31+0.01
0.01
−

4.049+0.002
0.002
−
3.964+0.002
0.002
−
0.742+0.005
0.005
−

165.8+0.3
0.3

−
1.986+0.002
0.002
−
0.416+0.006
0.007
−

8.042+0.005
0.005
−

8.07+0.01
0.01
−
0.52+0.02
0.03
−
92.3+0.5
0.5
−
1.351+0.009
0.008
−

0.36+0.05
0.04
−

−

−

−

0.043+0.002
0.001
−
22.3+0.7
0.8
−

3.9961+0.0007
0.0007
−
3.9319+0.0007
0.0007
−

0.54+0.01
0.01
−
128.2+0.5
0.5
−
0.0207+0.0008
0.0007
−
3.14+0.05
0.06
−
0.50+0.001
0.001
−

4.29

2.80

0.10+0.02
0.03
−

0.06+0.01
0.01
−
101.2+5.2
9.6

−

3.995+0.001
0.001
−
3.972+0.002
0.002
−

0.893+0.004
0.004
−

−

146.9+1.3
1.3
0.69+0.01
0.01
−
0.890+0.003
0.003
−
0.501+0.001
0.001
−

−

−

−

−

−

−

0.026+0.002
0.002
−
64.9+1.4
1.6
−

0.12+0.02
0.02
−
92.90+1.05
0.90
−

4.0053+0.0006
0.0006
−
3.9728+0.0005
0.0005
−

0.844+0.001
0.001
−

177.2+0.2
0.2
−
0.00618+0.00007
0.00007
−
4.92+0.03
0.03
−
2.24+0.04
0.04
−

8.0050+0.0004
0.0004
−
8.0035+0.0005
0.0005
−

0.749+0.001
0.001
−
88.4+0.1
0.1
−
0.208+0.003
0.002
−

3.29+0.02
0.02
−
4.76+0.04
0.04
−

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

Table A.1. Median mass and light parameter values with the corresponding 1σ uncertainties for all lensing systems in the F160W band.

Parameter
description

Parameter

primary lens light (2 S´ersic & point source)

S´ersic#2
axis ratio

position angle

amplitude

eﬀective radius

S´ersic index

Point source
amplitude

satellite light (S´ersic)

x-centroid

y-centroid

axis ratio

position angle

amplitude

qS,2

φS,2 [°]

AS,2

reﬀ,2 [′′]

nS,2

Aps

xsat [′′]

ysat [′′]

qsat

φsat [°]

Asat

eﬀective radius

reﬀ,sat [′′]

S´ersic index

nsat

quasar light

Quasar#A
x-centroid

y-centroid

amplitude

Quasar#B
x-centroid

y-centroid

amplitude

Quasar#C
x-centroid

y-centroid

amplitude

Quasar#D
x-centroid

y-centroid

amplitude

xQSO,A [′′]

yQSO,A [′′]

AQSO,A

xQSO,B [′′]

yQSO,B [′′]

AQSO,B

xQSO,C [′′]

yQSO,C [′′]

AQSO,C

xQSO,D [′′]

yQSO,D [′′]

AQSO,D

Table A.1 continued.

2
9

DES J0029

−

3814

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

DES J2100

−

4452

Lensing system

0.60+0.03
0.03
−
0.6+2.9
1.6
−
0.022+0.003
0.003
−

1.60+0.08
0.06
−
0.53+0.05
0.02
−

10.5+0.9
1.0
−

−

−

−

−

−

−

−

4.0486

3.3999

156.11

3.3976

3.7123

74.42

3.6689

2.8328

56.14

1.9218

2.8143

72.44

0.70+0.01
0.02
−
161.0+1.0
1.1

−
0.021+0.001
0.001
−
3.1+0.1
0.1
−
1.5+0.2
0.2
−

−

−

−

−

−

−

−

−

3.5069

3.1362

272.95

4.3237

4.7914

270.04

3.4361

4.5200

156.48

4.7708

3.8688

290.99

0.854+0.005
0.005
−

−

123.2+1.1
1.1
0.31+0.01
0.01
−
1.13+0.01
0.01
−
1.71+0.04
0.04
−

−

−

−

−

−

−

−

−

3.9264

2.8945

172.25

3.6861

3.9210

138.73

2.5129

2.6768

41.67

3.0603

4.0253

39.08

0.94+0.01
0.01
−
117.6+3.3
3.4

−
1.5+0.2
0.2
−
0.41+0.04
0.03
−
3.3+0.2
0.1
−

−

4.80

6.83

0.76

160.08

0.08

1.11

4.77

3.3407

6.2785

2272.19

8.0907

4.0381

694.04

3.4261

4.3756

559.82

4.4029

7.2629

455.58

0.74+0.01
0.01
−
120.6+0.8
0.8

−
0.148+0.006
0.005
−

1.26+0.02
0.03
−
4.7+0.1
0.1
−

0.803+0.006
0.005
−

−

115.5+0.8
0.9
1.08+0.03
0.03
−
0.495+0.007
0.007
−

3.13+0.04
0.04
−

−

−

−

−

−

−

−

−

5.2792

5.1995

2421.62

4.5511

6.9546

2874.75

7.2261

4.4272

2942.03

6.5268

6.5686

559.82

−

−

−

−

−

−

−

−

2.5612

3.1630

341.53

4.5556

2.8461

284.55

5.4041

4.8098

300.08

3.3031

4.9344

142.76

0.871+0.008
0.008
−
63.6+1.9
1.9
−
0.046+0.002
0.002
−

2.34+0.04
0.05
−
0.86+0.06
0.05
−

73.5+0.2
0.3
−

4.29

2.80

0.34

83.54

0.36

0.20

5.87

3.1513

4.3453

323.23

4.7760

3.7531

215.42

3.9512

3.4377

67.05

4.2779

4.4968

286.37

0.793+0.004
0.004
−

171.5+0.6
0.6

−
0.054+0.001
0.001
−
0.455+0.007
0.007
−

1.24+0.02
0.03
−

0.2+0.1
0.1
−

−

−

−

−

−

−

−

2.1149

4.7010

774.05

3.4383

6.1091

354.28

2.3668

2.3534

340.03

5.4424

3.5779

158.33

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

0.302+0.003
0.001
−
97.3+0.3
0.3
−
7.9+0.3
0.3
−
0.288+0.005
0.005
−

3.02+0.08
0.08
−

−

−
-

−

−

−

−

−

9.0466

7.1921

184.10

8.6241

6.8608

480.00

6.6032

7.5404

82.30

8.2033

9.0707

47.55

3
0

Parameter
description

quasar light

Quasar#E
x-centroid

y-centroid

amplitude

Quasar#F
x-centroid

y-centroid

amplitude

Parameter

xQSO,E [′′]

yQSO,E [′′]

AQSO,E

xQSO,F [′′]

yQSO,F [′′]

AQSO,F

Table A.1 continued.

DES J0029

−

3814

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

DES J2100

−

4452

Lensing system

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

2.9345

1.1298

87.26

4.8644

4.9188

14.61

−

−

−

−

−

−

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

System

Image

J0029

−

3814

J0214

−

2105

J0420

−

4037

J0659+1629

2M1134

−

2103

J1537

−

3010

J1606

−

2333

J1721+8842

J2100

−

4452

A
B
C
D

A
B
C
D

A
B
C
D

A
B
C
D

A
B
C
D

A
B
C
D

A
B
C
D

A
B
C
D
E
F

A
B
C
D

Convergence
κ
0.60+0.04
0.07
−
0.82+0.03
0.05
−
0.82+0.02
0.05
−
0.41+0.05
0.07
−
0.3+0.1
0.1
−
0.4+0.1
0.1
−
0.5+0.1
0.1
−
0.6+0.1
0.1
−
0.37+0.05
0.03
−
0.35+0.04
0.03
−
0.31+0.04
0.03
−
0.38+0.05
0.03
−
0.278+0.009
0.009
−
0.136+0.007
0.006
−
0.30+0.01
0.02
−
0.541+0.009
0.008
−
0.627+0.009
0.009
−
0.134+0.003
0.004
−
0.123+0.003
0.004
−
0.98+0.02
0.02
−
0.617+0.001
0.001
−
0.808+0.001
0.002
−
0.605+0.001
0.001
−
0.800+0.001
0.002
−
0.52+0.01
0.02
−
0.58+0.01
0.02
−
0.99+0.02
0.02
−
0.90+0.02
0.01
−
0.632+0.006
0.005
−
0.498+0.007
0.007
−
0.485+0.008
0.007
−
0.868+0.005
0.005
−
0.364+0.008
0.007
−
0.786+0.007
0.007
−
0.60+0.04
0.05
−
0.72+0.03
0.04
−
0.48+0.05
0.06
−
0.96+0.02
0.03
−

Total shear
γtot
0.08+0.01
0.01
−
0.6+0.1
0.1
−
0.59+0.1
0.07
−
0.02+0.02
0.01
−
0.36+0.04
0.05
−
0.44+0.07
0.07
−
0.7+0.1
0.1
−
0.7+0.1
0.1
−
0.74+0.04
0.06
−
0.59+0.03
0.04
−
0.54+0.02
0.03
−
0.69+0.04
0.05
−
0.588+0.008
0.008
−
0.33+0.01
0.01
−
0.90+0.01
0.02
−
0.81+0.01
0.02
−
1.40+0.02
0.01
−
0.145+0.003
0.003
−
0.113+0.004
0.003
−
1.95+0.03
0.03
−
0.1892+0.0006
0.0004
−
0.432+0.002
0.001
−
0.1855+0.0005
0.0004
−
0.427+0.002
0.001
−
0.178+0.009
0.009
−
0.151+0.007
0.005
−
0.53+0.03
0.02
−
0.51+0.02
0.01
−
0.508+0.007
0.008
−
0.341+0.004
0.005
−
0.314+0.004
0.004
−
0.69+0.01
0.01
−
0.213+0.002
0.002
−
0.51+0.01
0.01
−
0.32+0.04
0.03
−
0.38+0.06
0.04
−
0.29+0.03
0.02
−
0.55+0.09
0.06
−

−

−

−

−

Position angle of total shear
φγtot
102.5+2.1
2.2
174.6+0.3
0.2
−
37.6+0.2
0.2
−
171.8+5.9
14.7
−
152.5+0.3
0.3
162.1+0.5
0.5
−
47.0+0.3
0.3
−
78.2+0.2
0.2
−
64.3+0.3
0.3
−
146.0+0.4
0.4
126.4+0.2
0.2
−
13.4+0.4
0.4
−
66.1+0.4
0.3
−
78.0+1.1
0.9
−
116.0+0.3
0.3
−
21.4+0.4
0.4
−
134.84+0.09
0.08
105.5+0.6
0.6
152.3+0.7
0.6
139.35+0.09
0.08
118.9+0.1
0.1
−
27.46+0.04
0.04
−
122.2+0.1
0.1
−
32.33+0.05
0.04
−
70.2+1.0
0.7
−
85.4+1.4
1.2
−
175.1+1.0
1.5
151.3+0.5
0.4
69.13+0.08
0.08
−
20.5+0.1
0.1
−
131.4+0.2
0.2
−
75.5+0.05
0.05
−
158.1+0.1
0.1
139.2+0.1
0.1
53.8+0.6
0.6
−
28.2+0.3
0.3
−
106.7+0.4
0.4
170.3+0.2
0.2

−

−

−

−

−

−

−

−

−

Image mag.
µ
6.4+1.6
1.7
−
3.0+0.9
0.9
−
−
3.2+1
0.9
−
−
2.9+0.5
0.6
−
3.2+1.3
0.8
−
5.4+2.4
1.4
−
3.7+1.2
1.8
−
−
2.8+0.9
1.4
−
−
6.8+0.9
1.3
−
−
14.3+2.6
1.9
−
5.5+0.9
0.7
−
11.6+1.6
2.2
−
−
5.7+0.2
0.2
−
1.57+0.04
0.03
−
3.2+0.2
0.2
−
−
2.2+0.1
0.1
−
−
0.55+0.01
0.01
−
−
1.37+0.01
0.01
−
1.32+0.01
0.01
−
0.263+0.008
0.007
−

−

−

−
−

8.99+0.05
0.06
−
6.68+0.05
0.05
−
−
8.22+0.05
0.06
−
7.01+0.06
0.05
−
5.0+0.2
0.4
−
6.3+0.3
0.5
−
3.6+0.3
0.2
−
3.9+0.3
0.3
−
8.2+0.3
0.3
−
−
7.4+0.3
0.2
−
6.0+0.2
0.2
−
2.20+0.08
0.08
−
−
2.79+0.07
0.07
−
4.7+0.2
0.2
−
−
18.8+4.4
4.3
−
16.0+4.0
4.1
−
−
5.5+1.2
1.2
−
3.3+0.9
0.9
−

−

Table A.2. Convergence κ, total shear strength γtot, position angle φγtot
of the total shear (γtot), and magniﬁcation µ at the (modeled) image
positions.

31

3
2

System

∆τBA

∆τCA

∆τDA

∆τFE

∆τCB

∆τDB

∆τDC

DES J0029

DES J0214

DES J0420

3814

2105

4037

−

−

−

PS J0659+1629

2M1134

2103

−
3010

J1537

−

PS J1606

2333

−

PS J1721+8842

DES J2100

−

4452

−

0.038+0.007
0.004
−
0.13+0.03
0.02
−
0.021+0.002
0.003
−
3.9+0.1
0.1
−
−
0.584+0.006
0.006
−
−
0.207+0.001
0.001
−
0.076+0.005
0.005
−
0.103+0.002
0.002
−
−
0.0042+0.0008
0.0005
−

0.032+0.006
0.004
−
0.16+0.03
0.03
−
0.09+0.01
0.01
−
−
0.113+0.005
0.005
−
0.803+0.008
0.008
−
−
0.0483+0.0005
0.0006
−

0.148+0.005
0.005
−
0.202+0.004
0.004
−
0.27+0.03
0.05
−

−

−

−

0.34+0.03
0.05
−
−
0.19+0.04
0.04
−
0.017+0.002
0.002
−
−
0.086+0.003
0.003
−
0.497+0.008
0.006
−
0.190+0.001
0.001
−
0.128+0.005
0.005
−
0.98+0.01
0.02
−
0.26+0.03
0.02
−

−

−

−

−

−

−

−
3.11+0.04
0.04
−

−

−

−

0.006+0.002
0.002
−
0.04+0.007
0.006
−
0.065+0.007
0.007
−
4.0+0.1
0.1
−
0.219+0.002
0.002
−
0.255+0.001
0.001
−
−
0.072+0.003
0.002
−
0.099+0.002
0.003
−
0.27+0.03
0.05
−

−

−

−

0.37+0.04
0.06
−
−
0.06+0.01
0.01
−
0.0046+0.0006
0.0005
−
4.0+0.1
0.1
−
1.08+0.01
0.01
−
0.0174+0.0009
0.0008
−

−

0.053+0.002
0.002
−
1.08+0.02
0.02
−
0.25+0.03
0.02
−

0.37+0.04
0.06
−
−
0.026+0.006
0.006
−
0.070+0.008
0.007
−
0.028+0.004
0.004
−

−

1.30+0.01
0.01
−
0.238+0.002
0.002
−
0.02+0.002
0.002
−
−
1.18+0.02
0.02
−
0.53+0.05
0.08
−

Table A.3. All combinations of Fermat potential diﬀerences, computed based on Eq. (17). We give the median value and include the corresponding 1σ uncertainties.

System

zd

zs

∆tBA (days)

∆tCA (days)

∆tDA (days)

∆tFE (days)

∆tCB (days)

∆tDB (days)

∆tDC (days)

DES J0029

DES J0214

DES J0420

3814

0.863

2.821

2105

0.22

3.229

4037

0.358

2.4

−

−

−

PS J0659+1629

0.766

3.083

2M1134

2103

−
3010

J1537

−

PS J1606

2333

−

PS J1721+8842

0.5

≡
0.592

0.5

≡
0.184

DES J2100

−

4452

0.203

2.77

1.721

1.69

2.37

0.92

−

6.0+1.0
0.7
−
3.6+0.8
0.7
−
1.1+0.1
0.1
−
−
509.4+15.3
14.1
−
44.7+0.5
0.4
−
−
23.4+0.1
0.1
−
6.7+0.3
0.3
−
2.50+0.05
0.05
−
−
0.13+0.02
0.02
−

5.1+0.9
0.6
−
4.7+1.0
0.9
−
4.5+0.5
0.5
−
−
14.7+0.6
0.6
−
61.4+0.6
0.6
−
−
5.46+0.06
0.06
−
−
13.1+0.5
0.5
−
4.9+0.1
0.1
−
8.5+0.9
1.6
−

−

−

53.5+5.3
8.1
−
−
5.4+1.2
1.0
−
0.9+0.1
0.1
−
−
11.1+0.4
0.4
−
38.0+0.6
0.5
−
21.4+0.1
0.1
−
11.3+0.5
0.5
−
23.9+0.4
0.4
−
8.2+1.0
0.7
−

−

−

−

−

−

−

−
73.6+1.0
0.9
−

−

0.9+0.3
0.3
−
−
1.0+0.2
0.2
−
3.4+0.3
0.4
−
−
524.4+16.0
14.3
−
16.7+0.2
0.2
−
28.9+0.2
0.2
−
−
6.4+0.1
0.1
−
2.42+0.06
0.06
−
8.6+0.9
1.6
−

−

−

−

59.4+6.0
9.2
−
−
1.8+0.4
0.3
−
0.24+0.03
0.03
−
520.5+14.5
15.6
−
82.7+0.8
0.7
−
2.0+0.1
0.1
−
−
4.7+0.2
0.2
−
26.4+0.4
0.4
−
8.1+1.0
0.7
−

58.6+5.9
9.1
−
−
0.8+0.2
0.2
−
3.7+0.4
0.4
−
3.6+0.5
0.5
−
−
99.4+0.9
0.8
−
26.9+0.2
0.2
−
1.8+0.2
0.2
−
−
28.8+0.5
0.5
−
16.7+1.6
2.5
−

Table A.4. Time-delay predictions. We present the measured or assumed (
addition we present all other combinations of time delays. We give the median value and include the corresponding 1σ uncertainties.

≡

) redshifts. The predicted time-delays are with respect to the reference image A for source 1 and E for source 2. In

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

Appendix B: Lens and quasar light parameters for F475 and F814

Parameter
description

Parameter

primary lens light (2 S´ersic & point source)

S´ersic#1
amplitude

S´ersic#2
amplitude

Point source
amplitude

AS,1(475)

AS,2(475)

Aps(475)

satellite light (S´ersic)

amplitude

Asat(475)

quasar light

Quasar#A
amplitude

Quasar#B
amplitude

Quasar#C
amplitude

Quasar#D
amplitude

Quasar#E
amplitude

Quasar#F
amplitude

AQSO,A(475)

AQSO,B(475)

AQSO,C(475)

AQSO,D(475)

AQSO,E(475)

AQSO,F(475)

DES J0029

−

3814

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

DES J2100

−

4452

Lensing system

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

0.002+0.0002
0.0002
−

0.0073+0.0005
0.0005
−

−

−

233.32

192.35

202.20

75.88

−

−

−

−

−

−

−

−

−

−

−

−

0.0137+0.0001
0.0002
−

0.145+0.003
0.003
−

4.25+0.55
0.39
−

−

669.25

362.34

345.94

139.11

91.63

22.76

−

−

−

−

−

−

−

−

−

−

Table B.1. Median light parameter values with the corresponding 1σ uncertainties for all lensing systems in the F475X band. The parameter values and uncertainties are taken from the ﬁnal (fully)
converged chain.

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

3
3

3
4

Parameter
description

Parameter

Lensing system

DES J0029

−

3814

DES J0214

−

2105

DES J0420

−

4037

PS J0659+1629

2M1134

−

2103

J1537

−

3010

PS J1606

−

2333

PS J1721+8842

DES J2100

−

4452

primary lens light (2 S´ersic & point source)

S´ersic#1
amplitude

S´ersic#2
amplitude

Point source
amplitude

AS,1(814)

AS,2(814)

Aps(814)

satellite light (S´ersic)

amplitude

Asat(814)

quasar light

Quasar#A
amplitude

Quasar#B
amplitude

Quasar#C
amplitude

Quasar#D
amplitude

Quasar#E
amplitude

Quasar#F
amplitude

AQSO,A(814)

AQSO,B(814)

AQSO,C(814)

AQSO,D(814)

AQSO,E(814)

AQSO,F(814)

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

0.000026+0.000020
0.000006
−

0.0031+0.0002
0.0002
−

0.0071+0.0008
0.0006
−

0.0363+0.002
0.002
−

−

−

1114.33

1206.04

1170.66

274.30

−

−

−

−

151.38

119.95

131.65

69.48

−

−

−

−

−

−

−

−

−

−

−

−

0.328+0.003
0.004
−

3.60+0.06
0.06
−

7.5+0.9
0.6
−

−

1946.88

1129.38

1079.34

413.29

254.68

44.33

−

−

−

−

−

−

−

−

−

−

Table B.2. Median light parameter values with the corresponding 1σ uncertainties for all lensing systems in the F814W band. The parameter values and uncertainties are taken from the ﬁnal (fully)
converged chain.

S

.

E
r
t
l

e
t

a
l
.
:

A
u
t
o
m
a
t
e
d
M
o
d
e
l
i
n
g

o
f

9
S
t
r
o
n
g
l
y
L
e
n
s
e
d
Q
u
a
s
a
r
s

Appendix C: Plots for comparison with Lenstronomy models

S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

1.0

0.8

0.6

0.4

y
m
o
n
o
r
t
s
n
e
L

κ

J0029-3814

J0214-2105

1.0

J0420-4037

J0659+1629

2M1134-2103

0.8

J1537-3010

J1606-2333

J1721+8842

0.6

J2100-4452

0.4

o
s
i

,
y
m
o
n
o
r
t
s
n
e
L

κ

2.0

y
m
o
n
o
r
t
s
n
e
L
,
t
o
t

γ

1.5

1.0

0.5

0.2

0.2

0.0

0.0

0.0

0.3

0.2

0.1

0.0

κ

Δ

−0.1

−0.2

−0.3

−0.4

20

10

0

y
m
o
n
o
r
t
s
n
e
L

μ

−10

−20

15

10

μ

Δ

5

0

−5

−10

−15

o
s
i

κ

Δ

0.3

0.2

0.1

0.0

−0.1

−0.2

−0.3

−0.4

0.4

0.2

0.0

t
o
t

γ

Δ

−0.2

−0.4

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.5

1.0

1.5

2.0

κ

GLEE

κ

GLEE, iso

γ

tot, GLEE

1.0

0.5

0.0

−0.5

0.4

0.3

0.2

0.1

0.0

−0.1

−0.2

−0.3

−0.4

y
m
o
n
o
r
t
s
n
e
L

τ

Δ

y
m
o
n
o
r
t
s
n
e
L

Δ
−
E
E
L
G

Δ

τ

τ

1.5

1.0

0.5

0.0

−0.5

0.4

0.3

0.2

0.1

0.0

−0.1

−0.2

−0.3

−0.4

o
s
i

,
y
m
o
n
o
r
t
s
n
e
L

τ

Δ

o
s
i

,
y
m
o
n
o
r
t
s
n
e
L

Δ
−
o
s
i

,
E
E
L
G

Δ

τ

τ

−20

−10

0

10

20

−0.5

0.0

0.5

1.0

−0.5

0.0

0.5

1.0

1.5

μ

GLEE

Δ

τ

GLEE

Δ

τ

GLEE, iso

100

50

0

−50

]
d
[

y
m
o
n
o
r
t
s
n
e
L

Δ

t

−100

]
d
[

y
m
o
n
o
r
t
s
n
e
L

Δ
−
E
E
L
G

Δ

t

t

50

40

30

20

10

0

−10

−20

−100−75 −50 −25 0

25 50 75 100

t

Δ

GLEE [d]

Fig. C.1. Comparison of κ, γtot, µ, Fermat potential diﬀerence ∆τ, and predicted time delay ∆t between the GLEE and Lenstronomy models.
Additionally, we compare κnew and ∆τnew, where we assume isothermal instead of power-law mass proﬁles.

35

 
 
S. Ertl et al.: Automated Modeling of 9 Strongly Lensed Quasars

J1606-2333 (GLEE PSF)

J1606-2333 (Lenstronomy PSF)

1.0

1.0

J2100-4452 (GLEE PSF)

J2100-4452 (Lenstronomy PSF)

y
m
o
n
o
r
t
s
n
e
L

κ

0.8

0.6

0.4

y
m
o
n
o
r
t
s
n
e
L
,
t
o
t

γ

0.8

0.6

0.4

0.2

0.2

0.0

0.0

0.30

0.25

0.20

κ

Δ

0.15

0.10

0.05

0.00

0.0

−0.1

t
o
t

γ

Δ

−0.2

−0.3

−0.4

−0.5

30

20

10

0

y
m
o
n
o
r
t
s
n
e
L

μ

−10

15

10

μ

Δ

5

0

−5

−10

−15

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.2

0.4

0.6

0.8

1.0

−20

−10

0

10

20

κ

GLEE

γ

tot, GLEE

μ

GLEE

1.0

40

y
m
o
n
o
r
t
s
n
e
L

τ

Δ

0.8

0.6

0.4

0.2

0.0

−0.2

y
m
o
n
o
r
t
s
n
e
L

Δ
−
E
E
L
G

Δ

τ

τ

0.00

−0.05

−0.10

−0.15

−0.20

−0.25

−0.30

−0.35

]
d
[

y
m
o
n
o
r
t
s
n
e
L

t

Δ

30

20

10

0

0

Δ2

Δ4

Δ6

Δ8

Δ10

]
d
[

y
m
o
n
o
r
t
s
n
e
L

Δ
Δ
E
E
L
G

Δ

t

t

−0.2 0.0 0.2 0.4 0.6 0.8 1.0

0

10

20

30

40

Δ

τ

GLEE

t

Δ

GLEE [d]

Fig. C.2. Change of κ, γtot, µ, Fermat potential diﬀerence ∆τ, and predicted time delay ∆t when using the Lenstronomy PSF with our GLEE
automation code for J1606

4452 in the F160W (IR) band.

2333 and J2100

−

−

36

 
 
