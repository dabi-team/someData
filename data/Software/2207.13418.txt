BayesianDynamicNetworkModelling:anapplicationtometabolicassociationsincardiovasculardiseasesMarcoMolinari1,AndreaCremaschi2,MariaDeIorio1,2,3,NishiChaturvedi4,AlunHughes4,andThereseTillin41DepartmentofStatisticalScience,UniversityCollegeLondon,UK2SingaporeInstituteforClinicalSciences,A*STAR,Singapore3YongLooLinSchoolofMedicine,NationalUniversityofSingapore,Singapore4DepartmentofPopulationScienceandExperimentalMedicine,UniversityCollegeLondon,UKAbstract:WeproposeanovelapproachtotheestimationofmultipleGraphicalModelstoanalysetemporalpatternsofassociationamongasetofmetabolitesoverdiﬀerentgroupsofpatients.OurmotivatingapplicationistheSouthallAndBrentREvisited(SABRE)study,atri-ethniccohortstudyconductedintheUK.Weareinterestedinidentifyingpotentialethnicdiﬀerencesinmetabolitelevelsandassociationsaswellastheirevolutionovertime,withtheaimofgainingabetterunderstandingofdiﬀerentriskofcardio-metabolicdisordersacrossethnicities.WithinaBayesianframework,weemployanodewiseregressionapproachtoinferthestructureofthegraphs,borrowinginformationacrosstimeaswellasacrossethnicities.Theresponsevariablesofinterestaremetabolitelevelsmeasuredattwotimepointsandfortwoethnicgroups,EuropeansandSouth-Asians.Weusenodewiseregressiontoestimatethehigh-dimensionalprecisionmatricesofthemetabolites,imposingsparsityontheregressioncoeﬃcientsthroughthedynamichorseshoeprior,thusfavouringsparsergraphs.WeprovidethecodetoﬁttheproposedmodelusingthesoftwareStan,whichperformsposteriorinferenceusingHamiltonianMonteCarlosampling,aswellasadetaileddescriptionofablockGibbssamplingscheme.Keywords:DynamicShrinkagePriors;GibbsSampling;GraphicalModels;Metabolomics;NodewiseRegression1IntroductionTheSouthallAndBrentREvisited(SABRE)[71]populationbasedcohortstudywasinitiatedinthelate1980sinnorth-westLondonwiththeaimofstudyingethnicdiﬀerencesincardiovasculardiseasesanddiabetes.ThestudyincludesindividualsofEuropean,South-AsianandAfrican-Caribbeandescent,aged40-69yearsatbaseline.Recently,metabolitesmeasurements,obtainedusingnuclearmagneticresonancespectroscopy[64],havebeencollectedonover3000storedbloodsamplesatbaselineand20-yearsfollow-up.Allparticipantsgavewritteninformedconsent.Ap-provalforthebaselinestudywasobtainedfromEaling,HounslowandSpelthorne,Parkside,andUniversityCollegeLondonresearchethicscommittees,andatfollow-upfromSt.Mary’sHospital1arXiv:2207.13418v1  [stat.ME]  27 Jul 2022ResearchEthicsCommittee(reference07/H0712/109).Inthiswork,weinvestigatethecomplexmetabolicpathwaysinvolvedincardiacmetabolism,combingmetaboliteconcentrationdatawithmoretraditionalclinicalmakers.Metabolitesaresmallmoleculesthatparticipateinmetabolicre-actionsandareinvolvedinbiochemicalpathwaysassociatedwithmetabolisminhealthanddisease[19].Indeed,thereisincreasingevidencethatmostcardiovasculardiseases,suchasdiabetesmel-litus,involvedisturbancesincardiacmetabolismandthat,ontheotherhand,heartdiseasescanaﬀectthemetabolism,henceinitiatingaviciouscycle[50].Inthelasttwodecades,metabolomics(i.e.thelarge-scalestudyofmetaboliteswithincells,bio-ﬂuids,tissuesororganisms)hasemergedasapowerfultoolfordeﬁningchangesinmetabolismthatoccuracrossarangeofcardiovasculardiseasestates.Findingsfrommetabolomicstudieshavecontributedtoabetterunderstandingofthemetabolicchangesthatoccurinheartfailureandischaemicheartdiseaseandhaveidentiﬁednewcardiovasculardiseasebiomarkers.Here,wefocusontype2diabetes,amainclinicaloutcomeofinterestintheSABREstudy,asitposesanenormousindividualandsocietalburden,withhighriskofmajorcomplicationsanddiminishedqualityandlengthoflife.Hence,itisimperativetounderstandcausalmechanismsinordertoidentifysubjectsathighestriskandtotailorpreventiveandtherapeuticmeasuresforappropriateperiodsduringthelifecourse.Theglobalepidemicoftype2diabetesdisproportionatelyaﬀectsnon-Europeanethnicgroups.South-Asians(fromtheIndiansubcontinent)formthelargestethnicminoritygroupintheUKwithprevalenceofdiabetesestimatedtobe2-4timeshigherthanthatofthegeneralpopulation[66].Researchtodatesuggeststhatinsulinresistanceanddiﬀerencesinbodyfatdistributionexplainsomeoftheethnicdiﬀerencesindiabetesrisk,buttheunderlyingmechanisticpathwaysarepoorlyunderstood,althoughtheyarelikelytoinvolveacomplexinterplaybetweenenvironmental,behavioural,metabolic,geneticandepigeneticinﬂuences.Therefore,itisessentialnottolimittheanalysistodiﬀerencesinmetabolitelevelsacrossethnicitiesovertime,buttoalsoconsiderpatternsofvariationsinmetabolicassociationstogainbetterinsightinmolecularmechanismsofdiseasepathogenesisandtoformulatenoveldata-drivenscientiﬁchypotheses.IntheSABREstudymeasurementsareavailableonover200metaboliteconcentrations,coveringawiderangeofchemicalclasses,atbaselineand20-yearsfollowup.Werepresentassociationpat-ternsamongmetabolitesthroughagraph,whichisthemainobjectofstatisticalinference.WithinaBayesianframework,ourmodelisbasedonnodewiseregression,originallyintroducedby[51].Inthenodewiseregressionapproach,estimatingagraphisequivalenttoestimatingtheprecisionmatrixbetweenvariables,inourcasemetabolitelevels.ThisisachievedbyrewritingtheproblemintermsofMindependentlinearregressions,whereMisthenumberofvariables/metabolites,andeachvariableisregressedonalltheothers.Itisalocalmethod,becauseitinferstheneighbour-hoodstructureofeachnode(i.e.theconnectionsinvolvingthenode)independently,asopposedtoglobalmethodsthataimtoinferjointlytheassociationpatternsacrossallthenodes.Theelementj,lintheprecisionmatrixisestimatedtobenon-zero(implyinganedgeinthegraphbetweenthetwovariables)ifeithertheestimatedregressioncoeﬃcientofvariablejonl,ortheestimatedcoeﬃcientofvariablelonj,isnon-zero.Alternativeapproachestographicalmodelsestimationareavailableintheliterature.GraphicalLassoisapopularglobalmethodinbothfrequentistandBayesiandomain,basedonapenalisedmaximumlikelihoodestimator[24]oronadoubleexpo-nentialprior[77],respectively.GraphicalLassohastheadvantageofensuringapositivedeﬁniteestimateofΩ,butrequiresagreatercomputationaleﬀortanditislessﬂexibleinestimatingtheindividualscalinglevels(i.e.thediagonalelementsofΩ)comparedtothenodewiseapproach[36].OtherBayesianapproachestographicalmodelestimationrelyonthespeciﬁcationofasuitable2priordistributionoverthegraphspaceand,conditionalonthegraph,apriorforprecisionmatrixisselected.Forexample,[43]proposeanalgorithmtoperformposteriorinferenceongraphspaceassumingaG-Wishartprior,ageneralisationoftheHyper-Wishartdistribution,thatallowstodealwithnon-decomposablegraphs.However,theconvergenceofassociatedMCMCalgorithmscanbeslowduetothesingleedgeupdateandtheintractablenormalisingconstantinthemarginalpos-teriorthatrequiresnumericalapproximations.Amoreeﬃcientalgorithm,basedonabirth-deathMCMC,hasbeenproposedby[52].Inseveralapplications,includingtheonepresentedinthiswork,informationregardingthegroupingofthesubjectsisavailable,e.g.diﬀerentethnicgroups.Therefore,itisofinteresttoestimateagroup-speciﬁcgraph,byspecifyingajointmodelformultiplegraphsabletoidentifycommonstructureaswellasgroup-speciﬁcconnections.Thisisparticularlyrelevantinourappli-cationasitallowstohighlightbiologicalmechanismwhichdiﬀerbetweenethnicityandpotentiallyleadtodiﬀerentdiseasedevelopment.Examplesofmodelsformultiplegraphsarefoundintheworkof[63],whichspecifyaglobalpenalisationanduseoptimizationtechniques,andof[56],whichinaBayesianframeworkproposeajointmodelinvolvingaMarkovrandomﬁeldpriortoencouragesharingofinformationamongedges.AMarkovrandomﬁeldpriormodellingbothspatialandtem-poraldependenceisalsousedby[45].Additionalexamplesaretheapproachesof[68],wheresharedstructuresaremodelledviaamultiplicativeprior,andof[8],wheremultipleprecisionmatricesareestimatedviaapenalisationapproachwhichallowstheinclusionofinformationa-priori.Themainmethodologicalcontributionofthisworkistoextendnodewiseregressionto(i)achievesparsityintheresultingprecisionmatrix(ii)accommodatemultiplegroups(iii)accountfordiﬀerenttimepoints.Thiswillallownotonlytobetterunderstandgroup-speciﬁcandglobaldepen-dencestructure,butalsohowtheyevolveacrosstime.Tothisend,weexploitrecentcontributiononshrinkageprioranddynamicstochasticvolatilitymodels.Inanodewiseregressionframework,inducingsparsityinthegraphisequivalenttoestimatingsomeregressioncoeﬃcientsequaltozero.Awealthofproposalsisavailableintheliteraturetoimposesparsityonregressioncoeﬃcients(see,forinstance,[54]forareviewonshrinkagepriors).WeoptfortheHorseshoeprior,whichbelongstotheclassofcontinuousglobal-localshrinkagepriors(see,forexample,[2,6,12]).TheHorse-shoepriorischaracterisedbyanaccentuatedspikeatzerotostronglyshrinksmallornegligiblecoeﬃcients,whileleavingimportantcoeﬃcientsunaﬀectedthankstoitsheavytails.Moreover,thispriorallowsforeﬃcientcomputations.Linkingthehyper-parametersoftheHorseshoepriorsacrossgroupsandemployingthedynamicextensionoftheHorseshoepriorproposedby[41],weareabletoaccuratelyestimatedynamicevolvingcomplexprecisionmatrices,acrossmultiplegroupsofobservationsofdiﬀerentsamplesizesatdiﬀerenttimepoints.Asimilarapproachistakenby[45],wheretheneighbourhoodselectionofeachnodeisbasedonthenodewiseregressionmethodof[51],butitisdiﬀerentfromourapproachintwoways:(i)aSpikeandSlabpriorisimposedontheregressioncoeﬃcientstoinducesparsityonedgeselection,increasingcomputationalcost;(ii)infor-mationissharedacrossmultiplegroupsandtimepointsthroughaMarkovRandomFieldstructure,whichalsoinvolvesneighbourhoodselection.OurchoiceofaHorseshoeprior,whichiscontinuousanddoesnotrequirehyper-parametertuning(initsoriginalformulation),signiﬁcantlyspeedsupcomputations,allowingtheuseofdiﬀerentinferenceapproaches,suchasMarkovchainMonteCarloandHamiltonianMonteCarlo(HMC).Furthermore,informationacrossmultiplegroupsissharedbyimposingahierarchicalstructureonthehyper-parametersofthehorseshoeprior,whiletimedependenceisincorporatedthroughanautoregressivemodelspeciﬁedontheregressioncoeﬃcientsasproposedby[41].Bothextensionsarecomputationallyeﬃcient,beingalsosuitableforparallel3computationsonmulticoremachines.Moreover,theapproachproposedby[41]scaleslinearlyinthenumberoftimepoints.Alimitationoftheneighbourhoodselectionbasedonnodewiseregres-sionisthelackofadirectposteriorestimateofthejointprecisionmatrix.Asdetailedin[45],theBayesianversionofnodewiseregressionallowstoaccuratelyestimatetheposteriordistributionoftheedgeselection,butdoesnotdirectlyprovideanestimateoftheprecisionmatrix.Nonetheless,wecanusetheestimatedposteriordistributionoftheregressioncoeﬃcientstoapproximatetheprecisionmatrixandasameasureofthestrengthanddirectionofeachspeciﬁcconnectioninthegraph.Thepaperisorganisedasfollows.InSection2weintroducenodewiseregression,itsextensionsanddiscusspriorspeciﬁcation.InSection3weshowtheperformanceoftheproposedmodelinsimulations.Section4illustratestheapplicationtotheSABREstudy.Section5concludesthepapersummarisingmainresultsandcontributions.2MethodologyInthisSection,weintroducenodewiseregressionanditsuseforgraphestimation.Weﬁrstprovideadetaileddescriptionofthebasicmodelforasinglegraph.Next,weexplainourstrategytoextendnodewiseregressiontomultiplegraphsandtothemoregeneraldynamicmultiplegraphsframework.Hence,weexplainhowtoperformposteriorinferenceonsuchmodels.2.1NodewiseregressionforgraphicalmodelsWeﬁrstintroducebasicconceptsfromgraphtheory.Formoredetails,wereferto[42].LetG=(V,E)beanundirectedgraph,withvertexsetV=(1,...,M)andedgesetE⊂{(j,l)∈V×V:j<l}.TheverticesofthegraphareassociatedwithaM-dimensionalvectorofvariablesy=(y1,...,yM)assumedtofollowamultivariateNormaldistributiony∼NM(µ,Ω)(1)whereµisthemeanvectorandΩ=[ωjl]Mj,l=1istheM×Mprecisionmatrix.InthecontextofGaussianGraphicalModels(GGM)[17],itisstandardpracticetospecifyapriordistributiononGand,then,conditionalonG,apriorforΩasthereisadirectcorrespondencebetweentheelementsoftheprecisionmatrixΩandtheedgesinthegraphG.AnedgeispresentbetweennodesVjandVl,thatis(j,l)∈E,ifandonlyifωjl6=0[42,79].Ifωjl=0(absenceofanedge),thenyjandylareconditionallyindependentgiventheremainingvariablesy−jl,wherey−jldenotestherandomvectoryexcludingtheelementsjandl.InthiscontextthemainobjectofinferenceisthegraphGandusuallyΩistreatedasalatentvariable.Posteriorinferenceisoftencomplicatedbythecomplexityofgraphspace.Inthispaperweoptforadiﬀerentapproachasitismorescalabletohigherdimensions.ToestimatethegraphGweusenodewiseregression[51],atechniquethatexploitstherelationshipbetweenthepartialcorrelationcoeﬃcientsandtheregressioncoeﬃcientsofalinearregression,withoutdirectlyspecifyingaprobabilitymodelforG.Recallthatforthestandardlinearregressionyl=Xj6=lβjlyj+εl,εl∼N(0,σ2l)(2)4theregressioncoeﬃcientsβjlcanbeexpressedintermsofpartialcorrelationsωjl,i.e.βjl=−ωjlωllandanalogouslyβlj=−ωljωjj.Thenωjl6=0⇐⇒βlj6=0⇐⇒βjl6=0ThisresultcanbealsoderivedfromthemomentsoftheconditionalNormaldistribution.Here,σ2ldenotestheerrorvariance.Inourcontext,considerthepartitionwheretherandomvariableylisthel-thcoordinateofyandy−lcorrespondstotheremainingcoordinates.Theconditionaldistributionofylgiveny−lisyl|y−l,µ,Ω∼Nµl−Xj6=lωjlωll(yj−µj),1ωll(3)whereωjl/ωll=βjl,forj6=l.Inmanyapplication,asinSection4,µlcapturescovariateeﬀectsontheresponseyl,i.e.µl=Zlηl,whereZlisthecovariatevectorandηlisthevectorofregressioncoeﬃcients.Inthiscase,thenodewiseregressionmodelisdeﬁnedontheresponsescentredonthecovariateterm.Foreaseofexplanation,inthefollowingsectionsweassume,withoutlossofgenerality,thatµ=(µ1,...,µM)=0.ThisframeworkallowsustoexpresstheproblemofgraphicalmodelselectionasMindependentlinearregressionproblems,sincearegressioncoeﬃcientestimatedequaltozeroimpliesazerointhecorrespondingelementoftheprecisionmatrixand,implicitly,alackofanedgeintheunderlyinggraph.Forthisreason,weareinterestedinidentifyingregressioncoeﬃcientsequaltozero.IntheBayesianframework,awealthofsparseBayesianregressiontechniquesisavailable.Whenperformingvariableselection,apopularchoiceistoimposeshrinkagepriorsontheregressioncoeﬃcients.Typicalexamplesincludetheclassoftwocomponentsdiscretemixturepriors,knownasspikeandslab[26],andtheclassofcontinuousshrinkagepriors,ofwhichexamplesaretheHorseshoeandtheHorseshoe+priorsee[6]forareview.Thespikeandslabapproachimpliesapositiveprobabilityfortheregressioncoeﬃcienttobezero,butitcanbecomputationallydemandingwithahighnumberofparameters,duetothelargestatespace.Incontrast,continuouspriorsareeasiertoimplementandareusuallymorecomputationallyeﬃcient,althoughtheprobabilityforthecoeﬃcienttobeexactlyzeroisnullandfurtherthresholdingisrequired.WeoptfortheHorseshoeprior[12],whichisascalemixturepriordeﬁnedasβj|λj,τ∼N(cid:0)0,λ2jτ2(cid:1)λj,τind∼C+(0,1)whereC+(0,1)denotesthestandardhalf-Cauchydistribution,withprobabilitydensityfunctionp(λj)=2π(1+λ2j),λj>0TheHorseshoebelongstothefamilyofglobal-localshrinkagepriors,astheglobal(i.e.commontoallβj)parameterτshrinksallthecoeﬃcientstowardszero,whilethethickhalf-Cauchytailsforthelocalscalesλjallowsomeregressioncoeﬃcientsβjtoescapetheshrinkageandcounter-balancetheeﬀectofτ.Moreover,theHorseshoepriorischaracterisedbyasingularityatzerotostrongly5shrinksmallornegligiblecoeﬃcients,whileleavingtheimportantonesunaﬀectedthankstoitsheavytails(givenbythehalf-Cauchydistribution).Wenowdescribetheproposedmodelforsinglegraphestimation.LetYbean×Mmatrixofobservations,wherenisthesamplesizeandMisthenumberofrandomvariables/nodes.Eachcolumnyl=(y1l,y2l,...,ynl)T,forl=1,...,M,containsthemeasurementsofthel-thvariable.Theregressionmodelforthel-thcolumncanbewrittenasyl|βl,σ2l∼Nn(cid:0)Xβl,σ2lIn(cid:1)βjl|λjl,τl∼N(cid:0)0,λ2jlτ2l(cid:1)σ2l|aσ,bσ∼Inverse-Gamma(aσ,bσ)(4)λjl∼C+(0,1)τl∼C+(0,1)whereXisthematrixofexplanatoryvariablesgivenbyY−l(i.e.Yexcludingthel-thcolumn)andβl=(β1l,β2l,...,βpl),withp=M−1,isavectorofregressioncoeﬃcientsforthel-thregression.Apseudoinclusionprobabilityparameterκjlisdeﬁnedby[12]asκjl=11+Var(βjl|λjl,τl)=11+λ2jlτ2l(5)whichisinterpretableastheamountofshrinkagetowardszero,withκjl≈1yieldingmaximalshrinkageandκjl≈0correspondingtominimalshrinkageandleadingtotheinclusionofthevariable/edgeinthegraph.Aspreviouslyshown[12],variableselectionbasedon(5)(withathresholdlevelof0.5)performssimilarlytoexplicitvariableselectionbasedonspikeandslabprior.Throughoutthiswork,wefollowthiscriteriontodecidewhichedgestoincludeinthegraph.Toimprovecomputationaleﬃciency,weusetherepresentationofthestandardhalf-Cauchydistributionemployedby[25,57].Thestandardhalf-Cauchydistributioncanbeexpressedastheproductofastandardhalf-NormaldistributiontimesthesquarerootofanInverse-Gammadistribution.Letz∼N+(0,1)andy∼Inverse-Gamma(1/2,1/2)anddeﬁnex=z√y,thenx∼C+(0,1).N+(0,1)denotesthestandardhalf-Normaldistribution,whichisdeﬁnedastheabsolutevalueofaNormaldistribution[44].Thisre-parametrisationcanhelptoavoiddivergenttransitionsinanHMCalgorithm(aproblemcommonlyencounteredwithfunnelshapeddistributions).Assuggestedby[57],wealsoallowforatunableglobalscaleparameterτl,whichcanhelpachievingthedesiredlevelofsparsity.Thusthepriordistributionontheregressionparametersbecomesβjl|λjl,τl∼N(0,λ2jlτ2l)λjl=λajlqλbjlτl=τalqτblτ0λajl∼N+(0,1)λbjl∼Inverse-Gamma(1/2,1/2)τal∼N+(0,1)τbl∼Inverse-Gamma(1/2,1/2)(6)whereτ0=p0p−p0σ√nandp0isapriorguessaboutthenumberofnon-zerocoeﬃcients.Thechoiceofp0isextensivelydiscussedby[57].Aschematicrepresentationofmodel(6)isshowninFigure1(a).6yly−lσ2lβjlj=1:pτlλjlj=1:pτalτblτ0λajlj=1:pλbjlj=1:p(a)StaticHorseshoenodewiseregressionmodelylrty−lrtσ2lrtβljrtβljrt−1j=1,...,pγljrthljrtτljrτ0λljrtφljrtj=1,...,pj=1,...,p(b)DynamicHorseshoenodewiseregressionmodelFigure1:Summaryofthenodewiseregressionmodels,highlightingtherelationshipbetweentheobservationsandtheparametersofthemodel.Circlesrepresentrandomvariables,whilesquarescorrespondtoobservationsorﬁxedhyper-parameters.(a)StaticHorseshoemodelforeachobservedvariableyl,withl=1,...,M,whenonlyagroupofobservationsisunderinvestigationatonetimepoint.(b)DynamicHorseshoemodelforeachobservedvariableylrtattimetandwithingroupr,withl=1,...,M.2.1.1ExtensiontomultiplegroupsWenowextendtheHorseshoepriortoallowborrowinginformationacrossmultiplegroupsofobservations.Thegroupsareusuallydeﬁnedbytheproblemunderinvestigation,forexampletheymightcorrespondtodiﬀerentbiologicalconditions,diseasestatusorspatialregions.Estimatingasinglegraphicalmodelwouldleadtoanimplicitassumptionofhomogeneityoftheunderlyinggraphsacrossgroups,withaconsequentlossofinformationabouttheirheterogeneityandahighriskoffalsepositives.Ontheotherhand,inferringeachgraphindividuallymightleadtoalossofpowergiventhereductioninsamplesize.SeveralapproachesforjointinferenceofmultipleGGMshavebeenrecentlydeveloped(see,forexample,[14,15,30,53,56,68,70,78]).Weoptfornodewiseregressionforcomputationalconvenienceandeaseofextensiontomorecomplexsetups.LetRbethenumberofgroupsandletYrbeamatrixofdimensionnr×Mcontainingonlytheobservationsbelongingtogroupr,withr=1,...,R.WeintroducedependenceacrossmultiplegraphsthroughthegroupspeciﬁcglobalshrinkageparameterτlroftheHorseshoeprior,extendingeasilymodel(6)tothissetup.Themodelisnowdeﬁnedasfollowsylr|βlr,σ2lr∼Np(cid:0)Xrβlr,σ2lrInr(cid:1)βjlr|λjlr,τlr∼N(cid:0)0,λ2jlrτ2lr(cid:1)λjlr=λajlrqλbjlrτlr=τalqτblτ0rσ2lr|aσ,bσind∼Inverse-Gamma(aσ,bσ)λajlr∼N+(0,1)λbjlr∼Inverse-Gamma(1/2,1/2)τal∼N+(0,1)τbl∼Inverse-Gamma(1/2,1/2)(7)7whereXrisanr×pmatrixcorrespondingtoY−lr(i.e.Yrexcludingthel-thcolumn)andβlr=(β1lr,β2lr,...,βplr)isavectorofregressioncoeﬃcientsspeciﬁctoequationlandgroupr.WeexploitthestructureoftheHorseshoeprior,retaininggroup-coeﬃcientspeciﬁclocalshrinkageparametersλjlr,whilewelinktheparametersτlr.Therationalebehindthisstrategyisthefollowing.Theglobalshrinkageparameterτlrpullsallthecoeﬃcientsgloballytowardszero,whilethethickhalf-Cauchytailsforthelocalvariancesλ2jlrallowtheimportantcoeﬃcientstoescapetheglobalshrinkageindependentlyineachgroup[12].Inpractice,weexpectthegraphstohavegroupspeciﬁcconnectionpatterns,allowedbythegroup-coeﬃcientspeciﬁclocalshrinkageparametersλjlr.Wealsoexpectgroupstosharesomecommonstructuresandtobesparse.Forthisreason,welinktheglobalshrinkageparametersτlr,allowingborrowinginformationacrossgroupsaboutthegloballevelofsparsityofthegraphs.2.1.2Extensiontomultipletimepoints-DynamicHorseshoepriorAnaturalextensionofthemodelaboveistointroduceatemporaldimension,whichallowsjointinferenceoftimedependentgraphsfrommultiplegroups.SomerecentproposalsforinferenceofdynamicGraphicalModelscanbefound,forinstance,in[1,21,28,31,33,45].Inthiswork,weconsidertheevolutionovertimeofthepatternsofmetabolicassociationsfortwoethnicgroups.Ourgoalistoestimatesparsemultiple-graphsevolvingovertime.Here,weprovideanextensionofthenodewiseregressionwhichenablesestimationoftimedependentgraphsformultiplegroups,enablingborrowingofinformationacrosstimeandgroups.Oneofthemaingoalsistogainabetterunderstandinghowthediﬀerencesinassociationsamonggroupsevolveovertime.Tothisend,weextendthemodelin(7)byimposingatimestructureovertheshrinkagescaleparametersoftheHorseshoepriorfollowingtheapproachproposedby[41].Timedependenceisintroducedbyspecifyingastochasticvolatilitymodelonthelog-varianceofeachregressioncoeﬃcient,aswellasanautoregressiveterminthedistributionofβjrt.Lett=1,...,TbethetimeindexandletYrtbeanrt×Mmatrixcontainingtheobservationsbelongingtogrouprattimet.Inwhatfollows,weomittheequationsubscriptlforeaseofnotation.Deﬁnehjrtashjrt=log(cid:0)τ2jrτ20/√pnrt(cid:1)+φjr(cid:0)hjrt−1−log(cid:0)τ2jrτ20/√pnrt(cid:1)(cid:1)+log(cid:0)λ2jrt(cid:1)(8)wherep=M−1,φjrisanautoregressivecoeﬃcientspeciﬁctothej-thcovariateandr-thgroup,τ0isaglobalshrinkageparametercommontoallregressioncoeﬃcientsandsharedbyallgroups,τjrisagroup-coeﬃcientspeciﬁcshrinkageparameterandλ2jrtisatime-group-coeﬃcientspeciﬁclocalshrinkageparameter.Notethatτ0allowssharinginformationacrossgroups,whilethetimedependenceiscapturedbytheparameterφjr.Finally,thetime-dependentmultiple-groupsnodewise8regressionmodelbecomesyrt|βrt,σ2rt∼Np(cid:0)Xrtβrt,σ2rtInrt(cid:1)σ2rt|aσ,bσ∼Inverse-Gamma(aσ,bσ)βjrt=βjrt−1+γjrtexp(hjrt/2)γjrtind∼N(0,1)(9)hjrt=log(cid:0)τ2jrτ20/√pnrt(cid:1)+φjr(cid:0)hjrt−1−log(cid:0)τ2jrτ20/√pnrt(cid:1)(cid:1)+log(cid:0)λ2jrt(cid:1)(φjr+1)/2|φa,φb∼Beta(φa,φb)τ0∼C+(0,1)τjr∼C+(0,1)λjrt∼C+(0,1)whereβrt=(β1rt,...,βprt)isatimeandgroupspeciﬁcvectorofregressionparametersandXrtisanrt×pmatrixcorrespondingtoY−lrt(i.e.Yrtexcludingthel-thcolumn).Aschematicrepresentationofmodel(9)isshowninFigure1(b).Thedistributionofthelogarithmofthesquareofahalf-CauchyrandomvariableisaZ-distribution[41].Inparticular,ifζ=log(λ2),whereλ∼C+(0,1),thenζhasprobabilitydensityfunctiong(ζ)=π−1exp(ζ)[1+exp(ζ)]−1,ζ∈R(10)TheZ-distributioncanberepresentedasamean-variancemixtureofGaussiandistributions[4]and,thankstothePolya-Gammaexpansionproposedby[41],wecandevelopamultiplegroupshierarchysimilartotheoneinmodel(7).Tothisend,wedeﬁneζjrt=log(cid:16)λ2jrt(cid:17),µ0=log(cid:0)τ20(cid:1)andµjr=log(cid:16)τ2jrτ20(cid:17)andwere-writethepriordistributionsfortheparametersonalogscaleasζjrt|ξζjrt∼N(cid:16)0,ξ−1ζjrt(cid:17)µjr|µ0,ξµjr∼N(cid:16)µ0,ξ−1µjr(cid:17)µ0|ξµ0∼N(cid:0)0,ξ−1µ0(cid:1)ξζjrt∼Polya-Gamma(1,0)ξµjr∼Polya-Gamma(1,0)ξµ0∼Polya-Gamma(1,0)(11)Thismodellingstrategyallowsustopropagatetheshrinkageproﬁleofeachregressioncoeﬃcientovertime,allowingfaststructuralchangesorslowlyadjustingprocesses.ThetheoreticalpropertiesofthedynamicHorseshoepriorarediscussedby[41],whoalsoshowitsgoodperformancewhencomparedtoalternativepriors.Moreover,thePolya-Gammaexpansionin(11)leadstoeﬃcientcomputationsasitallowstodesignafastblock-Gibbssampler(although,fortheapplicationinthiswork,posteriorinferenceisperformedthroughHamiltonianMonteCarlomethodsasimplementedinthesoftwareStan).2.2PosteriorInferenceFordatasetsofmoderatesize,e.g.M≤30andsamplesizen≤1000,posteriorinferenceforthenodewiseregressionmodelwithHorseshoeprior(staticanddynamic)canbeperformedeﬃcientlyusingBayesiansoftwareslikeStan[11]orJAGS(http://mcmc-jags.sourceforge.net/).Themaincomputationalbottleneckforourmodelissamplingfromtheposteriordistributionofthe9regressioncoeﬃcients,whichcanbeexpensiveforlargevaluesofpwithcomplexityequaltoO(p3)ingeneralsettings[7,62].[37]proposeanapproximationschemeforthehorseshoeposterior,whichexploitsthestructuralsparsityoftheposteriortoreducethecostperstepandthatcanscaletohundredsofthousandsofpredictors.Theperstepcomputationalcostoftheapproximatealgorithmisoftheorder(κ∨p)N,whereκisthenumberofincludedvariablesateverystep.InSection1ofSupplementalMaterial,weprovidesamplecodetoimplementtheproposedapproachinStan,whichimplementsHamiltonianMonteCarlo(HMC,[9],chapter5).WhenMislarge(>100),implementationinalowlevellanguageisadvisable.WealsodevelopablockGibbssampling,extendingthealgorithmprovidedby[41]toallowformultiplegroupsofdiﬀerentsamplesizesacrosstime.DetailsoftheMCMCalgorithmareprovidedinSection1ofSupplementalMaterial.Thecomputationaleﬃciencyofthetwoalgorithmsisassessedthroughasimulationstudy.WeconsiderN=100observationssplitequallybetweentwogroupsanddiﬀerentvaluesforthenumberofnodesMandoftimepointsT.Werecordthecomputationaltimes(inseconds)periterationforboththestanimplementationandtheblockGibbssamplerMCMCalgorithm(implementedinR).ThecomputeronwhichwehaverunthesimulationsisaLinuxmachinewithIntelCorei71.8GHZ.AsitisshowninTable1ofSupplementalSection1,bothalgorithmsarecomputationallyeﬃcientwhenT=3,withtheGibbssampleroutperformingStanforlargernumberoftimepoints.ThisisduetotheabilityoftheGibbssamplertoperformjointupdateswithoutloopingoverthenumberoftimepoints.RecallalsothatthecomputationalburdenofthedynamicHorseshoeapproachscaleslinearlywiththenumberoftimepoints[41].Theresultscanbefurtherimprovedbyimplementingaparallelprogrammingstrategy,thankstotheconditionalindependenceofthediﬀerentregressions.Finally,posteriorinferenceontheimpliedgraphcanbeperformedbyapplyingeithertheORruleortheANDrule.Inpractice,ateveryiterationoftheMCMCalgorithm,weobtainadrawforthegraph,byincludinganedgebetweennodesjandlifandonlyifthedrawsβjl6=0orβlj6=0,inthecaseoftheORrule.WhenusingtheANDrule,weincludeanedgebetweennodeslandjifandonlyifthedrawsβjl6=0andβlj6=0.Moreover,givenβjlandσ2l,weobtainasampledvalueforΩbysettingthediagonalelementsequalto1/σ2landoﬀ-diagonalelementsequalto−βjl/σ2l.3SimulationStudyWeinvestigatetheperformanceoftheproposedmodelsonsyntheticdatasets.WeevaluatetheabilityofeachmodeltoestimatetheprecisionmatrixΩthroughtheMeanAbsoluteError(MAE),calculatedbetweenthetruematrixanditsposteriormeanestimate.WealsoinvestigatetheabilityofthemodeltorecoverthetruegraphstructureGusingtheAreaUndertheCurve(AUC),whichisanormalisedmeasureoftheareaundertheReceiverOperatingCharacteristic(ROC)curve.TheROCcurveisobtainedbyplottingthetruepositiverateagainstthefalsepositiverateevaluatedatdiﬀerentthresholdsfortheedgeinclusionprobability.Wealsoincluderesultsrelativetothefalsepositiverates(FPR)andfalsenegativerates(FNR)whencomparingdiﬀerentnetworkestimates.ForallthesimulationscenariospresentedinthisSection,weshowtheresultsobtainedbyapplyingtheANDrule.UsingtheORruleyieldcomparableresults.Intheﬁrstsimulation,wecomparetheestimateofthemultiplegroupsmodelin(7)withthatoftheRpackageBDgraph,whichimplementsabirth-deathMCMCalgorithmforBayesianstructurelearningingraphicalmodels,andwiththeGraphicalGroupLasso[15].WeconstructthreeprecisionmatricesΩ1,Ω2andΩ3,correspondingtographsG1,G2andG3,ofM=20nodes.Following[56],10weﬁrstdeﬁnetheprecisionmatrixΩ1andthenderivetheothersasaperturbationoftheﬁrst.WesetthemaindiagonalelementsofΩ1equalto1,ﬁrstoﬀ-diagonalelementsωi,i+1=ωi+1,i=0.5,fori=1,...,19andsecondoﬀ-diagonalelementsωi,i+2=ωi+2,i=0.5,fori=1,...,18.Thenwesetallωi,j=0.9,fori<j<6,whiletherestoftheelementsaresettozero.Ω2isderivedfromΩ1,settingthesecondoﬀ-diagonalelementsωi,i+2=ωi+2,i=0,fori=1,...,18,alltheremainingelementsbeingequal.Ω3isderivedfromΩ1,settingtheﬁrstoﬀ-diagonalelementsωi,i+1=ωi+1,i=0,fori=1,...,19,alltheremainingelementsbeingequal.Thenewlycreatedmatricesarenotpositivedeﬁniteand,therefore,wecomputethenearestpositive-deﬁniteapproximationthroughtheRfunctionnearPD([32],fromtheRpackageMatrix.TheprecisionmatricesΩ2andΩ3constructedwiththisprocedureareaperturbationofΩ1:asaresulttheyexhibitsomecommonedgesandsomegroupspeciﬁcconnections.Thenumberofobservationsisﬁxedto60,40,30forgroup1,2and3,respectively.Eachgraphischaracterisedbyadensegroupofedgesonnodes1to6,representingasetofhighpartialcorrelations(absolutevalueof0.9).Inthesecondsimulationscenariowecomparethemultiplegroupsdynamicnodewisemodelin(9)with(i)thestaticmultiplegroupsnodewisemodelin(7)(whereweassumethethreetimeperiodstobeindependent);(ii)theBDgraphpackageand(iii)theGraphicalGroupLASSO.WeconsiderM=20nodes,twogroupsandweconstructtwomatricesΩ1t1andΩ2t1,oneforeachgroupattime1.FirstwesetthemaindiagonalelementsofΩ1t1equalto1andweadd12non-zerooﬀ-diagonalelements,chosenrandomlyfromtheKpossibleedgesandsettingthemequalto0.5.ThenΩ2t1isconstructedremovingtwoedgesfromΩ1t1atrandomandaddingthreenewedgeschosenrandomlyasbefore.Thesethreenewedgesaresetequalto0.5.Finally,wesimulatetheevolutionovertimeofthetwoprecisionmatrices,removingtwoedgesandaddinganewedgerandomlychosenforeachtimepoint(settingthecorrespondingelementsintheprecisionmatrixequalto0.5)foratotalofT=3timepoints.InFigure3inSection2ofSupplementalMaterial,weshowthenetworksgeneratedwithsuchprocedurefromwhichwesimulatethedatasets.Thenumberofobservationsisﬁxedto50,40,30respectivelyfort1,t2andt3(whereeachgrouphashalfofthetotalsamplesizeateachtimepoint).Inthethirdsimulationweconstructthedynamicprecisionmatricesfollowingthesamepro-cedureasthesecondscenario,changingthenumberoftimepointstoT=10.Thenumberofobservationsisﬁxedto40pertimepoint(equallysplitbetweentwogroups).Thegeneratedgraphsarecharacterisedbyaslowlychangingpattern,whereonlyoneedgeisaddedorremovedateachtimepoint.3.1SimulationresultsInFigure1inSupplementalSection2wereporttheresultsoftheﬁrstsimulationscenariobydisplayingtheboxplotsoftheMAEandAUC,calculatedovertwentyreplicatesobtainedwiththemultiplegroupsnodewisemodel(7)andwiththeBDgraphpackage.ThenodewisemodelworksbetterintermsofMAE,forwhichavaluecloserto0denotesanestimateofΩclosetothetruth,andintermsofAUC,forwhichavaluecloseto1denotesabetterrecoveryofthetruegraph.ThevaluesoftheFPRandFNRforthetwomodels,showninFigure2inSection2ofSupplementalMaterial,arecomparableinallgroups,andinparticularequaltozeroforgroupsG2andG3.InFigures4and5inSupplementalSection2weshowtheresultsforthesecondsimulationscenario.Wecomparetheresultsobtainedusingthedynamicandstaticmultiplegroupsnodewisemodelsin(7)and(9),theBDgraphpackageandtheGraphicalGroupLASSOmethod.Wenoticeacompetitiverecoveryoﬀeredbytheproposedmodelofthetrueprecisionmatrices(Figure4,MAE,11toptwopanels).Thegraphicalstructure(Figure4,AUC,bottomtwopanel)isrecoveredwellbytheproposedmethodintwoofthetimepointsfortheﬁrstgroup,andinthesecondtimepointforthesecondgroup.Inthissimulationsetting,nomethodconsistentlyoutperformstheothers.Thisisnotsurprisinggiventhesamplesizes.InFigure5wedisplayFalsePositiveandFalseNegativeRatesforthefourmodels.Asexpected,giventheuseofashrinkageprior,theproposedmodelsperformbetterintermsofFPRand,ingeneral,similarlytoBDgraph.WenotethatGraphicalGroupLASSOinduceslesssparsityingraphreconstruction.TheresultsofthecomparisonbetweenthedynamicandstaticnodewisemodelsobtainedfromthethirdsimulationscenarioareshowninFigures2and3,wherewereporttheboxplotsoftheMAE,AUC,FPRandFNRcalculatedovertwentyreplicates.ThedynamicmodelhasthelowestMAEvaluesinbothgroupsandatalltimepoints,whileBDgraphshowstheworstperformanceintermsofMAE.Intermsofgraphrecovery,asmeasuredbyAUC,themethodsarecomparable.IntermsofFPR,thedynamicHorseshoemodelperformsmostshrinkage,althoughitsuﬀersthehighestFNR.4ApplicationInthisSection,weapplythenodewiseregressionmodelfordynamicmultiplegraphstotheSABREmetabolicdata.Thedatasethasatotalof1246observationsatbaseline(T1)and875atfollow-uptime(T2).Inthisapplication,groupsaredeﬁnedbyethnicity.Individualsarestratiﬁedintotwoethnicitiesateachtimepoint,690Europeansand556South-AsiansatT1and503Euro-peansand372South-AsiansatT2.Measurementsofdiﬀerentclassesofmetabolitesareavailable.Lipoproteins,whichconstitutethemajorityofthemetabolomicdataset,areclassiﬁedaccordingtotheirdensity(very-low-densitylipoprotein(VLDL),low-densitylipoprotein(LDL),intermediate-densitylipoprotein(IDL)andhigh-densitylipoprotein(HDL)).Eachlipoproteinsubclasscanbefurthercharacterisedbyitslipidcomposition(i.e.triglycerides,phospholipids,freecholesterolandcholesterylesters)anditsparticlesize.ThefulllistofmetabolitesincludedintheanalysisisreportedinTable2inSection2ofSupplementalMaterial.Weincludeintheanalysisclinicalmarkers,suchasthehomeostasismodelassessment(HomaIR)asanindexofinsulinresistance[49]-animportantriskfactorforthedevelopmentoftype2diabetes-,waisttohipratio(WHR)asameasureofbodyfatdistribution,controlvariablessuchasgender,age,smokinghabits,physicalactivityandalcoholconsumption.Wecontrolforpreviousdiseasestatus,inparticularweincludeindicatorsofcoronaryheartdisease(CHD),strokeanddiabetesmellitus.Wealsoincludeindica-torsofdrugtreatmentsforbloodpressure,diabetesandbloodlipids.ThefulllistofcovariatesincludedisgiveninTable3inSection2ofSupplementalMaterial.ThenodesofthegraphcorrespondtothediﬀerentmetabolitesandthereareatotalofM=88nodes(i.e.thenumberofequationsinthenodewiseregression).Whenanalysingthesedata,itisimportanttocontrolforclinicaleventsofinterest(e.g.developmentofdiabetes)thatoccurbeforeT1andbetweenT1andT2.Tothisend,wemodelthemeanµlofthemultivariateNormaldistributionin(3)throughalinearpredictorandassumethatµlrt=Zηlrt,whereZisamatrixofpredictorscommontoallequationsandηlrtisapz-dimensionalvectorofregressioncoeﬃcientsforthemeanlevel.Themodeliscompletedbyspecifyingatimedependentstructureandaprior120.10.30.50.7MAE group 1ll0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7l0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7l0.10.30.50.70.10.30.50.70.10.30.50.7ll0.10.30.50.7l0.10.30.50.7l0.10.30.50.70.10.30.50.7ll0.10.30.50.7l0.10.30.50.7l0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7l0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7t1t2t3t4t5t6t7t8t9t100.10.30.50.7MAE group 20.10.30.50.70.10.30.50.7l0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7l0.10.30.50.7l0.10.30.50.70.10.30.50.7l0.10.30.50.7l0.10.30.50.7ll0.10.30.50.70.10.30.50.70.10.30.50.7ll0.10.30.50.7lll0.10.30.50.7l0.10.30.50.70.10.30.50.7ll0.10.30.50.7ll0.10.30.50.7lll0.10.30.50.70.10.30.50.7ll0.10.30.50.70.10.30.50.70.10.30.50.7l0.10.30.50.7ll0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7ll0.10.30.50.70.10.30.50.7l0.10.30.50.70.10.30.50.7ll0.10.30.50.70.10.30.50.70.10.30.50.70.10.30.50.7t1t2t3t4t5t6t7t8t9t10Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOl0.650.750.850.95ROC AUC group 1ll0.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.95ll0.650.750.850.950.650.750.850.95ll0.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.95ll0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.95ll0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95ll0.650.750.850.95t1t2t3t4t5t6t7t8t9t10ll0.650.750.850.95ROC AUC group 2l0.650.750.850.950.650.750.850.950.650.750.850.95ll0.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.95ll0.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95llll0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95ll0.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.95t1t2t3t4t5t6t7t8t9t10Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOFigure2:Thirdsimulationscenario.MAEandAUCcomparisonbetweentheresultsobtainedusingthedynamicmodelin(9)(black),thestaticmodelin(7)(red),BDgraph(green)andGraphicalGroupLASSO(blue).Eachrowreferstooneofthegroupsandshowstheboxplotsforeachofthetentimepoints.TheresultsareobtainedovertwentyreplicatesandbyadoptingtheANDrule.IntermsofMAE,thedynamicmodelyieldsthelowestvalues,indicatingoverallagoodperformanceinestimatingtheprecisionmatrix.Ontheotherhand,BDgraphshowstheworstperformanceintermsofMAE.ThemethodsarecomparableintermsofAUC.130.10.20.30.40.5FPR group 1l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5ll0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5t1t2t3t4t5t6t7t8t9t100.10.20.30.40.5FPR group 20.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5ll0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5ll0.10.20.30.40.5l0.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5ll0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.5lll0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5l0.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.50.10.20.30.40.5t1t2t3t4t5t6t7t8t9t10Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSO0.20.40.60.8FNR group 1ll0.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8lll0.20.40.60.80.20.40.60.8t1t2t3t4t5t6t7t8t9t10l0.20.40.60.8FNR group 20.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.8l0.20.40.60.80.20.40.60.8l0.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.80.20.40.60.8l0.20.40.60.8l0.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.80.20.40.60.8t1t2t3t4t5t6t7t8t9t10Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOFigure3:Thirdsimulationscenario.Falsepositiverates(FPR)andfalsenegativerates(FNR)forthedynamicmodelin(9)(black),thestaticmodelin(7)(red),BDgraph(green)andGraphicalGroupLASSO(blue).Eachrowreferstooneofthegroupsandshowstheboxplotsforeachofthetentimepoints.TheresultsareobtainedovertwentyreplicatesandbyadoptingtheANDrule.Inbothgroups,thedynamicandGraphicalGroupLASSOmodelsdiﬀerthemostintermsofFPRandFNR.Ontheotherhand,theresultsforthestaticmodelandBDgrapharecomparableattheﬁrsttimepoints,anddivergeslightlyatlatertimepoints.14distributiononηlrtasfollowsηklrt=ηklrt−1+γzklrtγzklrt∼N(0,s0)fork=1,...,pz,wheres0isthepriorvariance,herespeciﬁedtoinduceaﬂatNormaldistribution.Posteriorinferenceisperformedbyupdatingjointlytheregressioncoeﬃcientsβlrtandηlrt.Wealsoincludeanintercepttermsothatthetotalnumberofcovariatesispz=20.WeruntheMCMCfor10000iterations,includingaburn-inperiodof2000iterationsandthinningevery4iterations.WeperformposterioranalysisapplyingboththeANDandORrule.InFigures6to9inSupplementalSection2,wereporttheposteriorexpectationofκforeachgroupandtimepoint.Furthermore,inFigures10to17wedisplaytheinferredindividualnetworksforeachethnicgroupatbothbaselineandfollow-uptimes.Thesenetworksarecharacterisedbyahighnumberofedges,inparticular,wecannoticeaveryhighlyconnectedgroupoflipoproteinsinallgraphs.Inadditiontotheindividualnetworkswealsoestimatethediﬀerentialnetworks[16,68,74]derivedfromthepairwisecomparisonbetweenthegraphscorrespondingtothetwoethnicitiesforeachtimepointandthepairwisecomparisonbetweenT1andT2foreachethnicity.Following[68],adiﬀerentialnetworkincludesalltheedgesthatarepresentonlyinoneofthetwogroups/times(i.e.presentinonegroup/timeandnottheotherandvice-versa),thussheddinglightonthemaindiﬀerencesbetweenethnicitiesandtheevolutionofthemetabolicassociationsovertime.DiﬀerentialnetworksobtainedwiththeANDareshowninFigures4to7,whilethoseobtainedwithORarereportedinFigures18to21.Inadiﬀerentialnetwork,anedgebetweentwonodesisaddediftheposteriorprobabilityofanedgebeinginonegraphbutnotintheotherishigherthan0.5.InthisSection,weonlydiscusstheresultsobtainedwiththeANDrulesinceitimpliesamorestringentselectioncriteria.InFigures4and5weshowthediﬀerentialnetworksbetweenT1andT2forEuropeansandSouth-Asians,respectively.Itisworthnoticingthattherearenoedgesamongthemajorityofthemetabolitesinbothdiﬀerentialnetworks,whichimpliesthatthepresenceorabsenceofthoseconnectionsissharedbytherespectiveethnicitybothatT1andT2.Moreover,forbothethnicgroups,themajorityoftheedgesinthediﬀerentialnetworksderivesfromedgespresentatbaseline,butnotatfollow-up.Theconnectedmetabolitesinthediﬀerentialnetworksforbothethnicities(Figures4and5)belongpredominantlytothegroupsofverylowdensitylipoproteinsandhighdensitylipoproteins,withtheadditionofanedgebetweenleucineandisoleucine.Theseare,togetherwithvaline,essentialaminoacidswhichaccountfor35–40%ofthedietaryindispensableaminoacidsinbodyproteinand14%ofthetotalaminoacidsinskeletalmuscle[47].Theirassociationwithanumberofdisordershasoftenbeenreportedintheliterature,includinginsulinresistance,type-2diabetes[29]andcardiovasculardiseases[72].InFigures6and7wereportthediﬀerentialnetworksbetweenEuropeansandSouth-Asians,respectivelyattimeT1andT2.Thesenetworkspresentedgesconnectingamino-acidsandlipopro-teinssub-fractions,highlightingpotentialdiﬀerencesinunderlyingmetabolicprocesses.InthelastcolumnofTable2inSupplementalSection2wereportthemetabolitesdiﬀerentiallyconnectedatbothtimepoints.Togainabetterunderstandingoftheestimatedconnectionsandtorelatetheestimatedgraphtoknownmetabolicpathways,weconductapathwayover-representationanalysis(ORA)usingtheonlinesoftwareIMPaLA[IntegratedMolecularPathwayLevelAnalysis,38].Weincludeintheanalysisallmetabolitesthathaveaconnectioninthediﬀerentialnetwork.ORAevaluatesstatisticallythefractionofmetabolitesinaparticularpathwayfoundamongtheuser-15llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgBaselineFollow−UpPositive par.corr.Negative par.corr.Time Differential Network for EuropeansFigure4:EuropeanDiﬀerentialnetworkbetweenbaselineandfollow-upobtainedwiththeANDrule.Redlinescorrespondtoedgesonlypresentinthebaselinenetwork,whilebluelinestothoseonlypresentinthefollow-upnetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.Notethatthemajorityofthediﬀerentialedgescomesfromthoseonlypresentinthebaselinenetwork.16llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgBaselineFollow−UpPositive par.corr.Negative par.corr.Time Differential Network for South−AsiansFigure5:South-AsiansDiﬀerentialnetworkbetweenbaselineandthefollow-upobtainedwiththeANDrule.Redlinescorrespondtoedgesonlypresentinthebaselinenetwork,whilebluelinestothoseonlypresentinthefollow-upnetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.Notethattheonlydiﬀerencebetweenthetwonetworkscomesfromedgesonlypresentinthebaselinenetwork.17llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansSouth−AsiansPositive par.corr.Negative par.corr.Ethnicity Differential Network for the BaselineFigure6:DiﬀerentialnetworkbetweenEuropeansandSouth-AsiansatbaselineobtainedwiththeANDrule.RedlinescorrespondtoedgesonlypresentintheEuropeannetwork,whilebluelinestothoseonlypresentintheSouth-Asiannetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.18llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansSouth−AsiansPositive par.corr.Negative par.corr.Ethnicity Differential Network for the Follow−UpFigure7:DiﬀerentialnetworkbetweenEuropeansandSouth-Asiansatfollow-upobtainedwiththeANDrule.RedlinescorrespondtoedgesonlypresentintheEuropeannetwork,whilebluelinestothoseonlypresentintheSouth-Asiannetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.19speciﬁedsetofmetabolites,inourcasethemetaboliteswithconnectionsinthediﬀerentialnetwork.Foreachpathway,inputmetabolitesthatarepartofthepathwayarecounted.Next,everypathwayistestedforover-orunder-representationinthelistofinputmetabolitesusingthehypergeometrictest.Themostrepresentedpathwaysaretheoneswithsmallerp-valueandhighernumberofover-representedmetabolites.Herewediscusstheﬁrstfourtop-rankedpathwaysattimeT2:Cholesterolmetabolism,Fatdigestionandabsorptionmetabolism,LipidandatherosclerosismetabolismandVi-tamindigestionandabsorption.NotethatthediﬀerentialnetworkattimeT1containsonlyoneextrametabolitesascomparedtoT2,leadingtosubstantiallythesamepathways.Cholesterolmetabolisminhumansisacomplexprocesswhichinvolvesmultiplemetabolicpath-wayssubjecttomanypointsofregulationundergeneticandmetaboliccontrol[27].Inbrief,choles-teroliseithersuppliedfromdietorsynthesizedbymanycellsofthebody,withtheliverbeingoneofthemajorsitesofcholesterolsynthesis.Adietcharacterisedbyhighintakesofcholesterolitself,orofsaturatedfatsandexcessivecalories,mayincreasethelevelofcholesterolintheblood.Theresponsetochangesindietarycholesterolisheterogeneousinhumansandmanystudiesshowthatcholesterolconsumptionshouldberestrictedbydiabeticsandothersatriskforcardiovasculardisease[18].Moreover,levelsofcholesterolinbloodarealsoinﬂuencedbyenvironmentalfactorssuchasdietaryfattyacidsandmetabolicperturbationssuchasdiabetes,obesityandgeneticfactors[3].Lipidsandlipoproteinscruciallycontributetoatherosclerosis,thepathologicalbasisofcardio-vasculardiseasesandinﬂuenceinﬂammatoryprocessesaswellasfunctionofleukocytes,vascularandcardiaccells,therebyimpactingonvesselsandheart.Clinicalstudieshavefoundaclearcausalrelationshipbetweenhypercholesterolaemiaandatheroscleroticdisease[see,forinstance,59].Fur-thermore,beyondLDLcholesterol,thereisevidencethatalsootherlipidmediatorscontributetocardiovascularrisk[65].Consistentlywithouranalysis,ethnicdiﬀerencesindyslipidemiapatterns,lipidmetabolism,totalandHDLcholesterolhavebeenreportedintheliterature[20,23,73].Lipidshavephysical,chemical,andphysiologicalcharacteristicsthatmakethemimportantfactorsinhumannutrition.Theyformagroupofcompoundsofvariedchemicalnature,withthecommonpropertyofbeingsolubleinorganicsolventsbutinsolubleinwater.Thispropertyaﬀectstheirdigestion,absorptionandtransportinthebloodandmetabolismatcellularlevel[60].Dietaryfatsconsistofawiderangeofpolarandnonpolarlipids[10].Triacylglycerolisthedominantfatinthediet,contributing90–95%ofthetotalenergyderivedfromdietaryfat.Dietaryfatsalsoincludephospholipids,sterols(e.g.cholesterol),andmanyotherlipids(e.g.fat-solublevitamins).Lipiddigestion,absorption,andmetabolismhavebeenlinkedtolipid-associateddisorders,includingdyslipidemiasandcardiovasculardiseases.Eﬃcientabsorptionofdietaryfatsisimportantasfatcanbeusedasasourceofenergytosupportvariouscellularfunctionsorstoreduntilitisneededtosupportintracellularprocesses[35].Mostcirculatingandstoredfattyacidsarederivedfromthediet[75]andinrecentyearstherelationshipbetweenfattyacidsandcardiovasculardiseasehasreceivedincreasinginterest[76].Forinstance,amajorriskfactorforobesityandobesity-relatedmetabolicdisordersistheregularconsumptionoffat-richmeals.Hence,atremendouseﬀorthasbeendevotedtowardslimitingtheamountofdietarylipidsabsorbedthroughthegastrointestinaltract.Ingeneral,mostfocushasbeenplacedonlimitingtriglyceridedigestionintheintestinallumenandthetransportandabsorptionoffattyacidsandcholesterolthroughtheintestinalmucosa.Otherfatsalsocontributetoobesity-relateddisorders,suchasphospholipids,whicharemajorconstituentsintheintestinallumenaftermealconsumption,andproductsofphospholipidmetabolismintheintestine,whichdirectlycontributetocardio-metabolicdiseasesthroughmultiplemechanisms[34].Regardingthelipidandatherosclerosispathway,atherosclerosisisachronicinﬂammatorydis-20easemarkedbyanarrowingofthearteriesfromlipid-richplaquespresentwithinthewallsofarterialbloodvessels[39].Elevatedlevelsoflowdensitylipoprotein(LDL)cholesterolconstituteamajorriskfactorforgenesisofatherosclerosisasLDLcanaccumulatewithinthebloodvesselwallandundergomodiﬁcationbyoxidation.ItisgenerallyacceptedthatatheroscleroticlesionsareinitiatedviaanenhancementofLDLuptakebymonocytesandmacrophages[13,46].Ethnicdiﬀerenceshavebeenreportedintheriskofatherosclerosis.Forexample,Lipoprotein(a)(LP(a))isawell-knownriskfactorforatherosclerosisandLp(a)-associatedriskmayvarybyethnicity[e.g.,22].Lp(a)hasbeenrelatedtogreaterriskofcarotidplaqueanditsprogressioninwhitesandLp(a)-associatedriskofplaqueoutcomesvarysigniﬁcantlyinwhiteandblackindividuals[67].Moreover,therearedistinctpatternsoflipidproﬁlesassociatedwithethnicityregardlessoftheglucoselevels[80]andinthebiologicalrelationshipsunderlyingtheserumlipids-diseaseassociation[5].ThefourthidentiﬁedpathwayisVitamindigestionandabsorption.Vitaminsareorganicsub-stanceswhichareessentialforhealthandwell-beingastheycatalysenumerousbiochemicalreac-tions.Vitaminsmustbeobtainedfromexogenoussourcesviaintestinalabsorptionsincehumansandothermammalscannotsynthesizethesecompounds[39].Theimportanceofvitaminsinhealthhasbeenwidelyreported[48,69].TheseﬁndingssuggestplausiblemetabolicpathwayswhichmaybedisorderedtoagreaterextentinSouth-Asiansandcontributetotheirexcessriskofdiabetesandcardiovasculardisease.InFigures22,23,24and25weplottheposteriormeanoftheregressioncoeﬃcientsηjlrt,foreachequationlandcovariatej,groupedbyethnicityandtime.Themeasureofbody-fatdistributionWHRhasanegativeeﬀectonmanymetabolitesforbothethnicities,particularityatT1,whileafewmetabolitesareaﬀectedatT2.Bloodlipids(triglycerides,cholesterols)andHDLareimportantforbothgroupsandtimeperiods.Thepresenceofdiabetes,ordiabetestreatment,alsoaﬀectsthemeanlevelofsomemetabolites,inparticularinEuropeans.HomaIRhasaneﬀectonanelevatednumberofmetabolitesatT1andT2inbothEuropeansandSouth-Asians.Overall,HomaIR,bloodlipidsandserumHDLarethecontrolvariablesthathavestrongereﬀect(seethe95%credibleregion)onthemetabolites.HighbloodtriglyceridesandlowHDLareamongtheriskfactorsthatdeterminethemetabolicsyndrome[61],whichcanleadtothedevelopmentoftype2diabetes.Insummary,theseﬁndingshighlightthepresenceofcomplexinterplaysbetweenmetabolicprocesses,anthropometricfactorsandclinicalmarkers,whichcanhavediﬀerentimpactsontheriskofdiabetesandothercardiovasculardiseasesacrossethnicitiesandacrosstime.5DiscussionandConclusionThispaperextendsnodewiseregressiontechniquetoinferdynamicevolvingmultiplegraphs.Themodelallowsustoanalysemultiplegroupsofdiﬀerentsamplesizesobservedatmultipletimepoints,borrowinginformationacrosstimeandgroups.Weimposeregularisationontheregressioncoeﬃcientsandthemodelallowsfortheinclusionofpriorinformationaboutspeciﬁcconnectionsbetweenpairsofnodes,whenpriorknowledgeisavailable.ThestructureofnodewiseregressionensuresgoodscalabilityoftheMCMCalgorithmthankstothepossibilitytoinfereachregressionindependently.TheHorseshoeprioreﬀectivelyshrinkssmallandnegligiblecoeﬃcientstozero(inducingsparsityinthegraph),whileleavingimportantcoeﬃcientsunaﬀectedduetoitsheavytails,henceperforming(groupandtimespeciﬁc)variableselection.WeillustratetheperformanceoftheproposedmodelinasimulationstudyandcompareitwithanalternativeBayesianmodelforgraphestimationaswellasafrequentistmethod.Theresults21highlighttheabilityofthemodeltorecoverthetrueunderlyingstructureofthegraphsandtoaccuratelyestimatethecorrespondingprecisionmatrices.Inmostscenarios,theproposedmethodsoutperformsthecompetitors,stillmaintainingacomputationaladvantage.Finally,weemploytheproposeddynamicmodeltoanalysemetabolicdatafromtheSABREcohortstudy,aninformationrichdatasetoncardiovascularandmetabolicdiseases.OurclinicalinterestfocusesondiﬀerentpatternsofmetaboliteassociationswhichcharacterisetheEuropeanandSouth-Asianethnicitiesandtheirevolutionovertime,fromthebaselinevisittofollow-up.Ourapproachenablesustodetectaninterpretablesetofuniqueassociationpatternswhichcanaidmechanisticunderstandingofbetween-groupandbetween-timesdiﬀerencesinthedevelopmentofinsulinresistance,diabetesandcardiovasculardiseasesandhasthepotentialtohelpgeneratingnewscientiﬁchypotheses.Indoingthis,wecorrectforpotentialconfoundersandclinicaleventsthatcouldaﬀectmetaboliteslevels.SupplementalMaterialTheSupplementalMaterialﬁle,supplementarydata.pdf,isavailableontheJournalwebsite.Acknowledgement(s)Wearegratefultoallthepeoplewhotookpartinthestudy,andpastandpresentmembersoftheSABREteamwhohelpedtocollectthedata.FundingAlunHughesandNishiChaturvedireceivesupportfromtheNationalInstituteforHealthResearchUniversityCollegeLondonHospitalsBiomedicalResearchCentre,andworkinaunitthatreceivessupportfromtheUKMedicalResearchCouncil(ProgrammeCodeMCUU12019/1).TheSABREstudywasfundedatbaselinebytheMedicalResearchCouncil,DiabetesUK,andtheBritishHeartFoundation.Atfollow-upthestudywasfundedbytheWellcomeTrust(067100,37055891)&(086676/7/08/Z),theBritishHeartFoundation(PG/06/145,PG/08/103/26133,PG/12/29/29497andCS/13/1/30327)andDiabetesUK(13/0004774).TheSABREstudyteamalsoacknowledgesthesupportoftheNationalInstituteofHealthResearchClinicalResearchNetwork(NIHRCRN).ThisworkwassupportedbytheSingaporeMinistryofEducationAcademicResearchFundTier2underGrantMOE2019-T2-2-100.22References[1]A.Abbruzzo,C.DiSerio,andE.Wit,DynamicGaussiangraphicalmodelsformodellinggenomicnetworks,inInternationalMeetingonComputationalIntelligenceMethodsforBioinformaticsandBio-statistics.Springer,2013,pp.3–12.[2]A.Armagan,D.B.Dunson,andJ.Lee,Generalizeddoubleparetoshrinkage,StatisticaSinica23(2013),p.119.[3]D.ArnoldandP.Kwiterovich,Cholesterol—absorption,function,andmetabolism,inEncyclopediaofFoodSciencesandNutrition(SecondEdition),B.Caballero,ed.,secondeditioned.,AcademicPress,Oxford,2003,pp.1226–1237.Availableathttps://www.sciencedirect.com/science/article/pii/B012227055X00225X.[4]O.Barndorﬀ-Nielsen,J.Kent,andM.Sørensen,Normalvariance-meanmixturesandzdistributions,InternationalStatisticalReview/RevueInternationaledeStatistique(1982),pp.145–159.[5]A.R.BentleyandC.N.Rotimi,Interethnicdiﬀerencesinserumlipidsandimplicationsforcar-diometabolicdiseaseriskinafricanancestrypopulations,Globalheart12(2017),pp.141–150.[6]A.Bhadra,J.Datta,N.G.Polson,B.Willard,etal.,Thehorseshoe+estimatorofultra-sparsesignals,BayesianAnalysis12(2017),pp.1105–1131.[7]A.Bhattacharya,A.Chakraborty,andB.K.Mallick,Fastsamplingwithgaussianscalemixturepriorsinhigh-dimensionalregression,Biometrika(2016),p.asw042.[8]A.E.Bilgrau,C.F.Peeters,P.S.Eriksen,M.Bøgsted,andW.N.vanWieringen,Targetedfusedridgeestimationofinversecovariancematricesfrommultiplehigh-dimensionaldataclasses.,JournalofMa-chineLearningResearch21(2020),pp.1–52.[9]S.Brooks,A.Gelman,G.Jones,andX.L.Meng,Handbookofmarkovchainmontecarlo,CRCpress,2011.[10]M.Carey,Smalldm,blisscm.lipiddigestionandabsorption,AnnuRevPhysiol45(1983),pp.651–77.[11]B.Carpenter,A.Gelman,M.Hoﬀman,D.Lee,B.Goodrich,M.Betancourt,M.Brubaker,J.Guo,P.Li,andA.Riddell,Stan:Aprobabilisticprogramminglanguage,JournalofStatisticalSoftware,Articles76(2017),pp.1–32.Availableathttps://www.jstatsoft.org/v076/i01.[12]C.M.Carvalho,N.G.Polson,andJ.G.Scott,Thehorseshoeestimatorforsparsesignals,Biometrika97(2010),pp.465–480.[13]P.C.Choy,Y.L.Siow,D.Mymin,andK.O,Lipidsandatherosclerosis,Biochemistryandcellbiology82(2004),pp.212–224.[14]H.Chun,X.Zhang,andH.Zhao,Generegulationnetworkinferencewithjointsparsegaussiangraphicalmodels,JournalofComputationalandGraphicalStatistics24(2015),pp.954–974.[15]P.Danaher,P.Wang,andD.M.Witten,Thejointgraphicallassoforinversecovarianceestimationacrossmultipleclasses,JournaloftheRoyalStatisticalSociety.SeriesB,Statisticalmethodology76(2014),p.373.[16]A.DelaFuente,From‘diﬀerentialexpression’to‘diﬀerentialnetworking’–identiﬁcationofdysfunctionalregulatorynetworksindiseases,Trendsingenetics26(2010),pp.326–333.[17]A.P.Dempster,Covarianceselection,Biometrics(1972),pp.157–175.23[18]R.G.Elkin,Cholesterolinchickeneggs:Stilladietaryconcernforsome,inEggInnovationsandStrategiesforImprovements,Elsevier,2017,pp.189–198.[19]S.Ellul,M.Wake,S.A.Cliﬀord,K.Lange,P.W¨urtz,M.Juonala,T.Dwyer,J.B.Carlin,D.P.Burgner,andR.Saﬀery,Metabolomics:populationepidemiologyandconcordanceinaustralianchildrenaged11–12yearsandtheirparents,BMJopen9(2019).[20]B.Enkhmaa,E.Anuurad,andL.Berglund,Lipoprotein(a):impactbyethnicityandenvironmentalandmedicalconditions,Journaloflipidresearch57(2016),pp.1111–1125.[21]S.Epskamp,L.J.Waldorp,R.M˜ottus,andD.Borsboom,Thegaussiangraphicalmodelincross-sectionalandtime-seriesdata,MultivariateBehavioralResearch53(2018),pp.453–480.[22]N.I.Forbang,M.H.Criqui,M.A.Allison,J.H.Ix,B.T.Steﬀen,M.Cushman,andM.Y.Tsai,Sexandethnicdiﬀerencesintheassociationsbetweenlipoprotein(a)andperipheralarterialdiseaseinthemulti-ethnicstudyofatherosclerosis,Journalofvascularsurgery63(2016),pp.453–458.[23]A.T.Frank,B.Zhao,P.O.Jose,K.M.Azar,S.P.Fortmann,andL.P.Palaniappan,Racial/ethnicdiﬀerencesindyslipidemiapatterns,Circulation129(2014),pp.570–579.[24]J.Friedman,T.Hastie,andR.Tibshirani,Sparseinversecovarianceestimationwiththegraphicallasso,Biostatistics9(2008),pp.432–441.[25]A.Gelman,etal.,Priordistributionsforvarianceparametersinhierarchicalmodels(commentonarticlebybrowneanddraper),Bayesiananalysis1(2006),pp.515–534.[26]E.GeorgeandR.McCulloch,VariableselectionviaGibbssampling,JournaloftheAmericanStatisticalAssociation88(1993),pp.881–889.[27]J.L.GoldsteinandM.S.Brown,Acenturyofcholesterolandcoronaries:fromplaquestogenestostatins,Cell161(2015),pp.161–172.[28]K.Greenewald,S.Park,S.Zhou,andA.Giessing,Time-dependentspatiallyvaryinggraphicalmodels,withapplicationtobrainfMRIdataanalysis,inAdvancesinNeuralInformationProcessingSystems.2017,pp.5832–5840.[29]M.Guasch-Ferr´e,A.Hruby,E.Toledo,C.B.Clish,M.A.Mart´ınez-Gonz´alez,J.Salas-Salvad´o,andF.B.Hu,Metabolomicsinprediabetesanddiabetes:asystematicreviewandmeta-analysis,Diabetescare39(2016),pp.833–846.[30]J.Guo,E.Levina,G.Michailidis,andJ.Zhu,Jointestimationofmultiplegraphicalmodels,Biometrika98(2011),pp.1–15.[31]P.L.HarringtonJrandA.O.HeroIII,Spatio-temporalgraphicalmodelselection,arXivpreprintarXiv:1004.2304(2010).[32]N.J.Higham,Computingthenearestcorrelationmatrix—aproblemfromﬁnance,IMAjournalofNu-mericalAnalysis22(2002),pp.329–343.[33]F.HuangandS.Chen,Learningdynamicconditionalgaussiangraphicalmodels,IEEETransactionsonKnowledgeandDataEngineering30(2017),pp.703–716.[34]D.Y.Hui,Intestinalphospholipidandlysophospholipidmetabolismincardiometabolicdisease,Currentopinioninlipidology27(2016),p.507.[35]J.IqbalandM.M.Hussain,Intestinallipidabsorption,AmericanJournalofPhysiology-EndocrinologyandMetabolism296(2009),pp.E1183–E1194.24[36]J.Jankov´aandS.vandeGeer,Inferenceinhigh-dimensionalgraphicalmodels,arXivpreprintarXiv:1801.08512(2018).[37]J.Johndrow,P.Orenstein,andA.Bhattacharya,Scalableapproximatemcmcalgorithmsforthehorse-shoeprior,JournalofMachineLearningResearch21(2020).[38]A.Kamburov,R.Cavill,T.M.Ebbels,R.Herwig,andH.C.Keun,Integratedpathway-levelanalysisoftranscriptomicsandmetabolomicsdatawithimpala,Bioinformatics27(2011),pp.2917–2918.[39]M.KanehisaandS.Goto,Kegg:kyotoencyclopediaofgenesandgenomes,Nucleicacidsresearch28(2000),pp.27–30.[40]G.KastnerandS.Fr¨uhwirth-Schnatter,Ancillarity-suﬃciencyinterweavingstrategy(asis)forboostingmcmcestimationofstochasticvolatilitymodels,ComputationalStatistics&DataAnalysis76(2014),pp.408–423.[41]D.R.Kowal,D.S.Matteson,andD.Ruppert,Dynamicshrinkageprocesses,arXivpreprintarXiv:1707.00763(2017).[42]S.Lauritzen,GraphicalModels,OxfordStatisticalScienceSeries,ClarendonPress,1996,Availableathttps://books.google.co.uk/books?id=mGQWkx4guhAC.[43]A.LenkoskiandA.Dobra,Computationalaspectsrelatedtoinferenceingaussiangraphicalmodelswiththeg-wishartprior,JournalofComputationalandGraphicalStatistics20(2011),pp.140–157.[44]F.Leone,L.Nelson,andR.Nottingham,Thefoldednormaldistribution,Technometrics3(1961),pp.543–550.[45]Z.Lin,T.Wang,C.Yang,andH.Zhao,Onjointestimationofgaussiangraphicalmodelsforspatialandtemporaldata,Biometrics73(2017),pp.769–779.[46]M.F.Linton,P.G.Yancey,S.S.Davies,W.G.Jerome,E.F.Linton,W.L.Song,A.C.Doran,andK.C.Vickers,Theroleoflipidsandlipoproteinsinatherosclerosis,Endotext[Internet](2019).[47]I.ManoliandC.Venditti,Disordersofbranchedchainaminoacidmetabolism,Translationalscienceofrarediseases1(2016),pp.91–110.[48]M.A.Maqbool,M.Aslam,W.Akbar,andZ.Iqbal,Biologicalimportanceofvitaminsforhumanhealth:Areview,J.Agric.BasicSci2(2017),pp.50–58.[49]D.R.Matthews,J.P.Hosker,A.S.Rudenski,B.A.Naylor,D.F.Treacher,andR.C.Turner,Homeosta-sismodelassessment:insulinresistanceandβ-cellfunctionfromfastingplasmaglucoseandinsulinconcentrationinman,Diabetologia28(1985),pp.412–419.[50]R.W.McGarrah,S.B.Crown,G.F.Zhang,S.H.Shah,andC.B.Newgard,Cardiovascularmetabolomics,Circulationresearch122(2018),pp.1238–1258.[51]N.Meinshausen,P.B¨uhlmann,etal.,High-dimensionalgraphsandvariableselectionwiththelasso,Theannalsofstatistics34(2006),pp.1436–1462.[52]A.Mohammadi,E.C.Wit,etal.,Bayesianstructurelearninginsparsegaussiangraphicalmodels,BayesianAnalysis10(2015),pp.109–138.[53]K.Mohan,P.London,M.Fazel,D.Witten,andS.I.Lee,Node-basedlearningofmultiplegaussiangraphicalmodels,TheJournalofMachineLearningResearch15(2014),pp.445–488.25[54]R.B.O’Hara,M.J.Sillanp¨a¨a,etal.,Areviewofbayesianvariableselectionmethods:what,howandwhich,Bayesiananalysis4(2009),pp.85–117.[55]Y.Omori,S.Chib,N.Shephard,andJ.Nakajima,Stochasticvolatilitywithleverage:Fastandeﬃcientlikelihoodinference,JournalofEconometrics140(2007),pp.425–449.[56]C.Peterson,F.C.Stingo,andM.Vannucci,Bayesianinferenceofmultiplegaussiangraphicalmodels,JournaloftheAmericanStatisticalAssociation110(2015),pp.159–174.[57]J.Piironen,A.Vehtari,etal.,Sparsityinformationandregularizationinthehorseshoeandothershrinkagepriors,ElectronicJournalofStatistics11(2017),pp.5018–5051.[58]N.G.Polson,J.G.Scott,andJ.Windle,Bayesianinferenceforlogisticmodelsusingp´olya–gammalatentvariables,JournaloftheAmericanstatisticalAssociation108(2013),pp.1339–1349.[59]D.J.Rader,J.Cohen,H.H.Hobbs,etal.,Monogenichypercholesterolemia:newinsightsinpathogenesisandtreatment,TheJournalofclinicalinvestigation111(2003),pp.1795–1803.[60]M.Ramırez,L.Amate,andA.Gil,Absorptionanddistributionofdietaryfattyacidsfromdiﬀerentsources,Earlyhumandevelopment65(2001),pp.S95–S101.[61]C.K.Roberts,A.L.Hevener,andR.J.Barnard,Metabolicsyndromeandinsulinresistance:underlyingcausesandmodiﬁcationbyexercisetraining,ComprehensivePhysiology3(2013),pp.1–58.[62]H.Rue,Fastsamplingofgaussianmarkovrandomﬁelds,JournaloftheRoyalStatisticalSociety:SeriesB(StatisticalMethodology)63(2001),pp.325–338.[63]T.SaegusaandA.Shojaie,Jointestimationofprecisionmatricesinheterogeneouspopulations,Elec-tronicjournalofstatistics10(2016),p.1341.[64]P.Soininen,A.J.Kangas,P.W¨urtz,T.Suna,andM.Ala-Korpela,Quantitativeserumnuclearmag-neticresonancemetabolomicsincardiovascularepidemiologyandgenetics,Circulation:CardiovascularGenetics8(2015),pp.192–206.[65]J.Soppert,M.Lehrke,N.Marx,J.Jankowski,andH.Noels,Lipoproteinsandlipidsincardiovasculardisease:frommechanisticinsightstotherapeutictargeting,Advanceddrugdeliveryreviews159(2020),pp.4–33.[66]K.SprostonandJ.Mindell,Healthsurveyforengland2004.thehealthofminorityethnicgroups(2006).[67]B.T.Steﬀen,G.Thanassoulis,D.Duprez,J.H.Stein,A.B.Karger,M.C.Tattersall,J.D.Kaufman,W.Guan,andM.Y.Tsai,Race-baseddiﬀerencesinlipoprotein(a)-associatedriskofcarotidatherosclerosis:Themulti-ethnicstudyofatherosclerosis,Arteriosclerosis,thrombosis,andvascularbiology39(2019),pp.523–529.[68]L.S.Tan,A.Jasra,M.DeIorio,T.M.Ebbels,etal.,Bayesianinferenceformultiplegaussiangraphicalmodelswithapplicationtometabolicassociationnetworks,TheAnnalsofAppliedStatistics11(2017),pp.2222–2251.[69]T.G.Taylor,etal.,Theimportanceofvitaminstohumanhealth,Springer,1979.[70]D.Telesca,P.M¨uller,G.Parmigiani,andR.S.Freedman,Modelingdependentgeneexpression,Annalsofstatistics6(2012),p.542.[71]T.Tillin,N.G.Forouhi,P.M.McKeigue,andN.Chaturvedi,Southallandbrentrevisited:Cohortproﬁleofsabre,aukpopulation-basedcomparisonofcardiovasculardiseaseanddiabetesinpeopleofeuropean,indianasianandafricancaribbeanorigins,Internationaljournalofepidemiology41(2012),pp.33–42.26[72]D.K.Tobias,P.R.Lawler,P.H.Harada,O.V.Demler,P.M.Ridker,J.E.Manson,S.Cheng,andS.Mora,Circulatingbranched-chainaminoacidsandincidentcardiovasculardiseaseinaprospectivecohortofuswomen,Circulation:GenomicandPrecisionMedicine11(2018),p.e002157.[73]J.K.Ujcic-Voortman,G.Bos,C.A.Baan,D.G.Uitenbroek,A.P.Verhoeﬀ,andJ.C.Seidell,Ethnicdiﬀerencesintotalandhdlcholesterolamongturkish,moroccananddutchethnicgroupslivinginams-terdam,thenetherlands,BMCPublicHealth10(2010),pp.1–8.[74]B.Valc´arcel,P.W¨urtz,N.K.S.alBasatena,T.Tukiainen,A.J.Kangas,P.Soininen,M.R.J¨arvelin,M.Ala-Korpela,T.M.Ebbels,andM.DeIorio,Adiﬀerentialnetworkapproachtoexploringdiﬀerencesbetweenbiologicalstates:anapplicationtoprediabetes,PLoSOne6(2011),p.e24702.[75]F.Visioli,M.A.Crawford,S.Cunnane,P.Rise,andC.Galli,Lipidtransport,dietaryfats,anden-dogenouslipidsynthesis:hypothesesonsaturationandcompetitionprocesses,Nutritionandhealth18(2006),pp.127–132.[76]F.VisioliandA.Poli,Fattyacidsandcardiovascularrisk.evidence,lackofevidence,anddiligence,Nutrients12(2020),p.3782.[77]H.Wang,etal.,Bayesiangraphicallassomodelsandeﬃcientposteriorcomputation,BayesianAnalysis7(2012),pp.867–886.[78]R.Warnick,M.Guindani,E.Erhardt,E.Allen,V.Calhoun,andM.Vannucci,Abayesianapproachforestimatingdynamicfunctionalnetworkconnectivityinfmridata,JournaloftheAmericanStatisticalAssociation113(2018),pp.134–151.[79]N.Wermuth,Analogiesbetweenmultiplicativemodelsincontingencytablesandcovarianceselection,Biometrics(1976),pp.95–108.[80]L.Zhang,Q.Qiao,J.Tuomilehto,E.D.Janus,T.H.Lam,A.Ramachandran,V.Mohan,C.D.Ste-houwer,Y.Dong,T.Nakagami,etal.,Distinctethnicdiﬀerencesinlipidproﬁlesacrossglucosecate-gories,TheJournalofClinicalEndocrinology&Metabolism95(2010),pp.1793–1801.27SupplementalMaterialto’BayesianDynamicNetworkModelling:anapplicationtometabolicassociationsincardiovasculardiseases’MarcoMolinari1,AndreaCremaschi2,MariaDeIorio1,2,3,NishiChaturvedi4,AlunHughes4,andThereseTillin41DepartmentofStatisticalScience,UniversityCollegeLondon,UK2SingaporeInstituteforClinicalSciences,A*STAR,Singapore3YongLooLinSchoolofMedicine,NationalUniversityofSingapore,Singapore4DepartmentofPopulationScienceandExperimentalMedicine,UniversityCollegeLondon,UKJuly28,2022Abstract:Thisdocumentcontainsadditionalinformationrelativetothemanuscript’BayesianDynamicNetworkModelling:anapplicationtometabolicassociationsincardiovasculardiseases’anditisorganisedasfollows.Section1containsthedetailsoftheMCMCalgorithmneededtoperformposteriorinference.WeprovideboththeStancodeandtheGibbssamplingscheme.Section2showsadditionalﬁguresandtablesreferencedinthemaintext.Keywords:DynamicShrinkagePriors;GibbsSampling;GraphicalModels;Metabolomics;NodewiseRegression1arXiv:2207.13418v1  [stat.ME]  27 Jul 20221MCMCAlgorithmHereweprovidetheStancodeandthedetailsoftheGibbssamplingalgorithmtoperformposteriorinferenceofthemultiplegroupsdynamicnodewiseregressionmodel.Stancodedata{int<lower=1>NT;//Timepointsint<lower=1>n_t[NT];//Numberofobservationsforeachtimepointint<lower=1>Ngr;//Numberofgroupsint<lower=1>n_groups[Ngr*NT];//Dimensionofthegroupsforeachtimeint<lower=1>m;//Numberofregressorsint<lower=1,upper=Ngr>G_t[sum(n_groups)];//Vectorwithgroupsmembershipvector[sum(n_t)]y_t;//Responsevariablerow_vector[m]X_t[sum(n_t)];//Inputmatrix(=Y_-j)//---------------real<lower=0>scale_global_tau_0[Ngr];//priorscalefortheglobalshrinkageparameterTaureal<lower=1>df_global_0;//degreesoffreedomforTaureal<lower=1>df_global_j;real<lower=1>df_local_t;//degreesoffreedomforLambdasmatrix<lower=0>[m,Ngr]devs_X_t[NT];//DeviancesofX(diagofXtX)//------ParamsfortheregularisationoftheHorseshoereal<lower=0>slab_scale_c_t;//Slabofstudent-treal<lower=0>slab_df_c_t;//dfofstudent-t//ParametersBetaonPhi_jreal<lower=0>phi_ab[2];real<lower=0>sigma_prior;}transformeddata{intn_cumsum_gr[Ngr*NT];//Vectorofcumulativesumofobservationsingroupspertimeintpos;pos=1;for(ttin1:NT){for(grin1:Ngr){if(pos==1)n_cumsum_gr[pos]=1;if(pos>1)n_cumsum_gr[pos]=n_cumsum_gr[pos-1]+n_groups[pos-1];pos+=1;}}}parameters{vector<lower=0>[Ngr*NT]sigma_t;//Timevaryingnoisestd//ParametersTvector[m*Ngr]z_t[NT];//InnovationsforBeta_t//Tau_jvector<lower=0>[m*Ngr]aux1_global_j;vector<lower=0>[m*Ngr]aux2_global_j;//Tau_0real<lower=0>aux1_global_0;real<lower=0>aux2_global_0;//LocalLambda_jtvector<lower=0>[m*Ngr]aux1_local_t[NT];vector<lower=0>[m*Ngr]aux2_local_t[NT];2vector<lower=0>[Ngr]aux_c_t[NT];//AutoregressiveParameterphi_jforthedynamicHSvector<lower=0,upper=1>[m*Ngr]phi_j_pos;}transformedparameters{vector<lower=-1,upper=1>[m*Ngr]phi_j;//Tau_jvector<lower=0>[m]tau_j[Ngr];//Tau_0real<lower=0>tau_0[Ngr];//LocalLambda_j,tvector<lower=0>[m]lambda_t[NT*Ngr];vector<lower=0>[m]lambda_tilde_t[NT*Ngr];//truncatedlocalshrinkageparametervector<lower=0>[Ngr]c_t[NT];//cforregHS//log_scalevarianceh_j,tvector[m]log_h[NT*Ngr];vector<lower=0>[m]exp_h[NT*Ngr];//Beta_tvector[m]beta_t[NT*Ngr];vector[sum(n_t)]f_t;vector<lower=0>[sum(n_t)]sigma_long;//Tostorethesigmaforeachobs//<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>//<<<<<<<<<<<<<<<Nowoperations>>>>>>>>>>>>>>//<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>//Adjustphi_jphi_j=(phi_j_pos*2)-1;//InTime==1c_t[1]=slab_scale_c_t*sqrt(aux_c_t[1]);for(grin1:Ngr){//GlobalShrinkageparameterstau_j[gr]=aux1_global_j[((gr-1)*m+1):((gr-1)*m+m)].*sqrt(aux2_global_j[((gr-1)*m+1):((gr-1)*m+m)]);tau_0[gr]=aux1_global_0*sqrt(aux2_global_0)*scale_global_tau_0[gr]*sigma_t[gr];//tau_j[gr]=aux1_global_j.*sqrt(aux2_global_j[((gr-1)*m+1):((gr-1)*m+m)]);lambda_t[gr]=aux1_local_t[1][((gr-1)*m+1):((gr-1)*m+m)].*sqrt(aux2_local_t[1][((gr-1)*m+1):((gr-1)*m+m)]);lambda_tilde_t[gr]=sqrt((c_t[1][gr]^2*square(lambda_t[gr]))./(c_t[1][gr]^2+square(tau_j[gr]).*square(lambda_t[gr])));//Beginthecreationoglog-volatilityhlog_h[gr]=2*log(lambda_tilde_t[gr])+2*(log(tau_j[gr])+log(tau_0[gr]));exp_h[gr]=exp(0.5*log_h[gr]);}//Fortime>1for(ttin2:NT){c_t[tt]=slab_scale_c_t*sqrt(aux_c_t[tt]);for(grin1:Ngr){lambda_t[(tt-1)*Ngr+gr]=aux1_local_t[tt][((gr-1)*m+1):((gr-1)*m+m)].*sqrt(aux2_local_t[tt][((gr-1)*m+1):((gr-1)*m+m)]);lambda_tilde_t[(tt-1)*Ngr+gr]=sqrt((c_t[tt][gr]^2*square(lambda_t[(tt-1)*Ngr+gr]))./(c_t[tt][gr]^2+square(tau_j[gr]).*square(lambda_t[(tt-1)*Ngr+gr])));for(jjin1:m){log_h[(tt-1)*Ngr+gr][jj]=2*log(lambda_tilde_t[(tt-1)*Ngr+gr][jj])+2*(log(tau_j[gr][jj])+log(tau_0[gr]))+phi_j[(gr-1)*m+jj]*(log_h[(tt-2)*Ngr+gr][jj]-32*(log(tau_j[gr][jj])+log(tau_0[gr])));exp_h[(tt-1)*Ngr+gr][jj]=exp(0.5*log_h[(tt-1)*Ngr+gr][jj]);}}//gr}//tt//Beta_tfor(grin1:Ngr){beta_t[gr]=z_t[1][((gr-1)*m+1):((gr-1)*m+m)].*exp_h[gr];}for(ttin2:NT){for(grin1:Ngr){beta_t[(tt-1)*Ngr+gr]=beta_t[(tt-2)*Ngr+gr]+z_t[tt][((gr-1)*m+1):((gr-1)*m+m)].*exp_h[(tt-1)*Ngr+gr];}}//Meanfunction{intii_ind;ii_ind=1;for(ttin1:NT){for(grin1:Ngr){for(iiin1:n_groups[(tt-1)*Ngr+gr]){sigma_long[ii_ind]=sigma_t[(tt-1)*Ngr+gr];f_t[ii_ind]=X_t[ii_ind]*beta_t[(tt-1)*Ngr+gr];ii_ind+=1;}}}}}model{//Hereweuseauxiliaryvariablesfortauandlambda//Localssharedacrossgroupssigma_t~inv_gamma(0.5,0.5);phi_j_pos~beta(phi_ab[1],phi_ab[2]);//Oneglobaltauforeachgroupaux1_global_0~std_normal();aux2_global_0~inv_gamma(0.5*df_global_0,0.5*df_global_0);aux1_global_j~std_normal();aux2_global_j~inv_gamma(0.5*df_global_j,0.5*df_global_j);for(ttin1:NT){aux2_local_t[tt]~inv_gamma(0.5*df_local_t,0.5*df_local_t);aux1_local_t[tt]~std_normal();aux_c_t[tt]~inv_gamma(0.5*slab_df_c_t,0.5*slab_df_c_t);z_t[tt]~std_normal();}//Likelihoody_t~normal(f_t,sigma_long);}generatedquantities{//Vectorofk_j,thepseudoinclusionprobabilityvector[m]k_j_t[NT*Ngr];//VectortoholdprecisionOmegaelementsforthecurrentequationvector[m]omega_vec_t[NT*Ngr];//ElementsofOmegafor(ttin1:NT){4for(grin1:Ngr){for(jjin1:m){k_j_t[(tt-1)*Ngr+gr][jj]=1/(1+1/square(sigma_t[gr])*(exp_h[(tt-1)*Ngr+gr][jj]*exp_h[(tt-1)*Ngr+gr][jj])*devs_X_t[tt][jj,gr]);omega_vec_t[(tt-1)*Ngr+gr][jj]=(-beta_t[(tt-1)*Ngr+gr][jj])/square(sigma_t[gr]);}}}}GibbssamplingalgorithmHereweprovidedetailsoftheGibbssampling.Ourstartingpointisthealgorithmdescribedin[?]andweextendittoallowformultiplegroupsofdiﬀerentsamplesizes.Thesamplerconsistsoftwomaincomponents:astochasticvolatilitysamplingalgorithm[?]augmentedwithaPolya-Gammasampler[?],andaCholeskyFactorAlgorithm[?]tosampletheregressioncoeﬃcientsinthedynamiclinearmodel.Weprovidedetailsoftheupdatestepsthatdiﬀerfromtheoriginalpaper,fortheothersreferto[?].•Resamplingthelog-varianceshjrtgiventherest.[?]proposeamethodtosampledirectlyfromthefull-conditionaldistributionofhjr=(hjr1,...,hjrT),onthelog-scale,wheretheensuinglog-chi-squaredistributionofthelikelihoodlog(γ2jrt),fromlog(cid:0)(βjrt−βjrt−1)2(cid:1)=log(γ2jrt)+hjrtisapproximatedviaaknownnormalmixtureapproximationof10components.Tosamplethenewlog-variancesweusetheall-without-a-loop(AWOL)samplerof[?],whichallowstosamplehjrjointlywithouttheneedofasequentialalgorithm.Conditionalonalltheotherparametersthelog-variancesareindependentacrossgroups.Resamplingproceedsasin[?].•Resamplingthemixturecomponentsindicatorsjrtgiventherest.Thediscretemixtureprob-abilitiesarestraightforwardtoupdate.Thepriormixtureprobabilitiesarethepre-speciﬁedmixingproportionsgivenby[?]andthelikelihoodislog(γ2jrt+c)∼N(hjrt+msjrt,vsjrt),wherecisasmalloﬀsettoavoidnumericalunderﬂowsandmandvarethepre-speciﬁedmeanandvariance,respectively,ofthe10mixturecomponents.Resamplingproceedsasin[?],independentlyforeachgroup.•Resamplingthemeanparametersµjrgiventherest.Theupdateofµjrisdoneindepen-dentlyforeachgroup.Wecanre-writethelog-varianceequationin(8)asanordinarylinearregression,wheretheparametersµjrplaytheroleofregressioncoeﬃcients,asfollows:hjrt=µjr+φjr(hjrt−1−µjr)+ηjrt˜hjrt=µjr(1−φjr)+ηjrtwhere˜hjrt=hjrt−φjrhjrt−1and˜hjrt∼N(cid:16)µjr(1−φjr),ξ−1ηjrt(cid:17).Finally,wecanwrite˜˜hjrt∼N(µjrzjrt,1)5wherezjrt=(1−φjr)pξηjrtaretheregressioncovariates,µjraretheregressioncoeﬃcientand˜˜hjrt=˜hjrtpξηjrt,fort=2,···,T,aretheresponsevariables.TheposteriorfollowsfromthestandardupdateofaNormalpriorwithNormallikelihood.Forj=1,...,pandr=1,...,Rwesamplefromµjr|rest∼N(lµ/qµ,1/qµ)qµ=ξµjr+ξηjr1+TXt=2z2jrtlµ=ξµjrµ0+hjr1ξηjr1+TXt=2˜˜hjrtzjrt•Resamplingthemeanparameterµ0giventherest.Theposteriordistributionofµ0followsfromthestandardupdateofaNormalpriorandNormallikelihoodrepresentedbyµjr.Wesamplefromµ0|rest∼N(l0/q0,1/q0)q0=ξµ0+RXr=1pXj=1ξµjrl0=RXr=1pXj=1ξµjrµjr•Resamplingtheautoregressivecoeﬃcientsφjrgiventherest.Thenewvalueofφjrisdrawnviaslicesampler,independentlyforeachgroup.Theparametrisation(φjr+1)/2∼Beta(aφ,bφ)impliesthat|φjr|<1,whichensuresastationarystochasticprocessforhjr.Resamplingisperformedasin[?].•ResamplingthePolya-Gammamixingparametersξηjrt,ξµjrandξµ0giventherest.ThisstepisaconjugateupdateofaPolya-GammapriorgivenaGaussianlikelihood[?].ξηjrt|rest∼Polya-Gamma(1,ηjrt),∀j,r,tξµjr|rest∼Polya-Gamma(1,µjr−µ0r),∀j,rξµ0|rest∼Polya-Gamma(1,µ0)•Resamplingtheregressioncoeﬃcientsβrtgiventherest.Conditionalontherest,there-gressioncoeﬃcientsofeachgroupareindependent.Weperformajointupdateofβ=(βT1,...,βTt,...,βTT),whereβt=(β1t,...,βpt),exploitingtheblock-diagonalstructureoftheposteriorprecisionmatrixofβ.Theposteriordistributionis(omittingthegroupsub-scriptforeaseofnotation)β|rest∼N(cid:16)Q−1βmβ,Q−1β(cid:17)Qβ=Aσ+Ah6SettingHMCGibbsT=3M=200.260.28M=501.181.11M=1002.364.00T=10M=201.680.34M=509.751.60M=10075.107.27Table1:Computationaltimes(secondsperiteration)fortheHMCalgorithmasimplementedinStanandtheblockedGibbssamplingMCMCschemeasimplementedinR.SimulationsarerunfordiﬀerentvaluesofthenumberMofnodesandnumberToftimepoints,withN=100andR=2.ComputationaltimesarerecordedonaLinuxmachinewithIntelCorei71.8GHZ.whereAσisaTp×Tpblock-diagonalmatrixdeﬁnedasfollows:Aσ=XT1X1/σ210······0...............0···XTtXt/σ2t···0...............00······XTTXT/σ2TandAhisaTp×Tpmatrixdeﬁnedasfollows:Ah=(cid:0)DT⊗Ip(cid:1)Σ−1h(D⊗Ip)where⊗denotestheKroneckerproduct,DisaT×Ttri-diagonalmatrixwithdiagonalentriesequalto1andﬁrstoﬀ-diagonalelementsequalto−1,Ipisthep×pidentitymatrixandΣ−1hisaTp×Tpdiagonalmatrixwithdiagonalentriesequalto(exp(h11/2),...,exp(hp1/2),...,exp(h1T/2),...,exp(hpT/2))TheposteriormeanmβisaTp-dimensionalvectordeﬁnedas:mβ=(cid:0)XT1y1/σ21,...,XTtyt/σ2t,...,XTTyT/σ2T(cid:1)•Resamplingtheobservationerrorvariancesσ2rtgiventherest.ThisstepisaconjugateupdateofanInverse-GammapriorgivenaGaussianlikelihood.Foreachgrouprandtimetwesample:σ2rt|rest∼Inverse-Gamma(cid:18)aσ+nrt2,bσ+Pnrti=1(yirt−xirtβrt)22(cid:19)72AdditionalFiguresandTables8l0.060.080.100.120.140.160.18Mean Absolute Errorl0.060.080.100.120.140.160.18g1g2g3Multiple−Groups HS ModelBDgraph Model0.750.800.850.900.951.00ROC AUCl0.750.800.850.900.951.00g1g2g3Multiple−Groups HS ModelBDgraph ModelFigure1:Firstsimulationscenario.MeanAbsoluteError(leftpanel)andAUC(rightpanel)forthecomparisonbetweenthemultiplegroupsnodewiseregressionmodelin(7)andthepackageBDgraph.TheboxplotsoftheMAEandAUCareobtainedovertwentyreplicatesforeachmodelandbyadoptingtheANDrule.TheMAEandtheAUCarecomparedwithineachofthethreegroupsG1,G2andG3.ThenodewisemodelworksbetterbothintermsofMAE,indicatingamorepreciseestimationofΩ,andintermsofAUC,denotingabetterrecoveryofthegraphstructurewithineachgroup.0.000.050.100.150.200.250.30FPRll0.000.050.100.150.200.250.30g1g2g3Multiple−Groups HS ModelBDgraph Modell0.00.20.40.60.8FNR0.00.20.40.60.8g1g2g3Multiple−Groups HS ModelBDgraph ModelFigure2:Firstsimulationscenario.Falsepositiverates(FPR,leftpanel)andfalsenegativerates(FNR,rightpanel)forthecomparisonbetweenthemultiplegroupsnodewiseregressionmodelin(7)andthepackageBDgraph.TheboxplotsoftheFPRandFNRareobtainedovertwentyreplicatesforeachmodelandbyadoptingtheANDrule.TheFPRandtheFNRarecomparedwithineachofthethreegroupsG1,G2andG3.TheFPRandtheFNRarecomparableinbothmodels,andinparticularequaltozeroforgroupsG2andG3.9Table2:Metabolitesextendednames.Eachlipoproteinisdividedintotriglycerides,cholesterylesters,freecholesterolandphospholipids.AbbreviationFullnameDiﬀerentiallyexpressedacaceAcetoacetateaceAcetatealaAlaninealbAlbuminapoa1ApolipoproteinA-IapobApolipoproteinB3bohbut3-hydroxybutyrateceCholesterylEsters3citCitratecreaCreatininedha22:6,docosahexaenoicacidfaw3Omega-3fattyacidsfaw6Omega-6fattyacids3fcFreeCholesterol3glcGlucose3glnGlutamine3glolGlycerolglyGlycinegpGlycoproteinacetyls,mainlya1-acidglycoprotein3hisHistidineileIsoleucinela18:2,linoleicacid3lacLactate3leuLeucinemufaMonounsaturatedfattyacids;16:1,18:13pcPhosphatidylcholinesandothercholinesphePhenylalanineplPhospholipids3pufaPolyunsaturatedfattyacidspyrPyruvatesfaSaturatedfattyacidssmSphingomyelins3tgTriglycerides3tyrTyrosineunsatdegEstimateddegreeofunsaturationvalValinelipidsshdlLipidscompoundsinsmallHDLlipidsmhdlLipidscompoundsinmediumHDLlipidslhdlLipidscompoundsinlargeHDLlipidsxlhdlLipidscompoundsinextralargeHDLlipidssldlLipidscompoundsinsmallLDLlipidsmldlLipidscompoundsinmediumLDLlipidslldlLipidscompoundsinlargeLDLlipidsidlLipidscompoundsinIDLlipidsxsvldlLipidscompoundsinextrasmallVLDLlipidssvldlLipidscompoundsinsmallVLDLlipidsmvldlLipidscompoundsinmediumVLDLlipidslvldlLipidscompoundsinlargeVLDLlipidsxlvldlLipidscompoundsinextralargeVLDLlipidsxxlvldlLipidscompoundsinextraextralargeVLDL101234567891011121314151617181920S1_T11234567891011121314151617181920S2_T11234567891011121314151617181920S1_T21234567891011121314151617181920S2_T21234567891011121314151617181920S1_T31234567891011121314151617181920S2_T3Figure3:Networksgeneratedinthesecondsimulationscenarioandusedtosimulatethedatasetwithineachgroupandevolvingovertime.Table3:Anthropometriccovariates,diabetesindicator,CVDindicatorsandothercontrolvariables.Everyvariableisusedattime1(T1)andtime2(T2).VariablenameLabelAgeRespondent’sageWHRWaisttoHipRatioSystolicbloodpressureSystolicbloodpressureHomaIRHomeostasismodelassessmentInsulinResistanceSexfemaleDummyvariableforfemalesex(maleasreferencecategory)SmokeExIndicatorvariableforexsmokercategorySmokeCurrentIndicatorvariablecurrentsmokercategoryPtalcoholWeeklyquantityofalcoholconsumedPhysscorePhysicalactivityscoreEduyearsYearsofeducation(assumedconstantovertime)blhdlConcentrationofHDLbltrigConcentrationofbloodTriglyceridesblcholConcentrationofbloodCholesterolCHDIndicatorvariableforthepresenceofCoronaryHeartDiseaseuptoT1andT2strokeIndicatorvariableforthepresenceofstrokeuptoT1andT2DiabetesIndicatorvariableforthepresenceofDiabetesMellitus(type2)uptoT1andT2dmtreatIndicatorvariableforthepresenceofdrugtreatmentfordiabetesuptoT1andT2bptreatIndicatorvariableforthepresenceofbloodpressureloweringdrugstreatmentuptoT1andT2lipidstreatIndicatorvariableforthepresenceofbloodlipidsloweringdrugstreatmentuptoT1andT211l0.20.40.60.8MAE group 10.20.40.60.80.20.40.60.80.20.40.60.8ll0.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.8ll0.20.40.60.8ll0.20.40.60.8l0.20.40.60.80.20.40.60.8t1t2t30.20.40.60.8MAE group 2l0.20.40.60.80.20.40.60.80.20.40.60.8l0.20.40.60.8l0.20.40.60.8l0.20.40.60.8l0.20.40.60.8l0.20.40.60.8lll0.20.40.60.80.20.40.60.8l0.20.40.60.8t1t2t3Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSO0.650.750.850.95ROC AUC group 10.650.750.850.95ll0.650.750.850.95lll0.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95l0.650.750.850.950.650.750.850.950.650.750.850.95t1t2t3l0.650.750.850.95ROC AUC group 20.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.950.650.750.850.95t1t2t3Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOFigure4:Secondsimulationscenario.MeanAbsoluteError(toppanel)andAUC(bottompanel)comparisonbetweenthedynamicmodelin(9)(black),thestaticmodelin(7)(red),BDgraph(green)andGraphicalGroupLASSO(blue).TheboxplotsoftheMAEandAUCareobtainedovertwentyreplicatesforeachmodelandbyadoptingtheANDrule.EachrowintheFigurereferstoagroup,andtheMAEandtheAUCarecomparedateachtimepoint.TheMAEindicatesthattheproposedmodelperformswellintheestimationoftheprecisionmatrix.IntermsofAUCandgraphrecovery,thedynamicHSmodelyieldsbetterestimatesintwoofthetimepointsfortheﬁrstgroup,andinthesecondtimepointforthesecondgroup.Inthissimulationsettings,nomethodconsistentlyoutperformstheothers.120.150.250.35FPR group 10.150.250.350.150.250.35ll0.150.250.35l0.150.250.350.150.250.350.150.250.350.150.250.350.150.250.350.150.250.35l0.150.250.350.150.250.35t1t2t30.150.250.35FPR group 20.150.250.350.150.250.350.150.250.350.150.250.35l0.150.250.35lll0.150.250.350.150.250.350.150.250.350.150.250.350.150.250.350.150.250.35t1t2t3Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOl0.30.50.70.9FNR group 10.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.9l0.30.50.70.90.30.50.70.9ll0.30.50.70.90.30.50.70.90.30.50.70.9l0.30.50.70.9t1t2t30.30.50.70.9FNR group 20.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.90.30.50.70.9ll0.30.50.70.90.30.50.70.90.30.50.70.9t1t2t3Dynamic HS ModelStatic HS ModelBDgraphGraphical Group LASSOFigure5:Secondsimulationscenario.Falsepositiverates(FPR)andfalsenegativerates(FNR)forthedynamicmodelin(9)(black),thestaticmodelin(7)(red),BDgraph(green)andGraphicalGroupLASSO(blue).TheboxplotsareobtainedovertwentyreplicatesforeachmodelandbyadoptingtheANDrule.EachrowintheFigurereferstoagroup,andtheFPRandFNRarecomparedateachtimepoint.Theresultsobtainedwiththeproposeddynamicandstaticmodelsarecomparableatmostoftimepointsandinbothgroups.SimilarresultsareobservedfortheBDgraphmodel.GraphicalGroupLASSOpresentsdiﬀersthemostfromtheothermodels.1300.10.20.30.40.50.60.70.80.91acaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_placealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgFigure6:Posteriormeanofthepseudoinclusionprobabilityparametersκjl(seeEq.(5))fortheEuropeanethnicityatbaseline.Theedgesintheindividualnetworksareselectedwhentheposteriormeanof(1−κjl)isgreaterthan0.5.1400.10.20.30.40.50.60.70.80.91acaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_placealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgFigure7:Posteriormeanofthepseudoinclusionprobabilityparametersκjl(seeEq.(5))fortheEuropeanethnicityatfollow-up.Theedgesintheindividualnetworksareselectedwhentheposteriormeanof(1−κjl)isgreaterthan0.5.1500.10.20.30.40.50.60.70.80.91acaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_placealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgFigure8:Posteriormeanofthepseudoinclusionprobabilityparametersκjl(seeEq.(5))fortheSouth-Asianethnicityatbaseline.Theedgesintheindividualnetworksareselectedwhentheposteriormeanof(1−κjl)isgreaterthan0.5.1600.10.20.30.40.50.60.70.80.91acaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_placealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgFigure9:Posteriormeanofthepseudoinclusionprobabilityparametersκjl(seeEq.(5))fortheSouth-Asianethnicityatfollow-up.Theedgesintheindividualnetworksareselectedwhentheposteriormeanof(1−κjl)isgreaterthan0.5.17llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansllhigh betweennesslow betweennessFigure10:IndividualnetworkfortheEuropeanethnicityatbaselineobtainedapplyingtheANDrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.18llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansllhigh betweennesslow betweennessFigure11:IndividualnetworkfortheEuropeanethnicityatfollow-upobtainedapplyingtheANDrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.19llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgSouth−Asiansllhigh betweennesslow betweennessFigure12:IndividualnetworkfortheSouth-AsianethnicityatbaselineobtainedapplyingtheANDrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.20llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgSouth−Asiansllhigh betweennesslow betweennessFigure13:IndividualnetworkfortheSouth-Asianethnicityatfollow-upobtainedapplyingtheANDrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.21llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansllhigh betweennesslow betweennessFigure14:IndividualnetworkfortheEuropeanethnicityatbaselineobtainedapplyingtheORrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.22llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansllhigh betweennesslow betweennessFigure15:IndividualnetworkfortheEuropeanethnicityatfollow-upobtainedapplyingtheORrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.23llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgSouth−Asiansllhigh betweennesslow betweennessFigure16:IndividualnetworkfortheSouth-AsianethnicityatbaselineobtainedapplyingtheORrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.24llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgSouth−Asiansllhigh betweennesslow betweennessFigure17:IndividualnetworkfortheSouth-Asianethnicityatfollow-upobtainedapplyingtheORrule.Anedgebetweentwonodesisincludedinthegraphifitsposteriorprobabilityofinclusionishigherthan0.8.Thecoloursofthenodesrepresenthigh/lowlevelsofbetweenness,indicatingthedegreeofconnectivityofthenodeswithinthegraph.25llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgBaselineFollow−UpPositive par.corr.Negative par.corr.Time Differential Network for EuropeansFigure18:EuropeanDiﬀerentialnetworkbetweenbaselineandfollow-upobtainedwiththeORrule.Redlinescorrespondtoedgesonlypresentinthebaselinenetwork,whilebluelinestothoseonlypresentinthefollow-upnetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.26llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgBaselineFollow−UpPositive par.corr.Negative par.corr.Time Differential Network for South−AsiansFigure19:South-AsiansDiﬀerentialnetworkbetweenbaselineandthefollow-upobtainedwiththeORrule.Redlinescorrespondtoedgesonlypresentinthebaselinenetwork,whilebluelinestothoseonlypresentinthefollow-upnetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.27llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansSouth−AsiansPositive par.corr.Negative par.corr.Ethnicity Differential Network for the BaselineFigure20:DiﬀerentialnetworkbetweenEuropeansandSouth-AsiansatbaselineobtainedwiththeORrule.RedlinescorrespondtoedgesonlypresentintheEuropeannetwork,whilebluelinestothoseonlypresentintheSouth-Asiannetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.28llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllacaceacealaalbapoa1apobbohbutcitcreadhafaw3faw6glcglnglolglygphisidl_ceidl_fcidl_plidl_tgilelaclaleul_hdl_cel_hdl_fcl_hdl_pll_hdl_tgl_ldl_cel_ldl_fcl_ldl_pll_ldl_tgl_vldl_cel_vldl_fcl_vldl_pll_vldl_tgm_hdl_cem_hdl_fcm_hdl_plm_hdl_tgm_ldl_cem_ldl_fcm_ldl_plm_ldl_tgmufam_vldl_cem_vldl_fcm_vldl_plm_vldl_tgpcphepufapyrsfas_hdl_ces_hdl_fcs_hdl_pls_hdl_tgs_ldl_ces_ldl_fcs_ldl_pls_ldl_tgsms_vldl_ces_vldl_fcs_vldl_pls_vldl_tgtyrunsatdegvalxl_hdl_cexl_hdl_fcxl_hdl_plxl_hdl_tgxl_vldl_cexl_vldl_fcxl_vldl_plxl_vldl_tgxs_vldl_cexs_vldl_fcxs_vldl_plxs_vldl_tgxxl_vldl_cexxl_vldl_fcxxl_vldl_plxxl_vldl_tgEuropeansSouth−AsiansPositive par.corr.Negative par.corr.Ethnicity Differential Network for the Follow−UpFigure21:DiﬀerentialnetworkbetweenEuropeansandSouth-Asiansatfollow-upobtainedwiththeORrule.RedlinescorrespondtoedgesonlypresentintheEuropeannetwork,whilebluelinestothoseonlypresentintheSouth-Asiannetwork.Continuouslinesrepresentdiﬀerentialpositivepartialcorrelations,whiledashedlinesindicatenegativeones.29lllllllllllllllllll−2−1012Mean Betaagesex_femalesmoke_exsmoke_curryears_edutot_alcphys_scoreWHRsys_bphomaIRbl_cholbl_hdlbl_trigschdstrokediabdrug_diabdrug_lipdrug_bplllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFigure22:PosteriormeansofηljfortheEuropeansatbaseline.Eachdotrepresentsthemeanoftheposteriordistributionofacoeﬃcientηlj,l=1...,M.Reddotsdenotecoeﬃcientswhose95%credibleintervaldoesnotcontainthezero.lllllllllllllllllll−3−2−1012Mean Betaagesex_femalesmoke_exsmoke_curryears_edutot_alcphys_scoreWHRsys_bphomaIRbl_cholbl_hdlbl_trigschdstrokediabdrug_diabdrug_lipdrug_bplllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFigure23:PosteriormeansofηljfortheSouth-Asiansatbaseline.Eachdotrepresentsthemeanoftheposteriordistributionofacoeﬃcientηlj,l=1...,M.Reddotsdenotecoeﬃcientswhose95%credibleintervaldoesnotcontainthezero.30lllllllllllllllllll−2−1012Mean Betaagesex_femalesmoke_exsmoke_curryears_edutot_alcphys_scoreWHRsys_bphomaIRbl_cholbl_hdlbl_trigschdstrokediabdrug_diabdrug_lipdrug_bplllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFigure24:PosteriormeansofηljfortheEuropeansatfollow-up.Eachdotrepresentsthemeanoftheposteriordistributionofacoeﬃcientηlj,l=1...,M.Reddotsdenotecoeﬃcientswhose95%credibleintervaldoesnotcontainthezero.lllllllllllllllllll−1012Mean Betaagesex_femalesmoke_exsmoke_curryears_edutot_alcphys_scoreWHRsys_bphomaIRbl_cholbl_hdlbl_trigschdstrokediabdrug_diabdrug_lipdrug_bplllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFigure25:PosteriormeansofηljfortheSouth-Asiansatfollow-up.Eachdotrepresentsthemeanoftheposteriordistributionofacoeﬃcientηlj,l=1...,M.Reddotsdenotecoeﬃcientswhose95%credibleintervaldoesnotcontainthezero.31