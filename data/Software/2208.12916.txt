Stackelberg  game-based  optimal  scheduling  of  integrated  energy  systems  considering 
differences in heat demand across multi-functional areas   
Limeng Wang a, Ranran Yang b,*, Yang Qu a, Chengzhe Xu c 
a. Key Laboratory of Modern Power System Simulation and Control & Renewable Energy Technology, Ministry of Education（Northeast Electric Power University), Jilin 

132012, China； 

b. State Grid Nanyang Power Supply Company, Nanyang 473000, China 

c. State Grid Jilin Power Supply Company, Changchun 130000, China 

A R T I C L E    I N F O 

  A B S T R A C T 

Article history: 

  Demand-side management is very critical in China's energy systems because of its high 

fossil energy consumption and low system energy efficiency.  A building shape factor 

is introduced in describing the architectural characteristics of different functional areas, 

which  are  combined  with  the  characteristics  of  the  energy  consumed  by  users  to 

Keywords: 

investigate  the  features  of  heating  load  in  different  functional  areas.  A  Stackelberg 

Electro-thermal Integrated Energy 

game-based  optimal  scheduling  model  is  proposed  for  electro-thermal  integrated 

System; 

energy  systems,  which  seeks  to  maximize  the  revenue  of  integrated  energy  operator 

Stackelberg Game;   
Integrated Demand Response;   

(IEO) and  minimize the  cost of users. Here, IEO and users are the Stackelberg game 

leader  and  followers,  respectively.  The  leader  uses  real-time  energy  prices  to  guide 

Buildings' Thermal Inertia;   

loads to participate in demand response, while the followers make energy plans based 

PMV index; 
Thermal Network Characteristic 

on  price  feedback.  Using  the  Karush-Kuhn-Tucker  (KKT)  condition  and  the  big-M 

method, the model is transformed into a mixed-integer quadratic programming (MIQP) 

problem,  which  is  solved  by  using  MATLAB  and  CPLEX  software.  The  results 

demonstrate  that  the  proposal  manages  to  balance  the  interests  of  IEO  and  users. 

Furthermore,  the  heating  loads  of  public  and  residential  areas  can  be  managed 

separately  based  on  the  differences  in  energy  consumption  and  building  shape 

characteristics,  thereby  improving  the  system  operational  flexibility  and  promoting 

renewable energy consumption.   

1 Introduction 

the 

With 

crisis 

energy 

increasing 

and 
environmental pollution, how to build a modern energy 
system to ensure a safe, clean and sustainable energy 
supply has become a crucial issue [1]. In this context, 
vigorously developing and utilizing renewable energies 
has become an inevitable choice to achieve sustainable 
energy supply. With the increasing penetration rate of 
uncertain  renewable  energy,  the  secure  and  stable 
operation  of  the  system  is  faced  with  new  challenges 
[2]. Integrated energy systems may take full advantage 
of  the  benefits  of  multiple  complementary  energy 
sources  and  improve  the  utilization  of  renewable 
energy [3-5]. As a critical component of an integrated 
energy  system  (IES)  [6,7],  electro-thermal  integrated 

⁎ Corresponding author. 
E-mail address: stillwaterrundeep1@163.com. 

energy system can save expenditure on the energy bill 
via  multi-energy  complementarity  [8].  Deepening  the 
coupling between the  power and thermal systems  can 
achieve  the  effect  of  energy  cascade  utilization  and 
improve  the  comprehensive  utilization  efficiency, 
which  highlights  the  importance  of  collaborative 
research  on  the  optimal  operation  of  the  electric  and 
thermal  systems  [8].  An  electro-thermal  integrated 
energy system may dynamically select resources in two 
dimensions  of  time  and  location  to  meet  the  user's 
power load need and thermal comfort demand [10]. The 
reason  is  that  the  electrical  and  thermal  loads  reach 
their respective peaks at different times [11].   

 
 
 
 
 
                 
The average temperature of the skin 
surface (℃) 
The cost factor for charging and 
discharging 

  Minimum electricity/ thermal price 

($/mwh) 

  Maximum electricity/ thermal price 

($/mwh) 

  Average electricity and thermal price 

($/mwh) 

Variables 

PV power output in period t (MW) 

  WT power output in period t (MW) 
Time-shiftable electric load in period 
t (MW) 

  Cuttable heating load in period t in 
residential building areas (MW) 
Cuttable heating load in period t in 
the public building area (MW) 
Real-time electricity /thermal price in 
period t ($/MWh) 
Electric power of TP unit j in period t 
(MW) 
Electric power of CHP unit i in 
period t (MW) 

  Heat power of CHP unit i in period t 

(MW) 
Reserve capacities of unit i/j or the 
BESS in period t (MW) 

  Charge power of electric storage 

devices (MW) 

  Discharge power of electric storage 

devices (MW) 
Discharge power of heat storage 
devices (MW) 
Charge power of heat storage devices 
(MW) 

Nomenclature   

Acronyms 

Integrated demand response 
Combined heat and power 
Integrated energy system 
Integrated energy operator 

IDR   
CHP 
IES 
IEO 
DHN  District heating network 
KKT 
Karush-Kuhn-Tucker 
DHS 
District heating system 
Predicted mean vote 
PMV 
PDTP  Dynamic thermal performance 
BTI 
DR 
TP 

Thermal inertia of buildings 
Demand response 
Thermal power 

Sets and Parameters 

I 
J

U 

Node set of supply pipes   
Node set of return pipes 
The pipe sets of supply pipes 
The pipe sets of return pipes 
The set of CHP unit   
The set of thermal power unit 
The set of CHP unit, thermal power 
unit, BESS 
The heat energy obtained from heat 
source(MW) 
The mass flow of pipe k at time t 
(

) 

Specific heat capacity of hot water 
medium [

] 

The temperature of water supply 
pipelines (℃) 
The temperature of water return 
pipelines (℃) 
The heat energy of the k-th pipe at 
time t (MW) 
The flow velocity of the k-th pipe at 
time t 
The delay time of k-th pipe (h) 
The average thermal resistance 
The heat loss of the k-th pipe (MW) 
The temperature of the soil outside 
the k-th pipe at time t (℃) 
The supplied of heat energy at time t 
(MW) 
The heating transfer coefficient of the 
building 

nsSnrSpsSprSsourceQ,ktq/kgswaterC/()Jkg℃,,ktsT,,ktrT,ktQ,ktv,ktRkQ,ktsoilTtHhtcKmtl/,mineh/,maxeh/,,ehtmean,pvtP,windtP,LTStP,,cutrtH,,cutptH/,eht,,conjtP,,chpitP,,chpitH,utR,,echatP,,edistP,,hdistP,,hchatP 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
to 

increase 

introduce  electrical  and 

In  winter,  a  CHP  unit's  operation  mode  is 
"determining  electricity based  on  heat", which results 
electricity generated by wind is abandoned [12]. Hence, 
thermal 
the  researchers 
decoupling  devices  to  address  the  issue.  To  achieve 
heat-power decoupling of the CHP unit, electric storage 
device and heat storage devices are installed next to the 
CHP unit. Coordinated operation of the electric power 
system  and  district  heating  system,  which  is  an 
effective  way 
the  system  operation 
flexibility, can increase grid-connected electricity from 
wind  power  [13-15].  By  introducing  electro-thermal 
conversion  devices,  the  fluctuations  of  renewable 
energy generations are effectively suppressed, thereby 
reducing the renewable energy curtailment [16,17]. In 
reference  [18],  a  model  of  local  scale  heat  storage  is 
proposed  in  residential  areas.  This  paper  investigates 
the  size  of  heat  storage  devices' 
influence  on 
continuous heating time. Equipment including electric 
boilers, heat storage devices, heat pumps, etc. is studied. 
As  equipment  investment  increases,  the  increment  of 
equipment’s heating capacity becomes less ideal. 

The  traditional  dispatching  considers  the  energy 
balance equation of electrical and thermal loads hourly. 
Without  considering  the  thermal  inertia  of  thermal 
networks,  the  traditional  dispatching  cannot  fully 
utilize  the  system's  peak  shaving  ability  to  promote 
renewable energy consumption. Making full use of the 
thermal  inertia  of  buildings  and  heat  network  can 
increase  the  flexibility  of  coordinated  operation  of 
electric  heating  systems  [19,20].  When  the  outdoor 
temperature changes, the heat dissipation process of the 
building  also  changes.  Because  the  building  has 
thermal inertia, the building can be regarded as a heat 
storage  device  equivalently,  which  can  store  and 
release thermal energy [21]. The demand for heat load 
is also dynamically changing with the process of heat 
storage and heat release in the building. To increase the 
flexibility  of  the  power  system,  the  thermal  device 
responds  to  the  thermal  load  dispatching  within  a 
defined range [22,23].   

Several  studies  have  focused  on  how  to  take 
advantage of the thermal characteristics of the district 
heating  system  (DHS)  to  increase  system  operation 
flexibility, 
thermal 
performance  (PDTP)  of  heat  network  piping  and  the 
thermal inertia of buildings (BTI). Considering PDTP 

particularly 

dynamic 

the 

load  of 

the  building  during 

means taking into account piping heat loss and thermal 
time delay, while considering BTI [24] means studying 
the thermal storage potential of a building as a thermal 
storage  device  [25].  In  reference  [26],  a  day-ahead 
optimization  scheduling  method  based  on  forecasting 
wind  curtailment  periods  was  developed.  Reduce  the 
heating 
the  wind 
curtailment  period  within  the  adjustable  range  of  the 
indoor temperature to meet the thermal comfort level. 
The reduction of heat load can reduce the heat supply 
of  CHP  units  and  promote  the  absorption  of  wind 
power. Because the heating time of all buildings is the 
same, reference [18] obtains the average heat supply of 
the building set equivalently from the heat supply of a 
single building. Then the heat load of the building set 
is obtained according to the equivalent transformation. 
Reference [27] establishes a planning model for energy 
stations  in  a  mixed  commercial  and  residential  area, 
and  all  nodes  are  commercial  and  residential  mixed 
load nodes. In this study, the difference characteristics 
of electricity and heat loads in mixed commercial and 
residential areas are relatively lacking.  The  preceding 
literature  ignores  disparities  in  the  thermal  storage 
capacity  of  different  functional  types  of  buildings,  as 
well  as  differences  in  the  heating  demand  time  of 
different functional types of buildings. 

Demand  response 

is  a  popular  method  of 
transferring energy that helps  to  maintain the balance 
between  supply  and  demand  [28].  It  is  regarded  as 
being a crucial part of the development of smart grids 
in the future. Demand response can reduce the peak-to-
valley difference of grid load, which is advantageous to 
the  system's  steady  operation  [29].  Demand  response 
achieves the reasonable distribution of load and energy, 
which can improve the economy and flexibility of the 
system [30]. Reference [31] developed a demand-side 
management technique that adjusts loads in residential 
areas to reduce  energy costs.  Reference [32] uses the 
real-time  electricity  price  to  adjust  the  response 
quantity  of  the  load,  which  can  reduce  the  cost  and 
satisfy  the  user's  thermal  comfort.  A  multivariate 
integrated demand response (IDR) model was built in 
references [33, 34] guided by electricity price and heat 
price.  A  two-stage  model  of  day-ahead  and  intra-day 
was  established  in  reference  [35].  In  the  day-ahead 
stage,  the  time-shift  demand  response  is  used  to 
establish a robust optimization operation model. In the 

intra-day stage, a replaced DR is used for a stochastic 
scheduling.  This  strategy  can  effectively  improve  the 
balance of energy supply and demand by combining the 
advantages  of  multiple  energy  sources.  A  two-layer 
optimization  model  for  an  integrated  energy  system 
was  established  in  reference  [36],  which  took  into 
consideration  heating  costs  and  the  cost  of  electricity 
generation. The nonlinear two-layer model is translated 
into  a  mixed-integer  linear  programming  problem 
using  the  KKT  optimality  criterion.  The  lower-level 
sub-problem was transformed into the constraints of the 
upper-level  problem.  Reference 
[37]  employed 
Stackelberg  game  to  solve  energy  management  and 
pricing  problems  for  multi-community  integrated 
energy systems with multi-energy interactions. 

Based on existing research, an optimal scheduling 
approach  is  presented  for  integrated  energy  systems 
taking  into  account  the  differences  in  heat  demand 
across  multiple  regions.  First,  a  Stackelberg  game-
based optimization  model is constructed in this  paper 
to condition the interests of integrated energy operator 
(IEO)  and  users.  To  release  more  thermal  flexibility, 
the  temperature  threshold  of  heating  buildings  with 
varied functions can be employed to the fullest extent 
possible.  Second,  the  model  is  transformed  into  a 
mixed-integer  quadratic  programming  (MIQP)  using 
KKT optimum conditions. Last, the simulation results 
demonstrate  that  differential  heating  manages  to 
improve the thermal flexibility of system operation by 
individually  setting  the  temperature  thresholds  for 
buildings in different functional areas. 
2 Model of electro-thermal integrated 
energy system 
2.1 System architecture   

An  IES  is  described  in  this  study  as  a  multi-
energy  system  with  electro-thermal  coupling  that 
includes  power  producing  units,  energy  conversion 
devices, and electric storage device. CHP units offer 
thermal  energy,  while  distributed  generator  sets  and 
CHP units produce electricity. The electricity grid and 
heat  network  are  connected  by  CHP  units.  Demand 
response achieves load reduction and shifting. Due to 
the  load  peaks  of  the  grid  and  the  heat  grid  are  at 
different times, the two systems can be connected to 
improve  the  energy  efficiency  of  the  system.  The 
addition  of  electric  storage  devices  can  shape  the 

electric  load  curve,  cut  peaks  and  fill  valleys,  and 
reduce renewable energy curtailment. The introduction 
of  heat  storage  device  facilitates  thermal  decoupling 
of  CHP  units.  In  Fig.  1,  the  system  architecture  is 
displayed.   

Fig. 1 Architecture of the integrated electric and thermal 

energy system 

As  shown in  Fig. 1,  the  IES  model  used in  this 
study  includes  CHP  units,  thermal  units,  energy 
storage, wind turbines (WTs), Photovoltaic (PV) units, 
and  loads.  Based  on  the  previous  work  [22],  a 
comparative  experiment  is  set  based  on  different 
compositions of the auxiliary equipment. In this study, 
electric  and  heat  storage  device  is  introduced  to 
increase the flexibility of system operation.   
2.2 Modeling of district heating network 
2.2.1 Heat source model 

Heat source model can be expressed as follows: 
(1) 
where 
  is  the  heat  energy  obtained  from  the 
CHP  unit  and  the  heat  storage  device  at  the  supply   
  is the mass flow of 
network pipe of the head end, 
  is  specific  heat  capacity  of 
pipe  k  at  time  t, 
water, 
the 
temperatures  of  water  supply  or  return  pipelines  at 
heat source at time t , respectively. 
2.2.2 Mass flow balance of heat-supply network   

  and 

  are 

, 

Similar  to  Gustav  Kirchhoff’s  law  of  current, 
there is a law in heat networks. For each node in the 
network,  the  total  mass  flow  in  and  out  of  all  pipes 
connected to the node is equal:   

(2) 

  is a node  of  heating  networks, 

where 
are  respectively  the  node  set  of  supply  pipes  and 

and

EnergyWindSolar EnergyNatural GasCoalWTsPV UnitsCHP UnitsTP UnitsElectricity GridHeat Supply NetworkElectric storage devicesHeat storage devicesIntegrated Energy SystemThe User Side,windtP,pvtP,,echatP,,edistP,LtP,LtH,chptH,chptP,contP,,chatestH,,distestHPower FlowNatural GasThe Heat FlowCoalPublic AreaResidential Area ,,,,,( -)sourcektwaterktsktrQqCTTsourceQ,ktqwaterC/()℃kJkg,,ktsT,,ktrT',,,',,,   ' ,                                      SSiktiniktoutnsnrpsprqqiSSk'insSnrS 
 
 
 
return  pipes, 
and

  is  the  number  of  heat-supply  pipe, 
  are  the  pipe  sets  of  supply/return  pipes, 

respectively. 

  is the inlet mass flow of the k-th 

supply/return  pipe  connecting  node 

  is 

the  outlet  mass  flow  of 

  at  time  t, 
the  k-th 

supply/return pipe connecting node 
2.2.3 Heat power of pipes 

  at time t. 

in  a  pipe 

The  flow  of  heat  medium 

is 
accompanied  by  the  transfer  and  loss  of  heat. 
According to  the  basic  principle  of  heat conduction, 
the heat energy of the heating medium in the pipeline 
can be calculated according to the following formula: 

(3) 

where 

  and 

  are temperatures of the k-

th supply/return pipe at time t, respectively; 

and 

  are  the  heat  energy  of  the  k-th supply/return 

pipe at time t, respectively. 
2.2.4 The mixed temperature in the node   

The temperature of the hot water is fused to the 
same temperature and delivered to each exit pipe after 
being  gathered  from  several  intake  pipes  at  a  single 
node. The following model may be used to represent 
the temperature fusion: 

  (4) 

where 

is  the  outlet  temperature  of  the  k-th 

supply/return  pipe  connecting  node 
is temperature of supply/return pipe connecting node 

at time t. 

dispatching is very short, while the time scale of heat 
network  transmission  delay  varies  from  several 
minutes  to  several  hours.  The  heating  network 
satisfies  the  non-real-time  heat  balance  due  to  its 
transmission  delay.  It 
the  scheduling 
flexibility  for  the  electric  heating  system  and  fully 
utilizes  the  complementing  qualities  of  different 
energy  sources.  This  report  investigates  the  major 
heating  network's  transmission  delay.  The  principal 
heating  network's  hot  water  transmission  rate  is  as 
follows: 

increases 

(6) 

  is  water  density, 

where 
heating network pipe, 
th supply/return pipe at time t.   

  is  diameter  of 
  is flow velocity of the k-

The length of the heating pipe and flow velocity 
are  both  directly  correlated  with 
time  of 
transmission  delay.  The  time  of  transmission  delay 
can be expressed as 

the 

(7) 

where 
pipe. 

  is actual delay time of k-th supply/return 

In  order  to  apply  to  the  optimal  scheduling  of 
electro-thermal  integrated  energy  system,  the  actual 
delay time is integer by using a rounding function, as 
shown in the following formula: 

(8) 

  at time t. 

where 

  is time delay after rounding . 

Assuming the hot water temperature at node 
is  fused,  the  node  temperature  is  equal  to  the  inlet 
temperature of the pipe starting at node

. 

  (5) 

As  it  travels  along  the  hot  water  transmission 
pipeline, the hot water medium absorbs heat from the 
heat source and transfers  it  to  the  load  node. Due to 
the primary heat-supply network's lengthy length and 
the  time  delay  effect  from  the  supply  of  heat  to  the 
load.  The  heat-supply  network  is  not  a  real-time 
balance system. Therefore, the impact of the hot water 
flow's  time  delay  on  the  heat-energy  balance  of  the 
heat-supply network should be taken into account. 
2.2.5 Transmission delay of heat-supply network 

It is significant to study the transmission delay of 
heat-supply network in the electric-heating combined 
dispatching system.  The time  scale  of  power  system 

2.2.6 Thermal attenuation 

After a certain time delay, the inlet of hot water 
  to  the  outlet,  in  this  process 
through  the  length 
also  accompanied  by  energy  attenuation  and  time 
  is the length of the heating network pipe. 
delay. 
The  heat  loss  of  hot  medium  passing 
  through 
length 

  is shown in the following formula: 

(9) 

where 

  denotes  the  temperature  of  the  soil 

outside  the  k-th  pipe  at  time  t; 

  is  the  inlet 

temperature  of  the k-th  hot  water  pipe at  time  t; 
stands  for  average  thermal  resistance  between  the 
heated medium and the surrounding environment. 

The  heat  energy  obtained  by  the  load  side  heat 

exchanger of the primary heat network is 

(10) 

kpsSprS',,,iktinq'i',,,iktoutq'i,,,,,,,,,,      SS    SSktinktwaterktinpsprktoutktwaterktoutpsprQqCTkQqCTk,,ktinT,, ktoutT,,ktinQ,,ktoutQ',,,,',,    ' ,                                              SSiktoutktitktnsnrpsprTqTqiSSk',,,iktoutT'i',itT'i'i'i',,,       ' , SSitktinnsnrpsprTTiSSk,,2    SS(/2)ktktpsprkqvkdkd,ktv,,       kktpsprktLkSSv,kt,,[/]       ktktpsprroundtkSS,ktkLkLkQkL,,,2( )ktktinsoilkkTTQLR,ktsoilT,,ktinTR,,loadtsourcetKQQQ 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
where 

  denotes the heat energy obtained by the 

load side heat exchanger. 
2.3 Multi-region thermal demand variability 
modeling 

In winter, around 80% to 90% of the heat energy 
is supplied to various structures. Due to the structures' 
ability  to  store  heat,  it  is  widely  used  to  alleviate  the 
problem  of wind desertion in the  mode of continuous 
heat and power. Because administrative qualities vary 
between  functional  areas, building  structure  are  often 
diverse. Building structural differences are represented 
by  the  body  shape  coefficient  of  the  structure.  The 
shape  coefficients  of  large-volume  buildings  are  low, 
small-volume buildings are higher [38], and the public 
area's  shape  coefficient  is  0.2.  The  building  shape 
coefficient is 0.4 in residential area. 

(11) 

where Coefficient is the building shape factor, S is the 
external  surface  area  of  the  building  in  contact  with 
the  outdoor  atmosphere,  and  V  is  the  volume  of  the 
building. 

Energy  supply  requirements  vary  by  functional 
region.  A  public building's  heating  load requirement 
can  be  altered  at  different  stages.  Make  sure  the 
interior  temperature  is  higher  than  the  equipment's 
antifreeze temperature in the night. Allow the indoor 
temperature to be adjusted according to the needs of 
the human body during the day. There is no clear time 
split in the heating demand for residential buildings, 
necessitating  all-weather  heating.  It  is  possible  to 
change the heat load within a defined range due to the 
ambiguity  of 
indoor 
temperature  threshold  is  determined  to  account  for 
thermal comfort over time.   

thermal  awareness.  The 

As a result, the building's temperature and comfort 
can be maintained while reducing heat supply, making 
the  building's  heat  load  demand  more  flexible.  The 
thermal transient equilibrium equation for the building 
can  be  used  to  calculate  the  impact  of  the  amount  of 
heat supplied on the change in indoor temperature [39]: 

(12) 

where 

  and 

  are  the  indoor  and  outdoor 

, 
temperatures at  time  t; 
S,  and  V  are  the  heating  transfer  coefficient  of  the 

  is  the  heat supply, 

building, the surface area and volume of the building, 
respectively. 
  are  the  air  specific  heat 
capacity and density, respectively.   

  and 

To  determine  the  link  between  heating  load 
the  following 
temperature, 

power  and 
equation can be derived: 

interior 

(13) 

2.3.1  Temperature  setting  for  residential  heating 
considering thermal comfort 

The  heating  burden  of  residents  is  calculated 
using  the  human  body's  thermal  comfort  index.  The 
level of occupant comfort with regard to thermal load 
is assessed using the human thermal comfort index. A 
person's level of activity changes over time, and so do 
their temperature requirements. During the night, the 
body  is  in  a  sleeping  state  and  less  sensitive  to  its 
surroundings.  Several  thermal  comfort  and  energy 
demands are sacrificed to adapt the heating strategy to 
the  needs  of  users  at  various  times.  Wind  power 
networks  are  also  provided  more  space  through  the 
reduction of thermal demand. 
Human  comfort 

influenced  by  physical 
variables including temperature, wind speed, relative 
humidity,  and  others.  A  straightforward  formula  is 
frequently  used  in  engineering  practice  [40],  which 
leaves out airspeed and air humidity, and is as follows: 

is 

(14) 

  is  the  average  temperature  of  the  skin 
where 
surface, which is 33.5℃, 
  is the indoor temperature, 
M is the metabolic rate of the human body, which is 80
  is the thermal resistance of clothing 

, and 

[41].   

The  human  body  is  not  immediately  aware  of 
temperature fluctuations when the PMV is in the range 
of  [-0.5,  0.5].  It  may  also  meet  the  human  body's 
interior temperature requirements in the winter when it 
changes between [-1, 1]. Set the PMV indication to [-1, 
1] for [8:00, 22:00], and [-0.5, 0.5] for the rest of the 
time ranges. 

2.3.2 Temperature setting for public area   

Different  schemes  are  utilized  in  public  and 
residential  locations.  Because  public  spaces  have  a 
more  definite  use  time,  they  can  cut  heat  supply 
during  non-working  hours  while  maintaining  a 

loadQSCoefficientV()ininouttttthtcairairdTHTTKSdtcVintTouttTtHhtcKaircair1()())11inoutinouthtcttttairairthtcairairKSTTtTTcVHtKScV3.76()2.43(0.1)minclttPMVMImtint2/MmclI 
 
 
 
 
 
 
Stackelberg 

specified  temperature  (usually  5°C).  As  a  result, 
during  working  hours,  the  temperature  of  the  public 
area  should  be  regulated  to  keep  the  PMV  index 
within  [-0.5,  0.5]  and  should  not  be  lower  than  the 
working temperature during non-working hours.   
3 
game-based 
electrothermal IES scheduling model   
Multilevel  programming  and  game  theory  are 
commonly used to coordinate the interests of multiple 
stakeholders in the optimal scheduling [42, 43]. In this 
study,  a  Stackelberg  game-optimized  scheduling 
model 
is  developed,  where  different  demand 
responses  for  thermal  loads  are  considered.  In  this 
model, energy suppliers and consumers act as active 
facilitators  and  passive  followers,  respectively.  The 
upper  model 
the  maximizing  of 
comprehensive energy application providers' interests, 
where the price of electricity or heating is determined 
by the IEO; while the lower model is based on the user 
selecting energy consumption times based on price to 
reduce  energy  consumption  costs,  with  the  power 
consumption  plan being  given  back  to the  IEO.  The 
schematic diagram of game model is demonstrated in 
Fig. 2 below.   

is  based  on 

Fig. 2 Schematic diagram of game model 

3.1 The upper-level model 
3.1.1 The objective function of upper-level model 

After  deducting  the  total  operating  cost  of  the 
system,  the  upper  objective  function  is  the  greatest 
profit, which may be represented as: 

(15) 

where 
supplier; 

  is the profit amount of the integrated energy 
  is 

  is  the  system  operating  cost; 

the total income for the integrated energy supplier  by 
selling electric energy and heat energy. 
(1) System economic dispatching cost 

The IES's economic dispatch is influenced by the 
operating costs of the unit, the reserve cost of the units, 

and  the  charging  and  discharging  costs  of  electric 
storage.  The  system  economic  dispatching  cost  is 
represented as 

(16)  

where 

, 

is scheduling cycle. 

and 

  are the  fuel cost  of CHP  unit  i and 
thermal power unit j at time t, I and J are respectively 
the numbers of CHP and thermal power units , 

and 
  are  the  electric  and  heat  storage  device 
charging  and  discharging  powers  ,  L  is  the  set  of 
  is the cost factor 
electric and heat storage device , 
  is  the  spinning 
for  charging  and  discharging  , 

reserve capacity , 
  is the unit and electric  storage 
devices  reserve  factor  ,  U  is  the  set  of  CHP  units, 
thermal power units and electric storage devices . 

(17) 

(18) 

where

, 

  and 

  are  the  fuel  cost 

coefficients  of  CHP  units,    and 

, 

  and 

  are the  fuel  cost  coefficients  of thermal  power 

units. 

  and 

  are  respectively  electric 

power and thermal power of CHP unit i at time t, 

is  the   thermoelectric  ratio  of  CHP  unit  i, 

is 

electric power of the j-th thermal power unit at time t. 
integrated  energy 
(2)  Profitable  amount  of 
operators 

The  following  formula  can be  used  to  calculate 

the profit of IEO: 

(19) 

where 

  is the income from selling electricity and 

heat  energy  to  users, 

  and 

are  respectively 

real-time  electricity  and  heat  prices  at  time  t. 

  is 

the  power  load  at  time  t, 

  and 

  are 

heating  load  of  residential  building  area,  public 
building area at time t. 
3.1.2 Constraints of upper-level model 
(1) Power balance constraints 

Electricity cannot be significantly stored. It must 
be created immediately before usage. Each node of the 
system must continuously maintain an electric energy 
balance in order to satisfy load demand . 

Leader:IEOObjective:maximize the profit(Proceeds from the sale of electricity and heat deduct Operating costs)s.t. a)Power balance  constraints     b)Constraints of DHN pipeline      temperature      c)Constraints about  the price of electricity and heatFollower:USERObjective:minimize the energy costS.t.       a)Constraints of time-shiftable load b)Constraint of the thermal load which can be reduced     c)Constraints of PMV and temperatureStrategy of the energy priceStrategy of the energy consumptionmaxprofopfCCCCopfCprofC,,,1111,,1(()+())TIJUtitjopfCHPCONuuttijuLllchaldislCFFTRPP{1,2,...,24},TtTT,tiCHPF,tjCONF,ldisP,lchaPl,utRu,,2,,,,,,,,,,,,()()chpitiCHPchpichpitVichpitchpichpitVichpitFaPcHbPcHc,2,,,,,,,tjCONconjconjtconjconjtconjFaPbPc,chpia,chpib,chpic,conja,conjb,conjc,,chpitP,,chpitH,Vic,,conjtP,,,,,,,()profetLthtLrestLpubtCPHHprofC,et,ht,LtP,,LrestH,,LpubtH 
 
 
 
 
 
 
 
 
 
 
 
 
where 

  is the electric load before cutting at time t,

    (20)   

and 

heat  energy,  respectively,  and 

are  the  real  time  price  of  electricity  and 
  is  the  thermal 

The  thermal  network  must  also  adhere  to  the 

comfort  loss  coefficient. 

  and 

are 

following requirements for thermal power balance: 

  (21) 

(22) 

where

and 

are  respectively  the  wind  and 

  and

photovoltaic  power  at  time  t, 
  are 
discharge power and charge power of electric storage 
devices  at  time  t, 
  are  the  charging 
and   
and  discharging  efficiencies  of  electric  storage 
are  the  heating 
and 
devices  at  time  t. 

and heat loads in the residential building area and the 
public building area, respectively. 
(2) Constraint of hot water pipe's temperature   

  (23) 

where 

is  the  temperature  of  the  i-node  of  the 

thermal  network  at  time  t;  and 
minimum and maximum values. 
(3) Constraint of the real-time prices 

and 

  are  its 

The pricing range is set as specified in the formula 
below  to  keep  electricity  and  heat  prices  within  a 
reasonable range. 

thermal comfort losses in residential building areas and 
public areas, respectively (their values are derived from 
the  amount  of  thermal  load  deviation  from  the  most 
comfortable  temperature);  and  the  penalty  cost  of 
thermal comfort loss is 

.     

3.2.2 Constraints of lower-level model 
(1) Constraints of time-shiftable load 

  (27) 

  (28) 

is the time-shiftable load at time t,
, 

is the 
where 
proportion  of  time-shiftable  loads, 
  are 
the  Lagrange  multipliers  of  the  equation  constraints 
about  the  upper and lower limits  of the  transfer load, 
respectively. 
(2) Constraints of cuttable thermal loads   

, 

The threshold value that can curtail the heat load 
is  determined  by  combining  the  heating  indoor 
temperature limits in residential and public places (such 
as Sections 1.3.1 and 1.3.2) with Equation (13). 

    (29) 

    (30) 

where 

, 

, 

, 

  are  the 

  (24) 

    (25) 

reduction or initial heating load of residential area and 
public area at time t, respectively. Note that, the initial 
heating load takes into account the heat load operating 
, 
under  optimal  comfortable  conditions. 

(4) Other general constraints   

The  unit  output/climbing  constraints  and  energy 
storage constraints are not described here. More details 
regarding these operational constraints can be found in 
previous fundamental works [44-47].   

3.2 The lower-level model 
3.2.1 The objective function of lower-level model 

The  objective  function  of  the  lower  layer  is  to 
reduce  energy  costs  and  the  penalty  cost  of  thermal 
comfort loss. 

(26) 

  are  the  maximum  value  of  the  heat  load 

, 

that  can  be  reduced  in  the  two  regions  at  time  t, 
are  the  Lagrange 
respectively.
multiplier of the upper and lower limits of the thermal 
load reduction amount. 
(3) Constraints of PMV and temperature 

, 

, 

In order to better accurately represent the range of 
potential heating loads in residential and public places 
while taking district heating features into consideration, 
the  heat  load  index  for  interior  heating  is  calculated 
using temperature and PMV values.  The  heating load 
of the residential area is set according to the PMV index; 
while the heating load of the public area is set based on 
the  PMV  index  during  working  hours,  and  it  is  set 
according  to  the  indoor  temperature  not  lower  than  5 
degrees Celsius during non-working hours. The PMV 
index  of  the  residential  area  is  set  according  to  the 

,,,,,,,,,11,,,,/IJchpitconjtwindtpvtedistedisijechatechaLtPPPPPPP,,,,,,,,,,1,,,,/IchpitebebhdisthdisthchathchatiLrestLpubtHPPPHH,,,,,loadtLrestLpubtQHH,windtP,pvtP,,edistP,,echatP,echa,edis,,LrestH,,LpubtHminmax,iitiTTT,itTminiTmaxiT,,,,,,11,TTetetmeanhthtmeanttTT,min,,max,min,,max,eetehhth,,,,,,,221,,,,,,0,,0,,,,0,,,,122,,,,[()min()][()()()]TetLthtLrestLpubttcutrtcutptLTSetLttThtLrtcutrtLptcutpttcutrtcutptPHHFHHPPHHHHHH0,LtP,et,ht,,cutrtH,,cutptH22,,,,()cutrtcutptHH2424,0,11  :  LTStLtttPP,,,,min,max12  :  ,LTSLTSLTStttttPPP,LTStP1t2t,,0,,,,,max3,4,0: ,cutrtLrtcutrtttHHH,,0,,,,,max5,6,0: ,cutptLptcutptttHHH,,cutrtH,,cutptH0,,LrtH0,,LptH,,,maxcutrtH,,,maxcutptH3,t4,t5,t6,t 
   
 
 
 
 
 
 
 
 
 
 
 
 
following formula: 

The PMV index and temperature of the public area 

are set according to the following formula: 

  (31) 

(32)   

4 Solution of the proposed game-based 

scheduling model 

4.1 The framework of the Stackelberg game 
The IEO leads the game model, which is followed 

by the user, resulting in the Stackelberg game model. 

upper  model's  constraints  using  KKT  conditions. 
Nonlinear  constraints  are  managed  using  the  big-M 
method,  which  converts  them  into  a  mixed-integer 
quadratic  programming  (MIQP)  problem.  Note  that, 
this  work  uses  probability  density  functions  for 
modeling  the  uncertainty  of  renewables.  Due  to  the 
difficulty in obtaining precise probability distribution 
functions of uncertain parameters in real applications, 
deep  generative  learning-based  renewable  scenario 
generation can be adopted to more realistically model 
the renewable uncertainties [48]. 

The  description  of  the  Lagrangian  function  for 

creating a lower level model is as follows: 

where 

  is  participants  in  the  model, 

(33) 
  and 
  are the strategies adopted by the IEO and user, 
C  and  F  are  objectives  of  the  respective  strategies. 
Among them, the participants include the  IEO as the 
leader of the model and the user as the follower, so it 
.  In  this  two-
can  be  expressed  as:
layer game model, the operators supply the customers 
with  real-time  electricity  and  heat  prices,  and  its 
.  On  the  user  side,  the 
strategy  is 
energy consumption plan is changed by the IEO, and 
as  its  strategy. 
take

Leaders  and  followers  develop  strategies  based  on 
objective functions like equations (15) and (26). 

When leaders adopt strategies 

, the user 
   for  them,  and 

reacts  with  strategies 
leaders  respond  with  new  strategies 
based on this feedback. This cycle is repeated several 
times until the leader and the user reach the Stackelberg 
game  equilibrium
. 
The  following  formula  is  satisfied  when  the  strategy 
achieves an equilibrium solution: 

,  which  equals

  (34) 

In  other  words,  when  a  solution  is  found  that  is 
agreeable to both the leader and the user, it is the best 
course of action for both parties, and neither can profit 
by changing the strategy. 
4.2  Mathematical  analytic  formula  of  the 
established model 

The  two-layer  optimization  problem  is  broken 
down  in  this  paper  into  mathematical  programs  with 
equilibrium  constraints.  The  objective  function  and 
constraints  of  the  lower  model  are  converted  into  the 

(35) 

Taking  the  partial  derivatives  of  equation  (35) 

respectively, we can get: 

(36) 

    (37) 

    (38) 

Therefore,  the  two-layer  optimization  problem 

can be transformed into the following model: 

    (39) 

Since the constraints in Eq. (39) are nonlinear, the 
them, 

is  used 

linearize 

big-M  method 

to 

  can  be  equivalently  transformed 

into: 

where M is a sufficiently large  positive constant, 
zero-one variable. 
4.3 Solution flow 

(40) 
is 

This  study  addresses  the  demand  response  of  a 

||0.5[7,20]||1[0,7)(20,24]PMVtPMVt||0.5[8,22]5[0,8)(22,24]inPMVttt℃;;{;};IEOUSERGNCFNIEOUSER{;}NIEOUSER,,(,)IEOetht,,,,,(,,)LTSUSERtcutrtcutptPHHIEOx()USERyx(())IEOxyx**(,)xy**(,)IEOUSER******(,)(,)(,)(,)IEOUSERIEOUSERIEOUSERIEOUSERCCFF,,,,,1234562424,,,0,1,min11,,2,max3,,40,,,,,max,,5,,60,,(,,,,,,,,)()()()()(LTStcutrtcutptttttttLTSLTSLTStLttttttLTSLTSttttcutrttLrtcutrtcutrttcutpttLptLPHHFPPPPPPHHHHHH,,,max,,)cutptcutptHH,12,0etttLTStLP,,,34,,20htcutrtttcutrtLHH,,,56,,20htcutptttcutptLHH,,,,,min1,max20,,,,,max,,4,,5,,30,,,,,max,,6  (15) to (20)-(24), (36)-(38)(),(),(),,,()     (31)-LTSLTSLTSLTSttttttLrtcutrtcutrttcutpttcutrttLptcutptcutpttMaxSubjectPPPPHHHHHHHHwhere(32),,,max2()LTSLTStttPP,,,max2     (1)LTSLTStttPPMM 
 
 
   
 
   
 
 
 
 
 
   
 
 
 
  
 
thermal load differential and solves the problem using 
the master-slave game approach as follows: 

Step  1:  Establish  a  probability  density  function 
and provide a probabilistic description of the wind and 
solar outputs. 

Step  2:  Process  the  continuous  sequence  of 

scenery using the serialization operation. 

Step  3:  Process  the  wind  and  solar  output  and 
backup  constraints  using  the  opportunity  constraint 
method,  and  change  the  uncertainty  constraints  into 
deterministic constraints. 

Step 4: Establish a power grid flow model, a heat 
network  hydraulic  model,  and  a  thermal  model  by 
entering pertinent parameters. 

Step 5: Determine the upper and lower limits of 
the  residential  heating  load  for  each  heating  period 
using the PMV index. 

Step 6: The heating load threshold value for each 
time period in the public area is established based on 
the PMV index during working hours, the temperature 
during  non-working  hours  meeting 
the  duty 
temperature. 

Step 7: Create a  lower layer based on the game 

model. 

Step  8:  List  the  KKT  conditions  for  the  lower-

level issue. 

Step 9: Transform the nonlinear constraints using 

the big-M method. 

Step  10:  Create  an  optimization  model  for  the 

top-level integrated energy operator. 

Step 11: Use YALMIP and the Cplex solver on 
the MATLAB platform to solve the constructed model. 
Step 12: Obtain a  two-layer  scheduling  scheme 

for optimization, and then output the results. 

5 Case studies 

The test system used in this research combines the 
IEEE  30-bus  power  system  and  two  6-node  heat 
network  models  [39],  as  indicated  in  the  Fig.  4. 
Residential and public areas are heated by the two six-
node heat networks, respectively. 

Fig. 4 System structure 

In this test system, the IEEE 30-bus power system 
has 4 thermal power units connected to nodes 1, 5, 11, 
and  13,  two  CHP  units  connected  to  nodes  2  and  8, 
and wind and solar power plants installed at nodes 16 
and  17.  Tables  B1  and  B2  display  the  pertinent 
parameters of thermal power units and CHP units. Fig. 
5 displays the ambient temperature, wind speed, solar 
output,  and  electric  and  heat  load  data  prior  to  the 
response.  Due  to  without  consideration  of  the 
secondary heat network, the equivalent heat loads in 
residential and public areas are respectively aggregate 
at  nodes  4,  5,  and  6  and  nodes  10,  11,  and  12.  The 
time-step  size  in  this  study  is  one  hour,  and  the 
scheduling cycle is 24 hours. 

Fig. 3 Solution flow of the proposed method   

output and electric, heating load 

Fig. 5 Data of outdoor temperature, wind and PV expected 

Programming with MATLAB and yalmip,and use the CPLEX solver Using DST method to build discrete probabilistic sequenceStartBuild a chance-constrained modelBuilding a Probabilistic Model of the SceneryResidential area: heat load threshold based on PMV indexPublic area: heat load threshold based on PMV index and indoor temperatureLinearize nonlinear constraints using the big-M methodList the KKT conditions for the lower-level problemAppend the lower-level problem KKT condition to the upper-level problemLinearization of Nonlinear Constraints Using the Big-M MethodEndBuild a user-following modelInput parameters, build network modelEstablish an optimazation model for upper-level integrated energy operators 141334121523242526273029288761251617102122181920119WPGGGG~~CHPCHPND1ND2ND3ND4ND5ND6ND7ND8ND9ND10ND11ND12GTP~CHPWWINDPPVResidential areaPublic area123456789101112131415161718192021222324Time(h)0100200300400500600700Power(MW)-22-20-18-16-14-12-10-8Temperature(℃)PV expected outputWind expected outputSingle regional heatong loadOutside temperatureElectrical load 
The  parameters  of  wind,  PV,  electric  storage 
device and heat storage device are shown in the Table 
B3.  The  specific  heat  capacity  of  indoor  air  is 
 .The  density  of  indoor  air  is 

. The total heating volume of the two 

.The proportion of residential area is 
areas is 
K=0.5. The comprehensive heat transfer coefficient of 
the building is 

. 

and  minimum  water 

The  heating  volume  of  the  two  areas  can  be 
calculated  from  the  total  heating  volume  and  the 
proportion of residential area. Then, two areas’ heating 
acreage is calculated using the building shape  factor. 
The  maximum 
supply 
temperatures  for  the  heating  network  are  100°C  and 
90°C, respectively. The maximum and minimum return 
water 
the 
appropriate  real-time  price  parameters,  such  as  90/40 
$/MWh  for  the  maximum/minimum  electricity  price, 
65$/MWh  for  the  average,  and  70/30  $/MWh  for  the 
maximum/minimum  hot  price,  50$/MWh  for  the 
average. 

is  60°C  and  35°C.  Set 

temperature 

The  energy  consumption  time  and  building 
characteristics  are  directly  connected  to  the  heat  load 
requirement required by various functional regions. In 
order to meet users' needs for thermal comfort, a system 
is also offered that takes time-sharing and partitioning 
load 
into  consideration  when  calculating  heat 
requirements. Other modes are configured to contrast it 
at the same time. The following modes are designed in 
this  study  based  on  the  flexibility  and  effect  of  the 
obtained strategy to reduce heat load: 

Mode  1:  The  indoor  temperature  in  both  the 
residential  and  public  areas  maintains  within  the 
required thermal comfort range at all times. 

Mode 2: The temperature in both residential and 

public places is set to the ideal level.   

Mode 3: The temperature in the residential area is 
kept at the required  thermal  comfort range,  while the 
public area remains at an ideal temperature.   

Mode 4: The temperature in the residential area is 
kept  at  an  ideal  temperature,  while  the  public  area 
remains at the required thermal comfort range   

Mode 5: The temperature in the residential area is 
kept at the required  thermal  comfort range,  while the 
public area adopts different actions during working and 
non-working hours. 

The MATLAB software is used in this simulation, 
along with the YALMIP plug-in to invoke the CPLEX 
solver to solve the problem. 
5.1 Economic analysis 

largest.  Mode  2  operates  at 

To analyze the economy of the proposed method, 
the IEO benefits and  user costs are studied  under the 
five  modes.  Table  1  lists  the  three  indicators  of 
operation  cost,  income  and  net  income  of  IEO,  and 
three  indicators  of  user-side energy consumption cost 
and  comfort  loss,  and  total  cost.  The  comparative 
analysis of Modes 1-5 shows that: in Mode 1, the user-
side energy cost is the largest, and the IEO benefits are 
the  optimum 
the 
temperature with  no  loss  of thermal comfort.  The  net 
income of the IEO of Mode 5 is at the middle level, the 
decrease  in  net  income  accounts  for  3.5%  of  the  net 
income  of Mode 1, the increase accounts for 2.1% of 
Mode 3, and the operating cost is at a lower level. Mode 
3 is small, the energy cost is the minimum value in the 
proposed strategy, the comfort loss is the largest, and 
the total user cost is at a low level, which is 36,617$ less 
than Mode 1. The above analysis demonstrates that due 
to  the  different  heat  load  requirements  of  different 
functional areas, it is advantageous to set the range of 
heat  load  response  based  on  the  energy  consumption 
characteristics of the area. It also can be found that the 
resulting scheduling strategy can significantly improve 
IEO’s revenue and reduce user costs at the expense of 
user thermal comfort to a certain extent. Note that, the 
loss of thermal comfort is still tolerable. 

Table. 1 Revenue and user cost analysis of integrated energy applications 

IEO 

User   

Mode 

1 

2 

3 

4 

5 

Net revenue/$  Earnings/$  Operating costs/$ 

Energy costs/$  The cost of comfort loss /$  Overall costs/$ 

957709.2 

1123614 

156230.8 

935227.2 

1099309 

        154635.3 

904993.1 

1065153 

151018.7 

926553.9 

1075803 

149249.3 

924042.6 

1054377 

150474.1 

1123614 

1099309 

1065153 

1075803 

1054377 

10196.8 

/ 

9383.6 

6271.0 

20139.7 

1111134 

1099309 

1053046 

1082074 

1074517 

111.007℃airckJkg31.2airkgm73610m210.5℃htcKWm 
 
 
 
 
 
lower between the hours of 9:00 and 19:00. When the 
electrical load rises, which also happens to be a period 
when  a  lot  of  wind  energy  is  produced,  wind  power 
curtailment is somewhat less. 

5.2 Analysis of unit outputs 

Fig.  6  depicts  the  electric  and  thermal  output  of 
CHP units in five different modes. According to Fig. 6, 
there  are  significant  disparities  in  the  heat  output  of 
CHP units, with CHP units in mode 5 having the lowest 
heat output. The electric outputs of CHP units in five 
modes  is  relatively  flat.  This  result  demonstrates  that 
the proposed technique has considerable advantages in 
terms of reducing CHP unit heat production and fossil 
energy use. 

Fig. 6 Electric and thermal outputs of CHP units of different 
modes 
5.3 Analysis of integrated demand response   
5.3.1Time-shiftable load 

As a controllable load, the time-shiftable load will 
shift the energy consumption period under the incentive 
of real-time electricity price and under the premise that 
the  total  electricity  consumption  remains  unchanged. 
According to the price of electricity, users can find the 
most  economical  time  to  use  electricity.  Peak  and 
valley filling can reduce load pressure during peak load 
hours, move energy load to load valleys. The schematic 
diagram of the change of electrical load before and after 
demand response is shown in Fig. 7. The peak load was 

Fig. 7 Change of electrical load before and after demand 

5.3.2 Cuttable heat load   

response 

As shown in Fig. 8, the thermal load of public and 
residential places is  determined by  human comfort  in 
mode 1. It can be observed that while the heating price 
is low, the heat load can be lowered to a little extent, 
and when the heating price is high, the heat load may 
be  reduced  to  a  big  extent.  In  Mode  5,  the  cost  of 
heating is inversely proportional to the amount of heat 
load that can be lowered. Compared with Mode 1, the 
technique described in this work (Mode 5) can cut more 
heat load, and help the system spend less energy. In Fig. 
9,  Mode  5  outperforms  Modes  1,  3  and  4  with  the 
maximum heat load reduction. Modes 3 and 4 maintain 
optimal  temperatures  in  residential  and  public  areas, 
respectively;  while  Modes  1  and  5  have  a  relatively 
large temperature margin for adjustment during 00:00-
7:00 and 22:00-24:00. 

12345Mode0100020003000400050006000700080009000Power  (MW)CHPthermal power outputCHPpower  output0123456789101112131415161718192021222324300350400450500550600650Power  (MW)Time  (h)Electrical load before demand responseElectrical load after demand response0123456789101112131415161718192021222324-55-50-45-40-35-30-25-20-15-10-505101520250123456789101112131415161718192021222324-55-50-45-40-35-30-25-20-15-10-50510152025253035404550556065707580heating price($)253035404550556065707580 ($) Power  (MW)Power  (MW)Time  (h)Time  (h)heating pricea)        Mode  1 b)        Mode   5Reduce heat load in residential areaReduce heat load in public area Heating priceHeating priceReduce heat load in residential areaReduce heat load in public area  
 
 
Fig. 8 Comparison and real-time heat price of reducible heat load between Mode 1 and Mode 5

Fig. 9 Thermal load reduction of modes 1, 3, 4 and 5 

5.4 Sensitivity analysis 

As  shown  in  Fig.  10,  K  is  the  proportion  of 
residential heating volume to total heating volume, and 
K=0.4,  K=0.5,  and  K=0.6  are  chosen  for  analysis. 
Among them, when K =0.5, the heating volume of the 
residential area is equal to the public area; when K =0.4, 
the proportion of the residential area is lower than that 
of the  public area; when  K =0.6, the  opposite is  true.   
Fig. 10 shows the sensitivity curve that can reduce the 
total  heat  load  and  the  proportion  of  residential  area. 
The three curves in the figure all have large reductions 
in the periods of 0:00-7:00 and 23:00-24:00. However, 
it can be seen that when the ratio is 0.4, the heat load 
can be reduced more. When planning new areas, public 
areas  can  be  increased  within  a  certain  margin  zone 
ratio for more heat load flexibility.   

Table  2  shows  the  sensitivity  analysis  results  of 
changing  the  proportion  of  residential  areas.  From 
Table 2, the following results can be obtained:   

Fig. 10 Analysis of total heat reduction versus residential 

areas 

(1)  With  the  increase  of  the  proportion  of  the 
residential  area,  the  energy  consumption  cost  of  the 
user is increasing, and the comfort loss is decreasing. 
Since cuttable heat loads increase during non-working 
hours,  the  electrical  output  of  the  thermoelectric 
coupling is reduced. As a result, the cost of generating 
energy and operating costs of the unit are relatively low. 
  (2)  The  income  of  the  IEO  increases  with  the 
the  energy 
proportion  due 
consumption cost on the user side. The net income of 
the IEO is the largest when the proportion is the largest. 
The total cost of the user is smaller when the proportion 
is smaller, and the most beneficial solution for the user 
is  obtained.  It  can  be  concluded  that  when  the 
proportion is close to the median value, the interests of 
IEO and users can be balanced. 

increase  of 

the 

to 

Table. 2 Sensitivity analysis of residential area proportions 

IEO 

User 

K 

Net revenue /$  Earnings /$  Operating costs /$ 

Energy costs /$  The cost of comfort loss /$  Overall costs/$ 

0.1 

0.2 

0.3 

0.4 

0.5 

0.6 

0.7 

0.8 

0.9 

854678.1 

947419.4 

143194 

868351.2 

978642.1 

150078.1 

899139.2 

1011068 

146347.5 

916758.9 

1042311 

152975.6 

924042.6 

1054377 

150474.1 

948115.8 

1087124 

155925.5 

995421.6 

1127939 

156325.7 

1043279 

1170367 

155358.2 

1116348 

1244473 

163343.8 

947419.4 

978642.1 

1011068 

1042311 

1054377 

1087124 

1127939 

1170367 

1244473 

50452.68 

39787.17 

34418.82 

27423.95 

20139.69 

16917.75 

23808.32 

28269.84 

35218.55 

997872.1 

1018429 

1045487 

1069734 

1074517 

1104041 

995421.6 

1198637 

1279691 

0123456789101112131415161718192021222324Time  (h)-45-40-35-30-25-20-15-10-5Mode 1Mode 3Mode 4Mode 5Power  (MW)0123456789101112131415161718192021222324-60-50-40-30-20-10010K=0.4K=0.5K=0.6Power  (MW)Time  (h) 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
5.5  Comparative  analysis  of  master-slave 
game model and single-layer model 

To  examine  the  performance  of  the  presented 
master-slave  game  model,  a  comparative  analysis  of 
the  proposed  model  and  single-layer  model  has  been 
carried  out.  As  for  the  master-slave  game  model,  the 
results  of  Mode  5  are  used  for  subsequent  analysis. 
Regarding the single-layer model, the IEO only seeks 
to the minimum energy costs without consideration of 
user costs; an electric or heating pricing strategy based 
on  time-of-use  prices  is  adopted  to  guide  users' 
behavior,  and  the  price  is  allocated  according  to  the 
percentage of the load in the overall amount; the user 
comfort  cost  is  set  as  the  penalty  cost  of  thermal 
comfort loss in Eq. (26). Expect the price constraints, 
the both models (master-slave game model and single-
layer  model)  have  the  same  constraints.  The  PMV 
index is used to estimate the interior heat load of users 
in  residential  areas,  whereas  the  PMV  index  and  the 
interior temperature are used to determine the interior 
heat load of users in public places, according to Mode 
6. The objective function in an independent operation 
mode is as follows: 

Tables  3  and  4  show  the  cost  comparison, 
economic  comparison  and  heat  comparison  analysis 

(41) 

between  the  two-layer  model  and  the  single-layer 
model  considering  the  master-slave  game.  It  can  be 
seen from the above table that:   

(1)  Compared  with  the  single-layer  model,  the 
master-slave  game  model  has  the  higher  thermal 
comfort  penalty  cost  and  the  lower  energy  cost  and 
operating cost.  The  difference in the thermal comfort 
penalty cost between the two models is not reflected in 
the heat reduction, and master-slave game model has a 
greater  heat  reduction  than  single-layer  model.  The 
decrease in energy costs reflects the fact that the lower 
heat 
in  energy 
consumption. At the same time, along with the decline 
in energy costs, operating costs have been reduced. The 
results  show  that  the  two-layer  model  of  the  master-
slave game has a better guiding effect on reducing the 
heat  load  than  the  single-layer  model.  The  two-tier 
model  also  plays  a  role  in  reducing  energy  costs  and 
operating costs.     

load  contributes 

to  a  decrease 

(2)  The  users’  cost  and  the  benefits  of  IEO  in 
single-layer  model  are  higher  those  in  master-slave 
game  model.  In  comparison  to  master-slave  game 
model,  single-layer  model  has  higher  user  costs  and 
supplier benefits. This is because the Stackelberg game 
strategy can balance the interests of suppliers and users, 
but the single-layer model only seeks to minimize the 
supplier's cost or to maximize the supplier's profit, and 
pays  less  attention  to  the  user's  side  interests.  The 
advantages of the Stackelberg game are reflected, and 
it is concluded that the two-layer model is more likely 
to  obtain  a  satisfactory  equilibrium  solution  than  the 
single-layer model.   

Table. 3 Comparison of mode 5 and mode 6 related indicators 

Master-slave game two-layer model (Mode 5) 

Single Layer Model (Mode 6) 

Operating costs/$  Energy cost/$  Thermal Comfort Penalty Cost/$ 

Operating costs/$  Energy cost/$  Thermal Comfort Penalty Cost/$ 

150474.1 

1054377 

20139.7 

178063.8 

1154759 

12711.4 

Table. 4 Comparison of mode 5 and mode 6 economy and thermal output 

Master-slave game two-layer model (Mode 5) 

Single Layer Model (Mode 6) 

Supplier 

user 

Total reduced heat 

CHP unit heat 

Supplier 

user 

Total reduced heat 

CHP unit heat 

revenue/$ 

cost/$ 

load/MW 

output/MW 

revenue/$ 

cost/$ 

load/MW 

output/MW 

924042.6 

1074517 

750 

6899.1 

976695.2 

1167470 

674.7 

8323.8 

(3) To protect the interests of suppliers, the total 
heat  load  reduction  of  single-layer  model  is  less  than 
that  of  master-slave  game  model. Only  more sales  of 
thermal energy can be more profitable for IEO. Taking 

into  account  the  differences  in  heat  demand  across 
multiple regions, the strategy suggested in this paper is 
able to significantly lessen the impact of district heating 
over time. Compared with Mode 6, the heat produced 

,,,1111,,,,,,,,,1(()())()TNMKtntmCHPCONkkttnmkLllchaldisetLthtLrestLpubtlCFFTRPPPHH 
 
 
 
 
 
by  CHP  units  in  Mode  5  is  less,  which  increases  the 
amount  of  wind  power  that  can  be  transferred  to  the 
main  grid  in  Mode  5.  It  can  be  safely  drawn  that  the 
proposed  method  based  on  the  Stackelberg  master-
slave game is better than the single-layer model in this 
paper. 

6 Conclusion 

In  this  paper,  various  demand-side  management 
strategies for heat load are implemented in accordance 
with  the  building  shape  characteristics,  user  energy 
consumption  characteristics  of  public  and  residential 
areas,  and  demand  differences  of  heat  load.  An  IDR 
model for the Stackelberg game is developed, and it is 
driven by current electricity and heat prices. A network 
model based on IEEE30 nodes and two 6-node thermal 
networks is used to validate the conclusion of this paper. 
The following conclusions are drawn from the example 
analysis: 

(1)  The  interests  between  the  IEO  and  the  user 
reach a Nash equilibrium due to the use of Stackelberg 

game in the proposed approach, which also lowers the 
user's energy consumption costs. In comparison to the 
single-layer model, the benefits of the suggested model 
in  balancing  the  interests  of  IEO  and  users  are  fully 
reflected,  and  the  user  side's  enthusiasm  is  fully 
mobilized.   

(2) According to the building characteristics and 
energy  consumption characteristics  of  different areas, 
the  presented  approach  is  advantageous  to  carry  out 
heat demand response strategies for different areas. It 
provides  margin  for  thermal  load  reduction,  thereby 
increasing thermal load flexibility. 

(3)  Through  the  sensitivity  analysis  of  the 
proportion of residential areas, it can be seen that with 
the increase of the proportion of public areas, the heat 
that can be reduced by the system will increase, and the 
efficiency of system  energy  utilization  will be further 
improved.  At  the  same  time,  it  can  be  more  energy-
efficient  to  match  the  appropriate  proportion  of  the 
residential area in the area.

References 

[8]  Wang Y,  Wang X,  Yu  H, et al. Optimal design  of  integrated energy 

system  considering  economics,  autonomy  and  carbon  emissions[J]. 

[1] 

Sun G, Wang W, Lu X, et al. Rapid energy flow calculation  method 

Journal of Cleaner Production, 2019, 225: 563-578.   

for integrated electrical and thermal systems[J]. International Journal 

[9]  Dong X, Kang C, Ding Y, et al. Estimating the wind power integration 

of Electrical Power & Energy Systems, 2020, 123: 106317. 

threshold  considering  electro-thermal  coupling  of  overhead 

[2] 

Li  Y,  Zhang  M,  Chen  C.  A  deep-learning  intelligent  system 

transmission  lines[J].  IEEE  Transactions  on  Power  Systems,  2019, 

incorporating  data  augmentation  for  short-term  voltage  stability 

34(5): 3349-3358. 

assessment of power systems[J]. Applied Energy, 2022, 308, 118347. 

[10]  Rostampour  V,  Keviczky  T.  Probabilistic  energy  management  for 

[3] 

Badal  F  R,  Das  P,  Sarker  S  K,  et  al.  A  survey  on  control  issues  in 

building climate comfort in smart thermal grids with seasonal storage 

renewable energy integration and microgrid[J]. Protection and Control 

systems[J]. IEEE Transactions on Smart Grid, 2018, 10(4): 3687-3697. 

of Modern Power Systems, 2019, 4(1): 1-27.   

[11]  Zheng  W,  Hou  Y,  Li  Z.  A  dynamic  equivalent  model  for  district 

[4] 

Pan Z, Guo  Q, Sun H.  Interactions  of district electricity and heating 

heating networks: formulation, existence and application in distributed 

systems considering time-scale characteristics based  on quasi-steady 

electricity-heat operation[J]. IEEE Transactions on Smart Grid, 2021, 

multi-energy flow[J]. Applied Energy, 2016, 167: 230-243. 

12(3): 2685-2695. 

[5] 

Li  Y,  Li  K,  Yang  Z,  et  al.  Stochastic  optimal  scheduling  of  demand 

[12]  Dai Y, Chen L, Min Y, et al. Dispatch  model for CHP  with pipeline 

response-enabled  microgrids  with 

renewable  generations:  An 

and  building  thermal  energy  storage  considering  heat  transfer 

analytical-heuristic approach[J].    Journal of Cleaner Production, 2022, 

process[J].  IEEE  Transactions  on  Sustainable  Energy,  2018,  10(1): 

330: 129840. 

192-203. 

[6] 

Li  X,  Li  W,  Zhang  R,  et al.  Collaborative  scheduling  and  flexibility 

[13]  Yuan R, Ye J, Lei J, et al. Integrated combined heat and power system 

assessment  of  integrated  electricity  and  district  heating  systems 

dispatch considering electrical and thermal energy storage[J]. Energies, 

utilizing  thermal  inertia  of  district  heating  network  and  aggregated 

2016, 9(6): 474.   

buildings[J]. Applied Energy, 2020, 258(Jan.15): 1-20. 

[14]  Shao C, Shahidehpour M, Ding Y. Market-based integrated generation 

[7]  Wang  C,  Gong  Z,  Liang  Y,  et  al.  Data-driven  wind  generation 

expansion  planning  of  electric  power  system  and  district  heating 

admissibility  assessment  of  integrated  electric-heat  systems:  A 

systems[J].  IEEE  Transactions  on  Sustainable  Energy,  2019,  11(4): 

dynamic convex hull-based approach[J]. IEEE Transactions on Smart 

2483-2493. 

Grid, 2020, 11(5): 4531-4543. 

[15]  Siddiqui  S,  Macadam  J,  Barrett  M.  The  operation  of  district  heating 

with  heat  pumps  and  thermal  energy  storage  in  a  zero-emission 

[29]  Li  Y,  Wang  R,  Yang,  Z.  Optimal  scheduling  of  isolated  microgrids 

scenario[J]. Energy Reports, 2021, 7: 176-183. 

using 

automated 

reinforcement 

learning-based  multi-period 

[16]  Zhang  N,  Lu  X,  Mcelroy  M  B,  et  al.  Reducing  curtailment  of  wind 

forecasting[J]. IEEE Transactions on Sustainable Energy, 2022, 13(1), 

electricity in China by employing electric boilers for heat and pumped 

159-169.   

hydro for energy storage[J]. Applied Energy, 2016, 184: 987-994. 

[30]  Li Y, Wang B, Yang Z, et al. Optimal scheduling of integrated demand 

[17]  Meng  Q, Li Y, Ren X, et al. A demand-response  method to balance 

response-enabled  community-integrated  energy  systems  in  uncertain 

electric power-grids  via HVAC  systems using active energy-storage: 

environments[J].  IEEE Transactions  on  Industry  Applications, 2022, 

Simulation and on-site experiment[J]. Energy Reports, 2021, 7: 762-

58(2): 2640-2651. 

777. 

[31]  Ogunjuyigbe A, Ayodele T R, Akinola O A. User satisfaction-induced 

[18]  Baeten B, Rogiers F, Helsen L. Reduction of heat pump induced peak 

demand  side  load  management  in  residential  buildings  with  user 

electricity  use  and  required  generation  capacity  through  thermal 

budget constraint[J]. Applied Energy, 2017, 187: 352-366. 

energy storage and demand response[J]. Applied Energy, 2017, 195(1): 

[32] 

Iwafune  Y,  Yagita  Y.  High-resolution  determinant  analysis  of 

184-195. 

Japanese  residential  electricity  consumption  using  home  energy 

[19]  Verbeke  S,  Audenaert  A.  Thermal  inertia  in  buildings:  A  review  of 

management  system  data[J].  Energy  &  Buildings,  2016,  116(mar.): 

impacts across climate and building use[J]. Renewable & Sustainable 

274-284. 

Energy Reviews, 2018, 82(3):2300-2318. 

[33] 

Jiang  P,  Dong  J,  Huang  H.  Optimal  integrated  demand  response 

[20]  Chen  H,  Gao  L,  Zhang  Y,  et  al.  Optimal  scheduling  strategy  of  a 

scheduling  in  regional  integrated  energy  system  with  concentrating 

regional  integrated  energy  system  considering  renewable  energy 

solar power[J]. Applied Thermal Engineering, 2019, 166: 114754. 

uncertainty  and  heat  network  transmission  characteristics[J].  Energy 

[34]  Wesseh Jr P K, Lin B. A time-of-use pricing model of the electricity 

Reports, 2022, 8: 7691-7703. 

market  considering  system  flexibility[J].  Energy  Reports,  2022,  8: 

[21]  Sun  C,  Liu  Y,  Cao  S,  et  al.  Integrated  control  strategy  of  district 

1457-1470. 

heating  system  based  on  load  forecasting  and  indoor  temperature 

[35]  Li P, Wang Z, Wang J, et al. Two-stage optimal operation of integrated 

measurement[J]. Energy Reports, 2022, 8: 8124-8139. 

energy  system  considering  multiple  uncertainties  and  integrated 

[22]  Li  Y,  Wang  C,  Li  G,  et  al.  Improving  operational  flexibility  of 

demand response[J]. Energy, 2021, 225(4): 120256. 

integrated  energy  system  with  uncertain  renewable  generations 

[36]  Wu C, Gu W, Xu Y, et al. Bi-level optimization model for integrated 

considering  thermal  inertia  of  buildings[J].  Energy  Conversion  & 

energy  system considering the thermal comfort of  heat customers[J]. 

Management, 2020, 207(3):112526. 

Applied Energy, 2018, 232: 607-616. 

[23]  Van Oevelen T, Scapino L, Al Koussa J, et al. A case study on using 

[37]  Li  Y,  Wang  B,  Yang  Z,  et  al.  Hierarchical  stochastic  scheduling  of 

district heating network flexibility for thermal load shifting[J]. Energy 

multi-community 

integrated 

energy 

systems 

in 

uncertain 

Reports, 2021, 7: 1-8. 

environments  via  Stackelberg  game[J].  Applied  Energy,  2022,  308: 

[24]  Pan Z, Guo  Q, Sun  H. Feasible region  method  based integrated heat 

118392. 

and  electricity  dispatch  considering  building  thermal  inertia[J]. 

[38]  Hou  J.  Research  on  building  energy-saving  design  based  on  the 

Applied Energy, 2017, 192(4): 395-407.   

concept of green energy saving[J]. Building Technology Development, 

[25]  Li  J,  Fang  J,  Zeng  Q,  et  al.  Optimal  operation  of  the  integrated 

2019, 46(23): 142-143. 

electrical  and  heating  systems  to  accommodate  the  intermittent 

[39]  Li Y, Wang C, Li G, et al．Optimal scheduling of integrated demand 

renewable sources[J]. Applied Energy, 2015, 167: 244-254. 

response-enabled integrated energy systems with uncertain renewable 

[26]  Wu  C,  Jiang  P,  Gu  W,  et  al.  Day-ahead  optimal  dispatch  with  CHP 

generations:  A  stackelberg  game  approach[J].  Energy  Conversion 

and wind turbines based on room temperature control[C]//2016 IEEE 

and Management, 2021, 235: 113996． 

International  Conference 

on 

Power 

System  Technology 

[40]  Dong Y, Wang Y, Ni C, et al. Combined optimal dispatch of heat and 

(POWERCON). IEEE, 2016: 1-6.   

power considering the flexibility of thermal comfort[J]. Power System 

[27] 

Jia C, Wu C, Zhang C, et al. Optimal configuration of energy stations 

Protection and Control, 2021, 49(23): 26-34. 

in urban commercial-residential mixed area based on joint planning of 

[41]  Li Y, Han M, Yang Z, et al. Coordinating  flexible demand response 

electric  heating  system  [J].  Power  System  Protection  and  Control, 

and  renewable  uncertainties  for  scheduling  of  community  integrated 

2017, 45(06): 30-36. 

energy  systems  with  an  electric  vehicle  charging  station:  A  bi-level 

[28]  Ganyun  L  V,  Cao  B,  Jun  L,  et  al.  Optimal  scheduling  of  integrated 

approach[J].  IEEE Transactions  on Sustainable Energy, 2021, 12(4): 

energy  system  under the  background of carbon  neutrality[J]. Energy 

2321-2331.   

Reports, 2022, 8: 1236-1248. 

[42]  Li  Y,  Yang  Z,  Li  G,  et  al.  Optimal  scheduling  of  isolated  microgrid 

with an electric vehicle battery swapping station in multi-stakeholder 

[46]  Li Y, Wang J, Zhao D, et al. A two-stage approach for combined heat 

scenarios: A bi-level programming approach via real-time pricing[J]. 

and  power  economic  emission  dispatch:  Combining  multi-objective 

Applied energy, 2018, 232: 54-68. +2 

optimization  with integrated decision  making[J]. Energy, 2018, 162: 

[43]  Zhang J, Zhou Y, Li Z, et al. Three-level day-ahead optimal scheduling 

237-254. 

framework  considering  multi-stakeholders  in  active  distribution 

[47]  Sun J, Deng J, Li Y, et al. A BCS-GDE multi-objective optimization 

networks: Up-to-down approach[J]. Energy, 2021, 219: 119655. 

algorithm  for  combined  cooling,  heating  and  power  model  with 

[44]  Li Y, Feng B, Wang B, et al. Joint planning of distributed generations 

decision strategies[J]. Applied Thermal Engineering, 2022: 118685. 

and  energy  storage  in  active  distribution  networks:  A  Bi-Level 

[48]  Li  Y,  Li  J,  Wang  Y.  Privacy-preserving  spatiotemporal  scenario 

programming approach[J]. Energy, 2022, 245: 123226.       

generation  of  renewable  energies:  A  federated  deep  generative 

[45]  Zhang J, Zhu X, Chen T, et al. Improved MOEA/D approach to many-

learning  approach[J].  IEEE  Transactions  on  Industrial  Informatics, 

objective  day-ahead  scheduling  with  consideration  of  adjustable 

2022, 18 (4):    2310-2320. 

outputs  of  renewable  units  and  load  reduction  in  active  distribution 

networks[J]. Energy, 2020, 210: 118524.     

Appendix A: 
(1) Proof of existence     
Theorem: Only when the model satisfies the following 
three conditions at the same time, the Stackelberg game 
problem can obtain an equilibrium solution. 

(a)  The  IEO’s  objective  function  is  the  non-empty 

, the USER take 

as the unique strategy;     

(b) When the USER’s strategy is defined as

, the IEO has a unique 

continuous function of 

; 

optimal solution.     

(b)  The  objective  function  of  USER  is  a  non-empty 

Proof: (a) Compute the first-order partial derivative of 

continuous function of 

;     

F with respect to 

, respectively. 

(c) The objective function of USER is the quasi-convex 

function of 

.     

Proof. C and F are nonempty and continuous functions 

of 

and

,  respectively. 

Thus, the proof for condition (c) is as follows: 

(4) 

(5) 

(6) 

(1) 

According to formula (4), it can be known that the 

function of F is an increasing trend according to the 

(2) 

variable 

. Let the first-order partial derivatives 

in equations (5) and (6) be equal to zero, respectively. 

(3) 

Simplified to: 

and 

From equations (1)-(3), it can be concluded that F 

. When 

, the optimal 

is  a  convex  function  about 

. 

strategy of users is

. When

Therefore, the existence of the equilibrium solution of 

the established game model is proved. 

(2) Proof of uniqueness   
Theorem: When the Stackelberg game satisfies the 
following conditions, a unique equilibrium solution 
exists. 
(a) When the IEO’s strategy is defined as 

users is

users is

, the optimal strategy of 

. When 

, the optimal strategy of 

. 

(b) The derivatives of C with respect to 

and 

,,(,)IEOetht,,,,,(,,)LTSUSERtcutrtcutptPHH,,,,,(,,)LTSUSERtcutrtcutptPHH,,(,)etht,,,,,(,,)LTStcutrtcutptPHH2,20()LTStFP22,,20()cutrtFH22,,20()cutptFH,,,,,(,,)LTStcutrtcutptPHH,,(,)IEOetht,,,,,(,,)LTSUSERtcutrtcutptPHH,,,,,(,,)LTSUSERtcutrtcutptPHH,,,,,,,LTStcutrtcutptPHH,,0()etLTStFP,,,,,2()htcutrtcutrtFHH,,,,,2()htcutptcutptFHH,LTStP,,,/2cutrthtH,,,/2cutpthtH,/20ht,(,0,0)LTStP,0,,,,max0/2htLrtcuttHH,,,(,/2,/2)LTSththtP,0,,,,max/2htLrtcuttHH,0,,,,,max0,,,,,max(,,)LTStLrtcutrtLrtcutptPHHHH,et,ht 
 
 
 
 
 
 
 
 
 
 
 
 
 
respectively are: 

It  can  be  known  from  equations  (7)-(8)  that  C  is  a 

monotonically  increasing  function  of 

and

. 

Therefore,  the  revenue  model  of  IEO  can  obtain  a 

unique solution about 

and 

. 

,

(7) 

(8) 

Appendix B: 

Table. B1 Main parameters of thermal power units 

(MW) 

(MW) 

(MW/h) 

(MW/h) 

($/MW2) 

($/MW) 

($) 

($/MW) 

50 
35 
30 
40 

25 
10 
10 
12 

25 
18 
15 
20 

25 
18 
15 
20 

0.012 
0.069 
0.028 
0.010 

17.82 
26.24 
37.69 
12.88 

10.150 
31.670 
17.940 
6.778 

13.7 
13.2 
13.2 
14.2 

Table. B2 Main parameters of CHP units 

(MW) 

200 
200 

(MW) 

  (MW) 

(MW/h) 

(MW/h) 

($/MWh) 

($/MWh) 

($/h) 

($/MW) 

100 
100 

250 
250 

50 
50 

50 
50 

0.0044 
0.0044 

13.29 
13.29 

39 
39 

0.15 
0.15 

16.2 
16.2 

Table. B3 Parameters of wind turbines and PV 

parameter 

Wind turbines parameters 

Photovoltaic parameters 

data 

=3m/s 

=15m/s 

=25m/s 

=60MW 

=1300m2 

=120MW 

Table. B4 Parameters of energy storage units 

parameter 

data 

Electric storage device parameters 

Heat storage device parameters 

=

=40MW 

=32MWh 

=160MWh 

=

=0.9 

=

=50MW 

=40MWh 

=240MWh 

,,0()LtetCP,,,,,0()LrestLpubthtCHH,et,ht,et,ht,,maxconiP,,minconiP,conujr,condjr,conja,conjb,conjcu,,maxchpiP,,minchpiP,,maxchpiH,chpuir,chpdir,chpia,chpib,chpicVCuinvrvoutvrPpvAmaxPVPmaxDCPmaxCHP,minocS,maxocSdcchmaxHCPmaxHDP,minocC,maxocC 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
