2
2
0
2

l
u
J

9
1

]
h
p
-
t
n
a
u
q
[

1
v
9
8
5
9
0
.
7
0
2
2
:
v
i
X
r
a

DESIGN AND IMPLEMENTATION OF THE ILLINOIS EXPRESS
QUANTUM METROPOLITAN AREA NETWORK

A PREPRINT

Joaquin Chung1,2,*, Ely M. Eastman4, Gregory S. Kanter3,4, Keshav Kapoor7, Nikolai Lauk5,6, Cristián Peña7, Robert
Plunkett7, Neil Sinclair5,6,8, Jordan M. Thomas4, Raju Valivarthi5,6, Si Xie5,6, Rajkumar Kettimuthu1,2,9, Prem
Kumar4,10, Panagiotis Spentzouris7, and Maria Spiropulu5,6

1Data Science and Learning Division, Argonne National Laboratory, 9700 S Cass Ave. Lemont, IL. 60439, USA
2The University of Chicago Consortium for Advanced Science and Engineering, 924 E 57th St, Chicago, IL 60637,
USA
3NuCrypt LLC, 1840 Oak Ave, Evanston, IL 60201, USA
4Center for Photonic Communication and Computing, Department of Electrical and Computer Engineering,
McCormick School of Engineering and Applied Science, Northwestern University, 2145 Sheridan Road, Evanston, IL
60208-3118, USA
5Division of Physics, Mathematics and Astronomy, California Institute of Technology, 1200 E. California Blvd.,
Pasadena, CA 91125, USA
6Alliance for Quantum Technologies (AQT), California Institute of Technology, 1200 E. California Blvd., Pasadena,
CA 91125, USA
7Fermi National Accelerator Laboratory, Kirk Rd and Pine St, Batavia, IL 60510, USA
8John A. Paulson School of Engineering and Applied Sciences, Harvard University, 29 Oxford St., Cambridge, MA
02138, USA
9The Northwestern Argonne Institute of Science and Engineering (NAISE), 2205 Tech Drive Suite 1-160, Evanston, IL
60208, USA
10Department of Physics and Astronomy, Northwestern University, 2145 Sheridan Road, Evanston, IL 60208-3112,
USA
*Corresponding author: chungmiranda@anl.gov

July 21, 2022

ABSTRACT

The Illinois Express Quantum Network (IEQNET) is a program to realize metropolitan scale quantum
networking over deployed optical ﬁber using currently available technology. IEQNET consists of
multiple sites that are geographically dispersed in the Chicago metropolitan area. Each site has one
or more quantum nodes (Q-nodes) representing the communication parties in a quantum network.
Q-nodes generate or measure quantum signals such as entangled photons and communicate the
measurement results via standard, classical signals and conventional networking processes. The
entangled photons in IEQNET nodes are generated at multiple wavelengths, and are selectively
distributed to the desired users via transparent optical switches. Here we describe the network
architecture of IEQNET, including the Internet-inspired layered hierarchy that leverages software-
deﬁned networking (SDN) technology to perform traditional wavelength routing and assignment
between the Q-nodes. Speciﬁcally, SDN decouples the control and data planes, with the control plane
being entirely implemented in the classical domain. We also discuss the IEQNET processes that
address issues associated with synchronization, calibration, network monitoring, and scheduling. An
important goal of IEQNET is to demonstrate the extent to which the control plane classical signals
can co-propagate with the data plane quantum signals in the same ﬁber lines (quantum-classical
signal “coexistence”). This goal is furthered by the use of tunable narrow-band optical ﬁltering at
the receivers and, at least in some cases, a wide wavelength separation between the quantum and
classical channels. We envision IEQNET to aid in developing robust and practical quantum networks

 
 
 
 
 
 
Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

by demonstrating metro-scale quantum communication tasks such as entanglement distribution and
quantum-state teleportation.

Keywords Quantum networks, metropolitan area, Q-LAN, Q-MAN

1

Introduction

The full exploitation of quantum computing and quantum sensing is expected to require fully networked and distributed
solutions, as is robustly shown in the classical case. The advantages presented by deploying such quantum systems
come along with special challenges to the transmission of information that must be addressed to realize the full potential
of networking. For example, quantum signals are very sensitive to loss and even miniscule levels of added noise. The
no-cloning theorem prevents us from using approaches commonly employed in classical networks to mitigate such
problems since it forbids the creation of identical copies of an arbitrary unknown quantum state. As a result, more
sophisticated approaches must be employed to protect the quantum information we want to transfer (for example,
through indirect channels utilizing distribution of quantum entanglement and teleportation).

While quantum optical networks will eventually be used to interconnect quantum computers, for e.g. via quantum
transduction [1, 2], it is worth to mention that they provide some important near term advantages such as enhancing the
security of communication via quantum cryptography and improving the sensitivity of measurements via distributed
quantum sensing. While it is desirable to leverage as much of the already deployed ﬁber-optic infrastructure as possible,
because of the quantum information transmission speciﬁc challenges we discussed above, we expect quantum network
design to require major paradigm shifts from classical networks, as well as custom engineering for its systems. At
the same time, it is imperative that quantum networks are able to co-exist and, eventually, interoperate with classical
networks, so the design must incorporate as much compatibility with conventional networks as is practical.

The Illinois Express Quantum Network (IEQNET) is a program for developing metro-scale quantum networking over
deployed optical ﬁber infrastructure. While new technologies, such as quantum repeaters, will be needed to realize the
long-term goals of quantum networking, IEQNET focuses on leveraging currently available technology (with provision
for future upgrades as technology advances), to develop architecture and systems, and test and improve them through a
co-design process with deployment of metropolitan area quantum networks.

Two of the prime needs in quantum information systems are distributing entanglement and subsequently using the
entanglement to perform tasks like quantum key distribution and quantum teleportation. These needs should be met
while simultaneously allowing higher-power classical signals to share the same ﬁber, both for the purposes of enabling
communications to support quantum applications and for independent coexistence of high data-rate classical channels.
In this paper we introduce our architecture to realize these functions over a metro-scale network, focusing on simplicity
for entanglement distribution, and discuss some of the major control and management issues that need to be addressed
to enable reliable network operation. While there have been several proof-of-concept demonstrations of deployed
quantum communications and networking, over both free space and ﬁber, in various locations around the globe, see e.g.,
Refs. [3–9] for an overview, there is a need to advance entanglement-based technologies to be more integrated into
the (classical) networking framework beyond that of previous demonstrations. This includes scaling to more users,
reaching longer link distances, allowing coexisting quantum and classical data channels on the same ﬁber links, testing
quantum protocols in a realistic network setting, e.g., using transparent optical switches and other optical networking
components, as well as optimizing and automating the software control of network operations such as synchronization
between nodes.

2 Design Considerations

Despite the fact that quantum networks are not yet fully developed, it is expected that most quantum applications
will require networks that support entanglement distribution to enable teleportation for quantum communications,
in order to protect the quantum information. Since quantum network components essential for network deployment
beyond the metropolitan scale (e.g., quantum repeaters) are currently unavailable, it is essential to advance quantum
network architecture and develop quantum network technologies independently of the availability of such components.
One such approach is to develop entanglement-based quantum network architecture and implementations that employ
software-deﬁned networking (SDN) technology, together with transparent optical switches to implement network
functions. Such an architecture design allows the network to establish lightpaths among quantum nodes or between
quantum nodes and entangled photon sources via traditional (classical) wavelength routing and assignment approaches
used in transparent optical networks. In transparent optical networking, a lightpath is a path between two nodes in the
network in which light passes through unmodiﬁed. This quantum network architecture approach is inspired by the

2

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 1: IEQNET topology.

vision of universal transparent quantum networks detailed in the quantum networks for science workshop report [10]. It
is also desirable that the implementation of such a network should support coexistence of the quantum and classical
signals in the same optical ﬁber transmission systems and share the same DWDM network components.

3

IEQNET Architecture and Design

3.1

IEQNET Topology and Architecture

IEQNET consists of multiple sites that are geographically dispersed in the Chicago metropolitan area with sites at
Northwestern University (NU), Fermi National Accelerator Laboratory (FNAL), Argonne National Laboratory (ANL),
and a Chicago-based international communications exchange (StarLight). Each site has one or more quantum nodes
(Q-Nodes), which can communicate data and generate and/or measure quantum signals. Q-Nodes are connected to
software-deﬁned networking (SDN) enabled optical switches through optical ﬁbers. The optical switches further
connect with one another to form a meshed all-optical network. IEQNET contains three logically independent quantum
local area networks (see Figure 1): Q-LAN1 at FNAL, Q-LAN2 at NU and StarLight, and Q-LAN3 at ANL. The
Q-LANs are connected by dedicated communication channels and additional dark ﬁbers between FNAL and ANL
(already operational), as well as between ANL and StarLight and FNAL and StarLight (these connections are part of
the ESnet [11] plan for quantum network infrastructure deployment). A dark ﬁber is essentially an unused optical
ﬁber cable with no service or trafﬁc running on it. In addition, IEQNET has Q-Nodes that incorporate one or multiple
entangled photon sources (EPSs) shared across the network, as well as Q-Nodes that incorporate Bell state measurement
capabilities (BSM nodes), which are also connected to SDN-enabled optical switches through optical ﬁbers. An EPS
generates entangled photon pairs at N wavelengths, allowing a maximum of N/2 user-pairs to simultaneously share
bipartite entangled photons. The N wavelengths from the EPS are typically distributed via N ﬁbers to an all optical
NxN switch. Such switches are commercially available with low loss, high port counts, and transparency over the entire
low-loss ﬁber wavelength range of 1270-1620 nm. These features allow efﬁcient distribution of quantum photons to
many users and open up wavelength options like the use of a 1310 nm band entangled photon source that allows for
enhanced co-existence with classical data. A BSM node performs Bell state measurements, projections of two qubit
states onto Bell basis, and local qubit operations for incoming photon pairs.

IEQNET implements a layered quantum networking architecture, which describes how quantum network functions
are vertically composed to provide increasingly complex capabilities. Other research groups have proposed layered
architectures for quantum networks that resemble the classical Internet stack. For instance, Dahlberg et al. 12 [QuTech
at Delft University, Netherlands] proposed a quantum network stack that perfectly maps the names of the TCP/IP stack
(i.e., they have Application, Transport, Network, Link, and Physical layers). Similarly, Alshowkan et al. 13 [Oak
Ridge National Laboratory, USA] proposed an architecture that considers Application, Transport, Link, and Physical
layers. The authors purposely exclude a network layer because they consider this is only needed for connecting multiple
independent networks like in the case of the classical Internet. IEQNET’s layered quantum networking architecture
relies on four key vertical layers (see Figure 2).

3

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 2: IEQNET’s layered quantum networking architecture relies on four key vertical layers: quantum physical
layer, quantum link layer, quantum networking layer, and quantum service layer. See text for further description.

• Quantum physical layer deals with the physical connectivity of two communicating quantum nodes. It deﬁnes

quantum channel frequencies, signal rates, photon pulses used to represent quantum signals, etc.

• Quantum link layer is the protocol layer in Q-Nodes that handles the transmission of quantum signals and

messages across quantum channels.

• Quantum networking layer performs wavelength routing and assignment in optical networks to establish

lightpaths between quantum nodes.

• Quantum service layer provides quantum services, such as entanglement distribution and quantum teleportation

to users and applications.

We must emphasize that our layered architecture does not have a one-to-one mapping to the classical TCP/IP stack.
Mainly because repeaterless, metropolitan-scale quantum networks do not need the equivalent of classical packet
switching in the quantum domain. These networks can operate under the circuit switching paradigm, that is, establishing
a lightpath between Q-Nodes before communication starts as done in IEQNET’s quantum networking layer. This
explains the absence of a transport layer in our layered architecture. However, when we move from experimental
demonstrators towards more realistic network applications an Application layer could be introduced on top of the stack
to incorporate various quantum applications that use entanglement and teleportation services.

3.2

IEQNET Q-Node design

Much like their classical counterparts Q-Nodes in IEQNET, depicted in Fig. 3, represent the communication parties
in a quantum network. Every Q-Node performs both conventional (classical1) and quantum functions. The quantum
functions that the node has to execute depend on the node type. These range from single and entangled photonic
qubit generation to qubit measurements and processing, including Bell-state measurements. A Q-Node also performs
conventional functions such as classical computation and communication. For example, a Q-Node will exchange
messages with other Q-Nodes via conventional trafﬁc channels to exchange the results of quantum measurements, e.g.,
to determine correlations, or execute quantum protocols. A Q-Node is assigned an Internet Protocol (IP) address to
uniquely identify the node. Meanwhile the endpoints of each conventional channel within the Q-Node are identiﬁed and
addressed by a physical address (a classical device that contributes to the workﬂow of a classical function constitutes a
“conventional endpoint”). In addition, a Q-Node enumerates and numbers the quantum channels it connects to. The
<Q-Node IP, quantum channel #> pair is used to identify and address a particular quantum channel endpoint (a quantum
device within the Q-Node that contributes to the workﬂow of a quantum function constitutes a “quantum endpoint”).

Conventional channels serve three purposes in IEQNET: (i) as communication channels between Q-Nodes to exchange
data and timing messages to enable quantum (correlation) measurements, (ii) embedded signals to allow calibration
and stabilization functions (e.g., polarization stabilization, calibration of quantum basis measurements, or ﬁber-delay
stabilization), (iii) as test channels for experimentation, e.g., to determine the limits of classical/quantum channel

1We use “classical” and "conventional" interchangeably in this article, as a qualiﬁer for classical network functions and/or signals

4

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

coexistence. We note that the calibration/stabilization could use quantum signals directly, but the use of larger
magnitude classical signals when possible can provide enhanced functionality, such as reducing set-up time when the
network changes the user connections or allows high-rate feedback control to compensate time-varying parameters (like
polarization).

Routing is a fundamental network function. Multi-hop
networks (those in which information has to travel across
more than one networking devices) require a means of
selecting paths through the network. Due to technology
immaturity in quantum memory and quantum computa-
tion, IEQNET does not perform routing in the quantum
domain, such as entanglement routing. Instead, SDN tech-
nology is used to perform traditional wavelength routing
and assignment in optical networks to establish lightpaths
between Q-Nodes, or between Q-Nodes and entangled
photon pair sources (EPSs), as appropriate (see Sec. 3.3
for more details).

3.3

IEQNET Control Plane Design

Figure 3: IEQNET Node implementation diagram. Each
node performs conventional and quantum functions and has
optical and electronic interfaces that are controlled by a
FPGA with additional software layers running on top.

Mechanisms for generation, synchronization, and mea-
surement of quantum states in networks are crucial for
realizing a multitude of quantum information applica-
tions. They can allow high-quality distribution of en-
tanglement throughout the network—provided errors are
identiﬁed, their magnitude estimated, and steps taken for
their correction. Orchestration and control mechanisms
are especially important for performing advanced quan-
tum communication tasks, such as quantum teleportation
and entanglement swapping, which are based on quantum
interference and thus are more susceptible to dynamical processes in a network environment, such as polarization
rotations in the ﬁber channels or electronic control drift from local clock mismatches. IEQNET uses a centralized
control approach in which SDN controllers monitor the status of key infrastructure plane metrics (e.g., loss on ﬁber
links, status of optical switches, etc.). IEQNET’s control and management software performs such functions as time
synchronization, optical path routing and wavelength assignment for quantum and classical channels, channel calibration
and optimization, and error detection and feedback.

• Time Synchronization. Synchronizing remote locations for distribution of entanglement and their use in
subsequent applications is crucial for quantum networking. For the ﬁber channels, this is done by distributing
clock pulses in the same ﬁber as the quantum signals, where permitted.

• Routing is a fundamental network function, and multihop networks require a means of selecting paths through
the network. IEQNET’s underlying quantum network is a WDM-based all-optical network. We use SDN
technology to perform traditional routing and wavelength assignment (RWA) [14] to establish paths between
Q-Nodes in IEQNET’s quantum physical layer. RWA is typically formulated as a multi-commodity ﬂow
problem, an NP-hard problem that is typically solved with heuristic algorithms. For IEQNET, we represent the
network by an undirected graph G(V, E), where V represents the set of nodes in the graph (Q-Nodes, BSM,
EPSs, and optical switches) and E represents the set of edges in the graph (optical links). Each edge in the
graph (optical link in the network) has the following characteristics that contribute to the computation of the
edge’s metric/weight: link length, total number of wavelengths, number of wavelengths available, attenuation,
etc. Each node in the graph may also contribute to the edge’s metric/weight with attributes such as insertion
loss, polarization-dependent loss (PDL), and polarization mode dispersion (PMD). We use the following
shortest-path RWA (SP-RWA) algorithm as the baseline (see Algorithm 1):

1. The set of shortest paths between a source-destination pair is ordered according to the entanglement

distribution requirements

2. The set of wavelength is ordered according to the entanglement distribution requirements
3. A new connection is routed on the ﬁrst path on which a wavelength is available
4. Among the set of available wavelengths on that path, the ﬁrst one is selected, or the one that meets the

requirement is selected

5. If no path, or no wavelength can be found, the connection is considered blocked

5

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

• Quantum Channel Calibration & Optimization. The single-photon nature of quantum communication signals
makes them extremely sensitive to noise on the quantum channels. In addition, as mentioned above, protocols
such as teleportation require indistinguishability in spectral, temporal, spatial, and polarization properties
of the two photons arriving at the BSM node. IEQNET employs several active and automated quantum-
channel calibration and optimization mechanisms to minimize quantum-channel loss, reduce background
noise, and compensate for polarization and delay drifts. A common way to assess the indistinguishability is to
perform a so called Hong-Ou-Mandel (HOM) experiment for the interfering photons by adjusting the relative
time of arrival of the photons on the beam-splitter. This renders photons from completely distinguishable,
corresponding to the case when the two photons arrive at different times and don’t interfere with each other, to
as indistinguishable as possible, corresponding to the case when two photons arrive at the same time at the
beam-splitter. By increasing the HOM visibility we can ensure quantum indistinguishability. The monitoring
of the HOM visibility provides feedback to compensate for the photons’ relative time-of-ﬂight, ensuring stable
operation. Active polarization measurement and calibration using coexisting classical signals, such as clock
pulses, is used to compensate for polarization drifts in ﬁbers.

Algorithm 1 Shortest-Path RWA (SP-RWA) algorithm

wavelengths ← SORTWAVELENGTH(path, C, p)
for each wl in wavelengths do
if wl is available then

1: Input: G(V, E), src, dst, C, p
2: Output: route
3: route ← NULL
4: paths ← FINDANDSORTPATHS(G, src, dst, C)
5: for each path in paths do
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16: end for
17: return “Connection Blocked”

route ← ROUTECONN(path, wl)
break

end for
if route is not NULL then

return route

end if

end if

3.4

IEQNET Control Plane Implementation

(a)

(b)

Figure 4: (a) IEQNET control plane implementation and (b) Q-NET Server block diagram.

We are implementing and deploying the SDN-based, logically centralized IEQNET control plane design described in
section 3.3, concurrently with the deployment of the IEQNET Q-Nodes and carrying out of use-case demonstrators.

6

Web PortalSDN AgentSDN Controllere.g., ONOSSwitchQ-nodeQ-nodeEPSSwitchMessage BusQ-NET ServerSouthbound APIsMSGsBSM-nodeQ-nodeMSGsMSGsMSGsDesign and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

As illustrated in Figure 4, a logically centralized Q-NET server coordinates all activities in the network. This server
manages and schedules various quantum network resources at the Q-Nodes (such as EPS, BSM, and send and receive
channels) to perform key control and management functions of quantum networking services (e.g., entanglement
distribution and quantum teleportation for the IEQNET use cases).

A web portal authenticates, authorizes, and audits users and applications, and allows them to access IEQNET services
and functions. For example, for an entanglement distribution service request, the following information is conveyed to
the Q-NET server via the web portal: the credentials of the task submitter, the Q-Nodes involved, and the entanglement
distribution requirements, such as qubit type, rate, duration, etc. The Q-NET server uses this information to schedule
and broker resources for the task. In addition, users are able to browse the quantum network topology or monitor the
system/site status via the web portal.

As the network expands and/or changes with nodes or connections joining or going ofﬂine, an SDN agent keeps
track of the quantum topology and trafﬁc status with the aid of SDN controllers. It is also responsible for reliably
updating SDN-enabled switch rules, as requested by the Q-NET server, to assign paths for quantum, clock, and classical
signals/messages. SDN controllers are open-source network operating systems, such as the Open Network Operating
System (ONOS) [15]. The SDN agent accesses SDN controllers through northbound application programming interface
(APIs). A nortbound API allows other applications to send commands to an SDN controller. One or multiple SDN
agents will be deployed, depending on the size of the quantum network.

In this implementation, the Q-NET server communicates with other entities through a message queuing telemetry
transport (MQTT) based message bus. Such a control plane design offers ﬂexibility, robustness, and scalability.

3.5

IEQNET Classical Control Protocol Suite

In this section we describe the IEQNET classical control protocol suite, which is composed of two main protocols:
quantum network resource and topology discovery protocol (see Figure 5) and the protocol for handling entanglement
distribution requests (see Figure 6). The classical control protocol suite runs inside the Q-NET server of IEQNET’s
control plane implementation.

Figure 5 shows a sequence diagram of the discovery protocol, which starts when each quantum networking resource
(e.g., Q-Nodes, EPS, BSM-nodes, and switches) load their own conﬁguration from ﬁle at initialization. The next step
is for the SDN agent to discover the network topology through the SDN controller’s southbound API. A southbound
API allows an SDN controller to communication with networking devices such as all-optical switches. As all-optical
switches are passive devices and thus classical active mechanism for topology discovery will not work, we have
extended ONOS’s link discovery service to build the topology from information loaded in a tag ﬁeld on each optical
port’s conﬁguration. Quantum network resources register to the Q-NET server by sending their features and connectivity
information. The Q-NET server will request the topology from the SDN agent and will subsequently ask the SDN
agent to verify the connectivity information provided by individual quantum resources. Once the topology has been
veriﬁed, the Q-NET server will build a topology graph based on the updated topology and present it to users through
the Web portal. This cross-veriﬁcation is necessary because the current prototype of the IEQNET controller does not
support active discovery (as already mentioned). As we work with conﬁguration ﬁles, the only way the SDN Agent can
know a Q-Node is connected to its designated port is by receiving a message from the Q-NET server after the Q-Node
registered. This discovery protocol keeps running as quantum network resources can come and go. Furthermore, the
SDN agent has the capability to notify the Q-NET server of topology changes asynchronously.

Figure 6 illustrates how IEQNET handles a user entanglement distribution request. The protocol starts with a user
requesting entanglement distribution between Q-Node1 and Q-Node2. The Q-NET server will analyze this request
and choose an EPS that meets the requirements speciﬁed by the user. Upon acceptance of the request, the Q-NET
server will execute path routing and wavelength assignment and will establish the paths among involved entities via the
SDN agent. Q-NET server will notify Q-Node1 and Q-Node2 when paths are established and initiate path veriﬁcation,
which involves a series of active probes from EPS to Q-Nodes (and vice versa) using both classical and quantum
light. After path veriﬁcation, the Q-NET server will initiate calibration and optimization processes (as described in
Section 3.3) for the requested service. Once all entities send the READY signal to the Q-NET server, the entanglement
distribution process starts. Q-Nodes will collect measurements until they have a long enough ebit string for the upper
layer application. At that point they will send the END signal to the Q-NET server to stop entanglement distribution.
Periodically during entanglement distribution, the Q-NET server will re-initiate the calibration and optimization
processes. After the Q-NET server stops the EPS, all measurements will be stored at the Q-NET server and the user
will be able to access them through the Web portal.

7

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 5: Quantum network resource and discovery protocol.

3.5.1 Entanglement Distribution Protocol

In this subsection we expand the description of the entanglement distribution protocol shown in Figure 6. The
corresponding IEQNET protocol is characterized by the following message ﬂow between the entities:

1. A user sends a request to IEQNET controller for entanglement distribution between Q-Node-1 and Q-Node-2.

• Qubit types (polarization, time-bin,...)
• Start/END time
• Q-Node pair
• Common measurement basis for calibration

2. IEQNET controller analyzes the request and chooses an EPS that meets the requirement, or the request is

rejected.

3. IEQNET controller executes path routing & wavelength assignment and establishes paths among involved

entities.

4. IEQNET controller notiﬁes Q-Node-1, Q-Node-2 and EPS node that paths are established

5. Q-Node-1, Q-Node-2, and EPS test and verify paths. If there are failures, they send negative acknowledgements
(NACKs) to the IEQNET controller and the ﬂow goes back to step 3. Otherwise, they send acknowledgement
(ACKs) to IEQNET controller.

• Veriﬁcation of the path from EPS to Q-Node1 is done in two stages. First a classical light (some light of
known power for example) is sent from EPS to Q-Node1. The received power is measured at Q-Node-1
and communicated to the IEQNET controller. This will be used to establish losses.

• Next step is to send quantum light from EPS which is measured in the single photon detectors (SPDs)
and upon receiving expected clicks, the Q-Node-1 will send a message to the IEQNET controller saying
that the path has been veriﬁed. Similar steps are used to verify the path between EPS and Q-Node-2.
Assuming the EPS is calibrated and the losses from EPS to Q-Nodes are also known from the previous
step, the expected clicks will be R ∗ η where R is the rate of photon generation at EPS and η the loss

8

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 6: The protocol for handling entanglement distribution requests. The steps inside the alt box are only executed
if the SelectEPS() procedure returns a successful ESP, otherwise the request is cancelled.

between the EPS and the Q-Node. Measure the “noise” on the detector by switching off the quantum
light from EPS. Calculate the ratio of noise/rates and if the ratio is less than some speciﬁed threshold (e.g.
1/6) declare it as a success. Similar steps are followed for the clock paths too.

6. IEQNET controller performs calibration and preparation for entanglement distribution.

• The classical signals to be exchanged between the two receiver stations for sync and channel monitoring
are assigned the wavelength of λsync = 1551.72 nm (DWDM ITU Channel C32). These signals can go
back and forth between the two receiver stations.

• Measurement basis alignment

(a) Polarization Qubit:

– Add classic alignment light at EPS [16].
– IEQNET controller notiﬁes EPS to send out alignment signals. The controller will specify the

basis.

– Q-Node tunes its analyzer to maximize the output so that measurement basis(es) are aligned with

the EPS basis(es).

– Q-Node stops and notiﬁes IEQNET controller.

(b) Time Bin qubit:

– IEQNET controller notiﬁes EPS to send early,early photons. Q-Node will identify the “early”
timing with respect to the local clocks. Then the EPS will send late, late photons which will then
allow Q-Nodes to identify the “late” timing.

– If the receivers are using the same detectors to detect in time and phase basis then IEQNET
controller asks EPS to send the entangled photons and receiver stations identify the so-called early,
middle and late bins from the histograms of the detection signals obtained locally.

– For interferometer alignment at both locations we add classic interferometer alignment light at

EPS.

9

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

– IEQNET controller notiﬁes EPS to send out interferometer alignment signals. The controller will

specify the phase.

– Q-Node tunes its interferometer phase to maximize the output to the corresponding phase so that

phases are aligned at both the Q-Nodes.

– Q-Node stops and notiﬁes IEQNET.

• In order to connect two types of networks a straight forward conversion between polarization and time-bin

qubits can be performed [17].

• In the calibrate phase, the entangled photons received by both are detected in a common measurement
basis which is agreed upon before. The detection results are encoded onto a laser with wavelength (λsync)
and exchanged back and forth between the two stations.

• These results are used then to achieve bit level sync using local time-taggers / coincidence analyzers at

each receiving station.

• This is also where the correlation delay can be established. Ideally the controller has a range of possible
delay values that may work for measuring correlations at a given node, which it communicates to the node.
While the measurement bases are aligned the node can scan the electrical delay (in integer clock units)
until heightened correlations are observed. Typically the node can determine if the delay setting is likely
to be right or wrong after ∼10 coincidence counts are measured (standard deviation of the measurement
10). If it is likely to be correct then another 10 coincidence counts should verify it.
is then

√

• Proceed to entanglement distribution (steps 8-11)
• Note that λquantum, λclk, and λsync can all be multiplexed onto a single ﬁber strand or just the classical

ones onto a different ﬁber strand as envisioned for the initial phases of the project.

• Choose a suitable duty cycle of the experiment and repeat the calibration step at the start of each cycle.

7. EPS, Q-Node-1, Q-Node-2, and other related entities notify READY to IEQNET controller.
8. IEQNET controller sends START to EPS.
9. EPS starts to distribute entanglement pairs; Q-Node-1 and Q-Node-2 receive entangled photons.
10. Q-Node-1 and Q-Node-2 measures the entangled photons, and exchange results. They store the results locally
until they have long enough e-bit string for the required application and communicate END to the IEQNET
controller.

11. IEQNET controller stops EPS with an END command.
12. The results will be posted to the IEQNET controller and will be stored.

The teleportation protocol can be devised in similar manner.

4

IEQNET Demonstrators

In this section we present experimental results that demonstrate system capabilities necessary for the deployment of the
IEQNET quantum network architecture. These involve quantum teleportation and quantum/classical signal co-existence
experiments performed at both Q-LAN1 and Q-LAN2 of IEQNET. Demonstrating co-existence in real-world conditions
is a major goal for IEQNET and a very desirable development for the deployment of quantum networks. Classical
communications are a fundamental part of many quantum communications protocols that require the transmission of
the results of quantum measurements amongst the node connections, such as remote state preparation and teleportation.
Furthermore, classical signals for time synchronization in quantum networks will be required. Beyond purely quantum-
based applications, future quantum networks will likely have ﬁber connections that are already populated with light
from the classical internet, which is predominantly in the C-band. If quantum communications can coexist in the same
ﬁbers carrying such high powers, the entire classical internet ﬁber infrastructure is available for quantum network
deployment. This would signiﬁcantly reduce the cost of deploying quantum networks as dark ﬁbers will not be required
and increase the number of available ﬁber connections between node locations. Dark ﬁbers are expensive to lease
due to the high demand for installed ﬁbers from the expansion of the classical internet. We demonstrate engineering
approaches to achieve this such that the network could be deployed anywhere within the ﬁber infrastructure.

Q-LAN1 has nodes deployed in two separate locations at Fermilab, connected by 2.5 km of optical ﬁber. Q-LAN1
is used to demonstrate time-bin qubit teleportation, although these initial tests are performed in a single location to
allow for experimental ﬂexibility and enable faster debugging. We perform teleportation over 44 km of lab-deployed
ﬁbers at 1536 nm and achieve above 90 % teleportation ﬁdelities with a semi-autonomous system that can sustain stable
operation via modern data-acquisition systems and integrated feedback mechanisms. We also discuss the commissioning
results of a clock distribution system, co-existing in the same optical ﬁber as the quantum channel, and where we

10

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

measured a time jitter of 5 ps. These co-existing clock distribution systems will pave the way towards synchronizing
multiple nodes in remote locations and thus allowing more complex quantum protocols.

Q-LAN2 connects the Quantum Communications Lab at Northwestern University in Evanston, Il to the Starlight
Communications Facility located on the Chicago campus of Northwestern. This underground ﬁber link is 22.8 km, with
the option of operating in loop-back mode to reach 45.6 km. The experimental measurements reported in this section
operate at the Northwestern site using the 45.6 km loop-back conﬁguration. The Starlight facility also has access to a
short-reach ﬁber connection to 600 S. Federal building and a 16x16 all-optical switch. Q-LAN2 distributes polarization
entangled photons, and includes the use of classical alignment signals to account for the unknown polarization transfer
function of the distribution ﬁber. This network uses the O-band (1310 nm band) for the quantum signal, which is chosen
so that substantial amounts of co-existing classical communications in the C-band (1550 nm band) can be tolerated on a
shared optical ﬁber. Our experiments and data analysis are guided and supported by a phenomenological model which
can be quickly compared with experimental data. We discuss the model and its utilization in our results.

4.1 Quantum Teleportation of Time-bin Qubits and coexistence with telecommunication O-band classical

signals at Q-LAN1

The Q-LAN1 nodes are deployed in two separate locations at Fermilab, one at the D0 Assembly Building (DAB) and
one at the Fermilab Computing Center (FCC). The two labs supporting the Q-LAN1 nodes at these two locations are
connected by ∼2.5 km of optical ﬁber going through a 16×16 (Polatis 6000s Ultra) all-optical switch. The Q-LAN1
setup with its two locations, short separation by ﬁeld-deployed ﬁber, and optical switch serves as an internal IEQNET
“testbed” to test and validate performance of IEQNET protocols before connecting the three Q-LANs (ﬁrst Q-LAN1
and Q-LAN3 at Argonne, and then Q-LAN2, the sequence in the order of increasing distance). The ﬁrst set of Q-LAN1
experiments were performed at the DAB lab.

4.1.1 Quantum teleportation

The Q-LAN1 ﬁber-based experimental system, summarized in the diagram of Figure 7, allows us to demonstrate a
quantum teleportation protocol in which a photonic qubit (provided by Alice) is interfered with one member of an
entangled photon-pair (from Bob) and projected (by Charlie) onto a Bell-state whereby the state of Alice’s qubit can
be transferred to the remaining member of Bob’s entangled photon pair. Up to 22 (11) km of single mode ﬁber is
introduced between Alice and Charlie (Bob and Charlie), as well as up to another 11 km at Bob, depending on the
experiment. All qubits are generated at a clock rate of 90 MHz, with all of their measurements collected using a data
acquisition (DAQ) system. The measured teleportation ﬁdelities with and without the additional ﬁber are presented in
Figure 8. To illustrate network compatibility, teleportation is facilitated using semi-autonomous control, monitoring, and
synchronization systems, with results collected using scalable acquisition hardware. Our system can be run remotely for
several days without interruption and yield teleportation rates of a few Hz using the full length of ﬁber. The Q-LAN1
systems are identical to those utilized in [18], with the DAB lab nodes being part of these original experiments.Our
qubits are also compatible with erbium-doped crystals, e.g. Er:Y2SiO5, that is used to develop quantum network
devices like memories and transducers [19–21]. The collaboration is currently working towards achieving teleportation
rates appropriate for practical, real-world applications by increasing the clock rate from 90 MHz to 4 GHz.

4.1.2 Clock distribution

While quantum teleportation has been achieved with state-of-the-art ﬁdelities and overall performance parameters
capable of supporting network functions, the demonstration has nevertheless been restricted to a single node. In a real
world network containing more than one node, clock distribution to synchronize the various nodes is critical. Since
photons are identiﬁed by recording their times of generation and detection, an accurate clock distribution system must
be in place to reduce the error rate to a negligible level. To this end, we developed a clock distribution system based on
the demonstration presented in [22]. The system relies on a stable clock oscillator measured to have a jitter below 700 fs.
The oscillator is used to synchronized all the RF components of the experiment in the main Q-node and additionally
drive a 200 MHz clock signal in the O-band which is directed to two independent nodes to adjust their local clocks.
C-band photon pairs, originating from a source based on spontaneous parametric down-conversion, are co-transmitted
with the classical clock signal. We ﬁnd that the clock distribution system can allow for high-ﬁdelity qubit distribution
despite the presence of (Raman) noise. We measure the coincidence to accidental ratio (CAR) of the photons arriving at
the remote Q-node. Figure 9 shows the difference in arrival time from the pair source (∆t) for different input clock
powers. We measure that the clock distribution reduces the CAR from 344 ± 22 to 246 ± 14, this resulting CAR will
ensure high-ﬁdelity qubit distribution using this clock system. The clock distribution was measured to have a jitter
below 2 ps is it 2 or 5, as we say in the intro paragraph?. The observed timing jitter between clocks at the central and

11

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 7: Schematic diagram of the quantum teleportation system consisting of Alice, Bob, Charlie, and the data
acquisition (DAQ) subsystems. One cryostat is used to house all SNSPDs, it is drawn as two for ease of explanation.
Detection signals generated by each of the SNSPDs are labelled 1-4 and collected at the TDC, with 3 and 4 being
time-multiplexed. All individual components are labeled in the legend, with single-mode optical ﬁbers (electronic
cables) in grey (green), and with uni- and bi-chromatic (i.e. unﬁltered) optical pulses indicated.

end nodes, suggests that our method can be used for high-rate networks. The deployment of such a system will pave the
road towards implementing important multi-node quantum functions for scalable networks.

4.1.3 Entanglement swapping

Furthermore, by building on the current capabilities, the systems are being upgraded towards entanglement swap-
ping [23], a key requirement for building long distance quantum networks. By performing a BSM between individual
members of two entangled photon sources, entanglement is swapped onto the photons that have never interacted before.
Using the newly commissioned FCC Q-node, we have measured the indistinguishability of the photons from two
photon pairs sources using a Hong-Ou-Mandel analysis [24]. The experimental results closely match a model of our
experimental setup which predicts, under these experimental conditions, a high swapping ﬁdelity.

4.2 Polarization Entanglement Distribution with Coexisting C-band Classical Light over Real-World

Installed Fiber at Q-LAN2

In addition to time-bin entanglement distribution, IEQNET also supports the distribution of polarization entanglement.
Here, we demonstrate methods for monitoring and compensating polarization birefringence effects during transmission
of photon pairs over installed ﬁber, which is required for quantum applications and measurements in polarization
entanglement-based networks. Classical alignment signals are used to transmit information about the birefringent
rotations during transmission over a ﬁber connection to polarization control systems (PCSs) at receiving nodes. Using
this information, inverse unitary transformations are applied such that each Q-node that is connected to a source at
Q-nodeA shares a universal polarization reference frame deﬁned during the entanglement generation at the source.

12

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

(a)

(b)

Figure 8: Quantum teleportation ﬁdelities for |e >A, |l >A, and |+ >A, including the average ﬁdelity. The dashed
line represents the classical bound. Fidelities using quantum state tomography (QST) are shown using blue bars while
the minimum ﬁdelities for qubits prepared using |n = 1 >, F d
+, including the associated average ﬁdelity
F d
a vg, respectively, using a decoy state method (DSM) is shown in grey. Panels a) and b) depict the results without and
with additional ﬁber, respectively. Uncertainties are calculated using Monte-Carlo simulations with Poissonian statistics

l , and F d

e , F d

Further, the Q-LAN2 installed ﬁber connection explores the implementation of alternative wavelength allocation for
quantum signals to make the physical layer more robust to noise photons generated from classical communications
coexisting inside the same ﬁber connection [25]. The polarization entangled quantum signal is allocated to the O-
band, which is shown to be optimal for scenarios in which the ﬁber connection is occupied with C-band classical
communication with high enough power that the amount of generated photon noise is fatal to C-band quantum
communication [26].

These studies are conducted at Q-LAN2, which is an
underground installed ﬁber link that connects the Quan-
tum Communications Lab at Northwestern University
in Evanston to the Starlight Communications Facility
located on the Northwestern Campus in Chicago (link
distance of 22.8 km) where we loop the connection back
to the Evanston Lab (total round-trip distance of 45.6
km).

4.2.1 Coexistence with C-band classical light

The wavelength allocation of quantum and classical sig-
nals to implement quantum network protocols is ﬂexible
when dark ﬁbers are available, allowing the lowest-loss
C-band to be used for optimal rate-loss quantum signal
transmission. In this scenario, classical signals for quan-
tum network control can be allocated to other wavelength
bands (such as the L or O-bands) to minimize noise cross-
talk into the quantum bands. However, the design of full
integrated networks must presume that high-power clas-
sical communications in the same ﬁber will unavoidably
occupy the C-band, making quantum signal allocation to
the C-band impractical at some threshold power level due
to the presence of spontaneous Raman scattering (SRS),
four-wave mixing (FWM), and ampliﬁed spontaneous
emission (ASE) from optical ampliﬁers. This noise dis-
rupts the ability to perform quantum communications
protocols in the C-band, requiring the reconsideration

Figure 9: Time difference between photons from the pair
source (∆t). The main peak at around ∆t = 0 corre-
sponds to the coincidence peak while the secondary peaks
are the accidental counts. Different input power for the
co-propagating clock signal in the O-band (1310 nm) are
shown in different colors. The increasing heights of the
accidental peaks with the higher clock power indicate more
Raman noise.

13

10.07.55.02.50.02.55.07.510.0t (ns)101102103104Counts/ 1.2 nsFQNETCAR(Clock Power(W))344±22(0)322±19(79)292±19(121)246±14(199)Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

of the quantum physical layer’s wavelength allocation
scheme. We mitigate the noise limitations caused by C-band classical coexistence by wavelength allocating the quantum
entangled photon pairs to the O-band. Due to the comparatively narrow bandwidths of FWM and appropriate ﬁltering
of the ASE, these effects have no noticeable cross-talk into the O-band. Further, since the O-band is far detuned from
the C-band on the anti-Stokes side (∼ 35 THz), noise photons generated from SRS are signiﬁcantly reduced. Since the
O-band has reasonably low loss in standard installed ﬁbers (∼ 0.33 dB/km), metro-scale quantum communication can
still be performed while noise from classical communications is drastically reduced compared to the C-band.

There have been numerous experimental implementations of a variety of coexistence scenarios in the context of
quantum key distribution (QKD) using weak coherent states (WCS) from attenuated laser light with a strong focus
on the O-band/C-band quantum/classical wavelength allocation scheme described above [27–33]. These studies were
primarily performed via single quantum channel schemes with WCS. However, fully operational quantum networks
beyond QKD will require the distribution of quantum entanglement. This means that two channels must be considered
simultaneously, one for each photon in the pair of the entangled state. In contrast to the single quantum channel
experiments, the signal to noise trade-off for entanglement-based networks depends on the coincidence detection of
correlations in the signal and idler pair’s time, frequency, and entangled degree of freedom. Due to the correlations
in time-of-arrival and energy conserving frequency correlations, tight temporal and spectral ﬁltering in coincidence
detection can be used to distinguish the quantum entangled signals from the uncorrelated background noise generated
from classical communications.

As a demonstration of the above-mentioned engineering considerations, we show experimentally that metropolitan scale
entanglement-based quantum communications can be achieved in installed ﬁber using the O-band with copropagating
classical C-band power levels that would make C-band quantum transmission infeasible. We show that polarization-
entangled quantum light can successfully copropagate with milliwatt power-level classical light over 45.6 km of
installed underground ﬁber. One photon from a polarization entangled source at the Northwestern Evanston location is
transmitted over the Q-LAN2 connection to the Starlight facility where it then loops back to the Evanston lab, while
the other photon is kept locally. Polarization analyzers and low-dark-count superconducting nanowire single photon
detectors (SNSPDs) are used for quantum characterization of the returning noise degraded quantum signal, which
have 30% detection efﬁciency in the O-band. The equivalent measured loss rate in the underground ﬁber link is 0.43
dB/km at 1310 nm, which is higher than expected in modern ﬁbers typically used in laboratory experiments, making the
equivalent loss closer to a 60 km distance if newer ﬁbers and low loss splicing were used. The use of O-band/C-band
quantum/classical wavelength allocation as well as tight temporal and spectral ﬁltering at receiver nodes allows us to
achieve high copropagating classical powers (about 7 dBm) while still maintaining nonclassical visibility (> 70.7%) in
polarization entanglement two-photon interference.

4.2.2 Polarization Entanglement Distribution Calibration

The quantum networking layer will control routing and assignment of lightpaths between nodes, which means every
time a new switched ﬁber connection has been established, re-calibration of the pair of paths needs to be performed.
Further, occasional re-calibration will also be required. Inevitably, time-dependent birefringence due to a variety
of environmental disturbances (temperature ﬂuctuations, ﬁber stresses on hanging ﬁber, etc.) will cause an initial
polarization state to drift over time. Thus, a crucial part of polarization entanglement network control is to ensure that
drift from the intended quantum state can be accurately and reliably monitored to re-establish the desired quantum
correlations between node pairs. Here we explain a simple protocol for polarization calibration between nodes in the
network using broadband classical light sources that are built into the entanglement source’s design.

Basis-alignment can be performed via the transmission of alignment signals which can be analyzed to extract the
polarization transformations that occur from the source to receivers. Then, unitary operations at receiving nodes can
be performed to compensate for birefringence in the ﬁbers and establish well-deﬁned relative polarization reference
frames amongst nodes in the network for performing correlated measurements. The design of polarization monitoring
highly depends on the timescales of the drift from the intended transmitted state. For slowly varying ﬁber birefringence,
alignment can be maintained for hours of operation with little drift from the intended quantum state, however some
ﬁber connections may have drift timescales where re-calibration may be required more frequently. In some situations,
particularly when loss is less prevalent and drift timescales are slow, using the output of the quantum entanglement
source itself can be used to align measurement basis. This method is limited by the transmission rate of the quantum
source, which signiﬁcantly increases the calibration duration and complexity due to low singles or coincidence count
rates, especially over long-distance ﬁber connections with high loss. Active monitoring of polarization rotations can be
performed by multiplexing in low power classical light at neighboring wavelengths to monitor polarization changes
[34, 35] at the expense of increased design complexity and coexisting classical channels, which may introduce some
noise into the quantum band

14

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

We choose to use a broadband classical alignment signal that is built into the O-band quantum entanglement source. The
broadband nature of the signal means that when the alignment signal is turned on, classical light is then sent throughout
the network to each node connection deriving from the EPS for basis alignment. Since the alignment signal is in the
same wavelength band as the quantum signal, it contains wavelength dependent polarization effects and propagates
the ﬁber network connections deﬁned by the wavelength routing/assignment and switching connections for quantum
channel conﬁgurations without additional modiﬁcations to the network physical design. This introduces light into
the quantum band, temporarily disrupting quantum communications. However, the classical nature of the alignment
signal allows us to de-couple the alignment procedure from quantum source rates, allowing the signal to overcome long
distance or high loss ﬁber connections by arbitrarily controlling the power transmitted and thus signiﬁcantly reducing
off-line calibration time due to the strong feedback signal for alignment regardless of link distance. For situations with
many connections, it may be desirable to only select a few channels that need alignment. By including WDMs and
variable attenuators, our signal can be modiﬁed to selectively send to a single or subset of receiving nodes such that
quantum communications are not disrupted over the entirety of the network connections.

Our alignment procedure consists of multiplexing in broadband ampliﬁed spontaneous emission (ASE) covering the
entire O-band to transmit a signal |V align(cid:105) for alignment in the H/V basis followed by a |diag align(cid:105) signal used to
align in the D/AD basis via polarization control at each node. The two non-orthogonal signals allow for full alignment
of the Poincare sphere at nodes Bob and Charlie to that deﬁned during entanglement generation at Alice [34]. The
broadband spectrum of the ASE is carved by the WDM ﬁlters deﬁned for transmission of the entangled pairs, which
allows for wavelength dependent birefringence to be accounted for. The ASE photons are then received by the same
polarization analyzers (PAs) as the quantum signals and is then detected by the single photon detectors. Active feedback
from the single photon counts from the detectors are used to perform basis alignment by adjusting birefringence
compensating waveplates in the PAs.

4.2.3 Q-LAN2 Experiment

Figure 10 shows a schematic of our experiment. We generate the polarization entangled quantum signals via cascaded
second harmonic generation-spontaneous parametric down conversion (c-SHG-SPDC) in a single periodically poled
lithium-niobate waveguide (PPLN) [36]. The cascaded second order interaction acts as a quasi-spontaneous four
wave mixing process used in ﬁber-based sources of entanglement [37], where the pump, signal, and idler wavelengths
all occupy same wavelength band. Since our cascaded second order nonlinear source is analogous to a ﬁber-based
entanglement source, we easily adopt the built-in alignment signal design used in previous ﬁber-based sources of
polarization entanglement [16, 38] for this SPDC based source. The PPLN waveguide is phase matched for SHG of
the 1320 nm pump pulse train at 417 MHz repetition rate with 80 ps pulse-width. We place the waveguide inside a
polarization Sagnac loop to generate polarization entangled photon pairs. The pump light entering the loop is split by a
polarizing beam splitter (PBSA) into two counter-propagating directions. The c-SHG-SPDC generates broad-bandwidth
quantum amplitudes for photon pairs centered around 1320 nm in both directions. Upon recombination at the PBS, the
two photon state exits the Sagnac loop in a polarization entangled state |φ(cid:105) ∝ |HH(cid:105)A + eiφEP S |V V (cid:105)A, where φEP S
is due to a relative phase between the H and V components of the pair generation pump.

We then separate the signal/idler photons into bands using a standard coarse wavelength division multiplexer (CWDM).
The CWDM outputs 20 nm wide bands with center wavelengths of 1310 and 1330 nm. The broadband spectrum of the
c-SHG-SPDC allows the source to support distribution over the full O-band to easily scale the network to more users by
carving the spectrum into more WDM output channels by either using the 1290 and 1350 CWDM bands or by further
carving the 20 nm wide channels into multiple narrower channels.

For alignment, broadband ASE from a Praseodymium-doped ﬁber ampliﬁer (PDFA) is multiplexed in to transmit
polarized signals in the wavelength bands deﬁned by the spectral ﬁlters in each ﬁber link connection. The alignment
procedure consists of sending two sequential alignment signals, one with a vertical (|V align(cid:105)) polarization and the
other with a signal for diagonal (|diag align(cid:105) ∝ 1√
(|H(cid:105)A + eiφEP S |V (cid:105)A) alignment, which the receiving nodes at
2
Bob and Charlie use to orient their waveplates while counting single photons to align their polarization basis with
that at Alice. A 100 GHz DWDM ﬁlter centered at 1320 nm passes the pump wavelength (1320 nm) and rejects the
broad ASE spectrum into another ﬁber. For H/V basis alignment the ASE signal is injected into one arm of the Sagnac
loop in Alice’s source to be reﬂected at PBSA such that it emerges vertically polarized (deﬁned by Alice’s PBS) and
propagates through both ﬁber channels to the PAs. At PABob and PACharlie, we initially set the projective measurement
waveplates to 0 degrees, with a liquid crystal retarder aligned at 0 degrees. The horizontal basis is then aligned via
rotating the ﬁrst QWP/HWP pair to minimize the single count rates in both Bob and Charlie’s single photon detectors.

The diagonal alignment signal is generated by injecting ASE via a 99:1 splitter into the source pump path such that
the output signal carries the same relative weighting and phase of H and V polarizations as the entangled photons. At
both PAs, the projection HWPs are set at 22.5 degrees to project onto the D basis while an automated search scans the

15

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 10: Q-LAN2 experimental design.

voltages applied to the LCR, which adjusts the relative phase between H and V components until the singles count
rates are minimized. After the optimal voltages are found for both PAs, the relative phase has been set to zero degrees
resulting in the arrival of the symmetric Bell state |Φ(cid:105)+ = 1√
(|HBHC(cid:105) + |VBVC(cid:105)) shared between Bob and Charlie,
2
where |H(cid:105) and |V (cid:105) are deﬁned at Alice’s PBS.

To demonstrate coexistence, we amplify C-band laser light at 1550.1 nm with an Erbium-doped ﬁber ampliﬁer (EDFA)
and multiplex it into the underground ﬁber to copropagate with the O-band quantum signal. We phase modulate the
C-band light to broaden its spectrum which emulates a data channel and inhibits stimulated Brillouin scattering. At the
receiver, we demultiplex out the C-band light while further ﬁltering the remaining signal and idler photons with 100
GHz bandpass (BP) ﬁlters centered at 1306.5 and 1333.5 nm, respectively. We detect the photons with SNSPDs, which
are followed by a time-tagging correlation detection system. We apply an electronic delay between the two channels to
account for the ﬁber delay and perform coincidence measurements using a coincidence correlation time window of 0.5
ns, which is set such that the arriving photon pair pulse would not drift outside the window due to timing jitter from
transmission over the ﬁber.

We send one photon of the polarization-entangled photon pair over a 45.6 km loop of underground installed ﬁber. The
underground ﬁber link connects the Quantum Communications Laboratory at Northwestern University in Evanston
to the Starlight Communications Facility located on the Northwestern Campus in Chicago (link distance of 22.8 km)
where we loop the co-propagating light back to the Evanston laboratory for characterization with polarization analyzers
and low-dark-count superconducting nanowire single photon detectors (SNSPDs).

Polarization measurement apparatuses described above at Bob and Charlie ﬁrst use the classical basis alignment signals
from Alice to set their measurement basis to the same reference frame deﬁned by Alice’s source. After basis alignment
is done, two-photon interference (TPI) measurements are made to analyze the performance of entanglement distribution
without (Figure 11(b)) and with (Figure 11(c)) copropagating classical light. TPI records coincidence-count fringes in
two non-orthogonal basis states, and the resulting fringe visibility is a metric of entanglement quality. TPI fringes with
V>70.7% are consistent with violating Bell’s inequalities and are strongly non-classical. To record a TPI, the basis
state measurement of one location is ﬁxed (say in the H or D orientation) by appropriate alignment of the polarization

16

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

Figure 11: (a) Back-to-back entanglement visibility measurements. (b) Entanglement visibility after transmission over
45.6 km installed ﬁber link. (c) Entanglement visibility with 6.8 dBm copropagating C-band power.

control elements, while the basis state measurement of the other location is scanned along a Great Circle of the Poincaré
sphere. For reference, Figure 11(a) shows the back-to-back TPI fringes, where visiblities are roughly 90%. The
low back-to-back visiblities are a result of increasing the source rates at the expense of visiblity in order to achieve
distribution over the lossy ﬁber. Figure 11(d) shows TPI fringes after the transmitted photon has propagated alongside
6.8 dBm of C-band launch power, where a visibility of 77% is observed in the HV basis and 74% in the DA basis. Both
values are > 71% and thus fall in the nonclassical regime of two-photon interference.

Due to the lack of active temporal drift monitoring for electronically shifting the correlation window around the 100
ps pulse, we use a 500 ps correlation window to make sure the coincidence counts stay within the same time window.
Active monitoring and shifting of a narrower correlation window would signiﬁcantly increase visibility. In the frequency
domain, narrowing our frequency ﬁltering even further to less than 5 GHz could presumably reduce Raman noise
by another factor of 20, which would allow for even higher copropagating powers to be used. The powers used in
our experiment clearly demonstrate that O-band quantum networks can coexist with the majority of modern classical
communications channels in the C-band. Further improvement to the quantum source and the optimization of SNSPDs
for the O-band (>80% efﬁciency) would signiﬁcantly increase the detection rates.

In summary, we have demonstrated that O-band/C-band quantum/classical wavelength allocation along with temporal
and spectral ﬁltering in coincidence detection are useful noise mitigation methods for coexistence scenarios in ﬁber-
optic quantum networking. High visibility two photon interference fringes are demonstrated over 45.6 km of installed
underground ﬁber with a copropagating 7 dBm classical launch power. An O-band classical alignment signal is
built into the entanglement source to align each node in a polarization entanglement network to the same polarization
reference frame. The combination of these two methods allows for robust polarization entanglement networks to be
integrated into real world installed ﬁber networks.

5 Conclusions and Future Work

The network architecture described above, where SDN technology is used to decouple the control and data planes and
perform network functions, could be easily be extended to include pair sources that are able to create entangled pairs
over a broad wavelength rage. This in turn would allow for simultaneous distribution of entanglement from a single
node to multiple users in a network by using wavelength-division multiplexing and by ﬂexible assigning of the available
frequency pairs to the different user pairs. Furthermore, to fully take advantage of this capability, solutions to achieving
photon-packet interference from sources of different wavelength are needed, e.g. by using tuneable narrow band ﬁlters.
This gives the network much more ﬂexibility allowing a more efﬁcient and dynamic quantum network.

The next steps on the way to the actual implementation of our quantum network will be distribution of the entangled
photon between Fermilab (Q-LAN1) and Argonne National Lab (Q-LAN3) and demonstration of entanglement
swapping operation at the Q-LAN1 for two independent entangled photon pair sources that are located at two distant
Q-LAN1 labs within Fermilab. To perform this task it is crucial that the photons that are used for the Bell state
measurement arrive at the same time. This requires high degree of synchronization between participating locations.
To achieve this we will use the recently developed clock distribution system [22] and characterized at the QLAN1.
This system allows for synchronization at the few ps second level by sending optical clock signals using the same
optical ﬁber as quantum signal, hence also demonstrating the ability of quantum-classical communication co-existence.

17

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

We will also continue to pursue co-existence demonstrators and quantum protocols at the Northwestern University
locations (Q-LAN2) using different telecom wave bands for the classical and quantum signals. In the next step for the
network deployment we will implement conversion between time-bin and polarization qubits and vice versa, which
would allow us to perform teleportation and entanglement swapping between Q-LANs that use different types of
entanglement. Further steps include connections to node-based hybrid systems such as superconducting resonators
https://arxiv.org/abs/2204.08605, mechanical cavities or spins by direct transduction or teleportation [1],
growing to a quantum internet.

Acknowledgment

IEQNET is funded by the Department of Energy’s Advanced Scientiﬁc Computing Research Transparent Optical
Quantum Networks for Distributed Science program, but no government endorsement is implied. The Caltech team also
acknowledges partial funding support from the Department of Energy BES HEADS-QON Grant No. DE-SC0020376
on applications related to transduction, Department of Energy HEP-QuantiSED Grant No. DE-SC0019219, and the
AQT Intelligent Quantum Networks and Technologies (INQNET) research program as well as productive discussions
with Matt Shaw and Boris Korzh of the Jet Propulsion Laboratory, California Institute of Technology and Daniel Oblak,
and Christoph Simon of the University of Calgary.

References

[1] N. Lauk, N. Sinclair, S. Barzanjeh, J. P. Covey, M. Saffman, M. Spiropulu, and C. Simon, “Perspectives on

quantum transduction,” Quantum Science and Technology, vol. 5, no. 2, p. 020501, 2020.

[2] N. J. Lambert, A. Rueda, F. Sedlmeir, and H. G. Schwefel, “Coherent conversion between microwave and optical
photons—an overview of physical implementations,” Advanced Quantum Technologies, vol. 3, no. 1, p. 1900077,
2020.

[3] A. Boaron, G. Boso, D. Rusca, C. Vulliez, C. Autebert, M. Caloz, M. Perrenoud, G. Gras, F. Bussières, M.-J. Li
et al., “Secure quantum key distribution over 421 km of optical ﬁber,” Physical Review Letters, vol. 121, no. 19,
p. 190502, 2018.

[4] C. Elliott and H. Yeh, “Darpa quantum network testbed,” BBN TECHNOLOGIES CAMBRIDGE MA, Tech.

Rep., 2007.

[5] S.-K. Liao, W.-Q. Cai, W.-Y. Liu, L. Zhang, Y. Li, J.-G. Ren, J. Yin, Q. Shen, Y. Cao, Z.-P. Li et al., “Satellite-to-

ground quantum key distribution,” Nature, vol. 549, no. 7670, pp. 43–47, 2017.

[6] M. Peev, C. Pacher, R. Alléaume, C. Barreiro, J. Bouda, W. Boxleitner, T. Debuisschert, E. Diamanti, M. Dianati,
J. Dynes et al., “The secoqc quantum key distribution network in vienna,” New Journal of Physics, vol. 11, no. 7,
p. 075001, 2009.

[7] S. Pirandola, U. L. Andersen, L. Banchi, M. Berta, D. Bunandar, R. Colbeck, D. Englund, T. Gehring, C. Lupo,
C. Ottaviani et al., “Advances in quantum cryptography,” Advances in Optics and Photonics, vol. 12, no. 4, pp.
1012–1236, 2020.

[8] M. Sasaki, M. Fujiwara, H. Ishizuka, W. Klaus, K. Wakui, M. Takeoka, S. Miki, T. Yamashita, Z. Wang, A. Tanaka
et al., “Field test of quantum key distribution in the tokyo qkd network,” Optics Express, vol. 19, no. 11, pp.
10 387–10 409, 2011.

[9] R. Ursin, F. Tiefenbacher, T. Schmitt-Manderbach, H. Weier, T. Scheidl, M. Lindenthal, B. Blauensteiner, T. Jen-
newein, J. Perdigues, P. Trojek et al., “Entanglement-based quantum communication over 144 km,” Nature Physics,
vol. 3, no. 7, pp. 481–486, 2007.

[10] “Report of the DOE Quantum Internet Blueprint Workshop- “From Long-distance Entanglement to Building a Na-
tionwide Quantum Internet”,” https://www.energy.gov/sites/prod/ﬁles/2020/07/f76/QuantumWkshpRpt20FINAL_
Nav_0.pdf.

[11] “Energy sciences network,” https://www.es.net.

[12] A. Dahlberg, M. Skrzypczyk, T. Coopmans, L. Wubben, F. Rozpundeﬁneddek, M. Pompili, A. Stolk,
P. Pawełczak, R. Knegjens, J. de Oliveira Filho, R. Hanson, and S. Wehner, “A link layer protocol for quantum
networks,” in Proceedings of the ACM Special Interest Group on Data Communication, ser. SIGCOMM
’19. New York, NY, USA: Association for Computing Machinery, 2019, p. 159–173. [Online]. Available:
https://doi.org/10.1145/3341302.3342070

18

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

[13] M. Alshowkan, B. P. Williams, P. G. Evans, N. S. Rao, E. M. Simmerman, H.-H. Lu, N. B. Lingaraju, A. M.
Weiner, C. E. Marvinney, Y.-Y. Pai et al., “A reconﬁgurable quantum local area network over deployed ﬁber,”
arXiv preprint arXiv:2102.13596, 2021.

[14] H. Zang, J. P. Jue, B. Mukherjee et al., “A review of routing and wavelength assignment approaches for wavelength-

routed optical wdm networks,” Optical Networks Magazine, vol. 1, no. 1, pp. 47–60, 2000.

[15] P. Berde, M. Gerola, J. Hart, Y. Higuchi, M. Kobayashi, T. Koide, B. Lantz, B. O’Connor, P. Radoslavov, W. Snow,
and G. Parulkar, “ONOS: Towards an open, distributed SDN OS,” in Proceedings of the Third Workshop on Hot
Topics in Software Deﬁned Networking, ser. HotSDN ’14. New York, NY, USA: ACM, 2014, pp. 1–6. [Online].
Available: http://doi.acm.org/10.1145/2620728.2620744

[16] S. X. Wang, P. Moraw, D. R. Reilly, J. B. Altepeter, and G. S. Kanter, “Fast measurements of
entangled photons,” J. Lightwave Technol., vol. 31, no. 5, pp. 707–714, Mar 2013. [Online]. Available:
http://jlt.osa.org/abstract.cfm?URI=jlt-31-5-707

[17] C. Kupchak, P. J. Bustard, K. Heshami, J. Erskine, M. Spanner, D. G. England, and B. J. Sussman,
“Time-bin-to-polarization conversion of ultrafast photonic qubits,” Phys. Rev. A, vol. 96, p. 053812, Nov 2017.
[Online]. Available: https://link.aps.org/doi/10.1103/PhysRevA.96.053812

[18] R. Valivarthi, S. I. Davis, C. Peña, S. Xie, N. Lauk, L. Narváez, J. P. Allmaras, A. D. Beyer, Y. Gim, M. Hussein
et al., “Teleportation systems toward a quantum internet,” PRX Quantum, vol. 1, no. 2, p. 020317, 2020.

[19] E. Miyazono, T. Zhong, I. Craiciu, J. M. Kindem, and A. Faraon, “Coupling of erbium dopants to yttrium
orthosilicate photonic crystal cavities for on-chip optical quantum memories,” Applied Physics Letters, vol. 108,
no. 1, p. 011111, 2016.

[20] S. Welinski, P. J. Woodburn, N. Lauk, R. L. Cone, C. Simon, P. Goldner, and C. W. Thiel, “Electron
spin coherence in optically excited states of rare-earth ions for microwave to optical quantum transducers,”
Physical Review Letters, vol. 122, no. 24, p. 247401, 2019.

[21] B. Lauritzen, J. Mináˇr, H. De Riedmatten, M. Afzelius, N. Sangouard, C. Simon, and N. Gisin,
“Telecommunication-wavelength solid-state memory at the single photon level,” Physical Review Letters, vol. 104,
no. 8, p. 080502, 2010.

[22] R. Valivarthi, L. Narváez, S. Davis, N. Lauk, C. Peña, P. Allmaras, B. Korzh, A. Mueller, P. Spent-
zouris, N. Sinclair, and M. Spiropulu, “Picosecond synchronization system for quantum networks,”
To be submitted to IEEE Selected Topics in Quantum Electronics, TBD.

[23] M. Zukowski, A. Zeilinger, M. A. Horne, and A. K. Ekert, “" event-ready-detectors" bell experiment via

entanglement swapping.” Physical Review Letters, vol. 71, no. 26, 1993.

[24] C.-K. Hong, Z.-Y. Ou, and L. Mandel, “Measurement of subpicosecond time intervals between two photons by

interference,” Physical Review Letters, vol. 59, no. 18, p. 2044, 1987.

[25] J. M. Thomas, G. S. Kanter, E. M. Eastman, K. F. Lee, and P. Kumar, “Entanglement Distribution in Installed Fiber
with Coexisting Classical Light for Quantum Network Applications,” in Optical Fiber Communication Conference
(OFC) 2022. Optica Publishing Group, 2022, p. Tu3I.3, journal Abbreviation: Optical Fiber Communication
Conference (OFC) 2022. [Online]. Available: http://opg.optica.org/abstract.cfm?URI=OFC-2022-Tu3I.3

[26] T. Chapuran, P. Toliver, N. Peters, J. Jackel, M. Goodman, R. Runser, S. McNown, N. Dallmann, R. Hughes,
K. McCabe et al., “Optical networking for quantum key distribution and quantum communications,” New Journal
of Physics, vol. 11, no. 10, p. 105001, 2009.

[27] P. Eraerds, N. Walenta, M. Legré, N. Gisin, and H. Zbinden, “Quantum key distribution and 1 Gbps data
encryption over a single ﬁbre,” New Journal of Physics, vol. 12, no. 6, p. 063027, Jun. 2010. [Online]. Available:
https://iopscience.iop.org/article/10.1088/1367-2630/12/6/063027

[28] C. Yuan, H. Yu, Z. Zhang, Y. Wang, H. Li, L. You, Y. Wang, H. Song, G. Deng, and Q. Zhou,
“Quantum entanglement distribution coexisting with classical ﬁber communication,” in Asia Communications
and Photonics Conference (ACPC) 2019. Optica Publishing Group, 2019, p. T2F.2. [Online]. Available:
http://opg.optica.org/abstract.cfm?URI=ACPC-2019-T2F.2

[29] L.-J. Wang, L.-K. Chen, L. Ju, M.-L. Xu, Y. Zhao, K. Chen, Z.-B. Chen, T.-Y. Chen, and J.-W. Pan, “Experimental
multiplexing of quantum key distribution with classical optical communication,” Applied Physics Letters, vol.
106, no. 8, p. 081108, Feb. 2015. [Online]. Available: http://aip.scitation.org/doi/10.1063/1.4913483

[30] S. Aleksic, F. Hipp, D. Winkler, A. Poppe, B. Schrenk, and G. Franzl, “Perspectives and limitations of QKD
integration in metropolitan area networks,” Optics Express, vol. 23, no. 8, p. 10359, Apr. 2015. [Online].
Available: https://opg.optica.org/abstract.cfm?URI=oe-23-8-10359

19

Design and Implementation of the Illinois Express Quantum Metropolitan Area Network A PREPRINT

[31] L.-J. Wang, K.-H. Zou, W. Sun, Y. Mao, Y.-X. Zhu, H.-L. Yin, Q. Chen, Y. Zhao, F. Zhang, T.-Y.
Chen, and J.-W. Pan, “Long-distance copropagation of quantum key distribution and terabit classical
optical data channels,” Physical Review A, vol. 95, no. 1, p. 012301, Jan. 2017. [Online]. Available:
https://link.aps.org/doi/10.1103/PhysRevA.95.012301

[32] Y. Mao, B.-X. Wang, C. Zhao, G. Wang, R. Wang, H. Wang, F. Zhou, J. Nie, Q. Chen, Y. Zhao, Q. Zhang,
J. Zhang, T.-Y. Chen, and J.-W. Pan, “Integrating quantum key distribution with classical communications
in backbone ﬁber network,” Optics Express, vol. 26, no. 5, p. 6010, Mar. 2018. [Online]. Available:
https://opg.optica.org/abstract.cfm?URI=oe-26-5-6010

[33] J.-Q. Geng, G.-J. Fan-Yuan, S. Wang, Q.-F. Zhang, Y.-Y. Hu, W. Chen, Z.-Q. Yin, D.-Y. He, G.-C. Guo,
and Z.-F. Han, “Coexistence of quantum key distribution and optical transport network based on standard
single-mode ﬁber at high launch power,” Optics Letters, vol. 46, no. 11, p. 2573, Jun. 2021. [Online]. Available:
https://opg.optica.org/abstract.cfm?URI=ol-46-11-2573

[34] G. B. Xavier, G. Vilela de Faria, G. P. Temporão, and J. P. von der Weid, “Full polarization control for ﬁber
optical quantum communication systems using polarization encoding,” Optics Express, vol. 16, no. 3, p. 1867,
2008. [Online]. Available: https://opg.optica.org/oe/abstract.cfm?uri=oe-16-3-1867

[35] G. B. Xavier, N. Walenta, G. Vilela de Faria, G. P. Temporão, N. Gisin, H. Zbinden, and J. P. von der Weid,
“Experimental polarization encoded quantum key distribution over optical ﬁbres with real-time continuous
birefringence compensation,” New Journal of Physics, vol. 11, no. 4, p. 045015, Apr. 2009. [Online]. Available:
https://iopscience.iop.org/article/10.1088/1367-2630/11/4/045015

[36] S. Arahira, N. Namekata, T. Kishimoto, H. Yaegashi, and S. Inoue, “Generation of polarization entangled photon
pairs at telecommunication wavelength using cascaded χ (2) processes in a periodically poled LiNbO3 ridge
waveguide,” Optics Express, vol. 19, no. 17, pp. 16 032–16 043, 2011.

[37] X. Li, P. L. Voss, J. E. Sharping, and P. Kumar, “Optical-Fiber Source of Polarization-Entangled Photons in the
1550 nm Telecom Band,” Physical Review Letters, vol. 94, no. 5, p. 053601, Feb. 2005. [Online]. Available:
https://link.aps.org/doi/10.1103/PhysRevLett.94.053601

[38] S. Wang and G. S. Kanter, “Robust multiwavelength all-ﬁber source of polarization-entangled photons with built-in
analyzer alignment signal,” IEEE Journal of Selected Topics in Quantum Electronics, vol. 15, pp. 1733–1740,
2009.

20

