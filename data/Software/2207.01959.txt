2
2
0
2

l
u
J

5

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
9
5
9
1
0
.
7
0
2
2
:
v
i
X
r
a

MNRAS 000, 1–18 (2019)

Preprint 6 July 2022

Compiled using MNRAS LATEX style ﬁle v3.0

Determining AGN luminosity histories using present-day outﬂow
properties: a neural-network based approach

Kastytis Zubovas1,2,★, Jonas Bialopetravičius2, Monika Kazlauskait˙e2
1Center for Physical Sciences and Technology, Saul˙etekio al. 3, Vilnius LT-10257, Lithuania
2Astronomical Observatory, Vilnius University, Saul˙etekio al. 3, Vilnius LT-10257, Lithuania
★ E-mail: kastytis.zubovas@ftmc.lt

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
Large-scale outﬂows driven by active galactic nuclei (AGN) can have a profound inﬂuence on
their host galaxies. The outﬂow properties themselves depend sensitively on the history of AGN
energy injection during the lifetime of the outﬂow. Most observed outﬂows have dynamical
timescales longer than the typical AGN episode duration, i.e. they have been inﬂated by
multiple AGN episodes. Here, we present a neural-network based approach to inferring the
most likely duty cycle and other properties of AGN based on the observable properties of their
massive outﬂows. Our model recovers the AGN parameters of simulated outﬂows with typical
errors < 25%. We apply the method to a sample of 59 real molecular outﬂows and show that
a large fraction of them have been inﬂated by AGN shining with a rather high duty cycle
𝛿AGN > 0.2. This result suggests that nuclear activity in galaxies is clustered hierarchically in
time, with long phases of more frequent activity composed of many short activity episodes. We
predict that ∼ 19% of galaxies should have AGN-driven outﬂows, but half of them are fossils -
this is consistent with currently available data. We discuss the possibilities to investigate AGN
luminosity histories during outﬂow lifetimes and suggest ways to use our software to test other
physical models of AGN outﬂows. The source code of all of the software used here is made
public.

Key words: accretion, accretion discs — quasars:general — galaxies:active

1

INTRODUCTION

Supermassive black holes (SMBHs) exist in the majority of galaxies,
at least down to stellar masses 𝑀∗ ∼ 1010 M(cid:12) (Heckman & Best
2014; Greene et al. 2020; Reines 2022). For a few percent of its
lifetime (Wang et al. 2006), each SMBH powers an active galactic
nucleus (AGN) by rapidly accreting material. These brief episodes
are instrumental in regulating the star formation history of the host
galaxies and producing the high-mass cutoﬀ in the galaxy mass
function, as shown in many semi-analytical (e.g., Bower et al. 2006;
Croton et al. 2006) and hydrodynamical simulations that test the
eﬀects of AGN feedback (e.g., Sĳacki et al. 2007; Puchwein &
Springel 2013; Dubois et al. 2014; Vogelsberger et al. 2014; Schaye
et al. 2015; Tremmel et al. 2019).

Numerous AGN host galaxies show evidence of powerful mas-
sive outﬂows (e.g. Feruglio et al. 2010; Sturm et al. 2011; Rupke &
Veilleux 2011; Cicone et al. 2014; Rupke et al. 2017; Fiore et al.
2017; Fluetsch et al. 2019). These outﬂows are likely driven by the
AGN, as evidenced by their momentum and energy rates correlat-
ing well with the AGN luminosity (Cicone et al. 2014; Fiore et al.
2017; Fluetsch et al. 2019). Indeed, in a few galaxies, outﬂows have
been discovered simultaneously with smaller scale winds emanating
from AGN (Tombesi et al. 2015; Bischetti et al. 2019; Marasco et al.

© 2019 The Authors

2020), strengthening the interpretation that the two processes are
connected and providing a pathway to connect the AGN radiative
output to the dynamics of the host galaxy gas.

The most successful theoretical model of AGN feedback is
based on wind-driven outﬂows (see King & Pounds 2015, for a
review). Radiation emitted by the accretion disc and the SMBH
corona drives a quasi-relativistic wind with velocity 𝑣w ∼ 0.1𝑐,
which shocks against the surrounding gas and creates a hot bubble
in the centre of the galaxy. The bubble typically cools ineﬃciently,
resulting in adiabatic expansion of the shocked interstellar medium
(ISM). The expanding bubble forms an energy-driven outﬂow, with
1, close to the
predicted kinetic energy rate (cid:164)𝐸out ∼− 0.02 − 0.03𝐿AGN
observational estimate. The momentum rate of the outﬂow is also
close to the observed (cid:164)𝑝out ∼− 20𝐿AGN/𝑐.

Despite the apparent success of this model, many questions re-
main unanswered. In particular, the ratio of the outﬂow energy rate
and AGN luminosity, as well as the corresponding momentum rate

1 Note that this is lower than the often-quoted factor 0.05; this latter factor
is the fraction of AGN luminosity transferred to the gas in the energy-driven
outﬂow, but some of that energy is used up to do work against gravity and
𝑝d𝑉 work, with the remainder going into the kinetic energy of the gas.

 
 
 
 
 
 
2

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

ratio, exhibit a large scatter around the analytically predicted val-
ues (Marasco et al. 2020). A promising explanation is that outﬂow
properties change on a longer timescale than AGN luminosity, so
that the outﬂow correlates better with the long-term average AGN
luminosity, which might diﬀer signiﬁcantly from its instantaneous
value (Zubovas & Nardini 2020). By making reasonable assump-
tions regarding the evolution of the AGN luminosity during a sin-
gle episode, it is possible to reproduce both the observed outﬂow
properties and the instantaneous AGN luminosity simultaneously.
However, relaxing the assumption of a constant AGN luminosity
introduces a number of free parameters into the model. This makes
ﬁtting individual outﬂows a time-consuming process.

In this paper, we develop a diﬀerent approach to connecting
AGN-driven outﬂow properties with AGN luminosity histories. We
create an artiﬁcial neural network and train it using a large sample
of simulated spherically-symmetric outﬂows. The network takes in
ﬁve input parameters that require few model-dependent assump-
tions: AGN luminosity, black hole mass, outﬂow radius, velocity
and mass outﬂow rate. Using these, the network is able to determine
the AGN duty cycle over the lifetime of the outﬂow, the duration
of an individual AGN episode, the likely gas fraction in the host
galaxy bulge, the total bulge mass and the fraction of solid angle
subtended by the outﬂow. The typical uncertainties are ∼ 20 − 25%;
this number includes both the eﬀect of observational errors and
neural network prediction errors. We apply the network to a sam-
ple of 59 real molecular outﬂows in 46 galaxies, and ﬁnd that the
predicted AGN parameters, when applied to our outﬂow simulation
tool, reproduce the observed outﬂow properties very well. We show
that galaxies with brighter AGN tend to have higher duty cycles,
while the other inferred parameters cover a wide range of possi-
bilities. Most duty cycles are higher than the long-term population
average for AGN, and signiﬁcantly higher than the population aver-
age for low-redshift AGN. This result suggests that nuclear activity
in galaxies is clustered hierarchically in time, with long phases of
more frequent activity composed of many short activity episodes.
This clustering explains why instantaneous evidence of AGN feed-
back is generally not observed. We predict that ∼ 19% of galaxies
should show evidence of AGN-driven outﬂows, with roughly half
of them being fossil outﬂows; this fraction is consistent with avail-
able observational data. We also suggest that powerful molecular
outﬂows should coincide with weak ionised ones and vice versa. We
discuss other implications of our results in terms of investigating
individual galaxy activity histories and present the possibilities of
applying the tools developed here to testing other physical models
of AGN feedback.

The paper is structured as follows. In Section 2, we present
the physical basis of the wind-driven outﬂow model and the recent
extension allowing for signiﬁcant AGN luminosity variation. In
Section 3, we present the numerical scheme used to generate model
outﬂows for neural network training and testing. In Section 4, we
describe the neural network and present its testing results, including
the eﬀects of observational uncertainties in the input parameters. In
Section 5, we apply the neural network to the sample of 59 real
outﬂows that have been analysed in Zubovas & Nardini (2020),
deriving the likely properties of the recent activity histories of their
host galaxies. Finally, we discuss our ﬁndings, both in terms of
outﬂow physics and code performance, in Section 6 and conclude
in Section 7.

AGN OutFlow Investigation Tool), used to produce the results of
this paper is made publicly available2.

2 PHYSICS OF AGN WIND-DRIVEN OUTFLOWS

The AGN wind-driven outﬂow model was ﬁrst proposed by King
(2003) and signiﬁcantly developed in King (2010a) and Zubovas
& King (2012b). The basis of the connection between AGN lu-
minosity and the wider galactic environment is the wide-angle
quasi-relativistic wind, launched from the accretion disc (King &
Pounds 2003; Nardini et al. 2015). The wind is accelerated by
the AGN radiation ﬁeld, with photons typically scattering once
before escaping (King 2010b). Thus the wind gains a momen-
tum rate (cid:164)𝑝w ≡ (cid:164)𝑀w𝑣w = 𝐿AGN/𝑐. Assuming that the wind mass
ﬂow rate is similar to the black hole accretion rate, the wind
velocity is 𝑣w ∼− 𝜂𝑐 ∼ 0.1𝑐, where 𝜂 ∼ 0.1 is the radiative
eﬃciency of accretion. The kinetic power of the wind is then
(cid:164)𝐸w ∼− 𝜂𝐿AGN/2 ∼ 0.05𝐿AGN. These values are consistent with
those of observed quasi-relativistic small scale ﬂows, known as
ultra-fast outﬂows (Reeves et al. 2003; Tombesi et al. 2010a,b; Igo
et al. 2020).

The wind shocks against the surrounding ISM and heats up to
temperatures of order 𝑇sh ∼ 1010 K. At this temperature, the only
eﬃcient cooling process is inverse Compton cooling against the
AGN radiation ﬁeld. Assuming that the shocked wind is a single-
temperature plasma, cooling is eﬃcient in the central few hundred
parsecs and only the wind momentum gets transferred to the ISM
(King 2003). When the SMBH mass grows large enough, its wind
momentum can overcome the weight of the gas and shut oﬀ fur-
ther SMBH growth, establishing the 𝑀 − 𝜎 relation (King 2003;
Murray et al. 2005; King 2010a). Once the outﬂow reaches a dis-
tance where inverse Compton cooling becomes ineﬃcient, a more
powerful energy-driven outﬂow develops that can sweep gas out
of the galaxy, quenching further star formation (Zubovas & King
2012b). A large-scale outﬂow can also develop in a multiphase ISM
if we treat the shocked wind as a two-temperature plasma; in this
case, inverse Compton cooling is much less eﬃcient and large-scale
outﬂows occur from the very centre (Faucher-Giguère & Quataert
2012). The 𝑀 − 𝜎 relation in this situation is established by the
AGN wind momentum acting on individual dense clouds, since
most of the shocked wind energy escapes via low-density channels
(Zubovas & Nayakshin 2014).

The predicted properties of large-scale energy-driven outﬂows
agree quite well with the observed ones (Cicone et al. 2014; Fiore
et al. 2017; González-Alfonso et al. 2017; Fluetsch et al. 2019;
Lutz et al. 2020). However, analytical treatment of the problem
is only possible for a few idealised cases, limiting the variety of
galaxy properties and AGN luminosity histories that can be ex-
plored. In particular, the equation of motion for the outﬂow can
only be solved analytically for constant-luminosity AGN producing
spherically-symmetric outﬂows in an isothermal gas distribution
and isothermal gravitational potential. Here, while driven, the out-
ﬂow quickly reaches a quasi-steady state, with constant velocity
𝑣out ∼ 1000km s−1 and a mass outﬂow rate (cid:164)𝑀out that can reach
more than several hundred M(cid:12) yr−1. This leads to the momentum
loading factor quoted above (King 2005). Once the AGN switches
oﬀ, the outﬂow reacts slowly and only stalls after a period up to

The software package, which we call MAGNOFIT (Massive

2 https://www.github.com/zadrras/magnofit

MNRAS 000, 1–18 (2019)

an order of magnitude longer than the duration of the AGN phase
(King et al. 2011).

A more realistic density distribution in the galaxy is the
Navarro-Frenk-White (NFW) proﬁle (Navarro et al. 1997). Nu-
merical calculations show that the outﬂow evolution depends only
slightly on the assumed density distribution, except for the velocity
being non-constant when using an NFW proﬁle (Zubovas & King
2012a; McQuillin & McLaughlin 2013). Variation of the AGN lu-
minosity also aﬀects outﬂow propagation. A single AGN episode is
expected to last no more than 𝑡ep ∼ a few times 105 yr (Schawinski
et al. 2015; King & Nixon 2015). During this time, the outﬂow can
be inﬂated only to a radius 𝑅out ∼ 𝑣out𝑡ep ∼ a few ×100 pc. There-
fore, only outﬂows very close to the nucleus have been inﬂated by
the AGN episode that is currently observed, while those further out
have been pushed by multiple episodes and their properties should
correlate better with the long-term average luminosity (Zubovas &
Nardini 2020). Unfortunately, determining the actual evolution of
the outﬂow pushed by non-continuous AGN energy input requires
the addition of several free parameters to the model: the maximum
AGN luminosity, the duration of each episode, the shape of the
light curve 𝐿AGN (𝑡) and the duty cycle. These values might be
diﬀerent for each individual galaxy, making their determination dif-
ﬁcult and time consuming. On the other hand, identifying the most
likely parameters of AGN luminosity variation over the lifetime of
the outﬂow can provide signiﬁcant insights into the co-evolution of
individual galaxies and their SMBHs on million-year timescales,
which are inaccessible to other types of investigation.

3 GENERATION OF MODEL OUTFLOWS

3.1 Numerical scheme

We simulate outﬂows for neural network training and testing by
using a 1D spherically symmetric outﬂow propagation model. The
ﬁrst iteration of this model was used in King et al. (2011) and a
detailed description of its workings is presented in Zubovas & King
(2016). Zubovas & King (2019) updated the code to allow tracking
and outﬂow with an arbitrary adiabatic index 𝛾. Here, we present
the basics of the model following that paper, and give a detailed
derivation of the equation of motion in Appendix A.

The core of the model is a numerical integration scheme
that follows the evolution of an outﬂow expanding in an arbi-
trary spherically-symmetric gas distribution and background grav-
itational potential. The only requirements for the gas and potential-
generating mass distributions, speciﬁed as 𝑀 (< 𝑅) and 𝑀pot (< 𝑅)
respectively, are that the ﬁrst and second radial derivatives of the
enclosed mass, 𝜕 𝑀 (< 𝑅) /𝜕𝑅 and 𝜕2 𝑀 (< 𝑅) /𝜕𝑅2, can be ex-
pressed analytically. We also assume that the energy injected into
the outﬂow is conﬁned within a narrow region just outside the con-
tact discontinuity, so that we can treat the outﬂow as having a single
radial coordinate; this assumption is correct as long as the inter-
stellar medium shocked by the outﬂow cools rapidly, as seems to
be the case (Zubovas & King 2014; Richings & Faucher-Giguère
2018a,b). Inside the contact discontinuity, conversely, we assume
that the shocked wind is completely adiabatic; at the shock tem-
peratures of order 1010 K, the applicable cooling processes are
ineﬃcient at the distances beyond a few parsecs (Faucher-Giguère
& Quataert 2012). This means that all of the injected energy goes
into driving the outﬂow. The equation of motion in this case is

d
d𝑡

(cid:0)𝑀 (cid:164)𝑅(cid:1) = 4𝜋𝑅2𝑃 −

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

,

(1)

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

3

where 𝑃 is the pressure of the shocked wind bubble. We omit the
(< 𝑅) notation for brevity. We also use the energy equation

d
d𝑡

(cid:19)

(cid:18) 𝑃𝑉
𝛾 − 1

𝜂
2

=

𝐿AGN − 𝑃

d𝑉
d𝑡

−

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

(cid:164)𝑅,

(2)

where the left-hand side speciﬁes the enthalpy of the outﬂowing gas,
and the right-hand terms are the driving luminosity, 𝑃d𝑉 work and
work against gravity, respectively. We can use eq. (1) to eliminate
𝑃 from eq. (2); after expanding the derivatives and rearranging, we
ﬁnally obtain the numerically integrable equation of motion3:

(cid:168)𝑅 =

3 (𝛾 − 1)
𝑀 𝑅

(cid:16) 𝜂
2

𝐿AGN − 𝐴

(cid:17)

− 𝐵,

where

𝐴 = (cid:164)𝑀 (cid:164)𝑅2 + 𝑀 (cid:164)𝑅 (cid:165)𝑅 +

(cid:18)

𝑀

2𝐺 (cid:164)𝑅
𝑅2

𝑀pot +

(cid:19)

𝑀
2

and

𝐵 =

(cid:165)𝑀 (cid:164)𝑅
𝑀

(cid:164)𝑀 (cid:164)𝑅2
+
𝑀 𝑅
(cid:34) 𝑀pot (cid:164)𝑀
𝑀

2 (cid:164)𝑀 (cid:165)𝑅
𝑀

+

+

(cid:164)𝑅 (cid:165)𝑅
𝑅

+

+ (cid:164)𝑀 + (cid:164)𝑀pot −

(cid:18)

𝑀pot +

(cid:35)

.

𝑀
2

(cid:19) (cid:164)𝑅
𝑅

+

𝐺
𝑅2

(3)

(4)

(5)

The time derivatives of mass terms are deﬁned as (cid:164)𝑀 ≡ (cid:164)𝑅𝜕 𝑀/𝜕𝑅
and (cid:165)𝑀 ≡ (cid:165)𝑅𝜕𝑀/𝜕𝑅 + (cid:164)𝑅2𝜕2 𝑀/𝜕𝑅2.

3.2 Initial conditions

The model galaxy consists of two extended components - a halo and
a bulge, and an AGN in the centre driving the outﬂow. Below, we
describe the parameters governing this behaviour and the ranges of
values used in the models generating the outﬂows for neural network
training and testing. All the parameters, their brief descriptions,
value ranges and/or deﬁning equations are summarized in Table 1.

3.2.1 Galaxy parameters

The mass distribution in the galaxy is speciﬁed by ten parameters:
ﬁve for the halo, four for the bulge and one for the SMBH. The
halo parameters are its total mass 𝑀tot,h, the virial radius 𝑅vir,
the density proﬁle, the concentration 𝑐 = 𝑅vir/𝑅s (where 𝑅s is
the scale length) and the gas fraction 𝑓g,h ≡ 𝑀gas,h/𝑀tot,h. In all
model galaxies, we use an NFW (Navarro et al. 1997) density proﬁle
with concentration 𝑐 = 10. We determine 𝑀tot,h in the following
manner. First, we choose the total galaxy mass 𝑀tot from the range
1012M(cid:12) − 1014M(cid:12), sampled uniformly in logarithmic space. Then,
once the bulge mass 𝑀tot,b is chosen (see below), we calculate
𝑀tot,h = 𝑀tot − 𝑀tot,b. Then we apply the usual deﬁnition of the
virial radius

𝑅vir =

(cid:18) 3𝑀tot,h
4𝜋𝜌crΔvir

(cid:19)1/3

,

(6)

where 𝜌cr = 3𝐻2/(8𝜋𝐺) is the critical density of the Universe, 𝐻 is
the Hubble parameter, and Δvir is the virial overdensity (cf. Bryan
& Norman 1998)

Δvir ∼−

18𝜋2 − 121 + 160Ωm − 39Ω2
m
Ωm

∼− 103.2,

(7)

3 Note that in Zubovas & King (2019), the corresponding equation of motion
had a notation error where we wrote 𝜂 instead of 𝜂/2, and a derivation error
where the ‘𝐴’ term had an extra factor; the eﬀect of this latter error was to
increase the calculated outﬂow velocities by ∼ 5%.

4

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

Parameter
𝑀tot
𝑀tot,h
𝑅vir
Halo proﬁle
𝑐
𝑓g,h
𝑀tot,b
𝑅bulge
Bulge proﬁle
𝑓g,b
𝑀BH
Luminosity proﬁle
𝐿0
𝐿shut
𝑡ep
𝛿AGN
𝑡rep
𝑏out

Description
Total virial mass of the galaxy
Mass of the halo component
Halo virial radius
Density proﬁle of the halo component
Halo concentration parameter 𝑐 ≡ 𝑅vir/𝑅s
Halo gas fraction
Mass of the bulge component
Bulge radius
Density proﬁle of the bulge component
Bulge gas fraction
SMBH mass
Time dependence of AGN luminosity
Initial luminosity in each AGN episode
Luminosity at which the AGN is considered shut oﬀ
Duration of one full AGN episode from 𝐿0 to 𝐿shut
AGN duty cycle
AGN episode repetition timescale
Fraction of solid angle subtended by the outﬂow cone

Range
1012 − 1014M(cid:12)
∼ 1012 − 1014M(cid:12)
290 − 1300 kpc
NFW
10
10−3
∼ 5 × 108 − 7 × 1012 M(cid:12)
∼ 0.1 − 90 kpc
Isothermal
0.003 − 0.3
∼ 1.5 × 106 − 1.5 × 1010 M(cid:12)
Extended power-law
𝐿Edd
0.01𝐿Edd
0.01 − 0.3 Myr
0.04 − 1.0
0.01 − 7.5 Myr
0.05 − 1

Deﬁning equation and/or reference
-
𝑀tot − 𝑀tot,b
eq. 6
Navarro et al. (1997)
Navarro et al. (1997)
-
eq. 9; McConnell & Ma (2013)
eq. 11
-
-
eq. 8; Bandara et al. (2009)
eq. 12; King & Pringle (2007)
-
Best & Heckman (2012); Sądowski et al. (2013)
King & Nixon (2015); Schawinski et al. (2015)
-
𝑡ep/ 𝛿AGN
-

Table 1. Parameters of the outﬂow generator model.

where Ωm is the fractional density of matter in the Universe and
we use the current best-ﬁt value Ωm = 0.315 (Planck Collaboration
et al. 2020) to derive the ﬁnal value. In general, both Ωm and 𝐻
depend on redshift, but here we consider only local galaxies where
these corrections are negligible. We ﬁx the gas fraction in the halo
at a low value 𝑓g,h = 10−3. The precise values of the halo shape
parameters have only a small eﬀect on the outﬂow propagation, since
the bulge component dominates the potential gradient within 𝑅bulge.
This eﬀectively leaves only one free parameter, 𝑀tot,h, deﬁning the
halo mass distribution.

The SMBH mass is related to the virial mass according to the

correlation given in Bandara et al. (2009):

log

(cid:19)

(cid:18) 𝑀BH
M(cid:12)

= (8.18 ± 0.11) + (1.55 ± 0.31) log

(cid:19)

(cid:18) 𝑀tot
1013 M(cid:12)

.

(8)

We choose the SMBH mass using the above relation, by taking the
average value of the slope and uniformly sampling the value of the
intercept within the uncertainties. The black hole has a negligible
extent, so its mass is simply added to all the 𝑀pot terms in eq. 3.

The bulge is deﬁned by four parameters: mass 𝑀tot,b, radius
𝑅b, density proﬁle and gas fraction 𝑓g,b ≡ 𝑀gas,b/𝑀tot,b. We always
use isothermal density distributions. We experimented with relax-
ing this assumption and using a power-law distribution 𝜌b ∝ 𝑅−𝛾
with an arbitrary exponent 1.9 < 𝛾 < 2.2, based on observational
constraints (Shankar et al. 2017). This change had a negligible eﬀect
on our results. The bulge mass is determined by the chosen SMBH
mass using the relationship from McConnell & Ma (2013):

log

(cid:19)

(cid:18) 𝑀BH
M(cid:12)

= (8.46 ± 0.08) + (1.05 ± 0.11) log

(cid:19)

(cid:18) 𝑀tot,b
1011 M(cid:12)

.

(9)

We also sample the 𝑀 − 𝜎 relation (McConnell & Ma 2013) to get
the bulge velocity dispersion:

log

(cid:19)

(cid:18) 𝑀BH
M(cid:12)

= (8.32 ± 0.05) + (5.64 ± 0.32) log

(cid:18)

𝜎b
200kms−1

(cid:19)

.

(10)

These relations are sampled in the same way as the SMBH mass -

total mass relation (eq. 8). Then the bulge radius is given by

𝑅bulge =

𝐺 𝑀tot,b
2𝜎2
b

.

(11)

The bulge gas fraction is sampled uniformly randomly from a range
0.001 < 𝑓g,b < 0.3.

3.2.2 AGN luminosity evolution

We allow the AGN luminosity to vary with time. Based on the results
of Zubovas (2018), who found that an extended power-law decay
proﬁle produces the best correlations between outﬂow properties
and AGN luminosity, we utilize only this prescription. It is based
on the solutions to thin disc equations (King & Pringle 2007):

𝐿AGN = 𝐿0

(cid:18)

1 +

𝑡 mod 𝑡rep
𝑡q

(cid:19)−19/16

.

(12)

This prescription has three parameters: initial AGN luminos-
ity 𝐿0, characteristic luminosity change timescale 𝑡q and episode
repetition timescale 𝑡rep. In all simulations, we choose 𝐿0 = 𝐿Edd =
4𝜋𝐺 𝑀BH𝑐/𝜅 ∼− 1.44 × 1038 erg s−1, where 𝜅 ∼− 0.346 g cm−2 is the
electron scattering opacity. We switch oﬀ the driving of the outﬂow
once the AGN luminosity drops below a value 𝐿shut = 0.01𝐿Edd, the
approximate luminosity when the accretion ﬂow transitions from a
radiatively eﬃcient thin disc to an advection-dominated ﬂow (Best
& Heckman 2012; Sądowski et al. 2013). This allows us to deﬁne a
duration of an AGN episode, 𝑡ep, as the time between the switching
on and switching oﬀ of the AGN. For this luminosity prescription,
we have 𝑡ep ∼− 47𝑡q; we use this expression to deﬁne 𝑡q after choos-
ing a value for 𝑡ep. We also deﬁne an AGN duty cycle 𝛿AGN - the
fraction of time for which the AGN is active - and use it to determine
the repetition timescale: 𝑡rep ≡ 𝑡ep/𝛿AGN.

With these deﬁnitions, the free parameters deﬁning the AGN
luminosity evolution are 𝑡ep and 𝛿AGN. We sample 𝑡ep uniformly
from a logarithmic distribution 4 < log (cid:0)𝑡eq/yr(cid:1) < 5.5. The duty
cycle is sampled uniformly from a range 0.04 < 𝛿AGN < 1.0.

MNRAS 000, 1–18 (2019)

3.2.3 Outﬂow geometry

Although our numerical model is implicitly spherically symmet-
ric, real outﬂows generally aren’t. Instead, their geometry is usually
conical (e.g., Crenshaw et al. 2010; Husemann et al. 2016; Pereira-
Santaella et al. 2016; Venturi et al. 2018; Shin et al. 2019), with
an opening angle that can vary from as low as ∼ 30 deg (Pereira-
Santaella et al. 2016) to > 100 deg (Nardini et al. 2015). This situa-
tion mainly aﬀects the total mass outﬂow rate, although collimation
can also lead to the outﬂows being faster (Zubovas & Nayakshin
2014). Furthermore, the gas in the galaxy spheroid has uneven
density; this leads to more diﬀuse gas being pushed away faster
(Zubovas & Nayakshin 2014) and possibly unable to cool and form
molecules (Richings & Faucher-Giguère 2018a,b), while the dens-
est clouds may be completely unaﬀected by the outﬂow (Zubovas &
King 2014). In order to account for these uncertainties, we add one
more free parameter: 𝑏out, the fraction of full solid angle subtended
by the outﬂow, as seen from the SMBH. It should be understood that
this solid angle may be composed of multiple disjoint components.
The parameter values are sampled uniformly randomly from the
range 0.05 < 𝑏out < 1.

3.3 Numerical outﬂow evolution

Once all the model parameters are chosen, the outﬂow equation
of motion (eq. 3) is integrated with a simple Eulerian integrator4.
Outﬂow evolution is insensitive to the precise values of initial out-
ﬂow radius, velocity and acceleration; we use 𝑅0 = 0.001 kpc,
(cid:164)𝑅0 = 100km s−1 and (cid:165)𝑅0 = 0. The timestep of integration is chosen
using a Courant-like condition:

Δ𝑡 = 𝐶CFL × min

(cid:26) 𝑅
(cid:164)𝑅

,

(cid:164)𝑅
(cid:165)𝑅

,

(cid:165)𝑅
(cid:168)𝑅

(cid:27)

,

(13)

where 𝐶CFL = 0.02 is the Courant factor (Courant et al. 1928).
Furthermore, whenever a new AGN episode begins, we adjust the
timestep so that its boundary coincides exactly with the beginning
of the AGN episode; this ensures that no injected energy is lost to
numerical eﬀects.

The observable parameters of the outﬂow are deﬁned as fol-

lows. The outﬂow velocity is

𝑣out ≡ (cid:164)𝑅 ≡

∬

(cid:168)𝑅d𝑡d𝑡.

The outﬂow radius is

𝑅out ≡ 𝑅 ≡

∫

(cid:164)𝑅d𝑡.

(14)

(15)

The mass outﬂow rate is deﬁned in a way similar to how it is usually
done when analysing observations:

(cid:164)𝑀out ≡ 𝑀out

𝑣out
𝑅out

,

(16)

where 𝑀out is the total ‘available’ gas mass contained within 𝑅out.
It is deﬁned as

𝑀out (< 𝑅) ≡ 𝑏out

(cid:16)

𝑓g,h 𝑀tot,h (< 𝑅) + 𝑓g,b 𝑀tot,b (< 𝑅)

(cid:17)

.

(17)

The code keeps track of outﬂow radius, velocity and mass
outﬂow rate with time, as well as the current value of the AGN
luminosity. The other interesting parameters are easily derived from

4 More complicated integration schemes produce identical results (Zubovas
& King 2016)

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

5

these. In particular, the momentum and energy rates of the outﬂow
are

(cid:164)𝑝out ≡ (cid:164)𝑀out𝑣out

and

(cid:164)𝐸out ≡

(cid:164)𝑀out𝑣2
out
2

.

(18)

(19)

4 NEURAL NETWORK

Generating realistic AGN outﬂow properties when given a partic-
ular luminosity history is a simple task, as described above. We
are interested in solving the inverse problem: determining the prop-
erties of the luminosity history given the observable properties of
the outﬂow and the AGN. The most straightforward approach is to
populate the space of observable outﬂow parameters with data of
simulated outﬂows, then “read oﬀ” the desired simulation parame-
ters that produce observable outﬂow properties close to those of real
outﬂows. Unfortunately, this does not work, since almost any given
combination of observable properties can be produced by a large
variety of parameter combinations. We show this in more detail in
Appendix B.

As a result, we seek a solution using a neural network. We
present the details of the network architecture in Section 4.1, its
training scheme and test results in Section 6.5 and investigate the
eﬀect of observational errors on the results in Section 4.3.

4.1 Description of the neural network

The network we use is a multilayer perceptron (MLP), a type of
feedforward artiﬁcial neural network with a nonlinear activation
function; we refer the reader to Haykin (2009) for more details
about this particular neural network. Our MLP is composed of an
input layer, two hidden layers and an output layer. The hidden layers
contain 128 neurons each, while the input and output layers each
have ﬁve nodes, which correspond to the parameters of outﬂows and
their driving AGN (see below). We use the Exponential Linear Unit
(Clevert et al. 2015) as the activation function for the hidden layers.
The mean squared error loss function and the Adam (Kingma &
Ba 2014) optimizer are used for training the network. The MLP is
trained for 12 epochs. The initial learning rate is 0.001; after the 4th
and 8th learning epochs, it is reduced by a factor of 10. All of the
hyperparameters mentioned above were chosen by trial and error
to produce the best test results. Training the neural network takes
under 12 minutes on an AMD Ryzen 7 3800X processor.

The neural network takes in ﬁve inputs, corresponding to the
observable parameters of outﬂows and their driving AGN: outﬂow
radius 𝑅out, outﬂow velocity 𝑣out, mass outﬂow rate (cid:164)𝑀out, AGN
luminosity 𝐿AGN and SMBH mass 𝑀SMBH. All of these quantities
can be robustly derived from observational data and require the
least amount of model-dependent assumptions. Using only a subset
of these parameters results in signiﬁcantly poorer constraints on
the AGN luminosity history. The network produces predictions of
ﬁve parameters: AGN duty cycle 𝛿AGN, single episode duration 𝑡ep,
outﬂow solid angle fraction 𝑏out, host galaxy bulge gas fraction 𝑓g,b
and bulge total mass 𝑀tot,b. This way, our data loses any explicit
dependence on time - this is important because the age of the outﬂow
is not generally known.

Each input and output parameter is converted to logarithmic
scale. Since many parameters have ranges encompassing more than
one order of magnitude, this leads to a much more even weighting

6

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

of the diﬀerent parameters and a much better testing result. Fur-
thermore, in order to avoid unintended weighting of parameters, the
training data is normalised so that the distribution of each parameter
has a mean of zero and a standard deviation of one.

4.2 Neural network training and testing
We generate a sample of 5 × 104 outﬂows; this takes ∼ 2.25 hours
on 16 cores of an AMD Ryzen 7 3800X CPU. Approximately 1.5%
of the generated outﬂows ‘fail’ in the sense that the outﬂow never
expands beyond 20 pc from the nucleus; we remove these from
further consideration. From each outﬂow, we randomly sample 200
data points with 𝑅out > 0.02 kpc, representing the outﬂow state at
diﬀerent times. The total data sample contains ∼ 107 data points.
We then randomly choose 80% of outﬂows (∼ 8 × 106 data points)
to create a training sample, while the rest (∼ 2 × 106 data points)
form a testing sample.

∼ 𝑣out

∼ 𝐿AGN

Figure 1 showcases the range of simulated outﬂow parame-
ters5: AGN luminosity (horizontal axis in all panels), outﬂow veloc-
ity (top panel), mass outﬂow rate (middle panel) and outﬂow kinetic
energy rate (bottom panel). We show only 104 randomly selected
data points for clarity. The AGN luminosity values encompass the
range 1042 erg s−1 <
∼ 1048 erg s−1, in line with essentially
<
all AGN with detected outﬂows (e.g., González-Alfonso et al. 2017;
Fiore et al. 2017; Fluetsch et al. 2019, ; also see Table 2 below). Most
∼ 800 km s−1,
outﬂow velocities fall in the range 30 km s−1 <
<
again in agreement with most observed outﬂows. Mass outﬂow
rates (middle panel) mostly range between 10 M(cid:12)yr−1 < (cid:164)𝑀out <
2×103 M(cid:12)yr−1, while the kinetic energy rates (bottom panel) range
between 2 × 1039 erg s−1 <
∼ 2 × 1044 erg s−1. The two denser
<
diagonal bands in the (cid:164)𝑀out and (cid:164)𝐸out plots correspond to outﬂows
that are just beginning to expand and outﬂows that have been inﬂated
by multiple AGN episodes. Outﬂows that are just starting tend to
have higher mass outﬂow and energy rates for a given AGN lumi-
nosity, because they have received a continuous energy input over
their (relatively short) lifetimes. Conversely, outﬂows that have been
inﬂated by multiple episodes have experienced coasting periods and
so have lower mass outﬂow and energy rates. We also see that out-
ﬂows in the ﬁrst group follow the line (cid:164)𝐸out ∼− 0.01𝐿AGN, close to
the prediction by analytical estimates of constant-luminosity AGN.
Finally, there are some outﬂows with kinetic energy rates far higher
than predicted analytically, with a few even showing (cid:164)𝐸out (cid:38) 𝐿AGN.
These outﬂows are coasting after the AGN driving has switched oﬀ,
mostly for the ﬁrst time.

∼ (cid:164)𝐸out

The results of neural network testing are shown in Figure 2.
Each of the four histograms shows how well the network recovers
one of the four parameters of interest: 𝛿AGN (top left), 𝑡ep (top
right), 𝑏out (bottom left) and 𝑓g,b (bottom right); we don’t show
𝑀bulge because, as explained below, it is mainly determined by
the SMBH mass and is less important for the determination of
outﬂow properties. The red dashed line represents perfect agreement
between inferred (vertical axis) and true (horizontal axis) values.
We see that the neural network recovers 𝛿AGN and 𝑏out quite well,
with no systematic oﬀset throughout most of the range; only the
highest values of 𝛿AGN and 𝑏out are very slightly underpredicted.
The scatter around the true value is ±0.14 throughout most of the
range for both parameters.

The other two quantities show some systematic oﬀsets in their
recovered values. Lower true values of 𝑡ep, below ∼ 1.5 × 105 yr,

5 All ﬁgures are made using the Matplotlib Python package (Hunter 2007).

Figure 1. Properties of simulated outﬂows. Each point represents a sin-
gle snapshot of an evolving outﬂow. Only 104 randomly selected points
are plotted out of a total ∼ 107. Top: AGN luminosity against outﬂow ve-
locity. Middle: AGN luminosity against mass outﬂow rate. Bottom: AGN
luminosity against outﬂow kinetic energy rate. The diagonal red lines show
(cid:164)𝐸out = 𝐿AGN (solid), (cid:164)𝐸out = 0.05𝐿AGN (dashed), (cid:164)𝐸out = 0.01𝐿AGN (dot-
ted).

tend to be overpredicted while higher values, above 2 × 105 yr, are
underpredicted. The scatter, at ∼ 0.67 × 105 yr ∼ 22% of the allowed
range, is also noticeably higher than that of 𝛿AGN and 𝑏out. Bulge
gas fraction values above 𝑓g,b = 0.22 are underpredicted, while
lower values have no systematic oﬀset. The scatter is similar to that
of 𝛿AGN and 𝑏out, equal to ∼ 0.05 ∼ 17% of the allowed range,
except for the lowest values 𝑓g,b < 0.05, where the scatter is ∼ 0.02.
The ﬁfth predicted parameter, the bulge mass, shows no sys-
tematic deviation from the one-to-one correspondence. Its scatter is
∼ 0.18 dex, which corresponds to ∼ 50%. This is approximately half
the value of the scatter in the 𝑀BH − 𝑀bulge relation in (McConnell
& Ma 2013) which we used in our simulations.

4.3 Eﬀect of observational errors

Confusion between diﬀerent simulated models is not the only pos-
sible source of error in the predictions. Another is the error in input
parameter values, which arises from observational uncertainty. To
check the importance of these errors, we use the following proce-
dure. We randomly select 240 points from the testing sample. For
each of those points, we generate 1000 variations by sampling each

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

7

Figure 4. Inferred parameters of real galaxies with observed outﬂows. The
four histograms show, left to right and top to bottom, the AGN duty cycle,
single AGN episode duration, the solid angle subtended by the outﬂow and
the gas fraction in the host galaxy bulge.

of the ﬁve input (observable) parameters from a lognormal distribu-
tion with mean equal to the true value and standard deviation equal
to 0.15 dex; while this is an arbitrary number, it is comparable to
the expected uncertainty of outﬂow and AGN parameters. We run
the neural network on each of these 2.4 × 105 points and calculate
the mean and standard deviation of each output parameter for each
set of 1000 variations. The mean values agree very well with the
original test result. In Figure 3, we show a histogram of the standard
deviations as a function of the true values of each parameter of inter-
est. Each bin encompasses approximately 20 test points. In the case
of 𝛿AGN, 𝑏out and 𝑓g,b, the uncertainties are very small when the
true parameter values are low, and increase to a plateau as the true
value increases. The uncertainties of 𝑡ep are similar throughout the
range. The plateau uncertainties are Δ𝛿AGN ∼− 0.15, Δ𝑡q ∼− 35000 yr,
Δ𝑏out ∼− 0.17, Δ 𝑓g,b ∼− 0.04, Δ𝑀b,tot ∼− 0.15 dex. Each of these un-
certainties is comparable to, or smaller than, the scatter presented
in Figure 2. We reran the test with several diﬀerent values of the
standard deviation of input parameters and found that the fractional
uncertainties of the results scale approximately linearly with the
fractional uncertainties of the input.

Adding the prediction and uncertainty errors in quadrature, we
ﬁnd that our neural network is able to predict the AGN duty cycle
and outﬂow solid angle fraction with an error of <
∼ 20%, the bulge
gas fraction with an error of ∼ 21% and the single AGN episode
activity duration with an error of ∼ 25%, with the caveat that the
longest episode durations are underpredicted by up to ∼ 30%. The
bulge mass is predicted with an error of ∼ 0.23 dex.

5 INFERRED REAL OUTFLOW EVOLUTION

5.1 Real outﬂow sample

We now utilise the neural network to infer the activity histories and
other properties of galaxies hosting real observed outﬂows. For this,
we use a sample of 59 molecular outﬂows in 46 local (𝑧 < 0.18)

Figure 2. Neural network testing results. The four 2D histograms show, left
to right and top to bottom, the AGN duty cycle 𝛿AGN, single AGN episode
duration 𝑡ep, the solid angle fraction subtended by the outﬂow 𝑏out and the
gas fraction in the host galaxy bulge 𝑓g,b. The horizontal axis is the true
value of the parameter used to generate the outﬂow, and the vertical axis is
the value inferred by the network. Darker squares represent higher density
of points, red dashed line represents a one-to-one correspondence.

Figure 3. Inﬂuence of uncertainties in input parameters on the neural net-
work result. Each histogram column represents the average uncertainty of
∼ 20 test points, each with 1000 variations created by sampling the input
parameters from a normal distribution with mean equal to the true value
and standard deviation of 0.15 dex. The four panels correspond to those in
Figure 2, bin widths are also identical between the two ﬁgures.

MNRAS 000, 1–18 (2019)

8

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

Galaxy

NGC 1068
IRAS F11119+3257 (a)
IRAS F11119+3257 (b)
PG 0157+001
PDS 456 (a)
PDS 456 (b)
Mrk 231 (a)
Mrk 231 (b)
IRAS 17020+4544
Mrk 876
IRAS F10565+2448 (a)
IRAS F10565+2448 (b)
IRAS F20551-4250 (a)
IRAS F20551-4250 (b)
4C +12.50
Circinus Galaxy
SDSS J1356
IRAS F23060+0505
IRAS F08572+3915 (a)
IRAS F08572+3915 (b)
Arp 220
IRAS 12112+0305
IRAS 22491-1808
IRAS 05189-2524 (a)
IRAS 05189-2524 (b)
IRAS F14348-1447 (a)
IRAS F14348-1447 (b)
NGC 4418
IC 5063
M 51
Mrk 273 (a)
Mrk 273 (b)
IRAS 20100-4156 (a)
IRAS 20100-4156 (b)
IRAS F09111-1007
NGC 2623 (a)
NGC 2623 (b)
IRAS 17208-0014
IRAS F14378-3651
IRAS 23365+3604 (a)
IRAS 23365+3604 (b)
NGC 6240
NGC 1614
NGC 1377
NGC 2146
NGC 1808
NGC 3256
IRAS 05083+7936
NGC 253
NGC 1266
NGC 3628
NGC 6764
NGC 1433
IRAS 13120-5453 (a)
IRAS 13120-5453 (b)
M 82
III Zw 035
IRAS 12224-0624
ESO 320-G030

log𝐿AGN
[erg s−1]
45.44
46.03
46.03
45.75
47.09
47.09
45.96
45.96
45.12
45.78
44.85
44.85
45.06
45.06
45.65
43.42
45.67
45.93
45.68
45.68
44.99
44.84
44.95
45.65
45.65
45.15
45.15
44.41
44.56
43.21
45.48
45.48
45.53
45.53
43.53
44.21
44.21
45.02
43.99
44.57
44.57
44.9
43.98
42.19
42.89
42.82
43.97
44.21
42.26
42.22
41.55
42.71
42.06
43.76
43.76
41.53
42.66
41.75
41.8

log𝑀BH
[M(cid:12)]
6.96
7.98
7.98
7.87
9.24
9.24
8.24
8.24
7.6
8.3
7.6
7.6
7.81
7.81
8.41
6.23
8.56
8.85
8.63
8.63
8.11
7.98
8.1
8.86
8.86
8.4
8.4
7.8
8.07
6.8
9.12
9.12
9.34
9.34
7.39
8.14
8.14
8.98
7.99
8.6
8.6
8.95
8.24
6.82
7.62
7.61
8.83
9.22
7.34
7.32
6.69
7.88
7.36
9.36
9.36
7.17
8.52
7.94
8.23

log 𝑓Edd

0.37
−0.06
−0.06
−0.23
−0.26
−0.26
−0.39
−0.39
−0.59
−0.63
−0.86
−0.86
−0.86
−0.86
−0.87
−0.92
−1
−1.03
−1.06
−1.06
−1.23
−1.25
−1.26
−1.32
−1.32
−1.36
−1.36
−1.5
−1.62
−1.7
−1.75
−1.75
−1.92
−1.92
−1.97
−2.04
−2.04
−2.07
−2.11
−2.14
−2.14
−2.16
−2.37
−2.74
−2.84
−2.9
−2.97
−3.12
−3.19
−3.21
−3.25
−3.28
−3.41
−3.71
−3.71
−3.75
−3.97
−4.3
−4.54

𝑅out
[kpc]
0.1
0.3
7
0.645
1.2
1.8
0.24
0.6
1
3.54
0.44
1.1
0.16
0.23
0.27
0.45
0.3
4.05
0.11
0.825
0.095
1.54
0.515
0.23
1.04
0.25
1.45
0.035
0.5
0.08
0.25
0.55
0.3
1
0.61
0.61
5.26
0.38
0.24
0.2
1.23
0.6
0.58
0.24
2
0.86
0.53
1
0.235
0.4
0.56
0.78
0.1
0.39
0.47
0.9
2.2
0.265
1.3

𝑣out
[km s−1]
100
1000
1000
400
670
690
240
700
1670
1050
355
450
320
490
640
150
500
550
560
800
420
460
325
330
445
130
387
325
300
100
520
620
540
930
330
585
400
1115
355
215
450
400
360
140
200
100
500
800
50
325
90
25
100
300
420
100
315
565
450

log𝑀out
[M(cid:12)]
7.13
7.77
8.75
7.99
8.23
7.89
9.07
8.43
8.27
9.38
8.56
8.34
8.01
7.48
7.72
6.58
7.81
9.42
8.1
8.56
7.05
8.8
8.14
8.32
7.92
9.48
8.83
5.97
7.31
6.17
8.25
8.21
8.77
8.86
8.07
7.06
6.66
7.57
8.11
8.81
8.12
8.58
7.47
7.03
7.96
7.45
7.67
7.98
7.19
7.67
6.88
5.8
6.15
8.23
8.26
7.76
8.59
7
6.83

(cid:164)𝑀out
[M(cid:12) yr−1 ]
14
204
81
63
83
17
1288
331
323
741
295
95
224
68
129

1.3

110
363
741
347
52
199
91
309
37
1659
199

9.1
13
1.9

398
190
1202
691
65
11
0.36

112
209
741
51
263
19
6.6
10
3.4
50
79
3.4
39
1.3
0.02
0.93

135
166

6.8
58
23
10

References

García-Burillo et al. (2014)
Veilleux et al. (2017)
Veilleux et al. (2017)
Lutz et al. (2020)
Bischetti et al. (2019)
Bischetti et al. (2019)
González-Alfonso et al. (2017)
Cicone et al. (2012)
Lutz et al. (2020)
Lutz et al. (2020)
González-Alfonso et al. (2017)
Cicone et al. (2014)
González-Alfonso et al. (2017)
Lutz et al. (2020)
Dasyra & Combes (2011)
Zschaechner et al. (2016)
Sun et al. (2014)
Lutz et al. (2020)
González-Alfonso et al. (2017)
Cicone et al. (2014)
Barcos-Muñoz et al. (2018)
Pereira-Santaella et al. (2018)
Pereira-Santaella et al. (2018)
González-Alfonso et al. (2017)
Lutz et al. (2020)
González-Alfonso et al. (2017)
Pereira-Santaella et al. (2018)
Lutz et al. (2020)
Morganti et al. (2013)
Querejeta et al. (2016)
González-Alfonso et al. (2017)
Cicone et al. (2014)
González-Alfonso et al. (2017)
Gowardhan et al. (2018)
Lutz et al. (2020)
Lutz et al. (2020)
Lutz et al. (2020)
Lutz et al. (2020)
González-Alfonso et al. (2017)
González-Alfonso et al. (2017)
Cicone et al. (2014)
Feruglio et al. (2013)
García-Burillo et al. (2015)
Aalto et al. (2012)
Tsai et al. (2009)
Salak et al. (2016)
Sakamoto et al. (2014)
Lutz et al. (2020)
Bolatto et al. (2013)
Lutz et al. (2020)
Tsai et al. (2012)
Leon et al. (2007a)
Combes et al. (2013)
Lutz et al. (2020)
González-Alfonso et al. (2017)
Walter et al. (2002)
Lutz et al. (2020)
Lutz et al. (2020)
Pereira-Santaella et al. (2016)

Table 2. Properties of outﬂows in our observational sample. The galaxies are listed in order of decreasing 𝑓Edd. Horizontal lines divide the sample into groups
𝑓Edd,min > 10−2, 𝑓Edd,min < 10−2 < 𝑓Edd,max and 𝑓Edd,max < 10−2, where 𝑓Edd,min and 𝑓Edd,max are the lower and upper ranges of the uncertainty in 𝑓Edd,
respectively.

MNRAS 000, 1–18 (2019)

galaxies presented in Zubovas & Nardini (2020). Each outﬂow in the
sample contains data of mass, momentum and outﬂow rates as well
as present-day AGN luminosity and SMBH mass. 13 galaxies have
either multiple clearly spatially distinct outﬂows, or the data of their
outﬂows diﬀers signiﬁcantly between publications. For reference,
we give these values in Table 2, in addition to references to the
primary paper from which outﬂow data was collected. We refer
the reader to Zubovas & Nardini (2020) for the details of how the
relevant properties were extracted and adapted. The galaxies are
listed in order of decreasing Eddington factor, 𝑓Edd ≡ 𝐿AGN/𝐿Edd.
The ﬁrst group of 29 outﬂows in 21 galaxies contains those where
𝑓Edd is deﬁnitely larger than 0.01, i.e. the thin-disc model is a
reasonable approximation to the accretion ﬂow and we may expect
winds to be present and the outﬂow to be driven. The second group
of 14 outﬂows in 10 galaxies contains those where the uncertainty
in 𝑓Edd encompasses the value of 0.01; these galaxies may still be
accreting via a thin disc, but that is less certain. Alternatively, they
may have recently undergone a transition from a thin disc accretion
to a less radiatively eﬃcient mode. The ﬁnal group of 16 outﬂows in
15 galaxies contains those galaxies where 𝑓Edd is deﬁnitely below
0.01; these outﬂows are either in the fossil phase or are driven by
star formation.

5.2

Inferred AGN parameters

The main results are given in Figure 4. The four histograms show,
left to right and top to bottom, the inferred duty cycle, single AGN
episode duration, the solid angle subtended by the outﬂow and the
gas fraction in the host galaxy bulge. The three groups of galaxies
identiﬁed above are represented with diﬀerent colours: blue for the
brightest AGN, orange for the intermediate ones and green for the
faintest. All parameters except for 𝑓g,b show a large spread across
all available values, with some interesting systematics.

There is a clear trend that brighter AGN also have higher duty
cycles. In principle this is not surprising: a galaxy with a high duty
cycle is more likely to be active at any given time, and more likely to
have a high Eddington factor, while the opposite is true for galaxies
with low duty cycles. The complete division between high- 𝑓Edd and
low- 𝑓Edd galaxies in terms of 𝛿AGN is unexpected, but understand-
able, especially considering that faint galaxies tend to have weaker
outﬂows than bright ones. Eight outﬂows - IRAS F10565+2448
(a) and (b), IRAS F14348-1447 (a), IRAS 12112+0305, Mrk 876,
Mrk 231 (b), IRAS F11119+3257 (b) and IRAS 17020+4544 - have
unphysical predicted values 𝛿AGN > 1, however only three - IRAS
F14348-1447 (a) IRAS 12112+0305 and Mrk 876 have 𝛿AGN > 1.2,
i.e. they cannot be explained by the uncertainties inherent in our
model. All three are particularly powerful. For example, the outﬂow
(cid:164)𝑀out of the whole
in IRAS F14348-1447 has the highest value of
sample, while the outﬂow in Mrk 876 is one of the fastest. They
may represent the upper limits of what an AGN can drive out of its
host galaxy.

Inferred values of individual episode duration spread through-
out the allowed range, but there are fewer galaxies with inferred
𝑡ep > 2 × 105 yr. This is understandable as a consequence of the
systematic underprediction of large true 𝑡ep values by our model (see
Figure 2). On the other hand, the peak around 𝑡ep = (1 − 1.5)×105 yr
is most likely real; due to the systematic overprediction of 𝑡ep in this
region, these values probably correspond to somewhat shorter ac-
tual values of individual episode duration. Nevertheless, the result
agrees well with statistical and theoretical estimates (Schawinski
et al. 2015; King & Nixon 2015). Two outﬂows, in IRAS F14348-

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

9

1447 (a) and III Zw 35, fall outside the range of simulation param-
eters, with inferred values 𝑡ep = 3.5 × 105 yr and 𝑡ep = 3.1 × 105 yr,
respectively. IRAS F14348-1447 (a) has been discussed above -
its immense power may only be possible with unusually long ac-
tivity episodes; additionally, the unphysically high duty cycle may
be throwing oﬀ other predictions. III Zw 35, on the other hand, is
one of the faintest AGN in our sample, and the galaxy is currently
merging; it is quite possible that our spherically symmetric model
is insuﬃcient to represent this system.

The inferred solid angles subtended by real outﬂows show a
large spread with no obvious systematics. This suggests that out-
ﬂow geometry does not depend on the history of AGN luminosity.
This is not surprising for the ‘large-scale’ geometry, i.e. the shape
of the outﬂow cone - it should depend only on the gas distribution
in the host galaxy. The ‘small-scale’ geometry, i.e. the distribu-
tion of gas phases, should in principle depend on the heating and
cooling rates, which are sensitive to AGN luminosity. On the other
hand, the thermodynamic properties of outﬂows evolve on much
shorter timescales than a single AGN episode duration (Richings &
Faucher-Giguère 2018b), and so are unlikely to be captured by our
model. 14 outﬂows in 12 galaxies have inferred values 𝑏out > 1,
which appear unphysical at face value. Five of them have 𝑏out > 1.2,
i.e. the large values cannot be explained by our estimated uncertainty
of predictions (see Section 4.3). These galaxies have high duty cy-
cles 𝛿AGN > 0.75, with three being outliers in both parameters.
On the other hand, they typically have lower-than-average predicted
bulge gas fractions, which may go some way to explaining the out-
lying values of 𝑏out. The outﬂow solid angle fraction is mainly
constrained by (cid:164)𝑀out ∝ 𝑀out𝑣out ∝ 𝑓g,b𝑏out (cf. eq. 16), therefore a
low value of one constrains the other to be large. Otherwise, these
outﬂows are unremarkable within the whole sample. There is, how-
ever, a possible physical interpretation of 𝑏out > 1: these outﬂows
may consist of multiple radially distinct components that overlap in
at least some sightlines from the AGN.

Bulge gas fraction is always estimated as very low - note the
diﬀerent scale between this panel and the corresponding panels in
Figures 2 and 3. Here, again, there is little diﬀerence among the
three groups, except for a tendency that fainter galaxies have lower
gas fractions. Only three outﬂows fall outside the range of the plot:
IRAS F14348-1447 with 𝑓g,b = 0.53 (see above), Mrk 231 (a) with
𝑓g,b = 0.37 and IRAS 23365+3604 (a) with 𝑓g,b = 0.2.

The estimated bulge masses agree very well with the prediction
of the 𝑀BH − 𝑀bulge relation: 51 out of 59 outﬂows have model-
predicted 𝑀bulge within 20% of that estimated from 𝑀BH, while
the rest are within a factor of two from the estimate. We hesitate to
draw any strong conclusions from this, because this result simply
reﬂects that the neural network learnt to associate the value of 𝑀bulge
predominantly with 𝑀BH, with the other parameters having a minor
inﬂuence. On the other hand, we note that in all cases where we
have data on multiple outﬂows in the same galaxy, the predicted
bulge masses are similar, yet not identical, with diﬀerences as large
as 20%, so it is not only the SMBH mass (which, by deﬁnition, is
the same for both outﬂows in the same galaxy) that determines the
bulge mass prediction. The fact that the prediction remains close to
the expected one, then, is encouraging.

We also checked whether the galaxies with diﬀerent types of
AGN have systematically diﬀerent inferred activity histories, but
didn’t ﬁnd any statistically signiﬁcant diﬀerences; we show this
in more detail in Appendix C. This result agrees with the uniﬁed
picture of AGN: since outﬂows are galaxy-wide structures, they
are not signiﬁcantly obscured independently of the direction of
the observer, so the outﬂows do not appear systematically diﬀerent

10

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

in diﬀerent AGN types. On the other hand, this result suggests
that whatever real diﬀerences there may be among Type 1, Type
2 or LINER AGN, they do not aﬀect the formation of large-scale
outﬂows.

5.3 Tests of model predictions

Small diﬀerences in the initial conditions can result in signiﬁcantly
diﬀerent outﬂow evolution, especially if the outﬂow propagates for
a long time and multiple AGN episodes, as should be the case for
most of our sample. It is possible that the errors introduced by the
uncertainties in the outﬂow parameters and the neural network lead
to outﬂow evolution incompatible with the observed data. To check
this, we reran the outﬂow simulations for each galaxy, using the pa-
rameter predictions produced by the neural network. Additionally,
we used eq. 8 to determine an appropriate halo mass for the galax-
ies; the precise value of this parameter is generally not important,
since the mass and the gravitational potential within the present-day
outﬂow radius are dominated by the bulge component.

We show three example plots of outﬂow evolution in Figure 5.
Each panel corresponds to one galaxy, while the four sub-panels
show four combinations of observable parameters: 𝑣out against
(cid:164)𝑀out against 𝐿AGN
𝐿AGN (top left), 𝑣out against 𝑅out (top right),
(cid:164)𝑀out against 𝑅out (bottom right). The red dots in the
(bottom left),
middle of each panel represent observed outﬂow data. Red error
bars show the uncertainties in 𝐿AGN and (cid:164)𝑀out as given in the out-
ﬂow detection papers. Yellow bars show the estimated uncertainties
in 𝑅out and 𝑣out, equal to ±0.15 dex of the observed value.

The top panels show the results of Mrk 273. By the time
the outﬂow expands to the observed radius of 𝑅 = 550 pc, its
evolution has settled to constant-velocity expansion, with each AGN
episode (seen as a mostly horizontal line in the left-hand sub-panels)
producing negligible changes to 𝑣out and (cid:164)𝑀out. At early times, the
variation was more signiﬁcant, as evidence by the spread in the
model lines in the two left sub-panels. The simulated outﬂow passes
almost exactly through the observed point.

The middle panels show NGC 4418. Its outﬂow has a much
smaller radius, 𝑅out = 35 pc. The outﬂow is being inﬂated by the
ﬁrst activity episode, and so the velocity and mass outﬂow rates
are changing dramatically. At later times, we expect the outﬂow to
reach a similarly quasi-steady evolutionary state as the one in Mrk
273. Despite this diﬀerence, the match between the model and the
data is almost perfect.

The bottom panels show NGC 3628, where the outﬂow never
settles to a constant-velocity solution. As a result, both 𝑣out and
(cid:164)𝑀out ﬂuctuate signiﬁcantly. Nevertheless, the model still matches
the data extremely well.

Overall, 37 outﬂows in 29 galaxies show evolution patterns
very similar to those of Mrk 273, i.e. they settle to a constant velocity
(and, hence, constant (cid:164)𝑀out) solution before reaching the present-day
outﬂow radius. 33 of those outﬂows in 28 galaxies reproduce the ob-
served outﬂow properties well within the uncertainties. Of the other
four, three predict velocities that are slightly too small (although
the mass ﬂow rates are within the observational uncertainties) and
the last one, the extended outﬂow in PDS 456, reproduces the ob-
served velocity very well, but predicts a slightly higher mass ﬂow
rate ( (cid:164)𝑀out,pred ∼− 22 M(cid:12) yr−1 > (cid:164)𝑀out,obs = 17 M(cid:12) yr−1).

17 outﬂows show signiﬁcant variability, similar to the patterns
of NGC 3628. Nevertheless, 12 of them reproduce the observed
velocities very well. The other ﬁve predict velocities that are lower
than the observed ones. All 17 predict mass outﬂow rates within the
limits of the uncertainties.

Figure 5. Outﬂow evolution using our predicted parameters. Red dots are
observed data, red error bars represent uncertainties taken from corre-
sponding observation papers, yellow bars represent uncertainty estimates
of ±0.15 dex.

MNRAS 000, 1–18 (2019)

Finally, ﬁve outﬂows - Mrk 231 (a), NGC 253, NGC 6764,
M82 and IRAS 17020+4544 - do not reproduce either the velocity
or the mass ﬂow rate within the uncertainties, although the ﬁrst one
comes close. The outﬂow in Mrk 231 has a very small radius, which
may explain to some extent the failure of our model. The failures of
NGC 253, NGC 6764 and M82 may be explained by the fact that
these galaxies have very weak AGN and their outﬂows may have
signiﬁcant components driven by star formation (NGC 253: Walter
et al. 2017; NGC 6764: Leon et al. 2007b; M82: Bland & Tully
1988; Strickland & Stevens 2000). IRAS 17020+4544 is peculiar in
that its outﬂow radius is larger than the estimated radius of the bulge,
which may be hampering the neural network’s ability to determine
the appropriate parameters.

Overall, we see that the outﬂow generator, using the parameters
provided by the neural network, reproduces the observed outﬂow
velocities in 45 out of 59 (76%) and mass outﬂow rates in 54 out
of 59 (92%) of real outﬂows. Of the failures, all predictions but
the four mentioned above (NGC 253, NGC 6764, M82 and IRAS
17020+4544) are still close to the observed value, diﬀering by less
than twice the observational uncertainty.

5.4

Individual galaxies with multiple outﬂows

13 galaxies in our sample have two outﬂows each. Three of those -
IRAS F11119+3257, PDS 456 and NGC 2623 - have outﬂows that
are deﬁnitely spatially separated. Four - Mrk 231, IRAS F20551-
4250, Mrk 273 and IRAS 13120-5453 - have outﬂow radii diﬀering
by less than 500 pc; we tentatively identify them as representing
the same physical outﬂow. The other six - IRAS F10565+2448,
IRAS F08572+3915, IRAS 05189-2524, IRAS F14348-1447, IRAS
20100-4156 and IRAS 23365+3604 - have outﬂows with radii dif-
fering by between 0.6 − 1.2 kpc and cannot be easily classiﬁed by
their geometry alone.

The inferred duty cycles in 7 of 13 (54%) pairs diﬀer by less
than the uncertainty of ±0.2 of our model, including measurement
uncertainties. The six outﬂow pairs where the duty cycle diﬀers
more signiﬁcantly include all three spatially distinct pairs and three
in the uncertain category. 9 out of 13 (69%) pairs have single episode
durations diﬀering by less than the uncertainty of 55 kyr; the outliers
are IRAS F14348-1447, Mrk 231, IRAS F11119+3257 and IRAS
F08572+3915.

6 of 13 (46%) pairs have solid angle fraction diﬀerences greater
than the ±0.2 uncertainty, including Mrk 231, where the pair pre-
sumably represents the same outﬂow. This may be explained by
the fact that the two outﬂows have been detected using diﬀerent
molecular gas tracers: OH (González-Alfonso et al. 2017) and CO
(Cicone et al. 2012). The more compact OH outﬂow has a smaller
inferred solid angle and a much higher gas fraction than CO. Since
OH traces denser gas than CO, this discrepancy probably simply
reﬂects the fact that the more compact outﬂow represents a denser
phase composed of geometrically smaller clouds, while the CO ra-
diation is emitted by more diﬀuse gas covering a higher solid angle.
It is also possible that the two detections represent separate outﬂow
shells.

In addition to Mrk 231, there are two more pairs of outﬂows
with signiﬁcantly diﬀerent inferred gas fractions; both are in the
uncertain category. The two outﬂows in IRAS F14348-1447 have
radii diﬀering by 1.2 kpc or a factor of 5.8 and possibly represent
separate outﬂow shells; the much higher gas fraction inferred for the
more compact OH outﬂow presumably represents a radial variation
in dense gas within the outﬂow. In IRAS 23365+3604, the outﬂow
radii also diﬀer by a factor > 6; once again, the more compact and

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

11

denser outﬂow is detected in OH and presumably represents much
denser gas close to the centre of the host galaxy.

6 DISCUSSION

6.1 Galaxy activity histories

Our results suggest that AGN, especially currently-bright ones, have
a wide spread of generally large duty cycles, approaching 𝛿AGN = 1
in extreme cases. It is important to remember that this duty cycle is
only applicable during the time that the outﬂow has been expand-
ing for, which is typically ∼ 1 Myr. Even so, for most outﬂows,
this is longer than the duration of a single AGN episode, so we
would expect signiﬁcant variability in AGN luminosity to occur
during the evolution of the outﬂow. This variation of energy input
can have a strong eﬀect on the thermal evolution of the outﬂowing
material, perhaps explaining, at least in part, the presence of multi-
phase gas in outﬂows (Cicone et al. 2018; Fluetsch et al. 2021) and
preventing the outﬂowing material from reaching complete thermal
equilibrium (Richings et al. 2021). We plan to explore the eﬀect of
AGN luminosity variability on outﬂow thermodynamics in a future
publication.

On timescales comparable to the Hubble time, the duty cycle
of AGN is of order 0.07 (Wang et al. 2006), although in local
galaxies it can vary in the range of 10−4 − 10−2, depending on the
SMBH mass (Shankar et al. 2009, 2013). The percent-level duty
cycles are consistent with our model predictions for the faintest
AGN, but the other AGN have been active much more frequently
in the recent past than over the longer term. This is consistent with
a view that galaxy activity is hierarchically clustered, with ‘phases’
lasting several times 107 yr (Hopkins et al. 2005), while within each
phase, numerous individual episodes with durations ∼ 105 yr may
occur. In this view, the bright and intermediate AGN are currently
within such a phase, while the faintest ones are outside it, and their
recent activity was a singular event, if it indeed was responsible for
inﬂating the outﬂow. It is worth noting that Khrykin et al. (2021)
recently found that typical quasar lifetimes are probably longer, with
mean duration 𝑡Q ∼− 1.6 Myr. On the other hand, the result is based
on measuring the HeII proximity zones around quasar host galaxies;
the recombination timescale of these regions is 𝑡eq ∼ 30 Myr, so the
method is not sensitive to variations in AGN luminosity that result
in quiescent periods much shorter than 𝑡eq (Khrykin et al. 2019).

The outﬂow can have an important eﬀect in determining the
duration of the longer activity phase. By pushing the gas away, the
outﬂow quenches the gas supply to the SMBH and regulates its
growth. Over a few times 107 yr, the AGN injects enough energy
into the gas to unbind it from the host galaxy (Zubovas & King
2016). This timescale is also comparable to the timescale for dense
gas clouds embedded in the hot outﬂow to evaporate (Cowie & Mc-
Kee 1977). Therefore, over a few tens of Myr, the AGN eﬀectively
quenches its own gas supply, and it takes at least an order of magni-
tude longer for the gas to stall and fall back dynamically, triggering
a new phase of activity. The infalling gas presumably also leads to a
burst of star formation, so we predict that AGN, especially in the lo-
cal Universe where galaxies have little gas, should reside primarily
in galaxies with evidence of recent star formation. This is consis-
tent with recent observational results that local AGN host galaxies
have been rejuvenated in the past ∼ 100 Myr (Martín-Navarro et al.
2021).

In line with the above framework of long-term accretion phases
composed of short episodes, AGN within such phases should con-
tain signiﬁcant amounts of dense gas in the central regions. This

12

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

gas may not be directly susceptible to the outﬂow if, for example,
it forms a dense circumnuclear disc (CND) around the SMBH. It is
well known that CNDs correlate with the presence of AGN (Izumi
et al. 2016; Agüero et al. 2016) and can act as a valve regulating the
long-term nuclear activity (Fujita et al. 2022). Feeding of the SMBH
on scales of tens of parsecs has been observed by calculating the
gravity torques experienced by the gas (García-Burillo et al. 2005;
García-Burillo & Combes 2012; Combes et al. 2014; Audibert et al.
2019). Typical CND masses are of order 107 − 108 M(cid:12) (Izumi et al.
2016); this is comparable to the SMBH mass, i.e. the circumnuclear
disc (or ring) can in principle feed the black hole for a Salpeter time
or longer. It would be interesting to look for observational diﬀer-
ences between circumnuclear rings in galaxies with predicted high
and low AGN duty cycles.

The fact that both AGN in long activity phases and those
outside of them can launch outﬂows can explain, at least partly, the
conundrum that negative AGN feedback is not generally observed
on galactic scales (e.g., Carniani 2017; Bae et al. 2017; Jarvis et al.
2020; Scholtz et al. 2020, 2021). Numerical simulations, however,
clearly show that AGN feedback suppresses star formation, at least
on cosmological timescales, in massive galaxies (Bower et al. 2006;
Croton et al. 2006; Sĳacki et al. 2007; Vogelsberger et al. 2014;
Schaye et al. 2015; Tremmel et al. 2019; Davé et al. 2019). There
have been suggestions that AGN feedback only becomes evident
on long timescales (Harrison et al. 2019) and our results suggest a
similar explanation. The eﬀect of AGN feedback on star formation
and dense gas content in the host galaxy may become evident only
by the end of long phases of activity; however, present-day AGN
are a mixture of those at various points of such phases and those
completely outside them. Our results thus imply that feedback on
star formation should be more evident in AGN with predicted large
duty cycles, and in particular in the subset of such AGN with the
largest outﬂows (since, presumably, they have been active for the
longest time). This prediction can be tested both with observations
and numerical simulations, where otherwise identical galaxies are
subjected to AGN activity with diﬀerent duty cycles.

6.2 Evidence of outﬂow stalling

Within the framework of our model, the outﬂow slows down, can
stall and even fall back somewhat in between subsequent AGN
episodes (cf. Fig. 5). The thickness of the coasting shell also in-
creases, since it is no longer compressed by the wind coming from
the nucleus. Once a new episode begins, the AGN wind impacts the
slowed gas and drives a new shock through it. Given that the shocked
and compressed gas cools rapidly, on timescales much shorter than
dynamical (Zubovas & King 2014; Richings & Faucher-Giguère
2018a,b), this can lead to a rapid burst of star formation in a shell
or fragment thereof. The thickness of this shell is determined by
the radial gas distribution in the outﬂow, which in turn depends
on the time between AGN episodes. Assuming that the shell thick-
ness increases with a typical velocity ∼ 𝜎b, it reaches a value
Δ𝑅sh ∼ 𝜎b (1 − 𝛿AGN) 𝑡rep between two episodes. The distance be-
tween subsequent shells is, at least at the early stages of outﬂow
expansion, Δ𝑅out ∼ 𝑣out𝛿AGN𝑡rep. Requiring that Δ𝑅sh < Δ𝑅out
leads to an inequality

𝛿AGN >

𝜎b
𝜎b + 𝑣out

.

(20)

At early times, 𝑣out is usually a few times higher than 𝜎b, so
we can expect to ﬁnd evidence of recent AGN episodes, and the
corresponding changes in outﬂow dynamics, in the distribution of

young stars and/or star-forming regions in galaxies with duty cycles
𝛿AGN

>
∼ 0.25.
In galaxies with the highest duty cycles, these shells may not
exist because the gas shell does not have enough time to spread out
before the next AGN episode begins. In a purely spherical geometry,
this eﬀect would be negligible, since the shell of molecular gas
must be very thin and so can spread out quickly. In real galaxies the
importance of this ‘shell mixing’ is determined predominantly by
the variations of gas density along diﬀerent lines of sight from the
SMBH.

Another piece of evidence of recent previous AGN episodes
may be galactic fountains in disc galaxies. A single AGN episode
usually does not inject enough energy into the gas to unbind it from
the host galaxy. The stalling outﬂow is then drawn toward the mid-
plane, where the gas density is higher. As the outﬂow geometry is
typically conical, the gas that has dropped close to the midplane is
not pushed as eﬀectively during the subsequent activity episodes.
Over many AGN episodes, the stalling outﬂow forms a series of
falling streams and/or clouds, covering a large radial extent of the
galaxy disc. While galactic fountains are usually associated with
supernova-driven outﬂows in galactic discs, there is some evidence
that AGN can also drive them (Tremblay et al. 2018). Future obser-
vations should reveal galaxies with signiﬁcant amounts of matter
falling on to the disc, but little to no evidence of supernova ex-
plosions that could have driven the fountain in the ﬁrst place; this
would be another piece of evidence of a relatively recent AGN
growth phase and associated outﬂow.

6.3 Narrow-angle outﬂows

Some of the outﬂows in our sample are predicted to have very small
opening angles. If we assume that these represent the ‘large-scale’
collimation, i.e. that the outﬂows are launched as narrow cones, then
the probability of seeing the outﬂow head-on is correspondingly
small. In this case, the observationally-derived outﬂow parameters,
especially its velocity, are projected and so have smaller values than
the actual ones. To understand the eﬀect this has on the measured and
derived parameters, we can assume, very roughly, that the projected
velocity is 𝑣proj ∼ 𝑣real sin 𝑖, where 𝑖 is the inclination of the outﬂow
cone, measured from the plane of the sky. Then the mass ﬂow rate
may be underestimated by a factor (cid:16)
= sin3 𝑖. The duty
cycle, which determines the total injected energy via the mean
luminosity (cid:104)𝐿AGN(cid:105) ∝ 𝛿AGN 𝐿Edd, is also underestimated, because
𝑣out ∝ (cid:104)𝐿AGN(cid:105)1/3, so 𝛿AGN,real ∝ sin−3 𝑖𝛿AGN,proj. The duration of
a single AGN episode should not be systematically aﬀected, except
for the outﬂows with the smallest extent, which may have been
inﬂated by only a single episode; in this case, the episode should
be longer than inferred from the projected velocity. The product of
bulge gas fraction and solid angle fraction is 𝑓g,b𝑏out ∝ (cid:164)𝑀out/𝑣out
(see eq. 23 below), so its value is proportional to sin2 𝑖. In other
words, the real value of this product, and hence of its components,
may be higher if the outﬂow is seen in projection. The fact that a
projected outﬂow may have a higher actual solid angle than inferred
helps to somewhat mitigate this whole problem.

𝑣proj/𝑣real

(cid:17)3

On the other hand, a small inferred solid angle fraction can sim-
ply represent the fact that an almost spherical outﬂow is composed
of multiple gas phases, with molecular gas comprising only a small
fraction of it. In that case, the probability of seeing, and being able
to infer, the real parameters of the outﬂow is much higher than the
solid angle fraction. Given that the galaxies with spatially-resolved
outﬂows tend to have large outﬂow opening angles, we believe this

MNRAS 000, 1–18 (2019)

situation is more likely to be the case where the solid angle fraction
is inferred to be small. Nevertheless, more detailed observations
of outﬂow geometry will allow us to test these predictions more
rigorously (see Section 6.5).

6.4 Prevalence of fossil outﬂows

Assuming that SMBH grow in long phases of activity that are
composed of shorter episodes, as suggested by our results (see
Section 6.1, above), we can make an order-of-magnitude estimate
of the frequency with which fossil outﬂows should be detected in
comparison with outﬂows in present-day AGN host galaxies, and as
a fraction of the whole galaxy population.

During a growth phase,
the average AGN duty cycle is
>
∼ 0.2. The outﬂow is eﬀectively visible all the time, inde-
𝛿AGN
pendently of whether the black hole is active or not. Given that the
distribution of duty cycles appears to be ﬂat (see Fig. 4), we take
the average duty cycle as (cid:104)𝛿AGN(cid:105) ∼ 0.6. Assuming that the growth
phase lasts ∼ 10 Myr, the AGN is visible, on average, for ∼ 6 Myr,
and fossil outﬂows during an AGN growth phase are visible for
∼ 4 Myr.

Once the growth phase ends, it takes some time for the outﬂow

to stall. Following eq. (25) in King et al. (2011), we have

𝑡stall ∼

𝑅0𝑣out
2𝜎2 ∼ 6𝑅kpc𝑣500𝜎−2

200Myr,

(21)

where 𝑅0 ≡ 1𝑅kpc kpc is the outﬂow radius at the time the growth
phase ends and 𝑣out ≡ 500𝑣500 km s−1 is the outﬂow velocity at
that time. We used the average values of our real outﬂow sample for
the scalings.

We see that for every 16 Myr that an outﬂow is visible, the
AGN should be present for ∼ 6 Myr, while the outﬂow spends the
other ∼ 10 Myr in a fossil phase. In other words, fossil AGN outﬂows
should outnumber currently-driven ones by a factor of ∼ 1.6 : 1. This
factor is probably somewhat smaller, because an outﬂow becomes
eﬀectively undetectable once its velocity drops below ∼ 𝜎, before
it stalls completely.

The ∼ 6 Myr that the AGN is active within a growth phase cor-
responds to a long-term duty cycle of ∼ 0.07 over the lifetime of the
galaxy. Therefore, an AGN outﬂow (including both the driven and
fossil phases) should be present for a fraction ∼ 16/6 × 0.07 ∼ 0.19
of a galaxy’s lifetime. Assuming the galaxy population is statisti-
cally representative, we expect ∼ 19% of galaxies to show evidence
of AGN-driven outﬂows. This prediction is consistent with recent
observational results (Stuber et al. 2021), where ∼ 20 − 25% of
galaxies show evidence of outﬂows, and half of those galaxies are
AGN hosts.

6.5 Future tests of our results

As more data on outﬂows, especially their resolved morphology,
is collected, various subtle diﬀerences among outﬂows in diﬀerent
galaxies will become apparent. Some of them can serve as tests of
the results presented here and of the wind-energy-driven outﬂow
model in general.

One important test comes from the multiphase nature of the
outﬂows. Our model, at the moment, is concerned only with the
molecular phase, which comprises only part of the outﬂow. This par-
tition is captured to some extent by the outﬂow solid angle fraction
𝑏out. It is worth noting that inferred 𝑏out correlates positively with
the ratio (cid:164)𝐸out/𝐿AGN (Figure 6, top panel). The correlation is even
stronger with (cid:164)𝐸out/𝐿Edd (Figure 6, bottom panel); this ratio should

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

13

Figure 6. Inferred solid angle fraction of real outﬂows against energy loading
factor of the outﬂow. Top: energy loading factor calculated as (cid:164)𝐸out/𝐿AGN.
Bottom: energy loading factor calculated as (cid:164)𝐸out/𝐿Edd. The red dashed line
shows the trend (cid:164)𝐸out/𝐿Edd ∝ 𝑏2

out.

be more important since the energy injection into the surrounding
gas over multiple AGN episodes is proportional to 𝐿Edd and doesn’t
necessarily correlate with instantaneous luminosity. Assuming that
this correlation arises purely because of the division of outﬂowing
material between phases, it suggests that in galaxies where less en-
ergy is absorbed by the dense molecular gas, the ionised outﬂows
should be comparatively more powerful. At ﬁrst glance, this result
appears at odds with the observational data shown in Fiore et al.
(2017) and Bischetti et al. (2019), where higher AGN luminosities,
which correspond to higher (immediate) (cid:164)𝐸out/𝐿AGN values, also
have higher ionised-to-molecular outﬂow ratios in terms of both the
mass and the energy ﬂow rates. On the other hand, most of the galax-
ies in those samples have either a molecular or an ionised outﬂow,
but not both, so it is possible that the samples represent galaxies
in diﬀerent evolutionary phases in terms of outﬂow properties. The
few galaxies that have both molecular and ionised outﬂows, taken
from Fluetsch et al. (2019), show an opposite trend, with ionised
outﬂows comparatively weaker in brighter AGN.

It is also worth noting that the correlation in our results is super-
linear, (cid:164)𝐸out/𝐿Edd ∝ 𝑏2
out. This trend agrees very well with the idea
that a large fraction of AGN input energy may escape through low-
density channels, leaving disproportionately little energy to drive
the bulk of the mass, which forms the molecular outﬂow. A high
value of 𝑏out, conversely, implies that the injected energy is absorbed
eﬃciently in all directions, so the outﬂow is more energetic.

In our model, the quantity 𝑓g,b𝑏out is easily constrained by
equations (16) and (17). Since 𝑓g,h 𝑀tot,h (< 𝑅) is generally negli-
gible in the central several kiloparsecs of the galaxy, and since we
use an isothermal bulge which has 𝑀 (< 𝑅) ∝ 𝑅, we have

(cid:164)𝑀out = 𝑏out 𝑓g,b

𝑅out
𝑅bulge

𝑀tot,b

𝑣out
𝑅out

,

(22)

14

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

which gives

𝑏out 𝑓g,b =

𝑅bulge
𝑣out

(cid:164)𝑀out
𝑀tot,b

.

(23)

All the right-hand terms are either given as inputs to the neural
network (𝑣out, (cid:164)𝑀out) or can be derived from a third input parameter,
the SMBH mass, and the known correlations (eqns. 9 - 11). Note
that this equation only works as long as 𝑅out < 𝑅bulge; outside the
bulge, the mass increases much slower as the outﬂow propagates
through the diﬀuse halo.

Breaking the degeneracy between these parameters is not triv-
ial within our model, but the neural network manages this. It will
be interesting to check what diﬀerences there are among galaxies
with the same value of the product 𝑓g,b𝑏out but vastly diﬀerent gas
fractions and outﬂow solid angles. The observable conical shape of
the outﬂow can provide some constraint on the solid angle fraction,
although we must keep in mind that the outﬂow can be composed
of multiple disjoint components, some of which may be visible and
some not, but all which contribute to 𝑏out. Similarly, observations of
the gas content in outﬂow host galaxies provide some indication of
the gas fraction, but not all gas is susceptible to being pushed by the
outﬂow or to becoming part of its molecular phase, complicating
the interpretation of these observations.

The predictions of AGN duty cycles and individual episode
durations do not show strong correlations with any individual ob-
servable parameters, their products or ratios, as expected. The time
since the start of the last episode may be important, however. Galax-
ies where the AGN has switched on recently (in the past 103 yr or so)
may have unusually small narrow-line regions, since the ionising
radiation has not reached throughout the galaxy yet (Schawinski
et al. 2015). This eﬀect should be more easily visible in galax-
ies with low duty cycles, because more time has passed since the
last episode, allowing the ionised gas to recombine and cool. This
idea can be extended to currently inactive galaxies that have fossil
outﬂows: light echoes from their last activity episode may still be
visible, providing a test to our predictions. It will be very interesting
to look for outﬂows in fading AGN candidates, which show strong
evidence of signiﬁcant luminosity decay over the past ∼ 104 −105 yr
(Keel et al. 2017).

6.5.1 Tests in individual galaxies

The 13 outﬂow pairs discussed in Section 5.4 oﬀer an opportunity
to test our model predictions by considering the radial proﬁles of
gas properties. Ten of those pairs contain one detection in OH from
González-Alfonso et al. (2017); in nine of them, the OH-detected
outﬂow is more compact, and in seven of those, it is also more
massive than the larger counterpart. However only Mrk 231 has a
signiﬁcant diﬀerence in the inferred outﬂow solid angle fraction,
while in three cases - Mrk 231, IRAS F14348-1447 and IRAS
23365+36040 - there are diﬀerences in the inferred bulge gas frac-
tion (the OH outﬂow has a higher 𝑓g,b in all three). The signiﬁcant
diﬀerences in gas fraction suggest a steep radial gas density proﬁle
in these galaxies, while the other galaxies should show shallower
density proﬁles closer to the isothermal case 𝜌 ∝ 𝑅−2.

6.6 Software applicability and improvements

6.6.1 Dependence on the assumed physical model

All the results presented in this paper rely on the assumption that
the wind-driven outﬂow model is the correct physical framework

of AGN outﬂow generation. While this model is very successful
in explaining and predicting various observations related to AGN
outﬂows, it is not the only possibility (e.g., Morganti 2017). It
is naturally interesting whether a similar numerical framework as
Magnofit can be applied to diﬀerent physical models of AGN
feedback.

Unfortunately, the most straightforward implementation - ad-
justing the equation of motion, while leaving all the other compo-
nents intact - is unlikely to work. For example, it cannot work for
the radiation pressure driven AGN outﬂow model (e.g., Fabian et al.
2008; Ishibashi et al. 2018). The reason for this is the following.
The inﬂation of outﬂows by direct radiation pressure depends very
strongly on the optical depth of the outﬂow, which in turn depends
on the initial inner radius of the outﬂowing shell; for an isothermal
gas distribution, the dependence is 𝜏 ∝ 𝑅−1. For most reasonable
parameter combinations, the outﬂow becomes transparent to the IR
radiation ﬁeld beyond 𝑅tr ∼ 100 pc. This is a distance that can easily
be reached during a single AGN episode. As a result, all subsequent
AGN episodes have only a negligible eﬀect on the outﬂow properties
and it becomes impossible to determine the duty cycle of the AGN
using outﬂow properties. One may be able to determine the duration
of the AGN episode that inﬂated the outﬂow, but even so, techni-
cally this is only the duration of the episode before transparency is
achieved, which may be shorter than the whole episode.

Similar problems may arise with other physical outﬂow driving
mechanisms, although, for example, nuclear starbursts (McLaugh-
lin et al. 2006; Sharma & Nath 2013) may be more easily tractable
if we assume that the outﬂow has an eﬀectively inﬁnite opacity
to supernova remnants and stellar winds, just as it does to AGN
winds. Advection-dominated and other radiatively ineﬃcient ac-
cretion ﬂows (e.g., Narayan et al. 1998) present their own issues,
such as the strong dependence of the accretion ﬂow, and hence the
AGN luminosity, on the properties of the outﬂow (Li & Cao 2009).
Finally, jet-driven outﬂows are generally narrow and would suﬀer
from projection-related issues, as discussed in Section 6.3 above.

Nevertheless, with appropriate changes to the framework, the
predictions of other physical outﬂow models can be utilized to
investigate the activity histories of galaxies in numerous ways. A
combined approach may even be possible, for example by using
diﬀerent outﬂow equations of motion at diﬀerent AGN luminosities,
corresponding to disc and radiatively ineﬃcient accretion modes
and/or wind and jet feedback regimes (Merloni et al. 2003).

6.6.2 Other considerations

Certain aspects of the outﬂow simulations can be improved in the
future. For example, it should be possible to relax the assumption of
perfect adiabaticity of the system, by allowing for cooling, follow-
ing the results of Richings & Faucher-Giguère (2018b). This may
be further extended to encompass a multiphase system and allow
us to produce predictions for outﬂows where ionised, neutral and/or
molecular components are observed simultaneously (Fluetsch et al.
2021). The neural network could then be updated to take into ac-
count the properties of multiple outﬂow phases simultaneously. This
should allow us to eliminate 𝑀BH as an input parameter of the net-
work; this would signiﬁcantly expand the number of AGN to which
the network can be applied. Furthermore, these improvements can
potentially reduce the uncertainties of the neural network predic-
tions.

Another important assumption in the simulations is spheri-
cal symmetry. Relaxing it will let us model conical outﬂows in
greater detail, investigate outﬂows propagating through galactic

MNRAS 000, 1–18 (2019)

discs (Menci et al. 2019), compressing them (Zubovas et al. 2013)
or even originating within them (such as superbubbles from star-
forming regions, e.g., Mac Low & McCray 1988; Roy et al. 2013).
The possibility of connecting outﬂow eﬀects on galactic discs, such
as the existence of cavities, shock fronts and coherent starburst re-
gions, to the properties of outﬂow sources, i.e. AGN or supernovae,
opens up exciting opportunities for the investigation of recent nu-
clear activity and star formation histories of galaxies.

7 SUMMARY AND CONCLUSION

We presented a numerical framework for analysing AGN luminosity
histories based on the properties of large-scale massive molecular
outﬂows. The framework comprises two components. The ﬁrst is a
semi-analytical simulation tool that can track the propagation of adi-
abatic energy-driven outﬂows expanding in an arbitrary spherically
symmetric mass distribution illuminated by AGN with arbitrary
luminosity histories. The second is a neural network that takes in
outﬂow radii, velocities, mass outﬂow rates, current AGN lumi-
nosities and SMBH masses, and infers the AGN duty cycle over
the lifetime of the outﬂow, the typical duration of a single AGN
episode, the galaxy spheroid (bulge) mass, the gas fraction in the
bulge, and the fraction of the solid angle subtended by the outﬂow.
We trained the network with a sample of ∼ 40000 simulated
outﬂows and tested it on a further sample of ∼ 10000 simulated
outﬂows, with 200 data points per outﬂow. The network recovers
the true values of AGN duty cycle, bulge mass and outﬂow solid
angle fraction with no systematic oﬀset. Individual AGN episode
durations are recovered with a tendency to underestimate the longest
episodes, while a similar but weaker tendency is exhibited by the
bulge gas fraction predictions. Including the eﬀect of typical ob-
servational uncertainties of input parameters, the ﬁve parameters of
interest are recovered to within ∼ 20 − 25% of the true value.

We applied the neural network to a sample of 59 molecular
outﬂows in 46 galaxies. The present-day AGN luminosities range
between ∼ 1041.5 erg s−1 and ∼ 1047 erg s−1, while the Eddington
ratios encompass a range 10−4.54 < 𝑓Edd < 100.37. We split the
sample into three groups by Eddington ratio, into AGN that are
currently almost certainly accreting through a thin disc and driving
the ongoing outﬂow, AGN that currently almost certainly don’t have
a thin disc, and intermediate ones. We ﬁnd the following properties
of this AGN sample:

• AGN with high present-day Eddington ratios tend to have had
higher duty cycles over the lifetime of the outﬂow, although the
spread in duty cycle values is rather large; most AGN have duty
cycles higher than the long-term average, suggesting that outﬂows
are inﬂated during long SMBH growth phases that are composed
of numerous shorter growth episodes, i.e. that AGN episodes are
clustered hierarchically in time.

• Individual AGN episode durations range between 5 × 104 yr
and 3 × 105 yr, with no systematic dependence on Eddington ratio;
the most likely episode durations are (1 − 1.5) × 105 yr.

• Outﬂows subtend a wide variety of solid angles, from neg-
ligible to almost perfectly spherical; again, there is no systematic
dependence on Eddington ratio.

• The estimated bulge gas fractions tend to be low, 𝑓g,b < 0.1,
with most galaxies having 𝑓g,b < 0.05; this is consistent with the
expectation that galaxies in the local Universe tend to be gas-poor.
• Inferred bulge masses agree very well with the observed 𝑀BH−
𝑀b relation; since this relation was used when preparing the initial

MNRAS 000, 1–18 (2019)

Neural networks for AGN outﬂows

15

conditions of the simulations on which the neural network is trained,
we do not draw any strong conclusion from this result.

• In galaxies with multiple outﬂow observations, our results
agree with expectations based on the molecular tracers used for out-
ﬂow detection, i.e. OH-derived outﬂows tend to have smaller solid
angles and higher densities, as expected since OH traces denser gas.

The clear diﬀerence between galaxies with high and low duty
cycles implies that they should have other observable diﬀerences
as well. For example, galaxies with high duty cycles should have
massive gas reservoirs near their centres, such as circumnuclear
discs/rings that can feed the AGN eﬃciently in the presence of
feedback. The fact that AGN have probably been active for a long
time in these galaxies also suggests that they are the best targets to
look for evidence of immediate AGN feedback on star formation
or gas morphology. AGN with low duty cycles, on the other hand,
probably don’t have much of an eﬀect on their host galaxies on
timescales of several Myr.

Our results also suggest a few testable predictions regarding
the properties of the outﬂows and their prevalence. For example,
outﬂows should be visible in ∼ 20% of all galaxies, when averaged
across cosmic time. In local galaxies, this fraction should be lower
in proportion to the lower duty cycles of local AGN. In both cases,
just under half of those galaxies should host an AGN. The relation
between outﬂow kinetic power and inferred solid angle suggests that
AGN with powerful molecular outﬂows should have weak ionised
counterparts and vice versa.

The software we developed can be used to quickly analyse new
outﬂow data as it becomes available. It can also be adapted to inves-
tigate other AGN outﬂow models in a straightforward fashion. We
hope that this will be useful to the community advancing the un-
derstanding of multiphase AGN outﬂows, their driving mechanisms
and their impacts on host galaxies.

ACKNOWLEDGEMENTS

This research was funded by the Research Council Lithuania grant
no. S-MIP-20-43.

DATA AVAILABILITY

data was

new observational

No
ration
the
https://www.github.com/zadrras/magnofit.

this manuscript. The

of
results

presented

for
used

publicly

herein

taken

code

is

the
to
available

prepa-
produce
at

REFERENCES

Aalto S., Muller S., Sakamoto K., Gallagher J. S., Martín S., Costagliola F.,

2012, A&A, 546, A68

Agüero M. P., Díaz R. J., Dottori H., 2016, International Journal of Astron-

omy and Astrophysics, 6, 219

Audibert A., et al., 2019, A&A, 632, A33
Bae H.-J., Woo J.-H., Karouzos M., Gallo E., Flohic H., Shen Y., Yoon S.-J.,

2017, ApJ, 837, 91

Bandara K., Crampton D., Simard L., 2009, ApJ, 704, 1135
Barcos-Muñoz L., et al., 2018, ApJ, 853, L28
Best P. N., Heckman T. M., 2012, MNRAS, 421, 1569
Bischetti M., et al., 2019, A&A, 628, A118
Bland J., Tully B., 1988, Nature, 334, 43
Bolatto A. D., et al., 2013, Nature, 499, 450

16

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

Bower R. G., Benson A. J., Malbon R., Helly J. C., Frenk C. S., Baugh

C. M., Cole S., Lacey C. G., 2006, MNRAS, 370, 645

Bryan G. L., Norman M. L., 1998, ApJ, 495, 80
Carniani S., 2017, Frontiers in Astronomy and Space Sciences, 4, 24
Cicone C., Feruglio C., Maiolino R., Fiore F., Piconcelli E., Menci N.,

Aussel H., Sturm E., 2012, A&A, 543, A99

Cicone C., et al., 2014, A&A, 562, A21
Cicone C., Brusa M., Ramos Almeida C., Cresci G., Husemann B., Mainieri

V., 2018, Nature Astronomy, 2, 176

Clevert D.-A., Unterthiner T., Hochreiter S., 2015, arXiv e-prints, p.

arXiv:1511.07289

Combes F., et al., 2013, A&A, 558, A124
Combes F., et al., 2014, A&A, 565, A97
Courant R., Friedrichs K., Lewy H., 1928, Mathematische Annalen, 100, 32
Cowie L. L., McKee C. F., 1977, ApJ, 211, 135
Crenshaw D. M., Kraemer S. B., Schmitt H. R., Jaﬀé Y. L., Deo R. P., Collins

N. R., Fischer T. C., 2010, AJ, 139, 871
Croton D. J., et al., 2006, MNRAS, 365, 11
Dasyra K. M., Combes F., 2011, A&A, 533, L10
Davé R., Anglés-Alcázar D., Narayanan D., Li Q., Raﬁeferantsoa M. H.,

Appleby S., 2019, MNRAS, 486, 2827
Dubois Y., et al., 2014, MNRAS, 444, 1453
Fabian A. C., Vasudevan R. V., Gandhi P., 2008, MNRAS, 385, L43
Faucher-Giguère C.-A., Quataert E., 2012, MNRAS, 425, 605
Feruglio C., Maiolino R., Piconcelli E., Menci N., Aussel H., Lamastra A.,

Fiore F., 2010, A&A, 518, L155+

Feruglio C., Fiore F., Piconcelli E., Cicone C., Maiolino R., Davies R., Sturm

E., 2013, A&A, 558, A87

Fiore F., et al., 2017, A&A, 601, A143
Fluetsch A., et al., 2019, MNRAS, 483, 4586
Fluetsch A., et al., 2021, MNRAS, 505, 5753
Fujita Y., Kawakatu N., Nagai H., 2022, ApJ, 924, 24
García-Burillo S., Combes F., 2012,

in Journal of Physics Confer-
ence Series. p. 012050 (arXiv:1205.0758), doi:10.1088/1742-
6596/372/1/012050

García-Burillo S., Combes F., Schinnerer E., Boone F., Hunt L. K., 2005,

A&A, 441, 1011

García-Burillo S., et al., 2014, A&A, 567, A125
García-Burillo S., et al., 2015, A&A, 580, A35
González-Alfonso E., et al., 2017, ApJ, 836, 11
Gowardhan A., et al., 2018, ApJ, 859, 35
Greene J. E., Strader J., Ho L. C., 2020, Annual Review of Astronomy and

Astrophysics, 58, 257

Harrison C. M., Alexander D. M., Rosario D. J., Scholtz J., Stanley F., 2019,

arXiv e-prints, p. arXiv:1912.01020

Haykin S. S., 2009, Neural networks and learning machines, third edn.

Pearson Education

Heckman T. M., Best P. N., 2014, ARA&A, 52, 589
Hopkins P. F., Hernquist L., Martini P., Cox T. J., Robertson B., Di Matteo

King A. R., Pringle J. E., 2007, MNRAS, 377, L25
King A. R., Zubovas K., Power C., 2011, MNRAS, 415, L6
Kingma D. P., Ba J., 2014, arXiv e-prints, p. arXiv:1412.6980
Leon S., et al., 2007a, A&A, 473, 747
Leon S., et al., 2007b, A&A, 473, 747
Li S.-L., Cao X., 2009, MNRAS, 400, 1734
Lutz D., et al., 2020, A&A, 633, A134
Mac Low M.-M., McCray R., 1988, ApJ, 324, 776
Marasco A., et al., 2020, arXiv e-prints, p. arXiv:2009.11294
Martín-Navarro I., Shankar F., Mezcua M., 2021, MNRAS,
McConnell N. J., Ma C.-P., 2013, ApJ, 764, 184
McLaughlin D. E., King A. R., Nayakshin S., 2006, ApJ, 650, L37
McQuillin R. C., McLaughlin D. E., 2013, MNRAS, 434, 1332
Menci N., Fiore F., Feruglio C., Lamastra A., Shankar F., Piconcelli E.,

Giallongo E., Grazian A., 2019, ApJ, 877, 74

Merloni A., Heinz S., di Matteo T., 2003, MNRAS, 345, 1057
Morganti R., 2017, Frontiers in Astronomy and Space Sciences, 4, 42
Morganti R., Frieswĳk W., Oonk R. J. B., Oosterloo T., Tadhunter C., 2013,

A&A, 552, L4

Murray N., Quataert E., Thompson T. A., 2005, ApJ, 618, 569
Narayan R., Mahadevan R., Grindlay J. E., Popham R. G., Gammie C., 1998,

ApJ, 492, 554

Nardini E., et al., 2015, Science, 347, 860
Navarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493
Pereira-Santaella M., et al., 2016, A&A, 594, A81
Pereira-Santaella M., et al., 2018, A&A, 616, A171
Planck Collaboration et al., 2020, A&A, 641, A6
Puchwein E., Springel V., 2013, MNRAS, 428, 2966
Querejeta M., et al., 2016, A&A, 593, A118
Reeves J. N., O’Brien P. T., Ward M. J., 2003, ApJ, 593, L65
Reines A. E., 2022, Nature Astronomy, 6, 26
Richings A. J., Faucher-Giguère C.-A., 2018a, MNRAS, 474, 3673
Richings A. J., Faucher-Giguère C.-A., 2018b, MNRAS, 478, 3100
Richings A. J., Faucher-Giguère C.-A., Stern J., 2021, MNRAS, 503, 1568
Roy A., Nath B. B., Sharma P., Shchekinov Y., 2013, MNRAS, 434, 3572
Rupke D. S. N., Veilleux S., 2011, ApJ, 729, L27+
Rupke D. S. N., Gültekin K., Veilleux S., 2017, ApJ, 850, 40
Sakamoto K., Aalto S., Combes F., Evans A., Peck A., 2014, ApJ, 797, 90
Salak D., Nakai N., Hatakeyama T., Miyamoto Y., 2016, ApJ, 823, 68
Schawinski K., Koss M., Berney S., Sartori L. F., 2015, MNRAS, 451, 2517
Schaye J., et al., 2015, MNRAS, 446, 521
Scholtz J., et al., 2020, MNRAS, 492, 3194
Scholtz J., et al., 2021, MNRAS, 505, 5469
Shankar F., Weinberg D. H., Miralda-Escudé J., 2009, ApJ, 690, 20
Shankar F., Weinberg D. H., Miralda-Escudé J., 2013, MNRAS, 428, 421
Shankar F., et al., 2017, ApJ, 840, 34
Sharma M., Nath B. B., 2013, ApJ, 763, 17
Shin J., Woo J.-H., Chung A., Baek J., Cho K., Kang D., Bae H.-J., 2019,

ApJ, 881, 147

T., Springel V., 2005, ApJ, 625, L71

Sĳacki D., Springel V., Di Matteo T., Hernquist L., 2007, MNRAS, 380,

Hunter J. D., 2007, Computing in Science & Engineering, 9, 90
Husemann B., Scharwächter J., Bennert V. N., Mainieri V., Woo J. H.,

Kakkad D., 2016, A&A, 594, A44
Igo Z., et al., 2020, MNRAS, 493, 1088
Ishibashi W., Fabian A. C., Maiolino R., 2018, MNRAS, 476, 512
Izumi T., Kawakatu N., Kohno K., 2016, ApJ, 827, 81
Jarvis M. E., et al., 2020, MNRAS, 498, 1560
Keel W. C., et al., 2017, ApJ, 835, 256
Khrykin I. S., Hennawi J. F., Worseck G., 2019, MNRAS, 484, 3897
Khrykin I. S., Hennawi J. F., Worseck G., Davies F. B., 2021, MNRAS, 505,

649

King A., 2003, ApJ, 596, L27
King A., 2005, ApJ, 635, L121
King A. R., 2010a, MNRAS, 402, 1516
King A. R., 2010b, MNRAS, 408, L95
King A., Nixon C., 2015, MNRAS, 453, L46
King A. R., Pounds K. A., 2003, MNRAS, 345, 657
King A., Pounds K., 2015, ARA&A, 53, 115

877

Sądowski A., Narayan R., Penna R., Zhu Y., 2013, MNRAS, 436, 3856
Strickland D. K., Stevens I. R., 2000, MNRAS, 314, 511
Stuber S. K., et al., 2021, A&A, 653, A172
Sturm E., et al., 2011, ApJ, 733, L16+
Sun A.-L., Greene J. E., Zakamska N. L., Nesvadba N. P. H., 2014, ApJ,

790, 160

Tombesi F., Cappi M., Reeves J. N., Palumbo G. G. C., Yaqoob T., Braito

V., Dadina M., 2010a, A&A, 521, A57+

Tombesi F., Sambruna R. M., Reeves J. N., Braito V., Ballo L., Goﬀord J.,

Cappi M., Mushotzky R. F., 2010b, ApJ, 719, 700

Tombesi F., Meléndez M., Veilleux S., Reeves J. N., González-Alfonso E.,

Reynolds C. S., 2015, Nature, 519, 436

Tremblay G. R., et al., 2018, ApJ, 865, 13
Tremmel M., et al., 2019, MNRAS, 483, 3336
Tsai A.-L., et al., 2009, PASJ, 61, 237
Tsai A.-L., Matsushita S., Kong A. K. H., Matsumoto H., Kohno K., 2012,

ApJ, 752, 38

MNRAS 000, 1–18 (2019)

Veilleux S., Bolatto A., Tombesi F., Meléndez M., Sturm E., González-

Alfonso E., Fischer J., Rupke D. S. N., 2017, ApJ, 843, 18

Venturi G., et al., 2018, A&A, 619, A74
Vogelsberger M., et al., 2014, MNRAS, 444, 1518
Walter F., Weiss A., Scoville N., 2002, ApJ, 580, L21
Walter F., et al., 2017, ApJ, 835, 265
Wang J.-M., Chen Y.-M., Zhang F., 2006, ApJ, 647, L17
Zschaechner L. K., et al., 2016, ApJ, 832, 142
Zubovas K., 2018, MNRAS, 473, 3525
Zubovas K., King A. R., 2012a, MNRAS, 426, 2751
Zubovas K., King A., 2012b, ApJ, 745, L34
Zubovas K., King A. R., 2014, MNRAS, 439, 400
Zubovas K., King A., 2016, MNRAS, 462, 4055
Zubovas K., King A., 2019, MNRAS, 484, 1829
Zubovas K., Nardini E., 2020, MNRAS, 498, 3633
Zubovas K., Nayakshin S., 2014, MNRAS, 440, 2625
Zubovas K., Nayakshin S., King A., Wilkinson M., 2013, MNRAS, 433,

3079

APPENDIX A: DERIVATION OF THE EQUATION OF
MOTION

Here we show, for convenience, a step-by-step derivation of the
outﬂow equation of motion (eq. 3).

We start with the appropriate formulation of Newton’s Second

Law:

d
d𝑡

(cid:0)𝑀 (cid:164)𝑅(cid:1) = 4𝜋𝑅2𝑃 −

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

,

(A1)

where the left-hand side refers to the change in outﬂow momentum,
the ﬁrst right-hand side term is the driving force and the ﬁnal term
is the weight of the gas. We also use the energy equation

d
d𝑡

(cid:19)

(cid:18) 𝑃𝑉
𝛾 − 1

𝜂
2

=

𝐿AGN − 𝑃

d𝑉
d𝑡

−

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

(cid:164)𝑅,

(A2)

where the left-hand side speciﬁes the enthalpy of the outﬂowing
gas, and the right-hand terms are the driving luminosity, rate of
𝑃d𝑉 work and rate of work against gravity. The volume of the
shocked wind bubble is 𝑉 = 4𝜋𝑅3/3. Using this expression and eq.
(A1), we can simplify two of the terms in eq. (A2):

Neural networks for AGN outﬂows

17

Figure B1. Same as Figure 2, but the parameter values were recovered
using a point matching algorithm. Only a weak correlation between actual
and recovered values is visible.

terms and moving the factor (𝛾 − 1) to the right-hand side:

(cid:165)𝑀 𝑅 (cid:164)𝑅 + (cid:164)𝑀 (cid:164)𝑅2 + 2 (cid:164)𝑀 𝑅 (cid:165)𝑅 + 𝑀 (cid:164)𝑅 (cid:165)𝑅 + 𝑀 𝑅 (cid:168)𝑅
3

+

𝐺 (cid:0) (cid:164)𝑀 𝑀pot + 𝑀 (cid:164)𝑀pot + 𝑀 (cid:164)𝑀(cid:1)
3𝑅

+

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1) (cid:164)𝑅
3𝑅2

−

=

= (𝛾 − 1)

(cid:18) 𝜂
2

𝐿AGN − (cid:164)𝑀 (cid:164)𝑅2 − 𝑀 (cid:164)𝑅 (cid:165)𝑅 −

2𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

(cid:19)

(cid:164)𝑅

.

(A6)

Finally, we multiply both sides by 3/(𝑀 𝑅) and rearrange again to
get an expression for (cid:168)𝑅, which is the ﬁnal equation of motion (eq.
3):

(cid:168)𝑅 =

3 (𝛾 − 1)
𝑀 𝑅

(cid:16) 𝜂
2

𝐿AGN − 𝐴

(cid:17)

− 𝐵,

where

𝐴 = (cid:164)𝑀 (cid:164)𝑅2 + 𝑀 (cid:164)𝑅 (cid:165)𝑅 +

(cid:18)

𝑀

2𝐺 (cid:164)𝑅
𝑅2

𝑀pot +

(cid:19)

𝑀
2

(cid:165)𝑀 (cid:164)𝑅
𝑀

(cid:164)𝑀 (cid:164)𝑅2
+
𝑀 𝑅
(cid:34) 𝑀pot (cid:164)𝑀
𝑀

2 (cid:164)𝑀 (cid:165)𝑅
𝑀

+

+

(cid:164)𝑅 (cid:165)𝑅
𝑅

+

+ (cid:164)𝑀 + (cid:164)𝑀pot −

(cid:18)

𝑀pot +

(cid:35)

.

𝑀
2

(cid:19) (cid:164)𝑅
𝑅

(A7)

(A8)

(A9)

𝑃𝑉 = 4𝜋𝑅2𝑃

=

(cid:20) d
𝑅
3
d𝑡
(cid:164)𝑀 𝑅 (cid:164)𝑅 + 𝑀 𝑅 (cid:165)𝑅
3

+

(cid:0)𝑀 (cid:164)𝑅(cid:1) +

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2
𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
3𝑅

;

(cid:21) 𝑅
3

=

(A3)

and

𝐵 =

= 4𝜋𝑅2𝑃 (cid:164)𝑅 = (cid:164)𝑀 (cid:164)𝑅2 + 𝑀 (cid:164)𝑅 (cid:165)𝑅 +

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1)
𝑅2

(cid:164)𝑅.

(A4)

+

𝐺
𝑅2

=

𝑃

d𝑉
d𝑡

Taking the time derivative of eq. (A3) gives

d
d𝑡

(𝑃𝑉) =

(cid:165)𝑀 𝑅 (cid:164)𝑅 + (cid:164)𝑀 (cid:164)𝑅2 + 2 (cid:164)𝑀 𝑅 (cid:165)𝑅 + 𝑀 (cid:164)𝑅 (cid:165)𝑅 + 𝑀 𝑅 (cid:168)𝑅
3

+

𝐺 (cid:0) (cid:164)𝑀 𝑀pot + 𝑀 (cid:164)𝑀pot + 𝑀 (cid:164)𝑀(cid:1)
3𝑅

+

𝐺 𝑀 (cid:0)𝑀pot + 𝑀/2(cid:1) (cid:164)𝑅
3𝑅2

.

−

(A5)

We can now rearrange the energy equation, inserting these expanded

MNRAS 000, 1–18 (2019)

APPENDIX B: AN UNSUCCESSFUL ATTEMPT TO
MATCH OBSERVABLE OUTFLOW PROPERTIES WITH
AGN LUMINOSITY HISTORIES

Our initial attempt to determine AGN luminosity histories from ob-
servable outﬂow properties was based on a straightforward point
matching algorithm. We used the same simulated outﬂow data as
the neural network samples (see Section 6.5 above). We took in-
dividual data points from the ‘testing’ sample and tried to match

18

K. Zubovas, J. Bialopetravičius, M. Kazlauskait˙e

This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.

Figure C1. Inferred parameters of real galaxies with observed outﬂows. The
data is identical to that of Fig. 4, but the galaxies are grouped by activity
type into Type 1 (unobscured AGN), Type 2 (obscured AGN), LINER and
HII.

them to their neighbours in the ‘training’ sample based on the ﬁve
measurable properties: outﬂow radius, velocity, mass outﬂow rate,
AGN luminosity and SMBH mass. We scaled the value of each
parameter so that its range in the ‘training’ sample became [0; 1].
Then we measured the distance between points in the ‘testing’ sam-
ple and points in the ‘training’ sample as a Euclidean distance in
this ﬁve-dimensional space, selected the 50 nearest neighbours and
considered the average values of the relevant parameters. This pro-
cess was computationally ineﬃcient, so we used only a subsample
of 25000 points from the ‘testing’ sample.

The results are shown in Figure B1. Clearly, the matching
is very poor, with only a slight correlation between actual and
recovered parameter values. Changing the number of neighbours,
the subsample size and the scaling of measurable parameter values
did not lead to signiﬁcant improvements.

APPENDIX C: INFERRED OUTFLOW PROPERTIES
BASED ON GALAXY TYPES

In principle, it is possible for galaxies with diﬀerent types of ac-
tive nuclei to have very diﬀerent outﬂows and/or activity histories.
To check for this possibility, we plot, in Figure C1, the inferred
parameters of our real outﬂow sample, but grouping galaxies by
activity type rather than the Eddington factor. At ﬁrst glance, none
of the parameters show any systematic diﬀerences among the four
groups. Considering the mean parameter values in the diﬀerent
groups, we ﬁnd that Type 1 AGN tend to have the highest duty
cycles and outﬂow solid angle fractions, but both parameters also
have a signiﬁcant scatter. Objects classiﬁed as HII (i.e. those where
the ionisation is dominated by star formation) have the lowest in-
ferred duty cycles and gas fractions. The low duty cycles can be
expected, because these objects also tend to have low AGN lumi-
nosities. Nevertheless, we conclude that there are no statistically
signiﬁcant diﬀerences when considering objects based on the type
of active nucleus.

MNRAS 000, 1–18 (2019)

