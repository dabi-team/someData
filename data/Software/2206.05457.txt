2
2
0
2

n
u
J

1
1

]
E
S
.
s
c
[

1
v
7
5
4
5
0
.
6
0
2
2
:
v
i
X
r
a

Testing Ocean Software with Metamorphic Testing

Quang-Hung Luu
Swinburne University of Technology
Hawthorn, Victoria, Australia
hluu@swin.edu.au

Tsong Yueh Chen
Swinburne University of Technology
Hawthorn, Victoria, Australia
tychen@swin.edu.au

Huai Liu
Swinburne University of Technology
Hawthorn, Victoria, Australia
hliu@swin.edu.au

Hai L. Vu
Monash University
Clayton, Victoria, Australia
hai.vu@monash.edu

ABSTRACT
Advancing ocean science has a signiï¬cant impact to the develop-
ment of the world, from operating a safe navigation for vessels
to maintaining a healthy and diverse ocean ecosystem. Various
ocean software systems have been extensively adopted for diï¬€er-
ent purposes, for instance, predicting hourly sea level elevation
across shorelines, simulating large-scale ocean circulations, as well
as integrating into Earth system models for weather forecasts and
climate projections. Regardless of their signiï¬cance, guaranteeing
the trustworthiness of ocean software and modelling systems is a
long-standing challenge. The testing of ocean software suï¬€ers a
lot from the so-called oracle problem, which refers to the absence
of test oracles mainly due to the nonlinear interactions of multi-
ple physical variables and the high complexity in computation. In
the ocean, observed tidal signals are distorted by non-deterministic
physical variables, hindering us from knowing the â€œtrueâ€ astro-
nomical tidal constituents existing in the timeseries. In this paper,
we present how to test tidal analysis and prediction (TAP) soft-
ware based on metamorphic testing (MT), a simple yet eï¬€ective
testing approach to the oracle problem. In particular, we construct
metamorphic relations from the periodic property of astronomical
tide, and then use them to successfully detect a real-life defect in
an open-source TAP software. We also conduct a series of exper-
iments to further demonstrate the applicability and eï¬€ectiveness
of MT in the testing of TAP software. Our study not only justiï¬es
the potential of MT in testing more complex ocean software and
modelling systems, but also can be expanded to assess and improve
the quality of a broader range of scientiï¬c simulation software sys-
tems.

CCS CONCEPTS
â€¢ Applied computing â†’ Earth and atmospheric sciences; â€¢
Software and its engineering â†’ Software testing and debug-
ging.

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proï¬t or commercial advantage and that copies bear this notice and the full cita-
tion on the ï¬rst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciï¬c permission
and/or a fee. Request permissions from permissions@acm.org.
METâ€™22, May 9, 2022, Pittsburgh, PA, USA
Â© 2022 Association for Computing Machinery.
ACM ISBN 978-1-4503-9307-2/22/05. . . $15.00
https://doi.org/10.1145/3524846.3527341

KEYWORDS
Metamorphic testing, metamorphic relation, ocean software, scien-
tiï¬c simulation, tidal analysis and prediction

ACM Reference Format:
Quang-Hung Luu, Huai Liu, Tsong Yueh Chen, and Hai L. Vu. 2022. Testing
Ocean Software with Metamorphic Testing. In 7th International Workshop
on Metamorphic Testing (METâ€™22), May 9, 2022, Pittsburgh, PA, USA. ACM,
New York, NY, USA, 8 pages. https://doi.org/10.1145/3524846.3527341

1 INTRODUCTION
Our Earth is actually a world of water as over 70% of its surface
is covered by the ocean. Ocean science, also being referred to as
marine science or oceanography, is an important discipline of the
Earth sciences, covers a wide range of topics, from ocean circula-
tion, waves, storm surge, sea level rise, heat content, water trans-
port to ecosystem dynamics, ocean acidiï¬cation and plate tectonics
of the sea bed [38]. In the current computing age, various software
systems have been developed to support the ocean modelling and
computations, which help our scientists simulate, model and pre-
dict ocean conditions, and thus assist the relevant industries and
human activities as well as contribute to advance other disciplines
[8].

Being a dynamic of the ocean, astronomical tide is the periodic
variability of sea levels on the Earth exerted by gravitational forces
of the Moon and the Sun. We are hence unable to observe the pure
astronomical tide in sea level elevations. Instead, sea level eleva-
tions are a result of co-existence and interaction between tides
and other non-deterministic variables such as surface wind, atmo-
spheric pressure and ocean currents at multiple spatio-temporal
scales [23]. In other words, it is a great challenge to correctly obtain
the â€œpureâ€ astronomical tidal constituents from sea level records.

Tidal analysis and prediction (TAP) software is an ocean soft-
ware and modelling system. It is developed to decompose tidal con-
stituents from timeseries (i.e., series of data points arranged in the
time order) of the sea level elevation, and adopt them to predict
future sea level [7, 12, 28]. Having correct astronomical tidal con-
stituents is a critical task because it contributes to assure a safe ves-
sel navigation, validate complex ocean modelling systems [21, 27],
estimate the rate of sea level rise [23, 37, 39], and even support the
claims on oceanographic territories [24]. On one hand, it is diï¬ƒ-
cult to isolate pure astronomical tidal constituents. On the other
hand, the TAP software is prone to defects and bugs. Because of
both physical and computational reasons, it is diï¬ƒcult to deter-
mine whether the outcome from the TAP software is correct.

 
 
 
 
 
 
METâ€™22, May 9, 2022, Pittsburgh, PA, USA

Q.-H. Luu et al.

It is a prevalent problem in many ocean software and modelling
systems, including TAP software, that there does not exist a sys-
tematic mechanism, namely the oracle, to check the correctness of
the computation result given any program input. Such a problem
is termed as the oracle problem in the context of software testing.
Among all testing techniques, metamorphic testing (MT) [2, 5, 34]
has been demonstrated as very eï¬€ective in addressing the oracle
problem which has helped reveal many longstanding real-life bugs
in a wide variety of software systems. The core component of MT
is a set of metamorphic relations (MRs), which are basically the
necessary properties of the target algorithm, represented as the
relationships among multiple inputs and their corresponding ex-
pected outputs. Numerous studies [5, 34, 35] have shown that if
well-deï¬ned, even a simple MR could help detect non-trivial bugs
in a complicated system that suï¬€ers from the oracle problem.

Several studies have been conducted to use MT to test the soft-
ware for scientiï¬c computations and simulations. For instances,
in testing simulations, MT has been successfully adopted to test
agent-based (ABM) and discrete-event (DES) simulations [26], hy-
brid ABM and DES systems [11], health care simulation [25], web-
enabled simulation [1], and simulator platform for self-driving cars
[36, 41]. In testing scientiï¬c software, MT is an eï¬€ective technique
to detect faults in simulation programs for designing nuclear power
plants [14], bioinformatics programs [4], epidemiological models
[31, 33], chemical reaction networks for prototyping nano-scale
molecular devices [13], matrix calculation programs [32], solvers
for partial diï¬€erential equations [3], multiple linear regression soft-
ware [22], ocean modelling [16], storm water management model
systems [19], machine learning-based hydro-logical models [40],
Monte-Carlo computational programs [10, 30], serverless scientiï¬c
applications [20], as well as other types of scientiï¬c software [9, 18,
19, 29]. For example, He et al. [14] has found 33 bugs in simulation
programs that are used to design and analyze nuclear power plants
in a study that adopts MT.

In this paper, we demonstrate how to test TAP software using
MT. Seven MRs are identiï¬ed and applied to test UTide, a real-life
and open-source TAP software. The paper has the following three
contributions:

â€¢ Based on the fundamental features of TAP, we propose two
strategies for identifying MRs that are particularly suitable
for TAP software.

â€¢ The testing based on our MRs has revealed a real-life defect

in UTide.

â€¢ A series of experimental studies have been conducted to
demonstrate the applicability and eï¬€ectiveness of MT in the
testing of TAP software, and more broadly, ocean software.

The rest of the paper is organized as follows. In Section 2, we
introduce the background information of the present work, includ-
ing the basic concepts of MT and TAP. In Section 3, we present two
strategies of identifying MRs for TAP software, based on which, we
deï¬ne seven MRs for this study. The settings for our experimental
studies are presented in Section 4, while the experimental results
are analyzed in Section 5. We further discuss the results in Section 6
and the related work in Section 7. Finally, the paper is summarized
in Section 8.

2 BACKGROUND
2.1 Metamorphic Testing
Metamorphic testing (MT) was ï¬rst proposed in 1990s as an ap-
proach for test case generation [6]. MRs are leveraged to transform
some existing test cases into new test cases. The basic steps for MT
are as follows:

(1) Identify necessary properties of the target program and rep-
resent them in the form of MRs, that is, the relations among
multiple inputs and their corresponding expected outputs.
(2) Generate source test cases using other test case generation

techniques.

(3) Execute the source test cases.
(4) Construct follow-up test cases based on MRs and the source
test cases (and even their test results obtained in Step (3)).

(5) Execute the follow-up test cases.
(6) Check the test results in Steps (3) & (5) against the corre-

sponding MRs.

Note that MT makes use of MRs, instead of a test oracle, to verify
the test results, as shown in the above Step (6). If an MR is violated
in Step (6), we can say that a defect has been revealed. In other
words, MRs provide an alternative mechanism to the oracle for test
result veriï¬cation, thus addressing the oracle problem.

Let us look at the following example to further illustrate how
MT works. Suppose that a program ğ‘ƒ calculates the shortest path
between two nodes ğ‘ and ğ‘ in an undirected graph ğº. One possi-
ble MR can be deï¬ned as follows: Given a node ğ‘ that appears in
the shortest path between ğ‘ and ğ‘, the length of the shortest path
between ğ‘ and ğ‘ should be equal to the sum of the length of the
shortest paths between ğ‘ and ğ‘ and that between ğ‘ and ğ‘. Assume
that we already have the source test case (ğº, ğ‘, ğ‘). We execute this
test case and select a node ğ‘ from the execution result ğ‘ƒ (ğº, ğ‘, ğ‘)
(that is, the shortest path composed of a series of nodes). Then, we
can construct two follow-up test cases, (ğº, ğ‘, ğ‘) and (ğº, ğ‘, ğ‘), the ex-
ecution results of which are ğ‘ƒ (ğº, ğ‘, ğ‘) and ğ‘ƒ (ğº, ğ‘, ğ‘), respectively.
Finally, we check whether the relation |ğ‘ƒ (ğº, ğ‘, ğ‘)| = |ğ‘ƒ (ğº, ğ‘, ğ‘)| +
|ğ‘ƒ (ğº, ğ‘, ğ‘)| holds or not. If the relation does not hold, it means that
the MR is violated, which, in turn, implies the detection of a defect.

2.2 Tidal Analysis and Prediction
Consider a time series of sea level observations ğ‘¦ (ğ‘¡) where ğ‘¡ =
ğ‘¡1, ğ‘¡2, . . . , ğ‘¡ğ‘€ and ğ‘€ is an odd integer. Assume the sea level is a
combination of ğ‘ astronomical tidal constituents with frequencies
ğœ1, ğœ2, . . . , ğœğ‘ , each of which is constructed from a unique com-
bination of six Doodson numbers. These numbers are associated
with the mean longitudes of the Moon, the Sun, the lunar perigee
and the solar perigee, together with the negative of the longitude
of the Moonâ€™s ascending node and the mean lunar time [12]. Tidal
response model equation [12, 28] is as follows:

Ë†ğ‘¦(ğ‘¡) = Ë†ğ‘0 + Ë†ğ‘1ğ‘¡ +

ğ‘

Ã•
ğ‘˜=1

Ë†ğ‘ğ‘˜ğ‘’ğ‘–ğœğ‘˜ğ‘¡ + Ë†ğ‘âˆ’ğ‘˜ğ‘’âˆ’ğ‘–ğœğ‘˜ğ‘¡

(1)

Testing Ocean Software with Metamorphic Testing

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

where Ë†ğ‘âˆ’ğ‘˜ and Ë†ğ‘âˆ’ğ‘˜ are unknown (complex) amplitude and ğ‘– is the
imaginary unit. Its conjunction form in real numbers is as follows:

where

Ë†ğ‘¦(ğ‘¡) = Ë†ğ‘0 + Ë†ğ‘1ğ‘¡ +

ğ‘

Ã•
ğ‘˜=1

Ë†ğµğ‘˜ cos ğœğ‘˜ğ‘¡ + Ë†ğ¶ğ‘˜ sin ğœğ‘˜ğ‘¡ (cid:17)

(cid:16)

(2)

X(ğ‘¡) =

= ğ‘– ( Ë†ğ‘ğ‘˜ âˆ’ Ë†ğ‘âˆ’ğ‘˜ )/2. Alternatively, the
where Ë†ğµğ‘˜
response model can also be represented by the following equation:

= ( Ë†ğ‘ğ‘˜ + Ë†ğ‘âˆ’ğ‘˜ )/2 and Ë†ğ¶ğ‘˜

Ë†ğ‘¦ (ğ‘¡) = Ë†ğ‘0 + Ë†ğ‘1ğ‘¡ +

ğ‘

Ã•
ğ‘˜=1

Ë†ğ´ğ‘˜ cos (ğœğ‘˜ğ‘¡ + Ë†ğœ™ğ‘˜ )

(3)

where the amplitude Ë†ğ´ğ‘˜ and the phase Ë†ğœ™ğ‘˜ of a tidal constituent ğ‘˜
are deï¬ned in terms of Ë†ğµğ‘˜ and Ë†ğ¶ğ‘˜ as follows:

Ë†ğ´ğ‘˜
Ë†ğœ™ğ‘˜

= q Ë†ğµğ‘˜ + Ë†ğ¶ğ‘˜
= arctan (âˆ’ Ë†ğ¶ğ‘˜/ Ë†ğµğ‘˜ )

(4)

After the equation is solved, some corrections can be applied.
First, the computed phases Ë†ğœ™ğ‘˜ (ğ‘˜ = 1, 2, . . . , ğ‘ ) are referenced to
the â€œGreenwich phaseâ€, which is deï¬ned as the phase of the equi-
librium response at 0â—¦ longitude (the Greenwich meridian). Second,
nodal or satellite corrections are applied if a latitude is speciï¬ed in
the conï¬gurable input; otherwise, it will use a default value.

A process for TAP consists of two modes. In the analysis mode,
the TAP software takes the input of raw timeseries of sea level
elevation ğ‘¦ (ğ‘¡) at time steps ğ‘¡ = ğ‘¡1, ğ‘¡2, . . . , ğ‘¡ğ‘€ . It will also use other
inputs such as tidal frequencies, conï¬guration for which algorithm
to be used for ï¬tting, the latitude of tide gauge or the adoption of a
trend. If any of these inputs is not provided, it will be automatically
determined by the TAP software, through either assigning a de-
fault value or computing it using relevant algorithms. For instance,
frequencies of ğ‘ astronomical tidal constituents ğœ1, ğœ2, . . . , ğœğ‘ can
be either given by users or determined by the TAP itself, at the dis-
cretion of the users. The output of analysis mode consists of tidal
amplitudes Ë†ğ´1, Ë†ğ´2, . . . , Ë†ğ´ğ‘ and phases Ë†ğœ™1, Ë†ğœ™2, . . . , Ë†ğœ™ğ‘ together with
the intercept Ë†ğ‘1 and the trend Ë†ğ‘2. In the prediction mode, the TAP
software uses the determined tidal constants Ë†ğ´1, Ë†ğ´2, . . . , Ë†ğ´ğ‘ and
phases Ë†ğœ™1, Ë†ğœ™2, . . . , Ë†ğœ™ğ‘ as well as Ë†ğ‘1 and Ë†ğ‘2 to predict the sea level
elevation Ë†ğ‘¦ (ğ‘¡) at a given time ğ‘¡ according to Equation 3.

3 METAMORPHIC RELATIONS FOR TAP

SOFTWARE

Considering the unique features of TAP software, we design two
strategies to derive MRs. The ï¬rst approach is to construct MRs
based on the core mathematical framework for the TAP, namely
regression. The second approach is to construct MRs based on the
properties of tidal waves.

3.1 Regression-based MRs
We can reformulate Equation 2 in the matrix form as follows:

1
ğ‘¡1
ï£®
ï£¯
cos ğœ1ğ‘¡1
ï£¯
ï£¯
sin ğœ1ğ‘¡1
ï£¯
ï£¯
. . .
ï£¯
ï£¯
cos ğœğ‘ ğ‘¡1
ï£¯
ï£¯
sin ğœğ‘ ğ‘¡1
ï£¯
ï£¯
ï£¯
Ë†ğ‘0
ï£°
(cid:2)
Ë†ğ‘¦(ğ‘¡1)
(cid:2)

1
ğ‘¡2
cos ğœ1ğ‘¡2
sin ğœ1ğ‘¡2
. . .
cos ğœğ‘ ğ‘¡2
sin ğœğ‘ ğ‘¡2
Ë†ğ¶1
Ë†ğµ1
Ë†ğ‘¦(ğ‘¡2)
. . .

Ë†ğ‘1

. . .
. . .
. . .
. . .
. . .
. . .
. . .
Ë†ğ¶ğ‘ (cid:3)

;

1
ğ‘¡3
cos ğœ1ğ‘¡3
sin ğœ1ğ‘¡3
. . .
cos ğœğ‘ ğ‘¡3
sin ğœğ‘ ğ‘¡3
Ë†ğµğ‘

. . .

Ë†ğ‘¦ (ğ‘¡ğ‘€ )

(cid:3)

1
ğ‘¡ğ‘€
cos ğœ1ğ‘¡ğ‘€
sin ğœ1ğ‘¡ğ‘€
. . .
cos ğœğ‘ ğ‘¡ğ‘€
sin ğœğ‘ ğ‘¡ğ‘€

;

ï£¹
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£»

(6)

Ë†ğ›½âˆ— =
Ë†y(ğ‘¡) =

This equation can be solved using the ordinary least square (OLS)

regression, which gives us the unique solution

Ë†ğ›½âˆ— = (XXğ‘‡ )âˆ’1Xy(ğ‘¡)

(7)

where

y(ğ‘¡) =

ğ‘¦ (ğ‘¡2)
(8)
In the analysis, the output coeï¬ƒcient Ë†ğ›½ is commonly used as the

ğ‘¦ (ğ‘¡1)
(cid:2)

ğ‘¦ (ğ‘¡ğ‘€ )

. . .

(cid:3)

Ë†ğ›½ =

output which is deï¬ned as follows
Ë†ğœ™1
where the coeï¬ƒcients of Ë†ğ›½ are derived from the coeï¬ƒcients of Ë†ğ›½âˆ—
according to Equation 4 and Equation 6.

Ë†ğœ™ğ‘ (cid:3)

Ë†ğ‘0
(cid:2)

Ë†ğ´ğ‘

Ë†ğ´1

. . .

Ë†ğ‘1

(9)

2, ğ‘¦ğ‘ 

ğ‘€, ğ‘¦ğ‘ 

1), (ğ‘¡ğ‘ 

2), . . . , (ğ‘¡ğ‘ 

Hereby, we reuse some MRs that have been developed in our
previous study for the multiple linear regression (MLR) [22]. Given
the source test case ğ¼ğ‘  = {(ğ‘¡ğ‘ 
1, ğ‘¦ğ‘ 
ğ‘€ )} and the
corresponding output ğ‘‚ğ‘  = { Ë†ğ›½ğ‘  }. It should be noted that regres-
sion and TAP software are designed to solve diï¬€erent problems
though they are based on the same mathematical approach. There-
fore, they have some common MRs but also some diï¬€erent MRs.
For example, we have an MR related to swapping or rotating two
timeseries (i.e., the data for two variables) in the regression, but
such kind of MRs cannot be deï¬ned for the TAP software. In this
study, ï¬ve MRs are reused to the TAP software as described as fol-
lows.

MR1: Inserting a predicted point. Assume (ğ‘¡ğ‘, ğ‘¦ğ‘ ) is a predicted
point using Equation 2. The follow-up test case can be constructed
=
by ğ¼ ğ‘“
{ Ë†ğ›½ğ‘“ }. Thus, this MR should have the relation Ë†ğ›½ğ‘“

(ğ‘¡ğ‘, Ë†ğ‘¦ğ‘ ), and the follow-up output should be ğ‘‚ ğ‘“

= Ë†ğ›½ğ‘  .

= ğ¼ğ‘ 

Ã

1

= âˆ’ Ë†ğ›¼0

= âˆ’ Ë†ğ›¼1

ğ‘— and Ë†ğ›¼ ğ‘“

= âˆ’ğ¼ğ‘ , then Ë†ğ›¼ ğ‘“
0

MR2: Reï¬‚ecting the sea level. The follow-up test case can be con-
structed by having ğ¼ ğ‘“
ğ‘— . When
there is only one astronomical tidal constituent (ğ‘ = 1), the rela-
tion should also consist of Ë†ğ´ğ‘“
= Ë†ğ´ğ‘ 
1.
1
MR3: Shifting the sea level. The follow-up test case can be con-
= ğ¼ğ‘  + â„, where â„ is a real number, and then
structed by having ğ¼ ğ‘“
the intercept is shifted accordingly whilst other components of Ë†ğ›½
are unchanged; that is, Ë†ğ›¼ ğ‘“
= Ë†ğœ™ğ‘ 
0
ğ‘˜
for ğ‘˜ = 1, 2, . . . , ğ‘ .

0 +â„ and Ë†ğ›¼ ğ‘“

ğ‘˜, Ë†ğœ™ ğ‘“

1, Ë†ğ´ğ‘“

= Ë†ğ´ğ‘ 

= Ë†ğ›¼ğ‘ 

= Ë†ğ›¼ğ‘ 

ğ‘˜

ğ‘˜

1

MR4: Scaling the sea level. The follow-up test case can be con-

= ğ›¾ğ¼ğ‘  , where ğ›¾ is a real number, and then the amplitude-

structed by ğ¼ ğ‘“
related components of the follow-up output is scaled proportion-
ally, that is, Ë†ğ›¼ ğ‘“
1, Ë†ğ´ğ‘“
0
ğ‘˜
MR5: Swapping samples. If we swap two points in the input,

ğ‘˜ for ğ‘˜ = 1, 2, . . . , ğ‘ .

0, Ë†ğ›¼ ğ‘“

= ğ›¾ Ë†ğ´ğ‘ 

= ğ›¾ Ë†ğ›¼ğ‘ 

= ğ›¾ Ë†ğ›¼ğ‘ 

1

Ë†y(ğ‘¡) = Xğ‘‡ (ğ‘¡) Ë†ğ›½âˆ—

(5)

then the follow-up output is the same, that is, Ë†ğ›½ğ‘“

= Ë†ğ›½ğ‘  .

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

Q.-H. Luu et al.

3.2 Domain-speciï¬c MRs
MR6: Cancellation of signals. Consider the sea level elevation in-
duced by a single tidal constituent component without a trend, that
is, we have

Ë†ğ‘¦(ğ‘¡) = Ë†ğ‘0 + Ë†ğ´1 cos (ğœ1ğ‘¡ + Ë†ğœ™1)
In the follow-up test case, the signal is cancelled by the predicted
1 cos (ğœ1ğ‘¡ + Ë†ğœ™ğ‘ 
component, ğ‘¦ ğ‘“ = ğ‘¦ğ‘  âˆ’ Ë†ğ´ğ‘ 
1). Then, we should have
Ë†ğ´ğ‘“
= 0. MR6 comes from the intuition that if we suppress the
1
oscillation of a tidal constituent, then this wave component is no
longer part of the timeseries.

(10)

MR7: Periodic shift of signals. Consider the sea level elevation

induced by a single tidal constituent with a trend, that is

(11)

Ë†ğ‘¦ (ğ‘¡) = Ë†ğ‘0 + Ë†ğ‘1ğ‘¡ + Ë†ğ´1 cos (ğœ1ğ‘¡ + Ë†ğœ™1)
2 , . . . , ğ‘¡ ğ‘“

1 , ğ‘¡ ğ‘“
In the follow-up test case, the timeseries ğ‘¡ ğ‘“
ğ‘€ are all shifted
by a magnitude of 2ğœ‹/ğœ1, that is, ğ‘¡ ğ‘“
ğ‘— + 2ğœ‹/ğœ1 for ğ‘— = 1, 2, . . . , ğ‘€.
ğ‘—
The follow-up output is then expected to be Ë†ğ‘ğ‘“
0 âˆ’2ğœ‹ Ë†ğ‘ğ‘ 
1/ğœ1, and
0
Ë†ğ‘ğ‘“
1. The rationale for MR7 is the periodic
1
property of a tidal wave which requires the tide to be the same
after a full period.

1, Ë†ğ´ğ‘“

1, Ë†ğœ™ ğ‘“

= Ë†ğ´ğ‘ 

= Ë†ğœ™ğ‘ 

= Ë†ğ‘ğ‘ 

= Ë†ğ‘ğ‘ 

= ğ‘¡ğ‘ 

1

1

4 EXPERIMENTS
4.1 Research questions
In this study, we attempt to answer the following three research
questions (RQs):

RQ1: Can MT help reveal any real-life defect? We will examine
whether or not the proposed MRs are able to detect any issue in
the system under test (SUT).

RQ2: Is MT applicableto detect diï¬€erent types of faults? We will
carry out the mutation analysis to further study the eï¬€ectiveness
of MT.

RQ3: Is there any diï¬€erence in the eï¬€ectiveness of MRs? Its answer

may hint us for the selection of the best MRs for testing.

RQ1 will be addressed by testing the original program; whilst

RQ2 and RQ3 will be answered based on the mutation analysis.

4.2 System under test and mutation analysis
UTide (Uniï¬ed Tidal Analysis and Prediction) software developed
by Wesley Bowman (https://github.com/wesleybowman/UTide) was
used as our system under test. Its Python version has 2940 lines of
code (LOC), taking the raw input of timeseries of sea level, and pro-
ducing the output in the form of either tidal harmonic constants
(in the analysis mode) or timeseries of tidal elevation (in the predic-
tion mode). Having the latest version (v0.2.6) published one year
ago, the software is stable after 4 years of development, receiving
GitHub stars from 75 users and being forked by 44 developers. It
was conï¬gured to run on iMac M1 computer with Python 3 under
an Anaconda environment.

Mutation analysis is a commonly used method to examine the
eï¬€ectiveness of testing approaches [17]. In the mutation analysis,
the original program will be modiï¬ed by seeding a fault into a se-
lected statement. Each modiï¬ed version is referred to as a mutant,
which should be unique to avoid double counts. It contains the
code and behaviour that are not the same as the original program.

If the fault seeded in a mutant can be detected using a test suite, it
is said that the mutant is â€œkilledâ€ by the test suite. The eï¬€ectiveness
of the test suite (and hence the technique that generates the test
suite) is measured by the percentage of mutants that they kill out
of all considered mutants. The advantage of mutation analysis is
to generate a wide range of faults to challenge the eï¬€ectiveness of
the newly developed testing method. In this study, we adopted the
mutant-generating tool developed by Luu et al. [22], and modiï¬ed
it to suit our purpose of testing Python-based programs.

Our focus is to test the core component of UTide. Hence, for the
mutation analysis, we generated mutants from the core analysis
component of the TAP. It contains 206 LOC (in â€œ_solve.pyâ€ from
line 232 to line 438). Among mutation operators deï¬ned in [22]
for C/C++ programs, we used ï¬ve sets to generate mutants for the
Python program, as presented in Table 1. We then applied a ï¬lter-
ing process to eliminate the equivalent mutants (which refers to
the mutants that have the same execution behaviors as the origi-
nal program): If a mutant always delivers the same output as the
UTide on a set of randomly generated test cases, that mutant would
be removed. We also manually inspected the remaining mutants
to ensure that the non-equivalent mutants are unique. Finally, we
obtained 38 non-equivalent mutants that are non-trivial (i.e., not
killed by the Python interpreter) to be used for testing (Table 1).

4.3 Experimental setup
In this study, we generated diï¬€erent timeseries of the principal lu-
nar semi-diurnal (M2) tidal constituent with random noises and
conï¬gurations. The period of M2 astronomical tidal constituent is
about 12 hours and 25.2 minutes [15]. Only one tidal constituent
was used so that all MRs are applicable. The length of timeseries
varies randomly from 1 week to 1 month at one-hour intervals.
The amplitudes and phases were randomly chosen in the range of
[0.1, 3] metres and [0â—¦, 360â—¦), respectively. We generated and used
100 diï¬€erent random datasets (meaning 100 source test cases).

The input to UTide is the timeseries of tide data and the conï¬gu-
ration for the analysis. We conï¬gured the program in the â€œautoma-
tionâ€ mode using the OLS ï¬tting algorithm with a trend for MR1,
MR2, MR3, MR4 and MR5 and MR7. For MR6, the program was
customized with the given tidal constituent (M2) without a trend
in accordance with Equation 10. Unless preï¬xing the output with
a single tidal constituent, the program returns the output which
consists a list of tidal amplitudes and phases that have signiï¬cant
impacts to the signals. We mainly used these outputs to determine
whether the MRs are satisï¬ed or violated. For each MR, we ran an
experiment twice, one with the source (random) test case and an-
other with the follow-up ones. We repeated the experiments 100
times using 100 diï¬€erent datasets generated above.

4.4 Assessment
To determine the violation or satisfaction of an MR, we examined
the relation between the source and follow-up outputs. It involves
two conditions.

(1) For the ï¬rst condition, we determined whether or not the
tidal constituents are consistent with the conï¬guration. All
MRs require that the tidal constituents in both the source
and follow-up outputs are the same. If they diï¬€er by a tidal
constituent, the MRs will be considered as violated.

Testing Ocean Software with Metamorphic Testing

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

Table 1: Summary of generated mutants and mutants used for testing, being classiï¬ed by mutation operators.

Mutation category mutation operators
array_index
condition_if
logic_comparison
logic_value
math_operator

Description
Misplaced array index
[], [1+], [1-]
Illogical branching condition
if(), if None, if False, if True
! =, <, >, <=, >=, ==
Mistaken logical operators
True, False, None, not None Mistaken logical condition
+, -, *, /

Wrong use of mathematical operators
Total

Number of used mutants
7
10
3
1
17
38

(2) For the second condition, we continued to examine the rela-
tion between source and follow-up outputs if the ï¬rst condi-
tion is satisï¬ed. For example, in MR1, we checked whether
= Ë†ğœ™ğ‘  are satisï¬ed
or not both conditions Ë†ğ´ğ‘“
within a small round-oï¬€ error (which was set as 0.01 in this
study). If one of them is not satisï¬ed, the MR will be consid-
ered as violated.

= Ë†ğ´ğ‘  and Ë†ğœ™ğ‘“

To measure the eï¬€ectiveness of our method, we used the muta-

tion score ğ‘€ğ‘†, which is deï¬ned as

ğ‘€ğ‘† = ğ‘€ğ¾
ğ‘€ğ‘

Ã— 100%

(12)

where ğ‘€ğ¾ is the total number of mutants that are killed by an MR,
ğ‘€ğ‘ is the total number of non-equivalent mutants.

5 RESULT
5.1 RQ1: Detection of real-life defect
The proposed MRs were ï¬rst applied to test the UTide. We ob-
served that MR1 is able to reveal the real-life defect in the software
under test.

With MR1, we found that adding a new point to the timeseries
will cause the TAP to produce a totally diï¬€erent output. The detec-
tion of error is described as follows. Assume Ë†ğ´ğ‘  and Ë†ğœ™ğ‘  are the am-
plitude and the phase of a tide component in the timeseries consist-
ing of ğ‘€ points ğ¼ğ‘  = {(ğ‘¡1, ğ‘¦1), (ğ‘¡2, ğ‘¦2), . . . , (ğ‘¡ğ‘€ , ğ‘¦ğ‘€ )}, respectively.
= {(ğ‘¡1, ğ‘¦1),
The follow-up test case consists of ğ‘€ + 1 points ğ¼ ğ‘“
(ğ‘¡2, ğ‘¦2), . . . , (ğ‘¡ğ‘€ , ğ‘¦ğ‘€ ), (ğ‘¡ğ‘€+1, Ë†ğ‘¦ğ‘€+1)} where Ë†ğ‘¦ğ‘€+1 is obtai-ned from
the prediction mode using Equation 3 with the known Ë†ğ´ğ‘ , Ë†ğœ™ğ‘  and
ğ‘¡ğ‘€+1. The follow-up output consists of Ë†ğ´ğ‘“ and Ë†ğœ™ğ‘“ . As required by
our MR, the follow-up output should be the same for both ampli-
= Ë†ğœ™ğ‘  . However, the follow-
= Ë†ğ´ğ‘  and ğœ™ğ‘“
tude and phase, that is Ë†ğ´ğ‘“
up phase Ë†ğœ™ğ‘“ turned out to look like a random number (and hence
not equal to Ë†ğœ™ğ‘  ), and related to the choice of ğ‘¡ğ‘€+1, which should
not be the case.

To make sure that there is no human error in the data processing,
we have rigorously tracked down every step in the data pipeline.
It could be conï¬rmed that the transformation that does not alter
the length of timeseries (e.g., scaling, shifting) have not led to any
similar abnormal output. The adoption of other MRs (MR2, MR3,
MR4, MR5, MR6 and MR7) did not detect any violation. We were
yet to determine the root cause of the fault. We anticipated that it

could be attributed to how the program converts the computed co-
eï¬ƒcients (e.g., Ë†ğµğ‘˜ and Ë†ğ¶ğ‘˜ ) to the phase ( Ë†ğœ™ğ‘˜ ), or the mistake in han-
dling the last time step for determining the correct phase. Further
investigation will be conducted to locate the buggy statements.

5.2 RQ2: Applicability of MT
Since the defect happens only when we modify the length of time-
series, the UTide is arguably still usable for the mutation analysis.
The violation of MR1 is determined from examining only the re-
lation among amplitudes. For other six MRs, both amplitudes and
phases were used to derive the mutation scores. Table 2 presents
the summary of experimental results on the mutation analysis.

It is found that all MRs are able to kill mutants. In other words,
all MRs are eï¬€ective in detecting buggy programs. The mutation
scores range from 13% to 24% (Table 2), subject to the MRs and
test cases used. The adoption of domain-speciï¬c MRs (MR6 and
MR7) also allowed us to detect the mutants (ğ‘ğ‘ = ğ‘›ğ‘.â„ğ‘ ğ‘¡ğ‘ğ‘ğ‘˜ ((ğ‘š [:
ğ‘›ğ‘ ğ‘…];ğ‘š [2âˆ—ğ‘›ğ‘ ğ‘… : 2+ğ‘›ğ‘ ğ‘… +ğ‘›ğ‘…])) and ğ‘Œğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ğ‘ğ‘š)) that
are unable to be killed by the regression-based MRs (as shown in
Table 3). Whilst our MRs can detect mutants in the ğ‘šğ‘ğ‘¡â„_ğ‘œğ‘ğ‘’ğ‘Ÿğ‘ğ‘¡ğ‘œğ‘Ÿ
and ğ‘ğ‘œğ‘›ğ‘‘ğ‘–ğ‘¡ğ‘–ğ‘œğ‘›_ğ‘– ğ‘“ categories (Table 2), some mutants associated
with ğ‘™ğ‘œğ‘”ğ‘–ğ‘_ğ‘ğ‘œğ‘šğ‘ğ‘ğ‘Ÿğ‘–ğ‘ ğ‘œğ‘› and ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦_ğ‘–ğ‘›ğ‘‘ğ‘’ğ‘¥ have yet been killed in
these experiments (Table 1).

5.3 RQ3: Eï¬€ectiveness of MRs
We also found that the eï¬€ectiveness of each MR is not the same.
MR1 has the best performance among all MRs: It could kill about
one quarter of the mutants (Table 2). It is associated with inserting
the predicted point into the analysis. The second best MRs include
MR2 and MR4, which are related to the reï¬‚ecting and scaling of
sea level, respectively. They had the same mutation score of 16%
(Table 2).

Most detected mutants were about the modiï¬cation of coeï¬ƒ-
cients through the arithmetic operators (+, âˆ’, âˆ—, /) in preparation
for the ï¬tting (Table 3). There are three mutants (ğ‘œğ‘ğ‘¡ [â€œğ‘Ÿğ‘šğ‘–ğ‘›â€]/(24+
ğ‘™ğ‘œğ‘Ÿ );, ğ‘– ğ‘“ ğ‘‡ğ‘Ÿğ‘¢ğ‘’ : (Line 302), and ğ‘‹ğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)) that were
killed only by MR1. The results suggest that the diversity of MRs
is required for detecting diï¬€erent types of faults.

The wide range of eï¬€ectiveness indicates that some MRs are
better than others in detecting faults. As a result, selecting the most
eï¬€ective MR is one key issue for the testing of the TAP software,
similar to other types of software.

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

Q.-H. Luu et al.

Table 2: Mutation scores after 100 test cases.

Mutation score ğ‘€ğ‘†

Dataset MR1 MR2 MR3 MR4 MR5 MR6 MR7
13%

16%

11%

24%

11%

16%

11%

Table 3: List of non-equivalent mutants killed and the numbers of times they are killed over the total 100 random test cases.

Mutation category Line Original
math_operator
condition_if
math_operator

242
302
338

math_operator
math_operator
math_operator
math_operator
math_operator
math_operator
condition_if
condition_if

342
342
343
342
343
343
357
367

Mutant
ğ‘œğ‘ğ‘¡ [â€œğ‘Ÿğ‘šğ‘–ğ‘›â€]/(24 + ğ‘™ğ‘œğ‘Ÿ );
ğ‘œğ‘ğ‘¡ [â€œğ‘Ÿğ‘šğ‘–ğ‘›â€]/(24 âˆ— ğ‘™ğ‘œğ‘Ÿ );
ğ‘– ğ‘“ ğ‘›ğ‘œğ‘¡ ğ‘œğ‘ğ‘¡ [â€œğ‘›ğ‘œğ‘¡ğ‘Ÿğ‘’ğ‘›ğ‘‘â€] :
ğ‘– ğ‘“ ğ‘‡ğ‘Ÿğ‘¢ğ‘’ :
ğ‘ğ‘ = ğ‘›ğ‘.â„ğ‘ ğ‘¡ğ‘ğ‘ğ‘˜ ((ğ‘š [: ğ‘›ğ‘ ğ‘…];
ğ‘ğ‘ = ğ‘›ğ‘.â„ğ‘ ğ‘¡ğ‘ğ‘ğ‘˜ ((ğ‘š [: ğ‘›ğ‘ ğ‘…];
ğ‘š [2 âˆ— ğ‘›ğ‘ ğ‘… : 2 + ğ‘›ğ‘ ğ‘… âˆ— ğ‘›ğ‘…])) ğ‘š [2 âˆ— ğ‘›ğ‘ ğ‘… : 2 + ğ‘›ğ‘ ğ‘… + ğ‘›ğ‘…]))
ğ‘‹ğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ + ğ‘ğ‘š)
ğ‘‹ğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ + ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘– ğ‘“ ğ‘œğ‘ğ‘¡ [â€œğ‘¡ğ‘¤ğ‘œğ‘‘ğ‘–ğ‘šâ€] :
ğ‘– ğ‘“ ğ‘œğ‘ğ‘¡ [â€œğ‘›ğ‘œğ‘¡ğ‘Ÿğ‘’ğ‘›ğ‘‘â€] :

ğ‘‹ğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘‹ğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ— ğ‘ğ‘š)
ğ‘Œğ‘¢ = ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ’ ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ + ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘ âˆ— ğ‘ğ‘š)
ğ‘Œğ‘¢ = âˆ’ğ‘›ğ‘.ğ‘Ÿğ‘’ğ‘ğ‘™ (ğ‘ğ‘/ğ‘ğ‘š)
ğ‘– ğ‘“ ğ‘‡ğ‘Ÿğ‘¢ğ‘’ :
ğ‘– ğ‘“ ğ‘‡ğ‘Ÿğ‘¢ğ‘’ :

MR1 MR2 MR3 MR4 MR5 MR6 MR7
0
0

0
0

0
0

0
0

0
0

0
0

2
1

0
85
89
0
86
86
100
100
100

0
0
100
0
14
100
100
100
100

0
0
0
0
85
96
0
100
100

0
0
100
0
88
82
100
100
100

0
0
0
0
93
93
0
100
100

100
0
81
100
0
0
0
100
0

100
0
0
0
0
22
23
100
100

6 DISCUSSION
To further improve the eï¬€ectiveness and robustness of testing, we
can consider the following tasks in our future work:

â€¢ Improvements: Bugs in the SUT should be detected and cor-
rected before the mutation analysis. We should also need to
include more code in the mutation analysis, and at the same
time, enhance the diversity of mutants. A better reï¬nement
and ï¬ltering of non-equivalent mutants are of necessity.
â€¢ Extensions: New MRs are necessary to improve the eï¬€ec-
tiveness of testing. In addition, the adoption of realistic tide
records instead of random data is useful to measure the per-
formance of the method. More TAP programs (other than
UTide) are needed to examine the eï¬€ectiveness of MT.

Looking forward, we suggest that MT can be adopted in diï¬€er-

ent ways as follows:

â€¢ Veriï¬cation of the TAP software: Our method is applicable
to test the TAP software, either well-established or newly
developed ones.

â€¢ Validation of the TAP data quality and output: It is very com-
mon that a short (1-day to two-week) timeseries of sea level
are used. Our MRs can be organized to construct suitable
metrics for evaluating the reliability of used data and the
conï¬dence of results.

â€¢ Veriï¬cation and validation of high-resolution tide models: In
practice, tidal simulations are mainly validated by means of
root mean square errors and correlation coeï¬ƒcients. Since
tidal waves simulated in ocean modelling systems are peri-
odic, the domain-speciï¬c MRs can be extended to verify and
validate them in a similar way.

7 RELATED WORKS
In ocean science, Hiremath et al. [16] conducted the ï¬rst study to
adopt MT to validate ocean systems. They developed a machine
learning algorithm that is able to identify MRs automatically by op-
timizing a predeï¬ned cost function. They have adopted the method
to test a simpliï¬ed model for computing the kinetic energy of the
sea level elevation.

In the hydraulic ï¬eld, MT has been successfully applied to test
the storm water management model (SWMM) systems [19] and
dynamical hydraulic systems model [40]. Lin et al. [19] have pro-
posed four MRs related to the change of correlation coeï¬ƒcients
(ğ‘…2), which help detect real-life defects in the SWMM system that
is used to simulate the dynamic rainfall-runoï¬€ models for estimat-
ing the storm water runoï¬€s in urban areas. The work of Yang and
Chui [40] focuses on testing machine learning models which pre-
dict ï¬‚ood events in Germany. They have proposed three MRs and
adopted them to test 13 machine learning models. They then pro-
posed that MT can be further extended to test the general process-
based models.

In summary, whilst MT has been shown to be applicable to ocean
science and related ï¬elds, to the best of our knowledge, no compre-
hensive work has been carried out to systematically apply MT into
the testing of realistic ocean software and modelling systems.

8 CONCLUSION
In this study, we illustrated how to use MT to test the ocean soft-
ware through a case study of TAP software. In doing so, we have
deï¬ned a set of MRs, either by adopting MRs derived from its math-
ematical framework, or by identifying new MRs based on TAPâ€™s

Testing Ocean Software with Metamorphic Testing

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

innate properties. The experiment showed that our MRs were ef-
fective in both revealing the real-life fault as well as killing non-
equivalent mutants. We also discussed on the future directions to
improve and extend the work. The success of our study points out
a promising direction for the testing of complex ocean modelling
systems, including Ocean General Circulation Models (OGCM) and
real-time/operational Ocean Forecast Systems (OFS).

In addition to demonstrating the potentials of MT in testing
ocean software, this study also highlights the vision of MTâ€™s ap-
plication into various scientiï¬c and industrial simulation systems.
In the underwater research, submarine simulators (e.g., UWSim,
NAUTIS Maritime Simulator) are used to test the underwater robots
including Autonomous Underwater Vehicles (AUVs) for a better
development and operation of a submarine. On one hand, subma-
rine simulation might require the inputs from ocean and other
simulations; on the other hand, it has features and functions for
navigating AUVs. Traï¬ƒc simulations, as another example, involve
complex mathematical formulas and rules for predicting potential
traï¬ƒc ï¬‚ows and events. The work in testing diï¬€erent traï¬ƒc simu-
lators (such as SUMO and PTV Vissim) and autonomous driving
simulators and platforms (e.g., Apollo, Autoware, CARLA, SVL)
not only helps improve the safety and the road usersâ€™ experience,
but also may promote the reliability of other vehicular systems in-
cluding submarines and aeroplanes. It would be worthwhile to in-
vestigate how to deï¬ne MRs (similar to our regression-based MRs).
Other application domains of MT in scientiï¬c simulations include
power distribution systems and even nuclear plants, where a se-
ries of MRs can be constructed and used to test the correctness of
simulation results such that potential safety-critical errors can be
detected and avoided before the real systems are deployed.

REFERENCES
[1] John Ahlgren, Maria Berezin, Kinga Bojarczuk, Elena Dulskyte, Inna Dvortsova,
Johann George, Natalija Gucevska, Mark Harman, Maria Lomeli, Erik Meijer,
Silvia Sapora, and Justin Spahr-Summers. 2021. Testing Web Enabled Simula-
tion at Scale Using Metamorphic Testing. In 2021 IEEE/ACM 43rd International
Conference on Software Engineering: Software Engineering in Practice (ICSE-SEIP).
140â€“149. https://doi.org/10.1109/ICSE-SEIP52600.2021.00023

[2] Tsong Yueh Chen, S. C. Cheung, and Siu-Ming Yiu. 1998. Metamorphic Testing:
A New Approach for Generating Next Test Cases. Technical Report HKUST-CS98-
01, Hong Kong University of Science and Technology (1998).

[3] T. Y. Chen, J. Feng, and T. H. Tse. 2002. Metamorphic testing of programs on par-
tial diï¬€erential equations: a case study. In Proceedings 26th Annual International
Computer Software and Applications. 327â€“333.

[4] Tsong Yueh Chen, Joshua WK Ho, Huai Liu, and Xiaoyuan Xie. 2009.
testing bioinformatics programs using
BMC Bioinformatics 10, 1 (19 Jan 2009), 24.

An innovative
metamorphic testing.
https://doi.org/10.1186/1471-2105-10-24

approach for

[5] T. Y. Chen, F. C. Kuo, H. Liu, P.L. Poon, D. Towey, T. H. Tse, and Z. Q. Zhou.
2018. Metamorphic Testing: A review of challenges and opportunities. Comput.
Surveys 51, 1 (2018). https://doi.org/10.1145/3143561

[6] T. Y. Chen and M. F. Lau. 1998. A new heuristic for test suite reduction. Infor-

mation and Software Technology 40, 5 (1998), 347â€“354.

[7] D.L. Codiga. 2011. MUniï¬ed Tidal Analysis and Prediction Using the UTide
Matlab Functions. Technical Report 2011-01. Graduate School of Oceanography,
University of Rhode Island, Narragansett, RI (2011).

[8] Benoit Cushman-Roisin and Jean-Marie Beckers. 2011. Introduction to Geophys-
ical Fluid Dynamics: Physical and Numerical Aspects (2 ed.). Academic Press.
[9] Junhua Ding, XinChuan Li, and Xin-Hua Hu. 2019. Testing Scientiï¬c Soft-
ware with Invariant Relations: A Case Study. In 2019 IEEE 19th Interna-
tional Conference on Software Quality, Reliability and Security (QRS). 406â€“417.
https://doi.org/10.1109/QRS.2019.00057

[10] Junhua Ding, Tong Wu, Dianxiang Wu, Jun Q. Lu, and Xin-Hua Hu. 2011. Meta-
morphic Testing of a Monte Carlo Modeling Program. In Proceedings of the 6th
International Workshop on Automation of Software Test (Waikiki, Honolulu, HI,

USA) (AST â€™11). Association for Computing Machinery, New York, NY, USA, 1â€“7.
https://doi.org/10.1145/1982595.1982597

[11] Mohammed Farhan, Caroline Krejci, Megan Olsen,

nak. 2021.
In 2021 Annual Modeling and Simulation Conference
https://doi.org/10.23919/ANNSIM52504.2021.9552058

and M S Rau-
Metamorphic Testing for Hybrid Simulation Validation.
(ANNSIM). 1â€“12.

[12] M. G. G. Foreman and R. F. Henry. 1989. The harmonic analysis of tidal
Advances in Water Resources 12, 3 (1989), 109â€“120.

model time series.
https://doi.org/10.1016/0309-1708(89)90017-1

[13] Michael C. Gerten, James I. Lathrop, Myra B. Cohen, and Titus H. Klinge. 2020.
ChemTest: An Automated Software Testing Framework for an Emerging Para-
digm. Association for Computing Machinery, New York, NY, USA, 548â€“560.
https://doi.org/10.1145/3324884.3416638

[14] Xiao He, Xingwei Wang, Jia Shi, and Yi Liu. 2020. Testing High Performance
Numerical Simulation Programs: Experience, Lessons Learned, and Open Issues.
In Proceedings of the 29th ACM SIGSOFT International Symposium on Software
Testing and Analysis (ISSTA 2020). Association for Computing Machinery, New
York, NY, USA, 502â€“515. https://doi.org/10.1145/3395363.3397382

[15] Steacy Dopp Hicks. 2006. Understanding tides. NOAA National Ocean Service.
[16] J. Dilip Hiremath, Martin Claus, Wilhelm Hasselbring, and Willi Rath. 2021. To-
wards Automated Metamorphic Test Identiï¬cation for Ocean System Models. In
2021 IEEE/ACM 6th International Workshop on Metamorphic Testing (MET). 42â€“46.
https://doi.org/10.1109/MET52542.2021.00014

[17] Yue Jia and Mark Harman. 2011. An Analysis and Survey of the Development of
Mutation Testing. IEEE Transactions on Software Engineering 37, 5 (2011), 649â€“
678. https://doi.org/10.1109/TSE.2010.62

[18] Upulee Kanewala and Tsong Yueh Chen. 2019. Metamorphic Testing: A Simple
Yet Eï¬€ective Approach for Testing Scientiï¬c Software. Computing in Science
Engineering 21, 1 (2019), 66â€“72. https://doi.org/10.1109/MCSE.2018.2875368
[19] X. Lin, M. Simon, and N. Niu. 2018. Hierarchical Metamorphic Relations for Test-
ing Scientiï¬c Software. In Proceedings of the International Workshop on Software
Engineering for Science (Gothenburg, Sweden) (SE4Science â€™18). ACM, New York,
NY, USA, 1â€“8. https://doi.org/10.1145/3194747.3194750

[20] Xuanyi Lin, Michelle Simon, and Nan Niu. 2021. Scientiï¬c Software Testing
Goes Serverless: Creating and Invoking Metamorphic Functions. IEEE Software
38, 1 (2021), 61â€“67. https://doi.org/10.1109/MS.2020.3029468

[21] Q. H. Luu, Kosuke I., Yoichi I., and Toshiyuki A. 2011. Tidal transport through
the Tsugaru Straitâ€”Part I: Characteristics of the major tidal ï¬‚ow and its residual
current. Ocean Science Journal 46, 4 (2011), 273â€“288.

[22] Quang-Hung Luu, Man F. Lau, Sebastian P.H. Ng, and Tsong Yueh
Testing multiple linear regression systems with metamor-
Journal of Systems and Software 182 (2021), 111062(1â€“21).

Chen. 2021.
phic testing.
https://doi.org/10.1016/j.jss.2021.111062

[23] Q. H. Luu, P. Tkalich, and T. W. Tay. 2015. Sea level trend and variability around

Peninsular Malaysia. Ocean Science 11, 4 (2015), 617â€“628.

[24] Y. Lyons, Luu Q. H., and P. Tkalich. 2018. Determining high-tide features (or
islands) in the South China Sea under Article 121 (1): a legal and oceanography
perspective. In The South China Sea Arbitration. Edward Elgar Publishing.
[25] Christian Murphy, M. S. Raunak, Andrew King, Sanjian Chen, Christopher Im-
briano, Gail Kaiser, Insup Lee, Oleg Sokolsky, Lori Clarke, and Leon Osterweil.
2011. On Eï¬€ective Testing of Health Care Simulation Software. In Proceedings of
the 3rd Workshop on Software Engineering in Health Care (Waikiki, Honolulu, HI,
USA) (SEHC â€™11). Association for Computing Machinery, New York, NY, USA,
40â€“47. https://doi.org/10.1145/1987993.1988003

[26] M. Olsen and M. Raunak. 2019.

Through Metamorphic Testing.
2019), 91â€“108. https://doi.org/10.1109/TR.2018.2850315

Increasing Validity of Simulation Models
IEEE Transactions on Reliability 68, 1 (March

[27] Jeï¬€rey D. Paduan and Libe Washburn. 2013. High-Frequency Radar Observa-
tions of Ocean Surface Currents. Annual Review of Marine Science 5, 1 (2013),
115â€“136. https://doi.org/10.1146/annurev-marine-121211-172315
[28] Rich Pawlowicz, Bob Beardsley, and Steve Lentz. 2002.

tidal harmonic

cal
including error
analysis
Computers & Geosciences
using T_TIDE.
https://doi.org/doi:10.1016/S0098-3004(02)00013-4

estimates
28,

8 (2002),

Classi-
in MATLAB
929â€“937.

[29] Zedong Peng, Upulee Kanewala, and Nan Niu. 2021. Contextual Understanding
and Improvement of Metamorphic Testing in Scientiï¬c Software Development.
In Proceedings of the 15th ACM / IEEE International Symposium on Empirical Soft-
ware Engineering and Measurement (ESEM). Association for Computing Machin-
ery, New York, NY, USA. https://doi.org/10.1145/3475716.3484188

[30] Daniel Pesu, Zhi Quan Zhou, Jingfeng Zhen, and Dave Towey. 2018. A Monte
Carlo Method for Metamorphic Testing of Machine Translation Services. In 2018
IEEE/ACM 3rd International Workshop on Metamorphic Testing (MET). 38â€“45.
[31] L.L. Pullum and O. Ozmen. 2012. Early Results from Metamorphic Testing of Epi-
demiological Models. In 2012 ASE/IEEE International Conference on BioMedical
Computing (BioMedCom). 62â€“67. https://doi.org/10.1109/BioMedCom.2012.17

[32] Karishma Rahman and Upulee Kanewala. 2018.

Predicting Metamorphic
Relations for Matrix Calculation Programs. In Proceedings of the 3rd In-
ternational Workshop on Metamorphic Testing (Gothenburg, Sweden) (MET

METâ€™22, May 9, 2022, Pittsburgh, PA, USA

Q.-H. Luu et al.

â€™18). Association for Computing Machinery, New York, NY, USA, 10â€“13.
https://doi.org/10.1145/3193977.3193983

[33] Arvind Ramanathan, Chad A. Steed, and Laura L. Pullum. 2012.

Ver-
iï¬cation of Compartmental Epidemiological Models Using Metamor-
phic Testing, Model Checking and Visual Analytics.
In 2012 ASE/IEEE
International Conference on BioMedical Computing (BioMedCom). 68â€“73.
https://doi.org/10.1109/BioMedCom.2012.18

[34] S. Segura, G. Fraser, A.B. Sanchez, and A. Ruiz-Cortes. 2016. A survey on Meta-
IEEE Transactions on Software Engineering 42, 9 (Sept 2016),

morphic Testing.
805â€“824. https://doi.org/10.1109/TSE.2016.2532875

[35] S. Segura, D. Towey, Z. Q. Zhou, and T. Y. Chen. 2020. Metamorphic Testing:

Testing the Untestable. IEEE Software 37 (2020), 46â€“53. Issue 3.

[36] John Seymour, Dac-Thanh-Chuong Ho, and Quang-Hung Luu. 2021. An Empiri-
cal Testing of Autonomous Vehicle Simulator System for Urban Driving. In 2021
IEEE International Conference on Artiï¬cial Intelligence Testing (AITest). 111â€“117.

https://doi.org/10.1109/AITEST52744.2021.00031

[37] P. Tkalich, P. Vethamony, Q. H. Luu, and M.T. Babu. 2013. Sea level trend and

variability in the Singapore Strait. Ocean Science 9 (2013), 293â€“300.

[38] Robert Ellis Tom Garrison. 2016. Oceanography: An Invitation to Marine Science

(9 ed.). Cengage Learning.

[39] Thomas Wahl, Shaleen Jain, Jens Bender, Steven D. Meyers, and Mark E. Luther.
2015.
Increasing risk of compound ï¬‚ooding from storm surge and rainfall
for major US cities. Nature Climate Change 5, 12 (01 Dec 2015), 1093â€“1097.
https://doi.org/10.1038/nclimate2736

[40] Yang Yang and Ting Fong May Chui. 2021.

Reliability Assessment of
Machine Learning Models in Hydrological Predictions Through Metamor-
phic Testing.
Water Resources Research 57, 9 (2021), e2020WR029471.
https://doi.org/10.1029/2020WR029471

[41] Z. Q. Zhou and L. Sun. 2019. Metamorphic Testing of Driverless Cars. Commu-
nications of ACM 62, 3 (Feb. 2019), 61â€“67. https://doi.org/10.1145/3241979

