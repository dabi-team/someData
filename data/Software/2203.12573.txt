SerialTrack:ScalEandRotationInvariantAugmentedLagrangianParticleTrackingJinYang(0000-0002-5967-980X)a,YueYina,b,AlexanderK.Landauer(0000-0003-2863-039X)c,SeldaBuyuktozturka,d,JingZhanga,LukeSummeya,AlexanderMcGheea,MattK.Fue,JohnO.Dabirie,ChristianFrancka,∗aUniversityofWisconsin-Madison,MechanicalEngineering,Madison,WI,USAbDepartmentofMechanicalEngineering,CarnegieMellonUniversity,Pittsburgh,PA,USAcNationalInstituteofStandardsandTechnology,Gaithersburg,MD,USAdSchoolofEngineering,BrownUniversity,Providence,RI,USAeGraduateAerospaceLaboratories,CaliforniaInstituteofTechnology,Pasadena,CA,USAAbstractWepresentanewparticletrackingalgorithmtoaccuratelyresolvelargedefor-mationandrotationalmotionﬁelds,whichtakesadvantageofbothlocalandglobalparticletrackingalgorithms.WecallthismethodtheScalEandRotationInvariantAugmentedLagrangianParticleTracking(SerialTrack).Thismethodbuildsaniterativescaleandrotationinvarianttopology-basedfeatureforeachparticlewithinamulti-scaletrackingalgorithm.Theglobalkinematiccompat-ibilityconditionisappliedasaglobalaugmentedLagrangianconstrainttoen-hancethetrackingaccuracy.Anopensourcesoftwarepackageimplementingthisnumericalapproachtotrackboth2Dand3D,incrementalandcumulativedeformationﬁeldsisprovided.Keywords:particletracking,topology-basedfeature,augmentedLagrangian,ﬁnitedeformation∗CorrespondingauthorEmailaddress:cfranck@wisc.edu(ChristianFranck)PreprintsubmittedtoSoftwareXMarch24,2022arXiv:2203.12573v1  [cs.RO]  23 Mar 2022RequiredmetadataCurrentcodeversionNr.CodemetadatadescriptionPleaseﬁllinthiscolumnC1Currentcodeversionv1.0C2Permanentlinktocode/repositoryusedforthiscodeversionhttps://github.com/FranckLab/SerialTrackC3CodeOceancomputecapsuleC4LegalCodeLicenseMITlicenseC5CodeversioningsystemusedgitC6Softwarecodelanguages,tools,andservicesusedMATLAB1C7Compilationrequirements,operatingenvironments&dependenciesMATLABwiththefollowingtoolboxes:SystemIdentiﬁcationToolbox,ImageProcessingToolbox,StatisticsandMachineLearningToolbox,PartialDifferentialEquationToolbox,WaveletToolbox,CurveFittingToolbox,ParallelComputingToolbox,MATLABParallelServer,andPolyspaceBugFinderC8IfavailableLinktodeveloperdocumentation/manualhttps://github.com/FranckLab/SerialTrack/wikiC9Supportemailforquestionscfranck@wisc.eduTable1:Codemetadata1Certaincommercialequipment,softwareand/ormaterialsareidentiﬁedinthispaperinordertoadequatelyspecifytheexperimentalprocedure.InnocasedoessuchidentiﬁcationimplyrecommendationorendorsementbytheNationalInstituteofStandardsandTechnology,nordoesitimplythattheequipmentand/ormaterialsusedarenecessarilythebestavailableforthepurpose.1.MotivationandsigniﬁcanceSingleparticletracking(SPT)andparticletrackingvelocimetry(PTV)meth-odsprovidequantitative,temporallyresolvedmeasurementsofmotionsanddeformationstoinvestigatecomplexdynamicsattheresolutionofsingletrack-ingfeaturesbyautomaticallylocalizingandtrackingindividualparticles[1,2,3].Thisisincontrasttodigitalimage/volumecorrelation(DIC/DVC)andpar-ticleimagevelocimetry(PIV),whicharesubset-correlation-basedtechniques(seeasummaryofvariousfull-ﬁeldtrackingmethodsinTable2).Thein-creasedspeciﬁcityofthetrackedparticlescanbebeneﬁcialtoapplicationssuchasquantitativebiologicalmotiontracking[4,5,6,7,8,9]andﬂuidmechan-icsforﬂowmeasurements[10,2,11,12].However,itremainsachallengetouniquelyandrobustlymatchparticlesthroughoutanimagesequence.Particletrackingmethodshavebeenusedtostudymultiplelengthandtimescalesinsoftmaterialsandrheology[13,14],experimentalphysics[15],mate-rialsscience[16,17],andgeophysics[18].ThereareanumberofSPTandPTV2algorithmscreatedforvariousapplications[19,20]buttheyareoftenspecial-ized,andtypicallyrequireeithersmallinter-framedeformations[21,22,23]orsparse[24,25,26]/dense[27,28]particleseedingvolumestoperformwell.Particletrackingprocedurescangenerallybedividedintotwosteps:(i)par-ticlelocalization,wherecoordinatesofindividualparticlesareextractedfromeachframeofanimagesequence,and(ii)particlelinking,wheredetectedparti-clesareuniquelymatchedfromframetoframetoconstructamotionﬁeld.Particlelocalizationalgorithmsoftendecomposetheprocessintoparticledetectionfollowedbysubpixelcentroidlocalization.Forexample,imagesarepre-processedtoreducenoiseandselectivelyenhanceobjects,thenparticlespotsorfeaturelocationsaredetectedbyapplyingimagesegmentation,local-maximaﬁnding,orotherthresholdingcriteria.ParticlecentroidlocationsareoftenestimatedbyapplyingGaussianﬁtting[29,30]orintensity-basedcen-troidmeasurements[31,32].Ingeneral,alloftheaboveimageprocessing-basedmethodsperformwellforimageswithsufﬁcientlyhighsignal-to-noiseratios(SNR≤5).Recently,machinelearning-basedmethodshavebeendevel-opedthatcanpotentiallyimproveperformanceinimageswithspatiotemporalheterogeneityandpoorsignal-to-noiseratios[33,34,35].Variousalgorithmshavebeencreatedtodetectandtrackindividualparti-cles[1]suchasthestraightforwardk-nearest-neighbor(kNN)searches,topology-basedapproacheswhereneighboringparticlesareemployedtoconstructlocalsurroundingtopologyfeatures[27,36,37,38,39],globallyoptimizedsearchproblems–includinglinearassignmentprogramming[26],Kalmanﬁltering[40],relaxationmethods[19,41],andfeaturevector-basedtechniques[22,25](seeabriefsummaryofparticletrackingopen-sourcecodesinTable3).Amongthesemethods,thenearestneighbor-typesearchalgorithmsaretypicallysuit-ableforrelativelylownumbersofparticlesthatundergodisplacementssmallerthanthetypicalinterparticleseparationdistance.Themorerobusttopology-basedandfeature-basedparticletrackingalgorithmsareabletoresolvelargedeformationﬁeldsbutfavorlargeparticlenumbers.Therelaxation-basedap-proachesperformwellonhighlystochasticmotionﬁeldsbutrequiresmallinter-framemotions.Thenearest-neighborandlocaltopology-basedmethodsarecomputationallyefﬁcientandcanbeeasilyimplementedinparallel.How-ever,theybothhavelimitationsinregardtoparticleseedingdensitiesandthereisnoguaranteethattheﬁnaltrackedmotionﬁeldsareuniqueandkinemati-callyadmissible.Globaloptimizationparticletrackingmethodscanguaranteetheuniquenessandkinematicadmissibilityofthetrackedmotion,butaretyp-icallycomputationallyexpensive.Herewepresentanewparticletrackingalgorithm,calledtheScalEandRotationInvariantAugmentedLagrangianParticleTracking(SerialTrack)method,whichtakesadvantageofbothlocal(i.e.,nearest-neighborsearchandlocal-topology-basedfeaturetracking[27,42])andglobaloptimizationtorecon-structmotionﬁeldsineither2Dor3D,andwithlarge,complexdeformationsforbothsparseanddenseparticlesefﬁciently,robustlyandaccurately.Thisnewmethodﬁrstbuildsalocalscaleandrotationinvarianttopology-basedfeatureforeachparticle,theniterativelytracksthesewithinaglobalmulti-scalealgorithm.TheglobalkinematiccompatibilityconditionisappliedasanaugmentedLagrangianconstraint[43,44]toenhancethetrackingaccuracy.Inadditiontotrackingincrementaldeformationbetweentwosubsequentframes,SerialTrackcantracklargecumulativedeformationswheretheinitialguessof3TechniquenamePIVDICDVCPTVSPTSerialTrack(thiswork)ConsideringparticleshapedistortionornotNoYesYesNoNoYesMatchingcontinuouspatches(C)ordiscretefeaturepoints(D)CDCCDD2Dimagesequenceor3Dvolumetricimage2D&3D2D3D2D&3D2D&3D2D&3DTrackingvelocityﬁeld(v)orcumulativedisplacement(u)vuuvuv&uTable2:Comparisonofdifferentfull-ﬁeldmeasurementmethodsNameRefsLanguageDim.ParticlelinkingalgorithmPTVlab[46,47]MATLAB2DIntegratedcross-correlationandrelaxationalgorithmOpenPTV[48]C&Python3DAspatio-temporalmatchingalgorithm[49]TrackMate[34,50]MATLAB&Fiji2D&3DLAP,u-track,Kalmanﬁlter,etc[51].TracTrac[39,52]MATLAB&Python2DK-dimensionaltreestosearchandcomputestatisticsaroundneighboringobjectsTPT[27,53]MATLAB3DTopology-basedmatchinganditerativedeformationwarping(IDM)FM-Trac[54]Python3DRotation-invarianttopology-basedmatchingPart2Track[42]MATLAB2DNearestneighborsearchingorhistogrammatchingKNOT[35]Python2D&3DAdaptiveanalysisonthesingleframedisplacementsproducedfrompointcloudsSerialTrack(thiswork)[55]MATLAB2D&3DScaleandrotation-invarianttopology-basedmatchingandaugmentedLagrangianglobalkinematiccompatibilityconstraintTable3:Comparisonofdifferentopen-sourceparticletrackingcodeseachtrackingdisplacementﬁeldhasbeenimprovedbyadata-drivenreducedordermodelingmethod[45].Thenewmethodincludesbothparticlelocaliza-tionandparticlelinkingprocesses,andalsomayoptionallyaccountforshapedistortionofparticlesduetolargedeformations.2.Softwaredescription2.1.SoftwarearchitectureThebasicworkﬂowoftheSerialTrackimplementationissummarizedinFig.1.SerialTrackrequirestheuserstoprovidetheircaptured2Dand3D(volumetric)imagepairsorimagesequence.Insolidmechanicsandmaterial42D3DParticlerigidity“Hard”particle“Soft”particleParticletrackingproblemDimTrackingmodeCumulativeIncrementalDouble frameTrackingprocessParticle detectionParticle linkingPost-processingFigure1:WorkﬂowofSerialTrack.Theparticletrackingsetupismostbroadlycategorizedbyproblemdimensionalityas2D(pixelimage)or3D(volumetricvoxelimage).Hardvs.softpar-ticlesfurtherspecifywhereparticleshapewarpingisincludedduringthesolution.Thetrackingmodedeﬁnestheschemeforselectingimagesfromtheexperimentalimagesequence.Finally,theparticlesdetection,linking,andpost-processingstrategiesarespeciﬁedgiventheexperimentalconﬁgurationanddesiredoutputdata.sciences,3Dimagevolumescanbescannedinmultiplelayersusingconfo-calcameras,X-rayCT,MRI,orotherimagingmodalities.Inﬂuidmechanics,these3DvolumesaretypicallyreconstructedfromseveralcameraPOVsusingmulti-viewstereoscopywithoneormoresensors,seeforexample[11,10].Thecodepackageincludesboth2D(SerialTrack_2)and3D(SerialTrack_3)particletrackingproblemsandthreeexecutingmodes:(i)incremental,(ii)cumulative,and(iii)doubleframe.Inincrementalmode,twoconsecutiveframesarecom-paredtoinferincrementalmotionbetweenframes,whileincumulativemode,laterframesarecomparedwiththeﬁrst,undeformedreferenceframetore-constructtheirtotalmotions.In2Dcases,wealsoincludethe“doubleframe”modewheretwoframesaretakenundereverysingleexposurewithatemporaldelayandeachoddnumberframeiscomparedtoitssubsequentevennumberframe.Oneadvancedfeatureofthe2Dcumulativemodeisthattheeffectofparticleshapedistortioncanbeconsidered.Weconsiderparticlestobe“soft”ifparticleshapechangecoincideswithlocaldeformationgradients,andcon-siderparticles“hard”iftheshapeiseffectivelyrigidandinvariantthroughouttheexperiment.Duringthetrackingprocess,wedetecteachindividualparticleinbothref-erenceanddeformedimagesandthenlinkthemtoobtainthefull-ﬁeldmo-tionsthroughoutanimagesequence.WewilldiscussthesefunctionalitiesinSections2.2-2.4.2.2.Softwarefunctionalities:particledetectionIntheSerialTrackimplementation,weleveragethestate-of-the-artparticledetectionmethodswheretheminimumsizeofparticlesthatcanbeeffectivelydetectedareusually3pixelsby3pixels(seemoredetailsinthedescriptionofeachdetectionmethodbelowandreferencestherein).Intheﬁrstoftwoapproachestodetectindividualsingleparticles,weemploythesamemethodusedinPateletal.[27]whereimagesarethresholdedbasedonauser-speciﬁedcutofftosegmentparticlesfrombackgroundasbinaryconnectedcomponents,andthenrapidlylocalizeparticlecentroidswithsub-pixelaccuracyusingtheradialsymmetrymethod[32,31].Inthesecondmethod,particlesaredetectedbyaLaplacianofGaussianimageﬁlteringtechnique,followedbyaGaussianinterpolationoftheparticlepeakintensities[39,42].Numeroustechniquesexistforparticlesegmentationandcentroidlocalization–whilethesetwoper-5formwellinourtestcases,fordifferentimagingmodalitiesorparticletypesothermethodsmaybemoreappropriate.Goodparticledetection,segmenta-tion,andlocalizationarecriticalforaccuratetracking.Inthisregard,thecodeishighlyextensible,andotheralgorithmscaneasilybeaddedsincethecorealgorithmsimplyexpectsalistofcentroidcoordinatesforeachimageasinput.2.3.Softwarefunctionalities:particlelinkingWedescribeourparticlelinkingprocessinthissection.WesummarizethecodeoutlineinAlgorithm1.Amathematicalformulationoftheparticletrack-ingproblemissummarizedinAppendixA,wherearegularizerisaddedtotheparticlematchingoptimizationfunctional(A.4)toenforcetheuniquenessofthesolution.Inourimplementation,thisoptimizationproblemissolvedbythealternatingdirectionmethodofmultipliers(ADMM)schemesummarizedinAppendixB.TosolvetheADMMlocalstepofEq(B.2),particlesarelinkedbetweenframesusinganewparticledescriptor(i.e.,featurevector),whichisdeﬁnedbasedonthetopologicalarrangementofrandomlylocatedneighborsinaframeworksimilartothosedescribedinPateletal.[27],Jankeetal.[42],andLejeuneetal.[54].Hereweimprovetheprevioustopology-basedrela-tiveneighborfeaturetobe2D/3Dscale-androtation-invariant,asshowninSection2.3.1.Duringtheiterativematchingprocess,auniversaloutlierremovalscheme[6]isalsoincorporatedtoenhancethequalityofthereconstructeddisplace-mentﬁeld.DuringeachADMMiteration,wealsodetectandremoveghostparticles,i.e.,particlesthatareonlydetectedonceinthetwocomparedframes,toimprovetherobustnessofeachparticle’stopology-basedfeaturevector(seeSection2.3.2).Totracktotal,cumulativedisplacementﬁelds,sometimescalledLagrangianparticletracking,wedescribetwostrategiesinSection2.3.3.Finally,wealsodiscussminimizingerrorsduetoparticleshapedistortioninSection2.3.4,sinceinsomeexperimentalinstancesparticlesmaydeformsigniﬁcantlyaccordingtolocaldeformationgradients,andthusshapechangemustbeaccountedforinthelocalizationprocess.2.3.1.Topology-basedscaleandrotation-invariantparticledescriptorForeachindividualparticle,therelativepositionbetweentheknearestneighborparticlesandtheselectedparticleisencodedintoacompleteparticledescriptorconsistingoftwofeaturevectors.Forthe2Dcase,anangle-basedfeatureisdeﬁnedasanarrayofpolaranglesbetweeneachofthekneighbor-ingparticles,i.e.,[θ1,θ2,···,θk]T,asshowninFig.2(a-b).Anarrayofinterpar-ticleEuclideandistancesisalsoconstructedasadistance-basedfeature,i.e.,[r1,r2,···,rk]T,wheredistancesarenormalizedbytheﬁrstnearestneighborparticledistance.Forthe3Dcase,analogoustothe2Ddescriptor,3Dradialdistances(r),polarangles(θ),andazimuthalangles(φ)ofthestoredkneigh-boringparticlesareusedtoconstructparticledescriptorsforeachparticle.Toestablishacoordinatesystem,{e1,e2,e3},foreachparticle,wedeﬁnetheﬁrstnearestneighborparticledirectionasthee1axis.Thee3directionisdeﬁnedtobeperpendiculartotheﬁrstandsecondnearestneighborparticles,andmustsatisfye3·r3>0wherer3isthethirdnearestneighborparticledirection.Thee2axisisdeﬁnedase3×e1where”×”isthecrossproduct.Asin2D,the6Reference imageDeformed imagee1e2e3e1e2e32D3DabcdSelected particleThree nearest neighborsNearest neighborsOther particlesSearch regionSelected particleOther nearest neighborsOther particlesSearch regionFigure2:Adiagramoutliningthedescriptorgenerationprocess.(a)Thekradiiandanglestonearestneighborparticleswithinthesearchdistanceforeachparticle(b)Thesamecomputationisperformedinthedeformedimage.SimultaneouslyminimizingEuclideandistanceforangularanddistancemismatch,weachieveafastlinkingthatisscaleandrotationinvariant,andthusrobustundermostkinematicallyadmissibledeformations.(c&d)Theanalogousprocessfora3D(volumetric)case,wherethebasisspaceforthedescriptorsiscomputedlocallyfromeachparticle’sthreenearestneighbors.radialdistance(r)featureistheEuclideaninterparticledistancenormalizedbytheﬁrstnearestneighborparticledistance.Thedesignofthesedescriptorsisadvantageoussincetheyfullyencodetherelativespatialpositionsofneigh-boringparticles.Theycanalsobecheapertocomputecomparedtonormalizedcorrelation-basedtrackingalgorithms,withapossiblethecomputationalcostreductionontheorderof(#ofimagepixels)/(#ofparticles).Theconstructedparticledescriptorsarescaleandrotationinvariant,whichallowsforlargede-formationsandrotationswhileretainingsimilaritybetweendescriptorsduringtracking.Toestablishparticlematchesbetweenframes,thetopology-baseddescrip-torforeachidentiﬁedparticleiscomputedthatindependentlyminimizestheEuclideandistances(summationofsquareddifferences)betweenthedistance-basedfeatureandangle-basedfeatures,respectively.Weconsidertwoparti-clestobematched,i.e.,thesamephysicalparticleinbothframes,iftheyattaintheminimumradialandangulardescriptorssimultaneously.DuringADMMiterations,weapplyaparticlecountscalingstrategy,suchthatthenumberofnearestneighboringparticlesforeachlocalmatchingstep,k,isexponen-tiallydecreasedfromauser-selectedstartingvalue(typically10’sofparticles)to1.Whenkequals1,ourmethodisidenticaltothenearestneighborsearch[42].Thisscalingstrategyhelpstoaddressvariableparticledensity–wehavefoundthatfeaturesrelyingonmanylocalparticles(highk)performwellfordenselyseededregions,whereasfeatureswithlowerkaremoreperformantforsparselyseededregions.Inbothcases,amaximumsearchradiusforpar-ticlestoincludecanbespeciﬁedtoreducecomputationalcostwhilebuildingfeatures.7Algorithm1:Outlineofthe“hard”particletrackingprocedureInput:Twoimagesfnandfn+tStep1:Detectparticlesinimagesfnandfn+t;Step2:(Optional)Warpdetectedparticlecoordinatesinfn+twithapredictorfordisplacementˆu;Step3:Setdualvariableθtobezero.SetIterNum=1,andM=0;while(cid:12)(cid:12)ˆuk+1−ˆuk(cid:12)(cid:12)>εandIterNum<IterMaxandM<5do%%%%%Subproblem1:ﬁxˆukandsolveuk+1locally%%%%%;Step4:Buildatopology-based,scaleandrotationinvariantdescriptorforeachparticle;Step5:MatchparticlefeaturesandcalculateMatchRatio;%%%%%Subproblem2:ﬁxuk+1andsolveˆuk+1globally%%%%%;Step6:SolveEq(B.3);Step7:(Optional)RemoveghostparticlesusingEq(1);Step8:Updatedualvariable:θk+1←θk+ˆuk+1−uk+1;ifMatchRatio==1thenM←M+1(M:countof“MatchRatio==1")endendOutput:Deformationdisplacementﬁeldsfromimagefntofn+t:locallysolveddisplacementuandﬁnalglobal,kinematicallycompatibleˆu2.3.2.RemovingghostparticlesTheremayexistparticlesthatareonlydetectedonceinthetwoframes,whicharetermedghostparticles[23].Thesemayoccurwhenpartofthesam-plemovesoutoftheﬁeldofview,orduetoexperimentalnoiseorocclusion.Theexistenceofghostparticleshasatwo-foldeffectonthelocaltopology-basedmatching:thedescriptorbuiltinoneframeforaghostparticlewillnothaveacorrespondingcorrectmatch,andfeaturedescriptorsofotherneigh-boringparticlesomitmissingparticles.Botheffectshaveadeleteriouseffectontheaccuracyofparticlelinkingandtracking.ThereforeaftersolvingeachADMMiterationglobalstepofEq(B.3),weattempttodetectandremoveghostparticlesandre-collectthecentroidlocationsofcorrectlydetectedparticlesinbothframesusingthefollowingcriteria:Pn←[Pn(cid:26)(cid:16)minPn+t∈Pn+t|Pn−Pn+t(ˆu)|(cid:17)<εd(cid:27),Pn+t←[Pn+t(cid:26)(cid:16)minPn∈Pn|Pn−Pn+t(ˆu)|(cid:17)<εd(cid:27),(1)whereˆuisthecurrent,solveddisplacementﬁeldaftertheADMMglobalstep;εdisauserspeciﬁedcriticaldistanceforadetectedparticleinoneframe(i.e.,framen)tobediagnosedasa“ghostparticle”iftheredoesnotexistanypar-ticleintheothercomparingframe(framen+t)withinεd.AllthedetectedghostparticleswillberemovedandremainingparticleswillformtheupdatedparticlecollectionsPnandPn+tforframenandframen+t,respectively.82.3.3.TrackingcumulativedisplacementTwostrategiesareprovidedbytheSerialTracktoreconstructtotal,cumula-tivedisplacementsateachstepinanimagesequence-namelybothcumulativeandincrementalmodesoftracking.Incumulativemode,subsequentframesarealwayscomparedtotheﬁxed,undeformedreferenceframe,wheretotalcu-mulativedisplacementﬁeldscanbeobtaineddirectly.Forlargedeformations,weemploythetrackedresultsfromthepreviousframesandleverageama-chinelearningmethodtoestimateadisplacementpredictortofurtherimprovethetrackingaccuracyofsubsequentframes[45].Inincrementalmode,eachframeiscomparedtoitsnextframe.Thetrackedincrementaldisplacementtrajectorysegmentsfromeachimagepairinthesequencecanbemergedtocomputetheﬁnalcumulativedisplacementsateachtimestep(seeSection2.4formoredetails).2.3.4.EffectofparticleshapedistortionWeoptionallyconsidertheeffectofparticleshapedistortion,e.g.,forpaintedcircularspeckledotsona2Dsamplesurfacethatdeformintoellipsesduringauniaxialcompression/tensiontest,whichcandegradetheparticledetectionanddecreasethetrackingaccuracy.TodistinguishfromAlgorithm1whereparticlesarecalled“hard”andwhoseshapesareassumedtoberigid,wecalltheseparticles“soft”andassumetheirshapedistortioncoincideswiththeirlocal,underlyingdeformationgradients.AmodiﬁedalgorithmtobettertrackthesedistortedparticlesissummarizedinAlgorithm2.Differentfrom“hard”particletracking,inthe“soft”particletrackingalgorithm,particlecentroidlo-cationsneedtobere-detectedusingwarpedimagesduringtheADMMitera-tions(seeStep4inAlgorithm2).2.4.SoftwareFunctionalities:Post-processingAfterallparticleshavebeentracked,weprovidepost-processingfunctionstointerpolatetrackeddisplacementﬁeldsontoaregulargriddedmeshtocal-culatedeformationgradientsandstrainﬁelds[4].Intheincrementaltrackingmode,thedirect,trackeddisplacementﬁeldforeachframeisinitscurrentde-formedconﬁguration,orinanEuleriancoordinateframe[56].Alternatively,wealsoincludepost-processingtodetermineindividualparticletrajectoriesthroughouttheimagesequenceinaLagrangiancoordinateframe.Particlesarelinkedandallthedisplacementtrajectoriesaremerged[42,17]toobtainto-talparticledisplacementsateachframeforeachidentiﬁedparticle.Tofurtherimprovethecumulativetrackingratios,allthetrackedincrementaldisplace-menttrajectorysegmentsareextrapolatedbothbeforethesegmentstartingtimepointandafterthesegmentendingtimepoint.Thenweﬁndandjointrajectorysegmentsatcorrespondingtimepointsthatarelikelyfromthesameparticles,whichcanbemergedtogether.Weperformthis“extrapolationandﬁnding”schemethreetoﬁvetimesoruntilwedonotﬁndun-mergedtrajectoryseg-ments.3.IllustrativeexamplesWeassesstheSerialTrackmethodwithbothsyntheticandexperimentaldatasetsatvariousparticleseedingdensities,asshowninFigs.3-6.Although9Algorithm2:Outlineofthe“soft”particletrackingprocedureInput:Twoconsecutiveimagesfnandfn+tStep1:Detectparticlesinreferenceimagefn;Step2:(Optional)Predictadisplacementpredictor;Step3:Setdualvariableθtobezero.SetIterNum=1,andM=0;while(cid:12)(cid:12)ˆuk+1−ˆuk(cid:12)(cid:12)>εandIterNum<IterMaxandM<5doStep4:Warpimagefn+twithcurrentdisplacementˆukanddetectparticlesinimagesfn+t;%%%%%Subproblem1:ﬁxˆukandsolveuk+1locally%%%%%;Step5:Buildatopology-based,scaleandrotationinvariantfeatureforeachparticle;Step6:MatchparticlefeaturesandcalculateMatchRatio;%%%%%Subproblem2:ﬁxuk+1andsolveˆuk+1globally%%%%%;Step7:SolveEq.(B.3)forˆuk+1;Step8:(Optional)RemoveghostparticlesusingEq.(1);Step9:Updatedualvariable:θk+1←θk+ˆuk+1−uk+1;ifMatchRatio==1thenM←M+1(M:countof“MatchRatio==1")endendOutput:Deformationdisplacementﬁeldsfromimagefntofn+t:locallysolveddisplacementuandﬁnalglobal,kinematicallycompatibleˆuIllustrativeexamplesSynorExpFig.Dim.ParticlerigidityTrack-ingmodeBeadintensitythresholdBeadradius(p_size)Maxneigh-bor#SizeofsearchﬁeldTranslationSyn3a2DHardinc0.5325InfRotationSyn3b2DHardinc0.5325InfUniaxialstretchSyn3c2DHardcum0.532550SimpleshearSyn3d2DHardcum0.532550TranslationSyn3e3DHardinc0.5325InfRotationSyn3f3DHardinc0.5325InfUniaxialstretchSyn3g3DHardcum0.532550SimpleshearSyn3h3DHardcum0.532550DICChallengev2Syn3i-j2DHardinc0.532550UniaxialstretchSynS3c2DSoftcum0.532550SimpleshearSynS3d2DSoftcum0.532550InertialcavitationExp4a2DHardinc0.521030PipeﬂowExp4b2DHardinc0.422550FoamcompressionExp52DSoftcum0.532550HydrogelshearExp6a3DHardinc0.1205700GelindentationExp6b3DHardinc0.132550Table4:SerialTrackcodeparametersfordemonstratedillustrativeexamplesforsynthetic(“syn”)andexperimental“exp”)testcasesthesyntheticimagegenerationmodelmaynotcaptureallnoiseanderrorsourcespresentinexperimentalimages,itservesasaveriﬁcationandvalidationforthealgorithmwheredirect,quantitativeerrormeasurementscanbemadebetweentrackingresultsandgroundtruthdata.Severalexperimentaltestcasesdemon-stratetheapplicabilityofthistechniqueforpermutationsofseedingdensityanddimensionality,andforbothﬂuidandsolidmaterials.AlltheusedcodeparametersaresummarizedinTable4.ApermanentcopyofthedatasetsfortheexamplescanbefoundontheMINDS@UWopenaccessinstitutionaldata10repository2.3.1.SyntheticexamplesForboth2Dand3Dsynthetictestcases,wegeneratesyntheticimageswithbeadpatternsfollowingthestepsdescribedinAppendixC,andtheirquantita-tiveevaluationresultsinFig.3areshownusingtrackingratiosandroot-mean-squareddisplacementerror.Asabaseline,weappliedasmallﬁrst-ordermo-tionﬁeldintheformofrigidbodytranslationinthex-directionfrom0pixelsto4pixelsin0.1pixelincrementsusingcumulativetracking.Thetypicaltrackingratiosinthe2Dand3Drigidtranslationareabove95%ofparticlestrackedand85%ofparticlestracked,respectively.Displacementrootmeansquare(RMS)errorswerecomputedonthemeasuredcentroidlocationsofeachLagrangian-trackedparticleontheorderof10−2pixels.Thiserrorleveliscomparabletotheparticlelocalizationuncertainty[31,32].Thedeformationgradienttensor,F,ofanyhomogeneousdeformationfollowsthemultiplicativedecompositionF=R·U=V·RwhereUandVaretherightandleftstretchtensorsandRisapurerotationofthepolardecomposition.Therefore,weincludetestcasesforlarge,rigidbodyrotations(rotationangleθfrom0◦to180◦inincrementsof10◦),ﬁniteuniaxialstretches(stretchratiosλfrom1to3inincrementsof0.1andsimpleshear(shearangleγfrom0◦to45◦intan(γ)incrementsof0.05),asshowninFig.3(b-d)for2Dcasesand(f-h)for3Dcases.Particleseed-ingdensities(SD)rangefrom0.003particlesperpixelto0.012particlesperpixelin2Dsyntheticcases,and10−4particlespervoxelto10−3particlespervoxelin3Dsyntheticcases.PTVmethodsbasedonanunderlyingrectilineargrid(typicalforimage-basedmeasurements)areoftenchallengedbylargero-tationangles.Forlargestretchesandshearswheremotionsaregreaterthantheinter-particlespacing,localalgorithms,suchaskNNorrelaxationmeth-ods,non-uniquenessofparticleidentiﬁcationleadstopoortrackingratios[27].IntheSerialTrackmethod,theregion-basedformulationisdesignedtomin-imizetheseeffectsandishybridizedwithaglobaloptimizationthatensuresuniquenessandkinematicadmissibilityofthereconstructedmotionﬁeld,andthusthetrackingratiosremainhighandRMSdisplacementerrorsaretypicallybelowO(0.1)px.Inallcases,thetrackingratiodecreaseinpartreﬂectsthatpar-ticlesaremovingoutoftheﬁeldofviewinourreferentialEulerianframe.Thisismostclearlyillustratedintherotationcase,wherethelowesttrackingratioscorrespondtoapproximately45◦rotation,wheretheoverlapbetweenrefer-enceanddeformedconﬁgurationframeislikewiseminimum.ForasummaryofoveralldetectionratioandstrainRMSerror,seeSIFig.S1andFig.S2forsynthetic2Dand3Dresults,respectively.Ourtypicalparticletrackingappli-cationsuserigidparticles,howeverdeformableormodulus-matchedparticlescanbeimportanttopreservetheverisimilitudeoftheinstrumentedtest.Themethod,therefore,alsooptionallyaccountsforparticleshapedistortion.AsimilarsummaryofthetrackingresultsforthissubclassofreconstructionsisgiveninSIFig.S3.InspiredbyReuetal.[57],wedesignedasynthetic2DexampletotestthespatialresolutionoftheSerialTrackalgorithmusinga“star”patterndisplace-mentﬁeld.Bothreferenceanddeformedimagesare4001pixels×501pixels.2https://minds.wisconsin.edu/handle/1793/8290111Tracking ratioDisp error (vx)u (vx)Tracking ratioDisp error (px)u (px)2D translationSD = 1e-4SD = 3e-4SD = 1e-3SD = 0.003SD = 0.006SD = 0.012abcefg2D rotation2D uniaxial stretch2D simple shearxyθxyγxyλθxyzxyzλγxyzθ (ο)θ (ο)λλtanγtanγxyuxyuzdh3D translation3D rotation3D uniaxial stretch3D simple shear01000200030004000-2-10123   0100020003000400001000200030004000sd11.5-1.51.00.50-0.5-1.0(px)sd1 = 0.003sd2 = 0.006sd3 = 0.012sd1: fittingsd2: fittingsd3: fittingx-disp (px)y-disp (px)sd2sd3ijFigure3:Theoverallratioofsuccessfullytrackedparticlestototaldetectedparticlesasafunc-tionofincreasingappliedmotion,i.e.,imagestep,andthedisplacementRMSerrorateachstepforsynthetic2D(toprow)&3D(middlerow)homogeneousdeformationsfortheproposedSerial-Trackmethod.(SD:seedingdensity).Asynthetic2Dexampleusinga“star"patternheterogeneousdisplacementﬁeldisshownatthebottomrow.(a,e)Unidirectionaltranslationsinthex-directionfrom0pixels(orvoxels)to4pixels(orvoxels).(b,f)Rigidbodyrotationaboutthez-axiswithrota-tionanglesfrom0◦to180◦.(c,g)Uniaxialstretchinthex-directionwithstretchratiosfrom1to3.(d,h)Simplexy-andxz-shearwithshearanglesfrom0◦to45◦.(i)Trackedxandydisplacementﬁeldsinthesynthetic“star"patternheterogeneousﬁeldandtheirverticaldisplacementsretrievedalongthecenterrowarefurthersummarizedin(j).Theverticaldisplacementhasavaryingspatialperiod,λ,from10pixelsatx=1pixels,to300pixelsatx=4001pixelsaccordingtoEq(2).Thespatialperiodoftheverticalsinewaveintheassigneddisplacementﬁeldispropor-tionaltotheimagepositionacrossthewidthoftheimage.Themagnitudeoftheperiodicverticaldisplacementsis±2pixels.Thegroundtruthofhor-12izontaldisplacementiszero.Wetestdifferentbeadseedingdensities(SD)of(0.003,0.006,and0.012)beadsperpixel.Noadditionalnoiseisaddedduringtheimagegeneration.λ=10+300−104001(x−1)(2)BothSerialTracktrackedhorizontalandverticaldisplacementﬁeldsaresummarizedinFig.3(i).Verticaldisplacementsretrievedalongthecenterrow(y=251)arefurthersummarizedinFig.3(j).Thegroundtruthoftheverti-caldisplacementaty=251pixelsis2pixels.First,weﬁndthatSerialTrackcanresolveheterogeneousdeformationswell.Particularly,usingdenseparti-cleswhereSD>0.006particlesperpixelcanaccuratelyrecoverhighlyoscillat-ingdeformationﬁeldswhenx>500pixels,wherethewavelengthisgreaterthan46pixels.Wealsoﬁndthatthetrackedverticaldisplacementforhighlyoscillatingdeformationontheleftsideisunderestimatedandnoisy.Thisisnotsurprising,becausewithatopology-basedparticletrackingapproachitischallengingtoresolveheterogeneousdeformationwhosecharacteristicwave-length(λ)issmallerthanhalfoftheaveragednearest-neighbor-particledis-tance∼O(SD−1/2).Comparedwithothersubset-basedcorrelationmethods[57],theSerialTrackmethodisnotonlyabletosolvedenseparticlesbutalsosparseparticles.Additionally,itcanbecomputationallycheaper,withapo-tentialcomputationalcostreductionontheorderof(#ofimagepixels)/(#ofparticles).3.2.ExperimentalexamplesWiththesyntheticdeformationcasesshowingstrongperformanceacrossarangeofdeformationmodesandparticledensitiesforboth2Dand3D,wemovetoavarietyofexperimentaltestcases.Testcasesareconductedinboth2Dand3D,withsparseanddenseparticles,andaresummarizedinFigs.4-6.Additionally,a2Dlargedeformationuniaxialcompressionexperimentisemployedtodemonstratethe“softparticle”implementationinSection3.2.2wheretheink-printedcirculardotshavesigniﬁcantshapedistortion.3.2.1.2D“hard”particleexamplesFigure4ashowsanexampleof2Dsparseparticletrackinginalaser-inducedcavitationeventinasoftmaterialspecimen.FollowingMcGheeetal.[58],15µmpolystyreneparticlesareembeddedintoasingle,ﬂatplanewithinthebulkofagelatinhydrogel.Thenthesampleisplacedintotheopticalpathofalaser-basedcavitationsystem[59,60].A6nslaserpulseispathedthroughthebackportofaninvertedmicroscopeandfocusedviaa20×magniﬁcation,0.5numericalaperture(NA)(i.e.,20×/0.5NA)imagingobjectiveontotheimag-ingplanetoinduceacavitationbubbleonthesameplaneastheembeddedparticles.Figure4a(i)showstheresultingbubbleradiusvs.timecurvewithcall-outsforspeciﬁcframesofinterestdenotedbyabluestar,reddiamond,andyellowcirclewhichcorrespondstotheexpansion,maximumbubblera-dius,andneartheﬁrstcollapse,respectively.Twoimagesofatypicalcavita-tioneventareshowninFig.4a(ii).Bytrackingmotionsoftheembedded2Dsparseparticlesinthisimagesequence,wecanreconstructtheevolutionoftheresultingtime-resolvedvelocityﬁelds.Forexample,theradialvelocityvs.13radialdistancecurvesarecomputedandplottedinFig.4a(iii).Velocityﬁeldsatthemarkedexpansion(bluestar)andcollapse(yellowcircle)timepointsinFig.4a(i)aresummarizedinFig.4a(iv).Asanexampleofa2Ddenseparticletracking,weexamineacasewherethedataoriginatesfromhigh-speedPIVmeasurementsofﬂowinatube[42],asshowninFig.4b(i).WeusethesameLaplacianofGaussianimageﬁlter-ingtechniqueasdescribed[42]todetectsingleparticles(seeFig.4b:ii-iii).Wetestedboththeincrementalandcumulativemodes(seeFig.4(b:v-vii)).Inthecumulativemode,wedirectlytrackthetotal,cumulativedisplacementofeachindividualparticle.Intheincrementalmode,thecumulativedisplacementsarecomputedbymergingtrajectorysegments(refertoSec.2.4).Theﬁnalcu-mulativetrackingratioisgivenineachcaseinFig.4(b:iv).ThereconstructedcumulativedisplacementﬁeldsfortheﬁrstandninthframesarevisualizedinFig.4(b:viii-ix),wherethecumulativedisplacementintheninthframeislargebutstillwelltrackedbytheSerialTrackimplementation.3.2.2.2D“soft”particleexampleHerewedemonstratetheSerialTrackcodeonalargedeformationuniax-ialcompressionexperimentonanopen-cellpolyurethanefoamsamplewithanominaldensityof240kg/m3.Thedimensionsofthefoamspecimenwereapproximately12.7mm×12.7mm×12.7mm.TheexperimentalsetupandotherexperimentaldetailscanbefoundinYangetal.[61].Thereferenceanddeformedimagesatcompressionratiosof7.3%,16.6%,25.9%,and37.4%areshowninFig.5a,withmagniﬁedinsetsshowninFig.5b.Threedashed-lineellipsesandthreerectanglesaremarkedtohighlightthesamelocationsonthefrontsurfaceofthetestingspecimenthatunderwentlargedeformations.AsdescribedinAlgorithm2,deformedimagesareiterativelywarpedandsingleparticlesaredetectedduringeachADMMiteration.HerewepresenttheﬁnalwarpedimagesinFig.5c.Thecorrespondingdetectedparticlecen-troidsaremarkedwithreddotsandshownundermagniﬁcationinFig.5d.TheﬁnaltrackedcumulativedisplacementsarevisualizedinconeplotsandsummarizedinFig.5e.3.2.3.3DexamplesAsasparse3Dtrackingexamplecase,inspiredbybiologicalapplicationssuchastraumaticbraininjury[62,63],weseeded5µmﬂuorescentmicroparti-clesata1.5%vol/volfractioninasoftpolyacrylamidehydrogelanddeformedthehydrogelinasimple-shear-likemodeonaconfocallaserpointscanningmi-croscopeusinga20×/0.5NA(approximately1µmvoxelsize)imagingobjec-tive.Thesheardeformationwasimposedquasi-statically(1minuteperstep)in10stepsinnominally4%engineeringshearstrainincrementsfrom0%strainto40%strain,andatotalofO(100)particlesweretrackedasshowninFig.6a(i)wheretheartiﬁcialcoloroftheparticlesdependsonthez-coordinate.Results,includingtheparticletrackingratios,nominalcrosshead,andreconstructeddeformationgradienttensorcomponents,areshowninFig.6a(ii,iii).Inaddi-tion,notethattheﬁnalcumulativetrackingratioobtainedbymergingincre-mentallytrackedtrajectorysegmentsishigherthanthedirectcumulativemode(seeFig.6a(ii)).WealsotestourSerialTrackmethodfortrackingdenselyseeded,three-dimensionalparticles.Inthisexperiment,a1mmdiameterstainlesssteel140.80.60.40.20510Deformed image #Tracking ratio(α)(β)CumulativeIncrementalTrajectory merging20406002040x-axis (μm)6080y-axis (μm)Image #1Image #9Disp |u| (μm)42060.80.60.40.20Tracked particle trajectories20 μm8x-axis (μm)14101268x-axis (μm)747072Frame# 1   10biii2D Sparse PT0100200t (us)0R (um)200100200400600r (um)-4-2024v (m/s)2D Dense PTaiiiiviiiiiivivviiviixviii100 μm100 μmFigure4:2D“hard”particletrackingexperimentalexamples.(a)Trackinglaser-inducedinertialcavitationinasoftmaterialspecimenwithsparseparticles[58].(a:i)Experimentallymeasuredbubbleradiusvs.timecurve.Threespeciﬁcframesofinterestaredenotedbyabluestar,reddiamond,andyellowcircle,whichcorrespondstotheexpansion,maximumbubbleradius,andneartheﬁrstcollapse,respectively.(a:ii)Rawhigh-speedcameraframesatthebluestarandreddiamondtimepoints.(a:iii)Reconstructedradialvelocityvs.radialdistancecurvesatthethreemarkedtimepointsin(a:i).(a:iv)Reconstructedvelocityﬁeldsatthebluestarandyellowcircletimepoints.(b)2Ddenseparticletrackingexampleofﬂowthroughabentpipe[42].(b:i)Onetypicalframeinthetime-resolvedimagesequence.(b:ii-iii)DetectedsingleparticlecentroidsusingtheLaplacianofGaussianﬁlteringtechniquearecircledinred.(b:iv)Particletrackingratios.(b:v-vii)Trackedtrajectories.(b:viii-ix)Trackedcumulativedisplacementﬁeldsfortheﬁrstandninthframes.spherewithadensityof7750kg/m3wasplacedontothesurfaceofasub-mergedsoftpolyacrylamide(PA)hydrogeltoperformthesphericalindenta-tionundertheforceofgravity(g),asshowninFig.6b(i-ii).3Dvolumetricim-agestacks(imagesize:1024voxels×1024voxels×445voxels)containingﬂuo-rescentbeadswerescannedbeforeandaftertheindentationdeformationnearthehydrogelsurfaceusingmultiphotonmicroscopyanda25×/1.15NAwa-terimmersionobjective[44].Allotherexperimentalparameterscanbefound15120804002001501005015035025050500300100(i) Referenceimage(ii) 7.3 %(iii) 16.6 %(iv) 25.9 %(v) 37.4 %abcdCompression ratioTrackeddisp fields(unit: px)5 mmROIe1 mmFigure5:Demonstrationofthe“soft”particletracking(Algorithm2)viaalargedeformationuni-axialcompressionexperiment.(a)Experimentalreferenceandselecteddeformedimageswhereregionsofinterest(ROIs)aremarkedusingdashedlinerectangularboxes.Insetsaremagniﬁedandshownin(b)wherethreeellipsesandthreerectanglesaremarkedtohighlightthesameloca-tionsonthesurfaceofthespecimenthatunderwentlargedeformations,respectively.Duringthe“soft”particletrackingprocess,deformedimagesareiterativelywarpedandparticlesaredetectedasshownin(c-d).Finaltrackedcumulativedisplacementﬁeldconeplotsaresummarizedin(e).in[44].Thethree-dimensionalconeplotandthexz-planeprojectionofthetracked3DdeformationareshowninFig.6b(iii)and(iv),respectively.4.ImpactandconclusionsParticletracking,oftencalledsingleparticletracking(SPT)andparticletrackingvelocimetry(PTV),isofkeyimportanceforfull-ﬁeldquantitativeanal-ysisofdynamicprocesses,typicallyfromtime-lapseimagedata.Itoperatesbydetectingandtrackingindividualtracerparticlesorﬁducialmarkersdur-ingatime-resolvedimagesequence.Herewepresentanewhybridlocal-globaltrackingalgorithmthatbuildsaniterativescaleandrotationinvarianttopology-basedfeatureforeachparticlewithinamulti-scaletrackingprocess,wheretheglobalkinematiccompatibilityoftheﬁnaltrackeddisplacementﬁeldisoptimized.SerialTrackisabletotrackparticlesinboth2Dand3Dimages16020040060080010000200x (vx)z (vx)1000500010005000x (vx)y (vx)z (vx)0200252015105Reference ImagezxgDeformed ImageDeformationba3D Dense PT3D Sparse PTiiiiiiivdu/dxdu/dydu/dzdv/dxdv/dydv/dzdw/dxdw/dydw/dzexp dv/dz246810Loading step0.80.40-0.2Def grad123100300500(μm)-0.40.20.6Tracking ratio246810Loading step10.50CumIncTraj. mergingiiiiiiFigure6:Tracking3Ddeformations.(a)A3Dshearexample(du/dz6=0,dv/dz6=0)withsparseparticles.(a:i)Thesheardeformationwasimposedquasi-staticallyonthehydrogelsample.Allthedetectedparticlesarecoloreddependingonthez-coordinateoftheircentroids.(a:ii)Trackingra-tios.(a:iii)Reconstructeddeformationgradients,whichagreewellwiththenominalcrossheadmo-tion(codedas“exp”).(b)A3Dsphericalindentationexamplewhereparticlesaredenselyseeded.(b:i-ii)Sketchofthereferenceanddeformedconﬁgurationsofthesphericalindentationexperiment(nottoscale).(b:iii-iv)3Dconeplotandthexz-planeprojectionofthetracked3Ddeformation.withbothsparseanddenseparticleseedingdensities,andcanaccuratelyre-constructlarge,ﬁnitedeformationandvelocityﬁelds.Wealsoconsidertheeffectofshapedistortionofparticlesduetotheirlocaldeformationgradients.Weusedsyntheticexamplestoverifyandvalidatetheimplementationandprovideanestimateofthespatialresolutioncapabilities.Wethendemonstratetheperformanceandpost-processingroutinesonavarietyofexperimentaltestcasesincluding2Dand3D,sparseanddense,andsoftandhardparticles.Theprovidedopen-sourcecodepackageimplementstheproposedSerialTrackmethodandallowsuserstoapplythecodedirectlytotheirownresearch.175.ConﬂictofinterestNoconﬂictofinterestexists:Weconﬁrmthattherearenoknownconﬂictsofinterestassociatedwiththispublicationandtherehasbeennosigniﬁcantﬁnancialsupportforthisworkthatcouldhaveinﬂuenceditsoutcome.Certaincommercialequipment,softwareand/ormaterialsareidentiﬁedinthispaperinordertoadequatelyspecifytheexperimentalprocedure.InnocasedoessuchidentiﬁcationimplyrecommendationorendorsementbytheNationalInstituteofStandardsandTechnology,nordoesitimplythattheequipmentand/ormaterialsusedarenecessarilythebestavailableforthepur-pose.AcknowledgementsTheauthorsthanktheU.S.OfﬁceofNavalResearchforresearchsupportunderthe“PANTHER”program,awardnumberN000142112044throughDr.TimothyBentley.ThisresearchwasperformedwhileA.K.L.heldanNRCRe-searchAssociateshipawardwithAaronForsterattheNationalInstituteofStandardsandTechnology.AppendixA.ParticletrackingproblemformulationWeassumethateachimageisinasequenceofimagesfromthe0th(ref-erenceconﬁguration)toNth(ﬁnal,fullydeformed)conﬁguration,whereeachimageisdeﬁnedbyagrayscaleintensityﬁeldfn(x),consistingofmultiplesu-perposedintensitysources(N,e.g.,fromﬂuorescentparticles)intheimagedomainas:fn(x)=∑P∈PnN(cid:18)x;A(P)exp(cid:18)−|x−P|22σ(P)2(cid:19)I(cid:19),(A.1)wherexdenoteseachimagepixel;Pisthecoordinateofeachindividualpar-ticlecentroid;Aisthemaximumparticleintensitywithσ(P)thestandardde-viationofintensitydecayforeachparticle;Iisanidentitymatrix.Pnisthecollectionofallparticlesinimagefn,C(n)isthetotalnumberofparticlesinimagefn,andwedeﬁnetheoperatorEastheparticledetectionprocessthatextractsthecentroidposition(Pi)ofeachparticlesuchthatPn=nP0,P1,···,PC(n)o:=E(fn(x))(A.2)Thesubsequentparticlelinkingprocesssolvesfortheunknowndisplace-mentﬁelduifromimageninthesequencetoalaterimagen+tinthese-quence.Forincrementalmodewesett,1,andforcumulativemoden,0andt∈N,wheretisingeneralapositiveintegernumberofimageframes.Thelinkingprocesssolutionminimizesacostfunction,forexample,inasimplecasethesumofsquareddifferences,minuiZx|E(fn(x))−E(fn+t(x−ui))|2dx(A.3)However,theaboveoptimizationproblemisill-posed.Ingeneral,thecostfunctionisnotconvexandthesolutionisnotunique,sincethematchingofpar-ticlesPntoPn+thasnoguaranteeofuniquenessandinpracticesmismatches18andnon-matchingparticlelinksfrequentlyexist.Toreducedisplacementnoiseintroducedbymis-linkedparticles,globalregularizationpenaltiesarefurtheraddedtotheoptimizationcostfunction.Thisoptimizationproblemcanbeef-ﬁcientlysolvedbythealternatingdirectionmethodofmultipliers(ADMM)afteraddingaglobalslackvariable,ˆui.Themodiﬁedoptimizationproblemis:minuiZx|E(fn(x))−E(fn+t(x−ui))|2+α2|∇ˆui|2Fdx,subjecttoui=ˆui(A.4)wherethecoefﬁcientαisapositiveweightoftheaddedregularizerand|·|FistheFrobeniusnormfortensorssuchthat|A|2F:=∑i∑j|Aij|2.Theﬁrsttermin(A.4)isthedisplacementfromparticlematchesusingthelocallinkingalgo-rithminformation,whichcanbesolvedquicklyandinparallelasdiscussedinSect2.3.1forourimplementation.ThesecondterminEq(A.4)penalizesglobaldisplacementvarianceandnoise.Otherglobalregularizationschemescanalsobeappliedifthereisadditional,aprioriknowninformationaboutthephysicsoftheproblem.Thecombinedlocalandglobaloptimizationsolutionisimple-mentedinaniterativefashion,suchthatlocalparticlematchingisinformedbythegloballyreﬁneddisplacementﬁeldtoyieldaﬁnaluniqueandkinemati-callyadmissibledisplacementﬁelduiwithlocalaccuracyandresolutionfromindividuallytrackedcentroidlocations.AppendixB.AlternatingdirectionmethodofmultipliersToefﬁcientlysolvetheoptimizationproblemposedinEq.(A.4),itcanberewrittenforagivendisplacementstepuinADMMformas[64]:L(u,ˆu,θ)=Zx|E(fn(x))−E(fn+t(x−u))|2+α2|∇ˆu|2+µ2|ˆu−u+θ|2dx(B.1)whereµisapositivecoefﬁcientoftheaddedaugmentedLagrangianpenaltyandθisanintroduceddualvariable.DuringeachADMMiterationstep,weﬁrstdecomposetheglobalminimizationproblemEq.(B.1)intoindependent,localproblems(seeSect2.3.1),thenallthelocalsolutions,u,areprojectedontoaglobal,kinematicallycompatiblespacewheretheglobalauxiliarydisplace-mentﬁeldˆuisadmissible.Mathematically,giventheresults{uki},{ˆuki},{θki}inthekthstep,wesolvethe(k+1)thupdateusingthefollowingsteps:•Subproblem1:Localupdate.Whileholding{ˆuki}and{θki}ﬁxed,wemin-imizeEq.(B.1)over{ui}toobtain{uk+1i}.Since{ˆu}isﬁxedandµcanbeasmallvalue,thisproblemisbrokendownintoaseriesoflocalproblemsthatcanbesolvedindependentlyusinglocaltopology-basedfeaturematchingtoobtainadisplacementguess:uk+1:=argminuL(u,ˆuk,θk)(B.2)•Subproblem2:Globalupdate.Whileholding{uki}and{θki}ﬁxed,wemin-imizeLover{ˆu}suchthatˆuk+1:=argminˆuL(uk+1,ˆu,θk)(B.3)19Thisisaglobalproblem,butisindependentoftheoriginalimagesequencefsinceitonlyreliesonthedisplacementscomputedfromthelocalparticlelinkingstep.Indeed,itleadstoawell-posedlinearproblem:(cid:18)−αµ∇·∇+I(cid:19)ˆu=uk+1−θk(B.4)•Subproblem3:Dualvariableupdate.Weﬁnallyupdatethedualvariable{θ}asfollows:θk+1:=θk+ˆuk+1−uk+1.(B.5)Inpractice,thesmoothingparameterαiscarefullychosenintherangeα/µ=O(10−3)∼O(10−1)basedontheexpectedsmoothnessofthedeforma-tionﬁeld.Theparameterα/µcanbefurthertunedusingtheL-curvemethod[65].AppendixC.SyntheticimagegenerationIneachreferenceimage,isolatedsphericalbeadsarerandomlyseededus-inga2Dor3DGaussianintensityproﬁleasanapproximationofarandom,isotropicimagepattern.AtypicalGaussianpointspreadfunction(PSF)withamplitudeAandspreadσandlocatedatxisexpressedasPSF(x)=Aexp −d∑i=1x2i2σ2!I(C.1)wheredistheimagedimensionalityandxiistheith-componentofx;Iistheidentitytensor.Wechooseσ=1toapproximateacircular/sphericalparti-cleinthevolumeimagewithadiameterofapproximately5pixelsorvoxels.AllthebeadsaresampledrandomlywithseedingdensitySDwhichdenotesthenumberofparticlesperpixelorvoxel.Toavoidparticlesoverlappinginthesyntheticimages,aPoissondiscsamplingalgorithmisusedtoseedcenter-pointlocationswithaminimumseparationdistancebetweenparticlesequaltotheparticlediameter[27].Theparticlepositionsinthedeformedimagesarecalculatedviatheimposeddisplacementﬁeldandgrayscalevaluesareinter-polatedintotheimage.Inaddition,5%whiteGaussiannoisehasbeenaddedtothesyntheticimagestoroughlyapproximatetheexperimentalnoiseinourimages.References[1]N.Chenouard,I.Smal,F.DeChaumont,M.Maška,I.F.Sbalzarini,Y.Gong,J.Cardinale,C.Carthel,S.Coraluppi,M.Winter,etal.,Objectivecomparisonofparticletrackingmethods,NatureMethods11(3)(2014)281–289.URLhttps://doi.org/10.1038/nmeth.2808[2]H.G.Maas,A.Gruen,D.Papantoniou,Particletrackingvelocimetryinthree-dimensionalﬂows,ExperimentsinFluids15(1993)133–146.URLhttps://doi.org/10.1007/BF0019095320[3]E.Meijering,O.Dzyubachyk,I.Smal,Chapternine-MethodsforCellandParticleTracking,in:P.M.conn(Ed.),MethodsinEnzymology,Vol.504ofImagingandSpectroscopicAnalysisofLivingCells,AcademicPress,2012,pp.183–200.URLhttps://doi.org/10.1016/B978-0-12-391857-4.00009-4[4]L.Hazlett,A.K.Landauer,M.Patel,H.A.Witt,J.Yang,J.S.Reich-ner,C.Franck,Epiﬂuorescence-basedthree-dimensionaltractionforcemi-croscopy,ScientiﬁcReports10(2020)16599.URLhttps://doi.org/10.1038/s41598-020-72931-6[5]V.Ulman,M.Maška,K.E.Magnusson,O.Ronneberger,C.Haubold,N.Harder,P.Matula,P.Matula,D.Svoboda,M.Radojevic,etal.,Anob-jectivecomparisonofcell-trackingalgorithms,NatureMethods14(12)(2017)1141–1152.URLhttps://doi.org/10.1038/nmeth.4473[6]H.Ewers,A.E.Smith,I.F.Sbalzarini,H.Lilie,P.Koumoutsakos,A.He-lenius,Single-particletrackingofmurinepolyomavirus-likeparticlesonlivecellsandartiﬁcialmembranes,ProceedingsoftheNationalAcademyofSciences102(2005)15110–15115.URLhttps://doi.org/10.1073/pnas.0504407102[7]I.F.Sbalzarini,P.Koumoutsakos,Featurepointtrackingandtrajectoryanalysisforvideoimagingincellbiology,JournalofStructuralBiology151(2005)182–195.URLhttps://doi.org/10.1016/j.jsb.2005.06.002[8]M.Wu,J.W.Roberts,S.Kim,D.L.Koch,M.P.DeLisa,CollectiveBacte-rialDynamicsRevealedUsingaThree-DimensionalPopulation-ScaleDe-focusedParticleTrackingTechnique,AppliedandEnvironmentalMicro-biology72(2006)4987–4994.URLhttps://doi.org/10.1128/AEM.00158-06[9]S.E.Leggett,M.Patel,T.M.Valentin,L.Gamboa,A.S.Khoo,E.K.Williams,C.Franck,I.Y.Wong,Mechanophenotypingof3Dmulticellularclustersusingdisplacementarraysofrenderedtractions,ProceedingsoftheNationalAcademyofSciences117(2020)5655–5663.URLhttps://doi.org/10.1073/pnas.1918296117[10]R.Ardekani,A.Biyani,J.E.Dalton,J.B.Saltz,M.N.Arbeitman,J.Tower,S.Nuzhdin,S.Tavare,Three-dimensionaltrackingandbehaviourmon-itoringofmultiplefruitﬂies,JournalofTheRoyalSocietyInterface10(2013)20120547.URLhttps://doi.org/10.1098/rsif.2012.0547[11]J.-T.Kim,D.Kim,A.Liberzon,L.P.Chamorro,Three-dimensionalParti-cleTrackingVelocimetryforTurbulenceApplications:CaseofaJetFlow,JournalofVisualizedExperiments:JoVE(2016)53745.URLhttps://doi.org/10.3791/53745[12]D.Saha,M.U.Babler,M.Holzner,M.Soos,B.Lüthi,A.Liberzon,W.Kinzelbach,BreakupofFinite-SizeColloidalAggregatesinTurbulent21FlowInvestigatedbyThree-Dimensional(3D)ParticleTrackingVelocime-try,Langmuir32(2016)55–65.URLhttps://doi.org/10.1021/acs.langmuir.5b03804[13]J.C.Crocker,D.G.Grier,Methodsofdigitalvideomicroscopyforcol-loidalstudies,JournalofColloidandInterfaceScience179(1)(1996)298–310.URLhttps://doi.org/10.1006/jcis.1996.0217[14]T.G.Mason,D.A.Weitz,OpticalMeasurementsofFrequency-DependentLinearViscoelasticModuliofComplexFluids,PhysicalReviewLetters74(1995)1250–1253.URLhttps://doi.org/10.1103/PhysRevLett.74.1250[15]C.Manzo,M.F.Garcia-Parajo,Areviewofprogressinsingleparticletracking:frommethodstobiophysicalinsights,ReportsonProgressinPhysics78(12)(2015)124601.URLhttps://doi.org/10.1088/0034-4885/78/12/124601[16]P.Y.Huang,S.Kurasch,J.S.Alden,A.Shekhawat,A.A.Alemi,P.L.McEuen,J.P.Sethna,U.Kaiser,D.A.Muller,Imagingatomicrearrange-mentsintwo-dimensionalsilicaglass:watchingsilica’sdance,Science342(6155)(2013)224–227.URLhttps://doi.org/10.1126/science.1242248[17]M.Novara,F.Scarano,Aparticle-trackingapproachforaccuratematerialderivativemeasurementswithtomographicPIV,ExperimentsinFluids54(2013)1584.URLhttps://doi.org/10.1007/s00348-013-1584-5[18]W.N.Smith,Asubmersiblethree-dimensionalparticletrackingvelocime-trysystemforﬂowvisualizationinthecoastalocean,LimnologyandOceanography:Methods6(2008)96–104.URLhttps://doi.org/10.4319/lom.2008.6.96[19]F.Pereira,H.Stüer,E.C.Graff,M.Gharib,Two-frame3Dparticletracking,MeasurementScienceandTechnology17(2006)1680–1692.URLhttps://doi.org/10.1088/0957-0233/17/7/006[20]N.T.Ouellette,H.Xu,E.Bodenschatz,Aquantitativestudyofthree-dimensionalLagrangianparticletrackingalgorithms,ExperimentsinFlu-ids40(2006)301–313.URLhttps://doi.org/10.1007/s00348-005-0068-7[21]R.Boltyanskiy,J.W.Merrill,E.R.Dufresne,Trackingparticleswithlargedisplacementsusingenergyminimization,SoftMatter13(2017)2201–2206.URLhttps://doi.org/10.1039/C6SM02011A[22]W.R.Legant,J.S.Miller,B.L.Blakely,D.M.Cohen,G.M.Genin,C.S.Chen,Measurementofmechanicaltractionsexertedbycellsinthree-dimensionalmatrices,NatureMethods7(2010)969–971.URLhttps://doi.org/10.1038/nmeth.153122[23]D.Schanz,S.Gesemann,A.Schröder,Shake-The-Box:Lagrangianparticletrackingathighparticleimagedensities,ExperimentsinFluids57(2016)70.URLhttps://doi.org/10.1007/s00348-016-2157-1[24]C.Cierpka,B.Lütke,C.J.Kähler,Higherordermulti-frameparticletrack-ingvelocimetry,ExperimentsinFluids54(2013)1533.URLhttps://doi.org/10.1007/s00348-013-1533-3[25]X.Feng,M.S.Hall,M.Wu,C.-Y.Hui,Anadaptivealgorithmfortracking3Dbeaddisplacements:applicationinbiologicalexperiments,Measure-mentScienceandTechnology25(2014)055701.URLhttps://doi.org/10.1088/0957-0233/25/5/055701[26]K.Jaqaman,D.Loerke,M.Mettlen,H.Kuwata,S.Grinstein,S.L.Schmid,G.Danuser,Robustsingle-particletrackinginlive-celltime-lapsese-quences,NatureMethods5(2008)695–702.URLhttps://doi.org/10.1038/nmeth.1237[27]M.Patel,S.E.Leggett,A.K.Landauer,I.Y.Wong,C.Franck,Rapid,topology-basedparticletrackingforhigh-resolutionmeasurementsoflargecomplex3Dmotionﬁelds,ScientiﬁcReports8(1)(2018)1–14.URLhttps://doi.org/10.1038/s41598-018-23488-y[28]K.Ohmi,S.P.Panday,ParticleTrackingVelocimetryUsingtheGeneticAlgorithm,JournalofVisualization12(2009)217–232.URLhttps://doi.org/10.1007/BF03181860[29]A.V.Abraham,S.Ram,J.Chao,E.S.Ward,R.J.Ober,Quantitativestudyofsinglemoleculelocationestimationtechniques,OpticsExpress17(2009)23352–23373.URLhttps://doi.org/10.1364/OE.17.023352[30]A.Small,S.Stahlheber,Fluorophorelocalizationalgorithmsforsuper-resolutionmicroscopy,NatureMethods11(2014)267–279.URLhttps://doi.org/10.1038/nmeth.2844[31]S.-L.Liu,J.Li,Z.-L.Zhang,Z.-G.Wang,Z.-Q.Tian,G.-P.Wang,D.-W.Pang,FastandHigh-AccuracyLocalizationforThree-DimensionalSingle-ParticleTracking,ScientiﬁcReports3(2013)2462.URLhttps://doi.org/10.1038/srep02462[32]R.Parthasarathy,Rapid,accurateparticletrackingbycalculationofradialsymmetrycenters,NatureMethods9(2012)724–726.URLhttps://doi.org/10.1038/nmeth.2071[33]J.M.Newby,A.M.Schaefer,P.T.Lee,M.G.Forest,S.K.Lai,Convolu-tionalneuralnetworksautomatedetectionfortrackingofsubmicron-scaleparticlesin2Dand3D,ProceedingsoftheNationalAcademyofSciences115(2018)9026–9031.URLhttps://doi.org/10.1073/pnas.180442011523[34]D.Ershov,M.-S.Phan,J.W.Pylvänäinen,S.U.Rigaud,L.LeBlanc,A.Charles-Orszag,J.R.W.Conway,R.F.Laine,N.H.Roy,D.Bonazzi,G.Duménil,G.Jacquemet,J.-Y.Tinevez,BringingTrackMateintotheeraofmachine-learninganddeep-learning,bioRxiv(2021).URLhttps://doi.org/10.1101/2021.09.03.458852[35]J.ZepedaO,L.D.C.Bishop,C.Dutta,S.Sarkar-Banerjee,W.W.Leung,C.F.Landes,UntyingtheGordianKNOT:UnbiasedSingleParticleTrack-ingUsingPointCloudsandAdaptiveMotionAnalysis,TheJournalofPhysicalChemistryA(2021)8723–8733.URLhttps://doi.org/10.1021/acs.jpca.1c06100[36]Y.Cui,Y.Zhang,P.Jia,Y.Wang,J.Huang,J.Cui,W.T.Lai,Three-dimensionalparticletrackingvelocimetryalgorithmbasedontetrahedronvote,ExperimentsinFluids59(2018)31.URLhttps://doi.org/10.1007/s00348-017-2485-9[37]A.Rubbert,W.Schroder,Iterativeparticlematchingforthree-dimensionalparticle-trackingvelocimetry,ExperimentsinFluids61(2020)58.URLhttps://doi.org/10.1007/s00348-020-2891-2[38]Y.Zhang,Y.Wang,B.Yang,W.He,Aparticletrackingvelocimetryalgo-rithmbasedontheVoronoidiagram,MeasurementScienceandTechnol-ogy26(2015)075302.URLhttps://doi.org/10.1088/0957-0233/26/7/075302[39]J.Heyman,TracTrac:Afastmulti-objecttrackingalgorithmformotionestimation,Computers&Geosciences128(2019)11–18.URLhttps://doi.org/10.1016/j.cageo.2019.03.007[40]J.-Y.Tinevez,N.Perry,J.Schindelin,G.M.Hoopes,G.D.Reynolds,E.La-plantine,S.Y.Bednarek,S.L.Shorte,K.W.Eliceiri,TrackMate:Anopenandextensibleplatformforsingle-particletracking,Methods115(2017)80–90.URLhttps://doi.org/10.1016/j.ymeth.2016.09.016[41]K.Ohmi,H.-Y.Li,Particle-trackingvelocimetrywithnewalgorithms,MeasurementScienceandTechnology11(2000)603–616.URLhttps://doi.org/10.1088/0957-0233/11/6/303[42]T.Janke,R.Schwarze,K.Bauer,Part2Track:AMATLABpackagefordou-bleframeandtimeresolvedParticleTrackingVelocimetry,SoftwareX11(2020)100413.URLhttps://doi.org/10.1016/j.softx.2020.100413[43]J.Yang,K.Bhattacharya,AugmentedLagrangiandigitalimagecorrela-tion,ExperimentalMechanics59(2)(2019)187–205.URLhttps://doi.org/10.1007/s11340-018-00457-0[44]J.Yang,L.Hazlett,A.K.Landauer,C.Franck,Augmentedlagrangiandigitalvolumecorrelation(aldvc),ExperimentalMechanics60(9)(2020)1205–1223.URLhttps://doi.org/10.1007/s11340-020-00607-324[45]J.Yang,V.Rubino,Z.Ma,J.Tao,Y.Yin,A.McGhee,W.Pan,C.Franck,SpatiotemporallyAdaptiveQuadtreemesh(STAQ)DigitalImageCorre-lationforresolvinglargedeformationsaroundcomplexgeometriesanddiscontinuities,Underreview.[46]W.Brevis,Y.Niño,G.Jirka,Integratingcross-correlationandrelaxationalgorithmsforparticletrackingvelocimetry,ExperimentsinFluids50(1)(2011)135–147.URLhttps://doi.org/10.1007/s00348-010-0907-z[47]PTVlabsoftwarelink,http://ptvlab.blogspot.com,accessed:2022-02-24.[48]OpenPTVsoftwarelink,http://www.openptv.net,accessed:2022-02-24.[49]J.Willneff,Aspatio-temporalmatchingalgorithmfor3Dparticletrackingvelocimetry,Ph.D.thesis,ETHZurich(2003).[50]TrackMatesoftwarelink,https://imagej.net/plugins/trackmate,ac-cessed:2022-02-24.[51]Trackmatesoftwarealgorithms,https://imagej.net/plugins/trackmate/algorithms,accessed:2021-12-07.[52]TracTracsoftwarelink,https://perso.univ-rennes1.fr/joris.heyman/trac.html,accessed:2022-02-24.[53]TPTsoftwarelink,https://github.com/FranckLab/T-PT,accessed:2022-02-24.[54]E.Lejeune,A.Khang,J.Sansom,M.S.Sacks,FM-Track:Aﬁducialmarkertrackingsoftwareforstudyingcellmechanicsinathree-dimensionalen-vironment,SoftwareX11(2020)100417.URLhttps://doi.org/10.1016/j.softx.2020.100417[55]SerialTracksoftwarelink,https://github.com/FranckLab/SerialTrack,accessed:2022-03-11.[56]A.K.Landauer,M.Patel,D.L.Henann,C.Franck,Aq-Factor-BasedDigitalImageCorrelationAlgorithm(qDIC)forResolvingFiniteDefor-mationswithDegenerateSpecklePatterns,ExperimentalMechanics58(2018)815–830.URLhttp://doi.org/10.1007/s11340-018-0377-4[57]P.L.Reu,B.Blaysat,E.Andò,K.Bhattacharya,C.Couture,V.Couty,D.Deb,S.S.Fayad,M.A.Iadicola,S.Jaminion,etal.,DICChallenge2.0:DevelopingImagesandGuidelinesforEvaluatingAccuracyandResolu-tionof2DAnalyses,ExperimentalMechanics(2022)1–16.URLhttps://doi.org/10.1007/s11340-021-00806-6[58]A.J.McGhee,E.O.McGhee,J.E.Famiglietti,K.D.Schulze,Dynamicsubsurfacedeformationandstrainofsofthydrogelinterfacesusinganembeddedspecklepatternwith2Ddigitalimagecorrelation,Experimen-talMechanics61(2021)1017–1027.URLhttps://doi.org/10.1007/s11340-021-00713-w25[59]J.B.Estrada,C.Barajas,D.L.Henann,E.Johnsen,C.Franck,Highstrain-ratesoftmaterialcharacterizationviainertialcavitation,JournaloftheMechanicsandPhysicsofSolids112(2018)291–317.URLhttps://doi.org/10.1016/j.jmps.2017.12.006[60]J.Yang,H.C.Cramer,C.Franck,Extractingnon-linearviscoelasticmate-rialpropertiesfromviolently-collapsingcavitationbubbles,ExtremeMe-chanicsLetters39(2020)100839.URLhttps://doi.org/10.1016/j.eml.2020.100839[61]J.Yang,J.-L.Tao,C.Franck,SmartDigitalImageCorrelationPatternsvia3DPrinting,ExperimentalMechanics61(2021)1181–1191.URLhttps://doi.org/10.1007/s11340-021-00720-x[62]L.Summey,Developmentofasimpleshearimpactdeviceforevaluatingcellulartraumaticbraininjury,Master’sthesis,UniversityofWisconsin-Madison(May2020).[63]E.Bar-Kochba,M.T.Scimone,J.B.Estrada,C.Franck,Strainandrate-dependentneuronalinjuryina3Dinvitrocompressionmodeloftrau-maticbraininjury,ScientiﬁcReports6(2016).URLhttp://doi.org/10.1038/srep30550[64]S.Boyd,N.Parikh,E.Chu,B.Peleato,J.Eckstein,DistributedOptimiza-tionandStatisticalLearningviatheAlternatingDirectionMethodofMul-tipliers,FoundationsandTrendsinMachineLearning3(1)(2011)1–122.URLhttp://dx.doi.org/10.1561/2200000016[65]P.C.Hansen,D.P.O’Leary,TheuseoftheL-curveintheregularizationofdiscreteill-posedproblems,SIAMJournalonScientiﬁcComputing14(6)(1993)1487–1503.URLhttps://doi.org/10.1137/091408626SupplementalInformationfor“SerialTrack:ScalEandRotationInvariantAugmentedLagrangianParticleTracking”JinYanga,YueYina,b,AlexanderK.Landauerc,SeldaBuyuktozturka,d,JingZhanga,LukeSummeya,AlexanderMcGheea,MattK.Fue,JohnO.Dabirie,ChristianFrancka,∗aUniversityofWisconsin-Madison,MechanicalEngineering,Madison,WI,USAbDepartmentofMechanicalEngineering,CarnegieMellonUniversity,Pittsburgh,PA,USAcNationalInstituteofStandardsandTechnology,Gaithersburg,MD,USAdSchoolofEngineering,BrownUniversity,Providence,RI,USAeGraduateAerospaceLaboratories,CaliforniaInstituteofTechnology,Pasadena,CA,USAS1.2DSyntheticuniformdeformation:“hard”particlesDetection ratioTracking ratioDisp RMS error (px)Strain RMS errora RotationUniaxial stretchSimple shearxyθxyγxyλu (px)xyuθ (ο)λtanγu (px)u (px)u (px)θ (ο)θ (ο)θ (ο)λλλtanγtanγtanγ2D hard particlesTranslationbc dFig.S1:Theratioofdetectedtototal“hard"2Dparticles,theoverallratioofsuccessfullytrackedparticlestototaldetectedparticles,andthedisplacementandstrainRMSerrorsasafunctionofincreasingappliedmotion,i.e.,imagestep,forsynthetic2DhomogeneousdeformationsfortheproposedALT-SCRIPTmethod.(a)Unidirectionaltranslationsinthex-directionfrom0to4pixels.(b)Rigidbodyrotationaboutthez-axiswithrotationanglesfrom0◦to180◦.(c)Uniaxialstretchinthex-directionwithstretchratiosfrom1to3.(d)Simplexy-shearwithshearanglesfrom0◦to45◦.∗CorrespondingauthorEmailaddress:cfranck@wisc.edu(ChristianFranck)PreprintsubmittedtoSoftwareXMarch24,2022arXiv:2203.12573v1  [cs.RO]  23 Mar 2022S2.3DSyntheticuniformdeformation:“hard”particlesxDetection ratioTracking ratioDisp RMS error (vx)Strain RMS errorTranslationRotationUniaxial stretchSimple shearu (px)θ (ο)λtanγu (px)u (px)u (px)θ (ο)θ (ο)θ (ο)λλλtanγtanγtanγxyuzθxyzxyzλγxyz3D hard particlesa bc dFig.S2:Theratioofdetectedtototal“hard"particles,theoverallratioofsuccessfullytrackedparticlestototaldetectedparticles,andthedisplacementandstrainRMSerrorsasafunctionofincreasingappliedmotion,i.e.,imagestep,forsynthetic3Dhomo-geneousdeformationsfortheproposedALT-SCRIPTmethod.(a)Unidirectionaltranslationsinthex-directionfrom0to4pixels.(b)Rigidbodyrotationaboutthez-axiswithrotationanglesfrom0◦to180◦.(c)Uniaxialstretchinthex-directionwithstretchratiosfrom1to3.(d)Simplexz-shearwithshearanglesfrom0◦to45◦.2S3.2DSyntheticuniformdeformation:“soft”particles(i) Detection ratio(ii) Tracking ratio(iii) Disp RMS error (px)(iv) Strain RMS error(a) Translation(b) Rotation(c) Uniaxial stretch(d) Simple shearxyθxyγxyλu (px)θ (ο)λtanγu (px)u (px)u (px)θ (ο)θ (ο)θ (ο)λλλtanγtanγtanγxyu2D soft particlesFig.S3:Theratioofdetectedtototal“soft"particles,theoverallratioofsuccessfullytrackedparticlestototaldetectedparticles,andthedisplacementandstrainRMSerrorsasafunctionofincreasingappliedmotion,i.e.,imagestep,forsynthetic2Dhomo-geneousdeformationsfortheproposedALT-SCRIPTmethod.(a)Unidirectionaltranslationsinthex-directionfrom0to4pixels.(b)Rigidbodyrotationaboutthez-axiswithrotationanglesfrom0◦to180◦.(c)Uniaxialstretchinthex-directionwithstretchratiosfrom1to3.(d)Simplexy-shearwithshearanglesfrom0◦to45◦.3