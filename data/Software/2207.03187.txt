Fast, accurate, and system-speciﬁc variable-resolution modelling of proteins

Raﬀaele Fiorentini,1, 2 Thomas Tarenzi,1, 2 and Raﬀaello Potestio1, 2, ∗
1Physics Department, University of Trento, via Sommarive, 14 I-38123 Trento, Italy
2INFN-TIFPA, Trento Institute for Fundamental Physics and Applications, I-38123 Trento, Italy
(Dated: July 8, 2022)

In recent years, a few multiple-resolution modelling strategies have been proposed, in which func-
tionally relevant parts of a biomolecule are described with atomistic resolution, while the remainder
of the system is concurrently treated using a coarse-grained model. In most cases, the parametri-
sation of the latter requires lengthy reference all-atom simulations and/or the usage of oﬀ-shelf
coarse-grained force ﬁelds, whose interactions have to be reﬁned to ﬁt the speciﬁc system under ex-
amination. Here, we overcome these limitations through a novel multi-resolution modelling scheme
for proteins, dubbed coarse-grained anisotropic network model for variable resolution simulations,
or CANVAS. This scheme enables the user-deﬁned modulation of the resolution level throughout
the system structure; a fast parametrisation of the potential without the necessity of reference simu-
lations; and the straightforward usage of the model on the most commonly used molecular dynamics
platforms. The method is presented and validated on two case studies, the enzyme adenylate kinase
and the therapeutic antibody pembrolizumab, by comparing results obtained with the CANVAS
model against fully atomistic simulations. The modelling software, implemented in python, is made
freely available for the community on a collaborative github repository.

(free) energy proﬁle and fewer degrees of freedom with
respect to all-atom representations.

Nonetheless, simpliﬁed models have their limitations
as well; in particular, they do not provide an accurate
description of the system if speciﬁc details, possibly cru-
cial for the properties or behaviour of interest, are eﬀec-
tively integrated out in the low-resolution model. Promi-
nent examples of this situation are provided by ligand-
binding events and protein-protein interactions, where
the relative position of individual atoms might determine
a shift in the binding aﬃnity of the complex; or ﬂexible
hinge regions, where the continuous forming and break-
ing of atomistic non-covalent interactions determine tran-
sitions between large-scale conformational states. Hence,
all-atom models provide the necessary accuracy at the
expenses of substantial computational resources, while
CG models enable a more eﬃcient and intelligible rep-
resentation of the system at the cost of losing possibly
crucial detail. Although several problems in computa-
tional biophysics can be tackled with one of these two
methods, many open questions remain that necessitate
an approach at the interface between chemical accuracy
and computational eﬃciency.

This approach was pioneered by the quantum me-
chanics/molecular mechanics (QM/MM) methods [10–
14], which allow a connection between a small region
where ab initio models are used, and a classical all-atom
description in the remainder of the system. Along the
same lines, several methodologies have been developed
to couple atomistic and coarse-grained levels of resolution
within the same simulation set-up, and even within the
same molecular structure. For example, in the Molecu-
lar Mechanics/Coarse-Grained (MM/CG) scheme devel-
oped in 2005 by Neri et.al [15], the atomistically detailed
active site is incorporated into a coarse-grained G¯o-like
model, which aims at reproducing the correct conforma-
tional ﬂuctuations of the full protein [16]. The MM/CG

Table-of-contents entry.

I.

INTRODUCTION

Steady improvements in high performance comput-
ing hardware and molecular dynamics (MD) simula-
tion software over several decades have ushered impres-
sive advancements in the computer-aided investigation of
soft and biological matter systems, in particular macro-
molecules of biological origin such as lipids, proteins, and
nucleic acids [1–3]. At the same time, a detailed mod-
elling of molecular systems, in which each atom is de-
scribed as an interaction center, often turns out to be
inconvenient or even undesirable, on the one hand due
to the major computing and data storage requirements,
on the other because of the eﬀort in analysing the sim-
ulation outcome. To overcome both limitations, simpli-
ﬁed, coarse-grained (CG) models [4–9] are frequently em-
ployed, in which several atoms are lumped in eﬀective in-
teraction sites. CG models enable the simulation of larger
systems over longer time scales, thanks to a smoother

∗ raﬀaello.potestio@unitn.it

2
2
0
2

l
u
J

7

]
t
f
o
s
.
t
a
m
-
d
n
o
c
[

1
v
7
8
1
3
0
.
7
0
2
2
:
v
i
X
r
a

CANVAS(a)(b)(c)(a)(b)(c)MappingForce Field 
 
 
 
 
 
method was later tailored for the simulation of mem-
brane protein/ligand complexes [17], and in the last ver-
sion of the method, dubbed open-boundary MM/CG [18],
the dual-resolution description of the protein is coupled
with an adaptive multiscale model of the solvent, namely
the Hamiltonian adaptive resolution scheme (H-AdResS)
[19, 20]; in the latter, regions of diﬀerent resolution are
deﬁned in the simulation box, allowing water molecules
to change their resolution on the ﬂy when diﬀusing from
one region to the other. More recently, a similar method
[21, 22] employed a high-resolution force ﬁeld in small
regions of a protein, most notably the active site, while
treating the remainder in a coarse-grained fashion, e.g.
as an elastic network model (ENM) [23].

Dual-resolution methods have been successfully ap-
plied for the study of several biological systems, including
soluble [22] and membrane proteins [24–26]. However,
the available approaches share some common shortcom-
ings: ﬁrst, the standard modelling of the CG region al-
lows little ﬂexibility in the choice of the CG sites; sec-
ond, the CG region is usually deﬁned ad hoc, and new
mappings require a completely new reparametrisation of
the interactions; third, non-bonded interactions (such as
electrostatics) are typically not taken into account in the
CG model, thus preventing interactions between diﬀer-
ent structural domains that might come in close contact
during the course of the simulation. CG models with
an accurate description of electrostatics have been de-
veloped [27–29]; however, in such cases, the protein is
uniformly coarse-grained at a resolution intermediate be-
tween the atomistic and one-bead-per-amino acid one,
thus limiting the level of coarse-graining and prevent-
ing a straightforward coupling between regions at diﬀer-
ent resolution. These limitations hinder the applicability
of standard multiple-resolution models, with detrimental
consequences for the in silico investigation of proteins
and their interactions.

In this work we propose a novel approach, dubbed
coarse-grained anisotropic network model for variable
resolution simulations, or CANVAS, which enables a
fast parametrisation of multiple-resolution models. The
CANVAS strategy leverages the blurred and approxi-
mate nature of coarse-grained models to identify eﬀec-
tive sites based on a user-provided input, and determines
the interactions among them based on the molecule’s
structure and all-atom force ﬁeld, making it unnecessary
to run reference simulations. This strategy makes the
parametrisation of the model practically instantaneous,
and allows the modulation of the system’s resolution in a
quasi-continuous manner across the structure, from all-
atom to (very) coarse-grained. Most notably, the interac-
tion between regions of the system at diﬀerent resolution
(including the solvent) is accounted for and straightfor-
ward to set up, allowing the seamless implementation
in standard MD software packages (e.g. GROMACS or
LAMMPS).

2

tion of the multiple resolution representation and on the
parametrisation of the interactions. A Methods section
follows, providing the simulation details. The results of
the validation of the CANVAS approach are then pre-
sented, by comparing results from all-atom and multi-
scale simulations of two biomolecules, namely the enzyme
adenylate kinase and the IgG4 antibody pembrolizumab,
each modelled with three resolution levels. Finally, con-
clusions and perspectives are discussed.

II. THE CANVAS MODEL

In the CANVAS approach to multi-resolution protein
modelling, a decimation mapping is implemented for the
choice of the interactions sites [9]: those atoms included
in a user-deﬁned list are retained, while the other ones
are discarded.
If all atoms of a given subregion of the
molecule are retained, the high-resolution atomistic de-
scription is employed; on the contrary, regions where
atoms are removed are described at a varying level of de-
tail. In lower-resolution regions, the physical properties
of the survived atoms are modiﬁed so as to incorporate
in eﬀective interactions those atoms that have been inte-
grated out (Figure 1). Speciﬁcally, each discarded atom
is associated to the closest surviving one, and the proper-
ties of the latter are determined from those of the group
of discarded atoms it represents.

The CANVAS model enables in principle a quasi-
continuous modulation of the resolution of a protein or
part of it, in that the detail of representation can be grad-
ually reduced from the all-atom level to a very coarse
one, possibly lower then a few (1 to 3) amino acids per
bead; between highest and lowest resolutions, an arbi-
trary number of intermediate levels are feasible. In the
current implementation, we performed the choice of em-
ploying three levels of resolution:

• all-atom (AT): the highest level of detail, where
all the atoms of a given amino acid are retained;

• medium-grained (MG): intermediate level of de-
tail, where only the backbone atoms of an amino
acid are retained, i.e. the carbon alpha CAmg, the
nitrogen Nmg of the amino group, the oxygen Omg
and the carbon Cmg of the carboxyl group.

• coarse-grained (CG): the lowest level of resolu-
tion. In the applications presented here, only the
Cα atoms of each CG residue are kept, dubbed
CAcg.

The sets of protein residues modelled with an AT, MG,
or CG detail are speciﬁed by the user and do not change
during the simulation, that is, the biomolecule has a time-
independent triple resolution. Table I summarizes the
survived atoms in each region and their label.

The paper is structured as follows: ﬁrst, we describe
in detail the CANVAS model, focusing on the construc-

The ﬁrst step of the model construction is to identify
the region of the system where the chemical details play

3

Label

Region

Survived atoms per aa

at

fully-AT

all (CAat, Nat, etc.)

mg medium-grained backbone (Nmg, CAmg, Cmg, Omg)

cg

coarse-grained

Cα (CAcg)

TABLE I: Description of survived atoms for amino acids
(aa) for each level of resolution.

a crucial role, such that no simpliﬁcation of the atomistic
description is desirable. Residues described at MG and
CG resolutions can be either speciﬁed from the user or di-
rectly identiﬁed on the basis of the atomistic residues; in
the latter case, the MG region is built by including those
residues at a distance of 1 nm from the AT region, while
the rest of the biomolecule is automatically assigned a
CG representation.

The AT part is modelled through a standard atomistic
force ﬁeld (in the implementation discussed here, these
are Amber99SB-ildn [30] or CHARMM36m [31]), where
the classical functional form and parametrisation of the
bonded and non-bonded interactions between atoms are
In the MG and CG domains, the potential
employed.
energy is given by:

E = EAA + Eharmonic
+ EV dW + Ecoulomb.

(1)

The ﬁrst term, EAA, corresponds to bonded inter-
actions from the atomistic force ﬁeld, namely chemical
bonds, angles, and proper/improper dihedrals:

EAA = Ebonds · h (r) + Eangles · h(θ) +

+ Edihedrals · h(φ) + Eimproper · h(ω).

(2)

Here, h(r), h(θ), h(φ), h(ω) are Heaviside functions
taking value 1 if a bond, angle, dihedral or improper dihe-
dral exists in the atomistic force ﬁeld for a couple, triplet,
or quadruplet of survived atoms. Therefore, stretching,
bending, and torsion potentials with their original equi-
librium values are possible only if, respectively, the pair,
triplet, and quadruplet of atoms (where at least a CG
bead is involved) from the all-atom representation of ref-
erence are maintained in the MG and CG regions. The
second term in Eq. 1, Eharmonic, describes the bonded
interactions between and within the low-resolution do-
mains. The bonded connectivity and its parametrisation
are strictly dependent on the resolution levels employed
and on the chemical nature of the retained sites, namely
on their atom type. In the current implementation, beads
are connected by harmonic springs as schematically de-
picted in Figure1d and described in detail in Figure 2.
Speciﬁcally, we make use of three diﬀerent elastic con-
stants:

1. a stiﬀ spring (kb) for consecutive beads (red line of
Figure 2): its value is 5 · 104 kJ · mol−1· nm−2.

FIG. 1: Scheme of the decimation process in the
low-resolution part of the biomolecule. (a): blue circles show
all the atoms in the low-resolution part. (b): choice of the
atoms that survive depicted in red. (c): the decimated
atoms (light orange and light green) are mapped onto their
closest survived atom in terms of Euclidean distance (orange
and green arrows), according to the Voronoi tessellation.
(d): Each survived atom, shown with a large red circle, is
representative of the closest not-survived atoms mapped by
it. A harmonic spring, depicted with a dashed yellow line,
connects the neighbouring survived atoms.

(a)(b)(c)(d)2. A weaker spring knb for non-consecutive Cα beads
(CAcg – CAmg, CAcg – CAcg, CAmg – CAmg)
whose distance in the reference (native) conforma-
tion lies below a ﬁxed cutoﬀ equal to 1.4 nm (or-
ange line of Figure 2). Critically, the magnitude
of knb depends on the distance d between the two
Cα beads, farther CG units interacting through
looser springs. The proﬁle of knb(d) was obtained
through a statistical analysis performed over an
ensemble of eﬀective pair potentials acting among
non-consecutive Cα atoms in the pembrolizumab
antibody; such potentials were extracted via direct
Boltzmann inversion. See Section S1 in the Sup-
porting Information for further technical details.

3. A second weaker spring kif employed between an
atomistic Cα and a CA bead (CAat – CAmg or
CAat – CAcg) if they do not belong to consecutive
residues, and their distance in the reference con-
formation is less than a ﬁxed cutoﬀ equal to 1.4
nm (magenta dash line of Figure 2). The recom-
mended value of kif is 50 kJ · mol−1· nm−2 in order
to guarantee the appropriate degree of ﬂexibility.

We stress that, if the two survived atoms taken into
account are connected by a covalent bond in the fully-
atomistic representation, the latter replaces Eharmonic
(black line of Figure 2). Similarly, bending and torsion
potentials with their original atomistic parametrisation
are maintained if the triplet and quadruplet of atoms
(where at least a CG bead is involved) in the all-atom
representation of reference are retained in the coarse re-
gions. Rescaled non-bonded 1-4 interactions are intro-
In addition, in order to
duced only in the AT region.
guarantee the correct degree of ﬂexibility in multidomain
proteins, no bond is introduced between those beads that
are close in space in the starting conﬁguration but belong
to distinct structural domains; the latter can be deﬁned
by the user in an optional input ﬁle containing the indices
of the residues belonging to each domain.

Finally, EV dW and Ecoulomb in Eq. 1 are the Van der
Waals and Coulomb non-bonded contributions to the po-
tential energy between nodes. For the AT region, stan-
dard force-ﬁeld parameters are taken, while in the MG
and CG regions, the charge and Lennard-Jones parame-
ters of each bead are computed from the average prop-
erties of the neighbouring atoms, as deﬁned through a
procedure akin to a Voronoi tessellation [32–34]. First,
a Voronoi cell is deﬁned by associating the decimated
atoms (blue circles of Figure 1b) to the closest survived
atom (in terms of Euclidean distance (cid:96)), which is now
treated as a CG bead (Figure 1c, and Figure 3b-c).
We underline that, since a geometric criterion is em-
ployed to group atoms, the resulting bead is representa-
tive of atoms that could also belong to separate residues,
as schematically shown in Figure 3. For this reason,
the protein’s starting structure plays a relevant role in
the Voronoi tessellation, since the relative orientation of
side-chains might inﬂuence the construction of the cells.

4

Therefore, it is important that the structure employed as
a reference for coarse-graining is minimized and equili-
brated.

After the deﬁnition of the Voronoi cells, non-bonded
potential parameters are computed for each CG bead.
Speciﬁcally, for a mapping that retains N atoms out of
n:

• the charge QI is deﬁned as the algebraic sum of the

charges qi of the atoms it represents:

QI ≡

(cid:88)

i∈I

qi.

(3)

• The diameter σI is twice the gyration radius Rg:

(4)

σI ≡ 2 · Rg
where:

R2

g =

1
N

·

rcog =

1
N

N
(cid:88)

i=1

N
(cid:88)

i=1

|ri − rcog|2

ri.

Here, ri are the coordinates of each atom, whereas
rcog corresponds to the coordinates of the center of
geometry of the group.

• (cid:15)I is the geometric average of the (cid:15)i values of the

atoms it represents:

(cid:15)I ≡

1
N
i

(cid:15)

.

(cid:89)

i∈I

(5)

As opposed to the network of bonded interactions,
where a predeﬁned set of parameters is employed, the
non-bonded part is automatically constructed on the ba-
sis of the properties of the retained sites, independently
of the level of resolution and the bonded connectivity
between them.

The code and examples of input ﬁles for simulating a
system with the CANVAS model are freely available at
https://github.com/potestiolab/canvas. The code con-
sists of two python scripts: the ﬁrst one (block.py) has
the purpose of creating the list of survived atoms with
their relative labels (AT, MG, or CG); the second script
(CANVAS.py) returns the input ﬁles needed for simulat-
ing a solvated biomolecule in LAMMPS or GROMACS,
according to the choice made by the user. The mandatory
arguments for the successful execution of the code are the
list of survived atoms, the coordinate ﬁle (.gro) and the
topology ﬁle (.top) of fully-atomistic representation. A
detailed description of the other parameters (mandatory
and optional) and a tutorial for the construction and sim-
ulation of a CANVAS model, starting from the atomistic
representation, are available on the same repository.

5

FIG. 2: Schematic representation of the bonded interactions in the three regions at diﬀerent resolution. On the top of the
ﬁgure, only consecutive residues are considered; on bottom, non-consecutive ones. The atoms/beads that belong to the 1st
residue are traced with a circle, while those ones that belong to the 2nd residue are sketched with a square. R stands for the
side chain. In the ﬁgure, hydrogen atoms are ignored for clarity, while being explicitly accounted for in the model. Bonded
interactions are represented with diﬀerent colors and thicknesses according to the spring constant.

RRCoarse-GrainedConsecutiveCoarse-GrainedbackbonebackbonefullyATCαCαCαfullyATNCαCONCαCOCαONCCαCONRCαCONNon-ConsecutiveCoarse-GrainedCoarse-GrainedCαCαbackboneCαfullyATbackboneNCαCONCαCONCαCOfullyATRCαCONCαCONRCαCONRCαNC1st res. bead     2nd res. bead   CG bead   fullyAT atom    hybrid bead    Covalent bond    Strong bond   Weak bond  Interface bondCαCαCαCαCαCαCαNCOCαNCOCαNCOCαNCOCαNCOCαNCOCαNCORNCαCOCαNCORCαNCORCαNCORCαNCORCαNCORMedium-GrainedMedium-GrainedMedium-GrainedMedium-GrainedMG beadNon-ConsecutiveConsecutive ea1i6

taining the energetic balance in the cell, interconvert-
ing adenosine diphosphate (ADP) molecules into adeno-
sine monophosphate (AMP) and adenosine triphosphate
(ATP) [39]. The structure of ADK can be partitioned
in three domains, called core, lid, and NMP, and two
distinct nucleotide binding sites, as shown in Figure4a-b.
The second system used here as a test case, pem-
brolizumab, is a humanized IgG4 antibody consisting of
four chains, covalently bound by disulﬁde bonds (Figure
5a). Pembrolizumab – which is the generic name for the
trade drug name Keytruda® – is currently used in im-
munotherapy as an anticancer drug [40]. Its antigen is
the programmed cell death protein 1 (PD-1), expressed
on the membrane of T cells, B cells, and natural killer
cells; the formation of the high-aﬃnity complex between
the antibody and its antigen prevents the binding of PD-1
with the programmed cell death receptor ligands PD-L1
and PD-L2, which would lead to a suppression of the
anti-tumor activity of T cells [41].

The reference structures employed for the construc-
tion of the multiscale models were obtained from equi-
librated all-atom simulations. Speciﬁcally, the crystallo-
graphic ADK structure (PDB ID: 4AKE) was solvated
in an aqueous solution at 0.15M NaCl concentration; fol-
lowing energy minimization, the system was equilibrated
for 125 ns in the NPT ensemble, using the Parrinello-
Rahman barostat [42] with a time constant of 2.0 ps at
1 bar and the Langevin thermostat [43] to keep the tem-
perature at 300 K. The all-atom simulation was extended
for 500 ns, on which the analyses were performed. For
the CANVAS simulation, the equilibrated structure was
placed in a cubic simulation box of 9.1 nm per side and
solvated in an aqueous solution at 0.15M NaCl concen-
tration.

The reference structures of pembrolizumab are given
by the representative conformations sampled from four
all-atom 500 ns-long simulations of the antibody in the
apo form, after clustering the frames on the basis of their
structural similarity. Each of these atomistic simulations
was started from the PDB crystallographic structure of
the deglycosilated antibody (PDB ID: 5DK3), after mod-
elling of the missing residues; for more details on the all-
atom simulation protocol, the reader is referred to Ref.
[44]. A CANVAS simulation is started from each repre-
sentative conformation of the antibody, for a total of 6
diﬀerent runs; this choice is dictated by the large con-
formational variability of the molecule, and the peculiar
properties of each conformational basin. The CANVAS
models of the representative structures are placed in a cu-
bic simulation box of 17.9 nm per side and are solvated
in a 0.15M NaCl aqueous solution.

For both ADK and pembrolizumab, the force ﬁeld em-
ployed was Amber99SB-ildn [30] and the water model
was TIP3P [45]. CANVAS systems were prepared start-
ing from the representative structures obtained from the
atomistic simulations, after energy minimization with the
steepest descent algorithm and 100 ps of NVT equili-
bration. The temperature is kept constant at 300 K

FIG. 3: (a): schematic representation of three amino acids
arginine, leucine and lysine (from left to right). Dashed
black lines represent the peptide bonds between two
residues. The aliphatic hydrogens are not displayed for
simplicity. (b): all the three amino acids are modelled as
CG, where only the Cα atom CAcg (red, blue, and green
bigger circles) are retained. The other atoms are decimated
and mapped onto the closest survived atom (shown in pink,
light blue, and light green). A bead is not necessarily
representative of atoms belonging to the same residue, since
the grouping criterion is merely based on euclidean distance.
(c): arginine and lysine are modelled in CG (red and green
bigger circles), whereas the leucine is described in MG
(CAmg in blue, Nmg in black, Cmg in violet, and Omg in
orange).

III. MATERIALS AND METHODS

The two systems employed in the present work as a test
bed for the CANVAS model are the enzyme adenylate
kinase [35–37] and the antibody pembrolizumab [38].

Adenylate kinase (ADK) plays a critical role in main-

(a)(b)(c)7

FIG. 5: (a): Graphical representation of the
crystallographic conformation of pembrolizumab in terms of
secondary structure. Fab 1, Fab 2, Fc, and the hinge are
depicted in green, yellow, grey, and red, respectively. (b):
Schematic representation of the 4A reference conformation
of pembrolizumab before conversion from the all-atom to the
multi-resolution. In particular, in green it is depicted the
hinge of biomolecule, modelled atomistically; in orange it is
shown the part that is going to be described as MG; the
remainder, shown in blue, is going to be represented as CG.

by means of the Langevin thermostat [43]. In the NPT
production run, the Parrinello-Rahman barostat is em-
ployed, as described above. The integration step is 2
fs. The calculation of electrostatic interactions is per-
formed in all cases by using the reaction-ﬁeld method
[46, 47] with a dielectric constant of (cid:15) = 80 and a cut-
oﬀ of 2.5 · σmax; here, σmax is the maximum value of σ
among all the beads of the system. The SETTLE [48]
and RATTLE [49] algorithms for rigid water and rigid
bonds containing hydrogen have been used. The length
of the CANVAS simulations is 500 ns for ADK and 200
ns for each antibody system. All simulations are car-
ried out with GROMACS 2018 [50]. We stress here that

FIG. 4: Fully atomistic representation of ADK. In
particular, (a) and (b) show the open and the compact
conformation of the protein, respectively, in terms of
secondary structure. LID, NMP, and CORE domains are
depicted in green, yellow, and grey. (c) displays a schematic
representation of the reference structure of ADK before
conversion from the all-atom representation to the CANVAS
one. Speciﬁcally, the CORE of protein, modelled
atomistically, is depicted in green; the part that is described
in MG is shown in orange; the remainder, which is going to
be coarse-grained, is shown in blue.

(a)(b)(c)CORENMPLIDCORELIDNMPHingeFab 2Fab 1Fc(a)(b)the usage of an explicit solvent, while guaranteeing the
highest level of overall accuracy of the model, makes the
computational cost of the simulation essentially identical
to that of a fully atomistic model. One of the long-term
targets in the development of variable-resolution models
is the boost of computational eﬃciency through the re-
duction of the number of model particles; here, however,
we restrict our analysis to the validation of the CAN-
VAS model of the protein, since the combined usage of
multiple-resolution models of the protein and the solvent
would lead to ambiguities in the interpretation of the out-
comes. The usage of the CANVAS model in combination
with computationally eﬃcient models of the solvent (e.g.
implicit solvent [51, 52] or adaptive resolution simulation
schemes [19, 20, 53]) will be the object of future work.

The analysis of ﬂuctuations was performed with VMD
molecular visualization program [54].
In particular,
the root-mean-square deviation (RMSD) was computed
through the RMSD Trajectory Tool considering the sole
Cα atoms. The root mean square ﬂuctuations (RMSF)
were computed by means of an in-house tkl script. The
radii of gyration were computed with gmx gyrate, while
the solvent-accessible surface area was computed with
gmx sasa. The principal component analysis (PCA) and
the calculation of the root mean square inner product
(RMSIP) [55] between the essential subspaces from atom-
istic and CANVAS simulations were performed with the
Python module MDAnalysis. The calculation of the elec-
trostatic potential was performed with the online adap-
tive Poisson-Boltzmann solver (APBS) [56], after the cre-
ation of an input PQR ﬁle that, in the case of the multi-
scale model, includes the radii and charges as computed
with the CANVAS protocol. Protein visualization and
rendering was performed with VMD [54], while the plots
were created with Xmgrace and Python libraries.

IV. RESULT AND DISCUSSION

In this section we compare results from the atom-
istic and CANVAS simulations for both ADK and pem-
brolizumb, in order to assess the validity of the proposed
multiscale model.
In the case of pembrolizumab, the
comparison is performed between the six CANVAS sim-
ulations and the corresponding ensembles of structurally
homogeneous conﬁgurations obtained through a cluster-
ing of all-atom simulation frames, see Tarenzi et al. [44].

A. Adenylate kinase

The all-atom simulation of ADK samples two main
conformations of the protein: the open one, as reported
in Figure 4a, and the closed one, shown in Figure 4b. In
the former structure, the arms (speciﬁcally, the residue
indexes 118-160, namely the LID domain, and 1-67,
namely the NMP domain) are separated from each other;

8

in the compact conformation, the distance between the
two arms is substantially reduced.

The evolution of the protein during the simulation can
be quantiﬁed in terms of the RMSD of all Cα atoms
with respect to the initial frame, which corresponds to
the equilibrated structure of ADK in the NPT ensemble
(Figure 4a). Since the latter is in the open conformation,
higher RMSD values are indicative of closer structures.
The resulting plot is shown with a red line in Figure
6a: as expected, two states are clearly visible: one cor-
responding to 3 ˚A, and the second one around 6 ˚A. The
compact conformation (higher RMSD values) is attained
for a few nanoseconds after 80 ns, it reappears subse-
quently after 200 ns, and remains there until the end of
the simulation.

Consistently with the previous analysis, the red line of
Figure 6b shows the RMSF for each Cα, computed with
respect to the average structure: we can notice that the
atoms constituting the protein arms, i.e. the LID and
NMP domains (indexes 118-160 and 30-67) have wider
ﬂuctuations with respect to the CORE.

Since the open/closed transition is determined by the
relative orientation of LID and NMP with respect to the
CORE, the latter is modelled at high-resolution in the
CANVAS simulation, with the aim of retaining a real-
istic degree of ﬂexibility of the hinge.
In contrast, the
LID and the NMP domains are described using two lev-
els of resolution, i.e. MG and CG. We recall that all
residues whose distance is less than 1 nm with respect
the closest all-atom residues are described as MG, in or-
der to guarantee a smooth transition between highest and
lowest level of resolution. A schematic representation is
shown in Figure 4c.

The CANVAS simulation shows two main protein con-
formations, in analogy with the all-atom simulation: the
open one, as depicted in Figure 7(a), and the compact one
as displayed in Figure 7(b). The interconversion between
the two conformations is monitored, in analogy with the
fully-atomistic simulation, by calculating the RMSD of
the Cα atoms (CAat, CAmg, CAcg) with respect to the
reference frame. The resulting curve is shown in blue
in Figure 6a. The comparison between the all-atom and
multi-resolution RMSD shows that the CANVAS model
reproduces well the conformational changes observed in
the fully atomistic system, allowing the protein to tran-
sition between the two basins more frequently than the
all-atom reference.

To gain further insight into this feature, we looked into
the ﬂuctuation of each Cα in the all-atom part, and each
CA bead (CAmg, CAcg) in the MG and CG ones (whose
position is the same of the corresponding Cα atoms in
all-atom representation), as depicted with blue line in
Figure 6b. Also in this case, for both all-atom and lower-
resolution regions the ﬂuctuations of Cα atoms are com-
parable with those from the atomistic simulation.

As explained in the description of the model, the values
of Q, σ and (cid:15) for each low-resolution bead are diﬀerent
depending on the number and type of the atoms that are

9

FIG. 6: (a): RMSD of all ADK Cα comparing the all-atom simulation (red line) and the CANVAS one (blue line). The
presence of two diﬀerent states, one corresponding at about 3 ˚Aand the second one close to 6 ˚A, are indicative of open and
compact conformations, respectively. (b) RMSF for each Cα of ADK from the all-atom simulation (red line) and the CANVAS
one (blue line). The cyan area corresponds to the CORE domain, which is described atomistically, while the grey and the
white regions correspond to the parts of system (LID and NMP domains) modelled in CG and MG, respectively. Videos of
the atomistic and CANVAS trajectories are provided on the Zenodo repository https://doi.org/10.5281/zenodo.6798962.

mapped onto it. Figure 7 shows the two conformations
where each CG bead is colored according to its charge,
and whose size is based on the σ values. The partial
charges assigned to each MG and CG bead, in addition
to those assigned to each atom by the atomistic force-
ﬁeld, were used to compute the electrostatic potential
with the adaptive Poisson-Boltzmann solver (APBS) [56].
The protein surface, colored according to the mapped
potential, is represented in Figure 7.c for both the fully
atomistic and the CANVAS case; the comparison shows
that the electrostatic patches are conserved in the multi-
resolution representation.

To check the accuracy in the description of the AT re-
gion in the CANVAS model, we computed the average
solvent-accessible surface area (SASA) for each atomistic
residue, comparing the results with the values obtained
from the atomistic simulation (Figure 8). The results
are in good agreement; the slightly larger SASA values
for some residues in the CANVAS simulation might be
ascribed to the fact that in the fully atomistic case the
protein spends a larger portion of the trajectory in the
compact state, where the solvent accessibility of a num-
ber of residues is reduced.

B. Pembrolizumab

In Tarenzi et al.

[44], four all-atom simulations have
been performed starting from the PDB crystallographic
structure of the full-length antibody, for a total simula-
tion time of 2µs. The antibody conformations sampled
from the MD simulations are grouped into six cluster,
on the basis of their structural similarity. The represen-
tative structures of the diﬀerent clusters are shown in

Figure S2, and labelled 0A, 1A, 2A, 3A, 4A, 5A according
to the increasing value of the protein’s average radius of
gyration. The conformations diﬀer mainly in the rela-
tive orientation of the Fab and Fc domains, which can
get in close contact thanks to the ﬂexibility of the hinge
region; the latter includes two 18-residue long disordered
segments, bridged by two disulﬁde bonds.

The six representative pembrolizumab structures are
taken as starting conformations for six CANVAS simu-
lations. Since the variation in the relative arrangement
of Fab1, Fab2 and Fc domains is made possible by the
disordered hinge region, the latter is described atomisti-
cally, while the three large domains are modelled with
lower levels of detail. In particular, those residues whose
distance is less than 1 nm with respect to the closest
fully-atomistic ones are described as MG, while the rest
is represented as CG. A schematic representation is given
in Figure 5b.

Protein ﬂuctuations were compared by computing the
RMSF of each Cα in the all-atom part, and each CA bead
(CAmg, CAcg) in the MG and CG ones (whose position
is the same of the corresponding Cα atoms in all-atom
representation). The analysis of the RMSF plots (Figure
9) shows that, for each cluster, the ﬂuctuations follow the
same trend for both all-atom and CANVAS simulations,
although their value is generally lower in the multiscale
case. This property is investigated by computing the lin-
ear correlation between the RMSF of Cα atoms of fully-
atomistic simulation and the CANVAS one for each case.
The latter is given by the calculation of Pearson Coeﬃ-
cient ρ [57] as depicted in the scatter plots of Figure S3.
All clusters show satisfactory results, with good RMSF
correlations (ρ ∼ 0.7); moreover, an excellent correlation

0100200300400500time  / ns 0246810RMSD  / Angstromall-atomCANVAS050100150200Cα index024681012RMSF  / Angstromall-atomCANVASAdenylate KinaseLIDCORECORECORENMP10

values present small deviations, with the largest discrep-
ancy of 1.3 ˚A observed in cluster 3A; however, in all
cases, the radius of gyration from the all-atom simula-
tions is slightly larger than that from the multiscale case,
arguably because the steric eﬀects of the side chains can-
not be perfectly matched in the very coarse represen-
tation employed here, where only the Cα or backbone
atoms are retained for more than 97% of the residues.

As previously done for ADK, the electrostatic poten-
tial of the Fab1 domain at MG/CG resolution has been
computed for the antibody Fab, on the basis of the par-
tial charges assigned to each bead in the CANVAS model
(Figure 10). The comparison between the all-atom and
low-resolution case shows a good similarity.

The average SASA was computed along the trajectory
for each residue of the atomistic region, namely the two
hinge segments (Figure 11). The comparison between
the SASA values computed from the all-atom and mul-
tiscale simulations, performed for each conformational
cluster, shows a very good agreement. The CANVAS
model proves able to accurately reproduce the solvent
exposure of the atomistic residues in relation to the con-
formational properties of the fully atomistic system.

V. CONCLUSIONS

In this work we introduced the CANVAS model for
the multiscale molecular dynamics simulation of proteins.
The model couples diﬀerent levels of detail within the
same protein representation, ranging from a fully atom-
istic description to a coarse one, e.g. one bead per amino
acid (as it was the case in the case studies discussed here)
or even lower levels of resolution. CANVAS allows a
smooth transition between these resolutions, by includ-
ing regions at intermediate levels of detail. Importantly,
the non-bonded components of the interaction potential
are taken into account at all resolution levels, by assign-
ing to each CG bead the averages properties – including
charge, size, and dispersion energy – of the atoms that
are mapped onto it. This property enables, in principle,
the application of CANVAS for the simulation of large,
multimeric protein complexes, where also the CG resolu-
tion can be used to model realistic molecular interfaces.
This application will be explored in future works.

Here, we have tested the CANVAS model on two sys-
tems of very diﬀerent size and conformational dynam-
ics, namely the enzyme adenylate kinase and the thera-
peutic antibody pembrolizumab. To validate the model,
we performed a comparison between properties extracted
from the fully atomistic and the multiscale simulations,
in terms of residue ﬂuctuations, large-scale dynamics, sol-
vent exposure, and electrostatic properties; in all cases,
the CANVAS model results are in good agreement with
the all-atom reference.

The variable-resolution modelling approach presented
here achieves two key goals: ﬁrst, it demonstrates that
a sensible modulation of the resolution can be employed

FIG. 7: CANVAS representations of ADK, where the
all-atom region is described in licorice and the MG/CG
beads as VdW spheres. The diameter of each bead is given
by the value of σ, while its color is dependent on the value
of the charge: white spheres are indicative of neutral charge,
while blue and red beads correspond to positive and
negative charges, respectively. (a) shows the open
conformation of the protein, while (b) the more compact
one. (c) displays the electrostatic potential calculated with
the adaptive Poisson-Boltzmann solver (APBS) [56] for the
all-atom and CANVAS representations of the starting ADK
structure, mapped on the protein surface.

is found in cluster 0A (ρ ∼ 0.87).

The conformational dynamics of the system was fur-
ther inspected by computing the root mean square in-
ner product (RMSIP) between the essential subspaces
given by the ﬁrst n normal modes of the covariance from
the atomistic and CANVAS simulations, with n ranging
from one to the ﬁrst 10 modes. A value of 0 indicates
that the two mode subspaces are orthogonal, while 1 in-
dicates that they are identical. Figure S4 shows that less
than 5 modes are enough to attain a very good overlap
(RMSIP>0.8) for all clusters.

We compared the similarity of the structures sampled
in the atomistic and CANVAS simulations through the
calculation of the radius of gyration (Figure S5). The

 (a)(b)    All-atomCANVAS-5kT/e5kT/e(c)(a)(b)(c)(b)(c) (a)11

FIG. 8: Per-residue values of SASA, computed for the atomistic region of the ADK. The AT region is composed of three
segments of consecutive residues, denoted AT1, AT2 and AT3.

FIG. 9: Root Mean Square Fluctuation (RMSF) computed on Cα atoms of each apo form of pembrolizumab, from all-atom
(red lines) and CANVAS simulations (blue lines). The cyan slabs correspond to the hinge region described atomistically in
the CANVAS model, while the grey and the white regions correspond to the parts of system modelled as CG and MG
respectively. The x-axis corresponds to the Cα indexes.

to construct models of large molecules whose behaviour
is the same of, or quantitatively consistent with, that
of a reference all-atom model of the system; second, it
enables the rapid, practical construction of tailored low-
resolution models of such molecules with minimal infor-
mation and no reference simulations. The possible appli-
cations of these models cover a broad spectrum; we here
stress those that appear most promising to us, namely:
exploration of the conformational space of molecules
whose structure is known with low resolution only; char-

acterisation of the structure-dynamics-function relation
by means of the systematic modulation of the resolution
throughout the structure; and eﬃcient free energy cal-
culations, employing an atomistic accuracy only in the
active and allosteric sites. These applications, which in-
volve the usage of the CANVAS model in combination
with eﬃcient simulation methods for the solvent (e.g.
multi-timestepping [58, 59], implicit solvent [51, 52], or
adaptive resolution simulation methods [19, 20, 53]) are
currently under development, and pave the way to a novel

  020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS0AFAB 1FAB 2FCFC020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS1AFAB 1FAB 2FCFC020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS2AFAB 1FAB 2FCFC020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS4AFAB 1FAB 2FCFC020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS5AFAB 1FAB 2FCFC020040060080010001200Cα index024681012RMSF  / Angstromall-atomCANVAS3AFAB 1FAB 2FCFC12

stants, and with Giovanni Mattiotti for an insightful
reading of the manuscript. This project received funding
from the European Research Council (ERC) under the
European Union’s Horizon 2020 research and innovation
program (Grant 758588).

AUTHOR CONTRIBUTIONS

RP designed the project; RF developed the software
and ran the simulations; RF and TT performed the anal-
yses. All authors contributed to the interpretation of the
results and to the writing of the manuscript.

NOTES

FIG. 10: Electrostatic potential calculated with the
adaptive Poisson-Boltzmann solver (APBS) [56] for the
all-atom and CANVAS representations of pembrolizumab
Fab1, mapped on the protein surface.

approach to computer-aided molecular biochemistry.

The authors declare no competing ﬁnancial interest.

DATA AND SOFTWARE AVAILABILITY

SUPPORTING INFORMATION

The CANVAS software is available for download
at https://github.com/potestiolab/canvas, including the
manual and tutorials. The raw data produced and anal-
ysed in this work are freely available on the Zenodo repos-
itory https://doi.org/10.5281/zenodo.6798962.

ACKNOWLEDGEMENTS

The authors are indebted with Roberto Menichetti for
the calculation of the distance-dependent elastic con-

The Supporting Information is available free of charge.
• Derivation of the elastic constants knb.

• Supplementary ﬁgures: representative structures of
pembrolizumab antibody; scatter plots of RMSF
for each pembrolizumab state; RMSIP between the
essential subspaces computed from the atomistic
and CANVAS simulations; average radius of gy-
ration for each conformational cluster of the anti-
body.

[1] J. E. Stone, D. J. Hardy, I. S. Uﬁmtsev, and K. Schulten,
Journal of Molecular Graphics and Modelling 29, 116
(2010).

[2] R. Lazim, D. Suh, and S. Choi, International journal of

molecular sciences 21, 6339 (2020).

[3] D. E. Shaw, P. J. Adams, A. Azaria, J. A. Bank, B. Bat-
son, A. Bell, M. Bergdorf, J. Bhatt, J. A. Butts, T. Cor-
reia, et al., in Proceedings of the International Conference
for High Performance Computing, Networking, Storage
and Analysis (2021) pp. 1–11.

[4] C. Peter and K. Kremer, Soft Matter 5, 4357 (2009).
[5] S. C. Kamerlin, S. Vicatos, A. Dryga, and A. Warshel,
Annual Review of Physical Chemistry 62, 41 (2011),
pMID: 21034218.

[6] S. Takada, Current Opinion in Structural Biology 22,
130 (2012), theory and simulation/Macromolecular as-
semblages.

[9] M. Giulini, M. Rigoli, G. Mattiotti, R. Menichetti,
T. Tarenzi, R. Fiorentini, and R. Potestio, Frontiers in
Molecular Biosciences 8 (2021).
and W.

[10] H. M.

Senn

Thiel,
48,

Angewandte
(2009),

Chemie
https://onlinelibrary.wiley.com/doi/pdf/10.1002/anie.200802019.

International Edition

1198

[11] B. Wang and D. G. Truhlar, Journal of Chemical The-
ory and Computation 6, 359 (2010), pMID: 26617295,
https://doi.org/10.1021/ct900366m.

[12] F. H. Wallrapp and V. Guallar, WIREs Com-
(2011),

putational Molecular
https://onlinelibrary.wiley.com/doi/pdf/10.1002/wcms.27.

Science

315

1,

[13] Q. Cui, T. Pal, and L. Xie, The Journal of Physical

Chemistry B 125, 689 (2021).

[14] V. Vennelakanti, A. Nazemi, R. Mehmood, A. H. Steeves,
and H. J. Kulik, Current opinion in structural biology 72,
9 (2022).

[7] S. Riniker, J. R. Allison, and W. F. van Gunsteren, Phys.

[15] M. Neri, C. Anselmi, M. Cascella, A. Maritan,

and

Chem. Chem. Phys. 14, 12423 (2012).

[8] W. G. Noid, The Journal of Chemical Physics 139,

090901 (2013), https://doi.org/10.1063/1.4818908.

P. Carloni, Physical review letters 95, 218102 (2005).
[16] J. Schneider, K. Korshunova, F. Musiani, M. Alfonso-
Prieto, A. Giorgetti, and P. Carloni, Biochemical and

  All-atomCANVAS5kT/e  VLCLVHCH1-5kT/e13

FIG. 11: Per-residue values of SASA, computed for the atomistic region of the antibody in each conformational basin. Hinge
1 belongs to chain B, while hinge 2 belongs to chain D.

biophysical research communications 498, 366 (2018).

[17] M. Legu`ebe, C. Nguyen, L. Capece, Z. Hoang, A. Gior-

getti, and P. Carloni, (2012).

[18] T. Tarenzi, V. Calandrini, R. Potestio, and P. Carloni,
Journal of chemical theory and computation 15, 2101
(2019).

[19] R. Potestio, S. Fritsch, P. Espa˜nol, R. Delgado-
Buscalioni, K. Kremer, R. Everaers, and D. Donadio,
Phys. Rev. Lett. 110, 108301 (2013).

[20] T. Tarenzi, V. Calandrini, R. Potestio, A. Giorgetti, and
P. Carloni, Journal of chemical theory and computation
13, 5647 (2017).

Structure, Function, and Bioinformatics 78, 1950 (2010).
[31] J. Huang, S. Rauscher, G. Nawrocki, T. Ran, M. Feig,
B. L. De Groot, H. Grubm¨uller, and A. D. MacKerell,
Nature methods 14, 71 (2017).

[32] P. A. Burrough, R. A. McDonnell, and C. D. Lloyd,
Principles of Geographical Information Systems, 3rd ed.
(Oxford, 2015).

[33] P. A. Longley, M. Goodchild, D. J. Maguire, and D. W.
Rhind, Geographic Information Systems and Science, 3rd
ed. (Wiley Publishing, 2010).

[34] Z. Sen, Spatial Modeling Principles in Earth Sciences,

2nd ed. (Springer, 2016).

[21] A. C. Fogarty, R. Potestio, and K. Kremer, Proteins:

[35] P. Dzeja and A. Terzic, International Journal of Molecu-

Struct., Func., and Bioinf. 84, 1902 (2016).

lar Sciences 10, 1729 (2009).

[22] R. Fiorentini, K. Kremer,

and R. Potestio, Proteins:
Structure, Function, and Bioinformatics 88, 1351 (2020).

[23] M. M. Tirion, Phys. Rev. Lett. 77, 1905 (1996).
[24] M. Alfonso-Prieto, A. Giorgetti, and P. Carloni, Current

opinion in structural biology 55, 8 (2019).

[25] M. Alfonso-Prieto, L. Navarini, and P. Carloni, Frontiers

in molecular biosciences 6, 29 (2019).

[26] F. Fierro, A. Giorgetti, P. Carloni, W. Meyerhof, and

M. Alfonso-Prieto, Scientiﬁc reports 9, 1 (2019).

[27] E. Spiga, D. Alemani, M. T. Degiacomi, M. Cascella,
and M. Dal Peraro, Journal of chemical theory and com-
putation 9, 3515 (2013).

[28] L. Darr´e, M. R. Machado, A. F. Brandner, H. C.
Gonz´alez, S. Ferreira, and S. Pantano, Journal of chem-
ical theory and computation 11, 723 (2015).

[29] P. C. Souza, R. Alessandri, J. Barnoud, S. Thallmair,
I. Faustino, F. Gr¨unewald, I. Patmanidis, H. Abdizadeh,
B. M. Bruininks, T. A. Wassenaar, et al., Nature methods
18, 382 (2021).

[30] K. Lindorﬀ-Larsen, S. Piana, K. Palmo, P. Maragakis,
J. L. Klepeis, R. O. Dror, and D. E. Shaw, Proteins:

[36] E. Formoso, V. Limongelli, and M. Parrinello, Scientiﬁc

reports 5 (2015).

[37] C. M¨uller, G. Schlauderer, J. Reinstein, and G. Schulz,

Structure 4, 147 (1996).

[38] G. Scapin, X. Yang, W. W. Prosise, M. McCoy, P. Re-
ichert, J. M. Johnston, R. S. Kashi, and C. Strickland,
Nature structural & molecular biology 22, 953 (2015).

[39] M. I. Ionescu, The Protein Journal 38, 120 (2019).
[40] I. N. Ivashko and J. M. Kolesar, American journal of

health-system pharmacy 73, 193 (2016).

[41] Y. Chen, Y. Pei, J. Luo, Z. Huang, J. Yu, and X. Meng,

Frontiers in Immunology 11, 1088 (2020).

[42] M. Parrinello and A. Rahman, Journal of Applied Physics
52, 7182 (1981), https://doi.org/10.1063/1.328693.
[43] P. Langevin, Comptes Rendus Hebdomadaires des
S´eances de l’Acad´emie des Sciences 146, 530 (1908).
[44] T. Tarenzi, M. Rigoli, and R. Potestio, Scientiﬁc reports

11, 1 (2021).
L.

[45] W.

Jorgensen,

Madura, R. W.
Journal

Impey,
of Chemical Physics

J. Chandrasekhar,

J. D.
and M. L. Klein, The
(1983),

926

79,

  Cluster 0ACluster 1ACluster 2ACluster 3ACluster 4ACluster 5A14

http://dx.doi.org/10.1063/1.445869.

[46] J. Barker and R. Watts, Molecular Physics 26, 789

(1973).

[47] R. Watts, Molecular Physics 28, 1069 (1974).
[48] S. Miyamoto and P. A. Kollman, J. Comput. Chem. 13,

952 (1992).

[49] H. C. Andersen, J. Comput. Phys. 52, 24 (1983).
[50] M. Abraham, D. van der Spoel, E. Lindahl, B. Hess,
(2018), http:

and the GROMACS development team,
//www.gromacs.org.

[51] A. V. Onufriev and D. A. Case, Annual review of bio-

physics 48, 275 (2019).

[52] Y. Chen, A. Kr¨amer, N. E. Charron, B. E. Husic,
and F. No´e, The Journal of Chemical

C. Clementi,
Physics 155, 084101 (2021).

[53] M. Praprotnik, S. Matysiak, L. Delle Site, K. Kremer,

and C. Clementi, Journal of Physics: Condensed Matter
19, 292201 (2007).

[54] W. Humphrey, A. Dalke, and K. Schulten, Journal of

Molecular Graphics 14, 33 (1996).

[55] A. Amadei, M. A. Ceruso, and A. Di Nola, Proteins:
Structure, Function, and Bioinformatics 36, 419 (1999).
[56] E. Jurrus, D. Engel, K. Star, K. Monson, J. Brandi, L. E.
Felberg, D. H. Brookes, L. Wilson, J. Chen, K. Liles,
et al., Protein Science 27, 112 (2018).

[57] J. Benesty, J. Chen, Y. Huang, and I. Cohen, in Noise
reduction in speech processing (Springer, 2009) pp. 1–4.
[58] D. D. Humphreys, R. A. Friesner, and B. J. Berne, The

Journal of Physical Chemistry 98, 6885 (1994).

[59] E. Krieger and G. Vriend, Journal of computational

chemistry 36, 996 (2015).

