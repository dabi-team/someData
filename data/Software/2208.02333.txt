Subspace identiﬁcation of low-dimensional
Structural-Thermal-Optical-Performance (STOP) models of
reﬂective optics

Aleksandar Habera, John E. Draganovb, and Michael Krainakb

aDepartment of Manufacturing and Mechanical Engineering Technology, College of
Engineering Technology, Rochester Institute of Technology, 70 Lomb Memorial Dr., Rochester,
NY 14623, USA
bRelative Dynamics, Inc., 6401 Golden Triangle Dr. STE 201, Greenbelt, MD 20770, USA

ABSTRACT

In this paper, we investigate the feasibility of using subspace system identiﬁcation techniques for estimating
transient Structural-Thermal-Optical Performance (STOP) models of reﬂective optics. As a test case, we use a
Newtonian telescope structure. This work is motivated by the need for the development of model-based data-
driven techniques for prediction, estimation, and control of thermal eﬀects and thermally-induced wavefront
aberrations in optical systems, such as ground and space telescopes, optical instruments operating in harsh
environments, optical lithography machines, and optical components of high-power laser systems. We estimate
and validate a state-space model of a transient STOP dynamics. First, we model the system in COMSOL
Multiphysics. Then, we use LiveLink for MATLAB software module to export the wavefront aberrations data
from COMSOL to MATLAB. This data is used to test the subspace identiﬁcation method that is implemented
in Python. One of the main challenges in modeling and estimation of STOP models is that they are inherently
large-dimensional. The large-scale nature of STOP models originates from the coupling of optical, thermal, and
structural phenomena and physical processes. Our results show that large-dimensional STOP dynamics of the
considered optical system can be accurately estimated by low-dimensional state-space models. Due to their low-
dimensional nature and state-space forms, these models can eﬀectively be used for the prediction, estimation,
and control of thermally-induced wavefront aberrations. The developed MATLAB, COMSOL, and Python codes
are available online.

Keywords: Adaptive optics, structural-thermal-optical-performance (STOP) models, system identiﬁcation,
model-based control, telescopes

1. INTRODUCTION

Thermally-induced mechanical deformations, wavefront aberrations, and large focal shifts can negatively aﬀect
performance and signiﬁcantly limit the resolution of both refractive and reﬂective optical systems. For example,
thermal phenomena and thermally-induced aberrations can limit the achievable resolution and performance of
optical lithography systems,1–10 space and ground telescopes,11–23 gravitational wave detectors,24–26 high power
lasers,27–29 and other optical systems.30–33
In the case of refractive optical systems consisting of lenses, ab-
sorbed thermal energy and non-uniform temperature distributions across optical elements, induce mechanical
deformations and variations of refractive indices. These eﬀects can in turn induce large focal shifts and wave-
front aberrations. On the other hand, in the case of reﬂective optical elements, thermally created mechanical
deformations are the main cause of thermally-induced wavefront aberrations. Here it should be noted that
even if all internal optical elements are properly thermally insulated, thermally induced deformations of enclo-
sures, supports, and other devices that are in direct mechanical contact with optics can cause signiﬁcant optical
misalignments.

Further author information: (Send correspondence to A. H.)
A. H.: E-mail: aleksandar.haber@gmail.com, Telephone: +1 585-475-5813

2
2
0
2

g
u
A
3

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
3
3
3
2
0
.
8
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
To design eﬀective control strategies for the compensation of thermally-induced wavefront aberrations or
to design novel wavefront correction devices that are based on thermo-mechanical actuation, it is often neces-
sary to develop high-ﬁdelity models of thermally-induced mechanical deformations and wavefront aberrations.
Apart from this, high-ﬁdelity models are important for performance prediction and worst-case analysis of opti-
cal systems under the negative inﬂuence of thermal eﬀects. To model thermally-induced wavefront aberrations
it is necessary to couple structural and thermal partial diﬀerential equations with optical parameters and ray
propagation equations. These models are often referred to as Structural-Thermal-Optical-Performance (STOP)
models. The development of accurate STOP models is a challenging task. First of all, STOP models involve
diﬀerent time scales of physical processes, as well as diﬀerent types of partial diﬀerential equations and bound-
ary conditions. Consequently, STOP models can often be numerically stiﬀ and diﬃcult for discretization and
simulation. Secondly, for the development of eﬃcient prediction and control algorithms, it is crucial to obtain
low-dimensional models. However, discretized STOP models obtained by applying ﬁnite-element methods lead
to state-space models with state dimension orders of 105 or even 106. Such large-scale models are impractical
for real-time prediction or control. Finally, it is often the case that the parameters describing the STOP models
are not accurately known or there are other model uncertainties. Consequently, it is often necessary to directly
estimate the models from the experimentally collected data. All these facts call for the development of data-
driven estimation and model validation approaches capable of estimating low-dimensional STOP models. This
paper aims at developing and testing such approaches.

In our previous work,34 we investigated the potential of using a subspace system identiﬁcation method8, 35–37
for estimating STOP models of refractive optical systems. In,34 we considered a test case consisting of a single lens
with an optomechanical support structure. By using the simulation data, we demonstrated that the subspace
system identiﬁcation method has a promising potential for accurately estimating low-order transient STOP
models. However, the feasibility of the subspace identiﬁcation method for estimating low-dimensional STOP
models of reﬂective optics has not been investigated. Then, in,38 we derived and experimentally veriﬁed a model
of transient thermal dynamics of an 8-inch aluminum mirror prototype.
In the same paper, we used model-
order reduction techniques to develop low-order state-space models of thermal dynamics. The results reported
in38 indicate that the transient thermal dynamics of reﬂective optics can be approximated by low-order models.
However, in,38 we only consider thermal dynamics without coupling the heat equation with other equations
mathematically describing thermal deformation and optical ray propagation. Consequently, it is not clear if an
integrated STOP transient dynamics of reﬂective optics can be approximated by low-dimensional models.

Motivated by the promising results presented in,34, 38 and above described open research questions, in this
paper, we investigate the feasibility and performance of the subspace system identiﬁcation method for estimating
STOP models of reﬂective optical systems. As a test case, we use a Newtonian telescope structure. We estimate
and validate a state-space model of a transient STOP dynamics. First, we model the system in COMSOL
Multiphysics. Then, we use LiveLink for MATLAB software module to export the wavefront aberrations data
from COMSOL to MATLAB. This data is used to test the subspace identiﬁcation method that is implemented
in Python. Our results show that the large-dimensional STOP dynamics of the considered optical system can
be accurately approximated by a low-dimensional state-space model. Due to its low-dimensional nature and
state-space form, the estimated model can eﬀectively be used for the prediction, estimation, and control of
thermally-induced wavefront aberrations. Furthermore, the used estimation and validation procedures can be
used for the development of feedforward adaptive optics compensation methods.39–46 The developed MATLAB,
COMSOL, and Python codes are available online.47, 48

A few comments about the synergistic approach presented in this paper are in order. Since the purpose of
this paper is to test the feasibility of the subspace identiﬁcation method, we use simulated STOP data to test the
identiﬁcation approach. The next development stage is to experimentally verify the presented approach. This
is a future research direction. In our accompanying article,49 we test the potential of using machine learning
techniques for estimating low-order STOP models of the Newtonian telescope structure. The system identiﬁcation
approach presented in this paper and the machine learning approach presented in the accompanying paper49
complement each other.

This paper is organized as follows. In Section 2, we present the STOP model and perform step response
In Section 3, we present the system identiﬁcation approach and results. Finally, in Section 4, we

analysis.

present conclusions and brieﬂy discuss future research directions.

2. SYSTEM STOP MODEL

In this section, we develop the system STOP model. Figure 1 shows the system structure. This is a conceptual
design obtained by combining a Newtonian telescope structure with a primary mirror support. We use ray-
tracing parameters and dimensions from50 to perform a ray tracing analysis in COMSOL Multiphysics. Table 1
summarizes the most important geometrical and ray tracing parameters. The primary mirror, denoted by 1 in
Fig. 1, has holes on the back side that are used to place cooler/heater devices and thermocouples for observing
the temperature. Holes, denoted by 7, are distributed over a 9 by 9 grid. The motivation for introducing
the heaters/coolers originates from our previous work on designing feedback temperature control systems for
optical components.34, 38 In our STOP simulations, heaters (heat inputs) are used to provide the heat power
that increases the primary mirror and support structure temperatures, and consequently, introduces wavefront
aberrations. Also, in our STOP simulations, we introduce external heat-ﬂux disturbances acting on one side of
the primary mirror. We are interested in developing a STOP model that relates the time series of the applied
heat inputs and external heat-ﬂux disturbances with the time-series of observed wavefront aberrations expressed
in the Zernike basis.

The support structure of the primary mirror is denoted by 2 in Fig. 1. A more detailed view of the mirror
support structure is shown in Fig. 3(b). We assume that the primary mirror and the support structure are made
of an aluminum alloy, with the thermal and structural parameters given in Table 2. Our modeling approach
can easily be generalized to other mirror materials, mirror geometries, and mount structures. Although we
followed some guidelines51 for designing and modeling the support structure, the support mirror structure is not
optimized from the structural and thermo-mechanical perspectives. The purpose of this paper is not to propose
an optimized support structure, instead, the purpose of the paper is to test the ability of subspace identiﬁcation
techniques to estimate STOP models. The geometry of the primary mirror support structure does not have
a signiﬁcant inﬂuence on our estimation results. The secondary mirror is denoted by 3 in Fig. 1. The ray
propagation obstruction is denoted by 4. The image (focal plane) is denoted by 5. Arrow 6 denotes the direction
of rays entering the telescope.

Figure 1. Newtonian telescope structure.
(3) Secondary
mirror. (4) Ray propagation obstruction. (5) Focal (image) plane. (6) Direction of rays entering the telescope. (7) 9 by
9 grid of holes on the mirror back side that are used to place heaters/coolers or thermocouples.

(2) Primary mirror support structure.

(1) Primary mirror.

124356125347P1P7P2Entrance pupil diameter
Primary mirror focal length
Primary mirror conic constant
Primary mirror focal ratio
Image plane position (relative to optical axis)
Secondary mirror diameter
Secondary mirror oﬀset (relative to optical axis)
Image plane diameter
Number of extra azimuthal points
Primary mirror surface diameter
Primary mirror full diameter
Primary mirror thickness
Secondary mirror thickness
Wavelength
Mirror emissivity
Ambient temperature
Heat transfer coeﬃcient - convection
Heat capacity at constant pressure
Thermal conductivity
Coeﬃcient of thermal expansion
Density
Young’s modulus
Poisson’s ratio

0.25 [m]
1 [m]
−1
4
0.2[m]
0.05 [m]
0.0044194 [m]
0.05 [m]
50
0.26 [m]
0.275 [m]
0.035 [m]
0.01 [m]
550 [nm]
0.1
293.15 [K]
5 [W/(m2 · K)]
900 [J/(kg · K)]
238 [W/(m · K)]
23 · 10−6 [1/K]
2700 [kg/m3]
70 · 109 [P a]
0.33

Table 1. Optical, thermal, and structural parameters that are used to model the STOP system.

Figure 2(a) shows a ray release grid and Fig. 2(b) shows some of the simulated ray trajectories. For clarity,
we do not overload Fig. 2(b) with too many rays. That is, we only show ray trajectories of a small portion of
the released rays.

Figure 2. (a) Ray release grid for ray tracing. (b) Simulated ray trajectories. Note that due to clarity, we only show a
small portion of ray trajectories.

2.1 Control heater STOP results

We simulate a step response of the system, where the inputs are control heaters. We assume that the central
and four neighboring heaters placed in the holes on the back of the primary mirror are active. We assume that
every heater generates 4 [W ] of power. The heater power is constant during simulations. To perform the STOP
analysis, we couple Geometrical Optics, Solid Mechanics, and Heat Transfer in Solids COMSOL Multiphysics

hexapolar release grida)b)modules. We ﬁrst deﬁne and run a COMSOL study consisting of Solid Mechanics and Heat Transfer in Solids
modules. This simulation run produces time-dependent temperature and displacement ﬁelds. Then, the results
of this simulation are used in ray tracing simulations. To perform ray tracing simulations, we use the Geometrical
Optics module. The COMSOL and MATLAB codes used to perform STOP analysis are posted online.47 Fig. 3(a)
shows the meshed geometry. The mesh contains around 109 · 103 elements. Fig. 3(b) shows the support structure
of the primary mirror. The green marks denote the ﬁxed constraints (the displacement is set to zero) for
performing the STOP analysis.

Figure 3. (a) Meshed mirror and support structure CAD model. (b) Mirror support structure. The green marks denote
the ﬁxed constraints (the displacement is set to zero) for performing the STOP analysis.

We simulate the transient STOP dynamics for 2 · 104 seconds with a step size of 100 seconds. The simulated
temperature distributions are shown in Fig. 4 for 103 and 104 seconds. The simulated displacement distributions
are shown in Fig. 5 for 103 and 104 seconds. Figure 6 shows (a) transient temperature and (b) displacement
responses at the spatial locations deﬁned by points P1, P2, ..., P7 that are shown in Fig. 1. This graph can
be used to estimate transient response parameters, such as rise time, settling time, and time constants. From
Figs. 4 and 5, we can observe that the simulated temperature and displacement ﬁelds spatially correlate with
the locations of the heat inputs. On the other hand, from Fig. 6, we can observe that there are spatial gradients
of temperature and displacement ﬁelds at the top surface of the primary mirror. At ﬁrst look, the magnitudes
of these gradients do not seem signiﬁcant. However, wavefront aberrations results that are presented in the
sequel, reveal that even these moderate gradients can cause signiﬁcant wavefront aberrations and spot-diagram
divergences in the focal plane.

a)b)Figure 4. STOP results for control inputs. Simulated temperature distribution at 103 and 104 seconds.

Figure 5. STOP results for control inputs. Simulated displacement distribution at 103 and 104 seconds.

Figure 6. STOP results for control inputs. (a) Temperature and (b) displacement transient responses at points P1, P2,
..., P7. The locations of these points are shown in Fig. 1.

Next, we present spot diagrams and wavefront aberrations at the focal (image) plane. Fig. 7(a) shows the
spot diagrams at time instants 500, 103, 5 · 103, and 104 seconds. Fig. 7(b) shows the wavefront aberrations at
the same time instants.

Figure 7. STOP results for control inputs. (a) Spot diagrams and (b) wavefront error at the focal (image) plane at the
time instants 500, 103, 5 · 103, and 104 seconds.

2.2 Heat disturbance STOP results

Here, we present step response results where the inputs are the external heat-ﬂux disturbances acting on one
side of the mirror. The spatial location of the external disturbances is shown in Fig. 10 (light blue). We simulate
the STOP dynamics for 2 · 104 seconds with a step size of 100 seconds. In our STOP simulations, the total
heat ﬂux power of the external disturbances is 50 [W ]. Figure 8(a) and (b) show simulated temperature spatial
distributions of the primary mirror at time instants 5 · 102 and 2 · 104 seconds. The panels (c) and (d) in the
same ﬁgure show simulated displacement spatial distributions at identical time instants.

a)b)Wavefront error[μm]500 [s]1000 [s]5000 [s]10000 [s]min=0.06max=0.27min=-0.08max=2.03Spot diagrammin=-0.75max=11.2min=-1.01max=14.7500 [s]1000 [s]5000 [s]10000 [s]rrms=4.15 [μm]rrms=20.3 [μm]rrms=116 [μm]rrms=151 [μm]a)b)[mm]Figure 8. STOP results for external disturbance inputs. Simulated temperature spatial distribution at the time instant
(a) 5 · 102 and (b) 104 seconds. Simulated displacement spatial distribution at the time instant (c) 5 · 102 and (d) 104
seconds.

Figure 9(a) shows the calculated spot diagrams at the image plane at the time instants 5 · 102, 5 · 103, and

2 · 104 seconds. Figure 9(b) shows the calculated wavefront aberrations at identical time instants.

.

Figure 9. STOP results for external disturbance inputs. (a) Spot diagrams calculated at the image (focal) plane at the
time instants 5·102, 5·103, and 2·104 seconds. The color legend quantiﬁes the ray radial position (in the ray release plane)
relative to the average over rays for each release feature (COMSOL’s variable “gop.rrel”). (b) Wavefront aberrations at
the image (focal) plane at the identical time instants.

a)b)c)d)a)500 [s]rrms=45.4 [μm]5000 [s]20000 [s]rrms=289 [μm]rrms=385 [μm][μm]500 [s]5000 [s]20000 [s]min=-1.3max=6min=-2.9max=30min=-3.6max=40.1[mm]b)3. SYSTEM IDENTIFICATION

In this section, we brieﬂy summarize the used system identiﬁcation method and present estimation and model
validation results. Additional technical details related to the used subspace identiﬁcation method can be found
in.36, 52, 53 Our goal is to estimate the following state-space model:

xk+1 = Axk + Bzk

yk = Cxk

(1)

(2)

where xk ∈ Rn is the system state vector, the subscript k = 0, 1, 2, . . . of all vectors denotes a discrete-time
instant, zk ∈ R10 is the input vector (consisting of control inputs and disturbances) at the discrete-time instant
k, yk ∈ Rr is the vector consisting of selected Zernike coeﬃcients, and A ∈ Rn×n, B ∈ Rn×10, and C ∈ Rr×n
are the system matrices. The input vector zk consists of control inputs u1,k, u2,k, . . . , u9,k ∈ R and the external
heat disturbance d10,k ∈ R:

zk = (cid:2)u1,k u2,k

. . . u9,k

d10,k

(cid:3)T

(3)

The control inputs u1,k, u2,k, . . . , u9,k represent the heat power generated by the heaters, and external heat
disturbance represents the power of the external heat ﬂux acting on the mirror. Figure 10 shows the physical
locations of the control inputs (red circles) and the external heat disturbance (blue area on the mirror side).

Figure 10. Red circles denote the locations of control inputs u1, u2, . . . , u9 (heater locations) and blue area denotes the
area on which external heat disturbance d10 is acting upon.

The identiﬁcation problem is to estimate the state order n and state-space matrices A, B and C of the state-
space model (1)-(2) by using time series of the collected input-output data {yk, zk}k=0,1,...,N . That is, by using
time-series of the collected Zernike coeﬃcients, and by using time series of the control inputs and the external
heat disturbance, we want to estimate the model order and state-space matrices.

We use a version of the subspace identiﬁcation method that is derived and summarized in our previous pa-
pers.34, 36, 52, 53 We implemented the subspace identiﬁcation method in Python. We used LiveLink for MATLAB
module to generate data sets for testing the subspace identiﬁcation method. The Python codes together with
LiveLink for MATLAB and COMSOL Multiphysics codes are provided online.48 In the sequel, we brieﬂy describe
the identiﬁcation steps and present the results.

Step 1: Generate identiﬁcation and validation data sets

In this paper, we generate input-output data sets for testing the subspace identiﬁcation method by simulating
the system STOP model. This is a usual practice when developing and testing estimation approaches. Namely,
in the development phase, the performance of the approach is ﬁrst tested on simulation data. Once this initial
testing phase is completed and the estimation approach is iteratively perfected, the next phase is to test the
approach on experimentally collected data. In this paper, we are focused on testing the identiﬁcation method by
using the simulation data, and experimental veriﬁcation of the developed approach is a future research direction.

u1u2u4u3u5u6u7u8u9d10First, we generate input sequences for system identiﬁcation. Generally speaking, input sequences have to
be suﬃciently rich such that they excite the system modes in the desired frequency range. We generate input
sequences (control inputs and the external heat disturbance) as binary pseudo-random numbers drawn from a
uniform discrete distribution. We use the MATLAB function randi() to generate these sequences. Figure 11(a)
shows an example of the generated input sequence.

Figure 11. (a) Example of the generated input sequence that is used for system identiﬁcation. (b) Three dominant Zernike
modes (coeﬃcients) produced by the generated input sequences.

The input sequences are applied to the STOP model. By simulating this model, we obtain the output data.
In total, by simulating the STOP model, we obtained the time series of the ﬁrst 21 Zernike modes (coeﬃcients)
that represent the output data. However, there are only 3 dominant Zernike modes whose magnitudes are
signiﬁcantly larger than the magnitudes of other modes. These modes are piston, horizontal tilt, and defocus,
and they are shown in Fig. 11(b). Consequently, we only include these modes in the output vector. That is, in
our case, r = 3 (r is the dimension of the output vector).

We generate two independent sets of inputs. The ﬁrst input set is used to generate the model outputs that are
used for system identiﬁcation. This data set is called the identiﬁcation data set. The second input set which is
statistically independent of the ﬁrst input set is used to generate the outputs that are used for model validation.
This data set is called the validation data set. To generate both of these data sets, we simulate the STOP model
for the total time duration of 9 · 103 seconds with the discretization step of 300 seconds. This gives in total 301
data samples. The main issue with generating larger data sets is that it takes a signiﬁcant amount of time to
simulate the STOP model. We performed simulations on a desktop computer with 64 GB RAM and an Intel
i9-10900 CPU. The generation of one data set on this computer takes at least 6 hours of computation time for
a moderate-sized discretization mesh. For denser meshes, it might take several days to obtain a single data set.

Step 2: Estimation of the state-space model

First, we estimate a Vector AutoRegressive eXogenous (VARX) model. The VARX model is postulated such
that the output of the system at the time instant k is a linear combination of the past inputs and outputs, from
k − 1 until k − p, for more details, see.34, 36, 52, 53 Here p is referred to as the past window. The ﬁrst step of
the subspace identiﬁcation method is to estimate the parameters of the VARX model and past window p. We
use a simple least-squares technique to estimate the VARX model parameters. We use the Akaike Information
Criterion (AIC) to estimate the value of the past window p.54 Figure 12(a) shows the AIC as a function of the
past window p. We select the past window p = 39 that produces the smallest AIC value.

a)b)Figure 12. (a) AIC value as a function of the past window p. (b) Singular values of the data matrix used to estimate the
model order.

We use the estimated VARX model, and input-output identiﬁcation data to form a data matrix. We estimate
the state-sequence of the system by performing a singular value decomposition of this matrix.35 After the state
sequence is estimated, we estimate the state-space matrices by solving a least-squares problem. During the state
and state-space matrices estimation steps, we also estimate the state order n. The state order is estimated by
detecting gaps in the plot of singular values. Namely, the state order can be estimated as a singular value index
immediately after signiﬁcant gaps. Figure 12(b) shows the singular values. We can observe that the candidates
for the state order are n = 2, 3, 6 and higher state orders, such as for example n = 35.

Step 3: Model validation and quality check

Often, several models are estimated and the ﬁnal model is chosen by validating and testing the performance of
estimated models by using the validation data set. Following this practice, once we estimated the models for
diﬀerent state orders, we simulate models by using the input sequence from the validation data set. Then, the
simulated model outputs are compared with the output from the validation data set. The error between the
validation output (also called the real output) and the simulated output (also called the predicted output) is
computed. This error is called the validation error or the model prediction error. The ﬁnal model is selected
as the model that produces the smallest validation error. Panels (a), (b), and (c) in Figure 13 show the real
and predicted piston, defocus, and horizontal tilt Zernike coeﬃcients (outputs), respectively, for the estimated
state order n = 2. Panels (a), (b), and (c) of Fig. 14 show the prediction and real value of the same coeﬃcients
determined for the estimated order of n = 35.

On the other hand, panels (d) in these two ﬁgures show the correlation values of the validation error of
predicting the defocus term. The red dashed lines represent the bounds of the interval for testing the white-noise
hypothesis of the validation error. This interval is used to additionally validate the model quality. Ideally, if all
information available in the data is captured by the ﬁnal model, then the validation error should have a white
noise property (this is also valid when the data is corrupted by the white measurement noise). If more than 95
percent of correlation values are in the interval, then we can assume that the validation error has a white noise
property. From the data in panels (d), we can observe that this is not the case since there is a strong correlation
for smaller lag values. This implies that the estimation results can be improved by changing the model structure
or choosing a diﬀerent model order. However, from panels (a) and (b), we can observe that our estimated ﬁnal
models for both n = 2 and n = 35 are able to accurately predict the piston and defocus modes. However, the
prediction is worse for the horizontal tilt mode. This is due to the fact that the horizontal tilt mode is more
oscillatory and more diﬃcult to be estimated. Furthermore, piston and defocus mode values are signiﬁcantly
larger than the values of the horizontal tilt mode. These results can be improved by some form of data scaling
and detrending of the piston and defocus modes. The improvement of our simulation results is a future research
direction.

a)b)Figure 13. Predicted and real Zernike modes: (a) piston, (b) defocus, and (c) horizontal tilt. (d) Correlation values of
the defocus validation error. The red dashed lines are the bounds of the interval for testing the white-noise hypothesis.
The results are generated for p = 39, future window f = 5, and state order of n = 2. The relative validation error and
Variance Accounted For (VAF) values are 5.99 and 99.6, respectively.

Figure 14. The panel descriptions are identical to the panel descriptions in Fig. 13. The results are obtained for p = 39,
f = 22 and n = 35. The relative validation error and VAF values are 7.6 and 99.42, respectively.

a)b)c)d)State order = 2Piston coefficientState order = 2Defocus coefficientState order = 2Horizontal tilt coefficienta)b)c)d)As the ﬁnal model quality check, we investigate the stability of the estimated models. Figure 15 shows the
eigenvalues of the estimated models for (a) n=2 and (b) n = 35. We can observe that both models are stable since
all the eigenvalues are inside of the unit circle. Another important observation is that for n = 35, the eigenvalues
are clustered close to the unit circle. A thorough analysis of this phenomenon is left for future research.

Figure 15. Eigenvalues of the estimated model for (a) n = 2 (other parameters given in caption of Fig. 13) and (b) n = 35
(other parameters given in caption of Fig. 14).

4. CONCLUSION AND FUTURE WORK

In this paper, we investigated the feasibility of using the subspace identiﬁcation method for estimating state-space
models of transient Structural Thermal Optical Performance (STOP) dynamics of reﬂective optical systems. We
tested the method on a Newtonian telescope structure. We obtained identiﬁcation and test data sets by simulating
the STOP model in COMSOL Multiphysics. Our results demonstrate that the subspace identiﬁcation method is
capable of estimating low-order STOP models of the dominant wavefront aberrations. Future research directions
should be directed towards improving the estimation performance by proper data preprocessing and method
tuning. Also, future research direction should be directed towards experimental veriﬁcation of the subspace
identiﬁcation method.

REFERENCES

[1] Choi, J. P., Park, T., Nam, Y. S., Kang, Y. S., Park, C.-H., Park, K.-Y., Ryu, C.-H., Huang, W., and Baik,
K.-H., “Lens heating impact analysis and controls for critical device layers by computational method,” in
[Proc. SPIE], 8683, 553–560 (2013).

[2] Ravensbergen, S. K., Rosielle, P. C. J. N., and Steinbuch, M., “Deformable mirrors with thermo-mechanical
actuators for extreme ultraviolet lithography: design, realization and validation,” Precis. Eng. 37(2), 353–
363 (2013).

[3] Haber, A., Polo, A., Maj, I., Pereira, S. F., Urbach, H. P., and Verhaegen, M., “Predictive control of

thermally induced wavefront aberrations,” Opt. Express 21(18), 21530–21541 (2013).

[4] Zhao, L., Dong, L., Yu, X., Li, P., and Qiao, Y., “Active lens for thermal aberration compensation in

lithography lens,” Appl. Optics 57(29), 8654–8663 (2018).

[5] Habets, M., Scholten, J., Weiland, S., and Coene, W., “Multi-mirror adaptive optics for control of thermally

induced aberrations in extreme ultraviolet lithography,” in [Proc. SPIE], 9776, 97762D (2016).

[6] Bikcora, C., Weiland, S., and Coene, W. M. J., “Thermal deformation prediction in reticles for extreme
ultraviolet lithography based on a measurement-dependent low-order model,” IEEE Trans. Semicond.
Manuf. 27(1), 104–117 (2014).

[7] Heertjes, M. F., Butler, H., Dirkx, N. J., van der Meulen, S. H., Ahlawat, R., O’Brien, K., Simonelli, J.,
Teng, K. T., and Zhao, Y., “Control of wafer scanners: methods and developments,” in [Proceedings of
American Control Conference ], 3686–3703, IEEE (2020).

a)b)State order = 2State order = 35Real partReal partImaginary partImaginary partEigenvalue [8] Haber, A., Polo, A., Ravensbergen, S., Urbach, H. P., and Verhaegen, M., “Identiﬁcation of a dynamical

model of a thermally actuated deformable mirror,” Opt. Lett. 38(16), 3061–3064 (2013).

[9] Bikcora, C. and Weiland, S., “Parameter-oriented reduction strategies for a thermo-mechanical model of
extreme ultraviolet reticles,” in [Proceedings of IEEE Conference on Control Applications], 1149–1154, IEEE
(2016).

[10] Bikcora, C., van Veelen, M., Weiland, S., and Coene, W. M. J., “Lens heating induced aberration prediction

via nonlinear kalman ﬁlters,” IEEE Trans. Semicond. Manuf. 25(3), 384–393 (2012).

[11] Yoder, P. and Vukobratovich, D., [Opto-Mechanical Systems Design, Volume 2: Design and Analysis of

Large Mirrors and Structures], vol. 2, CRC Press (2017).

[12] Holzl¨ohner, R., Kellerer, A., Lampater, U., Lewis, S., and Zanoni, C., “Structural, thermal, and opti-
cal performance analysis applied to subsystems of the European Extremely Large Telescope,” Journal of
Astronomical Telescopes, Instruments, and Systems 8(2), 021504 (2022).

[13] Brooks, T. E. and Stahl, H. P., “Precision thermal control technology to enable thermally stable telescopes,”

J. Astron. Telesc. Instrum. Syst. 8(2), 024001 (2022).

[14] Havey Jr, K., Martens, B., Hahm, T., Voyer, P., and Shomper, M., “Challenges and beneﬁts to achieving
sub-millikelvin thermal control stability on large space observatories,” in [Proc. SPIE ], 11116, 1111607
(2019).

[15] Segato, E., Da Deppo, V., Debei, S., Naletto, G., Cremonese, G., and Flamini, E., “Method for studying the
eﬀects of thermal deformations on optical systems for space application,” Appl. Optics 50(18), 2836–2845
(2011).

[16] Brooks, T. E., “Predictive thermal control applied to HabEx,” in [Proc. SPIE], 10398, 1039814 (2017).
[17] Zhang, G., Zhao, H., Chen, Y., Zhang, G., Zhang, Z., Peng, J., Zhao, Z., and Yan, A., “Optimization
thermal design method for space cameras based on thermo-optical analysis and Taguchi method,” Opt.
Eng. 59(7), 075101 (2020).

[18] Stahl, H. P., “Advanced ultraviolet, optical, and infrared mirror technology development for very large space

telescopes,” J. Astron. Telesc. Instrum. Syst. 6(2), 025001 (2020).

[19] Stahl, H. P., Brooks, T. E., Eﬃnger, M., Eng, R., and Young, R., “Predictive Thermal Control (PTC)
technology to enable thermally stable telescopes: year three status,” in [Proc. SPIE ], 11487, 114870T
(2020).

[20] Banyal, R. K., Ravindra, B., and Chatterjee, S., “Opto-thermal analysis of a lightweighted mirror for solar

telescope,” Opt. Express 21(6), 7065–7081 (2013).

[21] Buleri, C., Kehoe, M., Lukashin, C., Jackson, T., Beckman, J., Curtis, A., Edwards, B., Owen, T., Phe-
nis, A., and Stebbins, M., “Structural, thermal, and optical performance (STOP) analysis of the NASA
ARCSTONE instruments,” in [Proc. SPIE], 10925, 1092503 (2019).

[22] Blaurock, C., McGinnis, M., Kim, K., and Mosier, G. E., “Structural-thermal-optical performance (STOP)

sensitivity analysis for the James Webb Space Telescope,” in [Proc. SPIE], 5867, 58670V (2005).

[23] Gu, N., Li, C., Cheng, Y., and Rao, C., “Thermal control for light-weighted primary mirrors of large

ground-based solar telescopes,” J. Astron. Telesc. Instrum. Syst. 5(1), 014005 (2019).

[24] Loriette, V. and Boccara, C., “Absorption of low-loss optical materials measured at 1064 nm by a position-

modulated collinear photothermal detection technique,” Appl. Optics 42(4), 649–656 (2003).

[25] Zhao, C., Degallaix, J., Ju, L., Fan, Y., Blair, D. G., Slagmolen, B. J. J., Gray, M. B., Lowry, C. M. M.,
McClelland, D. E., Hosken, D. J., Mudge, D., Brooks, A., Munich, J., Veitch, P. J., Barton, M. A.,
and Billingsley, G., “Compensation of strong thermal lensing in high-optical-power cavities,” Phys. Rev.
Lett. 96(23), 231101 (2006).

[26] Ramette, J., Kasprzack, M., Brooks, A., Blair, C., Wang, H., and Heintze, M., “Analytical model for ring
heater thermal compensation in the advanced laser interferometer gravitational-wave observatory,” Appl.
Opt. 55(10), 2619–2625 (2016).

[27] Lyu, C. and Zhan, R., “Stop model development and analysis of an optical collimation system for a tactical

high-energy laser weapon,” Appl. Opt. 60(13), 3596–3603 (2021).

[28] Schmidt, K., Graf, T., Ahmed, M. A., and Sawodny, O., “Energy-optimal disturbance feedforward control
for constrained deformable mirrors with thermoelastic actuation,” in [Proceedings of IEEE International
Conference on Systems, Man and Cybernetics ], 107–112, IEEE (2019).

[29] Abt, F., Hess, A., and Dausinger, F., “Temporal behaviour of the focal shift of beam forming optics for
high power single mode lasers,” in [Proceedings of International Congress on Applications of Lasers &
Electro-Optics], 2008(1), 561–568, Laser Institute of America (2008).

[30] Turella, A., Della Corte, V., Paolinetti, R., Palumbo, P., Amoroso, M., Castronuovo, M., and Mugnuolo, R.,
“Structural-Thermal-Optical-Performance (STOP) analysis for the prediction of the line-of-sight stability
of JANUS camera on board JUICE ESA mission,” in [Proc. SPIE], 11103, 101–112 (2019).

[31] Koppen, S., Van Der Kolk, M., van Kempen, F. C. M., De Vreugd, J., and Langelaar, M., “Topology
optimization of multicomponent optomechanical systems for improved optical performance,” Structural and
Multidisciplinary Optimization 58(3), 885–901 (2018).

[32] Nordera, S., Chioetto, P., Zuppella, P., Pace, E., Morgante, G., Tozzi, A., del Vecchio, C., Scippa, A.,
Micela, G., and Da Deppo, V., “Methodology for the analysis of a thermo-mechanically deformed optical
system,” in [Proc. SPIE], 11852, 2072–2080, SPIE (2021).

[33] Li, Y., Yuan, G., Xie, X., Dong, L., and Yin, L., “Multilayer thermal control for high-altitude vertical

imaging aerial cameras,” Applied Optics 61(17), 5205–5214 (2022).

[34] Haber, A., Draganov, J. E., Heesh, K., Tesch, J., and Krainak, M., “Modeling and system identiﬁcation of

transient STOP models of optical systems,” Opt. Express 28(26), 39250–39265 (2020).

[35] Verhaegen, M. and Verdult, V., [Filtering and System Identiﬁcation: a Least Squares Approach], Cambridge

(2007).

[36] Haber, A. and Verhaegen, M., “Modeling and state-space identiﬁcation of deformable mirrors,” Opt. Ex-

press 28(4), 4726–4740 (2020).

[37] Haber, A. and Verhaegen, M., “Subspace identiﬁcation of large-scale interconnected systems,” IEEE Trans.

Automat. Contr. 59(10), 2754–2759 (2014).

[38] Haber, A., Draganov, J. E., Heesh, K., Cadena, J., and Krainak, M., “Modeling, experimental validation,

and model order reduction of mirror thermal dynamics,” Opt. Express 29(15), 24508–24524 (2021).

[39] Haber, A. and Bifano, T., “Dual-update data-driven control of deformable mirrors using Walsh basis func-

tions,” JOSA A 39(3), 459–469 (2022).

[40] Roddier, F., [Adaptive Optics In Astronomy ], Cambridge (1999).
[41] Tyson, R., [Principles of Adaptive Optics ], CRC (2015).
[42] Haber, A., Polo, A., Smith, C. S., Pereira, S. F., Urbach, P., and Verhaegen, M., “Iterative learning control
of a membrane deformable mirror for optimal wavefront correction,” Appl. Opt. 52(11), 2363–2373 (2013).
[43] Bonora, S. and Poletto, L., “Push-pull membrane mirrors for adaptive optics.,” Opt. Express 14(25), 11935–

11944 (2006).

[44] Haber, A. and Bifano, T., “General approach to precise deformable mirror control,” Opt. Express 29(21),

33741–33759 (2021).

[45] Vogel, C., Tyler, G., Lu, Y., Bifano, T., Conan, R., and Blain, C., “Modeling and parameter estimation for

point-actuated continuous-facesheet deformable mirrors,” JOSA A 27(11), A56–A63 (2010).

[46] Polo, A., Haber, A., Pereira, S. F., Verhaegen, M., and Urbach, H. P., “Linear phase retrieval for real-time

adaptive optics,” J. Eur. Opt. Soc.-Rapid 8(13070) (2013).

[47] Haber, A., “Codes for simulating transient structural thermal optical performance (STOP) analysis
[retrieved 17 July 2022], https://github.com/AleksandarHaber/

of Newtonian telescope,” (2022).
transient-structural-thermal-optical-performance-STOP-analysis-of-reflective-optics.

[48] Haber,

A.,

“Python

and

COMSOL

Livelink

timating
els.”
System-Identification-of-Structural-Thermal-Optical-Performance-STOP-models.

structural-thermal-optical
19
(2022)

performance

[retrieved

2022],

July

for MATLAB

es-
mod-
https://github.com/AleksandarHaber/

state-space

(STOP)

codes

for

[49] Haber, A., Draganov, J. E., and Krainak, M., “Machine learning of transient structural-thermal-optical-

performance (stop) models,” in [Proc. SPIE, to be published], (2022).

[50] COMSOL, “Ray tracing of Newtonian telescope,” (2022). [retrieved 17 July 2022], https://www.comsol.

com/model/newtonian-telescope-19063.

[51] Lockwood, M., “A modern guide to mirror support,” (2016). [retrieved 14 July 2022], http://www.loptics.

com/articles/mirrorsupport/mirrorsupport.html.

[52] Haber, A., “Subspace identiﬁcation of temperature dynamics,” arXiv preprint arXiv:1908.02379 (2019).
[53] Haber, A., Pecora, F., Chowdhury, M. U., and Summerville, M., “Identiﬁcation of temperature dynamics
using subspace and machine learning techniques,” in [Proceedings of ASME Dynamic Systems and Control
Conference], 59155, V002T24A003, ASME (2019).

[54] L¨utkepohl, H., [New introduction to multiple time series analysis], Springer Science & Business Media

(2005).

