BayesianMonitoringofCOVID-19inSwedenRobinMarina,H˚akanRunvikb,AlexanderMedvedevb,andStefanEngblom∗aaDivisionofScientiﬁcComputing,DepartmentofInformationTechnology,UppsalaUniversity,SE-75105Uppsala,Sweden.E-mail:robin.marin,stefane@it.uu.se.aDivisionofSystemsandControl,DepartmentofInformationTechnology,UppsalaUniversity,SE-75105Uppsala,Sweden.E-mail:hakan.runvik,alexander.medvedev@it.uu.se.June2,2022AbstractInaneﬀorttoprovideregionaldecisionsupportforthepublichealthcare,wedesignadata-drivencompartment-basedmodelofCOVID-19inSweden.Fromnationalhospitalstatisticswederiveparameterpriors,andwedeveloplinearﬁlteringtechniquestodrivethesimulationsgivendataintheformofdailyhealthcaredemands.Weadditionallyproposeaposteriormarginalestimatorwhichenablesareﬁnedresolutionofthereproduc-tionnumberestimate,andwhichalsoimprovessubstantiallyonourconﬁdenceintheoverallresultsthankstoaparametricbootstrapprocedure.FromourcomputationalapproachweobtainaBayesianmodelofpredictivevaluewhichprovidesimportantinsightintotheprogressionofthedisease,includingestimatesoftheeﬀectivereproductionnumber,theinfectionfatalityrate,andtheregional-levelimmunity.Wesuccessfullyvalidateourposteriormodelagainstseveraldiﬀerentsources,includingoutputsfromextensivescreeningprograms.Sinceourrequireddataincomparisoniseasyandnon-sensitivetocollect,wearguethatourapproachisparticularlypromisingasatooltosupportmonitoringanddecisionswithinpublichealth.Keywords:Bayesianforecasting|Publichealthsituationawareness|Data-drivenepidemics|Compartment-basedmodel|KalmanﬁlteringSigniﬁcance:UsingpublicdatafromSwedishpatientregistrieswedevelopanational-scalecomputationalmodelofCOVID-19.Theparametrizedmodelproducesvaluableweeklypredictionsofhealthcaredemandsattheregionallevelandvalidateswellagainstseveraldiﬀerentsources.Wealsoobtaincriticalepidemiologicalinsightsintothediseaseprogression,including,e.g.,reproductionnumber,immunityanddiseasefatalityestimates.Thesuccessofthemodelhingesonournoveluseofﬁlteringtechniqueswhichallowsustodesignanaccuratedata-drivenprocedureusingdataexclusivelyfromhealthcaredemands,i.e.,ourapproachdoesnotrelyonpublictestingandisthereforeverycost-eﬀective.IntroductionTheresultsinthispaperstemfromtheworkcarriedoutwithinthecross-disciplinaryresearchprojectCRUSHCovidatUppsalaUniversity†.Startinginthefall2020,everyweekthegrouppublishedawidelycirculatedreportcoveringtheregion’sCOVIDstatusby,e.g.,collectingdatafromPCRtests,mobileapps,wastewateranalysis,andhealthcare.OurcontributionconsistsofaBayesiandisease-spreadmodelwhichprovidesdecisionsupportintheformofpredictionsofhealthcaredemandsandadditionalepidemiologicalinsight.ThepathogenSARS-CoV-19andthesubsequentpandemicresultedinanexplosioninresearchrelatedtoCOVID-19:researchondatacollectionandinterpretation,modelingandforecasting,aswellasscenariogeneration.Fromthebeginningoftheoutbreak,datahavebeeninstrumentalinunderstandingthediseasedynamics[1,2,3].Withincreasingamountsofcasesandrecordedpatientdata,statisticalmodelsfordiagnosisandprognosiswerequicklydeveloped[4].Combiningin-patientdatawithothercovariates,theuseofdigitaltechnologiesfordiseasesurveillanceisnowpossible[5],notablywithanimpactalsoforCOVID-19[6,7,8,9].Challengesconnectedtothecollectionanddistributionofavailabledatawheremetwithspecializedtoolsfordecentralizedpublishing[10,11]andanonymizedmobilitydatawerealsoinactiveuse[12,13].Sincethestartofthepandemic,therehavebeenseveralattemptstomodelandforecastthespreadofthevirus.Datamightappearplentyatﬁrst,buttheabundanceofpoorlyinformativedataalsohindersmodelingeﬀorts[14,15].∗Correspondingauthor,telephone+46-18-4712754,fax+46-18-511925.†https://www.uu.se/forskning/projekt/crush-covid/1arXiv:2205.00859v3  [stat.AP]  1 Jun 2022Severalaspectsofthediseasetransmissionareofinterestandneedtobemodeled,fromsmallscaleinvitropropertiestoglobalinterventions.Somemodelingeﬀortsincludemultiplelevelsofresolutionstocapture,e.g.,globaltravelpatterns[16]orlocalwithin-countrydynamics[17].Understandinghowtocombinethevariousscalescansubstantiallybeneﬁttheﬁdelityofscenariogenerators[18].Itisfairtosaythatmodelswhichhavebeeninactualuseareunderstudiedduetotimeconstraintsandthereforeoftenlackathoroughuncertaintyanalysis[19,20].Infact,withthefrequentlackofhigh-qualitydataforthecurrentstateofthedisease,nowcastinghasbeenincreasinglycriticalindecisionmaking[3,21,22,23].Whenmodelingunderdatalimitationsandwithpotentiallylargeprocessuncertainties,theBayesianframeworkstandsoutasperhapsthemostnaturalchoiceformodelingandprediction;indeed,Bayesianinferenceindiseasemodelsisanactiveresearcharea[24,25,26].Themainchallengesaretobalancemodelgranularityandcomputationalcostswithdataqualityandactualinformationcontent.Oursolutioninvolvesadaptingalinearnoiseapproximation[27]whichenablesfusionofdiﬀerentdatasourcesandsupportsacomputationallycheapapproximatelikelihoodfunctionvialinearﬁlters.Wealsoinvestigatetheposteriormodelnotonlythroughtheposteriorpredictivedistribution[28,29],butalsobyestimatingthebiasintroducedbytheapproximatelikelihoodusingideasfromparametricbootstrap[24].Ourdiseasespreadmodelattemptstobalancethreekeyqualities:interpretability,quantiﬁableuncertainty,andforecastingaccuracy.Theposteriormodelwasinvestigatedthroughmarginalestimators,bycomparingourresultstoseveralothersources,andbybiasestimatesobtainedviabootstraparguments.Asthispaperdemonstrates,theachievedaccuracyandrobustnessarequiteremarkableconsideringthatnodatafromscreeningprogramswereused.ResultsBayesianCOVID-19modelTheSwedishpubliclyavailabledatafortheCOVID-19pandemicisdiscussedunderMaterialandMethods.Giventheseconsiderations,weformulateourmodelarounddataintheformofdailyobservationsofpatientsunderhospitalcare(H),intensivecare(W),andreporteddeaths(D),allinthe21Swedishregions(counties).ForthereasonsstatedinMaterialandMethods,anyothersourcesofdatahavebeenusedforcomparisonsaposteriorionly.InthestandardSEIRmodel,susceptibleindividualsSbecomeexposedE(withoutsymptoms),andafterprogress-ingtoasymptomaticinfectiousstateI,theybecomerecoveredR.Basedontheavailabledata,weextendtheSEIRmodelwiththestates(H,W,D),andregardthemasworsenedstatesofthesymptomaticinfectionsuchthatonlyacertainfractionoftheindividualswillenterthem.Itiswidelyacceptedthatnotallexposedbecomesymptomatic[30]andhencewealsoextendthemodelbyincludinganasymptomaticstateAwithnoorverymildsymptoms.Thetransmissionisusuallydrivenbyrandomortime-dependentcontactintensitiesbetweenthesusceptibleandtheinfectedindividuals.Asin[31,32,24],weratherconsiderimplicitspreadviaaninfectiouspressurecompartmentϕ,anenvironmentalstatevariablewhichmodelsthecurrentforceofinfectionofthevirus.Thepressureissourcedbysheddingfromallinfectedcarriersanddecaysovertime.Anadvantagewiththistypeofspreadisthatitiseasytomodeldiseasespreadbymorethanoneinfectiouscompartment,i.e.,(E,A,I)inourcase.Similarly,spreadoveranetworkdeﬁnedby,e.g.,commutingintensitiesbetweenregionscaneasilybehandled.Afterexperimenting,however,wedidnotincorporatenetworkspreadinthemodel,sincelettingtheregionsfunctionasindependentnodesreducesthecomputationalcomplexitywhilegivingaverysimilardataﬁt.TheresultingmodelissummarizedinFig.1,withadetaileddescriptionofthemodelandallparametersintheSupportingInformation(SI).Withincreasedmodelcomplexityfollowsexplanatorypowerattheexpenseofpoorermodelidentiﬁability.Withthisinmindweexcludeallmodelreﬁnementsthatareeithermissingorareunreliablyorincompletelyreportedinthedata,e.g.,ageandgenderaswellascertainreﬁnedstatesofminorsymptoms.Werecognizetheinfection’svaryingeﬀectsondiﬀerentagegroups[33]andsomustacceptthatourresultsremaininanage-averagedregime.Increasedmodelcomplexitywhich,however,isrequiredinvolvesusingamixofdynamicandstaticparameters,sincethisallowsthemodeltorespondtofunctionalchangessuchassocietalinterventions[34],vaccinationsandvirusmutations[35].Wethusletβt,theinfectionraterelatedtothereproductionnumberRt,andtheinfectionfatalityrate(IFR)betime-varying.Allinalltheproblemisthentodeterminetheposteriordistributionfor10staticandtwodynamicparameters.Thelatterareassumedconstantforfourweekperiodsbutarere-sampledindependentlyforeachsuchperiod.Clearly,well-chosenpriorsarerequiredtomaketheproblemdeﬁnite.Considerableworkwentintoconstructingandcontinuouslyupdatingourpriorsusingpublishedresearchandpublicregistries;theﬁnalpriorsaredisplayedinFig.2,withacompletelistofpriorsandpriorpredictiveestimatesgivenintheSI.WederiveaKalmanﬁltermodel[36]fromthetopologyofourcompartmentmodelandassumingexponentiallydistributedwaitingtimes.Themarginallikelihoodfromtheﬁlterthenapproximatesthelikelihoodconditionedonaparameterproposalwhensubjecttoanobservationtriple(H,W,D),andweusetheAdaptiveMetropolis(AM)[37]methodtogeneratesamplesfromtheinducedposterior.Theroleofthemarginallikelihoodisremindfulofasyntheticlikelihood[38]andwerefertothespeciﬁccombinationofaKalmanmarginalLikelihoodandAdaptiveMetropolisas2φFigure1:ProposedCOVID-19compartmentmodel.(S)usceptiblecontractthevirusbyexposuretoaninfec-tiouspressure(ϕ),become(E)xposedandthenenterei-therthe(A)symptomaticorthe(I)nfectedstate.Symp-tomaticseverityfollows:(I)nfectedto(H)ospitalizedto(W)orsen(intensivecare),andto(D)eath.OnlystatesA,I,andHcan(R)ecoverfromthedisease.Theobserv-ablesareH,W,andD.Figure2:Marginalpriors(red)forthemodelparametersandtheassociatedposteriordistributions(blue)fortheSwedishaggregateinferredfrompubliclyavailableregionaldatafromApril1,2020toMay30,2021.Thedashedlinesindicatethepriormeans,andthefulllinesandnumericvaluestheposteriormeans.ThereproductionrateRtandtheIFRaredynamicparametersandatemporalaverageisdisplayedhere.3Figure3:Seven-dayaheadpredictionintheUppsalaregion.Shadedareashows68%CrI,andthepointsaretheobservations.Thedottedverticallinesindicatethefour-weekperiodsusedforthedynamicrates.KLAM.AdditionaldetailsarefoundinMaterialandMethodsandintheSI.OurmodelwasusedforweeklyreportedpredictionswithinCRUSHCovid.Priortoeachreportwecarriedoutamodelupdatingprocedure:newdatawerepulledfrompublicrepositoriesandscreenedforcontradictoryorincorrectvalues.TheposteriorwassampledbyKLAMusinganinitializationeitherfromanestimatedinitialstateasdescribedinMaterialandMethodsanddevelopedforthisverypurpose,orsimplyusingpreviouslystoredstatesamples.Thelatterallowsforfastersamplingasitreducestheburn-inperiod:about24hoursofcomputefor21regionsandayear’sworthofdataona4-corelaptopwasthenreducedtoafewhours.Theﬁnalposteriormodelwasqueriedforone-week-aheadforecastswithuncertaintyboundsforthe(H,W,D)triple.Wealsocontinuouslyevaluatedthepreviousweek’spredictionsagainsttheup-to-datedatainthesameround.PosteriorpredictionInFig.2,wedisplaythepriordistributionstogetherwiththeresultingSwedishaggregateposterior,i.e.,thepopulationweightedaverageoftheindividualposteriorofeachofSweden’s21regions.Severalpriorsareclearlyverysimilartotheirrespectiveposteriors,e.g.,thelatentperiodrateσandthesymptomaticperiodrateγI.Thisisexpectedandsimplyindicateslittleinformationintheobservationsfortheseparametersrelativetotheprior.Ourdataalsocannotimproveonthepriorfortheshareofspreadfromexposed(pre-symptomatic)andasymptomaticindividuals(parametersθEandθA,respectively).ThisissimplyduetothefactthatwehavenocontinuouslyreporteddataneitherforEnorforA.Onthesamenotewehadtorelyonadirectedstudy[30]todeﬁnethepriorfortheparameterE2I,i.e.,thefractionofexposedindividualswhoeventuallydevelopsymptoms.Ofmoreinterestaretheparametersthatgovernthefractionthattransitiontoaworsenedstateofthedisease:I→HandH→W.Ourresultsshowthat3.8%[2.2,5.9](95%CredibleInterval(CrI)∗∗)ofthesymptomaticindividualsrequirehospitalcare,and11.2%[7.6,16.1]ofthehospitalizedpatientsrequireintensivecare.Duringtheconsideredperiod,theSwedishPublicHealthAgency(PHA)publishedﬁvepointestimatesofthosesamefractions.TherelevantdemographicaverageoftheseareI→H:3.0%(2.4,3.6)andH→W:14.3%(9.8,18.8)(mean±2std,n=5)respectively[33].Additionally,[39]foundsimilarestimatesinFranceI→H:2.9%[1.7,4.8]andH→W:19.0%[18.7,19.4].Wecouldhaveusedtheearlierofthosepointestimatestoimproveonthecorrespondingpriors,however,asvalidationpossibilitiesarescarce,wedecidedtoratherusethemforthispurposeinstead.Theregionalmodelswereusedforposteriorpredictionsonaweeklybasis,e.g.,one7-dayaheadpredictionperregionandonefortheentirenation.InFig.3thisisexempliﬁedoveralongerperiodtogetherwiththeactualoutcome.Theperformanceoftheweeklypredictionswhichwerereportedlive(N=25)ispresentedinTab.1.Eachprediction∗∗WeindicateCredibleIntervals(CrI)bysquarebrackets[·,·]andConﬁdenceIntervals(CI)byregularparentheses(·,·),unlessotherwisespeciﬁed.4Figure4:ThefractionofrecoveredindividualsintheStockholmregion.Ourmodel(blue),issetto2.35%onApril5,2020(matching[40]).Serology-basedBayesianmodelpredictions[40](red)whichreported70/95%CrIs.Estimatedmeanprevalenceofantibodiesfoundinsparedbloodsamplesfromoutpatientcare,with95%CI(solid,pink)andblooddonors(dashed,purple)[41].On2020,December27,theSwedishvaccinationcampaignstartedandboththenumberofdeliveredﬁrstdoses(dotted)andseconddoses(dash-dot)areindicated.includedameanwith68/95%CrI.Theweekafterpublishing,weevaluatedthepredictionagainstthethen-availabledata.ThepredictionsperformedbetterinthemediumsizedregionUppsalaandnotably,thepredictionsforcasualtieswaspoorinthelargerregionStockholm.ThisobservationeventuallyleadustoallowtheIFRtobecomeatime-varyingparameteraspreviouslydescribed(inTab.1only9outof25reportssupportedadynamicIFR).Anotherpossiblereasonforthepoorerpredictionperformanceherecouldbethat,sincetheStockholmregioncontainsthreelargehospitals,thegreaterheterogeneityintermsofreportingmakesidentiﬁcationmorechallenging.Onecanrightlyquestionifsmallersub-regionsshouldratherbemodeledhere,butwedidnothaveaccesstothedatatodrivesuchamodel.Table1:Frequency(%)ofallweeklyreportedpredictionsthatfellinsideof(68/95%CrI,7daysahead),evaluatedonthefollowingweek(N=25).NotethattheUppsalaresultsareveryclosetotheideal68/95%outcome.Hospital(H)Intensive(W)Death(D)Uppsala(68%)767268Stockholm646436Sweden884432Uppsala(95%)10010096Stockholm849268Sweden969268PosteriorhiddenstateestimationTheposteriormodelcanalsobeusedasakindof“Bayesiantwin”andestimatequantitiesthatareotherwiseverydiﬃculttoapproach.Forexample,wecanreadilyestimatethenumberofindividualsthathavecontractedthediseaseandsurvived;theseindividualsaretheonesthatcouldpotentiallyhavedevelopedantibodiesthataredetectableinserologytests.InFig.4,wevisualizeseveralreportedresultsforStockholm[40,41]andourestimates.Thoseestimatescompareverywell,andnotablysogiventhatnoscreeningdatawasusedbyourmethod.Theposteriormodelcanalsoestimatethesymptomaticincidenceinthesamevein.Fig.5illustratesourestimatedsymptomaticincidenceandthereportednumberofpositiveRT-PCRtestsbythePHAforUppsala.Astesting5Figure5:Top:theestimatedsymptomaticincidencefromourmodel(bluewith[68,95]%CrIshaded)andtheconﬁrmedcasesbyPHA(redline7-daysmoothedanduncertaintyfromrolling±[1,2]standarddeviationshaded,withdataaspoints)forUppsala.Therightaxisgivesthenumberoftestsper100000inhabitantsperweek(dashed).ThetotalnumberoftestsadministeredduringTestingphase3wasapproximately360000.Thedottedverticallinesmarkthestartofnewtestingphasesthataredeﬁnedbypolicychangesaﬀectingthetestingvolumes.Bottom:theratiobetweenthemodel’ssymptomaticincidenceandtheconﬁrmedcasesincidenceindicatestheproportionofcasesthataremissedbytesting.Valuesaboveonethushintsatanunderreportingofsymptomaticcases.increases,theratiobetweenourestimateandthepositivetestsoscillatesaroundone,indicatingthatthetestingatthattimecapturesmostofthesymptomaticinfected.Thesetwoexamplesareremarkableanddemonstratethatourcomputationalmodelcanbeusedtoeﬀectivelyestimatehiddenvariablesatthesameregionalresolutionassupportedbydata.Theﬁnancialcostforthiskindofmonitoringwouldofcoursebeatinyfractioncomparedtoanyalternativesbasedontesting.MarginalrisksRecallthattheIFRisdeﬁnedastheproportionofdeathsamonginfectedindividuals,i.e.,includingasymptoticcases.Bydesign,ourmodelreliesonanIFRwhichisconstantoverfourweeks.OurestimatedIFRforSwedenstayedrelativelyconstantovertheperiodMay2020–November2020at0.69%[0.11,1.5](95%CrI).Forcomparison,inApril2020,thePHApublishedanearlyestimateof0.58%(0.37,1.05)(95%CI)forStockholm,Sweden[42].However,thisestimatereliesoninitialassumptionsonthenumberofundetectedcasesthatseemunjustiﬁedwhencomparedtolaterﬁndings[43,44].ItalsoassumestherelativelyyoungerStockholmdemographicsratherthanthenationalone,andisthereforeanunderestimateofthenationalIFR.AlaterSweden-wideIFRestimateof0.76%[0.65,0.87]waspublishedinNovember2020[45]andalignswellwithourestimateabove.Althoughour95%CrIiscomparativelywide,thisispartiallyduetomodelingeachperiodindependentlyandwithoutanyregularizationinthetransitionbetweenperiods.Tab.2summarizesafewbi-monthlyestimatesfortheperiodafterOctober2020.Theﬁrsttwoentriesinthetableoverlaptheestimatesfrom[46]:Nov2020=[0.60,1.46]%,andJan2021=[0.56,1.44]%.Clearly,theIFRwastrendingdownwardsandthisisalsoknowntobethecaseinStockholm[45]aswellasfortheworldingeneral[46].Table2:Bi-monthlyestimatedIFR[%]with68%CrIfromOctober2020toMay2021.StockholmUppsalaSwedenOct+Nov‡0.66[0.34,0.81]0.49[0.24,0.74]0.55[0.27,0.88]Dec+Jan‡0.84[0.71,1.00]‡0.59[0.28,0.92]0.88[0.55,1.30]Feb+Mar§‡0.35[0.18,0.50]0.47[0.23,0.70]0.44[0.22,0.81]Apr+May0.35[0.19,0.49]0.45[0.22,0.67]0.35[0.18,0.56]§Theestimatedbiasislargecomparedtothe68%CrI(seeMaterialandMethods).‡The68%CrIsoftheposteriorandthebootstrapreplicatedonotshareatleasta68%overlap(seeMaterialandMethods).Ofinterestisalsothecasefatalityrisk(CFR)[47],i.e.,theriskofdeathconditionedonbeingdiagnosedwiththedisease.WemoregenerallydeﬁneCFRXastheproportionofdeathsexpectedgivenacertainnumberofindividualsincompartmentX∈{I,H,W}.NotethatCFRIinvolvesthenumberofsymptomaticindividualswhichisnotthesamethingasthenumberofcasesconﬁrmedbytesting.6Figure6:ReproductionnumberestimatesfortheUppsalaregion.TheBayesianposterioryieldsmonthlyestimates(box-plot)whilethequasi-MLestimatorisdaily(solid).ForcomparisonalsothePHA’sestimatesbasedonscreeningfromofatotalof367200RT-PCRtestsduringtheperiod5August,2020–26May,2021.FromourposteriorwemaydirectlyestimatethenationalaverageCFRstobe{[0.72,1.3],[16,19],[34,36]}%(95%CrIs)forCFRI,CFRH,andCFRW.Bycomparison,[48]oﬀerstheestimatesCFRI=(1.0,3.0)%,CFRH=(9.0,17.0)%,andCFRW=(24.0,51.0)%(95%CI).Anotherwaytoinvestigatetheserisksisbyrunningtheposteriorﬁlteracrossourdatatoproduceanestimateforthenumberofdeceasedpercompartment.UntilMarch23,2021weﬁndforallofSwedenthat{DI,DH,DW}={[1786,8652],[3612,8096],[1126,3627]}(95%CrIs).FromNBHWdatawemayestimatethosesamenumberstobe{8335,4102,935}[49],afterascalingofabout5%toarriveatthesametotalnumberofdeadasinourdataset(D=13372).Apparently,ourmodeloverestimatesthedeathsunderICUandtosomeextentalsoathospital,whileourestimatefordeathsoutsidehospitalisleft-tiltedcomparedtothisdatapoint.Thiscouldlikelyimprovegivenmoredetaileddatasources,including,e.g.,improvedrecordsofCOVID-relateddeathsandhospitalcareoutcomes.ReproductionestimatesThereproductionnumberprovidesanessentialinsightintothefuturedevelopmentofthespreadofadiseaseinapop-ulation.Anaccurateestimateofthisnumberisvitaltosupportrationalpublichealthdecision-makingandtoinformthegeneralpublic.Temporalvariationsinthereproductionnumberarecausedbysocio-behavioral,environmental,andvirologicalandbiologicalfactors[50].Thedynamicsofthereproductionnumberisthereforesigniﬁcantlyfasterthanthoseofmostotherparametersandhenceitisdesirabletoincreasethetemporalresolutionofthisestimator.Theproceduredescribedsofaryieldsstaticreproductionnumberestimatesforeachfour-weekperiodandwithcomparablylargespread.Weobtaineddailyestimatesthroughaseparateestimationprocedure,butusingthesamedata.Thisestimationisdiﬀerentasitisonlybasedonthemeanoftheposteriordistributionsandthemean-ﬁelddynamicsandwithoutthecorrectionstepoftheKalmanﬁlter.ByutilizingtheinnovationcovariancefromtheKalmanﬁlter,andaquadraticregularizationtermtoensuresmoothnessofthesolution,aquasi-maximumlikelihoodformulationisobtained.Fromthis,theestimatesarecalculatedusingdynamicoptimization,seeMaterialandMethodsandtheSIforfurtherdetails.ReproductionnumberestimateshavebeencalculatedinthiswayforthewholedurationoftheparameterizedperiodforallregionsinSweden.InFig.6,wepresentourresultsforUppsalatogetherwiththetesting-basedestimateproducedbythePHAforthesameperiod.Thecost-eﬀectivenessofourestimateisapparentheresincetheresultsaresimilar,butthePHAestimatereliesoncostlyincidencedata.Apartfromprovidingmoredetailedinformation,thisprocedureenablesavalidationoftheBayesianworkﬂowsinceitsupportssyntheticdatatobesimulatedinanoﬀ-linefashion.Thatis,foragivenposteriorandadaily7time-dependentestimateofthereproductionnumber,ourfullCOVID-19modelcanbesimulatedtogeneratereplicasofaprocesswithaknowntruth.OurBayesianinversionmaynowbeemployedasecondtimeinordertoestimatebiasorsensitivitiesforvariousestimatesofinterest.Theimprovedconﬁdenceintheresultsachievedbyfollowingthisprocedurecannotbeoverstated.DiscussionWehavedevisedadetailedBayesianmodelfortheregionaldynamicsoftheCOVID-19pandemicinSweden.Adata-centricviewpointisthat,usingmodel-baseddataanalysis,wehavegainedathoroughinsightintotheprogressionoftheCOVID-19pandemicinSwedeningeneral,withextraemphasisontheUppsalaRegion.Theproposedcompartment-basedmodelcombinedwiththenoveluseofoptimallinearﬁltersturnedouttobeaquiteremarkableinformation-theoreticepidemiologicaltool.Theoutputqualityasobtainedinourworkcomparesverywellwithoﬃcialestimatesgatheredintest-basedprograms,cf.Figs.4–6.DuringthesecondandthirdwavesinSweden,atleast10millionRT-PCRtestswereadministeredatastandardcostof1400SEK(≈$150)pertest[51].TheexpensesforsuchaPCRtestforallsymptomatic-strategyquicklygrows,underliningtheeconomicaladvantagesofourapproach.Clearly,attheindividuallevelthereareseveralbeneﬁtswithtestingandtheimportanceofscreeningasameanstocollectinitialstatisticsforthediseasespreadcannotbestressedenough.However,ourapproachremainsverypromisingasasupportingtooltocontinuetomonitorthesituationwhentestingislimitedduetorisk-costtrade-oﬀs.Theresultingmodelwasfurtherprocessedtooutputweeklypredictionsforhealthcaredemands,andalsomarginalestimatorsforimportantcharacteristicsofthediseasesuchasinfectionfatalityratesandreproductionnumbers.Thelatteroutputincreasedtheconﬁdenceintotheoverallapproachthroughthegenerationofsyntheticdataandparametricbootstraptechniques.Improveddatathatwouldhaveenabledahighermodelprecisioninclude(1)aconsistentlymanagedincidencereportfromrandomizedtesting(notnecessarilyhighvolume),and(2)ahighertemporalresolutionofhospitalizationandintensivecarerisksaswellastimesfortreatmentintheserespectivecategories.Thesestatisticscouldbothbecollectedatarelativelysmallcostbutwouldlikelyimprovetheprecisionconsiderably.Withoutrelyingonpublictestingstrategies,ourmodel-basedapproachprovidedimprovedsituationawarenessoftheprogressionofthepandemic.ByvirtueoftheconsistentBayesianframework,uncertaintiesaretransparentlypropagatedunderclearassumptions,alsointhefaceofpotentiallyhazardoussituations.Wearguethatthisqualitymakesthetechniquesdevelopedhereinparticularlypromisingfromacommunicativeperspective.Ourdatastreamsarehighinlatency,butareontheotherhandfairlylowinnoise.Low-latencysignals,e.g.,publicscreening,self-reportingmobileapps,oranalysisofsewagewater,areinsteadoftenmorenoisyorotherwisebiased.Combiningthesediﬀerentkindsofstreamsprovidesforexcellentdecisionsupportandappearsextremelypromisingforuseintrackingregionalepidemicsatanear-dailyresolution.MaterialsandMethodsWedetailtheSwedishpubliclyavailabledataandthemostimportantpartsofthecomputationalmodelanditsassociatedsyntheticlikelihoodhere.Two‘bootstrap’proceduresarealsooutlined:oneforimprovingthetemporalresolutionofthereproductionnumberestimates,andoneforboundingtheinversionbiasthroughthegenerationofsyntheticdata.Furtherdetailsconcerningthederivationofthelinearﬁlters,datapre-processing,andoptimizationalgorithmsarefoundintheSI.SwedishCOVID-19dataInSweden,thepubliclyavailabledatafortheCOVID-19pandemicfallinoneoftwocategories:hospitalloadandresultsfromPCRtesting.Inaddition,cumulativenational-leveldiseaseseveritystatisticshasbeenupdatedapproxi-matelyonceamonththroughoutthepandemic.The21regionalcouncilscompilehospitaldataandreportthenumberofpatientsundergoinginpatientorintensivecare,andalsothenumberofdeceasedindividuals.Thesenumbersarereportedonadailybasisandhavebeenjudgedtobeofconsistentqualityoversuﬃcientlylongperiodsoftimetobeusedinourmodeling.Weretrievethosedatafromtheportalinitiativec19.se,whichinturncollectsthedatafromtheregionalcouncils.Forvalidation,wehavecomparedwithoﬃcialpublicregistries,includingtheSwedishPublicHealthAgency(PHA),theNationalBoardofHealthandWelfare(NBHW),andtheSwedishIntensiveCareRegistry(SIR).Thereareoccasionalinconsistenciesinthedatawhichneedtobeﬁlteredaway;seetheSIforourquitebasicapproachforthis.TheSwedishdailyincidenceasreportedfromPCRtestinghasbeenpoorinseveralperiodsoftimeduetorestric-tionsandchangesintestingrecommendations[52].InJune2020,theSwedishgovernmentappointedacommissiontoevaluateCOVID-19measures,including,amongotherthings,thetestingprograms.TheyfoundthatthetimefrombookingaPCRtesttoreceivingthetestresultsexceededsixdaysacrossseveralregionsduringtheperiodoftimestudiedinthispaper,withadditionaltimedelaysinreportingCOVID-19notiﬁcationratesontheregional-and8municipalitylevels[53].Forthesereasons,wejudgedtheincidencedatatobeunreliableandexcludeditfromourmodel.NotethedirectcomparisionwiththeincidenceinFig.5.Self-reportingviamobileappshasbeenproposedasacheapandfastalternativetoPCRtesting[9].However,thevalidityofthesignaldependsonsymptomsthatoverlapwithotherrespiratoryinfections.Forexample,thePHAnotedahighoccurrenceofsymptomsofacuterespiratoryinfectionsbythestartoftheSwedishsecondwaveinfall2020[9,54].Laboratoryanalysesofrespiratoryviruseslaterindicatedahighincidenceofcommoncoldscausedbyrhinovirusesduringthesameperiod[55].Anotheralternativedatasourceisthesurveillanceofwastewater[56,57].Duetothesignal’slargerelativenoiseratio,wedidnotconsideritinthisstudybutleftitforfuturework.ApproximateLikelihoodsthroughLinearﬁlteringWeunderstandthecompartmentmodelasacontinuous-timeMarkovchain(CTMC)overanintegerlatticecountingthenumberofindividualsinthediﬀerentcompartments.Hencethewaitingtimeforexitingonecompartmentisexponentiallydistributedofmeanrate1/λ,andthenumberofindividualswhichexitinasmallwindowoftime[t,t+∆t)isPoissonian∼Po(ntλ∆t),withntthenumberofindividualsattimetinthecompartment.Ifthenumberofindividualsislargeenough,thistransitioncanbeapproximatedbythenormaldistribution∼N(ntλ∆t,ntλ∆t),whichcanbedirectlytranslatedintoacontributiontothestateupdatematrices(Fk,Qk)ofadiscrete-timeKalmanﬁlterwiththeequationsofstatexk+1=Fkxk+wk,wk∼N(0,Qk),(1)withkthediscretetimeindex.Toreducethetransients,weuseaninitializationoftheﬁlterdevelopedspeciﬁcallyforthispurpose.GiventhestateupdatematrixFk,observationmatrixHk,andtimeseriesdatay=(yk),theﬁrststepofthealgorithmremovesallcumulativestatesfromF0,H0,andy0toproduceFred,Hred,andyred.Theinitialnon-cumulativestatesarethenobtainedbyprojectingthedominatingeigenvectorofFredontothesubspacedeﬁnedbyHredxred=yredunderapositivityconstraint.Forthemeasuredcumulativestates,theinitialstateitselfistakenasthedata,whiletheunmeasuredcumulativestatesaresettozero.Inparticularandunderreasonableassumptions,ifthesystemwouldbeinitializedfromtheeigenvectorandsimulatedwithoutperturbations,therelativemagnitudeofthenon-cumulativestateswouldremainconstant.Thelinearﬁlterallowsforanapproximationoftheintractablelikelihoodofaparameterproposal˜Θ,namelythemarginalﬁlterlikelihood,p˜Θ(y)=TYk=0N(yk|Hkˆxk|k−1,Qk).(2)Inourapplicationwerelyonthelikelihoodtoproduceanapproximatesample(Θi)fromtheposteriorinaMetropolisalgorithmwithaGaussianproposalfunction,andwherethecovarianceisadaptivelytunedonthecovarianceoftheposteriorsamples[37].BootstraponthemarginTheachievabletemporalresolutionoftheBayesianparameterestimatesprovidedbyMetropolissamplingislimitedbybothcomputationalcomplexityandtheamountofdata.Toobtainmoreﬁne-grainedestimates,adiﬀerentapproachisneeded.Sincethereproductionnumberisthedominatingparameterofthedynamics,amorehighlyresolvedestimateofthereproductionnumberisparticularlyuseful.Intermsoftheparametersofthemodel,thiscorrespondstoimprovingtheestimationofβt.Therefore,adailyestimateβ(tk)=βkiscalculatedusingdynamicoptimizationtechniques.DynamicoptimizationhasbeenusedforestimatingthereproductionnumberoftheCOVID-19outbreakalsobyothers[58].However,whencombinedwithanexistingposteriordistribution,caremustbetakentoavoidoverconﬁdencefromusingthesamedatatwice.Forthisreason,wedonotattempttoderiveanimprovedposteriordistributionofβt,butinsteadasinglemarginaltime-dependentmaximumlikelihoodestimateissought,wheretherestoftheposteriordistributionis“frozen”.ThesamelogarithmicmarginallikelihoodthatisusedintheKalmanﬁlterisutilizedforthispurpose,nowunderstoodasaquadraticcostfunction.Here,however,thedeviationbetweenmeasurementsandtheoutputsfromthemean-ﬁelddynamicsisminimized,i.e.,ashortenedformulationcomparedtotheﬁlterisemployedsincetheKalmancorrectionstepisneglected.Toavoidfastvariationsinβk,aregularizingtermpenalizingsquaregradientsisalsoadded.Theresultingoptimizationproblemcanbesolvedusingstandardtechniques.FurtherdetailsontheformulationoftheoptimizationproblemanditssolutionareprovidedintheSI.9SyntheticbootstrapInrealapplications,a“true”ora“best”parameterposteriorP∗isusuallyunknown.Evaluatingthestabilityandthequalityoftheapproximateposterior˜Pisunfortunatelyoftenoverlooked.Wesuggestemployingaparametricbootstrapapproachasin[24]toassesstheerrorbetweensamplesfromthetrueandtheapproximatedposterior˜E:=˜Θ−Θ∗,whereΘ∗∼P∗and˜Θ∼˜P.Denotebyθ∗:=E[Θ∗],theminimummeansquareerrorestimator(MMSE)ofanassumedtruth.Decomposingthemeansquareerroraroundthisvalueweﬁnd˜e2:=E[(˜Θ−θ∗)2]=E[(˜Θ−˜θ)2]|{z}Variance+(˜θ−θ∗)2|{z}Squarebias=:˜b2,(3)where˜θ:=E[˜Θ]istheMMSEof˜Θ.Formally,thisstillrequiressamplesfromthetrueposteriorwhenestimatingthebias.WeapproximatethisviaabootstrappedestimatorusingasampleofNbootsyntheticdatasetsgeneratedfromtheMMSEoftheapproximateposterior.Thegenerativesimulatorrequiresdailyestimatesof(βk)orelsethesyntheticdataquicklydriftsoﬀcomparedtotheobservations,andthusthistechniqueultimatelyhingesonthehighlyresolvedmarginalestimatordescribedabove.Posteriorsamplesmaythenbegeneratedforeachsyntheticset,yieldingnowasetofsamplesˆΘi∼ˆPi,whichthenallowsfortheuseofthenowtractablebiasestimatorˆbi:=E[ˆΘi]−E[˜Θ].Ourﬁnalestimatoristhenanaverageoverthesesyntheticsets;˜b≈N−1bootPiˆbiin(3).Whileupto196000samplesfromeachposteriorwereusedtocomputepointestimatorsandCrIs,bootstrapreplicasaremuchmorecostlytoprocesssoweusedNboot=3,andmainlyreliedonthebiasestimatortodiagnosenon-robustnessinpointestimators.Thatis,apointestimatorwithCrIAoforderα=68%,say,andwithbiasestimate˜bisconsideredlessrobustwhenever˜b≥0.5diam(A).(4)Thebootstrapposteriordensitiescanbeusedinaggregateformforbiasestimationandcheckofestimatorrobust-nessasjustdescribed,orforarelatedcheckofcredibilityintervalrobustness.ConsidertwoCrIintervalsAandBoforderα,e.g.,α=68%,andwhereBisabootstrapreplicateofA.AbasicmeasureoftherobustnessofAisthelevelofoverlapbetweenAandBandonecanreasonablyrequirethesameoverlapastheindicatedorderα,i.e.,torequirediam(A∩B)≥αdiam(A∪B).(5)Ifthiscriterionissatisﬁed,thenarandomvariabledrawnuniformlyfromA∪Bhasprobability≥αtoalsobeinA∩B.TherobustnesschecksEqs.(4)–(5)areexplicitlyreportedinTab.2,butwerealsoroutinelyemployedwhenevaluatingvariousresults.AcknowledgmentsThisworkwasﬁnanciallysupportedbytheSwedishInnovationAgencyVinnova,bytheSwedishResearchCouncilFormas(S.Engblom),andbytheSwedishResearchCouncil(H.RunvikandA.Medvedev).AuthorcontributionsSEconceivedtheresearchandRMandSEdevelopedtheinitialforwardmodel.LinearﬁltersweredesignedbySEandHRwhoalsodevelopedandoperatedthedynamicoptimizationapproachwithinputsfromAM.SEdevelopedpriorsanddatapre-processingandRMadaptedtheBayesiansamplingtechniques,collecteddata,performedcomputations,andpreparedthemanuscriptjointwithSEandwithinputsfromHR.Allauthorstookpartinrevisingthemanuscript.References[1]LiQ,etal.(2020)EarlytransmissiondynamicsinWuhan,China,ofnovelcoronavirus–infectedpneumonia.N.Engl.J.Med.[2]LavezzoE,etal.(2020)SuppressionofaSARS-CoV-2outbreakintheItalianmunicipalityofVo’.Nature584(7821):425–429.[3]WuJT,LeungK,LeungGM(2020)Nowcastingandforecastingthepotentialdomesticandinternationalspreadofthe2019-nCoVoutbreakoriginatinginWuhan,China:amodellingstudy.TheLancet395(10225):689–697.[4]WynantsL,etal.(2020)Predictionmodelsfordiagnosisandprognosisofcovid-19:systematicreviewandcriticalappraisal.BMJ369.[5]AbadZSH,etal.(2021)Digitalpublichealthsurveillance:asystematicscopingreview.NPJDigit.Med.4(1):1–13.10[6]MenniC,etal.(2020)Real-timetrackingofself-reportedsymptomstopredictpotentialCOVID-19.Nat.Med.26(7):1037–1040.[7]DrewDA,etal.(2020)Rapidimplementationofmobiletechnologyforreal-timeepidemiologyofCOVID-19.Science368(6497):1362–1367.[8]RossmanH,etal.(2020)AframeworkforidentifyingregionaloutbreakandspreadofCOVID-19fromone-minutepopulation-widesurveys.Nat.Med.26(5):634–638.[9]KennedyB,etal.(2022)App-basedCOVID-19syndromicsurveillanceandpredictionofhospitaladmissionsinCOVIDSymptomStudySweden.Nat.Commun.13:2110.[10]GuidottiE,ArdiaD(2020)COVID-19datahub.J.OpenSourceSoftw.5(51):2376.[11]ReinhartA,etal.(2021)Anopenrepositoryofreal-timeCOVID-19indicators.Proc.Natl.Acad.Sci.U.S.A.118(51).[12]ImranM,QaziU,OﬂiF(2022)TBCOV:TwoBillionMultilingualCOVID-19TweetswithSentiment,Entity,Geo,andGenderLabels.Data7(1):8.[13]IlinC,etal.(2021)PublicmobilitydataenablesCOVID-19forecastingandmanagementatlocalandglobalscales.Sci.Rep.11(1):1–11.[14]ShindeGR,etal.(2020)Forecastingmodelsforcoronavirusdisease(COVID-19):asurveyofthestate-of-the-art.SNComput.Sci.1(4):1–15.[15]McDonaldDJ,etal.(2021)CanauxiliaryindicatorsimproveCOVID-19forecastingandhotspotprediction?Proc.Natl.Acad.Sci.U.S.A.118(51).[16]DavisJT,etal.(2021)CryptictransmissionofSARS-CoV-2andtheﬁrstCOVID-19wave.Nature600(7887):127–132.[17]GattoM,etal.(2020)SpreadanddynamicsoftheCOVID-19epidemicinItaly:Eﬀectsofemergencycontainmentmeasures.Proc.Natl.Acad.Sci.U.S.A.117(19):10484–10491.[18]JordanE,ShinDE,LeekhaS,AzarmS(2021)Optimizationinthecontextofcovid-19predictionandcontrol:Aliteraturereview.IEEEAccess.[19]EdelingW,etal.(2021)TheimpactofuncertaintyonpredictionsoftheCovidSimepidemiologicalcode.Nat.Comput.Sci.1(2):128–135.[20]SolteszK,etal.(2020)TheeﬀectofinterventionsonCOVID-19.Nature588(7839):E26–E28.[21]AltmejdA,Rockl¨ovJ,WallinJ(2020)NowcastingCovid-19statisticsreportedwithdelay:acase-studyofSweden.arXivpreprintarXiv:2006.06840.[22]HawrylukI,etal.(2021)Gaussianprocessnowcasting:ApplicationtoCOVID-19mortalityreportinginUncer-taintyArtif.Intell.pp.1258–1268.[23]WuJT,etal.(2021)Nowcastingepidemicsofnovelpathogens:lessonsfromCOVID-19.Nat.Med.27(3):388–395.[24]EngblomS,ErikssonR,WidgrenS(2020)Bayesianepidemiologicalmodelingoverhigh-resolutionnetworkdata.Epidemics32:100399.[25]GaglioneD,etal.(2020)AdaptiveBayesianlearningandforecastingofepidemicevolution—dataanalysisoftheCOVID-19outbreak.IEEEAccess8:175244–175264.[26]RadevST,etal.(2021)Outbreakﬂow:Model-basedBayesianinferenceofdiseaseoutbreakdynamicswithin-vertibleneuralnetworksanditsapplicationtotheCOVID-19pandemicsinGermany.PLoSComput.Biol.17(10):e1009472.[27]FearnheadP,GiagosV,SherlockC(2014)Inferenceforreactionnetworksusingthelinearnoiseapproximation.Biometrics70(2):457–466.[28]GelmanA,CarlinJB,SternHS,RubinDB(1995)Bayesiandataanalysis.(ChapmanandHall/CRC).[29]GabryJ,SimpsonD,VehtariA,BetancourtM,GelmanA(2019)VisualizationinBayesianworkﬂow.JRStat.Soc.Ser.A182(2):389–402.11[30]ByrneAW,etal.(2020)InferreddurationofinfectiousperiodofSARS-CoV-2:rapidscopingreviewandanalysisofavailableevidenceforasymptomaticandsymptomaticCOVID-19cases.BMJOpen10(8):e039856.[31]AndersonRM,MayRM(1981)Thepopulationdynamicsofmicroparasitesandtheirinvertebratehosts.Philos.Trans.R.Soc.291(1054):451–524.[32]WidgrenS,EngblomS,EmanuelsonU,LindbergA(2018)Spatio-temporalmodellingofverotoxigenicEscherichiacoliO157incattleinSweden:exploringoptionsforcontrol.Vet.Res.49(1):1–13.[33]Folkh¨alsomyndigheten(2021)Scenarierf¨orfortsattspridning(https://www.folkhalsomyndigheten.se/smittskydd-beredskap/utbrott/aktuella-utbrott/covid-19/statistik-och-analyser/analys-och-prognoser/).2–7.Online;accessed2022-01-21.[34]HaugN,etal.(2020)RankingtheeﬀectivenessofworldwideCOVID-19governmentinterventions.Nat.Hum.Behav.4(12):1303–1312.[35]LiuY,Rockl¨ovJ(2021)ThereproductivenumberofthedeltavariantofSARS-CoV-2isfarhighercomparedtotheancestralSARS-CoV-2virus.J.TravelMed.[36]KalmanRE(1960)Anewapproachtolinearﬁlteringandpredictionproblems.Trans.ASME,J.BasicEng.82D:35–45.[37]HaarioH,SaksmanE,TamminenJ(2001)Anadaptivemetropolisalgorithm.Bernoulli7(2):223–242.[38]WoodSN(2010)Statisticalinferencefornoisynonlinearecologicaldynamicsystems.Nature466(7310):1102–1104.[39]SaljeH,etal.(2020)EstimatingtheburdenofSARS-CoV-2infrance.Science369(6500):208–211.[40]CastroDopicoX,etal.(2021)SeropositivityinblooddonorsandpregnantwomenduringtheﬁrstyearofSARS-CoV-2transmissioninStockholm,Sweden.J.Intern.Med.[41]Folkh¨alsomyndigheten(2021)P˚avisningavantikropparmotSARS-CoV-2(1)iblodprovfr˚an¨oppenv˚arden,(2)hosblodgivare(https://www.folkhalsomyndigheten.se/contentassets).[42]Folkh¨alsomyndigheten(2021)TheinfectionfatalityrateofCOVID-19inStockholm–technicalreport(https://www.folkhalsomyndigheten.se/contentassets).Online;accessed2022-01-21.[43]RippingerC,etal.(2021)EvaluationofundetectedcasesduringtheCOVID-19epidemicinaustria.BMCInfec.Dis.21(1):1–11.[44]IronsNJ,RafteryAE(2021)EstimatingSARS-CoV-2infectionsfromdeaths,conﬁrmedcases,tests,andrandomsurveys.Proc.Natl.Acad.Sci.U.S.A.118(31).[45]Garcia-PtacekS,etal.(2021)Temporaltrendsinhospitalizationsand30-daymortalityinolderpatientsduringtheCOVIDpandemicfromMarch2020toJuly2021.medRxivpreprintmedRxiv:2021.12.22.21268237.[46]ForecastingTeamC(2022)VariationintheCOVID-19infection–fatalityratiobyage,time,andgeographyduringthepre-vaccineera:asystematicanalysis.TheLancet.[47]KellyH,CowlingBJ(2013)Casefatality:rate,ratio,orrisk?Epidemiology24(4):622–623.[48]AlimohamadiY,TolaHH,Abbasi-GhahramanlooA,JananiM,SepandiM(2021)CasefatalityrateofCOVID-19:asystematicreviewandmeta-analysis.J.Prev.Med.Hyg.62(2):E311.[49]Socialstyrelsen(2020)Avlidnaochcovid-19(https://www.socialstyrelsen.se/statistik-och-data/statistik/statistik-om-covid-19/statistik-over-antal-avlidna-i-covid-19/).Online;accessed2022-02-09.[50]DelamaterPL,StreetEJ,LeslieTF,YangYT,JacobsenKH(2019)Complexityofthebasicreproductionnumber(R0).Emerg.Infect.Dis.25(1):1.[51]SverigesKommunerochRegioner(2021)Meddelandefr˚anstyrelsen-¨OverenskommelsemellanStatenochSverigesKommunerochRegionerom¨okadnationelltestningochsmittsp˚arningf¨orcovid-192021(https://skr.se/download/18.32563d7d1784aa279ece298a/1618741812524/WEBB-17-OK-Staten-SKR-Covid-19.pdf).Online;accessed2022-04-01.[52]WinbladU,SwenningAK,SpanglerD(2022)Softlawandindividualresponsibility:areviewoftheSwedishpolicyresponsetoCOVID-19.HealthEcon.PolicyLaw17(1):48–61.12[53]AlmgrenM,Bj¨orkJ(2021)Kartl¨aggningavskillnaderiregionernasinsatserf¨orprovtagningochsmittsp˚arningundercoronapandemin.[54]Folkh¨alsomyndigheten(2021)Veckorapportomcovid-19,vecka39(https://www.folkhalsomyndigheten.se/globalassets/statistik-uppfoljning/smittsamma-sjukdomar/veckorapporter-covid-19/2021/covid-19-veckorapport-2021-vecka-39-final.pdf).Online;accessed2022-02-09.[55]Karolinskauniversitetslaboratioriet(2022)Luftv¨agspatogenerprovanalyseradeavKarolin-skaUniversitetslaboratoriettillochmedvecka52022(https://www.karolinska.se/globalassets/global/2-funktioner/funktion-kul/klinisk-mikrobiologi/epidemiologi/rapport-influensa--och-rs-virus-och-andra-luftvagspatogener.pdf).Online;accessed2022-02-09.[56]SagutiF,etal.(2021)SurveillanceofwastewaterrevealedpeaksofSARS-CoV-2precedingthoseofhospitalizedpatientswithCOVID-19.WaterRes.189:116620.[57]GalaniA,etal.(2022)SARS-CoV-2wastewatersurveillancedatacanpredicthospitalizationsandICUadmissions.Sci.TotalEnviron.804:150151.[58]RussoL,etal.(2020)Tracingday-zeroandforecastingtheCOVID-19outbreakinLombardy,Italy:Acompart-mentalmodellingandnumericaloptimizationapproach.PLoSONE15(10):e0240649.e0240649.13SupportingInformation:BayesianMonitoringofCOVID-19inSwedenThissupplementcontainsfurtherexplanationsanddetailsofthedata,themodel,andthecomputationalmethod-ology,aswellassomeadditionalresultsmentionedinthemainarticle.TheSIisorganizedinsectionsasfollows:Additionalsupportingresults•Incidence:ourmodel’sestimateoftheincidenceofsymptomaticcasescomparedtothenumberofconﬁrmedcasesbyPHAinStockholm(complementingtheUppsalacasesinthemainarticle).Thisalsoproducesanestimateoftheproportionofundetectedsymptomaticcases.•Rt-estimators:foraselectionofsmallandlargeregions.DataAsummaryofthevarioussourcesanduseofdata.CompartmentmodelOurextendedSEIR-modelindetail,includinganexplanationofallmodelparameters.PriorsTheparameterpriorsforthemodelandhowtheyweredetermined.KalmanﬁlterThelinearﬁlterapproximationofthecontinuous-timeMarkovchain,whichinturnisourprobabilisticunderstandingoftheextendedSEIR-model.PosteriorsamplingDetailsoftheMetropolissamplingprocedure.DynamicoptimizationsolutionTheprocedurefor‘bootstraponthemargin’toimprovethetemporalresolutionofthereproductionnumberestimator.Additionalevaluations•Posteriorrobustness:Acomparisonofthe21regionalposteriors,whichthusformanaturalbootstrappopulation.•Bootstraprobustness:Theestimatedbiasandsomeadditionalqualitystatisticsforthe21regionalposte-riors.•Baselinepredictor:AcomparisonofthepredictionofourKalmanﬁlterandasimplerregressionestimator.ReproducibilityThecodeaswellasthedatarequiredforreproducingtheresultsinthepaperarepubliclyavailableandcanbedownloadedatgithub.com/robineriksson/Bayesian-Monitoring-of-COVID-19-in-Sweden.RefertotheincludedﬁleREADME.mdformoreinformation.AdditionalsupportingresultsIncidenceestimates:acomparisonbetweenmodel-andtest-basedresultsInthemainpaper,weillustratehowtheposteriormodelcanestimatetheincidenceofsympomaticcases,whichisahiddenstateandthusdoesnotcorresponddirectlytodata.HerewedisplaythecorrespondingestimatesforStockholm,seeFig.7.Thereportedtestsaresmoothedbya7-daySavitzky-Golayﬁlterandtheestimateduncertaintyisthecorrespondingrollingstandarddeviation.Aftertestingphase3,theratiobetweenourestimateandthepositivetestsoscillatesaroundone,indicatingthatthetestingatthattimecapturesmostofthesymptomaticinfected.AfterApril2021,ourmodelestimatesasomewhatsmallersymptomaticincidencethanwhatwascapturedinactualtests.Apossibleexplanationforthisisthatatsmallerincidence,anincreasingproportionofasymptomaticcasesareincludedinthetestpool,e.g.,fromregularscreeningofhospitalpersonnelandsimilar.ThroughthismethodofexploringthedatawecanalsoconﬁrmourearlysuspicionthattheincidencedatasignalwaspoorduringTestingphase1andinpartduringphase2.ThenoiseinthescreeningdataexplainsthenervousbehaviorofthePHAsreproductionnumberestimatesasseeninFigs.6and8.Atthestartofthesecondwave,andduringTestingphase3,thissignalwasmuchmoreaccuratealbeitathugeeconomicalcosts.Rt-estimatorsWeillustratethedailyRt-estimatorsforthethreelargestandthethreesmallest(bypopulation)regions:Stockholm,V¨astraG¨otaland,Sk˚ane(largest),and,respectively,Gotland,J¨amtland,andBlekinge(smallest)inFig.8.Therelativeuncertaintyisvisiblysmallerinthelargerregionsthaninthesmallerones,atypicalsmallpopulationeﬀectasthedatastreamsforthesmallerregionsconsistofsmallercountswithlargeruncertaintiesinarelativesense.14Figure7:Left:theestimatedsymptomaticincidencefromourmodel(bluewith[68,95]%CrIshaded)andtheconﬁrmedcasesbyPHA(redline7-daysmoothedanduncertaintyfromrolling±[1,2]standarddeviationshaded,withdataaspoints)forStockholm.Therightaxisgivesthenumberoftestsper100000inhabitantsperweek(dashed).ThetotalnumberoftestsadministeredduringTestingphase3wasapproximately1800000forStockholm.Thedottedverticallinesmarkthestartofnewtestingphasesthataredeﬁnedbypolicychangesaﬀectingthetestingvolumes.Right:theratiobetweenthemodel’ssymptomaticincidenceandtheconﬁrmedcasesincidenceindicatestheproportionofcasesthataremissedbytesting.Figure8:Ourdailyreproductionnumberestimate(inred,withboxplotsforeach4-weekconstantposterior)andthepubliclyreportedPHAestimatesfromtheSwedishscreeningprogram(ingrey).Thethreelargestregionsare:Stockholm(topleft)[1864000total#ofRT-PCRtestsadministeredduringthe2ndand3rdwaves,August5,2020–May26,2021],V¨astraG¨otaland(topcenter)[1570000],andSk˚ane(topright)[1240000],followedbytheestimateforthethreesmallestregions:Gotland(bottomleft)[48440],Blekinge(bottomcenter)[110300],andJ¨amtland(bottomright)[184300].ThestandardcostperPCRtestwas1400SEK(≈$150)[1].15DataThedailyobservationsweuseintheinferenceisretrievedfromc19.seusingPythonscripts.Inturn,c19.sefetchesthedatafromtheoﬃcialregionalsourcesonadailybasis.Swedenhas21regions(Fig.9)thatareinchargeofprovidingforthehealthcareofitspopulation.Theyalsopresentdataonthenumberofhospitalizedpatients,thenumberofpatientsinintensivecare,andthedailynumberofdiseasedbyCOVID-19.Weuseacoupleofotherdatasetsforpriorgenerationandforposteriorvalidation,seeTab.3.ThesetsC19andNBHWDhaddoubleuse,however,thepriorinformationobtainedfromthesewereonanaggregatedlevel.Table3:Summaryofdatasourcesusedforprior,forinference,andforvalidation.NameDescriptionTime-seriesRegionalUseSourceC19Collectionofregionalreports(H,W,D)YesYesPrior,Inference[2]PHAIncidenceofconfirmedcases(Iinc)YesYesValidation[3]NBHWDTotal#ofdeaths(DI,DH,DW)NoNoPrior,Validation[4]NBHWγRecoverytimesathospitalandICUNoNoPrior[5]SIRD#ofdeathsasICU(DW)YesYesPrior[6]FHMRtEstimatedRtperregionfromIincYesYesValidation[7]FHM1Rec,FHM2RecFHMseroprevalencestudy(1:outpatientcare),(2:blooddonors)NoNoValidation[8]CastroREstimatedRecoveredinStockholmYesNoValidation[9]SCBtransRegionalin-/outcommutingNoNoPrior[10]RegionBlekinge: 159 748Dalarna: 287 795Gävleborg: 287 333Gotland: 59 636Halland: 333 202Jämtland: 130 697Jönköping: 363 351Kalmar: 245 415Kronoberg: 201 290Norrbotten: 250 230Örebro: 304 634Östergötland: 465 214Skåne: 1 376 659Södermanland: 297 169Stockholm: 2 374 550Uppsala: 383 044Värmland: 282 342Västerbotten: 271 621Västernorrland: 245 380Västmanland: 275 634Västra Götaland: 1 724 529Figure9:Swedenisdividedinto21regions.Weﬁndaposteriordistributionforeachoftheindividualregionsaseachregionpublishtheirowndataofobservables.Inthelegendthepopulationsizeofeachregionisgiven(asof9December,2019[11]),whichspansfromthesmallest:Gotland(59636),tothelargest:Stockholm(2374550).Datapre-processingOurmaindatasourceswereupdatedeachdayandincorrectorquestionabledatapointswerecommon.Twoerrorsthatneedtobeaddressedarenextdescribed.Firstly,thereareimpossibleorveryextremeupdates,e.g.,anegativeincidenceorverylargejumps,mostlikelyduetoanaccumulationofdelayedreports,orinsomecasespossiblyinanattempttocorrectearlierreports.Forexample,adelayinthereportingofdeceasedhasbeendescribedintheSwedishdataset[12],andwasthereexplainedas“batch”reporting.Insimilarspirit,therearealsoafewmissingdatapoints.However,theseareallfoundveryearlyoninthedatahistoryandcouldsafelybereplacedwithNaN-values,thussimplyignored.Second,andmoreproblematicfromamodel-basedperspective,isthefactthatpartsofthereportingdisplayastrongperiodiccomponent,thatis,whichisnotsupportedbythemodelandrathermostlikelyaneﬀectofweekdayperiodicity.16Figure10:Reportsofdeceasedperweekdayoverthepe-riodApril1,2020–May31,2021fortheStockholmregion.Thesmoothingprocedureattemptstocorrectforweeklyreportingpatternsintheoriginaldataandbehavessimi-larlytoabootstrapreplicateforthesametimeperiodandregion.Thepre-processingofdataisdoneintwosteps.First,weensurethatthereisnonegativeincidencedata.Negativevaluesaredetectedandsetto0,withvaluesbackwardsintimecorrectedina‘reasonable’wayusingasimplelineardecayingmemorykernel,andwiththecorrespondingcumulativecompartmentadjustedaccordingly.Inthisﬁrststepwealsoreplacemissingormanuallyfoundearlyoutliermeasurementswitheitherlinearlyinterpolateddatafromadjacentdays,orusingNaN-values.Thesecondstepinvolvessmoothingthecumulativeﬁeldsandtheincidenceﬁeldstomitigatetheeﬀectsofweeklyperiodiclagsorbatchreporting.Thesmoothingalgorithmremovesunlikelyincidencesbystartingfromthemostextremeoutliers,e.g.,≥[10,9,...,2]standarddeviationsunderaPoissonianapproximation,andspreadsthemoutduringtheperiodbeforeinsuchawayastodampenweekdaydependenciesinreporting.Mostweeklyperiodicityisremovedbythisprocedure,seeFig.10foranexample,andwhateverremainsdoesnotseemtointerferewiththeBayesianinference.Thetotaleﬀectthepre-processinghasonthedatacanbemeasuredinthesenseofthemeanmaximumrelativediﬀerence,dsmooth=N−1tXtmaxi|X(i)smooth−X(i)|(t)max(1,|X(i)(t)|),(6)wherei∈{1,2,3}forcompartmentX∈[H,W,D],i.e.,thethreedatacompartmentsandoversomeperiodoftimeoflengthNt.WereportthismeasurefortheperiodApril1,2000–May31,2021inTab.6.Thepopulationweightednationalaveragediﬀerenceis6.6%.CompartmentmodelTheextendedSEIRmodelisdepictedinFig.11.Thetransitionsintheﬁgurearemodeledviatransitionratescorrespondingtoexponentiallydistributedwaitingtimesinacontinuous-timeMarkovchaininterpretation.ThecompartmentmodelweconsiderstemsfromtheSISE-model[13](Chap.11).Thismodelcontainsthreestatevariables,[S,I,ϕ].TheﬁrsttwoareintegercompartmentsandaredeﬁnedbytheMarkoviantransitionsSβϕΣ−1−−−−→I,Iγ−→S,(7)withΣ=S+I,thetotalpopulationsize.Susceptibleindividualsturninfectedatarateproportionaltothelocalinfectiouspressureϕ,andinfectedindividualsrecoveratarateγ.Thelastcompartmentϕrepresentstheenvironmentalpathogenloadandfollowsthedynamics[14]ϕ0(t)=θII(t)−ρϕ(t).(8)Infectedindividualsshedthepathogenintotheenvironment,thussourcingtheinfectiouspressure,whichalsodecaysataﬁxedrateβ.TheR0-numberfortheSISE-modelisgivenbyR0=pθIβ/(γρ)suchthatθI=ρisaconvenientnon-dimensionalization.OurextendedSEIR-modelinvolvestwotypesofparameters:ratesandfractions.Theratesare[βt,σ,γI,γA,γH,γW,θA,θE,θI,ρ],andthefractions[F0,F1,F2,F2d,F3,F3d,F4].Wemayfurtherdividetheratesintowaitingtimesandthosegoverningtheinfectiouspressure.Thewaitingtimesareσ,γI,γA,γH,andγW,andareunderstoodastheinverseofthemeantimeanindividualstaysinacertaincompartment,e.g.,themeanrecoverytimeforasymptomaticinfectedisγ−1I.ThetransitionfromStoEdependsonϕandβt.TheinfectiouspressureϕissourcedbytheviralsheddingfromasymptomaticθA,fromexposedθE,andfromsymptomaticindividualsθI,anditdecreasesbytheviraldecayrateρ.Weusethenon-dimensionalizationθI=ρandthescaledvariablesθE=θE∗×ρandθA=θA∗×ρ.17ForthismodelthereproductionnumbercanbedeterminedasR0=sβ0(cid:18)θE∗σ+(1−F0)θA∗γA+F0+(1−F0)F1γI(cid:19),(9)andanidenticalrelationholdsfor(Rt,βt).Thefractionparametersdeterminetheprobabilisticfatesofindividualsinacompartmentwithmorethanoneexit.Theyweredeterminedfromdemographicaveragessincethedailydatadidnotcontainthelevelofdetailtosupportage-dependency(cf.thediscussioninMaterialandMethods).E→I:F0=E2I,(10)A→I:F1=A2I(=0inoursimulations),(11)I→H:F2=HOSP,(12)H→W:F3=ICHOSP,(13)H→D:F3d=SIRMORT×HOSPMORT(14)W→D:F4=SIRMORT,and,(15)I→D:F2d=max(cid:18)0,IFRE2I−(HOSPMORT+ICHOSP)×SIRMORT×HOSP1−ICHOSP×(1−SIRMORT)(cid:19).(16)Theﬁnalrelationisbestexplainedfromthediscussionleadingto(24)below.Theremainingfractionsofthemodelcangenerallybeobtainedbyrequiringthatthetotalsumofalloutgoingfractionsisone.Thatis,thefractionwhichrecoversfromcompartmentXisgivenby1−FX−FXd,whereFXisthefractionthatentersthenextstateinthechainandwhereFXdisthefractionthatdies.Notethatthemodelparameterscoveringfatalities,(F2d,F3d,F4),areobtainedfromthemorenaturalparameters(SIRMORT,HOSPMORT,IFR)viaEqs.(14)–(16).φFigure11:DetailedcompartmentmodelofFig.1withrelatedtransitionrates.Thedashedarrowindicatestheinteractionwiththeenvironmentalcompartmentϕ.NetworkeﬀectfornationalscalesimulationsWedidnotﬁndthatconnectingtheregionsimprovedtheﬁttodataand,intheend,wethereforedecidednottousethistechniqueonaregularbasis.However,sincewediduseitinTab.1andforcompleteness,wedescribebelowhowitwasimplemented.Thenetworkconnectionisobtainedbyintroducingapriorcommutingfactorλ∈[0.5,1.5]thatallowsforconnec-tionsbetweentheregions.Thisaﬀectsonlythecalculationsonanationallevel,anditdoessomainlybyaddingsomecorrelationbetweenconnectedregions.18ThenetworkisdeﬁnedbyaconnectionmatrixDwhichisa21-by-21squarematrixwithazerodiagonal.Fortheithrow,eachcolumnjcontainstheproportionofindividualscommutingintoregionifromregionj.Inturn,theconnectionmatrixitselfisfoundbyalinearprogrammingformulationonthevolumesofindividualscommutinginandoutpereachregion[10].Ateachforwardstepinthesimulation,theinfectiouspressureϕk=ϕ(tk)isthenupdatedasϕk+1=¯ϕk+1+λ(Dϕk−d(cid:12)ϕk),(17)where¯ϕk+1istheupdateaccordingtoEqs.(28)–(30),i.e.,withoutanynetworkeﬀects,andwheredisthecolumnsumofDand(cid:12)iselement-wisemultiplication.PriorsThepriorknowledgereliedupontoconstructpriorsstemsfromseveralsources.Belowwebrieﬂycommentonthetechniquesandassumptionsusedtoderiveourpriors;eﬀectivesummariesarefoundinTabs.4and5.Theprocessofconstructingpriorswasongoingduringthewholeperiodfall2020tolatespring2021.Werevisedthepriorswheneverwebecameawareofnewresearch,whenmorestatisticsbecameavailable,orwedeemedmodeltweaksnecessary.Theﬁnalpriors(arrivedattowardstheendofMay2021)arewhatwediscussbelow.σandγI/γAThemeanincubationtimeσ−1issetto6.2dayswithsupportin[5.4,7],derivedfromthemeanand95%CIgivenin[15].Therecoverytimeforthesymptomaticinfectiousγ−1Iislessknownandwethereforesetthemeanto7days[16][17]withawidersupportof[4,10]days.WeassumesimilaritybetweenasymptomaticandsymptomaticcasesbysettingγA=γI,whichcoversthepriorssuggestedin[16].γHandγWWedeterminethepriorsforhospitalrecoverytimes,γ−1Handγ−1WfromadatasetpublishedbytheNBHW[5],includingthedistributionofexittimesforhospitalpatientswithandwithoutICUcare.Thedatasetisright-tailedcensoredforwaitingtimesover30days,whichaﬀectstheICUpatientrecords.Forγ−1H,weﬁrstmakeaBayesianﬁtofanexponentialdistributiontohospitalcaringtimedata(N=40507patients)andplaceasomewhatbroaderBetadistributionacrossthecredibleintervalforthehyperparameterthusfound,thisresultsinaBetadistributionofmean8.9andsupporton[8.7,9.1][days].Therecoverytimeunderintensivecare,γ−1W,ismorecomplicatedsincetheavailabledatainvolvesalsonon-ICUcaringtimes.Assumingthepreviouslydeterminedexponentiallydistributedwaitingtimesunderhospitalcare,weﬁrstsubtractedtwosuchwaitingtimes(tomodelpre-andpost-ICUcare,respectively),nextmadeaBayesianexponentialﬁttotheremainingtime(N=4039patients).Thisﬁtwasjudgedabitworsethanfornon-ICUcaretimeandsoweusedalargerenclosingsupportof[10.8,13.9]withmean12.2[days].E2IThepriorforthefractionE2I(E→I)wastakenfrom[18]:0.75(0.62,0.84)(95%CI),forwhichwedetermineascaledBetadistributionthatﬁtsthemeanandthegivenCIinterval.Theresultingpriordistributionhasmean0.75andsupporton[0.014,1].IFRTheIFR,i.e.,theeventualfractionofinfectedindividualsthatdies(E→Dinourmodel),isvolatileinthattheIFRdependsstronglyontheagedistributionoftheregionaswellasonthequalityofthehealthcareandthecurrentlydominatingvirusvariant[19,42].WethereforesettledonascaledBetadistributionwithpositiveskewedandratherwidesupport:0.67%,[0,2].HOSPMORTandSIRMORTThepriorsforthemortalityathospitalandintensivecare(HOSPMORT,SIRMORT)arerecovereddirectlyfrommortalitydatasetslinkedtohospitalizationdeaths[4](N=46236patientsand5729diseased)andICUdeaths[6](N=5744patientsand1357diseased),andarekeptasﬁxedconstants.ICHOSPToﬁndourpriorfortheproportionofhospitalizedpatientsneedingintensivecare,weusethec19.sedatainaggregateformandextractthepercentiles([0.5,50,99.5]%)ofthequotient[H:W]betweenthenumberofhospitalized-andICUpatientsforalldataavailable.WenextassumearelationoftheformH∼[H:W]×W,(18)forWapproximatelystationaryandthussatisfyingabalancecondition.ThismeansthatWin=γH×H×ICHOSP≈γW×W=Wout.(19)ItthenfollowsthatICHOSP≈γWW/(γHH)∼γW/(γH[H:W]).(20)Transformingthepercentilesof[H:W]accordingly,wethenﬁndaBetadistributionwithsupportonthese([0.065,0.95])andameanatthemedian(0.18).19HOSPAtthispointwehavetherelationIFR=[E2I]×IMORT+[H]×HOSPMORT×SIRMORT+[W]×SIRMORT,(21)intermsoftheasymptoticfractionsinfectedwithsymptoms[E2I],underhospitalcare[H],andunderintensivecare[W],andallinrelationtotheexposedpopulationE.Weﬁndtheasymptoticfractions[H]and[W]byconsideringthedynamicsexpressedinFig.11andrecognizingageometricseries,[H]=E2I×HOSP×(1+x+x2+...)=E2I×HOSP/(1−x),(22)withx=ICHOSP×(1−SIRMORT).Similarly,[W]=E2I×HOSP×ICHOSP×(1+x+x2+...)=E2I×HOSP×ICHOSP/(1−x).(23)WethusarriveattherelationIFR=E2I×[IMORT+(HOSPMORT+ICHOSP)×SIRMORT×HOSP/(1−x)].(24)Wenextﬁndapriorforthefractionofsymptomaticindividualsthatentersthehospital(HOSP)asfollows.ThemodelinitselfrestrictsthedeadsourcecompartmentstoI,H,andW.BythepreviouscalculationsthetotalriskofdeathfromcompartmentIcanbedecomposedintoCFR=IMORT+(HOSPMORT×SIRMORT×HOSP/(1−x))|{z}=:HMORT+(SIRMORT×HOSP×ICHOSP/(1−x))|{z}=:WMORT.(25)ToclosethesystemofequationsweassumetherelationIMORT∼[I:HW]×(HMORT+WMORT),(26)forsomeunknownscaling[I:HW].Connectingwithaggregatedmortalitydatafortotaldeathsfromc19andhospitaldeathsfrom[4],weﬁnd[I:HW]≈0.98whichwesimplytaketobeaBeta-distributionwithsupport[0,2]andmean1.AtthispointweresorttoadirectMonteCarlosimulationof(24)andﬁndsamplesfromHOSPusingHOSP=IFR/E2I(1+[I:HW])×(HOSPMORT+ICHOSP)×HOSP/(1−x)(27)WeﬁtascaledBetadistributionto100000samplesfromthisdistributionandﬁnallyobtainaBetadistributionwithmean0.033andsupport[0,0.17].θEandθATheviralsheddingfromcompartmentsEandA,θE∗andθA∗,respectively,isassumedtobeuncertainbutbounded.Weassignthesamepriortobothsheddingrates,ascaledBetadistributionwiththemodeat1andsupportin[0,2].Infectioushalf-lifeandρThedecayrateρinϕisdeﬁnedasρ=−log(0.5)×Infectioushalf-life.Thepriorfortheinfectioushalf-lifeistakentobeuniformbetween1and12hours,realizedasauniformdistributionbetween1/24and12/24.Thisenclosestheestimatefrom[21]whosuggests3hours.λAsmentioned,wedonotﬁndtheposteriorforthenetworkcouplingλ.ButwedodeﬁneadistributionwhichwekeepﬁxedandsamplefromwhenperformingsomeofourSweden-levelsimulations.WeassumeascaledBetadistributionwithmeanτandsupportτ×[0.5,1.5],whereτ=8/24×5/7.Thisscalingismeanttoachievetheproportionoftimeatworkundernormal(non-pandemic)circumstances.R0LastlywehaveβtwhichweﬁndfromsamplingRtandusingthemap(9).WethereforeplacetheprioronRtinstead,forwhichtheliteratureisplenty.TheRtprioristakenfromR0similarto[22];atruncatedlognormaldistributionwithlogmeanlog(1.3)andlogstandarddeviation0.4,andwithsupport[0,4].PriorpredictiveWeassessthequalityofthepriordistributionthroughsomesamplesfromthepriorpredictivedistribution.Wegenerate7-dayaheadpredictionsusingthesameset-upasinFig.3andillustratetheresultsinFig.12.20Table4:Priordistributionsforthestaticparameters.ParameterPriorMeanDescriptionEmpiricalSourceInferredσB[0.1429,0.1852](2,2.5926)6.2−1Incubationperiod–[15]γIB[0.1,0.25](2,5)7.0−1Infectiousperiod–[16][17]γHB[0.1099,0.1143](3,3)8.9−1HospitalperiodYes[5]γWB[0.0719,0.0922](2,2)12−1IntensivecareperiodYes[5]E2I(E→I)B[0.014,1](52.5614,17.8545)75%FractionE→I–[18]ICHOSP(H→W)B[0.0646,0.9448](2,13.2129)18%FractionH→W(=ICU)Yes[2]HOSP(I→H)B[0,0.1657](2.0274,8.2751)3.3%FractionI→HYes[5][2]θE∗B[0,2](2,2)1.0SourceE→ϕ–ThispaperθA∗B[0,2](2,2)1.0SourceA→ϕ–ThispaperInfectioushalf-lifeU(1/24,12/24)6.5/24Half-lifeofinfectiouspressure–[21]NotinferredγA=γI7.0−1Recoveryperiodforasymptomatic–[16](HOSPMORT)H→D=0.1322←MortalityriskfromHYes[4][6](SIRMORT)W→D=0.2129←MortalityriskfromWYes[6][23]ρ=−log(0.5)×Infectioushalf-life←Infectiouspressureϕdecayrate–Thispaperλ=8/24×5/7×B[0.5,1.5](2,2)8/24×5/7Commutingintensity–ThispaperI→D(16)0.24%Implicitlydefined–ThispaperFigure12:7-dayaheadpredictionwith68%CrI(shaded)using1000samplesfromthepriordistributionandwithdataforreference(points).SeeFig.3fortheposteriorequivalent.21Table5:Priordistributionsforthedynamicparameters.ParameterPriorMeanDescriptionEmpiricalSourceIFRB[0,0.2](2,4)0.67%Infectionfatalityrate–[19]RtLognormal[0,4](log(1.3),0.4)1.4Eﬀectivereproductionnumber–[22]KalmanﬁltermodelAlinearnoiseapproximationofacontinuous-timeMarkovchain(CTMC)withexponentiallydistributedwaitingtimesbetweenthecompartmentsisemployedintheBayesianmodeling.Undertheassumptionthatthesusceptiblepopulationdecreasesslowly(inarelativesense)comparedtotheotherstatesofthesystem,i.e.,onlyasmallportionofthetotalpopulationisbecominginfectedovershorttimehorizons,thedependenceofthesusceptiblepopulationontheinfectionrateisneglectedandinsteadcapturedimplicitlyviathetime-dependenceof(βt,Rt).Themodelisdiscretizedintime,whichresultsinthelinearstate-spacemodelxk+1=Fxk+wk,(28)wherexkisthe8-dimensionalstatevectorconsistingofthecompartmentsxk=(cid:2)IkAkEkϕkHkWkDkRk(cid:3)|,(29)kisthetimeindex(daily)andFisgivenexplicitlybyF=1−γIγAF1σF00000001−γAσ(1−F0)00000001−σβ00001−e−ρθA(1−e−ρ)θE(1−e−ρ)e−ρ0000γIF20001−γIγW(1−F4)000000γHF3γW00γIF2d000γHF3dγWF410γI(1−F2−F2d)γA(1−F1)00γH(1−F3−F3d)001.(30)Theparametersinthismatrixaretheonesdescribedintheprevioussections.Notehowtheequationofstatefortheinfectiouspressureϕhasbeenintegratedexplicitly.Animportantpropertyofthismodelisthedistributionofthenoisewk.SinceaPoisson-distributedtransitionhasavarianceproportionaltothenumberofindividualsinthecompartment,theprocessnoiseisstate-dependent.Atermproportionaltothesquaredcompartmentpopulation,representinganuncertaintyinthetransition“ﬂow”,isalsoaddedtothevariance,aswellasaconstant,i.e.,regularizing,term.HenceforatransitionfromastateAtostateBwithrateµ,thenoisecovariancematrixisoftheformQ=Qp+Qv+Q0,(31)withQp=(cid:20)µA−µA−µAµA(cid:21),Qv=(cid:15)(cid:20)(µA)200(µA)2(cid:21),Q0=(cid:20)qA00qB(cid:21),(32)where(cid:15),qAandqBhavepositivevalues.NotethatanegativecorrelationisinducedbythePoisson-noise,whilewedonotintroducesuchtermsforQvnorQ0.TheprocessnoisecovarianceofthefullmodelisthencalculatedbyadditionoftheindividualcontributionsfromalltransitionswhichareencodedinF.Notethatthestateϕisthediscretizationofanordinaryratherthanastochasticdiﬀerentialequation,sotherearenoPoissoniancontributionstothecorrespondingelementsofthecovariancematrix.Inoursetup,(cid:15)=0.052anddiagonalelementsofunityforQ0arechosen,i.e.,correspondingtoprocessnoiseontheorderofsingleindividuals.Themeasuredsignalsaregivenbyyk=Hxk+vk,(33)whereformeasurementsofthestates[H,W,D]|wehaveH=000010000000010000000010(34)Thecomponentsofthemeasurementvkareassumedtobeuncorrelatedandconsistofbothaconstantandastate-dependenttermsothatthecorrespondingcovariancematrixbecomesRk=r0,H+rd,HH2k000r0,W+rd,WW2k000r0,D+rd,DD2k,(35)22wheretheparametervaluesr0,H=r0,W=r0,D=1andrd,H=rd,W=rd,D=0.0012areusedinourmodel.IntheKalmanﬁlter,thecovariancematricesarecalculatedbasedonstateestimatesateveryiteration.Oneshould,however,notethatoptimalityresultsoftheKalmanﬁlteronlyholdwhenthenoiseisGaussianandadditive,i.e.,independentofthestates,sothereisnotheoreticaljustiﬁcationfortheoptimalityoftheKalmanﬁlterinthecurrentsetup.CalculatedresultscanthereforebeunderstoodasanapproximationindensityandtheKalmanmarginallikelihoodisanapproximationtothetruelikelihood.Nonetheless,theﬁlterhasworkedratherconvincinglyinpractice.PosteriorsamplingWhenperformingBayesianinferenceonmodelswithintractablelikelihoodsonecommonapproachisApproximateBayesianComputations(ABC),alsoreferredtoaslikelihood-freeinference[24][25].ThecornerstoneinABCistouseasimulatory∼F(θ)togeneratedata.Thesegenerateddataarethencomparedtotheobserveddataandthe“distance”betweenthemactsasaproxyforthelikelihoodoftheparametergiventheobservation.AﬂavorofABCcalledsyntheticlikelihoods(SL)[26],ﬁndstheproxy-likelihoodbygeneratingmultipledatasamplesperparameterproposal,and,assumingasymptoticnormality,computesthethentractablelikelihoodoftheobservations.InourcaseofusingaKalmanﬁlterestimator,thelikelihoodestimateistheKalmanmarginallikelihood.ThislikelihoodactsinsimilarspiritastheSL,sincetheﬁltercanbeviewedasthelimitofmultiplesimulationsunderaGaussianassumption.However,theanalogyisnotperfectsincetheKalmanﬁlterimplementscorrectionstepsforeachnewdatapoint.WeusetheKalmanLikelihoodintheAdaptiveMetropolisalgorithm(“KLAM”).ThisissimilartotheclassicalMetropolisalgorithmbutwithanadaptiveproposalfunction[27].TheproposalfunctionisamultivariatenormaldistributionwithmeanatthecurrentparameterpointandanadjustablecovariancematrixN(xt−1,Ct),whereCt=(C0,t≤t0scov(x0,...,xt−1)+sεId,otherwise.(36)WeassumeadiagonalinitialcovarianceC0=0.001×Id,forthed-dimensionalidentityId,andwestartadaptingaftert0=10acceptedproposals.Wealsousethestep-lengthtuningparameters=0.05×2.42/d,andweruneachregionparameterposteriorchainforfourparallel5×104samplesresultinginaGelman-Rubinscorebelow1.1,e.g.,=1.01forUppsala.ByusingtheKalmanﬁlterlikelihood,samplesarefasttogenerate.Afullregionalposteriorof2×105(minus1×104asburn-in)isgeneratedinalittleover30minutesonanIntel(4×)Corei7-6820HQCPU@2.70GHz.Theregionalposteriorsarealsosolvedindependentlyofeachother,thusallowingustosampletheminparallelusingMatlab’sparforparallelfor-loop.Afullnationalposteriorcanthusbegeneratedinlittleover12hours.Thefastsamplingismadepossiblenotonlythankstotheﬁlterset-up,butalsothankstothetime-sequentialcharacteroftheproblem.Werepeatedtheinferenceeachweek,andcouldusethepreviousweeks’andregions’posteriorsasinitialguessesforthenewposteriors.DynamicoptimizationsolutionWithposteriorestimatesofβtavailableinfour-weekintervals,wenowexplainfurtherthemethodtoestimatethedailyinfectionrecruitmentβk=β(tk)andasaresultthedailyreproductionnumber.Themethodologyreliesonminimizingthenegativelogarithmiclikelihood.Forthatpurpose,letBdenoteavectorofconsecutiveβt’sasB=(cid:2)β1β2...βK(cid:3)|,(37)and˜Bdenotethecorrespondingestimate.WritingthedependenceonBexplicitly,theoptimizationproblemcanthenbeformulatedas˜B=argminB−‘(K)(B)+c∆B|∆B,(38)where‘(K)(B)denotesthelogarithmicmarginallikelihoodcomputedoverthetimehorizon[1,K],i.e.‘(K)(B)=KXk=112((˜yk(B))|S−1k˜yk(B)+log|Sk|+dylog2π),(39)wherecisapositiveregularizationparameterand∆denotestheﬁrstdiﬀerence.Thesecondpartofthecostfunctionin(38)thusconstitutesaregularizationtermwhichreduceshigh-frequentﬂuctuationsintheestimate.˜ykisthedeviationbetweenmeasurementszkandtheoutputfromthemean-ﬁelddynamicssystem:˜yk=zk−Hxk.(40)23ThereisnocorrectionofthestatefromthemeasurementsasintheKalmanﬁlter,butinsteadthestatexkisgivenbythestatespacemodelxk+1=Fkxk,(41)i.e.,thematrixFkisnowtimevaryingaccordingtoFk=F(βk),(42)wheretheremainingparametersofFkaregivenbythepreviouslyinferredposteriormaximumlikelihoods.Finally,thecovariancematricesSkin(38)arecalculatedfromthelinearﬁlter,againwiththemaximumlikelihoodparametervalues,andincludingβt.Asaresult,theoptimizationcanbeviewedasaquasi-maximumlikelihoodestimation.Here,theparameterβtisestimated,asexpected,toshowthefastesttemporalﬂuctuations,butproblemswithseveralfreeparameterscouldalsobeconsidered,suchastheIFR.Theinitialstatex0,couldalsobeincludedintheoptimizationformulation.TheproblemissolvedusingtheinteriorpointmethodwiththefunctionfminconinMatlab.Includingthewholeoptimizationhorizoninasingleoptimization,however,turnsouttobeverytimeconsumingcomputationally,oreveninfeasiblefortheproblemathand,whenKisoftheorderofseveralhundreds.Forthisreason,anapproachinspiredbytechniquesfromautomaticcontrolisusedtodividetheoptimizationhorizonasdescribedbelow.DividingtheoptimizationhorizonSincethecomplexityoftheoptimizationalgorithmissuperlinearinK,computationalgainscanbemadebydividingtheoptimizationhorizonintoshorterwindows,whicharesolvedindependently.Inourcontext,anadditionalmotiva-tionforthisisthattheproblemissolvedeveryweekasnewdatabecomesavailable,whichmeansthatoptimizationresultsforearliertimewindowspotentiallycouldbereused.However,theresultofconcatenatingoptimizationresultscalculatedovernon-overlappingwindowsdoesnotcoincidewiththesolutiontothefulloptimization(38),duetoend-of-horizoneﬀects,i.e.,thattheβt-estimatestowardtheendofonetimewindowdotakedataoutsidethewindowintoaccount.Inspiredbythemethodologyofmodelpredictivecontrol(MPC),wethereforeutilizeoverlappingop-timizationwindows.Morespeciﬁcally,timesteps∆k=ki+1−kiareusedtoiterateovertheoptimizationhorizon,correspondingtothesamplingtimesinMPC,andateachstep,anoptimizationoftheform(38)issolved,butoverahorizon[ki,ki+Kp],where∆k<Kp<K.ThishorizoncorrespondstothepredictionhorizoninMPC.Thecalculatedvaluesofβkfork∈[ki,ki+1]arethenusedtobuildthevector˜B.AssumingthatforasuﬃcientlylargeK0,measurementsattimesκ0+L,L≥K0havenegligibleeﬀectonthevaluesoftheoptimalβk,k≤κ0,wearethusabletoreplacetheoptimizationproblem(38)withasequenceofoptimizationproblemsoftheform˜Bi=argminBi−ki+1Xk=ki12(((˜yk(Bi))|S−1k˜yk(Bi)+log|Sk|+dylog2π)+c∆B|i∆Bi,(43)where˜Btheniscreatedbyconcatenatingtheﬁrst∆kelementsofeach˜Bi(exceptforthelast˜Biwhichisusedinitsentirety).Noticethatconstraintsneedtobeaddedtotheoptimizationstoensure“continuity”of˜B,i.e.thattheregularizationisemployedalsoacrossthelimitsofthetimewindows.Inourcase,apredictionhorizonof150daysandasteplengthof20dayswasused.Fortypicaldatasets,thereisthennodiscerniblediﬀerencebetweentheoptimalsolutionforthefullhorizonandthecombinationofthesolutionstothesmallerproblems.InFig.13,thisisillustratedfortheestimationofβtfromoneyearofdatafromUppsala.Thesolutiontimewiththedividedoptimizationisshorter;approximatelysevenminutesinsteadoftenonastandardmodernlaptop.Thisdiﬀerenceincreaseswiththelengthofthetotaltimehorizon.AdditionalevaluationsPosteriorrobustnessThecomputedposteriorinFig.2isthepopulationweightedposteriorwhencombiningthesamplesfromSweden’s21regions.InFig.14wedisplaythemeanposterior±1standarddeviationforeachregion.Theresultsagreewellacrossthisnaturalbootstrappopulationalbeitwithafewoutliers.BootstraprobustnessBythebootstrapprocedurepresentedinMaterialandMethods,wecaninvestigatetheposteriorrobustness,includingestimatingthebiasduetotheapproximatelikelihood.Theinferenceprocedureisrepeatedonasyntheticdatasetgeneratedbythemeanposteriorestimateandwiththetemporalresolutionupscalingprocedureforβt.InFig.15we24Figure13:Estimatedβtwithonebatchoptimizationversusdividingthehorizon.Forthelattermethod,thediscarded“tails”ofeachoptimizationwhicharecausedbytheend-of-horizoneﬀectarevisible.Figure14:Posteriormean±1standarddeviationperparameterandacross21Swedishregions.ForthedynamicparametersRtandIFR,thetemporalaverageisdisplayed.25Figure15:Fullysyntheticsimulationsforafewselectedregionswithparametersfromthenationalmeanposterior,butwithupscaledregionalβt.Thelinesoflightershadesofblueandredarerealizationsandthesolidlinesarethemeanofthesamples.Thepointsarethedatapointsusedintheinference.display25suchreplicatesforafewselectedregions.Notethatthesewereobtainedinacompletelyoﬀ-linefashionandarenevercorrectedagainstdata.Foreachregionr=1,...,21andparameterdimensionk=1,...,Kintheposteriorweestimatethebias˜br,k,asperthedescriptioninMaterialandMethods.Thedynamicparametersareheretreatedasasingleparameter,thatis,withasingleaveragebias,andtogetherwiththestaticparametersthereareK=12intotal.WecomputethreestatisticsT=[T1,T2,T3]tocharacterizethespread:thecoeﬃcientofvariation(CoV),thecoeﬃcientofbias(CoB),andthenormalizedroot-mean-squareerror(NRMSE),Tk,r,1=CoV=σk,r/µk,r,Tk,r,2=CoB=|˜bk,r|/µk,r,Tk,r,3=NRMSE=r(cid:16)σ2k,r+˜b2k,r(cid:17)/µk,r,(44)forthestandarddeviationσk,r,themeanµk,r,andtheestimatedbias˜bk,r.InTab.6,wepresentthemedianvalueperregionandstatistics∈{1,2,3}overtheKparameters,¯Tr,s=MediankTk,r,s.(45)Wevisualizeboththedataposteriorandtheaggregateofallbootstrapreplicateposteriors(n=3)inFig.16.WealsocomparethedailyRtestimateoftheactualdataposteriorandtheaveragefromthebootstrapreplicatesforUppsalainFig.17.BaselinepredictorToevaluatethepredictiveperformanceofourKalmanﬁltermodeloutsideofamodelvacuum,wecomparetoanautoregressivemodel(AR)model.ARmodelsarecommonintime-seriespredictions,andforCOVID-19,ARmodelswithauxiliaryindicatorsshowsigniﬁcantpredictionpower[28].Weconsiderasingle-dayforwardexpandingdatawindowforwhichweﬁttheARmodelonalldatainthewindowandpredict7daysahead.Thisprocedureisevaluatedacrossthesamedataasusedinourlivereports(N=25).26Table6:Medianuncertaintystatisticperregion:CoV,CoB,andNRMSEasinEqs.(44)–(45).Thesmoothingdiﬀerencedsmoothisthemeanmaxrelativediﬀerencebetweenthepre-processedandrawdata[H,W,D]asdeﬁnedin(6).RegionCoV[%]CoB[%]NRMSE[%]dsmooth[%]PopulationStockholm6.34.9126.62.4·106Uppsala132.6156.63.8·105Sodermanland152.0188.13.0·105Ostergotland134.3197.34.7·105Jonkoping142.4184.73.6·105Kronoberg144.0246.92.0·105Kalmar163.4235.12.5·105Gotland293.2322.26.0·104Blekinge183.130131.6·105Skane123.6135.91.4·106Halland162.4249.63.3·105VastraGotaland113.9146.21.7·106Varmland183.5257.72.8·105Orebro142.6209.43.0·105Vastmanland155.4244.42.8·105Dalarna143.6245.72.9·105Gavleborg142.7224.82.9·105Vasternorrland142.8244.32.5·105Jamtland224.128131.3·105Vasterbotten202.023102.7·105Norrbotten182.6264.52.5·105Figure16:Populationweightednationalaverageposteriorusing:actualdata(blue)orbootstrappeddata(green),foraselectedsetofparameters.Bothposteriorsusethesameprior(red).Theverticallinesindicatethedensitymeans:posterior(bluesolid),prior(reddashed),andbootstrappedposterior(greendotted).Themeanisalsoannotatedinthecorrespondingcolorfortheposteriorestimates.27Figure17:ReproductionnumberestimatesfortheUppsalaregionwithbootstrapreplicas.TheBayesianposterioronthetruedatayieldsmonthlyestimates(bluebox-plot)whilethequasi-MLestimatorisdaily(redsolid).Theaggregateposteriorofthebootstrapreplicates[n=3](greenbox-plot)andtheaveragedailyquasi-MLestimator(reddashed)fromthebootstrapreplicates.AstheKalmanﬁlter,theARmodelalsouses[H,W,D]asobservations.WeuseMatlab’sarximplementationoftheARmodel,formallycalledVectorARmodelwithExogenousVariables.Thepolynomialordersanddelaysaresetfromﬁndinggoodpredictionsinameansquareerrorsenseontheﬁrst50daysofthedataset.Wetunenbandncbyhand,andproposedvaluesfornabyapartialautocorrelationfunctionplotperdatadimensions.WeﬁndtheorderoftheAqpolynomials:na=[1,1,1]|,theBqpolynomials:nb=[0,1,0]|,andtheinput-outputdelay:nc=[1,1,1]|tobeclosetooptimalchoices.InFig.18,wevisualizethe7-dayaheadpredictionmadebytheARmodelforUppsala.InTab.7,wepresenttherespectivepredictionprecisionbyNRMSEandmultivariateEnergyscore[29]ofthetwomodelsalongwitharepetitionoftheresultsfromTab.1.AcloserinspectionrevealsthatthesimplermodelshaveasmallerNRMSEandEnergyScorethantheposteriorKalmanﬁlterbutwithoverlypessimisticCrIs.ThesimpleARmodelgeneratesgoodmean-squarepredictionsinafractionofthetrainingtimeofourposteriorKalmanﬁlterandcouldlikelybeimprovedabitwhenitcomestothewidthoftheconﬁdenceintervalestimate,reducingtheEnergyscorefurther.Thegreatadvantagewithourapproachliesinsteadinthefactthattheposteriormodelitselfcanbedisassembledandcontainsvaluableepidemiologicalinformation.Table7:Frequencyofallweeklyreportedpredictions(N=25,Dec2020–May2021)forUppsalathatfellinsideofthereportedCrIs(68/95%,7daysahead),theNRMSE,andthemultivariateEnergyScoreevaluatedonthefollowingweek,thuscomparingtheperformanceoftheposteriorKalmanﬁlterandtheARmodel.Hospital(H)Intensive(W)Death(D)PosteriorKalman(68%CrI)767268AR10010044PosteriorKalman(95%CrI)10010096AR10010092PosteriorKalman(NRMSE)25271.9AR4.7121.4PosteriorKalman(Energyscore)841530AR187.12428Figure18:Resultfromthe7-dayaheadARpredictionfortheUppsalaregionwith68%CrI(shaded).Thelivereporting(N=25)forTabs.1and7wasdoneinthereportingperiodindicatedtowardsthesecondhalf.References[1]SverigesKommunerochRegioner.Meddelandefr˚anstyrelsen-¨OverenskommelsemellanStatenochSverigesKom-munerochRegionerom¨okadnationelltestningochsmittsp˚arningf¨orcovid-192021.https://skr.se/download/18.32563d7d1784aa279ece298a/1618741812524/WEBB-17-OK-Staten-SKR-Covid-19.pdf,2021.Online;ac-cessed2022-04-01.[2]c19.se.https://c19.se/compare,2020.Online;accessed2022-04-01.[3]Folkh¨alsomyndigheten.Bekr¨aftadefallavcovid-19isverige.https://www.arcgis.com/sharing/rest/content/items/b5e7488e117749c19881cce45db13f7e/data,2020.Online;accessed2022-04-01.[4]Socialstyrelsen.Avlidnaochcovid-19.https://www.socialstyrelsen.se/statistik-och-data/statistik/statistik-om-covid-19/statistik-over-antal-avlidna-i-covid-19/,2020.Online;accessed2022-02-09.[5]Socialstyrelsen.V˚ardochcovid-19.https://www.socialstyrelsen.se/statistik-och-data/statistik/statistik-om-covid-19/statistik-om-slutenvard-av-patienter-med-covid-19/,2020.Online;accessed2022-02-09.[6]SvenskaIntensivv˚ardsregistret.Mortalitet30dagar,Coronafall.https://portal.icuregswe.org/siri/en/report/corona.mort?filter=d5d1d908-cd6a-8db0-e5ec-8c76b834d20,2020.Online;accessed2022-02-09.[7]Folkh¨alsomyndigheten.Aktuelltreproduktionstal(R-tal).https://www.folkhalsomyndigheten.se/smittskydd-beredskap/utbrott/aktuella-utbrott/covid-19/statistik-och-analyser/analys-och-prognoser/,2021.Online;accessed2022-01-13.[8]Folkh¨alsomyndigheten.P˚avisningavantikropparmotSARS-CoV-2(1)iblodprovfr˚an¨oppenv˚arden,(2)hosblodgivare.https://www.folkhalsomyndigheten.se/contentassets,2021.[9]XCastroDopico,SMuschiol,MChristian,LHanke,DJSheward,NFGrinberg,JRorbach,GBogdanovic,GMMcinerney,TAllander,etal.SeropositivityinblooddonorsandpregnantwomenduringtheﬁrstyearofSARS-CoV-2transmissioninStockholm,Sweden.J.Intern.Med.,2021.[10]StatistikmyndighetenSCB.Antalpendlareperl¨anochkommun,2018.https://www.scb.se/hitta-statistik/statistik-efter-amne/arbetsmarknad/sysselsattning-forvarvsarbete-och-arbetstider/registerbaserad-arbetsmarknadsstatistik-rams/pong/tabell-och-diagram/antal-pendlare-per-lan-och-kommun-2018,2019.Online;accessed2020-03-22.29[11]StatistikmyndighetenSCB.Sverigesbefolkningspyramid.https://www.scb.se/hitta-statistik/sverige-i-siffror/manniskorna-i-sverige/sveriges-befolkningspyramid,2020.Online;accessed2020-04-08.[12]AdamAltmejd,JoacimRockl¨ov,andJonasWallin.NowcastingCovid-19statisticsreportedwithdelay:acase-studyofSweden.arXivpreprintarXiv:2006.06840,2020.[13]RoyMAndersonandRobertMMay.Thepopulationdynamicsofmicroparasitesandtheirinvertebratehosts.Philos.Trans.R.Soc.,291(1054):451–524,1981.[14]StefanEngblomandStefanWidgren.Data-drivencomputationaldiseasespreadmodeling:frommeasurementtoparametrizationandcontrol.InDiseaseModelingandPublicHealth:PartA,volume36ofHandbookofstatistics,chapter11,pages305–328.Elsevier,2017.[15]WafaDhouib,JihenMaatoug,ImenAyouni,NawelZammit,RimGhammem,SihemBenFredj,andHassenGhannem.TheincubationperiodduringthepandemicofCOVID-19:asystematicreviewandmeta-analysis.Syst.Rev.,10(1):1–14,2021.[16]AndrewWilliamByrne,DavidMcEvoy,AineBCollins,KevinHunt,MiriamCasey,AnnBarber,FrancisButler,JohnGriﬃn,ElizabethALane,ConorMcAloon,etal.InferreddurationofinfectiousperiodofSARS-CoV-2:rapidscopingreviewandanalysisofavailableevidenceforasymptomaticandsymptomaticCOVID-19cases.BMJOpen,10(8):e039856,2020.[17]LucaFerretti,ChrisWymant,MichelleKendall,LeleZhao,AnelNurtay,LucieAbeler-D¨orner,MichaelParker,DavidBonsall,andChristopheFraser.QuantifyingSARS-CoV-2transmissionsuggestsepidemiccontrolwithdigitalcontacttracing.Science,368(6491):eabb6936,2020.[18]MulunehAlene,LelteworkYismaw,MogesAgazheAssemie,DanielBekeleKetema,BelaynehMengist,BekaluKassie,andTilahunYemanuBirhan.MagnitudeofasymptomaticCOVID-19casesthroughoutthecourseofinfection:Asystematicreviewandmeta-analysis.PloSONE,16(3):e0249090,2021.[19]NBrazeau,RobertVerity,SaraJenks,HanFu,CharlesWhittaker,PeterWinskill,IlariaDorigatti,PatrickWalker,StevenRiley,RicardoPSchnekenberg,etal.Report34:COVID-19infectionfatalityratio:estimatesfromseroprevalence.https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/covid-19/report-34-ifr/,2020.[20]Folkh¨alsomyndigheten.TheinfectionfatalityrateofCOVID-19inStockholm–technicalreport.https://www.folkhalsomyndigheten.se/contentassets,2021.Online;accessed2022-01-21.[21]NeeltjeVanDoremalen,TrentonBushmaker,DylanHMorris,MyndiGHolbrook,AmandineGamble,BrandiNWilliamson,AzaibiTamin,JenniferLHarcourt,NatalieJThornburg,SusanIGerber,etal.AerosolandsurfacestabilityofSARS-CoV-2ascomparedwithSARS-CoV-1.N.Engl.J.Med.,382(16):1564–1567,2020.[22]YousefAlimohamadi,MaryamTaghdir,andMojtabaSepandi.EstimateofthebasicreproductionnumberforCOVID-19:asystematicreviewandmeta-analysis.J.Prev.MedPublicHealth,53(3):151,2020.[23]KristoﬀerStr˚alin,ErikWahlstr¨om,StenWalther,AnnaMBennet-Bark,MonaHeurgren,ThomasLind´en,Jo-hannaHolm,andH˚akanHanberger.MortalitytrendsamonghospitalisedCOVID-19patientsinsweden:anationwideobservationalcohortstudy.TheLancetRegionalHealth-Europe,4:100054,2021.[24]Jean-MichelMarin,PierrePudlo,ChristianPRobert,andRobinJRyder.ApproximateBayesiancomputationalmethods.Stat.Comp.,22(6):1167–1180,2012.[25]ScottASisson,YananFan,andMarkBeaumont.HandbookofapproximateBayesiancomputation.CRCPress,2018.[26]SimonNWood.Statisticalinferencefornoisynonlinearecologicaldynamicsystems.Nature,466(7310):1102–1104,2010.[27]HeikkiHaario,EeroSaksman,andJohannaTamminen.Anadaptivemetropolisalgorithm.Bernoulli,7(2):223–242,2001.[28]DanielJMcDonald,JacobBien,AldenGreen,AddisonJHu,NatDeFries,SangwonHyun,NataliaLOliveira,JamesSharpnack,JingjingTang,RobertTibshirani,etal.CanauxiliaryindicatorsimproveCOVID-19forecastingandhotspotprediction?Proc.Natl.Acad.Sci.U.S.A.,118(51),2021.[29]TilmannGneiting,LarissaIStanberry,EricPGrimit,LeonhardHeld,andNicholasAJohnson.Assessingprobabilisticforecastsofmultivariatequantities,withanapplicationtoensemblepredictionsofsurfacewinds.TEST,17(2):211–235,2008.30SupportingInformation:BayesianMonitoringofCOVID-19inSwedenRobinEriksson1,StefanEngblom∗1,H˚akanRunvik2,andAlexanderMedvedev21DivisionofScientiﬁcComputing,DepartmentofInformationTechnology,UppsalaUniversity,SE-75105Uppsala,Sweden.2DivisionofSystemsandControl,DepartmentofInformationTechnology,UppsalaUniversity,SE-75105Uppsala,Sweden.∗Correspondingauthor:S.Engblom,telephone+46-18-4712754,fax+46-18-511925.1arXiv:2205.00859v3  [stat.AP]  1 Jun 2022SupportingInformation:BayesianMonitoringofCOVID-19inSwedenThissupplementcontainsfurtherexplanationsanddetailsofthedata,themodel,andthecomputationalmethodology,aswellassomeadditionalresultsmentionedinthemainarticle.TheSIisorganizedinsectionsasfollows:Additionalsupportingresults•Incidence:ourmodel’sestimateoftheincidenceofsymptomaticcasescomparedtothenumberofconﬁrmedcasesbyPHAinStockholm(complementingtheUppsalacasesinthemainarticle).Thisalsoproducesanestimateoftheproportionofundetectedsymptomaticcases.•Rt-estimators:foraselectionofsmallandlargeregions.DataAsummaryofthevarioussourcesanduseofdata.CompartmentmodelOurextendedSEIR-modelindetail,includinganexplanationofallmodelparameters.PriorsTheparameterpriorsforthemodelandhowtheyweredetermined.KalmanﬁlterThelinearﬁlterapproximationofthecontinuous-timeMarkovchain,whichinturnisourprobabilisticunderstandingoftheextendedSEIR-model.PosteriorsamplingDetailsoftheMetropolissamplingprocedure.DynamicoptimizationsolutionTheprocedurefor‘bootstraponthemargin’toimprovethetemporalresolutionofthereproductionnumberestimator.Additionalevaluations•Posteriorrobustness:Acomparisonofthe21regionalposteriors,whichthusformanaturalbootstrappopulation.•Bootstraprobustness:Theestimatedbiasandsomeadditionalqualitystatisticsforthe21regionalposteriors.•Baselinepredictor:AcomparisonofthepredictionofourKalmanﬁlterandasimplerregressionestimator.ReproducibilityThecodeaswellasthedatarequiredforreproducingtheresultsinthepaperarepubliclyavail-ableandcanbedownloadedatgithub.com/robineriksson/Bayesian-Monitoring-of-COVID-19-in-Sweden.RefertotheincludedﬁleREADME.mdformoreinformation.AdditionalsupportingresultsIncidenceestimates:acomparisonbetweenmodel-andtest-basedresultsInthemainpaper,weillustratehowtheposteriormodelcanestimatetheincidenceofsym-pomaticcases,whichisahiddenstateandthusdoesnotcorresponddirectlytodata.Here2wedisplaythecorrespondingestimatesforStockholm,seeFig.1.Thereportedtestsaresmoothedbya7-daySavitzky-Golayﬁlterandtheestimateduncertaintyisthecorrespond-ingrollingstandarddeviation.Aftertestingphase3,theratiobetweenourestimateandthepositivetestsoscillatesaroundone,indicatingthatthetestingatthattimecapturesmostofthesymptomaticinfected.AfterApril2021,ourmodelestimatesasomewhatsmallersymp-tomaticincidencethanwhatwascapturedinactualtests.Apossibleexplanationforthisisthatatsmallerincidence,anincreasingproportionofasymptomaticcasesareincludedinthetestpool,e.g.,fromregularscreeningofhospitalpersonnelandsimilar.ThroughthismethodofexploringthedatawecanalsoconﬁrmourearlysuspicionthattheincidencedatasignalwaspoorduringTestingphase1andinpartduringphase2.ThenoiseinthescreeningdataexplainsthenervousbehaviorofthePHAsreproductionnumberestimatesasseeninFigs.??and2.Atthestartofthesecondwave,andduringTestingphase3,thissignalwasmuchmoreaccuratealbeitathugeeconomicalcosts.Figure1:Left:theestimatedsymptomaticincidencefromourmodel(bluewith[68,95]%CrIshaded)andtheconﬁrmedcasesbyPHA(redline7-daysmoothedanduncertaintyfromrolling±[1,2]standarddeviationshaded,withdataaspoints)forStockholm.Therightaxisgivesthenumberoftestsper100,000inhabitantsperweek(dashed).ThetotalnumberoftestsadministeredduringTestingphase3wasapproximately1,800,000forStockholm.Thedottedverticallinesmarkthestartofnewtestingphasesthataredeﬁnedbypolicychangesaﬀectingthetestingvolumes.Right:theratiobetweenthemodel’ssymptomaticincidenceandtheconﬁrmedcasesincidenceindicatestheproportionofcasesthataremissedbytesting.Rt-estimatorsWeillustratethedailyRt-estimatorsforthethreelargestandthethreesmallest(bypop-ulation)regions:Stockholm,V¨astraG¨otaland,Sk˚ane(largest),and,respectively,Gotland,J¨amtland,andBlekinge(smallest)inFig.2.Therelativeuncertaintyisvisiblysmallerinthelargerregionsthaninthesmallerones,atypicalsmallpopulationeﬀectasthedatastreamsforthesmallerregionsconsistofsmallercountswithlargeruncertaintiesinarelativesense.3Figure2:Ourdailyreproductionnumberestimate(inred,withboxplotsforeach4-weekconstantposterior)andthepubliclyreportedPHAestimatesfromtheSwedishscreeningprogram(ingrey).Thethreelargestregionsare:Stockholm(topleft)[1,864,000total#ofRT-PCRtestsadministeredduringthe2ndand3rdwaves,August5,2020–May26,2021],V¨astraG¨otaland(topcenter)[1,570,000],andSk˚ane(topright)[1,240,000],followedbytheestimateforthethreesmallestregions:Gotland(bottomleft)[48,440],Blekinge(bottomcenter)[110,300],andJ¨amtland(bottomright)[184,300].ThestandardcostperPCRtestwas1,400SEK(≈$150)[?].4DataThedailyobservationsweuseintheinferenceisretrievedfromc19.seusingPythonscripts.Inturn,c19.sefetchesthedatafromtheoﬃcialregionalsourcesonadailybasis.Swedenhas21regions(Fig.3)thatareinchargeofprovidingforthehealthcareofitspopulation.Theyalsopresentdataonthenumberofhospitalizedpatients,thenumberofpatientsinintensivecare,andthedailynumberofdiseasedbyCOVID-19.Weuseacoupleofotherdatasetsforpriorgenerationandforposteriorvalidation,seeTab.1.ThesetsC19andNBHWDhaddoubleuse,however,thepriorinformationobtainedfromthesewereonanaggregatedlevel.Table1:Summaryofdatasourcesusedforprior,forinference,andforvalidation.NameDescriptionTime-seriesRegionalUseSourceC19Collectionofregionalreports(H,W,D)YesYesPrior,Inference[?]PHAIncidenceofconﬁrmedcases(Iinc)YesYesValidation[?]NBHWDTotal#ofdeaths(DI,DH,DW)NoNoPrior,Validation[?]NBHWγRecoverytimesathospitalandICUNoNoPrior[?]SIRD#ofdeathsasICU(DW)YesYesPrior[?]FHMRtEstimatedRtperregionfromIincYesYesValidation[?]FHM1Rec,FHM2RecFHMseroprevalencestudy(1:outpatientcare),(2:blooddonors)NoNoValidation[?]CastroREstimatedRecoveredinStockholmYesNoValidation[?]SCBtransRegionalin-/outcommutingNoNoPrior[?]RegionBlekinge: 159 748Dalarna: 287 795Gävleborg: 287 333Gotland: 59 636Halland: 333 202Jämtland: 130 697Jönköping: 363 351Kalmar: 245 415Kronoberg: 201 290Norrbotten: 250 230Örebro: 304 634Östergötland: 465 214Skåne: 1 376 659Södermanland: 297 169Stockholm: 2 374 550Uppsala: 383 044Värmland: 282 342Västerbotten: 271 621Västernorrland: 245 380Västmanland: 275 634Västra Götaland: 1 724 529Figure3:Swedenisdividedinto21regions.Weﬁndaposteriordistributionforeachoftheindividualregionsaseachregionpublishtheirowndataofobservables.Inthelegendthepopulationsizeofeachregionisgiven(asof9December,2019[?]),whichspansfromthesmallest:Gotland(59,636),tothelargest:Stockholm(2,374,550).5Figure4:ReportsofdeceasedperweekdayovertheperiodApril1,2020–May31,2021fortheStockholmregion.Thesmoothingproce-dureattemptstocorrectforweeklyreportingpatternsintheoriginaldataandbehavessimi-larlytoabootstrapreplicateforthesametimeperiodandregion.Datapre-processingOurmaindatasourceswereupdatedeachdayandincorrectorquestionabledatapointswerecommon.Twoerrorsthatneedtobeaddressedarenextdescribed.Firstly,thereareimpossibleorveryextremeupdates,e.g.,anegativeincidenceorverylargejumps,mostlikelyduetoanaccumulationofdelayedreports,orinsomecasespossiblyinanattempttocorrectearlierreports.Forexample,adelayinthereportingofdeceasedhasbeendescribedintheSwedishdataset[?],andwasthereexplainedas“batch”reporting.Insimilarspirit,therearealsoafewmissingdatapoints.However,theseareallfoundveryearlyoninthedatahistoryandcouldsafelybereplacedwithNaN-values,thussimplyignored.Second,andmoreproblematicfromamodel-basedperspective,isthefactthatpartsofthereportingdisplayastrongperiodiccomponent,thatis,whichisnotsupportedbythemodelandrathermostlikelyaneﬀectofweekdayperiodicity.Thepre-processingofdataisdoneintwosteps.First,weensurethatthereisnonegativeincidencedata.Negativevaluesaredetectedandsetto0,withvaluesbackwardsintimecorrectedina‘reasonable’wayusingasimplelineardecayingmemorykernel,andwiththecorrespondingcumulativecompartmentadjustedaccordingly.Inthisﬁrststepwealsoreplacemissingormanuallyfoundearlyoutliermeasurementswitheitherlinearlyinterpolateddatafromadjacentdays,orusingNaN-values.Thesecondstepinvolvessmoothingthecumulativeﬁeldsandtheincidenceﬁeldstomitigatetheeﬀectsofweeklyperiodiclagsorbatchreporting.Thesmoothingalgorithmremovesunlikelyincidencesbystartingfromthemostextremeoutliers,e.g.,≥[10,9,...,2]standarddeviationsunderaPoissonianapproximation,andspreadsthemoutduringtheperiodbeforeinsuchawayastodampenweekdaydependenciesinreporting.Mostweeklyperiodicityisremovedbythisprocedure,seeFig.4foranexample,andwhateverremainsdoesnotseemtointerferewiththeBayesianinference.Thetotaleﬀectthepre-processinghasonthedatacanbemeasuredinthesenseofthemeanmaximumrelativediﬀerence,dsmooth=N−1tXtmaxi|X(i)smooth−X(i)|(t)max(1,|X(i)(t)|),(1)wherei∈{1,2,3}forcompartmentX∈[H,W,D],i.e.,thethreedatacompartmentsandoversomeperiodoftimeoflengthNt.WereportthismeasurefortheperiodApril1,2000–May31,2021inTab.4.Thepopulationweightednationalaveragediﬀerenceis6.6%.6CompartmentmodelTheextendedSEIRmodelisdepictedinFig.5.Thetransitionsintheﬁgurearemodeledviatransitionratescorrespondingtoexponentiallydistributedwaitingtimesinacontinuous-timeMarkovchaininterpretation.ThecompartmentmodelweconsiderstemsfromtheSISE-model[?](Chap.11).Thismodelcontainsthreestatevariables,[S,I,ϕ].TheﬁrsttwoareintegercompartmentsandaredeﬁnedbytheMarkoviantransitionsSβϕΣ−1−−−−→I,Iγ−→S,(2)withΣ=S+I,thetotalpopulationsize.Susceptibleindividualsturninfectedatarateproportionaltothelocalinfectiouspressureϕ,andinfectedindividualsrecoveratarateγ.Thelastcompartmentϕrepresentstheenvironmentalpathogenloadandfollowsthedynamics[?]ϕ0(t)=θII(t)−ρϕ(t).(3)Infectedindividualsshedthepathogenintotheenvironment,thussourcingtheinfectiouspressure,whichalsodecaysataﬁxedrateβ.TheR0-numberfortheSISE-modelisgivenbyR0=pθIβ/(γρ)suchthatθI=ρisaconvenientnon-dimensionalization.OurextendedSEIR-modelinvolvestwotypesofparameters:ratesandfractions.Theratesare[βt,σ,γI,γA,γH,γW,θA,θE,θI,ρ],andthefractions[F0,F1,F2,F2d,F3,F3d,F4].Wemayfurtherdividetheratesintowaitingtimesandthosegoverningtheinfectiouspressure.Thewaitingtimesareσ,γI,γA,γH,andγW,andareunderstoodastheinverseofthemeantimeanindividualstaysinacertaincompartment,e.g.,themeanrecoverytimeforasymptomaticinfectedisγ−1I.ThetransitionfromStoEdependsonϕandβt.TheinfectiouspressureϕissourcedbytheviralsheddingfromasymptomaticθA,fromexposedθE,andfromsymptomaticindividualsθI,anditdecreasesbytheviraldecayrateρ.Weusethenon-dimensionalizationθI=ρandthescaledvariablesθE=θE∗×ρandθA=θA∗×ρ.ForthismodelthereproductionnumbercanbedeterminedasR0=sβ0(cid:18)θE∗σ+(1−F0)θA∗γA+F0+(1−F0)F1γI(cid:19),(4)andanidenticalrelationholdsfor(Rt,βt).Thefractionparametersdeterminetheprobabilisticfatesofindividualsinacompartmentwithmorethanoneexit.Theyweredeterminedfromdemographicaveragessincethedailydatadidnotcontainthelevelofdetailtosupportage-dependency(cf.thediscussioninMaterialandMethods).7E→I:F0=E2I,(5)A→I:F1=A2I(=0inoursimulations),(6)I→H:F2=HOSP,(7)H→W:F3=ICHOSP,(8)H→D:F3d=SIRMORT×HOSPMORT(9)W→D:F4=SIRMORT,and,(10)I→D:F2d=max(cid:18)0,IFRE2I−(HOSPMORT+ICHOSP)×SIRMORT×HOSP1−ICHOSP×(1−SIRMORT)(cid:19).(11)Theﬁnalrelationisbestexplainedfromthediscussionleadingto(19)below.Theremainingfractionsofthemodelcangenerallybeobtainedbyrequiringthatthetotalsumofalloutgoingfractionsisone.Thatis,thefractionwhichrecoversfromcompartmentXisgivenby1−FX−FXd,whereFXisthefractionthatentersthenextstateinthechainandwhereFXdisthefractionthatdies.Notethatthemodelparameterscoveringfatalities,(F2d,F3d,F4),areobtainedfromthemorenaturalparameters(SIRMORT,HOSPMORT,IFR)viaEqs.(9)–(11).φFigure5:DetailedcompartmentmodelofFig.??withrelatedtransitionrates.Thedashedarrowindicatestheinteractionwiththeenvironmentalcompartmentϕ.NetworkeﬀectfornationalscalesimulationsWedidnotﬁndthatconnectingtheregionsimprovedtheﬁttodataand,intheend,wethereforedecidednottousethistechniqueonaregularbasis.However,sincewediduseitinTab.??andforcompleteness,wedescribebelowhowitwasimplemented.8Thenetworkconnectionisobtainedbyintroducingapriorcommutingfactorλ∈[0.5,1.5]thatallowsforconnectionsbetweentheregions.Thisaﬀectsonlythecalculationsonanationallevel,anditdoessomainlybyaddingsomecorrelationbetweenconnectedregions.ThenetworkisdeﬁnedbyaconnectionmatrixDwhichisa21-by-21squarematrixwithazerodiagonal.Fortheithrow,eachcolumnjcontainstheproportionofindividualscommutingintoregionifromregionj.Inturn,theconnectionmatrixitselfisfoundbyalinearprogrammingformulationonthevolumesofindividualscommutinginandoutpereachregion[?].Ateachforwardstepinthesimulation,theinfectiouspressureϕk=ϕ(tk)isthenupdatedasϕk+1=¯ϕk+1+λ(Dϕk−d(cid:12)ϕk),(12)where¯ϕk+1istheupdateaccordingtoEqs.(23)–(25),i.e.,withoutanynetworkeﬀects,andwheredisthecolumnsumofDand(cid:12)iselement-wisemultiplication.PriorsThepriorknowledgereliedupontoconstructpriorsstemsfromseveralsources.Belowwebrieﬂycommentonthetechniquesandassumptionsusedtoderiveourpriors;eﬀectivesum-mariesarefoundinTabs.2and3.Theprocessofconstructingpriorswasongoingduringthewholeperiodfall2020tolatespring2021.Werevisedthepriorswheneverwebecameawareofnewresearch,whenmorestatisticsbecameavailable,orwedeemedmodeltweaksnecessary.Theﬁnalpriors(arrivedattowardstheendofMay2021)arewhatwediscussbelow.σandγI/γAThemeanincubationtimeσ−1issetto6.2dayswithsupportin[5.4,7],derivedfromthemeanand95%CIgivenin[?].Therecoverytimeforthesymptomaticinfectiousγ−1Iislessknownandwethereforesetthemeanto7days[?][?]withawidersupportof[4,10]days.WeassumesimilaritybetweenasymptomaticandsymptomaticcasesbysettingγA=γI,whichcoversthepriorssuggestedin[?].γHandγWWedeterminethepriorsforhospitalrecoverytimes,γ−1Handγ−1WfromadatasetpublishedbytheNBHW[?],includingthedistributionofexittimesforhospitalpatientswithandwithoutICUcare.Thedatasetisright-tailedcensoredforwaitingtimesover30days,whichaﬀectstheICUpatientrecords.Forγ−1H,weﬁrstmakeaBayesianﬁtofanexponentialdistributiontohospitalcaringtimedata(N=40,507patients)andplaceasomewhatbroaderBetadistributionacrossthecredibleintervalforthehyperparameterthusfound,thisresultsinaBetadistributionofmean8.9andsupporton[8.7,9.1][days].Therecoverytimeunderintensivecare,γ−1W,ismorecomplicatedsincetheavailabledatainvolvesalsonon-ICUcaringtimes.Assumingthepreviouslydeterminedexponentiallydistributedwaitingtimesunderhospitalcare,weﬁrstsubtractedtwosuchwaitingtimes(tomodelpre-andpost-ICUcare,respectively),nextmadeaBayesianexponentialﬁttotheremainingtime(N=4,039patients).Thisﬁtwasjudgedabitworsethanfornon-ICUcaretimeandsoweusedalargerenclosingsupportof[10.8,13.9]withmean12.2[days].E2IThepriorforthefractionE2I(E→I)wastakenfrom[?]:0.75(0.62,0.84)(95%CI),forwhichwedetermineascaledBetadistributionthatﬁtsthemeanandthegivenCIinterval.Theresultingpriordistributionhasmean0.75andsupporton[0.014,1].9IFRTheIFR,i.e.,theeventualfractionofinfectedindividualsthatdies(E→Dinourmodel),isvolatileinthattheIFRdependsstronglyontheagedistributionoftheregionaswellasonthequalityofthehealthcareandthecurrentlydominatingvirusvariant[??].WethereforesettledonascaledBetadistributionwithpositiveskewedandratherwidesupport:0.67%,[0,2].HOSPMORTandSIRMORTThepriorsforthemortalityathospitalandintensivecare(HOSPMORT,SIRMORT)arerecovereddirectlyfrommortalitydatasetslinkedtohospitalizationdeaths[?](N=46,236patientsand5,729diseased)andICUdeaths[?](N=5,744patientsand1,357diseased),andarekeptasﬁxedconstants.ICHOSPToﬁndourpriorfortheproportionofhospitalizedpatientsneedingintensivecare,weusethec19.sedatainaggregateformandextractthepercentiles([0.5,50,99.5]%)ofthequotient[H:W]betweenthenumberofhospitalized-andICUpatientsforalldataavailable.WenextassumearelationoftheformH∼[H:W]×W,(13)forWapproximatelystationaryandthussatisfyingabalancecondition.ThismeansthatWin=γH×H×ICHOSP≈γW×W=Wout.(14)ItthenfollowsthatICHOSP≈γWW/(γHH)∼γW/(γH[H:W]).(15)Transformingthepercentilesof[H:W]accordingly,wethenﬁndaBetadistributionwithsupportonthese([0.065,0.95])andameanatthemedian(0.18).HOSPAtthispointwehavetherelationIFR=[E2I]×IMORT+[H]×HOSPMORT×SIRMORT+[W]×SIRMORT,(16)intermsoftheasymptoticfractionsinfectedwithsymptoms[E2I],underhospitalcare[H],andunderintensivecare[W],andallinrelationtotheexposedpopulationE.Weﬁndtheasymptoticfractions[H]and[W]byconsideringthedynamicsexpressedinFig.5andrecognizingageometricseries,[H]=E2I×HOSP×(1+x+x2+...)=E2I×HOSP/(1−x),(17)withx=ICHOSP×(1−SIRMORT).Similarly,[W]=E2I×HOSP×ICHOSP×(1+x+x2+...)=E2I×HOSP×ICHOSP/(1−x).(18)WethusarriveattherelationIFR=E2I×[IMORT+(HOSPMORT+ICHOSP)×SIRMORT×HOSP/(1−x)].(19)10Wenextﬁndapriorforthefractionofsymptomaticindividualsthatentersthehospital(HOSP)asfollows.ThemodelinitselfrestrictsthedeadsourcecompartmentstoI,H,andW.BythepreviouscalculationsthetotalriskofdeathfromcompartmentIcanbedecomposedintoCFR=IMORT+(HOSPMORT×SIRMORT×HOSP/(1−x))|{z}=:HMORT+(SIRMORT×HOSP×ICHOSP/(1−x))|{z}=:WMORT.(20)ToclosethesystemofequationsweassumetherelationIMORT∼[I:HW]×(HMORT+WMORT),(21)forsomeunknownscaling[I:HW].Connectingwithaggregatedmortalitydatafortotaldeathsfromc19andhospitaldeathsfrom[?],weﬁnd[I:HW]≈0.98whichwesimplytaketobeaBeta-distributionwithsupport[0,2]andmean1.AtthispointweresorttoadirectMonteCarlosimulationof(19)andﬁndsamplesfromHOSPusingHOSP=IFR/E2I(1+[I:HW])×(HOSPMORT+ICHOSP)×HOSP/(1−x)(22)WeﬁtascaledBetadistributionto100,000samplesfromthisdistributionandﬁnallyobtainaBetadistributionwithmean0.033andsupport[0,0.17].θEandθATheviralsheddingfromcompartmentsEandA,θE∗andθA∗,respectively,isassumedtobeuncertainbutbounded.Weassignthesamepriortobothsheddingrates,ascaledBetadistributionwiththemodeat1andsupportin[0,2].Infectioushalf-lifeandρThedecayrateρinϕisdeﬁnedasρ=−log(0.5)×Infectioushalf-life.Thepriorfortheinfectioushalf-lifeistakentobeuniformbetween1and12hours,re-alizedasauniformdistributionbetween1/24and12/24.Thisenclosestheestimatefrom[?]whosuggests3hours.λAsmentioned,wedonotﬁndtheposteriorforthenetworkcouplingλ.ButwedodeﬁneadistributionwhichwekeepﬁxedandsamplefromwhenperformingsomeofourSweden-levelsimulations.WeassumeascaledBetadistributionwithmeanτandsupportτ×[0.5,1.5],whereτ=8/24×5/7.Thisscalingismeanttoachievetheproportionoftimeatworkundernormal(non-pandemic)circumstances.R0LastlywehaveβtwhichweﬁndfromsamplingRtandusingthemap(4).WethereforeplacetheprioronRtinstead,forwhichtheliteratureisplenty.TheRtprioristakenfromR0similarto[?];atruncatedlognormaldistributionwithlogmeanlog(1.3)andlogstandarddeviation0.4,andwithsupport[0,4].PriorpredictiveWeassessthequalityofthepriordistributionthroughsomesamplesfromthepriorpredictivedistribution.Wegenerate7-dayaheadpredictionsusingthesameset-upasinFig.??andillustratetheresultsinFig.6.11Table2:Priordistributionsforthestaticparameters.ParameterPriorMeanDescriptionEmpiricalSourceInferredσB[0.1429,0.1852](2,2.5926)6.2−1Incubationperiod–[?]γIB[0.1,0.25](2,5)7.0−1Infectiousperiod–[?][?]γHB[0.1099,0.1143](3,3)8.9−1HospitalperiodYes[?]γWB[0.0719,0.0922](2,2)12−1IntensivecareperiodYes[?]E2I(E→I)B[0.014,1](52.5614,17.8545)75%FractionE→I–[?]ICHOSP(H→W)B[0.0646,0.9448](2,13.2129)18%FractionH→W(=ICU)Yes[?]HOSP(I→H)B[0,0.1657](2.0274,8.2751)3.3%FractionI→HYes[?][?]θE∗B[0,2](2,2)1.0SourceE→ϕ–ThispaperθA∗B[0,2](2,2)1.0SourceA→ϕ–ThispaperInfectioushalf-lifeU(1/24,12/24)6.5/24Half-lifeofinfectiouspressure–[?]NotinferredγA=γI7.0−1Recoveryperiodforasymptomatic–[?](HOSPMORT)H→D=0.1322←MortalityriskfromHYes[?][?](SIRMORT)W→D=0.2129←MortalityriskfromWYes[?][?]ρ=−log(0.5)×Infectioushalf-life←Infectiouspressureϕdecayrate–Thispaperλ=8/24×5/7×B[0.5,1.5](2,2)8/24×5/7Commutingintensity–ThispaperI→D(11)0.24%Implicitlydeﬁned–ThispaperFigure6:7-dayaheadpredictionwith68%CrI(shaded)using1,000samplesfromthepriordistributionandwithdataforreference(points).SeeFig.??fortheposteriorequivalent.12Table3:Priordistributionsforthedynamicparameters.ParameterPriorMeanDescriptionEmpiricalSourceIFRB[0,0.2](2,4)0.67%Infectionfatalityrate–[?]RtLognormal[0,4](log(1.3),0.4)1.4Eﬀectivereproductionnumber–[?]KalmanﬁltermodelAlinearnoiseapproximationofacontinuous-timeMarkovchain(CTMC)withexponentiallydistributedwaitingtimesbetweenthecompartmentsisemployedintheBayesianmodeling.Undertheassumptionthatthesusceptiblepopulationdecreasesslowly(inarelativesense)comparedtotheotherstatesofthesystem,i.e.,onlyasmallportionofthetotalpopulationisbecominginfectedovershorttimehorizons,thedependenceofthesusceptiblepopulationontheinfectionrateisneglectedandinsteadcapturedimplicitlyviathetime-dependenceof(βt,Rt).Themodelisdiscretizedintime,whichresultsinthelinearstate-spacemodelxk+1=Fxk+wk,(23)wherexkisthe8-dimensionalstatevectorconsistingofthecompartmentsxk=(cid:2)IkAkEkϕkHkWkDkRk(cid:3)|,(24)kisthetimeindex(daily)andFisgivenexplicitlybyF=1−γIγAF1σF00000001−γAσ(1−F0)00000001−σβ00001−e−ρθA(1−e−ρ)θE(1−e−ρ)e−ρ0000γIF20001−γIγW(1−F4)000000γHF3γW00γIF2d000γHF3dγWF410γI(1−F2−F2d)γA(1−F1)00γH(1−F3−F3d)001.(25)Theparametersinthismatrixaretheonesdescribedintheprevioussections.Notehowtheequationofstatefortheinfectiouspressureϕhasbeenintegratedexplicitly.Animportantpropertyofthismodelisthedistributionofthenoisewk.SinceaPoisson-distributedtransitionhasavarianceproportionaltothenumberofindividualsinthecompart-ment,theprocessnoiseisstate-dependent.Atermproportionaltothesquaredcompartmentpopulation,representinganuncertaintyinthetransition“ﬂow”,isalsoaddedtothevariance,aswellasaconstant,i.e.,regularizing,term.HenceforatransitionfromastateAtostateBwithrateµ,thenoisecovariancematrixisoftheformQ=Qp+Qv+Q0,(26)withQp=(cid:20)µA−µA−µAµA(cid:21),Qv=(cid:15)(cid:20)(µA)200(µA)2(cid:21),Q0=(cid:20)qA00qB(cid:21),(27)13where(cid:15),qAandqBhavepositivevalues.NotethatanegativecorrelationisinducedbythePoisson-noise,whilewedonotintroducesuchtermsforQvnorQ0.Theprocessnoisecovari-anceofthefullmodelisthencalculatedbyadditionoftheindividualcontributionsfromalltransitionswhichareencodedinF.Notethatthestateϕisthediscretizationofanordinaryratherthanastochasticdiﬀerentialequation,sotherearenoPoissoniancontributionstothecorrespondingelementsofthecovariancematrix.Inoursetup,(cid:15)=0.052anddiagonalelementsofunityforQ0arechosen,i.e.,correspondingtoprocessnoiseontheorderofsingleindividuals.Themeasuredsignalsaregivenbyyk=Hxk+vk,(28)whereformeasurementsofthestates[H,W,D]|wehaveH=000010000000010000000010(29)Thecomponentsofthemeasurementvkareassumedtobeuncorrelatedandconsistofbothaconstantandastate-dependenttermsothatthecorrespondingcovariancematrixbecomesRk=r0,H+rd,HH2k000r0,W+rd,WW2k000r0,D+rd,DD2k,(30)wheretheparametervaluesr0,H=r0,W=r0,D=1andrd,H=rd,W=rd,D=0.0012areusedinourmodel.IntheKalmanﬁlter,thecovariancematricesarecalculatedbasedonstateestimatesateveryiteration.Oneshould,however,notethatoptimalityresultsoftheKalmanﬁlteronlyholdwhenthenoiseisGaussianandadditive,i.e.,independentofthestates,sothereisnotheoreticaljustiﬁcationfortheoptimalityoftheKalmanﬁlterinthecurrentsetup.CalculatedresultscanthereforebeunderstoodasanapproximationindensityandtheKalmanmarginallikelihoodisanapproximationtothetruelikelihood.Nonetheless,theﬁlterhasworkedratherconvincinglyinpractice.PosteriorsamplingWhenperformingBayesianinferenceonmodelswithintractablelikelihoodsonecommonapproachisApproximateBayesianComputations(ABC),alsoreferredtoaslikelihood-freeinference[?][?].ThecornerstoneinABCistouseasimulatory∼F(θ)togeneratedata.Thesegenerateddataarethencomparedtotheobserveddataandthe“distance”betweenthemactsasaproxyforthelikelihoodoftheparametergiventheobservation.AﬂavorofABCcalledsyntheticlikelihoods(SL)[?],ﬁndstheproxy-likelihoodbygen-eratingmultipledatasamplesperparameterproposal,and,assumingasymptoticnormality,computesthethentractablelikelihoodoftheobservations.InourcaseofusingaKalmanﬁl-terestimator,thelikelihoodestimateistheKalmanmarginallikelihood.ThislikelihoodactsinsimilarspiritastheSL,sincetheﬁltercanbeviewedasthelimitofmultiplesimulationsunderaGaussianassumption.However,theanalogyisnotperfectsincetheKalmanﬁlterimplementscorrectionstepsforeachnewdatapoint.14WeusetheKalmanLikelihoodintheAdaptiveMetropolisalgorithm(“KLAM”).ThisissimilartotheclassicalMetropolisalgorithmbutwithanadaptiveproposalfunction[?].TheproposalfunctionisamultivariatenormaldistributionwithmeanatthecurrentparameterpointandanadjustablecovariancematrixN(xt−1,Ct),whereCt=(C0,t≤t0scov(x0,...,xt−1)+sεId,otherwise.(31)WeassumeadiagonalinitialcovarianceC0=0.001×Id,forthed-dimensionalidentityId,andwestartadaptingaftert0=10acceptedproposals.Wealsousethestep-lengthtuningparameters=0.05×2.42/d,andweruneachregionparameterposteriorchainforfourparallel5×104samplesresultinginaGelman-Rubinscorebelow1.1,e.g.,=1.01forUppsala.ByusingtheKalmanﬁlterlikelihood,samplesarefasttogenerate.Afullregionalposte-riorof2×105(minus1×104asburn-in)isgeneratedinalittleover30minutesonanIntel(4×)Corei7-6820HQCPU@2.70GHz.Theregionalposteriorsarealsosolvedindependentlyofeachother,thusallowingustosampletheminparallelusingMatlab’sparforparallelfor-loop.Afullnationalposteriorcanthusbegeneratedinlittleover12hours.Thefastsamplingismadepossiblenotonlythankstotheﬁlterset-up,butalsothankstothetime-sequentialcharacteroftheproblem.Werepeatedtheinferenceeachweek,andcouldusethepreviousweeks’andregions’posteriorsasinitialguessesforthenewposteriors.DynamicoptimizationsolutionWithposteriorestimatesofβtavailableinfour-weekintervals,wenowexplainfurtherthemethodtoestimatethedailyinfectionrecruitmentβk=β(tk)andasaresultthedailyrepro-ductionnumber.Themethodologyreliesonminimizingthenegativelogarithmiclikelihood.Forthatpurpose,letBdenoteavectorofconsecutiveβt’sasB=(cid:2)β1β2...βK(cid:3)|,(32)and˜Bdenotethecorrespondingestimate.WritingthedependenceonBexplicitly,theoptimizationproblemcanthenbeformulatedas˜B=argminB−‘(K)(B)+c∆B|∆B,(33)where‘(K)(B)denotesthelogarithmicmarginallikelihoodcomputedoverthetimehorizon[1,K],i.e.‘(K)(B)=KXk=112((˜yk(B))|S−1k˜yk(B)+log|Sk|+dylog2π),(34)wherecisapositiveregularizationparameterand∆denotestheﬁrstdiﬀerence.Thesecondpartofthecostfunctionin(33)thusconstitutesaregularizationtermwhichreduceshigh-frequentﬂuctuationsintheestimate.˜ykisthedeviationbetweenmeasurementszkandtheoutputfromthemean-ﬁelddynamicssystem:˜yk=zk−Hxk.(35)15ThereisnocorrectionofthestatefromthemeasurementsasintheKalmanﬁlter,butinsteadthestatexkisgivenbythestatespacemodelxk+1=Fkxk,(36)i.e.,thematrixFkisnowtimevaryingaccordingtoFk=F(βk),(37)wheretheremainingparametersofFkaregivenbythepreviouslyinferredposteriormaximumlikelihoods.Finally,thecovariancematricesSkin(33)arecalculatedfromthelinearﬁlter,againwiththemaximumlikelihoodparametervalues,andincludingβt.Asaresult,theoptimizationcanbeviewedasaquasi-maximumlikelihoodestimation.Here,theparameterβtisestimated,asexpected,toshowthefastesttemporalﬂuctuations,butproblemswithseveralfreeparameterscouldalsobeconsidered,suchastheIFR.Theinitialstatex0,couldalsobeincludedintheoptimizationformulation.TheproblemissolvedusingtheinteriorpointmethodwiththefunctionfminconinMatlab.Includingthewholeoptimizationhorizoninasingleoptimization,however,turnsouttobeverytimeconsumingcomputationally,oreveninfeasiblefortheproblemathand,whenKisoftheorderofseveralhundreds.Forthisreason,anapproachinspiredbytechniquesfromautomaticcontrolisusedtodividetheoptimizationhorizonasdescribedbelow.DividingtheoptimizationhorizonSincethecomplexityoftheoptimizationalgorithmissuperlinearinK,computationalgainscanbemadebydividingtheoptimizationhorizonintoshorterwindows,whicharesolvedindependently.Inourcontext,anadditionalmotivationforthisisthattheproblemissolvedeveryweekasnewdatabecomesavailable,whichmeansthatoptimizationresultsforearliertimewindowspotentiallycouldbereused.However,theresultofconcatenatingoptimizationresultscalculatedovernon-overlappingwindowsdoesnotcoincidewiththesolutiontothefulloptimization(33),duetoend-of-horizoneﬀects,i.e.,thattheβt-estimatestowardtheendofonetimewindowdotakedataoutsidethewindowintoaccount.Inspiredbythemethodologyofmodelpredictivecontrol(MPC),wethereforeutilizeoverlappingoptimizationwindows.Morespeciﬁcally,timesteps∆k=ki+1−kiareusedtoiterateovertheoptimizationhorizon,correspondingtothesamplingtimesinMPC,andateachstep,anoptimizationoftheform(33)issolved,butoverahorizon[ki,ki+Kp],where∆k<Kp<K.ThishorizoncorrespondstothepredictionhorizoninMPC.Thecalculatedvaluesofβkfork∈[ki,ki+1]arethenusedtobuildthevector˜B.AssumingthatforasuﬃcientlylargeK0,measurementsattimesκ0+L,L≥K0havenegligibleeﬀectonthevaluesoftheoptimalβk,k≤κ0,wearethusabletoreplacetheoptimizationproblem(33)withasequenceofoptimizationproblemsoftheform˜Bi=argminBi−ki+1Xk=ki12(((˜yk(Bi))|S−1k˜yk(Bi)+log|Sk|+dylog2π)+c∆B|i∆Bi,(38)where˜Btheniscreatedbyconcatenatingtheﬁrst∆kelementsofeach˜Bi(exceptforthelast˜Biwhichisusedinitsentirety).Noticethatconstraintsneedtobeaddedtotheoptimizationstoensure“continuity”of˜B,i.e.thattheregularizationisemployedalsoacrossthelimitsofthetimewindows.16Figure7:Estimatedβtwithonebatchopti-mizationversusdividingthehorizon.Forthelattermethod,thediscarded“tails”ofeachoptimizationwhicharecausedbytheend-of-horizoneﬀectarevisible.Inourcase,apredictionhorizonof150daysandasteplengthof20dayswasused.Fortypicaldatasets,thereisthennodiscerniblediﬀerencebetweentheoptimalsolutionforthefullhorizonandthecombinationofthesolutionstothesmallerproblems.InFig.7,thisisillustratedfortheestimationofβtfromoneyearofdatafromUppsala.Thesolutiontimewiththedividedoptimizationisshorter;approximatelysevenminutesinsteadoftenonastandardmodernlaptop.Thisdiﬀerenceincreaseswiththelengthofthetotaltimehorizon.AdditionalevaluationsPosteriorrobustnessThecomputedposteriorinFig.??isthepopulationweightedposteriorwhencombiningthesamplesfromSweden’s21regions.InFig.8wedisplaythemeanposterior±1standarddeviationforeachregion.Theresultsagreewellacrossthisnaturalbootstrappopulationalbeitwithafewoutliers.BootstraprobustnessBythebootstrapprocedurepresentedinMaterialandMethods,wecaninvestigatetheposte-riorrobustness,includingestimatingthebiasduetotheapproximatelikelihood.Theinferenceprocedureisrepeatedonasyntheticdatasetgeneratedbythemeanposteriorestimateandwiththetemporalresolutionupscalingprocedureforβt.InFig.9wedisplay25suchrepli-catesforafewselectedregions.Notethatthesewereobtainedinacompletelyoﬀ-linefashionandarenevercorrectedagainstdata.Foreachregionr=1,...,21andparameterdimensionk=1,...,Kintheposteriorweestimatethebias˜br,k,asperthedescriptioninMaterialandMethods.Thedynamicparametersareheretreatedasasingleparameter,thatis,withasingleaveragebias,andtogetherwiththestaticparametersthereareK=12intotal.WecomputethreestatisticsT=[T1,T2,T3]tocharacterizethespread:thecoeﬃcientofvariation(CoV),thecoeﬃcientofbias(CoB),andthenormalizedroot-mean-squareerror(NRMSE),Tk,r,1=CoV=σk,r/µk,r,Tk,r,2=CoB=|˜bk,r|/µk,r,Tk,r,3=NRMSE=r(cid:16)σ2k,r+˜b2k,r(cid:17)/µk,r,(39)17Figure8:Posteriormean±1standarddeviationperparameterandacross21Swedishregions.ForthedynamicparametersRtandIFR,thetemporalaverageisdisplayed.18Figure9:Fullysyntheticsimulationsforafewselectedregionswithparametersfromthenationalmeanposterior,butwithupscaledregionalβt.Thelinesoflightershadesofblueandredarerealizationsandthesolidlinesarethemeanofthesamples.Thepointsarethedatapointsusedintheinference.forthestandarddeviationσk,r,themeanµk,r,andtheestimatedbias˜bk,r.InTab.4,wepresentthemedianvalueperregionandstatistics∈{1,2,3}overtheKparameters,¯Tr,s=MediankTk,r,s.(40)Wevisualizeboththedataposteriorandtheaggregateofallbootstrapreplicateposteriors(n=3)inFig.10.WealsocomparethedailyRtestimateoftheactualdataposteriorandtheaveragefromthebootstrapreplicatesforUppsalainFig.11.BaselinepredictorToevaluatethepredictiveperformanceofourKalmanﬁltermodeloutsideofamodelvacuum,wecomparetoanautoregressivemodel(AR)model.ARmodelsarecommonintime-seriespredictions,andforCOVID-19,ARmodelswithauxiliaryindicatorsshowsigniﬁcantpredic-tionpower[?].Weconsiderasingle-dayforwardexpandingdatawindowforwhichweﬁttheARmodelonalldatainthewindowandpredict7daysahead.Thisprocedureisevaluatedacrossthesamedataasusedinourlivereports(N=25).AstheKalmanﬁlter,theARmodelalsouses[H,W,D]asobservations.WeuseMatlab’sarximplementationoftheARmodel,formallycalledVectorARmodelwithExogenous19Table4:Medianuncertaintystatisticperregion:CoV,CoB,andNRMSEasinEqs.(39)–(40).Thesmoothingdiﬀerencedsmoothisthemeanmaxrelativediﬀerencebetweenthepre-processedandrawdata[H,W,D]asdeﬁnedin(1).RegionCoV[%]CoB[%]NRMSE[%]dsmooth[%]PopulationStockholm6.34.9126.62.4·106Uppsala132.6156.63.8·105Sodermanland152.0188.13.0·105Ostergotland134.3197.34.7·105Jonkoping142.4184.73.6·105Kronoberg144.0246.92.0·105Kalmar163.4235.12.5·105Gotland293.2322.26.0·104Blekinge183.130131.6·105Skane123.6135.91.4·106Halland162.4249.63.3·105VastraGotaland113.9146.21.7·106Varmland183.5257.72.8·105Orebro142.6209.43.0·105Vastmanland155.4244.42.8·105Dalarna143.6245.72.9·105Gavleborg142.7224.82.9·105Vasternorrland142.8244.32.5·105Jamtland224.128131.3·105Vasterbotten202.023102.7·105Norrbotten182.6264.52.5·10520Figure10:Populationweightednationalaverageposteriorusing:actualdata(blue)orboot-strappeddata(green),foraselectedsetofparameters.Bothposteriorsusethesameprior(red).Theverticallinesindicatethedensitymeans:posterior(bluesolid),prior(reddashed),andbootstrappedposterior(greendotted).Themeanisalsoannotatedinthecorrespondingcolorfortheposteriorestimates.21Figure11:ReproductionnumberestimatesfortheUppsalaregionwithbootstrapreplicas.TheBayesianposterioronthetruedatayieldsmonthlyestimates(bluebox-plot)whilethequasi-MLestimatorisdaily(redsolid).Theaggregateposteriorofthebootstrapreplicates[n=3](greenbox-plot)andtheaveragedailyquasi-MLestimator(reddashed)fromthebootstrapreplicates.22Variables.Thepolynomialordersanddelaysaresetfromﬁndinggoodpredictionsinameansquareerrorsenseontheﬁrst50daysofthedataset.Wetunenbandncbyhand,andproposedvaluesfornabyapartialautocorrelationfunctionplotperdatadimensions.WeﬁndtheorderoftheAqpolynomials:na=[1,1,1]|,theBqpolynomials:nb=[0,1,0]|,andtheinput-outputdelay:nc=[1,1,1]|tobeclosetooptimalchoices.InFig.12,wevisualizethe7-dayaheadpredictionmadebytheARmodelforUppsala.InTab.5,wepresenttherespectivepredictionprecisionbyNRMSEandmultivariateEnergyscore[?]ofthetwomodelsalongwitharepetitionoftheresultsfromTab.??.AcloserinspectionrevealsthatthesimplermodelshaveasmallerNRMSEandEnergyScorethantheposteriorKalmanﬁlterbutwithoverlypessimisticCrIs.ThesimpleARmodelgeneratesgoodmean-squarepredictionsinafractionofthetrainingtimeofourposteriorKalmanﬁlterandcouldlikelybeimprovedabitwhenitcomestothewidthoftheconﬁdenceintervalestimate,reducingtheEnergyscorefurther.Thegreatadvantagewithourapproachliesinsteadinthefactthattheposteriormodelitselfcanbedisassembledandcontainsvaluableepidemiologicalinformation.Figure12:Resultfromthe7-dayaheadARpredictionfortheUppsalaregionwith68%CrI(shaded).Thelivereporting(N=25)forTabs.??and5wasdoneinthereportingperiodindicatedtowardsthesecondhalf.23Table5:Frequencyofallweeklyreportedpredictions(N=25,Dec2020–May2021)forUppsalathatfellinsideofthereportedCrIs(68/95%,7daysahead),theNRMSE,andthemultivariateEnergyScoreevaluatedonthefollowingweek,thuscomparingtheperformanceoftheposteriorKalmanﬁlterandtheARmodel.Hospital(H)Intensive(W)Death(D)PosteriorKalman(68%CrI)767268AR10010044PosteriorKalman(95%CrI)10010096AR10010092PosteriorKalman(NRMSE)25271.9AR4.7121.4PosteriorKalman(Energyscore)841530AR187.12424