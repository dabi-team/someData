An Extension of Goldman-Hodgkin-Katz Equations
by Charges from Ionic Solution and Ion Channel Protein

2
2
0
2

g
u
A
4
2

]

M
B
.
o
i
b
-
q
[

1
v
3
9
2
1
1
.
8
0
2
2
:
v
i
X
r
a

Dexuan Xie∗

Abstract

The Goldman-Hodgkin-Katz (GHK) equations have been widely applied to ion
channel studies, simulations, and model developments. However, they are constructed
under a constant electric ﬁeld, causing them to have a low degree of approximation in
the prediction of ionic ﬂuxes, electric currents, and membrane potentials. In this paper,
the equations are extended from the constant electric ﬁeld to the nonlinear electric ﬁeld
induced by charges from an ionic solution and an ion channel protein. The extended
GHK equations are also shown to include the classic GHK equations as special cases.
Furthermore, a novel numerical quadrature scheme is developed to estimate one major
parameter, called the extension parameter, of the extended GHK equations in terms
of a set of electrostatic potential values. To this end, the extended GHK equations
become a bridge between the “macroscopic” ion channel kinetics (i.e.
ionic ﬂuxes,
electric currents, and membrane potentials) and the “microscopic” electrostatic poten-
tial values across a cell membrane. Developing methodologies and computational tools
for generating a set of required electrostatic potential values becomes one important
research topic in the application of the extended GHK equations. One natural way
to do so is to use a numerical solution of the one-dimensional Poisson-Nernst-Planck
ion channel model that has been used to construct the extended GHK equations. In
this paper, a nonlinear ﬁnite element iterative scheme for solving this model is devel-
oped and implemented as a Python software package. This package is then used to do
numerical studies on the extended GHK equations, the numerical quadrature scheme,
and the nonlinear iterative scheme. Numerical results conﬁrm the importance of con-
sidering charge eﬀects in the calculation of ionic ﬂuxes. They also validate the high
numerical accuracy of the numerical quadrature scheme, the fast convergence rate of
the nonlinear iterative scheme, and the high performance of the software package.

1

Introduction

The Goldman-Hodgkin-Katz (GHK) equations include three equations, called the GHK ﬂux,
electric current, and voltage equations, for the calculation of ionic ﬂuxes, electrical currents,
and membrane potentials across a cell’s membrane, respectively [7, 13, 17]. They were de-
rived by David E. Goldman and Nobel laureates Alan Lloyd Hodgkin and Bernard Katz in

∗Department of Mathematical Sciences, University of Wisconsin-Milwaukee, Milwaukee, WI 53201, USA.

E-mail address: dxie@uwm.edu.

1

 
 
 
 
 
 
(a) Selection 1

(b) Selection 2

Figure 1: Two typical selections of the ion channel interval [0, L] for the 1D PNPic model
(1).

the 1940s [12, 14]. Since then, many studies have been done on the equations, along with
a number of modiﬁed GHK equations, making them to become one of the most successful
achievements in electrophysiology [4, 6, 9, 10, 15, 16, 21, 22]. As one basic tool for cell mem-
brane study, the GHK equations have been included in most textbooks on electrophysiology
(e.g. [7, 13, 17]).

Charges from an ionic solution and an ion channel protein can induce a strongly nonlinear
electric ﬁled and in turn signiﬁcantly aﬀect ionic ﬂuxes, electrical currents, and membrane
potentials. However, the GHK equations hold only for a constant electric ﬁled since they do
not consider any charge eﬀect within an ion channel pore. Thus, they may have a low degree
of approximation accuracy in the prediction of ionic ﬂuxes, electrical currents, and voltages
across a cell membrane. Even so, they are still widely applied to various ion channel studies,
simulations, and model developments because they establish the connections of ionic ﬂuxes,
currents, and voltages with intracellular and extracellular concentrations and a membrane
potential in algebraic expressions.

For example, in a mitochondrial dynamical system reported in [1, 5], the GHK ﬂux
equation is used to connect the concentrations from the inside of an inner mitochondrial
membrane (IMM) with those from the outside of the IMM. To this end, intracellular and
extracellular concentration can be treated as the variable functions of the dynamical system.
Clearly, this dynamical system can be improved if the GHK ﬂux equation is replaced by a
modiﬁed GHK ﬂux equation workable for a nonlinear electric ﬁeld. Unfortunately, no such
modiﬁed GHK equations existed currently.

On the other hand, lots of work was done on Poisson-Nernst-Planck ion channel (PNPic)
models (e.g. see [8, 11, 18, 20] for one-dimensional (1D) PNPic models and [3, 24, 23] for
recent 3D PNPic models). Although they have a higher degree of accuracy than the GHK
equations in the numerical calculation of ionic ﬂuxes, electric currents, and voltages, these
PNPic models cannot be used to substitute any GHK equation since they do not provide
any algebraic formula similar to a GHK equation. Hence, extending GHK equations from
a constant electric ﬁeld to a nonlinear electric ﬁeld remains an open research problem. We

2

intend to solve it in this work.

To do so, we revisit the derivation of GHK equations based on a typical 1D PNPic
model (see (1) for its deﬁnition). We observe that one key step in the derivation of the
In this
GHK ﬂux equation is to treat the electric ﬁeld as a known coeﬃcient function.
way, a Nernst-Planck boundary value problem can be generated from the PNPic model and
then solved analytically to obtain an algebraic formula for estimating ionic ﬂux in terms of
ionic concentration boundary values. However, expressing its solution, an ionic concentration
function, in an analytical expression is diﬃcult unless the electric ﬁeld is set as a constant, as
is done in the derivation of the GHK ﬂux equation. In this work, we overcome the diﬃculty
through introducing a new parameter, called the extension parameter, to account for the
charge eﬀects from an ionic solution and an ion channel protein. To this end, extending the
GHK equations to a nonlinear electric ﬁeld becomes possible.

Remarkably, we ﬁnd that the extension parameter can be expressed as a deﬁnite integral
of a composite function, eZiu, over an ion channel pore interval (see (21) for details). Here, Zi
denotes the charge number of ionic species i and u is a dimensionless potential function of the
electric ﬁeld. For a constant electric ﬁeld, u is simply a linear function. Thus, the extension
parameter can be determined exactly. We can then reduce our extended GHK equations
to the classic GHK equations. In this sense, the classic GHK equations can be regarded as
special cases of our extended GHK equations. However, in the general case, we only can
calculate the extension parameter approximately using a numerical quadrature. While there
exist several numerical quadratures including the composite trapezoidal rule that can work
for such a calculation [2], in this work, we will develop a new numerical scheme according to
the composite property of the integrand function eZiu. That is, we approximate u, instead
of the integrand function eZiu, as a piecewise linear interpolation function. In this way, the
integral expression of the extension parameter can be rewritten as a sum of the sub-integrals
that can be evaluated exactly. Clearly, our new numerical scheme can have a higher degree of
numerical accuracy than the corresponding composite trapezoidal rule since its truncation
error comes from a piecewise linear approximation of u only. In contrast, the truncation
error of the composite trapezoidal rule comes from the integrand function eZiu.

Since a set of electrostatic potential function values is required by our new scheme, we
need a methodology for its generation. One natural way for us to do so is to use a numerical
solution of a 1D PNPic model. By far, several diﬀerent 1D PNPic modes were developed
and solved numerically (see [8, 11, 18, 20] for examples), which can be used to generate the
required electrostatic potential function values. However, we could not ﬁnd their software
packages from the public domain. Thus, we have to develop our own software package in
order to carry out an initial study on our extended GHK equations. This turns out to
be one important part of this work. To do so, we will develop a nonlinear ﬁnite element
iterative scheme for solving the 1D PNPic model that we have used in the construction of
our extended GHK equations based on our recent 3D PNPic work [3, 24, 23]. We then will
implement it in Python as a software package based on the state-of-the-art ﬁnite element
library from the FEniCS project [19]. With our package, we will do numerical tests to conﬁrm
the high numerical accuracy of our specially designed numerical quadrature, to demonstrate
a fast convergence rate of our ﬁnite element iterative scheme, and to show the importance
of considering charge eﬀects in the calculation of ionic ﬂuxes.

The remaining part of this paper is organized as follows: In Section 2, we revisit the

3

GHK equations. In Section 3, we present our extended GHK equations. In Section 4, we
present our new numerical quadrature. In Section 5, we present our 1DPNPic ﬁnite element
solver. In Section 6, we report numerical results. Finally, conclusions are made in Section 7.

2 Revisit of Goldman-Hodgkin-Katz equations

We set a normal direction of the membrane in the z-axis direction of a 3D coordinate system,
following what we did in our previous work [3, 24, 23]. We then deﬁne a dimensionless
electrostatic potential density function, u, and an ionic concentration function, ci, of species
i as functions of one variable, z, on an interval 0 ≤ z ≤ L by a 1D PNPic model as follows:

−(cid:15)s

e2
c
(cid:15)0kBT

d2u
dz2 =
(cid:20)

Zici(z)

i=1
du(z)
dz

Di

d
dz
u(L) = uL,

n
(cid:88)

Zici(z) + ρ(z),

0 < z < L,

(cid:21)

+

dci(z)
dz

= 0,

0 < z < L,

u(0) = u0,

ci(0) = ci,0,

ci(L) = ci,L,

i = 1, 2, . . . , n,

(1a)

(1b)

(1c)

where ρ denotes a permanent charge function; Di is a diﬀusion constant of species i; n is
the number of species in an ionic solution; (cid:15)s denotes the water permittivity constant; (cid:15)0 is
the permittivity of the vacuum; ec is the elementary charge; kB is the Boltzmann constant;
T is the absolute temperature; Zi denotes the charge number of ionic species i; and u0,
uL, ci,0, and ci,L are the boundary values of u and ci, respectively. Here, (1a) is called a
Poisson equation, (1b) a steady Nernst-Planck equation, and (1c) the Dirichlet boundary
value conditions.

Two typical selections of the interval [0, L] are illustrated in Figure 1. Here, L is the
length of a portion of the ion channel pore, the end number 0 is set inside the cell, and
L outside the cell. In Selection 1, the interval [0, L] corresponds to an ion-selectivity ﬁlter
of an ion channel protein. In this case, the charge function ρ can be positive for an anion
selectivity ﬁlter or negative for a cation selectivity ﬁlter.

The dimensionless potential u can be changed to an electrostatic potential, Φ, in volts

by

Φ(z) =

kBT
ec

u(z),

0 < z < L.

is about 0.026 volts at T = 298.15 Kelvin.

Here the constant kBT
ec

Clearly, the steady Nernst-Planck equation (1b) can be reformulated as

dJi(z)
dz

= 0,

0 < z < L,

i = 1, 2, . . . , n,

with Ji denoting the ﬂux density function of ionic species i as deﬁned by

(cid:20)

Ji(z) = −Di

Zici(z)

du(z)
dz

+

(cid:21)

.

dci(z)
dz

(2)

(3)

(4)

In this work, Ji is a scale function because both u and ci are the functions of one variable z.

4

We now use the above equations to derive the GHK equations by assuming that

ρ(z) = 0,

n
(cid:88)

i=1

Zici(z) = 0,

0 < z < L.

In other words, none of charges are considered within an ion channel pore interval. Under
this assumption, the Poisson equation (1a) becomes independent of the steady Nernst-Planck
equation (1b). Thus, a two-point boundary value problem of u is produced from model (1)
as follows:

(cid:26) d2u(z)

dz2 = 0,
u(0) = u0,

0 < z < L

u(L) = uL.

The solution u of the above boundary value problem can be easily found in the expression

u(z) =

uL − u0
L

z + u0,

0 ≤ z ≤ L,

resulting in a constant electric ﬁeld in the form

where Vm is deﬁned by

du(z)
dz

= −

Vm
L

,

Vm = u0 − uL,

(5)

(6)

(7)

which will be referred to as a membrane potential (or a voltage across a cell membrane).

From (3) it implies that the ﬂux function Ji(z) is either 0 or a nonzero constant. In the

case in which Ji = 0, we use (4) to get

Zici(z)

du(z)
dz

+

dci(z)
dz

= 0,

0 < z < L.

By separating the functions u and ci, the above equation is rewritten as

1
ci

dci
dz

= −Zi

du
dz

.

Integrating over the interval (0, L) on the both sides of the above equation, we obtain the
Nernst equation:

Vm =

1
Zi

ln

ci(L)
ci(0)

,

i = 1, 2, . . . , n.

(8)

We next consider the case in which Ji is a constant. Since the electric ﬁeld du
dz is a
constant, as given in (6), we can use (4) to construct a two-point boundary value problem
for determining the concentration ci of ionic species i as follows:






dci(z)
dz

− Zi

ci(0) = ci,0,

, 0 < z < L,

(9)

Vm
L

ci(z) = −

Ji
Di
ci(L) = ci,L.

5

Since Ji
Di

is a constant, by the integrating factor method, ci can be found in the expression

ci(z) =

1
θ(z)

(cid:20)

−

Ji
Di

(cid:90) z

Z1

(cid:21)

θ(z)dz + ci,0

,

where θ(z) is an exponential integrating factor, which can be found as follows:

θ(z) = e− (cid:82) z

0 Zi

Vm
L dz = e−Zi

Vm
L z,

where Vm has been deﬁned in (7). Applying the above expression to (10), we get
(cid:20) JiL
DiZiVm

ci(z) = eZi

Vm
L z − 1

+ ci,0

e−Zi

Vm
L z

(cid:16)

(cid:17)

(cid:21)

.

(10)

(11)

We then set z = L on the both sides of (11) to get a linear equation of Ji:

ci(L) = eZiVm

(cid:20) JiL
DiZiVm

(cid:0)e−ZiVm − 1(cid:1) + ci,0

(cid:21)

.

Solving the above equation for Ji, we obtain an expression of Ji as follows:

Ji = ZiDi

(cid:18) Vm
L

(cid:19) ci,0 − ci,Le−ZiVm
1 − e−ZiVm

,

i = 1, 2, . . . , n,

(12)

which can also be rewritten as

Ji = ZiDi

(cid:18) Vm
L

(cid:19) ci,L − ci,0eZiVm
1 − eZiVm

.

(13)

The expression (12) or (13) is referred to as the GHK ﬂux equation in the literature.

The electrical current Ii of species i can be derived from the multiplication of Ji by the

charge Ziec of species i:

Ii = ZiecJi,

i = 1, 2, . . . , n.

Using the GHK ﬂux equation (12), we immediately derive the GHK electric current
equation:

Ii = Z 2

i ecDi

(cid:18) Vm
L

(cid:19) ci,0 − ci,Le−ZiVm
1 − e−ZiVm

.

(14)

Adding the above currents together, we obtain a net electrical current, denoted by I, as
follows:

I =

n
(cid:88)

i=1

Ii = ec

Vm
L

n
(cid:88)

i=1

Z 2

i Di

ci,0 − ci,Le−ZiVm
1 − e−ZiVm

.

If the net current is zero, setting I = 0, we derive the GHK voltage equation:

n
(cid:88)

i=1

Z 2

i Di

ci,0 − ci,Le−ZiVm
1 − e−ZiVm

= 0.

A solution Vm of the above equation is called the GHK potential.

6

(15)

(16)

For example, for a solution with sodium (Na+ with Z1 = 1), potassium (K+ with Z2 = 1),
and chloride (Cl− with Z3 = −1) ions (n = 3) [7, Eq. (2.3)] and [17, Eq. (2.7.2)], we can
solve the equation (16) for Vm to get the GHK potential in the expression:

Vm = − ln

D1c1,0 + D2c2,0 + D3c3,L
D1c1,L + D2c2,L + D3c3,0

,

where c1,0, c2,0 and c3,0 are the concentration values of sodium, potassium, and chloride ions
at z = 0 while c1,L, c2,L and c3,L at z = L, respectively.
A membrane potential, V , in volts is deﬁned by

Using (2) and (7), we can derive V from Vm by

V = Φ(0) − Φ(L).

V =

kBT
ec

Vm.

(17)

Using (12) and (17), we can obtain another expression of the GHK ﬂux equation as

follows:

Ji = ZiDi

(cid:18) ec

kBT L

(cid:19)

V

ci,0 − ci,Le− Ziec
kB T V
1 − e− Ziec
kB T V

,

i = 1, 2, . . . , n.

(18)

As a special case, when ci,0 = ci,L = cb

i , the above expression is simpliﬁed as

Ji = ZiDicb
i

(cid:18) ec

(cid:19)

kBT L

V,

indicating that the ﬂux Ji has a linear relationship with the membrane potential V .
In
other words, the GHK ﬂux equation describes a nonlinear relationship of Ji with V only if
ci,0 (cid:54)= ci,L.

3 An extension of GHK equations

In this section, we extend the GHK equations from a constant electric ﬁeld to a nonlinear
electric ﬁeld based on the 1D PNPic model (1) with a nonzero permanent charge function ρ.
Because of (3), we still have that the ﬂux Ji of species i is either zero or a nonzero constant.
Since the case of Ji being zero can be treated in the same way as what is done in the previous
section, we only consider the case of Ji being a nonzero constant in this section.

Similarly to what is done in the derivation of GHK ﬂux equation, we treat the nonlinear
electric ﬁeld du/dz as a known coeﬃcient function of the steady Nernst-Planck equation
(1b). In this way, we can separate (1b) from the Poisson equation (1a) and then generate
a two-point boundary value problem for each ionic concentration function, ci, from the 1D
PNPic model (1) as follows:






+ Zi

dci
du
dz
dz
ci(0) = ci,0,

ci(z) = −

,

0 < z < L,

Ji
Di

ci(L) = ci,L.

7

By the integrating factor method, the solution ci of the above problem can be found in the
form

ci(z) =

1
θ(z)

(cid:20)

−

Ji
Di

(cid:90) z

0

(cid:21)

θ(ξ)dξ + ci,0

,

0 < z < L,

(19)

where θ(z) denotes an exponential integrating factor, which can be found as shown below:

θ(z) = e

(cid:82) z
0 Zi

du(ξ)

dξ dξ = eZi[u(z)−u0].

Applying the above expression to (19), we obtain an integral expression of ci as follows:

ci(z) = e−Zi[u(z)−u0]

(cid:20)

−

Ji
Di

(cid:90) z

0

eZi[u(ξ)−u0]dξ + ci,0

(cid:21)

.

Setting z = L on the both sides of the above expression, we get a linear equation of Ji:

ci,L = e−Zi[uL−u0]

(cid:20)

−

Ji
Di

(cid:90) L

0

eZi[u(ξ)−u0]dξ + ci,0

(cid:21)

.

Solving the above equation for Ji, we get an extension of the GHK ﬂux equation in
the form

Ji = Di

ci,0 − ci,LeZi[uL−u0]
(cid:82) L
0 eZi[u(z)−u0]dz

,

i = 1, 2, . . . , n,

(20)

Clearly, the integral (cid:82) L

0 eZi[u(z)−u0]dz can be reformulated as

(cid:90) L

0

eZi[u(z)−u0]dz = e−Ziu0

(cid:90) L

0

eZiu(z)dz.

Note that the integral (cid:82) L
0 eZiu(z)dz is a constant that collects all the values of potential
function u over the ion channel interval [0, L]. Hence, we can use it to deﬁne an extension
parameter, αi, by

(cid:90) L

αi =

eZiu(z)dz,

i = 1, 2, . . . , n.

(21)

For clarity, we denote the extended GHK ﬂux Ji of (20) by the new notation JE

i and use

the extension parameter αi to reformulate it as follows:

0

JE
i = Di

eZiu0
αi

(cid:2)ci,0 − ci,Le−ZiVm(cid:3) ,

i = 1, 2, . . . , n,

(22)

where Vm and αi have been deﬁned in (7) and (21), respectively.

Following what is done in (14), we can obtain an extened GHK current equation as

follows:

I E
i = ecZiDi

eZiu0
αi

(cid:2)ci,0 − ci,Le−ZiVm(cid:3) ,

i = 1, 2, . . . , n,

(23)

where I E

i denotes an electrical current of species i.

8

Adding all I E

i together, we obtain a net electrical current, I E, in the expression:

I E = ec

n
(cid:88)

i=1

ZiDi

eZiu0
αi

(cid:2)ci,0 − ci,Le−ZiVm(cid:3) .

(24)

Similar to what is done in (16), we can set I E = 0 to obtain an extended GHK voltage

equation as follows:

n
(cid:88)

i=1

ZiDi

eZiu0
αi

(cid:2)ci,0 − ci,Le−ZiVm(cid:3) = 0.

(25)

A solution of the above equation gives an extended ned GHK potential.

As an example, from the equation of (25) we can get an extended ned GHK potential,
m , for an ionic solution with sodium (Na+ with Z1 = 1) and chloride (Cl− with

denoted by V E
Z2 = −1) ions (n = 2) in the expression

(cid:36) +

V E
m = − ln

(cid:113)

(cid:36)2 + 4 α1
α2
2D1c1,L

D1D2e−2u0c1,Lc2,L

,

(26)

where c1,L and c2,L denote the concentration values of sodium and chloride ions at z = L,
respectively; D1 and D2 are the diﬀusion constants of sodium and chloride ions, respectively;
α1, α2, and (cid:36) are deﬁned by

α1 =

(cid:90) L

0

eu(z)dz, α2 =

(cid:90) L

0

e−u(z)dz,

and

α1
α2
Here (cid:36) has been assumed to be nonnegative and we have selected the positive square root
in (26) to ensure that the extended ned GHK potential V E

(cid:36) = D1c1,0 −

D2e−2u0c2,0.

m is well-deﬁned.

4 Numerical calculation for extension parameter

In this section, we present a numerical quadrature scheme for computing the extension
parameter αi approximately. In this scheme, we assume that a set of interpolation points,
Sm, is given by

Sm = {(zj, uj) | j = 0, 1, 2, . . . , m}, m ≥ 1,

(27)

where zj denotes the j-th partition number of the ion channel pore interval [0, L] satisfying

0 = z0 < z1 < z2 < . . . < zm−1 < zm = L,

(28)

and uj denotes a numerical value of an electrostatic potential function, u, at z = zj for
j = 0, 1, 2, . . . , m. To simplify the presentation of our numerical scheme, we set zj = jh with
the mesh size h = L/m.

9

When u is nonlinear, we use the interpolation point set Sm to construct a piecewise linear

interpolating function, ˆu, of u in the expression

ˆu(z) = ajz + bj

for zj−1 ≤ z ≤ zj,

(29)

where aj = (uj − uj−1)/h and bj = (zjuj−1 − zj−1uj)/h for j = 1, 2, . . . , m. That is, ˆu is a
linear function within sub-interval [zj−1, zj]. We then estimate the extension parameter αi
approximately as shown below:

αi =

(cid:90) L

0

eZiu(z)dz =

m
(cid:88)

(cid:90) zj

eZiu(z)dz

m
(cid:88)

(cid:90) zj

j=1

zj−1

j=1

eZi ˆu(z)dz =

zj−1

m
(cid:88)

(cid:90) zj

j=1

zj−1

eZi(aj z+bj )dz

≈

=

=

1
Zi

h
Zi

m
(cid:88)

j=1
m
(cid:88)

j=1

eZibj
aj

(cid:2)eZiaj zj − eZiaj zj−1(cid:3)

eZiuj − eZiuj−1
uj − uj−1

,

where we have used the partition formula zj = zj−1 + h. For clarity, the above approximate
value of αi is denoted by the notation ˆαi. That is,

ˆαi =

h
Zi

m
(cid:88)

j=1

eZiuj − eZiuj−1
uj − uj−1

.

(30)

This gives the formula for computing the extended GHK ﬂux JE

i approximately as follows:

JE
i ≈ Di

eZiu0
ˆαi

(cid:2)ci(0) − ci(L)e−ZiVm(cid:3) ,

i = 1, 2, . . . , n,

(31)

where Vm has been deﬁned in (7). Speciﬁcally, when m = 1, we have

h = L,

z0 = 0,

z1 = L,

u0 = u(0),

u1 = u(L),

and

ˆα1 =

h
Zi

eZiu1 − eZiu0
u1 − u0

,

from which (31) can be reduced to the GHK ﬂux equation (12). In this sense, our extended
GHK ﬂux equation contains the classic GHK ﬂux equation as a special case (i.e. only using
the two boundary values u0 and uL of u).

10

5 A ﬁnite element iterative scheme for solving

1DPNPic model

In order to generate an interpolation date set of (27), we present a nonlinear ﬁnite element
iterative scheme for solving the 1DPNPic model (1) in this section.

We start with a ﬁnite element approximation of the 1DPNPic model (1).
Let V denote a linear ﬁnite element function space based on the mesh partition (28) of
the interval [0, L]. Here each function of V is linear within each subinterval of the partition
and continuous on the interval [0, L]. We deﬁne a subspace, V0, of V by

V0 = {v ∈ V | v(0) = 0,

v(L) = 0}.

In the ﬁnite element method, V and V0 are referred to as the trial and test function spaces,
respectively. Multiplying each equation of the system (1) by a test function, v, and inte-
grating the second-order terms by parts, we can approximate the 1DPNPic model (1) as a
system of nonlinear ﬁnite element variational problems: Find u ∈ V and ci ∈ V satisfying
the Dirichlet boundary value conditions u(0) = u0, u(L) = uL, ci(0) = ci,0, and ci(L) = ci,L
such that

(cid:15)s

(cid:90) L

0

du
dz

dv
dz

(cid:90) L

0

dz −

e2
c
(cid:15)0kBT

(cid:90) L

(cid:32) n

(cid:88)

0

j=1

(cid:33)

Zjcj

vdz =

(cid:90) L

0

ρ(z)vdz ∀v ∈ V0,

(32a)

(cid:18)

Di

Zici

du
dz

+

dci
dz

(cid:19) dvi
dz

dz = 0 ∀vi ∈ V0,

i = 1, 2, . . . , n.

(32b)

We next present a damped iterative scheme for solving the above nonlinear ﬁnite element

system.

Let u(k) and c(k)

u(0) and c(0)

i

i denote the kth iterates of u and ci, respectively. When the initial iterates

are given, for k = 0, 1, 2, . . . , we deﬁne the updates u(k+1) and c(k+1)

i

= c(k)

i + ω(pi − c(k)
c(k+1)
i ),
i
u(k+1) = u(k) + ω(q − u(k)),

i = 1, 2, . . . , n,

by

(33a)
(33b)

where ω is a damping parameter between 0 and 1, pi is a solution of the linear ﬁnite element
variational problem: Find pi ∈ V satisfying pi(0) = ci,0 and pi(L) = ci,L for i = 1, 2, . . . , n
such that

(cid:90) L

(cid:18)

Di

Zipi

du(k)
dz

+

dpi
dz

(cid:19) dvi
dz

0

dz = 0 ∀vi ∈ V0,

(34)

and q is a solution of the linear ﬁnite element variational problem: Find q ∈ V satisfying
q(0) = u0 and q(L) = uL such that

(cid:15)s

(cid:90) L

0

dq
dz

dv
dz

dz =

e2
c
(cid:15)0kBT

(cid:90) L

(cid:32) n

(cid:88)

0

j=1

(cid:33)

Zjc(k+1)
j

vdz +

(cid:90) L

0

ρ(z)vdz ∀v ∈ V0.

(35)

Note that we have separate the nonlinear system (32) into n+1 independent linear equations
by substituting the current iterate u(k) to u in (32a) and the updates c(k+1)
to ci in (32b).

i

11

ω
0.2
0.2
0.19
0.6
0.6

JE
1

Iter.
59 −0.02590
58 −0.00082
57 −0.00084
14 −0.00499
11 −0.00133

JE
2
0.00039
0.01196
0.00664
0.00255
0.00203

|JE

1 −J1|
|JE
1 |
0.7394
7.2532
7.0130
0.3539
2.61 × 10−15

|JE

2 −J2|
|JE
2 |
3.7888
0.8430
0.7172
0.2628
3.63 × 10−15

CPU time (sec.)
0.3237
0.3142
0.2712
0.1385
0.0881

Test 1
Test 2
Test 3
Test 4
Test 5

Table 1: A comparison of the ﬂuxes JE
2 calculated by our extended GHK equations
(31) with the ﬂuxes J1 and J2 calculated by the classic GHK equations (18), along with the
convergence and performance of our ﬁnite element iterative scheme (33). Here J1 ≈ −0.00675
and J2 ≈ 0.00188 for the ﬁve tests.

1 and JE

By default, the initial iterates u(0) and c(0)

i

are set by

u(0) =

uL − u0
L

z + u0,

c(0)
i = 0,

i = 1, 2, . . . , n,

(36)

since the above selection can lead to the GHK ﬂux equation as shown in Section 2. We
terminate the iterative process whenever the following iteration termination rule holds:

(cid:107)u(k+1) − u(k)(cid:107) < (cid:15), max
1≤i≤n

(cid:107)c(k+1)
i

− c(k)

i (cid:107) < (cid:15),

(37)

where (cid:15) is a tolerance (e.g. (cid:15) = 10−5) and (cid:107) · (cid:107) is deﬁned by

(cid:107)v(cid:107) =

(cid:115)

(cid:90) L

0

|v(z)|2dz

for v ∈ V.

6 Numerical results

We implemented the damped iterative scheme (33) in Python as a program package based
In numerical
on the state-of-the-art ﬁnite element library from the FEniCS project [19].
tests, we used a piecewise constant permanent charge function, ρ, in the expression

ρ(z) =





Q1, 0 < z ≤ 10,
Q2, 10 < z ≤ 20,
Q3, 20 < z ≤ 30,
Q4, 30 < z ≤ 40,

(38)

where Qi is a net charge within the ith sub-interval of the ion channel interval [0, L] with
L = 40 for i = 1, 2, 3, 4. When all Qi are equal to Q, ρ becomes a constant function. We did
three numerical tests, called Tests 1, 2, and 3, using the following values of Q and Qi:

Test 1 Set Qi = Q for i = 1, 2, 3, 4 with Q = 10.

Test 2 Set Qi = Q for i = 1, 2, 3, 4 with Q = −20.

12

(a) Test 1 case

(b) Test 2 case

(c) Test 3 case

Figure 2: The electrostatic potential function u and ionic concentrations c1 and c2 generated
from Tests 1, 2, and 3 by our ﬁnite element program package for solving the 1DPNPic model
(1).

Test 3 Set Q1 = 0, Q2 = 20, Q3 = 10, and Q4 = 0.

Here Tests 1 and 2 are used to study the extended GHK ﬂux equation and 1DPNPic model
within an anion-selectivity ﬁlter and a cation-selectivity ﬁlter, respectively. In Test 3, the
interval [0, L] contains a selectivity ﬁlter (i.e. 10 < z ≤ 30) and two solution regions (i.e.
(0, 10] and (30, 40]), and ρ is a non-constant positive charge function within the ﬁlter and
zero within the two neutral solution regions. See Figure 1(a) for an illustration of the ion
channel interval [0, L] used in Tests 1 and 2 and Figure 1(b) for that used in Test 3.

We also did numerical tests without considering any permanent charge eﬀect as follows:

Test 4 Set ρ = 0 and ci,0 (cid:54)= ci,L with ci,0 = 0.1 and ci,L = 0.5 for i = 1, 2.

Test 5 Set ρ = 0 and ci,0 = ci,L with ci,0 = 0.1 and ci,L = 0.1 for i = 1, 2.

In these numerical tests, the units of length and concentration were set as angstroms and
moles per liter (mol/L), respectively; a mesh partition of (28) was set with m = 256 and
L = 40, which gave the mesh size h ≈ 0.156; a solution of two ionic species (i.e. n = 2)
was used with c1 denoting a concentration of cations and c2 a concentration of anions; the
boundary values of (1c) were set as u0 = −2, uL = 2, ci,0 = 0.1, and ci,L = 0.5 for i = 1, 2. We
also ﬁxed the parameters (cid:15)s = 80, Z1 = 1, D1 = 0.133 (for Na+), Z2 = −1, and D2 = 0.203
(for Cl−). The initial iterates were set by (36). Each ﬁnite element equation of (34) and
(35) were solved by the Gaussian elimination method. The numerical tests were done on our
iMac computer with one 4.2 GHz Intel core i7 processor and 64 GB memory. The numerical
results are reported in Table 1 and Figures 2 and 3.

Table 1 reports the ﬂux values JE

2 calculated by our extended GHK ﬂux equations
(31) and their relative errors with the ionic ﬂuxes J1 and J2 calculated by the GHK ﬂux

1 and JE

13

(a) Test 4 case

(b) Test 5 case

Figure 3: The electrostatic potential functions of u and ionic concentrations of c1 and c2
generated from Tests 4 and 5 by our ﬁnite element program package for solving the 1DPNPic
model (1).

equation (12). The relative error values can be large up to about 7, showing the importance
of considering charge eﬀects. Table 1 also reports the convergence and performance of our
nonlinear iterative scheme (33) in terms of the number of iterations and computer CPU
time. Here the damping parameter ω was selected optimally (by numerical experiments) in
the sense that it enabled the number of iterations satisfying the iteration termination rule
(37) to become the smallest. The computer CPU time was counted from the starting of an
implementation to the completion of an iteration process. From the table it can be seen that
our ﬁnite element iterative scheme (33) has a fast convergence rate and runs eﬃciently. All
the tests only took only 0.33 seconds or less in CPU time.

Figure 2 displays the electrostatic potential functions and ionic concentration functions
generated by our ﬁnite element program package for Tests 1, 2, and 3. In the case of Test
1, from Figure 2(a) it can be seen that anions have dominated cations due to a positive net
charge within the selectivity ﬁlter of an anion channel protein (such as a chloride channel).
On the other hand, when a negative net charge is set in the selectivity ﬁlter of an ion
channel protein, cations become to dominate anions as shown in Figure 2(b). This validates
the selectivity of a cation channel (such as a potassium channel).
In Test 3, we used a
nonnegative piecewise constant function to mimic a charge distribution over a portion of an
ion channel pore that contains one anion selectivity ﬁlter and two neutral solution regions,
resulting in a dominating concentration of anions as shown in Figure 2(c). These test results
indicate that our ﬁnite element program package is a valuable tool in the study of the ion
selectivity property of an ion channel protein.

14

(m, h)
(32, 1.25)
(64, 0.625)
(128, 0.3125)
(256, 0.15625)

(m, h)
(32, 1.25)
(64, 0.625)
(128, 0.3125)
(256, 0.15625)

ˆα1
581.434
582.651
581.943
581.24

ˆα2
20.771
20.616
20.544
20.509

α1,CT
583.129
583.078
582.05
581.267

α2,CT
21.145
20.711
20.568
20.515

α1
581.433
582.651
581.943
581.24

α2
20.771
20.616
20.544
20.509

| ˆα1−α1|
|α1|
1.76 × 10−6
1.14 × 10−7
7.17 × 10−9
4.49 × 10−10
| ˆα2−α2|
|α2|
1.19 × 10−5
7, 77 × 10−7
4.95 × 10−8
3.12 × 10−9

|α1,CT −α1|
|α1|
2.92 × 10−3
7.32 × 10−4
1.83 × 10−4
4.58 × 10−5
|α2,CT −α2|
|α2|
1.80 × 10−2
4.59 × 10−3
1.16 × 10−3
2.90 × 10−4

Table 2: A comparison of our numerical quadrature value ˆαi of (30) with the composite
trapezoidal value αi,CT of (40) for Test 3. Here the extension parameter αi of (21) is calcu-
lated by the FEniCS integral tool in high accuracy.

Interestingly, the numerical results for Tests 4 and 5 reported in Table 1 and Figure 3 show
that the boundary values of ionic concentrations ci can signiﬁcantly aﬀect the electrostatic
potential and ionic distributions when ρ = 0 (i.e.
ignoring the charge eﬀects from an ion
channel protein). When the boundary values are diﬀerent, as was done in Test 4, our
GHK ﬂux equation still produced diﬀerent ionic ﬂuxes from the classic GHK ﬂux equation.
However, with the same boundary values, we got a linear potential function, u, of z and
two constant ionic concentrations ci for i = 1, 2, as shown in Figure 3(b). As a result, our
extended GHK ﬂux equation produced the same ionic ﬂuxes as the classic GHK equation.

Finally, we made numerical tests on our numerical quadrature (30) to demonstrate its
numerical accuracy improvement in comparison to the classical composite trapezoidal (CT)
rule in the expression [2]:

(cid:90) L

0

g(z)dz ≈

(cid:34)

g(0) + 2

h
2

m−1
(cid:88)

j=1

(cid:35)

g(zj) + g(L)

.

(39)

Using the partition (28) of [0, L] and g = eZiu, we can obtain the CT value αi,CT of the
extension parameter αi for i = 1, 2, . . . , n in the expression:

αi,CT =

(cid:34)

h
2

eZiu(0) + 2

m−1
(cid:88)

j=1

(cid:35)

eZiu(zj ) + eZiu(L)

.

(40)

As the references for the accuracy comparison between our scheme and the CT rule, we
also calculated the extension parameter αi (i.e. the integral (cid:82) L
0 eZiu(z)dz) in high accuracy
using the FEniCS integral computational tool [19]. We used Test 3 as the test problem
since in this case, the potential function u is more nonlinear than the other test cases (as
In the tests, we set m = 32, 64, 128, 256 to get the mesh size h =
shown in Figure 2).
1.25, 0.625, 0.3125, 0.15625, respectively. The test results are reported in Table 2.

Table 2 shows that our new numerical scheme for computing the extension parameter
has a higher degree of accuracy than the composite trapezoidal rule. In fact, the composite

15

trapezoidal rule (40) is constructed from a piecewise linear interpolation function of the
composite function eZiu [2]. In contrast, our numerical quadrature (30) is constructed from
a piecewise linear interpolation function of u. Hence, our new scheme can have much smaller
relative errors than the classical composite Trapezoidal rule because its truncation error only
comes from a piecewise linear interpolation function of u, instead of the composite function
eZiu, as was done in the composite Trapezoidal rule.

7 Conclusions

In this paper, we have extended the classic GHK equations from a constant electric ﬁeld to a
nonlinear electric ﬁeld. The extended GHK equations have one additional parameter, called
the extension parameter, to account for the charge eﬀects from an ionic solution and an ion
channel protein. For a constant electric ﬁeld, a value of the extension parameter is found
analytically such that our extended GHK equations are reduced to the classic GHK equations
as special cases. When the electric ﬁeld is nonlinear, we have developed a novel numerical
quadrature scheme for computing the extension parameter approximately in terms of a set
of electrostatic potential values. To this end, the extended GHK equations can be viewed as
a bridge between the “macroscopic” ion channel kinetics (i.e. ionic ﬂuxes, electric currents,
and membrane potentials) and the “microscopic” electrostatic potential values. Hence, the
next step is to develop methodologies and computational tools for the generation of required
electrostatic potential values.

One natural way to do so is to use a numerical solution of the 1D PNPic model since this
model has been applied to the derivation of the extended GHK equations. In this paper, we
developed a ﬁnite element iterative scheme for solving the 1D PNPic model and implemented
it as a Python program package. Using this package, we generated diﬀerent sets of electro-
static potential values and then did diﬀerent numerical tests to study the extended GHK
equations, the numerical quadrature scheme, and the 1D PNPic ﬁnite element solver. The
numerical results from these numerical studies have conﬁrmed the importance of considering
charge eﬀects in the calculation of ionic ﬂuxes. They also show that our numerical quadrature
scheme has a higher degree of numerical accuracy than the classical composite trapezoidal
rule. Furthermore, they validate the convergence of our nonlinear ﬁnite element iterative
scheme and demonstrate the high performance of our program package. This package will
be a valuable tool for the numerical study of an ion channel protein by itself.

Acknowledgement

This work was partially supported by the Simons Foundation through research award number
711776 and the National Science Foundation, USA, through award number DMS-2153376.

References

[1] D. A. Beard, A biophysical model of the mitochondrial respiratory system and oxida-

tive phosphorylation, PLoS computational biology, 1 (2005), p. e36.

16

[2] R. L. Burden and J. D. Faires, Numerical Analysis, Thomson, Brooks/Cole, 10 ed.,

2015.

[3] Z. Chao and D. Xie, An improved Poisson-Nernst-Planck ion channel model and
numerical studies on eﬀects of boundary conditions, membrane charges, and bulk con-
centrations, Journal of Computational Chemistry, 42 (2021), pp. 1929–1943.

[4] J. R. Clay, Determining K+ channel activation curves from K+ channel currents
often requires the Goldman-Hodgkin-Katz equation, Frontiers in Cellular Neuroscience,
3 (2009).

[5] R. K. Dash and D. A. Beard, Analysis of cardiac mitochondrial Na+–Ca2+ ex-
changer kinetics with a biophysical model of mitochondrial Ca2+ handing suggests a 3:
1 stoichiometry, The Journal of physiology, 586 (2008), pp. 3267–3285.

[6] M. Didier, O. Tarun, P. Jourdain, P. Magistretti, and S. Roke, Membrane
water for probing neuronal membrane potentials and ionic ﬂuxes at the single cell level,
Nature communications, 9 (2018), pp. 1–7.

[7] C. P. Fall, E. S. Marland, J. M. Wagner, and J. J. Tyson, Computational

Cell Biology, Springer, 2002.

[8] A. Flavell, J. Kabre, and X. Li, An energy-preserving discretization for the
Poisson-Nernst-Planck equations, Journal of Computational Electronics, 16 (2017),
pp. 431–441.

[9] B. Frankenhaeuser, Sodium permeability in toad nerve and in squid nerve, The

Journal of physiology, 152 (1960), p. 159.

[10] C. Garc´ıa-Mart´ınez, C. Morenilla-Palao, R. Planells-Cases, J. M.
Merino, and A. Ferrer-Montiel, Identiﬁcation of an aspartic residue in the P-loop
of the vanilloid receptor that modulates pore properties, Journal of Biolsogical Chemistry,
275 (2000), pp. 32552–32558.

[11] C. L. Gardner, W. Nonner, and R. S. Eisenberg, Electrodiﬀusion model simula-
tion of ionic channels: 1D simulations, Journal of Computational Electronics, 3 (2004),
pp. 25–31.

[12] D. E. Goldman, Potential, impedance, and rectiﬁcation in membranes, The Journal

of general physiology, 27 (1943), pp. 37–60.

[13] B. Hille, Ion Channels of Excitable Membranes, Sinauer Associates, Sunderland, Mas-

sachusettes, 2001.

[14] A. L. Hodgkin and B. Katz, The eﬀect of sodium ions on the electrical activity of

the giant axon of the squid, The Journal of physiology, 108 (1949), p. 37.

[15] V. Iyer, R. Mazhari, and R. L. Winslow, A computational model of the human
left-ventricular epicardial myocyte, Biophysical journal, 87 (2004), pp. 1507–1525.

17

[16] M. S. Jafri, J. J. Rice, and R. L. Winslow, Cardiac Ca2+ dynamics: the roles of
ryanodine receptor adaptation and sarcoplasmic reticulum load, Biophysical journal, 74
(1998), pp. 1149–1168.

[17] J. P. Keener and J. Sneyd, Mathematical Physiology, vol. 1, Springer, 1998.

[18] W. Liu, One-dimensional steady-state Poisson-Nernst-Planck systems for ion channels
with multiple ion species, Journal of Diﬀerential Equations, 246 (2009), pp. 428–451.

[19] A. Logg, K.-A. Mardal, and G. N. Wells, eds., Automated Solution of Diﬀeren-
tial Equations by the Finite Element Method, vol. 84 of Lecture Notes in Computational
Science and Engineering, Springer Verlag, 2012.

[20] W. Nonner and B. Eisenberg, Ion permeation and glutamate residues linked
by Poisson-Nernst-Planck theory in L-type calcium channels, Biophysical Journal, 75
(1998), pp. 1287–1305.

[21] H. Tamagawa, Mathematical expression of membrane potential based on Ling’s adsorp-
tion theory is approximately the same as the Goldman-Hodgkin-Katz equation, Journal
of Biological Physics, 45 (2019), pp. 13–30.

[22] K. H. Ten Tusscher and A. V. Panfilov, Alternans and spiral breakup in a
human ventricular tissue model, American Journal of Physiology-Heart and Circulatory
Physiology, 291 (2006), pp. H1088–H1100.

[23] D. Xie and Z. Chao, A ﬁnite element iterative solver for an improved PNP ion
channel model by neumann boundary condition and membrane surface charge, Journal
of Computational Physics, 423 (2020), p. 109915.

[24] D. Xie and B. Lu, Eﬀective ﬁnite element iterative solver for a Poisson-Nernst-
Planck ion channel model with periodic boundary conditions, SIAM Journal on Scientiﬁc
Computing, 42 (2020), pp. B1490–B1516.

18

