Received: Added at production

Revised: Added at production

Accepted: Added at production

DOI: xxx/xxxx

RESEARCH ARTICLE

An implicit large-eddy simulation perspective on the ﬂow over
periodic hills

Laura Prieto Saavedra | Catherine E. Niamh Radburn | Audrey Collard-Daigneault | Bruno Blais*

1Research Unit for Industrial Flows
Processes (URPEI), Department of
Chemical Engineering, Polytechnique
Montréal, Montréal, Canada

Correspondence
*Bruno Blais. Email:
bruno.blais@polymtl.com

Present Address
PO Box 6079, Stn Centre-Ville, Montréal,
QC, Canada, H3C 3A7

Abstract

The periodic hills simulation case is a well-established benchmark case for Com-
putational Fluid Dynamics (CFD) solvers due to its complex features derived from

the separation of a turbulent ﬂow from a curved surface. We study the case with the
open-source implicit large eddy simulation (ILES) software Lethe. Lethe solves the

incompressible Navier-Stokes equations by applying a continuous Galerkin Finite
Element discretisation with SUPG/PSPG stabilisation. The results are validated by

comparison to experimental and computational data available in the literature at

Re = 5600. In addition, we study the eﬀect of the time step, averaging time and global
reﬁnement, and experiment with high-order elements and higher Reynolds numbers.

The ILES approach is shown to perform well even when using meshes coarser and
time steps larger than those typically used in periodic hills studies. For an optimised

ILES, the time step must be suﬃciently small to capture the rapidly changing turbu-
lent eﬀects, but this is compromised by a greater number of iterations increasing the

computational expense. The averaging time required to achieve statistical steadiness
is discussed and the mesh itself is investigated to determine the spatial resolution

required for accurate simulations. The greater understanding of the eﬀect of sim-
ulation parameters on the periodic hills case provided by this study can guide the

optimisation of other simulations and lead to a greater beneﬁt being obtained from
ILES solvers.

KEYWORDS:
Computational Fluid Dynamics (CFD), Finite Element Method (FEM), Implicit Large-Eddy Simulation

(ILES), Periodic Hills, turbulent ﬂow, incompressible ﬂow

2
2
0
2

n
u
J

6
1

]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[

1
v
5
4
1
8
0
.
6
0
2
2
:
v
i
X
r
a

1

INTRODUCTION

The phenomenon of turbulent separation from a curved surface occurs in a large variety of engineering problems, such as ﬂow
over a turbine, past an obstruction in a pipe, and through a reactor. It is therefore essential that a method capable of simulating
turbulent ﬂows is able to capture this phenomenon and the resulting ﬂow characteristics. The periodic hills is an established
simulation benchmark of this type 1. In this case, a well-deﬁned ﬂow passes over a series of hills which repeat along a channel
in a periodic fashion. As the ﬂow passes over a hill, there is a pressure-induced separation from the curved surface. It then
recirculates on the leeward face of the hill and reattaches at the base of the channel before accelerating up and over the next

0Abbreviations: SUPG, streamline-upwind/Petrov-Galerkin. PSPG, pressure-stabilizing/Petrov-Galerkin.

 
 
 
 
 
 
2

L. PRIETO SAAVEDRA ET AL

hill. It includes complex ﬂow features such as the generation of an unsteady shear layer, recirculation, strong pressure gradients,
attached and detached boundary layers, and turbulence recycling due to the periodicity assumption 2.

Over the past decade, the main research focus around the periodic hills simulation case has been on developing better wall
functions and subgrid-scale models for explicit Large-Eddy Simulations (LES) (e.g. 3,4,5), with a few studies using implicit LES
(ILES) 6,7,8,9,10,5. In the latter studies, only two use the Finite Element Method: Krank et al. with high-order discontinuous FEM 10
and Wang et al. with hp-spectral-FEM 5. The main diﬀerence between LES and ILES is that in the latter there is no subgrid-scale
model. Instead, careful reﬁnement of the mesh ensures all relevant length scales are resolved. Where the mesh is coarse and the
solution is smoother, large eddies are resolved but smaller ﬂow details are ignored, since they have a negligible impact on the
overall ﬂow regime. The mesh is ﬁner in areas of interest or where large ﬂow variation occur, so that the smaller eddies can also
be resolved (particularly in near-wall regions) to the scale where there is viscous dissipation. For that reason, the reﬁnement of
the mesh is critical to the accuracy of implicit LES 11,12.

The aim of this study is two-fold: the ﬁrst aim and main contribution is to demonstrate how accurate results for the periodic
hills case can be obtained at a reasonable cost in terms of mesh when using an ILES approach. This is achieved by comparing
the simulation results to two previous studies: an experimental study by Rapp 13 and a computational explicit LES completed
by Breuer et al. 14. The solver used in this study is already implemented in the open-source multiphase ﬂow simulation software
Lethe. Lethe uses a stabilised continuous Galerkin SUPG/PSPG Finite Element Method (FEM) formulation and is based on
the deal.II Finite Element Library 15,16. It supports multiple attractive features that are used in this study, such as the possibility
to use high-order isoparametric elements and high-order implicit time integrators. The second aim is to investigate the eﬀect
of numerical parameters on the periodic hills simulation, since the inﬂuence of numerical parameters must be understood in
order to exploit the advantage of high accuracy at minimal computational cost of LES approaches over DNS 17. Parameters
including the time step, overall simulation time for averaging of ﬂow properties and spatial reﬁnement are investigated due to
the importance of space and time in turbulent ﬂow simulations.

2

PERIODIC HILLS CASE

As the ﬂow passes over the hill, it is subjected to the eﬀects of both the curvature of the hill and the pressure gradient. The
adverse pressure gradient on the leeward side of the hill and resulting deceleration of the ﬂow causes the boundary layer to
separate from the curved hill surface. The ﬂow then recirculates on the leeward side of the hill and reattaches in the base of the
channel before the next hill. There is a short distance remaining before the subsequent hill which allows the boundary layer to
recover. The ﬂow then accelerates up and over the second hill, and the ﬂow pattern repeats in a periodic manner.

FIGURE 1 An instantaneous snapshot of the turbulent ﬂow over periodic hills as generated by Lethe after 800 s of simulation
run time. The recirculation zone, turbulence shed from the shear layer, and streaks along the upper wall can clearly be seen.

L. PRIETO SAAVEDRA ET AL

2.1 Geometry

3

For the past couples of decades, many experimental and computational studies have been completed over the same generalised
geometry, which was ﬁrst introduced by Mellen et al. 18 (for more information on this, a history of the periodic hills case is
well surmised by Rapp and Manhart 19 and more recently by Wang et al. 5). The geometry used minimises issues and additional
complexity in the ﬂow, as well as ensuring that computational models can be executed at a reasonable cost. This means that
there are now many studies, both experimental and computational, which can be used as benchmarks for the periodic hills case
and conﬁrm that the case has a well-deﬁned conﬁguration 20,13,14,21. Since the majority of cases use the same geometry, it was
also logical for our case to use this geometry, allowing comparison of the simulation with benchmark data.

FIGURE 2 Geometry of the periodic hills test case, where 𝐿𝑥 = 9ℎ, 𝐿𝑦 = 3.035ℎ and 𝐿𝑧 = 4.5ℎ, and ℎ is the maximum height
of the hill (Taken from ERCOFTAC, 2010 22)

The shape of the hills are described using 6 polynomials, each deﬁned for a sub-domain of the 𝑥 domain 1 (the polynomials
can be found in 7.1). The top of the ﬁrst hill is located at 𝑥∕ℎ = 0 with an elevation of 𝑦(𝑥) = ℎ. 𝑦(𝑥) reaches a minimal value of
0 at 𝑥∕ℎ = 1.929. The geometry is then ﬂat in the range 𝑥 ∈ [1.929; 7.071], with the geometry mirrored at 𝑥∕ℎ = 4.5 (meaning
the second hill has a windward face equal and opposite to the leeward face of the ﬁrst hill). The gap between hills is suﬃciently
sized to allow the ﬂow to reattach between hills and give some distance for recovery of the boundary layer after reattachment.
Therefore, the presence of the second hill does not aﬀect the point of reattachment.

The height and width of the channel are speciﬁed so to reduce the computational power and memory required and allow
suﬃcient resolution in both directions. The spanwise domain of 𝐿𝑧 = 4.5ℎ allows the side wall eﬀects to be ignored and the
spanwise ﬂuctuations to be completely resolved excluding the largest eddies 18,20,13. Flow characteristics which are half a channel
width apart are uncorrelated.

2.2

Boundary conditions

The top and bottom walls use no-slip boundary conditions, while the boundary conditions at the start (𝑥 = 0) and end of the
geometry (𝑥 = 𝐿𝑥) are periodic. This allows the ﬂow regime to achieve periodicity after several ﬂow throughs, as per the
deﬁnition of the test case, and removes the complication of specifying inlet and outlet conditions. The side walls are considered
to have periodic boundary conditions, which allows the model to represent the bulk ﬂow of the channel 1.

It is worth noting that while the velocity components are explicitly periodic at the streamwise boundaries, the pressure is not.

The pressure is comprised of a linear force component and a non-linear pressure component:

𝑝total(𝒙, 𝑡) = 𝑝force(𝑡) + 𝑝dynamic(𝒙, 𝑡) = 𝛽(𝑡)𝑥 + 𝑝(𝒙, 𝑡)

(1)

where 𝛽 is a spatially-independent momentum source term and 𝑝 is the dynamic pressure resulting from the ﬂow regime. The
value of 𝛽 is dynamically adapted through time following the procedure of Benocci and Pinelli 23 to ensure that the speciﬁed
volumetric ﬂow rate remains constant as the ﬂow develops.

4

2.3

Interesting features

L. PRIETO SAAVEDRA ET AL

Several features of interest have been identiﬁed in the ﬂow pattern at varying Reynolds numbers. The Reynolds number for this
ﬂow conﬁguration is given by:

Re =

𝑢𝐵ℎ
𝜈

3.035ℎ

𝑢𝐵 =

1
2.035

∫
ℎ

𝑢(𝑦)d𝑦

(2)

(3)

where 𝑢𝐵 is the bulk velocity, 𝜈 the kinematic viscosity and 𝑢(𝑦) the streamwise velocity proﬁle at 𝑥∕ℎ = 0. Periodic hills
simulations have been carried out at Reynolds numbers up to 37000 24,25,4,26. Most of the recent LES/DNS periodic hills studies
use Re = 10595 (e.g. 14,26,27,10,5,2). The ﬂow regime is still relevant for lower Reynolds numbers however, with the relevant
features being observed at a much more computationally feasible Re = 5600, not to mention the plentiful experimental and
numerical data available for this speciﬁc case summarized in Section 2.4. Consequently, this Reynolds number is used for the
core of this study, while the higher Reynolds numbers are only investigated shortly.

One main feature which has a large impact on the overall ﬂow pattern is the point of separation. The point of separation from
smoothly contoured walls is aﬀected greatly by the properties of the ﬂow and the environment, including pressure gradient, wall
roughness, turbulence in the shear layer and transport of downstream eﬀects 19,9. The point of separation has a strong eﬀect on
the length and height of the recirculation bubble, and hence on the reattachment point. As Re increases, the recirculation zone
ﬂattens and the reattachment point moves upstream 19. A small variation in the separation point strongly aﬀects the development
of the ﬂow regime in the leeward side of the hill, and so it leads to a major diﬀerence in reattachment point 1. Indeed, it has been
shown that a 1% change in separation point results in a 7% change in reattachment point 20.

The accuracy of the reattachment point is a good indicator of the accuracy of the simulation at the near-wall region. However,
the turbulent and unsteady nature of the ﬂow leads to a low frequency oscillation of the reattachment point, making it diﬃcult
to accurately determine 19. It is usually obtained as the location on the channel ﬂow where 𝑢 changes direction (the ﬂow stops
reversing within the recirculation bubble and reattaches, ﬂowing forward) 13, or the location on the channel ﬂoor where the wall
shear stress is zero 6.

Large eddies originate from the separated shear layer and are apparent as large longitudinal rolls on the windward side of the
second hill 24. These are due to the Kelvin-Helmholtz eﬀect; the diﬀerence in shear stress through the ﬂuid lead to a rotational
eﬀect and result in vortex rolls. These elongated vortices are often less than ℎ in diameter, but being able to model these large
3D structures indicates the need to have suﬃcient spanwise resolution in a simulation.

Fluctuations are observed in the 𝑧 direction on the windward side of the second hill. This is attributed to the "splattering"
eﬀect. Eddies, including the larger Kelvin-Helmholtz eddies, are transported by convection towards the second hill. These eddies
are compressed by the presence of the second hill, and as they can no longer continue motion in the x direction, they "splatter"
outwards. This is much more noticeable in the z direction than in the y direction as the bulk ﬂow at this location has a signiﬁcant
y-component as it accelerates up and over the second hill 20. This eﬀect is indicative of a more accurate simulation, since the
eddies are transported, compressed by the subsequent hill, and "splat": a phenomenon that RANS simulations are unable to
model 20.

A small recirculation has also been identiﬁed at the foot of the second hill, at around 𝑥∕ℎ = 7. As the ﬂow travels over the
second hill, the ﬂow accelerates and shear stress increases rapidly. Flow at the base of the second hill decelerates and can reverse,
leading to a separation of the boundary layer and secondary vortices 20. However, this separation is strongly dependent on the
ﬂow regime before the second hill and transportation of eddies. Since this varies over time, this recirculation is hardly visible
in the averaged ﬂow ﬁeld 14.

Another potential small recirculation can be observed on the crest of the hill. The sudden increase of wall shear stress as the
ﬂow accelerates over the second hill is countered by a change from a favourable to an adverse pressure gradient at approximately
𝑥∕ℎ = 8.6, dropping the shear stress and decelerating the ﬂow. This deceleration can lead to a small ﬂat recirculation zone (only
found in numerical simulations at Re > 10, 600, e.g. 14,28). Hence, it is not expected to be observed in the Lethe simulations at
Re = 5600. For a more detailed review of the ﬂow features which arise in the periodic hills simulation case, we refer the reader
to dedicated previous studies such as the articles by Frohlich et al. 20 or by Gloerfelt and Cinnella 21.

L. PRIETO SAAVEDRA ET AL

5

2.4

Previous studies of the periodic hills simulation case

Previous studies of the periodic hills case have either focused on the complex physical phenomenon occurring in the periodic hills
ﬂow, or on the ability of a CFD code to predict this ﬂow. Earlier studies on periodic hills focused on the later and hence the ﬂow
regime for this simulation case has now been well-elucidated across literature, most notably by Frohlich et al. 20. Later studies
have used the periodic hills in order to validate parts of a CFD model (such as a wall function) for turbulent ﬂow, separation of
boundary layers and resolution of wall eﬀects, without looking at the eﬀect of the simulation parameters on the simulation.

Table 1 describes the type and resolution of meshes used in previous periodic hills simulations at Re = 5600, and the
resulting reattachment points obtained, to give an indicator of the near-wall resolution. Similarly, Table 2 and Table 3 contain
the information for studies using Re = 10600 and Re = 37000 respectively. Table 1 shows that the mesh size varies dramatically
across studies of periodic hills at Re = 5600. Meshes used for LES tend to vary from 4 million cells up to 218 million cells.
The spacing and number of grid points is important to resolve features within the ﬂow completely and accurately. The ﬁner the
mesh, the closer to DNS the simulation becomes, and the greater the computational expense. Several studies do compare mesh
size and then proceed with the most accurate mesh for the least computational expense 24,10.

TABLE 1 Mesh type and resolutions used in previous studies with Re = 5600. A dash (-) is placed where the information was
not explicitly reported in the respective reference.

Code

Type

Spatial method

Number of
cells

DoFs Mesh type

Reattachment
point

Averaging time
[ﬂows through]

Time step
[s]

LESOCC

LES

STREAMLES

LES

LESOCC Case 7

LES

MGLET Case 8

DNS

URDNS 5600

URDNS

DNS 5600

DNS

FVM
(cell-centered)
FVM
(cell-centered)

FVM

FVM

DG-FEM
(𝑘 = 6)
FEM
(𝑘 = 7)

4.7M

4.7M

12.4M

218M

65K

65K

-

-

-

-

Curvilinear

Curvilinear

Curvilinear

Cartesian

4.56

4.72

5.09

5.14

22.5M Curvilinear

4.82±0.09

33.6M Curvilinear

5.04±0.09

55

55

145

38

61

61

0.002

0.001

0.002

0.001

Dynamic

Dynamic

Incompact3d

DNS

FD

37.8M

-

Cartesian

∼4.70

150

0.0005

Author

Frohlich et al.
2005 20
Frohlich et al.
2005 20
Breuer et al.
2009 14
Breuer et al.
2009 14
Krank et al.
2018 10
Krank et al.
2018 10
Xiao et al.
2020 29

The majority of previous periodic hills simulations do not discuss or even state the time averaging or time stepping aspects
of the simulations, excluding whether to consider if the CFL number is suﬃciently low (an important consideration for stability
in explicit time stepping methods). If they do state the averaging time and time step, often these are extremely large and small
respectively. However, an overly large averaging time or overly small time step may result in a simulation running for much
longer and being much more computationally costly than necessary. Additionally, due to the transient and turbulent nature of
the simulation, it was theorised that these two parameters would have an eﬀect on the results produced. Therefore, the time
after which the average was taken and the time step used in the simulation were deemed to be two parameters worthy of further
investigation.

To the authors’ knowledge, there is no available guidance on the optimal conditions to run a LES simulation for the periodic
hills case, particularly for an ILES using ﬁnite elements. The only notable exceptions to this are the studies by Krank et al. 10
and Wang et al. 5. The time is considered by Krank et al., who look at the time taken for averages to converge for diﬀerent DNS
and under resolved DNS simulations with both Re = 5600 and Re = 10600. They also consider the convergence using h/p
reﬁnement for a discontinuous Galerkin ILES approach, while Wang et al. look at the ILES requirements only for Re = 10600,
but mainly focus on the grid requirements and order of the elements, and do not consider the eﬀect of time at all.

In summary, the majority of previous studies of the periodic hills simulation case have focused on the physical processes
controlling the ﬂow regime, or solely have demonstrated the ability of a CFD code to accurately model the simulation case,
rather than focused on the parameters of the simulation itself. They hence ran the simulation case at the smallest time step and
ﬁnest grid that is computationally feasible for the longest time.

6

L. PRIETO SAAVEDRA ET AL

TABLE 2 Mesh type and resolutions used in previous studies with Re = 10600. A dash (-) is placed where the information was
not explicitly reported in the respective reference.

Number of
cells

DoFs

Mesh type

Reattachment
point

Averaging time
[ﬂows through]

Time step
[s]

Author

4.5M

12.4M

200K

900K

900K to 6.9M

5.4M and 14.3M

4.2M 33.5M

65K

524K

524K

67K, 524K,
4.2M and 33.5M

Name

Type

Spatial method

ALDM

ILES

FVM
(staggered)

LESOCC Case 9

LES

WMLES_C

WMLES_F

MDCD/SLAU

High order impact

DRP11

ILES

ILES

ILES

LES
ILES

LES

No-model and WALE

LES

URDNS 10600

URDNS

DNS 10600

DNS

FD

SEDM-Roe

SEDM-Aufs

SEDM

LES

LES

LES

LES

Nektar++

ILES

FVM

FVM

FVM

FVM

FVM

FD

DG-FEM
(k=3)
DG-FEM
(k=5)
FEM
(k=6)

FDM

DFEM
(k=4)
DFEM
(k=4)
DFEM
(k=6)
hp-FEM
(k=4,7)

-

-

-

-

-

-

-

Cartesian

4.3

Curvilinear

4.69

Cartesian

Cartesian

Curvilinear

Curvilinear

Curvilinear

-

-

-

4.2 and 4.4
3.75 and 4.4

−

3.9

4.19M

Curvilinear

113M

Curvilinear

4.57±0.06

180M

Curvilinear

4.51±0.06

60

142

90

40

20

-

80

-

61

61

-

0.0018

Dynamic

Dynamic

0.01

-

−

0.0001

Dynamic

Dynamic

-

Curvilinear

-

55 to 80

Explicit

72K and 10K

9M and 1.3M Curvilinear

4.37 and 4.18

64 and 96

Explicit

72K and 10K

9M and 1.3M Curvilinear

4.21 and 4.43

64 and 96

Explicit

72K

24.7M

Curvilinear

246K, 500K

-

Curvilinear

-

-

23

140

Explicit

0.001

Hickel et al.
2008 6
Breuer et al.
2009 14
Chen
2010 7
Chen
2010 7
Li et al.
2015 8
Balakumar et al.
2015 9
Gloerfelt et al.
2015 21
De la Llave Plata et al.
2018 26
Krank et al.
2018 10
Krank et al.
2018 10
Gloerfelt et al.
2018 2
Lodato et al.
2019 27
Lodato et al.
2019 27
Lodato et al.
2019 27
Wang et al.
2021 5

TABLE 3 Mesh type and resolutions used in previous studies with Re = 37000. A dash (-) is placed where the information was
not explicitly reported in the respective reference.

Name

Type

Spatial method

Number of
cells

DoFs Mesh type

Reattachment
point

Averaging time
[ﬂows through]

Time step
[s]

Author

HHTBLEC
HHTBLEF

PITM

LES

ILES

Hybrid RANS
/LES

LES

DLUM

RANS/LES

WALE

LES

FVM

FVM

FVM

FVM

DG-FEM
(k=3)

200K and 350K 12.4M

-

3.41 and 3.80

90 and 40

-

240K, 480K,
480K and 960K
500K, 5M
and 20M

500K

-

-

-

Curvilinear

Curvilinear

Curvilinear

65K

4.19M Curvilinear

4.30, 4.26
3.54 and 3.68
3.5, 3.65
and 3.65

3.8

3.2

-

140

140

-

Explicit

Explicit

Explicit

Explicit

Chen
2010 30
Chaouat and
Schiestel 2013 24
Mokhtapoor.
2016 25
Mokhtapoor.
2016 25
De la Llave Plata et al.
2018 26

Optimisation of the parameters for the ﬂow regime has barely been focused on at all; using parameters which maintain accuracy
of the simulation while reducing computational expense are important for feasible simulations, particularly for application of
the model to industry. Therefore, the eﬀect of the numerical parameters must be understood 17, and so the eﬀect of time step,
averaging time, mesh resolution and high-order elements, are investigated within this work.

3

SIMULATION SETUP

All simulations in this work were completed using the open-source software Lethe 31. All relevant code required to run the
simulations in this report can be found in the public Github repository for Lethe (https://github.com/lethe-cfd/lethe.git). Code
speciﬁc to post-processing the results obtained from the periodic hills simulations is available in the periodic hills folder within

L. PRIETO SAAVEDRA ET AL

7

the Lethe-utils Github repository (https://github.com/lethe-cfd/lethe-utils.git). Lethe is dependent on the deal.II library v9.3.0
with Trilinos, p4est and MPI enabled. In this study, the supercomputers Beluga and Niagara of the Digital Research Alliance of
Canada were used.

3.1 Governing equations and numerical model

Lethe solves the incompressible Navier-Stokes equations:

with

∇ ⋅ 𝒖 = 0

𝜕𝒖
𝜕𝑡

+ (𝒖 ⋅ ∇) 𝒖 = −∇𝑝∗ + ∇ ⋅ 𝝉 + 𝒇

𝝉 = 𝜈

(∇𝒖) + (∇𝒖)𝑇

(4)

(5)

(6)

where 𝒖 is the velocity vector, 𝑝∗ = 𝑝
with 𝑝 the pressure and 𝜌 the density, 𝝉 the deviatoric stress tensor, 𝜈 the kinematic vis-
𝜌
cosity and 𝒇 a body force. Being non-linear partial diﬀerential equations, they must be discretised in space and time in order
to approximate a solution. For this a continuous Galerkin Finite-Element formulation is used along with a SUPG (sreamline-
upwind/Petrov-Galerkin)/PSPG (pressure-stabilizing/ Petrov-Galerkin) stabilization approach. This allows the use of equal
order ﬁnite elements for the pressure and the velocity components and avoids numerical oscillations for advection-dominated
problems 32,33,31.The following weak formulation for the Navier-Stokes equations is obtained:

(

)

+ 𝒖 ⋅ ∇𝒖 + ∇𝑝∗ − ∇ ⋅ 𝝉 − 𝒇

⋅

𝜏𝑢∇𝑞

𝑑Ω𝑘 = 0

𝝉 ∶ ∇𝒗𝑑Ω −

(

)
𝑝∗∇ ⋅ 𝒗𝑑Ω

)

∇ ⋅ 𝒖𝑞𝑑Ω +

∫
Ω

𝜕𝒖
𝜕𝑡

𝐾 ∫
∑

Ω𝑘 (

𝜕𝒖
𝜕𝑡

∫
Ω (

+ 𝒖 ⋅ ∇𝒖 − 𝒇

⋅ 𝒗𝑑Ω +

)

∫
Ω

𝜕𝒖
𝜕𝑡

+

𝐾 ∫
∑

Ω𝑘 (

+ 𝒖 ⋅ ∇𝒖 + ∇𝑝∗ − ∇ ⋅ 𝝉 − 𝒇

⋅

𝑑Ω𝑘 = 0

∫
Ω
𝜏𝑢𝒖 ⋅ ∇𝒗

)

(

)

(7)

(8)

where 𝒗 and 𝑞 are the test functions for pressure and velocity respectively, and 𝐾 is the total number of elements. Since the
problem is transient, the stabilization parameter 𝜏𝑢 takes the following form:

2

−1∕2

2

2

)

+

(

(

+ 9

𝜏𝑢 =

diff )

1
Δ𝑡

4𝜈
ℎ2

⎡
(
⎢
⎢
⎣

𝒖
2
ℎconv )
|
|
where Δ𝑡 is the time step, ℎconv and ℎdiff are the size of the element related to the convective transport and diﬀusion mechanism,
respectively 34,32. In Lethe, both element sizes (ℎconv and ℎdiff ) are set to the diameter of a sphere of a volume equivalent to that
of the cell 35,33,31. The full deﬁnition of the methods and capability of this CFD solver are detailed in a separate publication 31.
For the periodic hills case, Newton’s method is used to solve implicitly the non-linear problem. Each linear system of equations
is solved with an ILU preconditioned GMRES solver. A second-order backward diﬀerence implicit scheme (BDF2) is used for
time-stepping 36. Diﬀerent time-stepping schemes are used in literature ranging from explicit Runge-Kutta schemes 14 to second
order three-step time-splitting schemes in a velocity-correction fashion 5. In this study, we take advantage of the implicit scheme
already implemented in the software. A detailed investigation of the advantages and disadvantages of time-stepping schemes
for this case is out of the scope of this study.

⎤
⎥
⎥
⎦

(9)

3.2

Simulation parameters

The ﬂow geometry is used as described in Section 2.1 and the boundary conditions as speciﬁed as in Section 2.2. The ℎ parameter
is set equal to 1 for simplicity. Likewise, the volumetric ﬂow rate and kinematic viscosity are set to be 9.1575 m3 s−1 and
1.785 71 × 10−4 m2 s−1 respectively, so that the bulk velocity 𝑢𝐵 = 1 m s−1, to a maintain a Reynolds number of 5600. The
kinematic viscosity is set to 9.433 96 × 10−5 m2 s−1 for a Reynolds number of 10600 and to 2.7027 × 10−5 m2 s−1 for a Reynolds
number of 37000. The elements of the mesh are isoparametric hexahedra and are arranged on a curvilinear mesh. For most of
the simulations 𝑄1𝑄1 elements are used. However, 𝑄2𝑄2 elements are also investigated.

8

L. PRIETO SAAVEDRA ET AL

FIGURE 3 Coarse mesh containing 250K cells used in the periodic hills case simulations for Lethe.

3.2.1 Meshing strategy
The mesh which is used for the majority of the simulations is a static, uniformly reﬁned mesh (see Fig. 3). In the 𝑥 and 𝑧
directions, the elements are of equal width across the domain. In the 𝑦 direction, spacing of the grid points can be varied, allowing
the mesh to become ﬁner as the elements approach the wall.

3.2.2 Quality of mesh
The quality of the grid is as important as the number of grid points in order to accurately locate features of interest and reduce
numerical errors. The resolution of the mesh in the near wall region is evaluated using the dimensionless distance from the wall
𝑦+, and the global reﬁnement of the mesh is evaluated using the Kolmogorov length scale 𝜂.

The dimensionless distance from the wall 𝑦+ indicates if a mesh is suﬃciently ﬁne in the near-wall region:

where 𝑦𝑐𝑐 is the half of distance from the wall to the wall-nearest grid point and the friction velocity 𝑢𝜏 is given by:

𝑦+ =

𝑦𝑐𝑐𝑢𝜏
𝜈

√
Simulations of attached boundary layers are not precise if the nearest computed values are not located within the viscous sub-
layer (𝑦+ < 5). This sets a requirement for the reﬁnement of the grid near the wall. The spanwise and lengthwise cell lengths
Δ𝑥+ and Δ𝑧+ are also important for resolving near the wall. However, if Δ𝑦+ is satisﬁed for the simulation in question, the cell
shape means requirements for Δ𝑥+ and Δ𝑧+ are almost always satisﬁed too 20,2.

In order to successfully dissipate the kinetic energy of the eddies, the resolution of the mesh must be suﬃciently ﬁne at
all points across the domain. Therefore, the required energy can be dissipated regardless of the eddy location in the mesh. To
evaluate the resolution of the mesh, the Kolmogorov length is used:

(10)

(11)

(12)

𝑢𝜏 =

𝜏𝑤
𝜌

𝜂 =

1
4

𝜈3
𝜖

(

)

An estimate of the dissipation tensor 𝜖 is predicted and averaged in time and in the spanwise direction by using 𝜖 ≈

is the length-scale of the largest eddy present in the ﬂow, and can be approximated by 𝜂
𝐿
give a conservative estimate of 𝜂, as there are several assumptions involved in the estimation of 𝜖.

14. 𝐿
≈ 𝑅𝑒−3∕4. This can be rearranged to

𝑢3
𝐵
𝐿

The resolution of the cell size in the mesh is assessed using the quantity Δ
𝜂

3 . Maximum
dissipation occurs at 24𝜂, and since each eddy must be resolved using at least 2 cells in each direction, the maximum cell size
should be 12𝜂 across the entirety of the mesh (since turbulence must be suﬃciently resolved across the entire mesh) 37,20. Hence,

, where the cell size Δ = (Δ𝑥 Δ𝑦 Δ𝑧)

1

L. PRIETO SAAVEDRA ET AL

for maximum dissipation and hence suﬃcient resolution of the turbulence:

Δ <

12𝜈𝑅𝑒−3∕4
𝑢𝐵
Δ < 0.1854

9

(13)

(14)

Since the mesh spacing for the static, uniform mesh is determined within the parameters ﬁle, this measure of mesh quality

can be evaluated a priori.

3.3

Comparison data

In order to verify the accuracy, stability and reliability of this ILES approach in the periodic hills case, the results are compared
to established test data from both experiments and other CFD simulations. Experimental data is obtained from Rapp 13, and
results from the LESOCC CFD code performed by Breuer et al. 14 provide benchmark computational data. For the latter, the
data was extracted from the article using Engauge digitizer 38. Since data is provided for cross-section at varying 𝑥∕ℎ values in
both benchmarks, the results from the Lethe simulation must also be extracted at these points to allow comparison of the data.

Experimental data

3.3.1
A series of experiments ran by Rapp 13 provide an experimental benchmark case. Not all benchmark data can be obtained from a
physical experiment - notably the data obtained by Rapp does not contain values of the turbulent kinetic energy or the spanwise
Reynolds normal stresses. The experimental set up involved a series of 10 hills with the curvature and hill spacing described in
Section 2.1 with hill height ℎ = 50 mm. The channel height was kept the same, but the channel span was increased to 18ℎ in
order to suﬃciently neglect side wall eﬀects.

Results were collected using Particle Image Velocimetry (PIV) and veriﬁed against Laser Doppler Anemometry (LDA) mea-
surements. Piezoelectric pressure probes were used to allow non-intrusive pressure measurement. Results were corrected for
error and signal noise. These conscientious, well-considered measurement techniques used give high conﬁdence to the results.
The reattachment point was determined at 𝑥∕ℎ = 4.83.

Periodicity of the ﬂow was conﬁrmed by comparing ﬂow between hills 6 and 7 and hills 7 and 8, and the reference data
taken from between hills 7 and 8. While it is conﬁrmed that the ﬂow can be assumed to be homogeneous (statistically 2D),
the periodicity at Re = 5600 can only be proven to a certain extent due to limitations inherent to the measurement equipment.
However, Rapp 13 concluded that the data produced is precise enough to be used to develop better LES models.

Rapp also collected data for higher Reynolds numbers (Re = 10600 and Re = 37000) using the same set up and experimental
techniques. This data is chosen for comparison with our results obtained using the higher Reynolds numbers in Section 4.6.
Measuring properties near to the wall is specially challenging in these cases as the boundary layer thickness is very small,
however, the periodicity of the ﬂow could be proven completely in both cases 13. The experimental reattachment point was
determined to be equal to 𝑥∕ℎ = 4.21 and to 𝑥∕ℎ = 3.76 for Re = 10600 and Re = 37000, respectively.

Computational data

3.3.2
An established benchmark test case for computational periodic hills simulations was created by Breuer et al. 14 by use of the
FVM code LESOCC. LESOCC solves the incompressible Navier-Stokes equations with the sub-grid scale Smagorinsky-Lilly
model with Van Driest damping near the solid walls, followed by averaging and ﬁltering to stabilise the dynamic model. A range
of simulations were performed by Breuer et al.; the ﬁrst results of interest arise from Case 7, which was performed at Re = 5600
using a LES approach. This setup uses around 12.4 million active cells (13.1 million grid points) in the mesh with a time step
of 0.002 s and the average taken over a time period of 1300 s.

The reattachment point for the benchmark case is 5.09, which is longer than the value of 4.83 given experimentally by Rapp.
Since the reattachment point describes the overall performance of a simulation in one number 10, these values can be used as
indicators for the method’s performance. Breuer et al. note that the pressure distribution in the computational benchmark data is
slightly under-predicted due to the SGS model, leading to a delay in the separation point, and hence to an over-prediction of the
reattachment point. On the contrary, the numerical and experimental spanwise domains have diﬀerent resolutions, and the highly
volatile nature of the reattachment point is under-predicted by the lower resolution of the Rapp domain, as spanwise resolution is
important for determining the separation point 20,10. In general, previous implicit LES studies appear to give better reattachment

10

L. PRIETO SAAVEDRA ET AL

point agreement to the Rapp data than the Breuer data 5, but give better overall agreement to the Breuer data 10. Therefore, while
both benchmarks do not give precise values, they give a clear indication of the region the reattachment point should fall within.
The second results of interest are known as LESOCC Case 9 and correspond to the Reynolds number of Re = 10600. The
grid used for this case was the same as in the previously explained simulation, but a time step of 0.0018 s and an average taken
over a time period of 1300 s were used. The numerical reattachment value was determined to be 𝑥∕ℎ = 4.69 in this case.

4

RESULTS AND DISCUSSION

A baseline simulation is initially ran to validate the results against the computational and experimental data sets presented in
Section 3.3. For this, two meshes are considered: coarse (∼ 250K cells, ∼ 1.1M DoFs) and ﬁne (∼ 1M cells, ∼ 4.5 DoFs).
Then, the eﬀects of several parameters of the simulation are investigated. We start with the analysis of the time step to ﬁnd a
suﬃciently low time step, followed by an analysis of the averaging time. Once the accuracy of the results can be considered
independent of the parameters related to time, the mesh itself is analysed. For the mesh, global reﬁnement on a static uniform
mesh is considered in order to ﬁnd the minimum mesh size required for the results to be independent of the spatial resolution;
for this we considered several meshes with up to 8M cells. At the end, we experiment with high-order elements for both the
velocity and pressure, and we investigate results for simulations with higher Reynolds numbers. In Table 4, a summary of the
diﬀerent simulations along with their parameters is presented.

TABLE 4 Summary of the simulations and respective parameters.

Re

Time step [s] Time average [s] Elements (𝑄𝑘𝑄𝑘)

5600

5600

5600

0.1

0.0125, 0.025,
0.05, 0.1

1000

1000

0.025

500 to 1100

Case

Baseline

Time step

Time averaging

Global reﬁnement

High-order elements

High Reynolds numbers

Mesh (cells, DoFs)
Coarse (250K, 1.1M)
Fine (1M, 4.5M)
Coarse (250K, 1.1M)
Fine (1M, 4.5M)
Coarse (250K, 1.1M)
Fine (1M, 4.5M)
Coarse (250K, 1.1M)
Intermediate (500K, 2.4M)
Fine (1M, 4.5M)
Very ﬁne (4M, 16M)
Finest (8M, 33M)
Very coarse (120K, 4.5M)

5600

0.025

5600

0.025

800

800

800

Very coarse (120K, 500K)
Coarse (250K, 1.1M)
Intermediate (500K, 2.4M)

10600,
37000

0.025

𝑄1𝑄1

𝑄1𝑄1

𝑄1𝑄1

𝑄1𝑄1

𝑄2𝑄2

𝑄1𝑄1

4.1

Baseline

The baseline simulation ensures that the results accurately reproduce the physical phenomenon occurring in the periodic hills
case. It uses a coarse and a ﬁne mesh, a time step of 0.1 s, and the average is taken between 207 s and 1000 s (for an averaging
period of 793 s or 88 ﬂow throughs). The coarse mesh consists of a uniform static mesh with 250K cells (128x64x32) and
maximum cell size Δ𝑥 = 0.0703, Δ𝑦 = 0.0474 and Δ𝑧 = 0.14. This results in Δ = 0.0776 < 0.1854. The ﬁne mesh consists
of a uniform static mesh with 1M cells (144x96x80) and maximum cell size Δ𝑥 = 0.062, Δ𝑦 = 0.031 and Δ𝑧 = 0.057. This
results in Δ = 0.048 < 0.1854. The cell size used is at least 2.3x smaller in the former and 3.5x smaller in the latter than the
Kolmogorov length scale, meaning all eddies are resolved using at least 4 and 7 elements respectively.

Considering the average velocity proﬁle in the 𝑥 direction (Fig. 4), there is a good agreement of the Lethe data with both
benchmarks at the lower wall and in the bulk of ﬂow. At the upper wall, the Lethe data exceeds the benchmarks but retains shape
at all 𝑥 values. This implies that the frictional wall eﬀects are not suﬃciently resolved. This is known to be a consequence of
the coarse mesh, since the grid near the upper wall is too coarse to resolve the smallest eddies in the near-wall region and hence
is inadequate for the wall-resolving LES 8,39. The size of the time step is also likely too large to depict the rapidly changing

L. PRIETO SAAVEDRA ET AL

11

1.4

1.2

1.0

0.8

0.0

0.2

0.4

0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

3.6

3.8

4.0

4.2

7.2

7.4

7.6

7.8

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe baseline 250K
Lethe baseline 1M

FIGURE 4 Average velocity in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks. The
proﬁles are scaled by a factor of 0.8 for ease of visualisation.

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

4.0 4.2 4.4 4.6

6.6 6.8 7.0 7.2

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe baseline 250K
Lethe baseline 1M

FIGURE 5 Reynolds normal stress in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks.
The proﬁles are scaled by a factor of 5 for ease of visualisation.

properties at the wall, as small eddies are formed and quickly transported away. Most notably, the diﬀerence can be observed near
to the bottom and upper walls. The maximum diﬀerence (∞ norm) between the experimental results and Lethe results obtained
by using the coarse and ﬁne mesh is of 11% and 18%, respectively, when the ﬂow separates at 𝑥∕ℎ = 0.05 and 𝑦∕ℎ=1.05.

The 𝑦 velocity and Reynolds stresses also agree well with the benchmark data; for the Reynolds stress in 𝑥 direction see Fig.
5. It can be seen that the Reynolds stresses are more sensitive than the average velocity. The reattachment point was determined
to be 4.73 with the coarse mesh and 4.40 with the ﬁne mesh, both shorter than both the Rapp and the Breuer values (4.83 and
5.09 respectively). This again is likely due to the poor resolution of the coarse mesh at the wall. Indeed, the reattachment point
has been shown to be constantly under-predicted by overly coarse meshes 5.

12

4.2

Time step

L. PRIETO SAAVEDRA ET AL

To select the optimal time step to run simulations at, four simulations per mesh were completed using Lethe. Again the coarse
and ﬁne meshes were used, and the time steps varied from Δ𝑡 = 0.1 s, Δ𝑡 = 0.05 s, Δ𝑡 = 0.025 s, and Δ𝑡 = 0.0125 s. Since
Lethe uses an implicit solver, the time step does not aﬀect the stability of the solution. However, the time step aﬀects temporal
accuracy and its impact must be assessed. Average results were taken again after 1000 s.

Coarse(250K)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.0

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.0

0.3

0.9
u/ub at x/h=0.5

0.6

0.3

0.9
u/ub at x/h=0.5

0.6

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

u/ub at x/h=2

u/ub at x/h=4

u/ub at x/h=6

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

u/ub at x/h=2

u/ub at x/h=4

u/ub at x/h=6

Lethe - ∆t=0.1s
Lethe - ∆t=0.05s

Lethe - ∆t=0.025s
Lethe - ∆t=0.0125s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 6 Average velocity in the 𝑥 direction at diﬀerent points of the geometry with Re = 5600, compared against the
benchmarks.

The stresses demonstrate the time step eﬀect most signiﬁcantly (see Fig. 7 and 8). The largest time step is not sensitive to
the shorter timescales in the turbulence, not detecting ﬂuctuations at the near-wall region and often over-predicting the normal
stresses in both cases. The two smallest time steps give results nearly identical to each other and to Breuer’s data for the ﬁne
mesh. However, for the coarse mesh, we see a higher discrepancy between these two time steps and to Breuer’s data. This is
most probably due to the stronger role of the stabilization when the mesh is coarser (see Eq. 9). For both cases a smaller time
step greatly increases the accuracy of the stresses. The velocities appear to be much less dependent on the time step except in
the lower wall (see Fig. 6). In cases where the velocities are signiﬁcantly impacted by time step (𝑥∕ℎ = 4), the corresponding
large diﬀerence in shear stress can be seen. However, the diﬀerence is more prominent in the coarse mesh case.

Considering the reattachment points in Table 5, it can be seen that the value of the reattachment point increases as time
step decreases when using the coarse mesh, surpassing the benchmark values when using Δ𝑡 = 0.05 and Δ𝑡 = 0.025 for the
experimental and numerical reattachment point respectively. In the case of the ﬁne mesh, decreasing the time step means that
the value converges more towards the experimental value by Rapp 13. In general, the reattachment point hence becomes more
accurate and the average 𝑦+ value decreases as the time step decreases. The reason for this is that decreasing the time step
increases accuracy in the near-wall region since the time scale of the smallest eddies can be resolved. An example of this can
be seen in Figure 6 at 𝑥∕ℎ = 4, where the two smallest time steps depict the lower wall region much more accurately than

L. PRIETO SAAVEDRA ET AL

Coarse(250K)

13

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.00

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=0.5

0.12

0.04
u′u′/u2

0.08
b at x/h=0.5

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=2

0.12

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=4

0.12

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=6

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=2

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=4

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=6

0.12

Lethe - ∆t=0.1s
Lethe - ∆t=0.05s

Lethe - ∆t=0.025s
Lethe - ∆t=0.0125s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 7 Reynolds normal stress in the 𝑥 direction at diﬀerent points of the geometry with Re = 5600, compared against the
benchmarks.

TABLE 5 Near wall parameters and computational parameters at varying time steps

Coarse (250K)

Fine (1M)

Time step [s]

0.1
0.05
0.025
0.0125

Reattachment
point
4.73±0.05
4.87±0.05
5.07±0.05
5.37±0.06

Average 𝑦+ CFL

1.74
1.67
1.67
1.59

≈ 2.2
≈ 0.9
≈ 0.5
≈ 0.2

Reattachment
point
4.40±0.05
4.59±0.05
4.80±0.05
4.88±0.05

Average 𝑦+ CFL

1.22
1.21
1.17
1.18

≈ 3.2
≈ 1.6
≈ 0.7
≈ 0.4

the largest two for both meshes. The overprediction of the reattachment point when using the coarse mesh is most likely due
to the eﬀect of the time step on the stabilization parameter and the oscillating nature of this value. As mentioned before, the
stabilization plays a larger role when the mesh is coarser. Therefore, while we would expect the value to be more accurate, the
stabilization parameters are increasing dissipation in the area where the reattachment point is calculated.

CFL conditions are not required for implicit time stepping, allowing a much greater time step to be used stability-wise com-
pared to explicit time stepping. For stability with an explicit time stepping method, a CFL number less than 0.8 is required in the
periodic hills case 4, which explains why the time step used is so small in other studies, which mostly use explicit methods. These
other models require much smaller time step for stability hence require more iterations to reach the same overall simulation time
and are more computationally time-consuming. Therefore, using an implicit solver like Lethe is more practical. However, it is
worth noting that using Δ𝑡 = 0.025 s and Δ𝑡 = 0.0125 s with both meshes does fulﬁll the CFL requirement regardless.

14

Coarse(250K)

L. PRIETO SAAVEDRA ET AL

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=0.5

0.00

u′v′/u2

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=0.5

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=2

0.00

u′v′/u2

−0.04

−0.02
b at x/h=2

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=4

0.00

u′v′/u2

−0.04

−0.02
b at x/h=4

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=6

0.00

u′v′/u2

−0.04

−0.02
b at x/h=6

0.00

u′v′/u2

Lethe - ∆t=0.1s
Lethe - ∆t=0.05s

Lethe - ∆t=0.025s
Lethe - ∆t=0.0125s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 8 Reynolds shear stress at diﬀerent points of the geometry with Re = 5600, compared against the benchmarks.

In conclusion, reﬁning the time step leads to more accuracy of the average velocity and the Reynolds stresses, with a higher
impact in the latter, in the lower wall region for both meshes, where the ﬂow properties are highly dependent on the viscous
eﬀects and stresses, and the ﬂow is changing rapidly. However, for the coarse mesh, it does not seem to help in the accurate
prediction of the reattachment point. The data obtained using Δ𝑡 = 0.025 s and Δ𝑡 = 0.0125 s is very similar, and since a
simulation running at half the time step will take twice as long to complete, as a compromise between temporal accuracy and
practicality, a time step of Δ𝑡 = 0.025 s was decided as the optimised value to further study the eﬀect of other parameters in this
simulation case.

4.3

Time averaging

For the periodic hills simulation, the average velocities and Reynolds stresses are taken over time. The values used in the
averaging process are taken after the time exceeds 207 s, or after 23 hills have been passed, and so the ﬂow can be considered
as periodic.

In previous studies, the averaging time period varied by approximately one order of magnitude 10, with no clear consistency
on how that time period was decided. According to Krank et al. 10, while some studies suggest a very long time averaging period
of around 1000 ﬂow-through times, this is not feasible nor desirable for high Reynolds numbers or benchmark simulations.
Additionally, it was observed in initial simulations that the values of certain ﬂow properties oscillated around a value, rather
than converging to a value. This indicates that the averaged values have not yet converged on the periodic value. Therefore, the
eﬀect of the time elapsed on the convergence of the average values was investigated.

Hence, using the coarse and the ﬁne mesh, data was extracted at varying times to see the convergence. A time step of 0.025 s
was used due to the results of the previous section. However, when the time step decreases, more iterations are required to
reach the same time in the simulation. Therefore, more values are used to calculate the average, and so it is assumed that the
simulations with a smaller time step will reach statistical steadiness in a shorter simulation time than one with a larger time step.

L. PRIETO SAAVEDRA ET AL

Coarse(250K)

15

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.0

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.0

0.3

0.9
u/ub at x/h=0.5

0.6

0.3

0.9
u/ub at x/h=0.5

0.6

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

u/ub at x/h=2

u/ub at x/h=4

u/ub at x/h=6

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

0.0

0.3

0.6

0.9

1.2

u/ub at x/h=2

u/ub at x/h=4

u/ub at x/h=6

Lethe - 500s
Lethe - 600s

Lethe - 700s
Lethe - 800s

Lethe - 900s
Lethe baseline - 1000s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 9 Average velocity in the 𝑥 direction at diﬀerent points of the geometry with Re = 5600, compared against the
benchmarks.

According to Fig. 9, 10 and 11, the results for the coarse mesh are average-independent. The reason for this could be that
the smallest time ﬂuctuations are not being captured by this simulation due to the coarse mesh. For the ﬁne mesh there is very
good agreement of average values at an averaging time as low as 500 s throughout the ﬂow. Convergence of the turbulence
generated by the shear layer requires 800 s, meaning 800 s are required for convergence of the bulk of the ﬂow. This agrees with
the convergence determined for a similar simulation 10. Some areas with highly complex turbulent eﬀects, such as 𝑢′𝑢′ on the
windward face of the second hill (where the "splattering" eﬀect can be observed), require 900 s to converge. In those terms, a
time average of 800 s is used in the other cases to ensure convergence of all the simulations.

4.4 Mesh global reﬁnement

Now that the temporal eﬀects have been elucidated, the spatial parameters can be explored with the results being considered
independent of time. The results analysed in the previous sections have concluded that we can obtain accurate results for the
average velocity and Reynolds stresses using both meshes, however, for both, the results diﬀer mostly in the near wall region.
In the literature, very ﬁne meshes are used, as discussed earlier in Table 1. Therefore, the eﬀect of uniformly reﬁning the mesh
is investigated.

In addition to the previously used meshes, we consider: an intermediate mesh with 500K cells (2.4M DoFs), a very ﬁne mesh
with 4M cells (16M DoFs) and the ﬁnest mesh with 8M cells (33M DoFs). The cells of the coarse and ﬁnest mesh are 0.025x and
1.7x the number of cells used by Breuer et al. respectively. Since the intermediate and ﬁne meshes are more globally ﬁne than the
coarse mesh, they are also ﬁne enough to fully capture the Kolmogorov length scale for this simulation case. Both simulations
were ran at 𝑡 = 0.025 s and extracted at 800 s, as per the required optimised times established in Sections 4.2 and 4.3.

In general, while all meshes produce a good agreement with the benchmark data, the coarse one seems to have a higher
discrepancy with the benchmarks. A more globally reﬁned mesh results in the global turbulence being more clearly resolved.

16

Coarse(250K)

L. PRIETO SAAVEDRA ET AL

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.00

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=0.5

0.12

0.04
u′u′/u2

0.08
b at x/h=0.5

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=2

0.12

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=4

0.12

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

0.00

0.04
u′u′/u2

0.08
b at x/h=6

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=2

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=4

0.12

0.00

0.04
u′u′/u2

0.08
b at x/h=6

0.12

Lethe - 500s
Lethe - 600s

Lethe - 700s
Lethe - 800s

Lethe - 900s
Lethe baseline - 1000s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 10 Reynolds normal stress in the 𝑥 direction at diﬀerent points of the geometry with Re = 5600, compared against
the benchmarks.

The results are in full agreement to the Breuer data, as can be seen in Figure 12, despite the fact the Breuer data uses 9.4x as
many cells of equal order as the intermediate mesh. Therefore, all meshes starting with the intermediate give suﬃcient spatial
resolution.

The near wall region shows the greatest diﬀerence in results. At the upper wall, as the mesh is reﬁned there is a complete
convergence to the Breuer data for 𝑥 velocity at all points throughout the ﬂow, and almost perfect agreement for other ﬂow
properties. The variation at the bottom and top walls can most clearly be seen in the stresses, such as in Figure 13. The largest
diﬀerence (∞ norm) between Lethe data and Breuer benchmark is encountered again where the ﬂow separates at 𝑥∕ℎ = 0.05
and 𝑦∕ℎ = 1.05. In the case of the intermediate mesh, this diﬀerence is of 10.56%, while for the ﬁnest mesh it is 7.21%.

At ﬁrst sight, it would seem that the deviation in near wall behavior is due to the diﬀerence in modelling of the boundary layer
between LESOCC and Lethe. However, Breuer et al. 14 compared the results of two identical simulations: one with a dynamic
SGS model and another one without a SGS model. It was found that the SGS model had a marginal eﬀect on the results due
to their mesh resolution and that the simulation could be in fact be considered as a DNS one. It is therefore impressive that the
Lethe results without using any SGS model, nor a wall function, converge to the benchmarks at the wall as the mesh is reﬁned.
The factors that could have inﬂuenced the behavior near to the wall of our simulations are that the pressure boundary condition at
the bottom wall is not a zero normal gradient, or that Lethe beneﬁts from the use of isoparametric 𝑄1𝑄1 elements in this region
which might lead to better accuracy. 𝑄1𝑄1 elements generate higher order interpolation in diagonal directions of the elements.
Consequently, even though they are formally second-order accurate, the higher-order interpolation that they generate in some
directions may signiﬁcantly decrease the error. In addition, there is a complex relationship between the mesh resolution and the
stabilization technique used in this FEM formulation.

However, it is also shown that an error due to the SGS model can be observed in the pressure at the wall when compared to a
DNS 14,2. This aﬀects the boundary layer and leads to an under-prediction of the shear stresses. The Breuer data is hence known
to deviate most signiﬁcantly at the extrema of the Reynolds stresses. Additionally, the Rapp data is known to over-predict the

L. PRIETO SAAVEDRA ET AL

Coarse(250K)

17

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=0.5

0.00

u′v′/u2

Fine(1M)

3.0

2.5

2.0

h
/
y

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=0.5

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=2

0.00

u′v′/u2

−0.04

−0.02
b at x/h=2

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=4

0.00

u′v′/u2

−0.04

−0.02
b at x/h=4

0.00

u′v′/u2

3.0

2.5

2.0

1.5

1.0

0.5

0.0

3.0

2.5

2.0

1.5

1.0

0.5

0.0

−0.04

−0.02
b at x/h=6

0.00

u′v′/u2

−0.04

−0.02
b at x/h=6

0.00

u′v′/u2

Lethe - 500s
Lethe - 600s

Lethe - 700s
Lethe - 800s

Lethe - 900s
Lethe baseline - 1000s

LESOCC - Breuer 2009
Experimental - Rapp 2009

FIGURE 11 Reynolds shear stress at diﬀerent points of the geometry with Re = 5600, compared against the benchmarks.

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

3.6 3.8 4.0 4.2

7.2 7.4 7.6 7.8

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

Experimental - Rapp 2009
LESOCC - Breuer 2009

x/h

Lethe - 250K
Lethe - 500K

Lethe - 1M
Lethe - 4M

Lethe - 8M

FIGURE 12 Average velocity in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks. The
proﬁles are scaled by a factor of 0.8 for ease of visualisation.

stress due to measurement errors 13. Therefore, the Lethe results tending towards the experimental data (but not exceeding it)
may reﬂect a more accurate simulation of the physical ﬂow regime.

18

L. PRIETO SAAVEDRA ET AL

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

1.2

1.0

0.8

0.6

3.0

2.8

2.6

2.4

3.0 3.2 3.4 3.6

6.6 6.8 7.0 7.2

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

Experimental - Rapp 2009
LESOCC - Breuer 2009

x/h

Lethe - 250K
Lethe - 500K

Lethe - 1M
Lethe - 4M

Lethe - 8M

FIGURE 13 Reynolds normal stress in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks.
The proﬁles are scaled by a factor of 5 for ease of visualisation.

5.6

5.4

5.2

5.0

4.8

4.6

4.4

4.2

]
-
[

h
t
g
n
e
l

t
n
e
m
h
c
a
t
t
a
e
R

Experimental - Rapp 2009
Lethe - 250K
Lethe - 500K
Lethe - 1M
Lethe - 4M
Previous studies
LESOCC - Breuer 2009

0

20

40

60

80

100

120

140

Averaging time [Flows throughs]

FIGURE 14 Reattachment point extracted at diﬀerent averaging times for the 250K, 1M and 4M meshes, where the dotted line
shows the error in the reattachment point over time.

Wall modelling is known to be one of the most challenging aspects of periodic hills simulations 14,7,2. It is therefore promising
that an implicit model with stabilization techniques can very accurately depict the wall as it dramatically simpliﬁes the modelling
process by using very coarse meshes. The diﬀerence in the near wall region leads to diﬀerence in the separation and reattachment
points of the ﬂow. This consequently results in variation being observed in the recirculation bubble and shear layer.

To ensure complete convergence and independence from time averaging eﬀects, the reattachment points were extracted at
varying averaging times for the intermediate mesh and plotted, as per the method by Krank et al. 10. For this, the reattachment
point is extracted after multiple averaging times. These reattachment points are then plotted against the averaging time (in
𝑇𝑓 , where 𝑐 is a manually
number of ﬂow through times). The error 𝑒 is evaluated using the following expression 𝑒 = ±𝑐∕
deﬁned constant and 𝑇𝑓 is the number of ﬂow through times. Since the reattachment point oscillates due to the turbulence, a
ﬁnal reattachment point is set to a value that the reattachment points extracted tend towards. The constant 𝑐 is then manually

√

L. PRIETO SAAVEDRA ET AL

19

adjusted so that the error is as small as possible with all the extracted reattachment points lying within the error range. The error
bandwidth hence decreases as the averaging time increases. The reattachment points converge very quickly, with the expected
oscillation at diﬀerent averaging times being within a very small error range.

The results in Figure 14 show that as we reﬁne the mesh, the reattachment points approach the experimental reattachment
point value by Rapp 13. It can be seen that the results are not monotonically approaching the value as the mesh is reﬁned and this
is in agreement with the oscillatory nature of the physical phenomena. In fact, the results using diﬀerent meshes coincide with
the results of previous studies. The reattachment point obtained by Breuer et al. 14 is in the error bandwidth of the reattachment
points obtained using the coarse mesh in this study. This is promising considering that this 250K cells mesh has 40x less cells than
the one used in the LESOCC simulation. In the literature Krank et al. 10 used this methodology to compare two conﬁgurations:
a DNS simulation with 65K cells and 33.6M DoFs and an URDNS simulation with 65K cells and 22.5M DoFs. For the latter,
they observed that the reattachment point was closer to the experimental value by Rapp 13 but away from the DNS simulation.
However, this study shows a very clear trend towards the experimental reattachment point as we increase the mesh resolution
along with a reduction of the error bandwidth.

As discussed in Section 4.2, varying the time step has the largest eﬀect on the stresses. Therefore, it is theorised that the time
step has a predominant eﬀect on the resolution of the small eddies at the wall and hence the stresses, which have a small time
scale and so a small time step is required to depict them. This impacts the reattachment point location. Global reﬁnement aﬀects
global factors, and enables a more accurate simulation of the bulk ﬂow and global properties. The ﬁner mesh however makes the
reattachment point more precise, as each cell along the lower wall is smaller and hence there is less uncertainty in those values.
Therefore, reﬁning the mesh has a signiﬁcant eﬀect on the bulk ﬂow accuracy. There is very little variation between the
intermediate (500K), ﬁne (1M), very ﬁne (4M) and ﬁnest mesh (8M), except at the near wall region, which leads to resulting
variation in the recirculation bubble and shear layer. These deviations are small and it is unclear as to whether they show a
greater accuracy, as these are hypothesised to be due to the time parameters, and so even the intermediate mesh is hence deemed
the ideal mesh to use for periodic hills simulations when a stabilization technique is used.

4.5 High-order elements

All the previous simulations considered 𝑄1 elements for both the pressure and the velocity. However, since Lethe also supports
higher-order elements, we decided to investigate this factor by comparing the previous coarse and intermediate meshes with a
very coarse mesh of 120K with 𝑄2 elements. This was done using a time step of 0.025 s and taking the average after 800 s.

Since the separation of the ﬂow is pressure induced, increasing the order of the pressure elements is likely to increase the
overall accuracy. According to the results, there is a good agreement between all Lethe data and the benchmarks. Taking a closer
look to the average velocity proﬁle in 𝑥 direction (see Fig. 15), all three Lethe simulations have very similar results at the bulk
ﬂow and at the upper wall. The only diﬀerence between the proﬁles can be seen at the lower wall, where the 500K mesh is
slightly closer to the benchmarks. For the Reynolds normal stress in the 𝑥 direction the diﬀerence is more signiﬁcant (see Fig.
16). Using high-order elements seems to be better to resolve the smallest eddies in the near-wall region and have closer results
to the numerical results by Breuer 14.

To answer the question whether the simulation of the periodic hills case would beneﬁt from the use of high-order elements
other factors need to be taken into account. While the accuracy seems to be improved near to the wall in the case of the average
velocity and in almost all regions in the case of the Reynolds stresses, it is also important to consider the diﬀerence of the number
of degrees of freedom and therefore the computational time needed to solve the numerical system. A 𝑄1 element has 32 degrees
of freedom, a 𝑄2 element has 108 degrees of freedom. In this study continuous ﬁnite elements are used, i.e. some of the degrees
of freedom are shared, therefore, the 120K mesh has ≈ 4.5M DoFs, the 250K mesh has ≈ 1.1M DoFs, and the 500K mesh has
≈ 2.4M DoFs. If the property to be calculated is the average velocity, we can take advantage of the 500K 𝑄1𝑄1 mesh that has
very similar results to the 120K 𝑄2𝑄2 mesh, as the size of the numerical system to be solved is approximately half as big and
the computational time decreases accordingly. However, if the Reynolds stresses are of utmost importance, using 120𝐾 𝑄2𝑄2
mesh could be beneﬁcial as it increases the accuracy in almost all of the regions and it has an equivalent number of DoFs to a
ﬁne 𝑄1 mesh with 1M cells.

20

L. PRIETO SAAVEDRA ET AL

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

3.6 3.8 4.0 4.2

7.2 7.4 7.6 7.8

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe - 250K - Q1Q1
Lethe - 500K - Q1Q1

Lethe - 120K - Q2Q2

FIGURE 15 Average velocity in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks. The
proﬁles are scaled by a factor of 0.8 for ease of visualisation.

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

1.2

1.0

0.8

0.6

3.0

2.8

2.6

2.4

3.0 3.2 3.4 3.6

6.6 6.8 7.0 7.2

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe - 250K - Q1Q1
Lethe - 500K - Q1Q1

Lethe - 120K - Q2Q2

FIGURE 16 Reynolds normal stress in the 𝑥 direction throughout the geometry at Re = 5600, compared against the benchmarks.
The proﬁles are scaled by a factor of 5 for ease of visualisation.

4.6 Higher Reynolds numbers

As mentioned in Section 2.4, results with higher Reynolds numbers are available, therefore, we tested our ILES method with
SUPG/GLS stabilization to see how well we can predict important ﬂow properties at Re = 10600 and Re = 37000. For this,
three meshes with 𝑄1𝑄1 elements are considered: very coarse (120K cells), coarse (250K cells) and intermediate (500K cells).
A time step of Δ𝑡 = 0.025 s and a time average of 800 s are used in accordance with the ﬁndings of the previous sections.

The results for Re = 10600 are compared to experimental and computational data by Rapp 13 and Breuer et al. 14, respectively.
In the case of Re = 10600, a good agreement with the average velocity in the 𝑥-direction reported by the benchmarks is obtained
for all meshes (see Figure 17). There is a slight underprediction of the value when the ﬂow separates and in the recirculation
zone. The results for all meshes at the upper wall seem to be very similar, while the diﬀerence is more signiﬁcant in the lower

L. PRIETO SAAVEDRA ET AL

21

1.4

1.2

1.0

0.8

0.0

0.2

0.4

0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

3.6

3.8

4.0

4.2

7.2

7.4

7.6

7.8

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe 120K
Lethe 250K

Lethe 500K

FIGURE 17 Average velocity in the 𝑥 direction throughout the geometry at Re = 10600, compared against the benchmarks.
The proﬁles are scaled by a factor of 0.8 for ease of visualisation.

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

4.0 4.2 4.4 4.6

6.6 6.8 7.0 7.2

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
LESOCC - Breuer 2009

Lethe 120K
Lethe 250K

Lethe 500K

FIGURE 18 Reynolds normal stress in the 𝑥 direction throughout the geometry at Re = 10600, compared against the
benchmarks. The proﬁles are scaled by a factor of 5 for ease of visualisation.

wall zone. The reattachment points obtained for this case using the diﬀerent meshes, starting from the coarse and moving to the
ﬁne are 𝑥∕ℎ = 4.54, 4.90 and 4.01. This is in agreement with the results obtained experimentally by Rapp (𝑥∕ℎ = 4.21), where
the point of reattachment moves upstream with increasing Reynolds number as the recirculation zone ﬂattens. Also, the ﬁrst two
values are very near to the reattachment point obtained by Breuer et al. (𝑥∕ℎ = 4.69). As explained in previous sections, the
reattachment point seems to be more sensitive to the time parameters, hence it is possible that a larger time averaging period is
required to obtain more accurate results. In the case of the Reynolds stresses (see Figure 18) all the meshes tend to overpredict
the stresses throughout the channel.

The results for the case with Re = 37000 were only compared to the experimental benchmark as Breuer et al. did not
conduct any study using LESOCC for this Reynolds number. We see a similar trend on the estimation of the average velocity

22

L. PRIETO SAAVEDRA ET AL

1.4

1.2

1.0

0.8

0.0

0.2

0.4

0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

3.6

3.8

4.0

4.2

7.2

7.4

7.6

7.8

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
Lethe 120K

Lethe 250K
Lethe 500K

FIGURE 19 Average velocity in the 𝑥 direction throughout the geometry at Re = 37000, compared against the benchmarks.
The proﬁles are scaled by a factor of 0.8 for ease of visualisation.

1.4

1.2

1.0

0.8

0.0 0.2 0.4 0.6

0.6

0.4

0.2

0.0

3.0

2.8

2.6

2.4

4.0 4.2 4.4 4.6

6.6 6.8 7.0 7.2

h
/
y

3

2

1

0

0

1

2

3

4

5

6

7

8

9

x/h

Experimental - Rapp 2009
Lethe 120K

Lethe 250K
Lethe 500K

FIGURE 20 Reynolds normal stress in the 𝑥 direction throughout the geometry at Re = 37000, compared against the
benchmarks. The proﬁles are scaled by a factor of 5 for ease of visualisation.

and the Reynolds stresses. In Figure 19, there is an underprediction of the velocity in the lower region of the channel and an
overprediction on the upper region, having a higher discrepancy near to the walls. A higher diﬀerence between the results of
the diﬀerent meshes can be observed in the results for the Reynolds stresses (see Figure 20), where the results do not have a
clear trend near to the separation zone but in the post-reattachment zone the intermediate mesh obtains results nearer to the
experimental ones. As pointed out by Rapp, to accurately predict the high near-wall peak obtained with this Reynolds number
is of utter importance to have a correct prediction of Reynolds stresses at the windward side of the hill.

The reattachment points obtained in this case were 𝑥∕ℎ = 4.20, 4.09 and 3.49 for the three meshes from coarse to ﬁne.
Experimentally, the reattachment point was determined to be equal to 3.76. Therefore, reﬁning the mesh, seems to help to have
a better resolution of the ﬂow properties allowing the reattachment point to move upstream. However, as in the previous case, it

L. PRIETO SAAVEDRA ET AL

23

may be necessary to have a larger time averaging period as the ﬂuctuations are stronger. This section demonstrates the capabilities
of this ILES approach to simulate higher Reynolds numbers for turbulent ﬂows with complex characteristics and the need of
improving the predictions to be able to understand phenomena that are not easy to observe experimentally.

5

CONCLUSION

Multiple simulations for ﬂow over periodic hills at Re = 5600 have been completed using an stabilized ﬁnite element ILES
approach implemented in the open-source software Lethe. The use of this numerical method for modelling this simulation
case was validated by comparison to two previous studies, meeting the ﬁrst aim of this study. This method can now be used
for simulations which require modelling of complex turbulence patterns, separated ﬂows and wall eﬀects with conﬁdence.
Furthermore, the method performs well even when using meshes coarser and time steps larger than those typically used in
periodic hills studies, increasing its feasibility in similar applications.

In general, it was found that a time step of 0.025 s, a static mesh of 500K cells and results extracted after 800 s give the
most accurate results at a reasonable computing time, with a reattachment point of 𝑥∕ℎ = 4.82 ± 0.02. This time step is small
enough to ensure that temporal changes are captured. The CFL stability condition ensures that the time step is suﬃciently small
for explicit time schemes, but for an implicit scheme such as the one used by Lethe, the use of a larger time step reduces the
computational expense by reducing the number of iterations required to reach the ﬁnal simulation run time. The time step chosen
is a compromise of the temporal resolution and number of iterations.

With the time step of 0.025 s, the data should be extracted after 800 s, where averaging has occurred over a span of 66 ﬂow
throughs. This ensures that statistical steadiness is reached, but the simulation is not run for an unnecessarily long time and uses
excessive computation power. Regarding the mesh itself, increasing the global reﬁnement resolves the global turbulence more
accurately. It can be seen that as more cells are used, the accuracy is increased near to the wall region, however, good agreement
to the benchmarks for the velocity and Reynolds stresses can be already found using a mesh of 500K cells. When it comes to the
reattachment point, it converges towards the experimental value given by the experimental benchmark as the mesh is reﬁned. In
fact, the results for the reattachment point for a mesh of 1M cells are very near to the ones of the 4M cells.

In the case of higher-order elements, the experiments resulted in good accuracy with signiﬁcantly coarser meshes. A 120K
mesh with high-order 𝑄2𝑄2 elements could be beneﬁcial for the periodic hills case as it increases the Reynolds stresses accuracy,
however, it has a similar number of degrees of freedom in comparison to the 1M mesh with 𝑄1𝑄1 elements for both pressure
and velocity. The method was also tested for Re = 10600 and Re = 37000. It was observed that as the Reynolds number is
increased, the reattachment moves upstream and the recirculation zone ﬂattens. While the ILES approach used in this study
obtains accurate results for the velocity for Re = 10600, the Reynolds stresses are highly aﬀected near to the separation and
post-reattachment zones. The results have higher discrepancies at Re = 37000, where signiﬁcant diﬀerences are observed not
only at the wall but also in the bulk of the ﬂow.

Therefore, a complete study of the inﬂuence of the time and mesh parameters on an ILES solver using a SUPG/PSPG stabi-
lization was conducted. It is believed that these parameters will also apply for other ILES solver, and so should provide a good
initial simulation setup. This study has not only provided a greater understanding of how the numerical parameters aﬀect the
simulation results, but also shows that ILES methods are able to provide very good solutions for these type of complex ﬂows
with coarser meshes than the ones used in literature. In fact, it shows that ILES methods are promising as they provide accu-
racy, do not require the calibration of a subgrid scale model and can reduce the computational eﬀort, in terms of mesh size and
degrees of freedom of the numerical system.

6

ACKNOWLEDGEMENTS

The authors would like to acknowledge the ﬁnancial support from the Natural Sciences and Engineering Research Council
of Canada (NSERC) through the RGPIN-2020-04510 Discovery grant. The authors would also like to acknowledge technical
support and computing time provided by the Digital Research Alliance of Canada and Calcul Québec.

24

7

APPENDIX

7.1 Geometry of hills

The 6 polynomials used to describe the shape of the hill are:

L. PRIETO SAAVEDRA ET AL

𝑥 ∈ [0; 0.3214ℎ]; 𝑦(𝑥) = min(ℎ; ℎ + 0ℎ𝑥 + 2.420ℎ × 10−4𝑥2 − 7.588ℎ × 10−5𝑥3)
𝑥 ∈ [0.3214ℎ; 0.5ℎ]; 𝑦(𝑥) = 0.8955ℎ + 3.484ℎ × 10−2𝑥 − 3.629ℎ × 10−3𝑥2 + 6.749ℎ × 10−5𝑥3
𝑥 ∈ [0.5ℎ; 0.7143ℎ]; 𝑦(𝑥) = 0.9213ℎ + 2.931ℎ × 10−2𝑥 − 3.234ℎ × 10−3𝑥2 + 5.809ℎ × 10−5𝑥3
𝑥 ∈ [0.7143ℎ; 1.071ℎ]; 𝑦(𝑥) = 1.445ℎ − 4.927ℎ × 10−2𝑥 + 6.950ℎ × 10−4𝑥2 − 7.394ℎ × 10−6𝑥3
𝑥 ∈ [1.071ℎ; 1.429ℎ]; 𝑦(𝑥) = 0.6401ℎ + 3.123ℎ × 10−2𝑥 − 1.988ℎ × 10−3𝑥2 + 2.242ℎ × 10−5𝑥3
𝑥 ∈ [1.429ℎ; 1.929ℎ]; 𝑦(𝑥) = max(0; 2.0139ℎ − 7.180ℎ × 10−2𝑥 + 5.875ℎ × 10−4𝑥2 + 9.553ℎ × 10−7𝑥3)

References

1. ERCOFTAC . 2D Periodic Hill Flow.; 2017.

2. Gloerfelt X, Cinnella P. Large Eddy Simulation Requirements for the Flow over Periodic Hills. Flow Turbulence and

Combustion 2019; 103: 55–91. doi: 10.1007/s10494-018-0005-5

3. Beck AD, Bolemann T, Flad D, et al. High-order discontinuous Galerkin spectral element methods for transi-
tional and turbulent ﬂow simulations. International Journal for Numerical Methods in Fluids 2014; 76(8): 522-548.
doi: https://doi.org/10.1002/ﬂd.3943

4. Mokhtarpoor R, Heinz S. Dynamic large eddy simulation: Stability via realizability. Physics of Fluids 2017; 29(10): 105104.

doi: 10.1063/1.4986890

5. Wang R, Wu F, Xu H, Sherwin SJ. Implicit large-eddy simulations of turbulent ﬂow in a channel via spectral/hp element

methods. Physics of Fluids 2021; 33(3): 035130. doi: 10.1063/5.0040845

6. S. Hickel TKNAA. Implicit large-eddy simulation applied to turbulent channel ﬂow with periodic constrictions. Theoretical

and Computational Fluid Dynamics 2008; 22: 227–242.

7. Chen ZL, Hickel S, Devesa A, Berland J, Adams NA. Wall modeling for implicit large-eddy simulation and immersed-

interface methods.. Theor. Comput. Fluid Dyn. 2014; 28: 1-21.

8. Li Z, Zhang Y, Chen H. A low dissipation numerical scheme for Implicit Large Eddy Simulation. Computers & Fluids

2015; 117: 233-246. doi: https://doi.org/10.1016/j.compﬂuid.2015.05.016

9. Balakumar P, Park GI. DNS/LES Simulations of Separated Flows at High Reynolds Numbers. In: ; 2015

10. Benjamin Krank MKWAW. Direct Numerical Simulation of Flow over Periodic Hills up to ReH=10,595. Flow Turbulence

Combust 2018; 101: 521-551.

11. Krank B, Fehn N, Wall WA, Kronbichler M. A high-order semi-explicit discontinuous Galerkin solver for 3D incompressible
ﬂow with application to DNS and LES of turbulent channel ﬂow. Journal of Computational Physics 2017; 348: 634-659.
doi: https://doi.org/10.1016/j.jcp.2017.07.039

12. Sadrehaghighi I. Turbulence modeling. Annapolis, MD: CFD Open Series . 2019.

13. Rapp C. Experimentelle Studie der turbulenten Strömung über periodische Hügel. PhD thesis. Technische Universität

München, ; 2009.

14. Breuer M, Peller N, Rapp C, Manhart M. Flow over periodic hills – Numerical and experimental study in a wide range of
Reynolds numbers. Computers & Fluids 2009; 38(2): 433-457. doi: https://doi.org/10.1016/j.compﬂuid.2008.05.002

L. PRIETO SAAVEDRA ET AL

15. Arndt D, Bangerth W, Blais B, et al. The deal.II Library, Version 9.2. Journal of Numerical Mathematics 2020.

pressdoi: 10.1515/jnma-2019-0064

25

in

16. Arndt D, Bangerth W, Blais B, et al. The deal.II Library, Version 9.3. Journal of Numerical Mathematics 2021; 29(3):

171–186. doi: 10.1515/jnma-2021-0081

17. Kornhaas M, Sternel DC, Schäfer M. Inﬂuence of Time Step Size and Convergence Criteria on Large Eddy Simulations with
Implicit Time Discretization. In: Meyers J, Geurts BJ, Sagaut P., eds. Quality and Reliability of Large-Eddy Simulations.
12. 2008 (pp. 119)

18. Mellen CP, Fröhlich J, Rodi W. Large-eddy simulation of the ﬂow over periodic hills. In: Deville M, Owens R., eds. 16th

IMACS world congress16th IMACS world congress. ; 2000; Lausanne, Switzerland.

19. Rapp C, Manhart M. Flow over periodic hills: An experimental study. Experiments in Fluids 2011; 51: 247-269.

doi: 10.1007/s00348-011-1045-y

20. Feöhlich J, Mellen CP, Rodi W, Temmerman L, Leschzinger MA. Highly resolved large-eddy simulation of sep-
arated ﬂow in a channel with streamwise periodic constrictions. Journal of Fluid Mechanics 2005; 526: 19–66.
doi: 10.1017/S0022112004002812

21. Gloerfelt X, Cinnella P. Investigation of the ﬂow dynamics in a channel constricted by periodic hills. In: American Institute

of Aeronautics and Astronautics (AIAA); 2015.

22. ERCOFTAC . File:Hill3d.jpg.; 2010.

23. Benocci C, Pinelli A. The role of the forcing term in the large eddy simulation of equilibrium channel ﬂow. In: Elsevier.
1990 (pp. 287–296). International Symposium On Engineering Turbulence Modelling And Measurements , Dubrovnik,
Yugoslavia, Sep 24-28, 1990.

24. Chaouat B, Schiestel R. Hybrid RANS/LES simulations of the turbulent ﬂow over periodic hills at high Reynolds number
using the PITM method. Computers & Fluids 2013; 84: 279-300. doi: https://doi.org/10.1016/j.compﬂuid.2013.06.012

25. Mokhtarpoor R, Heinz S, Stoellinger M. Dynamic uniﬁed RANS-LES simulations of high reynolds number separated ﬂows.

Physics of Fluids 2016; 28(9). doi: 10.1063/1.4961254

26. de la Llave Plata M, Couaillier V, Pape lMC. DNS and LES of the ﬂow over periodic hills based on a discon-
tinuous Galerkin approach. Notes on Numerical Fluid Mechanics and Multidisciplinary Design 2018; 135: 27–40.
doi: 10.1007/978-3-319-60387-2_3

27. Lodato G, Chapelier JB. Evaluation of the spectral element dynamic model for LES on unstructured, deformed meshes.

ERCOFTAC Series 2019; 25: 39–45. doi: 10.1007/978-3-030-04915-7_6

28. Diosady LT, Murman SM. DNS of Flows over Periodic Hills using a Discontinuous-Galerkin Spectral-Element Method.;

2014.

29. Xiao H, Laizet S, Duan L. Flows Over Periodic Hills of Parameterized Geometries: A Dataset for Data-Driven Turbulence

Modeling From Direct Simulations. Computers & Fluids 2020: 104431. doi: 10.1016/j.compﬂuid.2020.104431

30. Chen Z. Wall Modeling for Implicit Large-Eddy Simulation. PHDthesis 2010.

31. Blais B, Barbeau L, Bibeau V, et al. Lethe: An open-source parallel high-order adaptative CFD solver for incompressible

ﬂows. SoftwareX 2020; 12: 100579.

32. Tezduyar TE. Stabilized ﬁnite element formulations for incompressible ﬂow computations. In: . 28. Elsevier. 1992 (pp.

1–44).

33. Ilinca F, Yu KR, Blais B. The eﬀect of viscosity on free surface ﬂow inside an angularly oscillating rectangular tank.

Computers and Fluids 2019. doi: 10.1016/j.compﬂuid.2019.02.021

26

L. PRIETO SAAVEDRA ET AL

34. Tezduyar TE, Mittal S, Ray SE, Shih R. Incompressible ﬂow computations with stabilized bilinear and linear equal-order-
interpolation velocity-pressure elements. Computer Methods in Applied Mechanics and Engineering 1992; 95(2): 221–242.
doi: 10.1016/0045-7825(92)90141-6

35. Blais B, Ilinca F. Development and validation of a stabilized immersed boundary CFD model for freezing and melting with

natural convection. Computers and Fluids 2018. doi: 10.1016/j.compﬂuid.2018.03.037

36. Hay A, Etienne S, Pelletier D, Garon A. Hp-Adaptive time integration based on the BDF for viscous ﬂows. Journal of

Computational Physics 2015; 291: 151–176. doi: 10.1016/j.jcp.2015.03.022

37. Pope SB. Turbulent ﬂows. Cambridge, UK: Cambridge University Press . 2000.

38. Mitchell M, Muftakhidinov B, Winchen T, Schaik vB, Wilms A, others . Engauge digitizer software. Webpage:

http://markummitchell. github. io/engauge-digitizer. 2017; 11.

39. Piomelli U. Large eddy simulations in 2030 and beyond.. Phil. Trans. R. Soc. A. 2014; 372.

40. Li L, Hu D, Liu Y, et al. Large Eddy Simulation of Cavitating Flows with Dynamic Adaptive Mesh Reﬁnement using

OpenFOAM. Journal of Hydrodynamics 2018. doi: 10.1007/s42241-019-0041-1

41. Iacovella CR, Klein C, Sallai J, , Ismail AE. Validation of Computational Models and Codes. In: F. T. Wilmore CC., ed.

Introduction to Scientiﬁc and Technical ComputingBoca Raton, FL: CRC Press. 2017 (pp. 261-272).

42. Ge X, Vasilyev OV, Hussaini MY. Wavelet-based adaptive delayed detached eddy simulations for wall-bounded compress-

ible turbulent ﬂows. Journal of Fluid Mechanics 2019; 873: 1116–1157. doi: 10.1017/jfm.2019.449

43. Semakin A, Rastigejev Y. Numerical Simulation of Global-Scale Atmospheric Chemical Transport with High-
Order Wavelet-Based Adaptive Mesh Reﬁnement Algorithm. Monthly Weather Review 2016; 144: 160219143436009.
doi: 10.1175/MWR-D-15-0200.1

44. B. C. The State of the Art of Hybrid RANS/LES Modeling for the Simulation of Turbulent Flows. Flow Turbulence Combust

2017; 99: 279-327.

45. Li L, Hu D, Liu Y, et al. Large eddy simulation of cavitating ﬂows with dynamic adaptive mesh reﬁnement using

OpenFOAM. Journal of Hydrodynamics 2020; 32: 398-409.

46. Červený J, Dobrev V, Kolev T. Nonconforming Mesh Reﬁnement for High-Order Finite Elements. SIAM Journal on

Scientiﬁc Computing 2019; 41(4): C367-C392. doi: 10.1137/18M1193992

47. Hertel C, Schümichen M, Löbig S, Fröhlich J, Lang J. Adaptive large eddy simulation with moving grids. Theoretical and

computational ﬂuid dynamics 2013; 27(6): 817–841.

L. PRIETO SAAVEDRA ET AL

27

How to cite this article: L. Prieto Saavedra, C. E. N. Radburn, A. Collard-Daigneault, B. Blais (2022), An implicit large-eddy
simulation perspective on the ﬂow over periodic hills, 2022;1–26.

