ModelsofAdvanceRecordingSystems:AMulti-timescaleMicromagneticcodeforgranularthinﬁlmmagneticrecordingsystemsS.E.Rannalaa,∗,A.Meoa,b,S.Rutaa,c,W.Pantasrib,R.W.Chantrella,P.Chureemartb,J.Chureemartb,∗aDepartmentofPhysics,UniversityofYork,York,YO105BP,U.K.bDepartmentofPhysics,MahasarakhamUniversity,Mahasarakham,44150,ThailandcCollegeofBusiness,TechnologyandEngineering,SheﬃeldHallamUniversity,Sheﬃeld,U.K.AbstractMicromagneticmodellingprovidestheabilitytosimulatelargemagneticsystemsaccuratelywithoutthecomputationalcostlimita-tionimposedbyatomisticmodelling.Throughmicromagneticmodellingitispossibletosimulatesystemsconsistingofthousandsofgrainsoveratimerangeofnanosecondstoyears,dependinguponthesolverused.Herewepresentthecreationandreleaseofanopen-sourcemulti-timescalemicromagneticcodecombiningthreekeysolvers:Landau-Lifshitz-Gilbert;Landau-Lifshitz-Bloch;KineticMonteCarlo.Thiscode,calledMARS(ModelsofAdvancedRecordingSystems),iscapableofaccuratelysimulatingthemagnetisationdynamicsinlargeandstructurallycomplexsingle-andmulti-layeredgranularsystems.Theshorttimescalesimu-lationsareachievedforsystemsfarfromandclosetotheCuriepointviatheimplementedLandau-Lifshitz-GilbertandLandau-Lifshitz-Blochsolversrespectively.Thisenablesread/writesimulationsforgeneralperpendicularmagneticrecordingandalsostateoftheartheatassistedmagneticrecording(HAMR).ThelongtimescalebehaviourissimulatedviatheKineticMonteCarlosolver,enablinginvestigationsintosignal-to-noiseratioanddatalongevity.Thecombinationofthesesolversopensupthepossibilityofmulti-timescalesimulationswithinasinglesoftwarepackage.ForexampletheentireHAMRprocessfrominitialdatawritinganddatareadbacktolongtermdatastorageispossibleviaasinglesimulationusingMARS.TheuseofatomisticparameterisationforthematerialinputofMARSenableshighlyaccuratematerialdescriptionswhichprovideabridgebetweenatomisticsimulationandrealworldexperimentation.ThusMARSiscapableofperformingsimulationsforallaspectsofrecordingmediaresearchanddevelopment.Thisrangesfrommaterialcharacterisationandoptimisationtosystemdesignandimplementation.Theobjectori-entatednatureofMARSisstructuredtofacilitatequickandsimpledevelopmentandeasyimplementationofuserdeﬁnedcustomsimulationtypeswhichcanutiliseeithertimescaleoracombinationofbothtimescales.Keywords:HAMR,LLG,LLB,kMC,spindynamicsPROGRAMSUMMARYProgramTitle:MARSDeveloper’srepositorylink:https://bitbucket.org/EwanRannala/mars/Licensingprovisions:MITProgramminglanguage:C++Supplementarymaterial:MARStestingmethodologyNatureofproblem:Acombinedmodelthatenablesthecompletemodellingofmagneticrecordingprocessesatelevatedtemperaturescoveringalltimescalesfromwriting(nanoseconds)uptolongtermdatastorage(years).Themodelmustalsoaccuratelydescribethegranularnatureoftherecordingmediaasgrainsizesarereducedtoafewnanometres.Solutionmethod:ShorttimescalebehavioursarecapturedviatheLandau-Lifshitz-GilbertandLandau-Lifshitz-Blochsolversforlowandhightemperaturesystemsrespectively.ThelongtimescalebehavioursiscapturedviaakineticMonteCarlosolver.Toenablecomplexmodelswhichaccountformixedtimescalebehavioursthe∗CorrespondingauthorsEmailaddresses:ser527@york.ac.uk(S.E.Rannala),jessada.c@msu.ac.th(J.Chureemart)solversareimplementedasasingleclassstructurewhichallowsfordynamicsolverselection.ThegranularstructureisgeneratedviaaLaguerre-Voronoitessellationwithacustomimplementedpackingalgorithmtoproducehighlyrealisticgrainsizedistributions.Complexthermaldependenciesofmaterialscanbeincorporatedviaatomisticparameterisationformingamulti-timescalemodelofthematerial.1.IntroductionMagneticrecordingusingharddiskdrivesremainsthedom-inanttechnologyforcloud-basedinformationstorage.Asdatacentresconsumesuﬃcientenergytorepresentasigniﬁcantcon-tributiontoglobalwarmingthereisanimperativetoimproveenergyeﬃciencyandminimisetherequirednumberofdatacentresbymeansofincreasingstoragedensity.Inordertoachievethepropertiesrequiredformagneticinformationstor-age,thestoragemediummustbegranularinnature.Thees-sentialrequiredpropertyforthestorageofbinaryinformationisthepresenceofalargemagneticanisotropy(K):thematerialpropertywhichprovidesanenergybarriertoswitchingofthemagnetisationandtherebycreatesatwo-statemagneticsystem.TheincreaseofarealdensitygenerallyproceedsbyascalingarXiv:2205.05263v1  [physics.comp-ph]  11 May 2022ofproperties,particularlyareductionofthegrainsizetoen-sureadequatesignaltonoiseratio(SNR)giventhereductioninbitsize.ThisnecessitatesanincreaseinthevalueofKtoensurethermalstability,whichmakesthewritingofindividualbitsmorediﬃcultduetoanincreaseinwriteﬁeld:themag-netic‘trilemma’[1].Currenttechnology(perpendicularmag-neticrecording)isalreadyrunningintowrite-ﬁeldlimitationsandastepchangeoftechnologyisrequiredforfutureprod-ucts.BasedontheASRC(AdvancedStorageResearchCon-sortium)roadmap,therearetwofuturetechnologies:1)heatassistedmagneticrecording(HAMR)and2)Bitpatternedmag-neticrecording(BPMR),whichcombinedcanleadtoHeated-Dotmagneticrecording[2].Tofacilitatethedevelopmentandoptimisationofthepresent-dayandfuturemagneticrecordingtechnologiesadvancedmodelswithgreaterlevelsofcomplexityarerequired.Thesemodelsmustcapturethedynamicsatbothshortandlongtimescalesoveralargenumberofbits/grainswhilstaccuratelydescribingthevariationofmagneticﬁelds,temperaturesandtemperaturedependentparameters.HAMRiscurrentlythemostpromisingnewtechnologytoproviderecordingdensitiessigniﬁcantlygreaterthanthoseavailableviacurrentstandardperpendicularmagneticrecord-ing[3].HAMRprovidesincreasedarealdensitiesthroughtheutilisationofhighcoercivitymaterials,potentiallyenablingupto4Tb/in2[4].Theinitialdiﬃcultywithusinghighcoerciv-itymaterialsistherequirementofincreasedwritingheadﬁeldgradients.Thesolutiontothisistotemporarilyreducethecoercivityofthemedium,thusenablingwritingwithreducedﬁeldstrengths.Thisprocessisachievedbyapplyingalaserpulsetoheatthematerialandcauseareductioninthematerialanisotropy.ThephysicsofHAMR,involvingheatinguptoorbeyondthemagneticordering(Curie)temperatureTcremainschallengingandinvolvesmodelswithathermodynamicbasisbeyondthescopeofthoseusedinthetypicalmicromagneticapproach.Atomisticmodelsprovidethislevelofdetailandhavebeenusedtoprovidetemperaturedependentmagneticpropertiesandreversalmechanismsinrecordingmedia[5,6,7,8,9,10,11,12,13,14].Althoughatomisticsimulationscanprovideexcep-tionaldetailoftheunderlyingphysicalprocesseswhichgov-erntheirmacroscopicpropertiesthesesimulationscarryasig-niﬁcantcomputationalcost.Thiscostlimitsatomisticsimula-tionsofrecordingmediatoalengthscaleofafewgrainsandatimescaleofnanoseconds.Thissigniﬁcantcomputationalcostlimitstheinvestigationofstatisticalvariationinparticleprop-ertiesandinter-particleinteractionortemperature/ﬁeldproﬁlesoveratrackofrecordingbits.However,tobeabletodesign,testandoptimiseanypresent-dayandfuturemagneticrecord-ingtechnology,itisvitaltocapturetherecordingofthousandsofgrainsfromthesub-nanosecondtimescaletoadatastoragetimescale(5-10years).Furthermore,experimentalcharacterisationsandtestsareperformedatthenanosecondtimescaleforFMRandmillisec-ondtimescaleforstandardmeasurementssuchashysteresisloops,thermaldecay,FirstOrderReversalCurves(FORC)andthermoremanence[15,16].Overlongtimescales,thermallyactivatedtransitionsovertheenergybarrierscanleadtolossnmmmmmpsnsmsmssdaysyearsLLB/LLGkMCMulti-timescale micromagnetics (MARS)Atomistic and MARSAtomisticLengthscaleTimescaleHAMR-writeFMRHAMR-readfsFigure1:Illustrationofthetime/lengthscalesrequiredbysomecommonsim-ulations.ofrecordedinformation.TransitiontimesaregovernedbytheArrhenius-N´eellaw[17],whichgivesacharacteristictimeτ−1=f0exp(KV/kT),whereVisthegrainvolumeandKisthemagneticanisotropyconstant.Thepre-exponentialfactorisdependentonthevalueofKandisintheregionofGHztoTHz.Ensuringthermalstabilityofthewritteninformationfor5-10yearsrequireslargeenergybarriers(KV/kT>80)andgoodSNR.Typicallyshortandlongtimescaleinvestigationsareperformedseparately,mainlyduetothedescribedfundamentaldiﬀerencebetweenthesimulationmethodology.Nonetheless,therearenumerouscaseswherebothtimescalesareofinterest,thesimplestexampleofthisistheeﬀectofthewritingpro-cessonnearbybits(nanosecondtimescale)anddatalongevity(timescaleofyears).Herewepresentthedevelopedmulti-timescalemicromag-neticcode,MARS(ModelsofAdvancedRecordingSystems),whichhasthefunctionalityofutilisingvarioussolverstobestaccommodatetherequiredsimulationtimeframes.MARSincludesbothshortandlongtimescalesolverstomakesuchinvestigationsmoresimpleandtoopenupthepossibilitytomoreeasilyaccesstheeﬀectofdynamicprocessesonthelongtimescalebehaviour.MARSincludesastochastic-Landau-Lifshitz-Gilbert(sLLG)equationsolveralongwithastochastic-Landau-Lifshitz-Blochsolver,speciﬁcallythesLLB-II(whichisshowntohavegreateraccuracyattheCurietemperature[18]),tosimulateshorttimescaledynamicsofthemagnetisa-tion.AkineticMonte-Carlo(kMC)solverisalsoincludedinordertosimulatethelongtimescalebehaviour.Fig.1illustratesthebeneﬁtsofthemulti-timescalemicromagneticapproachovercomputationallyexpensiveatomisticsimulations.Thead-ditionofthekMCsolverenablesthesimulationoftimescalesfarbeyondthestandardssetusingdynamicalmicromagneticsolversalone.MARShasbeendesignedtobeusedalongsideatomisticsimulationsbyutilisingparameterisationobtainedviaatomisticsimulationtodescribematerialproperties,thisallowsforhighlyaccuratedescriptionsofsimulatedmaterials.ThereisnolimitonthenumberofmaterialsMARScanutiliseinasinglesim-2(a)(b)(c)(d)(e)Figure2:ExampleofthegranularstructureobtainedviathecentroidalVoronoitessellation(a).AsubsectionhasbeenchosentoillustrateLloyd’srelaxationalgorithmafter:zero(b),one(c),two(d)andthree(e)iterations.Theseedpointsareindicatedbythecrosseswiththecentroidsrepresentedbythecircles.Asmoreiterationsareperformedtheangularnatureofthegrainsisreduced.ulation.Thisenablesmulti-layeredsystemssuchasthoseusedforexchange-coupled-compositestobesimulated.Detailsofgranularsystemgenerationandthenumericalsolversarepro-videdinsection2.MARSincludesasetofcommonlyusedsimulationtypesforeasyuse,theseinclude:HAMRwriting,timeevolutionanddatareadback,thermoremanence,FORCandFMR.Aselectionofresultsobtainedviathesesimulationsareprovidedanddiscussedinsection3.2.MARS:multiscaleframework2.1.GranularmodelThemicromagneticapproachconsistsoftreatingmagneticgrainsasmacrospinswithassociatedmagnetisation,m.Toen-sureaccuratemodellingofthesesystemsitiscrucialtogenerateaccurategranularstructures.ThetypicalmethodforgeneratinggranularstructuresisviaVoronoitessellation[19,20,21,22].TheclassicalVoronoialgorithmstartswiththecreationofseedpointsthroughoutthesystem,cellwallsarethencreatedsuchthattheyliehalfwaybetweentwoseedpoints.Whilethegen-eralprocessisthesamethereexistvariousmethodstodeter-minetheinitiallocationsoftheseedpoints[23,24].AmajordrawbackwiththeclassicalVoronoiconstructionisevidentwhenadistributionofgrainsizesisrequired.Whenthereisalocalincreaseinseeddensitytheconstructioncangenerateunrealisticallyangularcells.Thisoccursduetotheonlyconstraintoncellconstructionbeingtherequirementthatthecellwallmustbeequidistantbetweenseedpoints.Toovercomethisdrawback,onecanutilisecentroidalVoronoitessellation,thismodiﬁedVoronoiprocesshasbeenshowntobemosteﬀectivewhencombinedwithLloyd’salgo-rithm[25,26].Theprocessinvolvesiterativerelaxationoftheconstructedgranularsystembyreplacingtheinitialseedpointswiththecentroids(typicallyknownasthecentreofmass)ofthegeneratedcellsuntilconvergenceisachieved.Fig.2showsthesystemgeneratedviaMARSusingcentroidalVoronoitessel-lationfollowedbythechangesproducedbyapplyingLloyd’salgorithmoverthreeiterations.Akeylimitationtoallseed-basedconstructiontechniquesisthattheyproduceGaussiancellsizedistributions[27,28].Inre-alitythegrainsizedistributionhasbeenshowntobedescribedbestbylognormalorGammadistributions[29,4,30].Toen-abletheconstructionofsystemsfollowingthesedistributionsamethodforperformingaVoronoiconstructionusing‘harddiscs’insteadofseedsisavailable,calledtheLaguerre-Voronoimethod.ThemainchallengetotheLaguerre-Voronoimethodistheinitialpackingoftherandomlysizedharddiscs.Therearenumerousmethodsforpackingtheseharddiscs,forMARSacustom“DropandRoll”methodhasbeenimplemented.Thismethodprovidesahighlevelofcontactbetweenneighbouringdiscsresultinginagreaterpackingfractionwhilebeingmorecomputationallyeﬃcient[31].UsingthisalgorithmMARSiscapableofgeneratingpackingfractionsofatleast80%forran-domlydistributeddiscsizes.OncethesystemhasbeenpackedthecellsaregeneratedusingtherobustopensourceVORO++packagedevelopedbyRycroft[32].Fig.3showsthediﬀerencebetweenthestructuresgeneratedviathecentroidalVoronoites-sellationandtheLaguerre-Voronoitessellation,thecorrespond-inggrainsizedistributionsareshowninFig.4.Theimple-mentationoftheLaguerre-VoronoitessellationmethodwithinMARSenablesthegenerationofrealisticsystemswithahighlevelofcontroloverthegrainsizedistributions.(a)(b)Figure3:GranularsystemgeneratedfromansinglearrangementofharddiscsviathecentroidalVoronoitessellation(a)andtheLaguerre-Voronoitessellation(b).FormicromagneticsimulationsperiodicboundaryconditionsareusedfortheVoronoitessellationinordertoremoveedgeef-fects,Fig.5showsasystemcreatedviaaLaguerre-Voronoites-sellationwiththeperiodicboundariesindicatedbythedashedlines.2.2.SystemenergyandeﬀectiveﬁeldsForamagneticﬁlmcomposedofNindividualgrains,whichwecanconsiderasmacrospins,theenergyofthesystemcanbe3 0.05 0.1 0.15 0.2 0.25 0.3Centroidal VoronoiGaussian µ=5.04, σ=1.26 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0 2 4 6 8 10 12 14Probability densityGrain Diameter (nm)Laguerre-VoronoiLog-normal µ=1.61, σ=0.50Figure4:GraindiameterdistributionsforcentroidalVoronoitessellation(top)andLaguerre-Voronoitessellation(bottom).Theinputdistributionwaslognor-malwithµ=1.65andσ=0.55.TheseedbasedVoronoiisunabletoprovidethedesireddistribution,insteadprovidingaGaussian.TheLaguerre-Voronoiwasabletoproducethedesireddistributiontypewithonlyasmallchangeofparameters,whichistobeexpectedduetotherandomnatureofthepackingprocess.writtenas:E=−XiViKi(mi·ˆei)2−µ0XiMisVimi·Happ−12Xnnij(MisViMjsVj)Jijmi·mj−µ04πXi,j(MisViMjsVj)3(mi·ˆrrrij)(mj·ˆrrrij)−mi·mjr3ij,(1)whereViisthevolumeofgrainiwithuniaxialanisotropyen-ergydensityKi,easyaxisdirectionˆei,bulksaturationmagneti-sationMisandnormalisedmagnetisationvectormi=Mi/Mis.Theanisotropyenergydensity,saturationmagnetisationandfractionalexchangeconstantJijarealltemperaturedependent.TheﬁrsttermistheZeemanenergywhichdescribestheinter-actionofthegrainswithanexternalappliedﬁeldHapp.Thesecondtermistheanisotropycontributiontotheenergywhichdescribesthepreferredalignmentdirectionforthegrainsmag-netisation.ThethirdtermdescribestheexchangeinteractionbetweennearestneighbourgrainswhichcanbeexpressedintermsofthelocalexchangeﬁeldHiexchThefourthtermisthelong-rangemagnetostaticinteraction,withinthedipoleapprox-imation,whichcouplesgrainsatsitesriandrjatadistancerij=rj−riacrossthewholesystem.Theeﬀectiveﬁeldactingoneachgrainisobtainedfromtheenergyofthesystem(Eq.1)andisgivenby:Hieﬀ=Happ+Hiani+Hiexch+Hidmg.(2)Theindividualtermsaredescribedinthefollowing.Hiexchdescribesthecouplingbetweendiﬀerentgrains,be-longingeithertothesamelayerortodiﬀerentlayersasinthecaseofexchange-coupledcomposite(ECC)media.InthecasexyFigure5:ExampleoftheperiodicsystemgeneratedviaMARSusingaLaguerre-Voronoitessellation.Thegrainscontainingpointsarethosegener-ated,withthedashedlinesindicatingtheperiodicrepetitions.ofagranularmediumtheexchangeresultsfromtheintergran-ularmedium.Althoughthisisengineeredtoensureexchangedecoupling,thisisnotnecessarilycomplete:infactinthecaseofmediaforperpendicularrecordingtheexchange,whichbal-ancestheeﬀectsofthemagnetostaticﬁeld,isapartofthema-terialdesign.Underthereasonableassumptionthattheinter-granularexchangeisproportionaltothecontactareabetweenthegrains,Penget.al.haveshownthattheexchangeHiexchisgivenby[33]:Hiexch=Xj∈neighiHsatJijhAiAiLijhLimj,(3)JijisthefractionalexchangeconstantbetweentheadjacentgrainsandLijisthecontactlengthbetweengrainsiandj,Aiistheareaofgraini,hidenotestheaveragevalueandHsatistheexchangeﬁeldstrengthatsaturation,whichisgener-allyderivedfromexperiment.Sokalskiet.al.[34]investigatedexperimentallytheexchangecouplingbetweenthinlayersofCoCrPtseparatedbyanoxide,ﬁndinganexchangestrengthwhichdecayedexperimentallywithoxidelayerthickness.El-liset.al.[11]foundasimilarrelationusinganatomisticmodelbasedonthepresenceofferromagneticimpuritiesintheox-idelayer.Thisstudyalsoshowedthepresenceofhigherorder(biquadratic)exchangeandimportantlydemonstratedthattheintergranularexchangedecayedtozerorapidlywithincreasingtemperature,suggestingthatintergranularexchangedoesnotplayamajorroleintheHAMRrecordingprocess.Itisimpor-tanttonote,giventhelikelyoriginofintergranularexchangeinthepresenceofimpuritymagneticspinsintheintergranu-larlayer,thatJijcouldvarysigniﬁcantly.AccordingtoPenget.al.[33]thiscanleadtoexchangeweaklinkswhichactaspinningsitesandreducethesizesofclustersarisingfrommag-netostaticinteractions.Hidmgiscalculatedusingthedipoleapproximation:Hidmg=Xj∈neighiWijmj,(4)4whereWijisthedemagnetisationtensorofthesystem:Wij=MsVj4πr3ij3r2ijxr2ij−13rijxrijyr2ij3rijxrijzr2ij3rijyrijxr2ij3r2ijyr2ij−13rijyrijzr2ij3rijzrijxr2ij3rijzrijyr2ij3r2ijzr2ij−1,(5)Visthevolumeofthegrain,rijαisthedisplacementbetweengrainsiandj,withthesubscriptα=x,y,zdenotingthecompo-nentofthedisplacement.AsWijisdependentonlyontheposi-tionandsizeofthegrainsthismatrixcanbedeterminedpriortosimulationinternallyorviaaseparateexternalcode.ImprovedmethodstodeterminetheWmatrixareavailablebutthesepro-duceadditionalcomputationalcost.Onesuchmethodissurfacechargeintegrationasdiscussedin[35].MARSiscapableofac-ceptingtheWmatrixasaninputenablingfastimplementationofalternativemethodsformagnetostaticdetermination.ThetemperaturedependenceofHianiisdescribedusingthefollowingexpression:Hiani(T)=2KiMis(mi(T))η−1(cid:16)mi·ˆei(cid:17)ˆei,(6)whereˆeiistheunitvectoralignedalongtheeasyaxis,KiistheanisotropyandMisisthezerotemperaturesaturationmag-netisationofgraini.Hereweexploitthefactthatwecanex-pressthetemperaturedependenceofKviathedependenceonthemagnetisationmdescribedviaCallen-Callenscaling[36],whichallowsK(T)tobeexpressedas:Ki(T)=Ki0mi(T)η.(7)K0istheanisotropyenergydensityat0Kandηisdeterminedviaexperimentoratomisticparameterisation.Typicallytheex-ponentη=3foruniaxialanisotropyandη=2for2-siteanisotropyappropriateforFePt[37].2.3.DynamicalandkineticMonte-CarloSolversMARSutilisesthreeseparatesolverstodescribethemag-netisation,theLandau-Lifshitz-Gilbert,Landau-Lifshitz-BlochandkineticMonteCarlo.TheLLGandLLBsolversrequireveryshorttimesteps,intheregionofpicosecondsandfem-tosecondsrespectively,tofunctionandprovidedynamicinfor-mationaboutthemagnetisation.ThekMCisaprobabilisticsolverwhichsacriﬁcesthedynamicinformationinordertoen-ablemuchlargertimesteps.Thisenablesthesimulationoflongtimescalephenomena,forexamplethelong-termdecayofwrit-teninformationarisingfromthermalactivation.Eachofthesolverspresentedinthisworkhavebeenrigorouslytestedtoensurecorrectimplementationandhighaccuracy.ThedetailsofthesetestsareprovidedinSupplementaryNotes1-3,withSupplementaryFigures1-7showingcomparisonsbetweenpro-ducedandexpectedtestresults.TheLLGequationofmotionforeachgraini,includingstochasticeﬀects,isgivenby:∂mi∂t=−γe1+α2(cid:16)mi×(Hieﬀ+Hith)(cid:17)−αγe1+α2mi×(cid:16)mi×(Hieﬀ+Hith)(cid:17).(8)TheﬁrsttermdescribesthequantummechanicalprecessionalmotionofthemagnetisationaroundtheeﬀectiveﬁeldHieﬀ,whilethesecondrepresentsthephenomenologicalrelaxationofthemagnetisationtowardsHieﬀ[38].TheGilbertdampingαcouplesthespinsystemwiththeenvironment,consideredtoactasthethermalbath,anddetermineshowfastthesys-temrelaxestowardsequilibrium.Hithisthethermalﬁeld,thisstochasticﬁeldaccountsforthethermallydrivenbehaviourofthemacrospinandisdescribedbyanon-correlatedwhitenoiseGaussianfunction.hHiαth(t)i=0hHiαth(t)Hjβth(t0)i=2αkBTγeMsVδijδαβδ(t−t0),(9)where:i,jlabelthemagnetisationontherespectivesites;α,β=x,y,z;kB=1.381·10−16ergK−1istheBoltzmannconstant;Tisthetemperature;δµγistheKroneckerdeltaandδ(t−t0)isthedeltafunction.Inthisformulationthenoiseisconsideredtobespatiallyandtemporallyuncorrelated,i.e.,whitenoise.Thisapproachworksatrelativelylowtemperatureswhereonecanconsiderthegraintobefullymagneticallysaturatedandtoexhibitcoherentrotationwithallatomicspinsremain-ingparallel.UnderthesecircumstancestheequationofmotionneedonlymodeltransversedynamicprocessesandtheLLGequationisvalid.However,astemperatureincreasesandap-proachestheCuriepointthisisnolongertrueandtheLandau-Lifshitz-Bloch(LLB)equationmustbeusedinstead.TheLLBintroducesalongitudinalrelaxationofthemacrospinwhichac-countsforthelossofmagnetisationanddivergenceofthelon-gitudinalsusceptibilityasthetemperatureapproachestheCuriepoint.TheLLBequationwasﬁrstderivedbyGaranin[39,40].TheLLBequationisasingle(macrospin)representationofthedynamicalbehaviourofasinglegrainanddiﬀersfromtheLLGequationinitsinclusionoflongitudinalrelaxationofthemag-netisation.AlthoughtheLLBequationparameterstobeout-linedbelowwereoriginallyderivedfrommean-ﬁeldtheory,thesecanbeobtainedfromatomisticcalculations.AsshownbyChubykaloet.al.[41],theLLBequationgivesexcellentagree-mentwithatomisticmodelcalculations,essentiallyvalidatingitsuseincalculationsofHAMR,whichinvolveheatingbeyondtheCurietemperature.TheimplementationofthestochasticLLBsolverusedbyMARSfollowstheworkofEvansetal.[18](sLLB-II)andforeachgrainireads:∂mi∂t=−γe(cid:16)mi×Hieﬀ(cid:17)+γeαkmi2(cid:16)mi·Hieﬀ(cid:17)mi−γeα⊥mi2hmi×(cid:16)mi×(cid:16)Hieﬀ+ζi⊥(cid:17)(cid:17)i+ζiad,(10)wheremiisthereducedmagnetisationMi/M(T=0),miisthelengthofmiandγeistheelectrongyromagneticratio.Theﬁrstandthirdtermsaretheprecessionalanddampingtermsforthetransversecomponentofthemagnetisation,asinEq.8,whilethesecondandfourthtermsareintroducedtoaccountforthelongitudinalrelaxationofthemagnetisationwithtemperature.ThestochasticLLGandLLBsolversbothutilisetheHeuninte-grationscheme.ThebeneﬁtsoftheHeunschemearetwo-fold.5Firstitprovidessecondorderaccuracyin∆tforthedetermin-isticpart,thusrenderingitmorenumericallystablethanEulertypeschemes.Second,ityieldstherequiredStratonovichso-lutionofstochasticdiﬀerentialequations.Thedampingofthemagneticmomentissplitintolongitudinalαkandtransverseα⊥componentsgivenby:αk=23TTcλandα⊥=λ 1−T3Tc!,ifT≤Tcα⊥=αk=23TTcλ,otherwise.(11)Whereλisthethermalbathcoupling,atemperatureindepen-dentphenomenologicalparameter,thatisthesameasthatusedinatomisticspindynamics.ThetransversedampingisrelatedtotheGilbertdampingbytheexpression:α=α⊥m,(12)ζ⊥andζadarethediﬀusioncoeﬃcientsthataccountforthethermalﬂuctuations.ThethermalnoisetermsaredescribedbyGaussianfunctionswithzeroaverageandavariancepropor-tionaltothestrengthoftheﬂuctuations:<ζiαad(t)ζjβad(t0)>=2|γ|kBTαkMsVδijδαβδ(t−t0)<ζiα⊥(t)ζjβ⊥(t0)>=2kBT(α⊥−αk)|γ|MsVα2⊥δijδαβδ(t−t0).(13)AstemperaturesapproachandexceedtheCuriepoint,Eq.6producesaﬁctitiouslongitudinalcomponentoftheanisotropy.Thisleadstoareductioninthelongitudinalrelaxationofthemagnetisationasafunctionoftemperature.Toovercomethisissuetheanisotropyﬁeldcanalsobedescribedasafunctionofthetransversesusceptibilityχ⊥[40]:Hiani=−(mixˆx+miyˆy)χ⊥,(14)wheremixandmiyarethecomponentsofthereducedmagneti-sationvectorandˆx,ˆyaretheunitvectoralongthesedirections,respectively.UnlikeEq.6thisformoftheanisotropyassumesthattheeasyaxisliesalongthez-axishoweveritisvalidforalltemperaturerangesandisthereforethemostsuitabledescrip-tionforLLBapplications.Forsoftmaterialsthedetermina-tionofχ⊥isextremelychallengingandthusbothformsoftheanisotropyareavailableforusewiththeLLBsolvertoenablethesimulationofbothhardandsoftmaterials.TheLLBequationincludesanadditionalﬁeldterm,Hiintragrain,withintheeﬀectiveﬁeld.Thistermaccountsfortheexchangebetweentheatomswithingraini,controlsthelengthofthemagnetisationandisgivenbyHiintragrain=12˜χk1−mi2m2emi,ifT≤Tc−1˜χk 1+35TcT−Tcmi2!mi,otherwise.(15)0.00.20.40.60.81.00100200300400500600700800900TcMagnetisation lengthTemperature (K)Polynomial fitCritical exponent fitAtomisticFigure6:Comparisonoftheﬁttingsofthemagnetisationachievedfora5nmgrainviathetwoavailablemethodsimplementedinMARS.Thedotsrepresenttheatomisticdata,whilethelinesshowtheﬁts.Heremiislengthofthereducedmagnetisationmiofgraini,andme(T)istheequilibriummagnetisation.ThetermHintragrainen-capsulatesthenewphysicsintroducedbytheLLBequation.Itincorporatesthelongitudinalﬂuctuationsofthemagnetisationwhilemaintainingameanvalueme(T).Itisimportanttonotethattheﬂuctuationsdivergeas˜χkdivergesclosetoTc.ThisisresponsiblefortheonsetofthelinearreversalmodelclosetoTc.ClearlyspeciﬁcationofthetemperaturedependenceoftheLLBparametersisofparamountimportance:afactorcompli-catedbytheeﬀectsofﬁnitesizeonthemagneticproperties.2.3.1.AtomisticparameterisationThegranularmodelrequirescharacterisationofthetemper-aturedependenceofthemagnetisation,anisotropyandsuscep-tibilities.Thesequantitiesareobtainedviaﬁttingofatomisticdata,obtainedusingtheVAMPIREpackage[42].Akeyben-eﬁtofatomisticparameterisationistheimprovedaccuracyofthemodelledmaterial’sbehavioursaswellastheabilitytosim-ulategranularsystemswhichincludeasegregantbetweenthegrainsasistypicallythecaseinrecordingmedia.Therearetwoavailablemethodsforﬁttingthemagnetisation.Theﬁrstisﬁt-tedaccordingtom(T)=M(T)/Ms=(1−T/Tc)β/Ms,whereMsisthespontaneousmagnetisationandβisthecriticalexponent.Thesecondisﬁttedviaamorecomplexpolynomialinpowersof(T−Tc)/Tc:m(T)=9Xi=0Ai Tc−TTc!i+A1/2 Tc−TTc!12,ifT<Tc(cid:20)2Xi=1Bi T−TcTc!i+A−10(cid:21)−1,otherwise.(16)Bothmethodsarecapableofproducingthecharacteristicbe-haviourofthetemperaturedependentmagnetisation.Acom-parisonofthesetwomethodsisgiveninFig.6.Forbulksys-temsastrongcriticalityisexpectedandthecriticalexponent6ﬁtreproducesthesharptransitiontozeromagnetisationattheCuriepoint.However,asgrainsizesdecreaseﬁnitesizeeﬀectsbecomesigniﬁcantwhichcauseareductioninthecriticalityofthetransition.Theresultofﬁnitesizeeﬀectsisasmallbutnon-zeromagnetisationabovetheCuriepoint.Thepolynomialﬁtiscapableofreproducingthisbehaviourandprovidesgreateragreementwithatomisticdataforsmallgrains(i.e.5nm)thanthecriticalexponentﬁt.Thesusceptibilityχisameasureofthestrengthoftheﬂuc-tuationsofthemagnetisation.Thecomponentsofthesuscepti-bility,accordingtothespinﬂuctuationmodel,canbeobtainedbytheﬂuctuationsofthesamemagnetisationcomponentsasfollows[43]:˜χα=µsNkBT(cid:16)Dm2αE−hmαi2(cid:17).(17)Where˜χα=χα/MsVisthereducedsusceptibilityandisinunitsofﬁeld−1.Nisthenumberofspinsinthesystemwithmagneticmomentµs.Herehmαiistheensembleaverageofthereducedmagnetisationcomponentα=x,y,zandlongitu-dinal.x,y,zarethespatialCartesiancomponentsofthemag-netisation,whilelongitudinaldescribesthelengthofthemag-netisation.˜χkdescribesthestrengthoftheﬂuctuationsofthemagnetisationcomponentalongtheeasy-axisdirection,whichforoursystemisz.˜χ⊥referstotheﬂuctuationsorthogonaltotheeasyaxisandthusonthex-yplane.For˜χkand˜χ⊥,weuseasimilarapproachtoEllis[43]andweﬁttheinverseofthesusceptibility1/˜χk,⊥:1˜χk,⊥=9Xi=0Ci Tc−TTc!i+C1/2 Tc−TTc!12,ifT<Tc4Xi=0Di T−TcTc!i,otherwise.(18)WhereCiandDiaretheﬁttingparametersandTcistheCuriepoint,obtainedbydeterminingthetemperatureatwhichthesusceptibilitiesintersect.Fig.7showsthesusceptibilitiesandﬁtsobtainedfromatomisticallyparameterisedFePt,theCuriepointofthissystemis685.14K.LowanisotropysystemsandsystemsofreduceddimensionscannotretainthealignmentofthemagnetisationalongtheeasyaxisuptoTc.Insuchcases˜χkisamixofthespatialcom-ponentsandbecomesdiﬃculttodetermine.Aworkaroundistoavoidcalculating˜χkdirectlyandtoobtain˜χkfromthelon-gitudinalsusceptibility˜χl,followingthediscussionpresentedin[44].Unfortunatelyasimilarmethodcannotbeusedfor˜χ⊥makingitdiﬃculttodeterminetheanisotropyforsoftsystemswhentheanisotropyﬁeldisgivenbyEq.14.Alternatively,iftheanisotropyﬁeldisdescribedasinEq.6,thereducedanisotropyisgivenbyk(T)=K(T)/K0=m(T)γ,asdiscussedbyCallen-Callen[36].MARSimplementsbothastandardCallen-Callenﬁttingandanextendedversion.Theextendedversionutilisesthreetemperatureregionseachwiththeirownﬁtparameterssuchthattherearenodiscontinuities.Thisextendedﬁttingmethodenablesgreateraccuracyinthere-productionoftheanisotropyasafunctionoftemperature.This0.000.020.040.060.080.100.120.140100200300400500600700800900Susceptibility (T-1)Temperature (K)χparaχperpFigure7:FitobtainedforparallelandperpendicularsusceptibilityusingtheinversemethodsimilartothatofEllis[43].TheCuriepointofthissystemisthetemperaturewherethesusceptibilitiesﬁrstintersect,whichforthisdatais685.14Kapproachshouldprovidemoreusefulresultsinthecaseofsoftmaterials,whereextracting˜χ⊥canprovediﬃcult.Fig.8isacomparisonoftheﬁtsobtainedusingthestandardandextendedCallen-Callenﬁttingmethods.Oncealltheseparametersaredetermined,thegranularmodelisfullyparameterisedregard-ingthematerialproperties.2.3.2.KineticMonte-CarlosolverFinallyweturntothesolverforlong-timescalesimulations:thekineticMonteCarlo(kMC)solver.InthekMCapproachasgivenin[45],theswitchingprobabilityisdependentonthemeasuringtimetmasfollows,Pt=1−e−tm/τ,(19)wheretherelaxationtimeτisgivenbytheArrhenius-N´eellaw[17]τ−1=f0(cid:16)exph−∆E12kBTi+exph−∆E21kBTi(cid:17),(20)wheref0istheattemptfrequency,usuallyassumedaround109s−1forthesesystems,and∆E12,21aretheenergybarriersforswitchingbetweenstates.Typically,largeenergybarriersof>60kBTarerequiredinordertoensurelong-termthermalsta-bilityofwrittenbits.τ−1isgivenbyτ−1=τ−112+τ−121.Tomodelthephysicaleﬀectoftheeasyaxisdispersion,easyaxesarechosenrandomlywithinaGaussiandispersionofangleaboutthenormal.Thetotalenergybarrierincludingtheeﬀectofanisotropydispersioncanbewrittenas∆E(HT,ψ)=KuV[1−HT/g(ψ)]κ(ψ),(21)whereHTthetotaleﬀectiveﬁeld,g(ψ)=[cos2/3ψ+sin2/3ψ]−3/2andκ(ψ)=0.86+1.14g(ψ)arethenumericalap-proximationsgivenbyPfeiﬀer[46].ThekMCiscapableofsimulationsonthetimescaleofyearsandisvalidforsystems70.00.20.40.60.81.00100200300400500600700800K(T)/K(0)Temperature (K)AtomisticKsingleKmultipleFigure8:Comparisonoftheﬁtachievedviathestandard(single)andextended(multiple)Callen-Callenmethods.Thepointsrepresenttheatomisticsimula-tiondatawhilethelinesshowtheﬁtsusedinMARS.TheextendedCallen-CallenisabletoprovideanimprovedﬁtoverallandespeciallyneartheCuriepointasshownintheinset.wheretheenergybarrierismuchlargerthanthethermalen-ergy.Inordertofunction,thekMCrequirescalculationofthemagnetisationstatescorrespondingtotheenergyminimaalongwiththeenergybarrierseparatingthetwostates.StationarystatesarefoundbysolutionoftheStoner-Wohlfarthmodelofcoherentrotation[47]forwhichthefreeenergyisgivenbyE=KuV(ˆe·ˆm)2−µH·ˆm.(22)Theﬁnalstep[45]istoensurethat,afterswitching,thepopu-lationsoftheenergyminimaobeyBoltzmannstatistics.Thisapproachleadstotheconditionthat,ifthereversaltransitionisallowed,themomentisthenassignedtoeitherenergyminimumwithaprobability,p=e−Ei/(e−E1+e−E2),(23)withi=1,2labellingtheminima,therebyensuringthatthepopulationofthetwostatesobeystheBoltzmanndistributioninthermalequilibrium[45].Thisisimportantinordertoin-cludethe‘backswitching’mechanismwhichleadstodcor‘re-manence’noise.Takingaccountofbothdistributionsthetran-sitionprobabilityisdeterminedusing:P2=(cid:18)1−exph−tmτi(cid:19)(cid:18)1+exph−(E2−E1)kBTi(cid:19)−1.(24)WhereP2istheprobabilityofthemagneticmomentjumpingtothesecondminimaand∆Eistheenergybarrierseparatingthetwominima.Todetermineifaswitchingeventoccursaran-domnumberbetweenzeroandunityisgeneratedandcomparedtoP2.IfitislessthanP2themagneticmomentorientationisassignedcorrespondingtothesecondminimumotherwiseitisassignedtotheﬁrstminimum.tmisthemeasurementtime.Duringthemeasurementtimetheexternalpropertiessuchasmagneticﬁeldandtemperatureareassumedconstant,suchthatEq.24canbeapplied.2.4.CurietemperaturedispersionTheHAMRprocessinvolvesheatingthroughTcwhich,asaresult,becomesanimportantmaterialparameter.Morepartic-ularly,simulationsbyLiandJhu[48,49]haveshownthatthedispersionofTcisaseriouslimitationfortheultimatestoragedensityachievableforHAMR.HereweconsideranirreduciblecontributiontothedispersionofTcwhicharisesdirectlyfromthediameterdispersion.Itiswellknownthatﬁnitesizeef-fectsleadtoareductionofTc,demonstratedexperimentallyforFePtbyRonget.al.[50].AtheoreticalinvestigationbasedonanatomisticmodelbyHovorkaet.al.[51]showedthatthevari-ationM(T)waswelldescribedbytheﬁnitesizescalinglawTc(D)=T∞c(1−(d0/D)λ),(25)whereDisthegraindiameter,λistheso-calledphenomeno-logicalshiftexponentandd0isthemicroscopiclengthscaleclosetothedimensionofaunitcellofthelatticestructure.Theexponentλisrelatedtothecorrelationlengthuniversalcriticalexponentνanditisexpectedthatλ=ν−1.However,smallgrainscanexhibitdeparturefromuniversalitysoweprefertheformofEq.25asafunctionalformtorepresentthediameterde-pendenceofTc.ClearlyadispersionofdiametermapsontothedispersionofTc.AssumingalognormaldistributionofD,withlogarithmicmeanDmandvarianceσ2Dithasbeenshown[51]thatthedispersionofTcisgivenbythedistributionfunctionfT(∆Tc)=1√2π∆TcσTexp−(ln∆Tc−T)22σ2T,(26)with∆Tc=T∞c−Tc.Eq.(26)isalognormaldistributionfunc-tionwithlogarithmicmeanTm=λ(ln(d0(T∞c)1/λ)−Dm)andvarianceσ2T=λ2σ2D.ThroughEq.25,withd0,λandT∞cdeter-minedeitherfromexperimentoratomisticmodelcalculations,aTcvaluecanbeassignedtoanindividualgrainandEq.26usedtocalculatethestandarddeviationoftheTcdispersion.3.SimulationsThissectionpresentsademonstrationofsomeofthebundledsimulationtypesavailableinMARSatrelease.Thesesimula-tionsservetoshowthecapabilityofMARSandprovidesomeofthemostcommonsimulationtypes.Theﬁrstexamplesim-ulationisthewritingofapseudorandombitsequence(PRBS)patternforHAMR.ThesecondexampleisthedeterminationofswitchingprobabilitiesforcharacterisingCuriepointdisper-sionviacomparisonwithexperimentaldata.Finallyanexam-pleofFMRsimulationsforuseindeterminingsystemdampingisprovided.3.1.WritingandreadingprocessesforheatassistedmagneticrecordingDevelopmentofimprovedheatassistedmagneticrecordingrequiresinvestigationsintothethermalreversalofthegrainsalongwiththeeﬀectofbitspacingondatastabilityandwritingperformance.MARScontainsthreeseparateHAMRfocusedsimulations.Theﬁrstappliesatemporallydependentlaserand8ﬁeldproﬁleontoasinglebit,allowinginvestigationsofthermalreversalpropertiesofmaterials.Thesecondsimulation,con-sistsofabitwithinasurroundingsystemofgrains,utilisingatemporalandspatiallydependentlaserandﬁeldproﬁle,allow-ingforinvestigationintotheinﬂuenceofthewrittenbitonanysurroundinggrains.Thethirdsimulationmodelsrealisticdatawriting,viaasquare-waveoruserspeciﬁedbinarysequence.Thiswritingcanoccurforsingleormultipletracks.Usingthisthirdsimulation,comprehensiveinvestigationsintotheentireHAMRwritingprocesscanbeachieved.ReadbackofasystemcanalsobesimulatedinMARS.Thesystemisﬁrstdiscretisedinto1nmpixels,thisenablesmoreprecisemeasurementofthemagnetisationandproducesamorerealisticreadbacksignal.Areadheadisthenplacedattheedgeofthetrack.Thisheadisscannedalongthetrackandthemag-netisationdetectedwithintheheadisaveragedandrecordedasafunctionofdowntrackposition.InordertoinvestigatedatadecayovertimethesimulationutilisesthekMCsolvertosim-ulatethesystemforyearsandperformsreadbackatspeciﬁedintervals.Fig.9showstheoutputobtainedviatherealisticHAMRwritingandreadingsimulationavailableinMARS.ForthissimulationtwosystemswithenergybarriersofKV/kBT=79and62wereused.Eachsystemconsistedof1,300grainswithalognormalgrainsizedistributionwithanav-eragediameterof8nm.ThematerialparametersusedwereMs=1,051.65emu/cm3,Tc=693.5K,λ=0.1andKu=9.2·107erg/cm3andKu=7.1·107erg/cm3respectively.A31-bitPRBSwaswrittentothesystems.Thesequenceusedwas1111100011011101010000100101100.Bothsystemswerethenevolvedovertimefortenyearsandreadbacktogen-erateasecondreadbacksignal.Thissimulationwasperformed100timeswithdiﬀerentrandomseeds,thereadbacksignalwasthenobtainedforeachsimulationinordertoobtainthespatial,i.e.ofthemedium,signal-to-noiseratio(SNR)asafunctionoftime.TherearetwocontributionstothespatialSNR:transitionandremanence[22].TheseSNRsdescribethenoisepresentatandawayfromthebittransitionsrespectively.ThelatteriscausedbygrainswithKV/kBTsuchthatswitchback,whereastheformerisameasureofhowgoodatransitionbetweenbitsiswritten.Transitionnoiseisthenoiseexpectedtobedominantinhighdensitymediaduetothereducedimensionsthebitsize.ThecalculationofSNRiscurrentlynotincludedintheMARSsoftwarepackage,eventhoughthereistheplantoincludeitinfuturereleases.TheextractionofSNRisbasedontheen-semblewaveformanalysisdevelopedbySeagate[52,53],amethodthatallowstoseparateandextractthediﬀerentnoisecomponents:transitionandremanence.Theapproachproceedsasfollows:atrackiswrittenmultipletimes,10timesinthepresentcase,witheachtrackreadbackonceonlysincereadernoiseisnotincluded.Thesignalsareﬁrstsynchronisedviacross-correlationandafterwardstheaverage“noise-free”sig-nalisobtainedbyaveragingoverthesignalofthe10writtentracks.Then,thetotalspatialnoiseiscalculatedasthevarianceoftheaverage“noise-free”signal.Toextracttheremanenceandtransitionnoiseappropriatewindowingfunctionsareappliedtothetotalspatialnoise.Eventually,theSNRsarecalculatedasthe10log10oftheratiobetweenthetotalsignalpowerandtherespectivenoisepower.Fig.10showstheSNRcomponentsforthehighenergybarriersystem(KV/kBT=79),andasexpectedthetransitionnoiseisthebottleneck.3.2.HAMRswitchingprobabilityTheheatinginHAMRsystemsoccursinanarrowtem-peratureregionnearTc,thustheperformanceofHAMRishighlydependentontheTcdispersionoftherecordingmedium[19,48,49].TodeterminetheTcdispersionexperimentallytheprocedurerequiresmeasurementofthethermo-remanencemagnetisationasafunctionoftheappliedlaserpulsepeakpower[16].TheapplicationofthislaserpulseoccursoverthelongtimescalethusLLBsimulationsareextremelycom-putationallyexpensive,tothepointofimpracticability.MARSovercomesthisproblembyutilisingthemulti-timescalenatureofthecode.Thesolverusedbythecodeisdeterminedauto-maticallybasedonthelaserapplicationtime:ifthistimeisoftheorderofmicrosecondsorgreaterthenthekMCisusedoth-erwisetheLLBisused.Theheatingandcoolingphasesrequiredynamicinformationtobemodelledandhencearealwaysper-formedviatheLLBsolver.TheabilityforMARStoautomat-icallyselectthemostsuitablesolverallowsforthesimulationstoberuninbatchjobswithoutspeciﬁcationofthesolveroreditingofthesourcecode.Fig.11(c,d)aretheresultsofathermoremanencesimu-lationsusedtoinvestigatetheswitchingprobabilityofsingleFePtgrainsasafunctionofpeaktemperatureforHAMR-likeheatpulsesforvariouspulselengthsandunderdiﬀerentap-pliedﬁelds.Theconsideredpulselengthfallswithinthefewnanosecondsregime,thustheLLBsolverhasbeenemployedinthesesimulations.Theseresultsarecomparedwiththeswitch-ingprobabilitiesobtainedbyperformingatomisticsimulationsforthesamesystemandsetup,presentedinpanels(a,b).TheagreementbetweentheatomisticparameterisedLLBandatom-isticsimulations,whichhavealsobeenusedfortheparame-terisation,provestheabilityofMARSindescribingsuchpro-cesses,asdiscussedinmoredetailinRef.[13].Fig.12presentsanexampleoftheaveragemagnetisationdynamicsfor100FePtgrainsundertheapplicationofanexternal−1Tﬁeldalongthez–axis,anda1.8nsheatpulsewithpeaktemperatureTpeak=600,700K.ThedashedbrownlineshowstheGaussianproﬁleusedtomodelthetimedependenceoftheheatpulse:T(t)=Ta+(Tpeak−Ta)exp[−(t−3tpulse)2/t2pulse],(27)wheretpulsecorrespondsto1/6ofthetotalpulselengthandTaistheambienttemperature,thetemperatureatwhichthegrainsareinabsenceoftheheatpulse,300Kinthiscase.ForlowTpeakandrelativelyfastpulsesthemagnetisationreversalofthegrainscannotbeachieved,however,despitethisapartialre-versalcanbeobservedwhenthetemperatureapproachesTpeak.However,asthegrainscooldownthemagnetisationisrestoredalongtheinitialdirection.Ontheotherhand,whenTpeakap-proachesTcofthegrains,allgrainsarereversed.9 10 30 50 70 90Cross track (nm)-1-0.5 0 0.5 1100300500700900Down track (nm)Mz/Ms100300500700900Figure9:HAMRwritingandreadingsimulationforKV/kT=79ontheleftandKV/kT=62ontheright.ThetopgraphshowsthemagnetisationofthegrainsafterthePRBSwaswrittenviatheLLBsolver.Thebottomgraphshowsthesignalobtainedviareadbackimmediatelyafterwriting(blue)andafteratenyeartimeevolution(red)viathekMCsolver. 12 13 14 15 16 17 18 1901 hour1 Day1 Month1 Year10 yearsSNR (dB)TimeKV/kBT=79 RemanenceTransistionTotalFigure10:SNRobtainedfrommultiplereadbacksimulationsperformedforaHAMRsystemwithKV/kBT=79.Figure11:Switchingprobabilityasafunctionofpeaktemperatureforvariouspulselengthsforbothmicromagneticandatomisticsimulations.AdaptedfromRef.[13].10Figure12:Timedependenceoftheaveragemagnetisationfor100FePtgrains,obtainedwiththeLLBsolver,foraheatpulsewithtpulse=300psandTpeak600K(dot-and-dashblue)and700K(solidblack)underanappliedﬁeldof−1Talongthez–direction.Thebrowndottedlineshowsthetimedependenceofthetemperaturepulse.3.3.FerromagneticresonanceFerromagneticresonance(FMR)isanimportanttechniqueusedforthemeasurementofmagneticpropertiesforbulkandthin-ﬁlmmagneticmedia[54].FMRsimulationsenableinves-tigationintothedynamicpropertiesofamaterialsuchasthedamping[55]aswellasthestaticpropertiessuchassaturationmagnetisationanduniaxialanisotropy[56].MARSprovidesasimplesystemtoperformfrequencyandﬁeldsweptFMRsimulationsoverarangeoftemperaturesviaitsLLGandLLBsolvers.Fig.13showsthepowerspectrumobtainedviaFFTvs.theappliedﬁeldfrequencyobtainedviaFMRsimulationsofasinglesystematvarioustemperatures.ThedatahavebeenﬁttedtoaLorentzianfunction:L(x)=Aπ0.5w(x−f0)2+(0.5w)2,α=0.5wf0,(28)whereAistheamplitude,wisthefullwidthathalfmaximum,αisthedampingparameterandf0istheresonantfrequency.TheresonancefrequencycanbedeterminedviatheKittelfor-mula[57].f0=γ2π(B+µ0Hk),(29)whereBisthein-planeFMRﬁeldamplitude.Fromthisﬁt-tingthesystem’sdampingparameterandresonantfrequencyareextracted.Fig.14showsthedampingandresonantfre-quencyextractedasafunctionofsystemtemperature,thereisverygoodagreementbetweentheextractedresultsandthean-alyticalvalues.4.ConclusionWehavedevelopedanopen-sourcemulti-timescalemicro-magneticcode(MARS)forsimulatinggranularthinﬁlms.TheprimaryfocusofMARSistoenabledetailedmodellingand 220 240 260 280 300 320 340 T/Tc=0.60 120 140 160 180 200 220Power (A.U.)T/Tc=0.90 80 100 120 140 160 180 200 Frequency (GHz)T/Tc=0.97Figure13:FrequencysweptFMRforFePtatvarioustemperaturevalues.ThePowerspectrahavebeenﬁttedviaaLorentzian(dashed)toobtainthesystemresonantfrequencyanddamping. 100 120 140 160 180 200 220 240 260 280 300 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1 0 0.05 0.1 0.15 0.2 0.25Resonant Frequency (GHz)DampingT/Tcf0αFigure14:DampingandresonantfrequencyasafunctionoftemperatureforamicromagneticFePtsystemparameterisedusing5nm×5nm×10nmFePtatomisticsimulationscomparedtotheexpectedanalyticalvalues(blacklines).simulationofstateoftheartandfuturemagneticrecordingsystemscoveringboththeshorttimescalewriting/readingpro-cessesandlongtimescaledatastorage.ThefunctionalityofMARSisprovidedviathedevelopmentandinclusionofthreemicromagneticsolvers:theLandau-Lifshitz-Gilbert(LLG),Landau-Lifshitz-Bloch(LLB)andkineticMonteCarlo(kMC).ShorttimescalesimulationsarepossibleviatheLLGandLLBdynamicsolvers.TheLLBenablesthesimulationofsystemsuptoandexceedingtheirCuriepoints,whichiscrucialforrecordingsystemsuchasHAMR.Thelongtimescalesimula-tionsareperformedviathekMCstochasticsolver.Thecombi-nationofthesesolversallowsforcomplexmulti-timescalesim-ulationstobedevelopedandperformed.MARShasalsobeendevelopedforuseinmaterialcharac-terisationtoaidresearchintothedevelopmentandoptimisationofrecordingmediamaterials.TheimplementationofatomisticparameterisationenableshighlyaccuratematerialdescriptionswithinMARSandproducesverygoodagreementbetweenre-11sultsobtainedusingMARSandthoseobtainedatomistically.ThusMARSishighlyusefulforbridgingthegapbetweenatomisticsimulationandrealworldexperimentation.Further-moretoensureanaccuratedescriptionofgranularmediathenumerousmethodsofVoronoiconstructionhavebeeninvesti-gatedandcomparedresultingintheLaguerre-Voronoimethodbeingimplementedinordertoensurerealisticgrainshapesaswellaslognormalgrainsizedistributions.DetaileddescriptionsofthemodelsincorporatedinMARShavebeenprovidedalongwiththevariousmethodsusedtomodeltemperaturedependentmaterialparameters.FinallywehaveprovidedexampleresultsobtainedviaMARSfornumerouspublishedoron-goingstudiestoshowtheversatilityandcapabilitiesofMARS.ThesestudiescovertheentirerangeofHAMRdevelopmentstartingfrommateri-alscharacterisationandoptimisationthroughtoHAMRwritingandﬁnallydatastorageandreadback.5.AcknowledgementsWearegratefultoDr.MaraStrungaruforheraidinthede-velopmentandtestingoftheFMRsimulationfeaturewithinMARS.TheauthorsgratefullyacknowledgethefundingfromTrans-formingSystemsthroughPartnershipProgrammeoftheRoyalAcademyofEngineeringunderGrantNo.TSP1285andSea-gateTechnology(Thailand).J.CandP.C.gratefullyacknowledgetheﬁnancialsupportfromThailandScienceResearchandInnovation(TSRI)NumeroussimulationsforthisworkwereundertakenontheVikingCluster,whichisahighperformancecomputefacilityprovidedbytheUniversityofYork.Wearegratefulforcompu-tationalsupportfromtheUniversityofYorkHighPerformanceComputingservice,VikingandtheResearchComputingteam.References[1]H.J.Richter,Thetransitionfromlongitudinaltoperpendicularrecord-ing,J.Phys.D:Appl.Phys.40(9)(2007)R149–R177.doi:10.1088/0022-3727/40/9/r01.[2]http://idema.org/?page_id=416,accessed:2020-01-29.[3]https://blog.seagate.com/craftsman-ship/hamr-next-leap-forward-now/,accessed:2021-05-11.[4]D.K.Weller,G.Parker,O.Mosendz,E.Champion,B.Stipe,X.Wang,T.Klemmer,G.Ju,A.Ajan,AHAMRmediatechnologyroadmaptoanarealdensityof4Tb/in2,IEEETransactionsonMagnetics50(2014)1–8.doi:10.1109/TMAG.2013.2281027.[5]R.F.L.Evans,W.J.Fan,Atomisticsimulationofsub-nanosecondnon-equilibriumﬁeldcoolingprocessesformagneticdatastorageap-plications,Appl.Phys.Lett.105(19)(2014)192405.arXiv:https://doi.org/10.1063/1.4901959,doi:10.1063/1.4901959.[6]C.Vogler,C.Abert,F.Bruckner,D.Suess,D.Praetorius,Arealdensityoptimizationsforheat-assistedmagneticrecordingofhigh-densitymedia,J.Appl.Phys.119(22)(2016)223903.arXiv:https://doi.org/10.1063/1.4953390,doi:10.1063/1.4953390.[7]C.Vogler,C.Abert,F.Bruckner,D.Suess,D.Praetorius,Basicnoisemechanismsofheat-assisted-magneticrecording,J.Appl.Phys.120(15)(2016)153901.arXiv:https://doi.org/10.1063/1.4964949,doi:10.1063/1.4964949.[8]P.Chureemart,R.Evans,R.Chantrell,P.-W.Huang,K.Wang,G.Ju,J.Chureemart,Hybriddesignforadvancedmagneticrecordingmedia:Combiningexchange-coupledcompositemediawithcoupledgranularcontinuousmedia,PhysicalReviewApplied8(2)(2017)024016.doi:10.1103/PhysRevApplied.8.024016.[9]R.-V.Ababei,M.O.Ellis,R.F.Evans,R.W.Chantrell,AnomalousdampingdependenceoftheswitchingtimeinFe/FePtbilayerrecord-ingmedia,PhysicalReviewB99(2)(2019)024427.doi:10.1103/PhysRevB.99.024427.[10]O.Muthsam,F.Slanovc,C.Vogler,D.Suess,Improvingthesignal-to-noiseratioforheat-assistedmagneticrecordingbyoptimizingahigh/lowTcbilayerstructure,JournalofAppliedPhysics126(12)(2019)123907.doi:10.1063/1.5119407.[11]M.O.Ellis,R.-V.Ababei,R.Wood,R.F.Evans,R.W.Chantrell,Man-ifestationofhigher-orderinter-granularexchangeinmagneticrecordingmedia,AppliedPhysicsLetters111(8)(2017)082405.doi:10.1063/1.4990604.[12]M.Strungaru,S.Ruta,R.F.Evans,R.W.Chantrell,Modelofmagneticdampingandanisotropyatelevatedtemperatures:Applicationtogranularfeptﬁlms,PhysicalReviewApplied14(1)(2020)014077.doi:10.1103/PhysRevApplied.14.014077.[13]A.Meo,W.Pantasri,W.Daeng-am,S.E.Rannala,S.I.Ruta,R.W.Chantrell,P.Chureemart,J.Chureemart,Magnetizationdynamicsofgranularheat-assistedmagneticrecordingmediabymeansofamultiscalemodel,Phys.Rev.B102(2020)174419.doi:10.1103/PhysRevB.102.174419.[14]J.Waters,D.Kramer,T.J.Sluckin,O.Hovorka,ResolvinganomaliesinthecriticalexponentsofFePtusingﬁnite-sizescalinginmagneticﬁelds,PhysicalReviewApplied11(2)(2019)024028.doi:10.1103/PhysRevApplied.11.024028.[15]D.Richardson,S.Katz,J.Wang,Y.K.Takahashi,K.Srinivasan,A.Kalitsov,K.Hono,A.Ajan,M.Wu,Near-TcferromagneticresonanceanddampinginFePt-basedheat-assistedmagneticrecordingmedia,Phys.Rev.Applied10(2018)054046.doi:10.1103/PhysRevApplied.10.054046.[16]S.Pisana,S.Jain,J.W.Reiner,G.J.Parker,C.C.Poon,O.Hell-wig,B.C.Stipe,MeasurementoftheCurietemperaturedistributioninFePtgranularmagneticmedia,AppliedPhysicsLetters104(16)(2014)162407.arXiv:https://doi.org/10.1063/1.4873543,doi:10.1063/1.4873543.[17]L.N´eel,Th´eoriedutraˆınagemagn´etiquedesferromagn´etiquesengrainsﬁnsavecapplicationsauxterrescuites,Ann.Geophys.5(1949)99–136.[18]R.F.L.Evans,D.Hinzke,U.Atxitia,U.Nowak,R.W.Chantrell,O.Chubykalo-Fesenko,StochasticformoftheLandau-Lifshitz-Blochequation,Phys.Rev.B85(2012)014433.doi:10.1103/PhysRevB.85.014433.[19]H.Li,J.-G.Zhu,UnderstandingtheimpactofTcandHkvariationonsignal-to-noiseratioinheat-assistedmagneticrecording,JournalofAp-pliedPhysics115(17)(2014)17B744.arXiv:https://doi.org/10.1063/1.4868503,doi:10.1063/1.4868503.[20]J.Zhu,H.Li,Understandingsignalandnoiseinheatassistedmagneticrecording,IEEETransactionsonMagnetics49(2)(2013)765–772.doi:10.1109/TMAG.2012.2231855.[21]K.Eason,H.T.Wang,M.R.Elidrissi,B.Xu,Z.Yuan,K.S.Chan,Recordingperformanceandcomparisonofgraded-Tcand-KuHAMRsystems,IEEETransactionsonMagnetics50(3)(2014)107–113.doi:10.1109/TMAG.2013.2287509.[22]R.H.Victora,P.Huang,Simulationofheat-assistedmagneticrecordingusingrenormalizedmediacells,IEEETransactionsonMagnetics49(2)(2013)751–757.doi:10.1109/TMAG.2012.2219300.[23]H.Zhu,S.Thorpe,A.Windle,Thegeometricalpropertiesofir-regulartwo-dimensionalVoronoitessellations,PhilosophicalMagazineA:PhysicsofCondensedMatter,Structure,DefectsandMechanicalProperties81(12)(2001)2765–2783,citedBy98.doi:10.1080/01418610010032364.[24]J.L.Grenestedt,K.Tanaka,Inﬂuenceofcellshapevariationsonelasticstiﬀnessofclosedcellcellularsolids,ScriptaMaterialia40(1)(1998)71–77.doi:https://doi.org/10.1016/S1359-6462(98)00401-1.[25]S.Lloyd,LeastsquaresquantizationinPCM,IEEETransactionsonIn-formationTheory28(2)(1982)129–137.doi:10.1109/TIT.1982.1056489.[26]Y.Liu,W.Wang,B.L´evy,F.Sun,D.-M.Yan,L.Lu,C.Yang,OncentroidalVoronoitessellation—energysmoothnessandfastcomputa-12tion,ACMTrans.Graph.28(4)(Sep.2009).doi:10.1145/1559755.1559758.[27]A.Fazekas,R.Dendievel,L.Salvo,Y.Br´echet,Eﬀectofmicrostructuraltopologyuponthestiﬀnessandstrengthof2Dcellularstructures,Inter-nationalJournalofMechanicalSciences44(10)(2002)2047–2066.doi:https://doi.org/10.1016/S0020-7403(02)00171-6.[28]A.Gervois,L.Oger,P.Richard,J.P.Troadec,Voronoiandradicaltes-sellationsofpackingsofspheres,in:P.M.A.Sloot,A.G.Hoekstra,C.J.K.Tan,J.J.Dongarra(Eds.),ComputationalScience—ICCS2002,SpringerBerlinHeidelberg,Berlin,Heidelberg,2002,pp.95–104.doi:10.1007/3-540-47789-6_10.[29]S.-P.Yu,Y.-H.Liu,A.-C.Sun,J.-H.Hsu,Determiningthesizedistribu-tionofmagneticnanoparticlesbasedonanalysisofmagnetizationcurves,JournalofAppliedPhysics106(10)(2009)103905.arXiv:https://doi.org/10.1063/1.3259424,doi:10.1063/1.3259424.[30]G.Ju,H.Zhou,R.Chantrell,B.Lu,D.Weller,Directprobeofanisotropyﬁelddispersioninperpendicularmedia,JournalofAppliedPhysics99(8)(2006)083902.arXiv:https://doi.org/10.1063/1.2189025,doi:10.1063/1.2189025.[31]J.Alsayednoor,P.Harrison,Evaluatingtheperformanceofmicrostructuregenerationalgorithmsfor2dfoam-likerepresentativevolumeelements,MechanicsofMaterials98(2016)44–58.doi:https://doi.org/10.1016/j.mechmat.2016.04.001.[32]C.H.Rycroft,Voro++:Athree-dimensionalVoronoicelllibraryinC++,Chaos19(4)(2009)041111.arXiv:https://doi.org/10.1063/1.3215722,doi:10.1063/1.3215722.[33]Y.Peng,X.W.Wu,J.Pressesky,G.P.Ju,W.Scholz,R.Chantrell,Clustersizeandexchangedispersioninperpendicularmagneticmedia,JournalofAppliedPhysics109(12)(2011)123907.arXiv:https://doi.org/10.1063/1.3596806,doi:10.1063/1.3596806.[34]V.Sokalski,D.E.Laughlin,J.-G.Zhu,Experimentalmodelingofinter-granularexchangecouplingforperpendicularthinﬁlmmedia,AppliedPhysicsLetters95(10)(2009)102507.doi:10.1063/1.3226638.[35]S.Ruta,Studyofinteractioneﬀectsinmagneticgranularsystemsforrecordingmediaapplication,Ph.D.thesis,UniversityofYork(92017).[36]H.Callen,E.Callen,Thepresentstatusofthetemperaturedependenceofmagnetocrystallineanisotropy,andthel(l+1)2powerlaw,J.Phys.Chem.Solids27(8)(1966)1271–1285.doi:https://doi.org/10.1016/0022-3697(66)90012-6.[37]O.Mryasov,U.Nowak,K.Guslienko,R.Chantrell,Temperature-dependentmagneticpropertiesofFePt:Eﬀectivespinhamiltonianmodel,EurophysicsLetters69(5)(2005)805–811.doi:10.1209/epl/i2004-10404-2.[38]W.M.Saslow,Landau–LifshitzorGilbertdamping?Thatisthequestion,JournalofAppliedPhysics105(7)(2009)07D315.arXiv:https://doi.org/10.1063/1.3077204,doi:10.1063/1.3077204.[39]D.A.Garanin,V.V.Ishchenko,L.V.Panina,Dynamicsofanensembleofsingle-domainmagneticparticles,TheoreticalandMathematicalPhysics82(2)(1990)169–179.doi:10.1007/BF01079045.[40]D.A.Garanin,Fokker-PlanckandLandau-Lifshitz-Blochequationsforclassicalferromagnets,Phys.Rev.B55(1997)3050–3057.doi:10.1103/PhysRevB.55.3050.[41]O.Chubykalo-Fesenko,U.Nowak,R.W.Chantrell,D.Garanin,DynamicapproachformicromagneticsclosetotheCurietemperature,Phys.Rev.B74(2006)094436.doi:10.1103/PhysRevB.74.094436.[42]R.F.L.Evans,W.J.Fan,P.Chureemart,T.A.Ostler,M.O.A.Ellis,R.W.Chantrell,Atomisticspinmodelsimulationsofmagneticnanoma-terials,J.Phys-CondensMat.26(10)(2014)103202.doi:10.1088/0953-8984/26/10/103202.[43]M.Ellis,Simulationsofmagneticreversalingranularrecordingmedia,Ph.D.thesis,UniversityofYork(92015).[44]C.Vogler,C.Abert,F.Bruckner,D.Suess,Landau-Lifshitz-Blochequa-tionforexchange-coupledgrains,Phys.Rev.B90(2014)214431.doi:10.1103/PhysRevB.90.214431.[45]R.Chantrell,N.Walmsley,J.Gore,M.Maylin,Calculationsofthesus-ceptibilityofinteractingsuperparamagneticparticles,PhysicalReviewB63(2)(2001)024410.doi:10.1103/PhysRevB.63.024410.[46]H.Pfeiﬀer,Determinationofanisotropyﬁelddistributioninparticleas-sembliestakingintoaccountthermalﬂuctuations,physicastatusso-lidi(a)118(1)(1990)295–306.arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/pssa.2211180133,doi:https://doi.org/10.1002/pssa.2211180133.[47]E.C.Stoner,E.P.Wohlfarth,Amechanismofmagnetichysteresisinheterogeneousalloys,Phil.Trans.R.Soc.A240(826)(1948)599–642.doi:10.1098/rsta.1948.0007.[48]H.Li,J.Zhu,TheroleofmediapropertydistributioninHAMRSNR,IEEETransactionsonMagnetics49(7)(2013)3568–3571.doi:10.1109/TMAG.2012.2234086.[49]J.-G.J.Zhu,H.Li,Signal-to-noiseratioimpactofgrain-to-grainheatingvariationinheatassistedmagneticrecording,JournalofAppliedPhysics115(17)(2014)17B747.arXiv:https://doi.org/10.1063/1.4867607,doi:10.1063/1.4867607.[50]C.-b.Rong,D.Li,V.Nandwana,N.Poudyal,Y.Ding,Z.Wang,H.Zeng,J.Liu,Size-dependentchemicalandmagneticorder-inginL10-FePtnanoparticles,AdvancedMaterials18(22)(2006)2984–2988.arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/adma.200601904,doi:https://doi.org/10.1002/adma.200601904.[51]O.Hovorka,S.Devos,Q.Coopman,W.J.Fan,C.J.Aas,R.F.L.Evans,X.Chen,G.Ju,R.W.Chantrell,TheCurietemperaturedistributionofFePtgranularmagneticrecordingmedia,AppliedPhysicsLetters101(5)(2012)052406.doi:10.1063/1.4740075.[52]S.Hernandez,P.Krivosik,P.W.Huang,W.R.Eppler,T.Rausch,E.Gage,Parametriccomparisonofmodelledandmeasuredheat-assistedmagneticrecordingusingacommonsignal-to-noisemetric,IEEETransactionsonMagnetics52(7)(2016)1–4.doi:10.1109/TMAG.2016.2528224.[53]S.Hernandez,P.-L.Lu,S.Granz,P.Krivosik,P.-W.Huang,W.Ep-pler,T.Rausch,E.Gage,Usingensemblewaveformanalysistocom-pareheatassistedmagneticrecordingcharacteristicsofmodeledandmeasuredsignals,IEEETransactionsonMagnetics53(2)(2017)1–6.doi:10.1109/TMAG.2016.2612230.[54]S.Hashmi,ReferenceModuleinMaterialsScienceandMaterialsEngi-neering,Elsevier,Amsterdam,2015.[55]O.Yalcin,FerromagneticResonance:TheoryandApplications,Intech,Croatia,2013.[56]O.Eriksson,AtomisticSpinDynamics:FoundationsandApplications,OxfordUniversityPress,Oxford,UnitedKingdom,2017.[57]C.Kittel,IntroductionToSolidStatePhysics,Wiley,Hoboken,NJ,2005.13Supplementaryinformationto“ModelsofAdvanceRecordingSystems:AMulti-timescaleMicromagneticcodeforgranularthinﬁlmmagneticrecordingsystems”S.E.Rannala,∗1,A.Meo1,2,S.Ruta1,3,W.Pantasri2,R.W.Chantrell1,P.Chureemart2,andJ.Chureemart†21DepartmentofPhysics,UniversityofYork2DepartmentofPhysics,MahasarakhamUniversity3CollegeofBusiness,TechnologyandEngineering,SheﬃeldHallamUniversity3September2021∗ser527@york.ac.uk†jessada.c@msu.ac.th1arXiv:2205.05263v1  [physics.comp-ph]  11 May 20221SupplementaryNote1-Generalsolvertesting1.1VeriﬁcationoftheHeunschemeThedynamicsolversutilisetheHeunintegrationschemeduetoitsabilitytoprovidetherequiredStratonovichsolutionofstochasticequations.However,ﬁrstthismethodmustbeshowntoaccuratelysolvethedeter-ministicequationsofmotion.ForthistestanalyticalsolutionswerederivedforspeciﬁccasesforboththeLLGandLLBsolvers.Forthistestasinglegrainwithaninitialmagnetisationalongthex-axisundertheinﬂuenceofanappliedﬁelddirectedalongthez-axis[1]isused,thetimeevolutionfortheLLGsolveristhengivenby:Mx(t)=sech(cid:18)γαH1+α2t(cid:19)cos(cid:18)γH1+α2t(cid:19)Mx(t)=sech(cid:18)γαH1+α2t(cid:19)sin(cid:18)γH1+α2t(cid:19)Mz(t)=tanh(cid:18)γαH1+α2t(cid:19).(1)FortheLLBsolverthetimeevolutionis:Mx(t)=sech(cid:18)γα⊥Htm2(cid:19)cos(γα⊥Ht)My(t)=sech(cid:18)γα⊥Htm2(cid:19)sin(γα⊥Ht)Mz(t)=tanh(cid:18)γα⊥Htm2(cid:19).(2)ThetimeevolutionfortheLLGandLLBalongwiththeobtainederrorsareshowninsupplementaryﬁgure1.ThemaximumerrorobtainedfortheLLGisaround10−2,whilefortheLLBitisaround10−5.ThisistobeexpectedasthetimesteputilisedintheLLBis1fsand1psintheLLG.TheformoftheseerrorsischaracteristicofacorrectlyimplementedHeunintegrationscheme.-0.8-0.40.00.40.8MagnetisationSimAnalyt-0.8-0.40.00.40.8MagnetisationSimAnalyt051015200.00.51.01.52.0Error (x10-3)Time (ns)xyz0.00.51.01.52.005101520Error (x10-6)Time (ns)xyzSupplementaryFigure1:ComparisonofthenumericalsimulationandanalyticalsolutionfortheLLG(left)andLLB(right)solvers.Bothsystemsareinthepresenceofa400πOeﬁeldandthetimestepsofintegrationusedare∆=1psfortheLLGand∆t=1fsfortheLLB.21.2AngulardependenceofthecoercivityVeriﬁcationoftheimplementationoftheuniaxialanisotropyforallsolversisperformedviaasimpletestwhichmakesuseoftheStoner-Wohlfarthmodel.Here,theStoner-WohlfarthparticledescribesthebehaviourofasinglegrainatzeroKelvinundertheinﬂuenceofanappliedﬁeld.Theangulardependenceofthecoercivityisverywellknown[2]andthusmakesaveryusefulpropertyforcomparisonandveriﬁcationofacode.ThistestveriﬁesthedeterministicbehaviouroftheLLGandLLBbyensuringtheeasyaxisproﬁleprovidesacoercivityofHk=2KMsasisknownanalytically.Thegrainisinitiallymagnetisedalongthez-axisandtheappliedﬁeldstrengthisvariedfromH=1.5HktoH=−1.5Hkandback,instepsof0.005Hk.Thisprocessisrepeatedforarangeofﬁelddirectionsrangingfrom90◦to0◦.Theprojectionofthemagnetisationontheﬁelddirectionisthenplottedasafunctionoftheappliedﬁeldstrengthasshowninsupplementaryﬁgure2fortheLLG,LLBandkMCsolvers.AsexpectedthesameproﬁlesareobtainedirrespectiveofwhichofthethreesolversareusedandtheseproﬁlesalsoagreeexactlywiththoseofStonerandWohlfarth’ssolution.-1-0.5 0 0.5 1-1.5-1-0.5 0 0.5 1 1.5M.HHappl/Hk0°15°30°45°60°75°90°SupplementaryFigure2:Alignmentmagnetisationforasinglegrainunderanappliedﬁeldforvariousanglesfromtheeasyaxis.The0◦and90◦proﬁlesaresimulatedwithasmalldeviationfromthelabelledvalue.Thisisdoneasatperfectalignment,intheabsenceofthermalnoise,thereiszerotorquewhichpreventsanychangeinthemagnetisationalignment.1.3Boltzmanndistributionsforanensembleofnon-interactinggrainsToverifythestochasticbehaviourofthesLLGandsLLB-IIsolversatestwhichutilisesthermaleﬀectsisrequired.ThemostsimpletestavailableisthereproductionoftheBoltzmanndistributionforanensembleofnon-interactinggrains,withuniaxialanisotropyintheabsenceofanappliedﬁeld.TheBoltzmanndistributionformagnetisationasafunctionofpolaranglefortheLLGissimpletoobtainandisgivenby:P(θM)=sin(θm)exp(cid:18)−KVsin(θM)2kBT(cid:19)Rπ/20sin(θm)exp(cid:18)−KVsin(θM)2kBT(cid:19)dθM,(3)whereθMistheangleofmagnetisationwithrespecttotheeasyaxis.Theensembleisallowedtoevolveovertimefor106stepsandtheangleofmagnetisationisrecordedateachstep.TheresultsobtainedbythesLLGandtheanalyticalsolutionareshowninsupplementaryﬁgure3foraninitialmagnetisationdirectionparalleltotheeasyaxisdirection.Thereisexcellentagreementbetweentheseresults,showingcorrectimplementationofthermaleﬀectsinthesLLG.3 0 10 20 30 40 50 60 70 80 90 0 5 10 15 20Probability densityΘm (degrees)T=300KT=500KT=900KSupplementaryFigure3:Angularprobabilitydistributionsforanon-interactingensembleofgrainswithuniaxialanisotropyfor300K,500Kand900K.TheanalyticalBoltzmanndistributionsarerepresentedbythesolidlines,thesimulateddataisrepresentedbypoints.FortheLLBequationthefreeenergyofthesystemisdeﬁnedas[3,4]:FM0SV=m2x+m2y2˜χ⊥+(m2−m2e)28˜χkm2e,ifT≤Tcm2x+m2y2˜χ⊥+320˜χkTcT−Tc(cid:18)m2+53T−TcTc(cid:19)2,otherwise.(4)Wheretheﬁrsttermprovidesuniaxialanisotropyandthesecondcontrolsthemagnetisationlength.TheexpectedBoltzmanndistributionisoftheform:P(|m|)∝m2exp(cid:18)−FkBT(cid:19).(5)Probabilitydistributionsalongmzandmxfordiﬀerenttemperaturesalongwiththecorrespondingana-lyticalsolutionsareplottedinsupplementaryﬁgure4,allresultsshowstrongagreementwiththeanalyticalsolutions.ThesimulatedsystemhasaCuriepointof685.14K,includesanisotropywithaninitialrandomuniformlydistributedmagnetisationandhasbeenevolvedovertimefor1ns(106steps).TheresultsshowtheabilityofthesLLB-IIsolvertodescribethelossofferromagneticbehaviourasthetemperatureapproachesandexceedstheCuriepoint,indicatedbytheformationofasinglepeakoncethetemperatureexceedstheCuriepoint.4-1-0.5 0 0.5 1-1-0.5 0 0.5 15.0e-071.0e-061.5e-062.0e-062.5e-063.0e-06650KmzmxP(mx,mz)-1-0.5 0 0.5 1-1-0.5 0 0.5 15.0e-071.0e-061.5e-062.0e-062.5e-063.0e-06680KmzmxP(mx,mz)-1-0.5 0 0.5 1-1-0.5 0 0.5 15.0e-071.5e-062.5e-063.5e-064.5e-065.5e-06700KmzmxP(mx,mz)SupplementaryFigure4:Anisotropicdistributionsofmagnetisationasfunctionsofmxandmz(lightbluegrid)comparedtoanalyticalsolutionsforslicesofmy(darkbluelines).52SupplementaryNote2-Landau-Lifshitz-Blochsolverspeciﬁctesting2.1DeterminationoftheCurietemperatureTheLLGconservesmagnetisationlengthassumingunityforalltemperatures,thusthemodelstartstobreakdownattemperaturesapproachingTc.TheLLBallowsforvariablemagnetisationlengthsenablingittosimulatesystemsatandbeyondtheirCuriepoints.ThistestwasdevisedtoverifythetreatmentofthemagnetisationlengthbytheLLB.Thetemperaturedependenceofthemagnetisationisdeterminedviaparameterisationobtainedusingatomisticsimulations.Twosystemsaresimulated,onewithahardmagneticmaterialtheotherasoftmaterial.ThehardmaterialismodelledviatheperpendicularsusceptibilitywhilethesoftmaterialutilisestheCallen-Callenmethod.Thesystemsareheatedfrom0KtoabovethehighestCuriepointofthematerials.Ateachtemperaturethesystemissimulateduntilanequilibriumisreachedatwhichpointthemagnetisationisrecordedandthetemperatureincreased.supplementaryﬁgure5showstheresultsobtainedforthehardandsoftmaterialsviaLLBsimulationcomparedtothoseobtainedbyatomisticsimulation.Thereisexcellentagreementbetweentheresults,showingthatMARSiscapableofreproducingthecorrectbehaviourofthemagnetisationlength. 0 0.2 0.4 0.6 0.8 1Magnetisation length (|M|/Ms) 0 0.2 0.4 0.6 0.8 1020040060080010001200TcHardTcSoftTemperature (K)LLBAtomisticSupplementaryFigure5:MagnetisationasafunctionoftemperatureforthehardandsoftmaterialsperformedusingLLBsolver.2.2LongitudinalrelaxationAsystemofnon-interactingidenticalgrainsisinitiallyalignedat30◦fromthez-axis,placingitinanon-equilibriumstate.Thesystemisthenallowedtothermallyrelax,intheabsenceofanappliedﬁeld,forarangeofsystemtemperaturesandthemagnetisationlengthisrecordedateachstep.supplementaryﬁgure6showsthecomparisonoftheresultsobtainedviaMARSandatomisticsimulations.Theresultsshowexcellentagreement.Asexpectedthereisasmalldiscrepancyforveryshorttimescaleswheretherateofrelaxationisgreatest[3],however,bothresultsshowidenticalequilibriumlengthswithinonly5ps.6 0.4 0.5 0.6 0.7 0.8 0.9 1 0 2 4 6 8 10mlTime (ps)300K500K600KSupplementaryFigure6:Comparisonofmicromagnetic(lines)andatomistic(dots)resultsofthemagnetisationlengthasafunctionoftime,forasystemundergoingthermalrelaxation.TheCurietemperatureofthesimulatedsystemis680K.3SupplementaryNote3-KineticMonteCarlosolverspeciﬁctesting3.1CoercivityasafunctionofsweeprateInthepresenceofthermaleﬀectsthecoercivitydependsontheappliedﬁeldsweeprate.ThecoercivityasafunctionofthesweepratewasdeterminedempiricallybySharrock[5]andthenderivedtheoreticallybyChantrell[6]undertheassumptionofconstantattemptfrequencyandaneasyaxisparalleltotheappliedﬁeld.AsimpletestforthekMCsolverconsistsofthesimulationofhysteresisproﬁlesforarangeofsweeprates.Supplementaryﬁgure7showsthecomparisonbetweenthesimulatedresultsandthetheoreticalprediction.TheresultsagreestronglywiththetheoryverifyingtheimplementationofthekMCforthermalsystems.7 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 1 100000 1x1010 1x1015Hc/HKField sweep rate (Oe/s)100K200K300K400K500K600K700KSupplementaryFigure7:Coercivityasfunctionofappliedﬁeldsweepratefortheeasyaxisalignedwiththeﬁeldforvarioustemperatures100Kto700K.Thesimulationresults(dots)showgoodagreementwiththetheoreticalprediction(lines).References[1]J.D.Hannay,Computationalsimulationsofthermallyactivatedmagnetisationdynamicsathighfre-quencies,Ph.D.thesis,Schoolofinformatics,UniversityofWales,Bangor,Gwynedd,U.K.(72001).[2]E.C.Stoner,E.P.Wohlfarth,Amechanismofmagnetichysteresisinheterogeneousalloys,Phil.Trans.R.Soc.A240(826)(1948)599–642.doi:10.1098/rsta.1948.0007.[3]N.Kazantseva,D.Hinzke,U.Nowak,R.W.Chantrell,U.Atxitia,O.Chubykalo-Fesenko,Towardsmultiscalemodelingofmagneticmaterials:SimulationsofFePt,Phys.Rev.B7718(2008)184428.doi:10.1103/PhysRevB.77.184428.[4]O.Chubykalo-Fesenko,U.Nowak,R.W.Chantrell,D.Garanin,DynamicapproachformicromagneticsclosetotheCurietemperature,Phys.Rev.B74(2006)094436.doi:10.1103/PhysRevB.74.094436.[5]P.J.Flanders,M.P.Sharrock,Ananalysisoftime-dependentmagnetizationandcoercivityandoftheirrelationshiptoprint-throughinrecordingtapes,J.Appl.Phys.627(1987)2918–2928.doi:10.1063/1.339373.[6]R.W.Chantrell,G.N.Coverdale,K.O’Grady,Timedependenceandratedependenceofthecoercivityofparticulaterecordingmedia,J.Phys.D:Appl.Phys.219(1988)1469–1471.doi:10.1088/0022-3727/21/9/026.8