The first original version of this manuscript has been submitted on August 9th, 2022, for 
consideration in the peer-reviewed Applied Energy journal. Please note that the manuscript has not 
undergone peer-review yet and has not been formally accepted for publication. Subsequent versions 
of this manuscript may have slightly different content. Please feel free to contact any of the authors; 
we welcome feedback. 

 
 
 
Direct and diffuse shading factors modelling for the most representative 
agrivoltaic system layouts 

Sebastian Zainali1,*, Silvia Ma Lu1, Bengt Stridh1, Anders Avelin1, Stefano Amaducci2, Michele Colauzzi2 , Pietro Elia 
Campana1,* 

1M√§lardalen University. Dept. of Sustainable Energy Systems, Box 883, 721 23 V√§ster√•s (Sweden) 

2Universit√† Cattolica del Sacro Cuore, Dept. of Sustainable Crop Production, Emilia Parmense 84, Piacenza (Italy) 

ÔÇ∑  Corresponding author:    sebastian.zainali@mdu.se, pietro.campana@mdu.se 

Abstract 

Agrivoltaic systems are becoming more popular as a critical technology for attaining several 

sustainable development goals such as affordable and clean energy, zero hunger, clean water 

and  sanitation,  and  climate  action. However,  understanding  the  shading  effects  on  crops  is 

fundamental to choosing an optimal agrivoltaic system as a wrong choice could lead to severe 

crop  reductions.  In  this  study,  fixed  vertical,  one-axis  tracking,  and  two-axis  tracking 

photovoltaic arrays for agrivoltaic applications are developed to analyse the shading conditions 

on the ground used for crop production. The models have shown remarkably similar accuracy 

compared to commercial software such as PVsyst¬Æ and SketchUp¬Æ. The developed models 

will help reduce  the  crop yield uncertainty under  agrivoltaic systems by  providing  accurate 

photosynthetically active radiation distribution at the crop level. The distribution was further 

analysed using a light homogeneity index and calculating the yearly photosynthetically active 

radiation reduction. The homogeneity and photosynthetically active radiation reduction varied 

significantly depending on the agrivoltaic system design, from 91% to 95% and 11% to 34%, 

respectively. To  identify the most  suitable  agrivoltaic system layout  dependent  on  crop  and 

geographical  location,  it  is  of  fundamental  importance  to  study  the  effect  of  shadings  with 

distribution analysis. 

Keywords: Agrivoltaics; Beam Shading Factor; Diffuse Shading Factor; Photosynthetically Active 

Radiation; Photovoltaics; Tracking. 

1  Introduction 

Shadings  on  photovoltaic  (PV)  modules  cause  significant  losses  in  electricity  production, 

especially in cases where there are no diodes, as the performance is decreased approximately 

proportionally to the irradiance reduction [1].  Therefore, several research activities have been 

 
 
focused on developing methods to accurately estimate the yield loss of solar arrays surrounded 

by  objects  or due  to  self-shading  when arranged  in  multiple rows.  Shading  calculations  for 

solar arrays have been developed and used for several years. In 1987, Bany & Appelbaum [2] 

developed equations to calculate the shadow that occurs on a field of solar collectors during 

the day. It is common to have more complex situations than a field of solar collectors. Hence, 

Cascone  et  al.  [3]  developed  a  calculation  procedure  of  the  shading  factor  under  complex 

boundary  conditions  that  can  be  implemented  for  every  sky  condition.  The  procedure  can 

obtain the instantaneous, daily average, or monthly average shading factor values. Nowadays, 

several  commercial  software  solutions  are  used  to  calculate  the  shading  factors,  but  these 

products tend to have limitations. For instance, some commercial products do not provide the 

flexibility and control by changing the timesteps or angular displacement needed for shading 

factors calculations. To provide more flexibility, control, and transparency over the shading 

factor calculation process, Silva et al. [4] created a model in Matlab¬Æ to calculate the beam 

and  diffuse  shading  factors.  Their  model  was  validated  with  PVsyst¬Æ  and  System  Advisor 

Model  (SAM)¬Æ  using  obstacles  shading  the  fixed  tilted  PV  array.  Their  model  has  shown 

similar results as SAM¬Æ. However, the PVsyst¬Æ result differed significantly from their model, 

with an R2 of 46% when analysing one module shaded by one infinite row. The shading factor 

simulation  over  a  long  period  requires  high  computational  power.  To  reduce  the  time 

complexity, Melo et al. [5] developed a method to estimate the shading factor and irradiation 

received on a surface, using a bi-linear interpolation. The simulation time could be reduced 

from 955 seconds to 39 seconds without reducing the shading factor accuracy. 

Even though shading factors are used frequently for PV systems performance assessment, there 

is still a limited amount of research regarding new emerging PV systems layouts, especially 

for agrivoltaic applications that have the possibility of reducing the competition of land used 

for either food or electricity production.   

Agrivoltaic systems can increase renewable energy capacity and produce food simultaneously 

[6], be a climate adaptation technology, and support society to meet the energy demand by only 

using a single per cent of global agricultural land [7]. Agrivoltaic systems have been found to 

also have a great synergy with animals by simultaneously using shading as a shelter and the 

land for grazing [8]. Additionally, there are several mutual benefits, such as reduced PV module 

heat  stress,  reduction  of  plant  drought  stress,  and  increased  food  production  under  certain 

climatic conditions [9]. Despite all the benefits, a tremendous lack of knowledge exists on how 

the  properties  of  the  crop  (i.e.,  yield,  energy  content,  and  morphology)  underneath  the  PV 

modules are affected due to shadings [9‚Äì11]. Therefore, accurate shading calculations on the 

ground are necessary to understand better the effects of combining PV systems and agriculture. 

Campana et al. [12] analysed a vertically mounted agrivoltaic system located in Sweden. In 

their study, diffuse and beam shading factors are calculated to get the photosynthetically active 

radiation  (PAR)  distribution  on  the  ground.  The  PAR  is  needed  for  the  crop  model 

Environmental Policy Integrated Climate (EPIC) developed by Williams et al. [13] to get the 

actual crop yield. The model has shown to be robust in identifying crop productivity, especially 

in open-field conditions [12]. Amaducci et al. [14] developed a shading and radiation model to 

compute the crop yield for an agrivoltaic system using two-axis trackers in North Italy. Their 

model indicates that agrivoltaic systems support clean energy conversion, crop yield, and water 

saving. Nevertheless, there is still a lack of studies analysing the shading that occurs under the 

panels of an agrivoltaic system, and this is a knowledge gap that must be filled. 

In this paper, a model is developed to accurately calculate the PAR distribution reaching the 

crops for fixed, one-axis, and two-axis agrivoltaic systems. In agrivoltaic systems, using either 

one- or two-axis trackers is common to control the irradiance on the crops grown underneath 

the PV system [15]. The model can be employed as a starting point for accurately estimating 

crop  yields  at  any  given  location  under  the  most  common  agrivoltaic  system  designs.  The 

schematic of the modelling chain is presented in Figure 1. 

Figure 1 Modelling schematic 

The paper is structured as follows. Section 2 describes the methodology used to calculate the 

beam  and  diffuse  shading  factors  for  the  fixed,  one-axis,  and  two-axis  agrivoltaic  systems. 

Section 3 presents the model comparisons and PAR distribution at different locations. Section 

4 summarizes the results of this study. 

2  Methodology 

The shadow effect on the solar modules includes the direct and diffuse shading factors. The 

direct  component  depends  on  the  module  geometry,  obstacles,  and  the  sun‚Äôs  position.  The 

diffuse component only depends on module geometry and obstacles. There is also a reflected 

component reduced by obstacles, reducing the albedo [4]. The albedo effect is not included in 

this  work  as  it  is  out  of  scope.  The  shading  factors  used  to  calculate  the  beam  horizontal 

irradiance (BHI) and the diffuse horizontal irradiance (DHI) can be calculated as follows: 

ùêµùêªùêº(cid:3020) = ùêµùêªùêº(1 ‚àí ùëì(cid:3029)),                                                                                                                            (1) 

ùê∑ùêªùêº(cid:3020) = ùê∑ùêªùêº(1 ‚àí ùëì(cid:3031)),                                                                                                                           (2) 

 
 
where, ùëì(cid:3029) is the beam shading factor, ùëì(cid:3031) is the diffuse shading factor, ùêµùêªùêº(cid:3020) is the shaded beam 

horizontal  irradiance,  and  ùê∑ùêªùêº(cid:3020)  is  the  shaded  diffuse  horizontal  irradiance.  The  input 

parameters  used  for  the  vertical,  one-axis,  and  two-axis  agrivoltaic  system  designs  are 

presented in Table 1. Due to construction limitations, the one-axis and two-axis maximum tilt 

angles are assumed to be -60 and 60 degrees.  

Table 1 Design parameters for the vertical, one-axis, and two-axis agrivoltaic systems. 

Input parameters 

Vertical 

One-axis 

Two-axis 

Panel width [m] 

Panel length [m] 

Number of panels 

Total panel area [m2] 

Number of rows 

Row spacing [m] 

Row length [m] 

Crop area [m2] 

Pitch [m] 

Height [m] 

Fixed tilt angle [¬∞] 

Azimuth angle [¬∞] 

Maximum tilt angle [¬∞] 

Minimum tilt angle [¬∞] 

1 

2 

40 

80 

2 

10 

20 

1 

2 

40 

80 

2 

10 

20 

1 

2 

40 

80 

2 

10 

20 

200 

200 

200 

- 

0  

90 

0 

- 

- 

- 

3 

- 

0 

60 

-60 

2 

3 

- 

0 

60 

-60 

The coordinates of the PV module are calculated with simple trigonometric relationships as 

follows: 

ùëÉ1 = (cid:3429)

ùë•(cid:2868)
ùë¶(cid:2868)
ùëß(cid:2868)

(cid:3433),                                                                                                                                               (3) 

ùëÉ2 = (cid:3429)

ùë•(cid:2868)
ùë¶(cid:2868) + ùëä
ùëß(cid:2868)

(cid:3433),                                                                                                                                     (4) 

ùëÉ3 = (cid:3429)

ùë•(cid:2868) + ùêø
ùë¶(cid:2868)
ùëß(cid:2868)

(cid:3433),                                                                                                                                       (5) 

ùëÉ4 = (cid:3429)

ùë•(cid:2868) + ùêø
ùë¶(cid:2868) + ùëä
ùëß(cid:2868)

(cid:3433),                                                                                                                                     (6) 

where, x0, y0, and z0 are the initial PV module coordinates located in the plane, L is the length 

of the panel (m), and W is the width of the panel (m). The tilt angle ùúî(cid:3010)(cid:3021)(cid:3004) (¬∞) for both fixed and 

one axis tracking PV systems follows the solar elevation with a rotation around the y-axis. The 

tilt  angles  are  calculated  with  the  equations  defined  by  Lorenzo  et  al.  [16].  First,  an  ideal 

tracking angle ùúî(cid:3010)(cid:3021) including mutual shadowing must be calculated and is given by: 

tan(ùúî(cid:3010)(cid:3021)) =

ùë•
ùëß

,                                                                                                                                         (7) 

where x, y, and z are the Cartesian coordinates of the Sun, which is referred to as a reference 

system with the z-axis pointing to the zenith, the y-axis pointing south, and the x-axis pointing 

west. The components of the solar vector are given as follows [16]: 

ùíî = (cid:4688)

ùë• = cos(ùõº(cid:3046)) sin(ùõæ(cid:3046))
ùë¶ = cos(ùõº(cid:3046)) cos(ùõæ(cid:3046)) ,
ùëß = sin(ùõº(cid:3046))                 

                                                                                                                  (8) 

where, ùõæ(cid:3046) is the solar azimuth angle (¬∞), and ùõº(cid:3046) is the solar elevation angle (¬∞). The solar vector 

components are calculated according to a panel-oriented coordinate system, which is defined 

with a north-south axis direction. To adjust the system deviations for different azimuth angles 

ùõº(cid:3027) relative to the N-S direction and axis tilts from the horizontal plane angle ùõΩ(cid:3027), the system 

has to be referred to as follows: 

ùë•(cid:4593) = ùë•ùëêùëúùë†(ùõº(cid:3027)) ‚àí ùë¶ùë†ùëñùëõ(ùõº(cid:3027))
ùë¶(cid:4593) = ùë•ùëêùëúùë†(ùõΩ(cid:3027))sin (ùõº(cid:3027)) + ùë¶ùëêùëúùë†(ùõΩ(cid:3027)) cos(ùõº(cid:3027)) ‚àí ùëßùë†ùëñùëõ(ùõΩ(cid:3027)),
(cid:4688)
ùëß(cid:4593) = xsin(Œ≤(cid:2910)) sin(ùõº(cid:3027)) + ùë¶ùë†ùëñùëõ(ùõΩ(cid:3027)) cos(ùõº(cid:3027)) + ùëßùëêùëúùë†(ùõΩ(cid:3027))

 The shaded fraction SF and shadow length s are given by: 

                                                        (3) 

ùëÜùêπ = max [0, (cid:3436)1 ‚àí

ùêø(cid:3006)(cid:3024)
ùë†

(cid:3440)],                                                                                                                   (9) 

ùë† =

1
cos (ùúî(cid:3010)(cid:3021))

,                                                                                                                                      (10) 

where, ùêø(cid:3006)(cid:3024) is the distance between axes from east to west. In Figure 2 the geometry of a one-

axis horizontal tracking is depicted. 

Figure 2 One-axis horizontal N-S oriented tracking. (a) ideal tracking with mutual 
shadowing, (b) corrected ideal tracking (back-tracking). Depicted from (Lorenzo et al. [16]). 

The ideal tracking angle can be used to calculate the corrected ideal tracking angle ùúî(cid:3010)(cid:3021)(cid:3004) and is 

given by: 

ùúî(cid:3004) = ùúî(cid:3010)(cid:3021) ‚àí ùúî(cid:3010)(cid:3021)(cid:3004),                                                                                                                                (11) 

cos ( ùúî(cid:3004)) = ùêø(cid:3006)(cid:3024)cos (ùúî(cid:3010)(cid:3021)),                                                                                                               (12) 

where, ùúî(cid:3004) is the back-tracking correction angle. For a fixed PV system, the tilt angle is fixed. 

The rotation around the y-axis is done by using the rotation matrix defined as follows [17]: 

ùëÖ(cid:3052) = (cid:3429)

cos(ùúî(cid:3030))
0

0 sin(ùúî(cid:3030))
1
‚àí sin(ùúî(cid:3030)) 0 cos(ùúî(cid:3030))

0

(cid:3433),                                                                                                   (13) 

The two-axis tracking PV system is rotated in the y-direction similarly as done for one-axis 

systems. In Figure 3, the geometry of a two-axis horizontal tracker is presented. 

 
Figure 3 Two-axis horizontal N-S oriented axis tracking, (a) ideal tracking with mutual 
shading, (b) corrected ideal tracking (back-tracking). Depicted by Lorenzo et al. [16]. 

However, the second rotation follows the solar azimuth angle and the ideal tracking angle ùõΩ(cid:3010)(cid:3021) 

for the x-axis is given by: 

tan(ùõΩ(cid:3010)(cid:3021)) =

ùë¶

(ùë•(cid:2870) + ùë¶(cid:2870))(cid:2869)/(cid:2870)  ,                                                                                                                 (14) 

The corrected ideal tracking angle ùõΩ(cid:3010)(cid:3021)(cid:3004) is given by: 

cos (ùõΩ(cid:3010)(cid:3021)(cid:3004)) =

ùêø(cid:3015)(cid:3020)
ùëä

cos ( ùõΩ(cid:3010)(cid:3021)),                                                                                                              (15) 

where, ùêø(cid:3015)(cid:3020) is the distance between the axes from north to south, and W is the panel width. The 

second rotation is done by using the rotation matrix around the x-axis as follows [17]: 

0

1
0 cos (ùúî(cid:2869)(cid:3030)) ‚àísin (ùúî(cid:2869)(cid:3030))
ùëÖ(cid:3051) = (cid:3429)
cos (ùúî(cid:2869)(cid:3030))
0 sin (ùúî(cid:2869)(cid:3030))

0

(cid:3433),                                                                                               (16) 

The final position of the coordinates of the PV modules is obtained after the rotation around 

both the y-axis and x-axis and one translational displacement. The rotations are performed by 

multiplying each panel point by a rotation matrix. The translational displacement is performed 

by first subtracting the current position of the panel‚Äôs coordinate with rotation center points. 

The mathematical expression of the rotations and translational displacement is given by [18]: 

 
ùëÉ(cid:3036) = ùëÖ(cid:3051)ùëÖ(cid:3052) (cid:4686)

ùëÉ(cid:3036)(cid:3051)‚àíùë•(cid:3030)
ùëÉ(cid:3036)(cid:3052) ‚àí ùë¶(cid:3030)
ùëÉ(cid:3036)(cid:3053) ‚àí ùëß(cid:3030)

(cid:4687) + (cid:3429)

ùë•(cid:3030)
ùë¶(cid:3030)
ùëß(cid:3030)

(cid:3433) ,   ùëñ ‚àà {1,2,3,4},                                                                                (17) 

where, ùëÉ(cid:3036) are the points defining the PV module, ùëÉ(cid:3036)(cid:3051), ùëÉ(cid:3036)(cid:3052), and ùëÉ(cid:3036)(cid:3053) are the coordinates in the x-

axis, y-axis, and z-axis respectively for the PV module points; ùë•(cid:3030), ùë¶(cid:3030), and  ùëß(cid:3030) are the coordinates 

describing the centre of the PV module. The equation of the normal vector n can be retrieved 

from the orientation and the tilt of the PV modules plane [3]: 

ùíè = (cid:4688)

a = cos(ùõæ) sin (ùõø)
b = sin(ùõæ) sin(ùõø) ,
c = cos(ùõæ)

                                                                                                                  (18) 

Once the normal vector n and solar vector s are defined, the projection of the PV module points 

that  define  the  shading  on  the  desired  plane  can  be  solved  by  calculating  the  straight-line 

projections and can be determined as follows [3]: 

P‚Äô = (cid:4688)

ùëÉ(cid:3051) + ùë• ‚ãÖ ùë°
ùëÉ(cid:3052) + ùë¶ ‚ãÖ ùë°
ùëÉ(cid:3053) + ùëß ‚ãÖ ùë°

,                                                                                                                                  (19) 

The coordinates of point P‚Äô, projection onto the plane along the straight line are given by the 

intersection of the straight line and the plane and can be solved by calculating parameter t [3]: 

ùë° = ‚àí

ùëéùëÉ(cid:3051) + ùëèùëÉ(cid:3052) + ùëêùëÉ(cid:3053)
ùëéùë• + ùëèùë¶ + ùëêùëß

,                                                                                                                     (20) 

The beam shading factor can be calculated as follows: 

ùëì(cid:3029) =

ùê¥(cid:3046)(cid:3035)(cid:3028)(cid:3031)(cid:3032)
ùê¥(cid:3047)(cid:3042)(cid:3047)

,                                                                                                                                        (21) 

where Ashade is the shaded area (m2) and Atot (m2) is the total reference area for the crop between 

two PV module rows. In this study, an assumed crop area of 200 m2, the area between the PV 

rows  is  used  to  define  the  total  reference  area.  The  total  shading  on  the  reference  area  for 

multiple panels is calculated by calculating the union and is given by: 

(cid:3041)

ùê¥(cid:3046)(cid:3035)(cid:3028)(cid:3031)(cid:3032) = (cid:4651) ùê¥(cid:3046)(cid:3035)(cid:3028)(cid:3031)(cid:3032),(cid:3036),
(cid:3036)(cid:2880)(cid:2869)

                                                                                                                        (22) 

where, n is the number of PV modules, and ùê¥(cid:3046)(cid:3035)(cid:3028)(cid:3031)(cid:3032),(cid:3036) is the shaded area from each respective 

PV module. A shading table for the direct component is used to discretize the sky dome with 

altitude angles from 0¬∞ to 90¬∞ and azimuth angles from ‚àí180¬∞ to +180¬∞ of 1 degree. The diffuse 

shading factor ùëì(cid:3031) is calculated using the approach used in [3,12,19] and is given by: 

ùëì(cid:3031) =

(cid:2870)(cid:3095)
‚à´
(cid:3082)(cid:2880)(cid:2868)

(cid:3095)
(cid:2870)
‚à´
(cid:3080)(cid:2880)(cid:2868)
(cid:3095)
(cid:2870)
‚à´
(cid:3080)(cid:2880)(cid:2868)

ùëì(cid:3029)ùëÖ(cid:3080)(cid:3082)ùëêùëúùë†ùúÉùëëŒ©

(cid:2870)(cid:3095)
‚à´
(cid:3082)(cid:2880)(cid:2868)

ùëÖ(cid:3080)(cid:3082)ùëêùëúùë†ùúÉùëëŒ©

,                                                                                                          (23) 

where ùõº and ùõæ are the sun altitude and azimuth angles, ùëÖ(cid:3080)(cid:3082) is the radiance (W/m2sr), ùúÉ is the 

angle of incidence (¬∞), which is the angle between the sky element and the normal to the surface, 

and Œ© is the solid angle (sr). The solid angle can also be expressed as ùúïŒ© = cos (ùõº) ‚ãÖ ùúïùõºùúïùõæ. 

To simplify the diffuse shading factor calculation and remove radiance ùëÖ(cid:3080)(cid:3082), an isentropic sky 

has to be considered. The discretised sky dome can be numerically computed by: 

ùëì(cid:3031) =

(cid:3080)
‚àë ‚àë
(cid:3036)(cid:2880)(cid:2869)

(cid:3082)
(cid:3037)(cid:2880)(cid:2869)
(cid:3082)
(cid:3080)
‚àë ‚àë
(cid:3036)(cid:2880)(cid:2869)
(cid:3037)(cid:2880)(cid:2869)

ùëì(cid:3029)(cid:3284)(cid:3285) cos(cid:3435)ùúÉ(cid:3036)(cid:3037)(cid:3439) cos (ùõº(cid:3036))
cos(cid:3435)ùúÉ(cid:3036)(cid:3037)(cid:3439) cos (ùõº(cid:3036))

,                                                                                            (24) 

2.1  Fixed vertical PV 

The fixed vertical agrivoltaic system PV panel geometry is defined by four points  Pi in the 

plane that corresponds to the vertexes of the PV module or array. Once those points are defined, 

the projections of those vertices on the horizontal plane can be used to calculate the shaded 

area that occurs on the ground at a given time step. It is assumed that grass growing close to 

the supporting structure does not allow the sunlight to pass through similar to Campana et al. 

[12]. An illustration of the fixed vertical agrivoltaic system is depicted in Figure 4. 

Figure 4 Vertical fixed agrivoltaic system. 

 
 
2.2  One-axis and two-axis tracking 

In this study, one-axis and two-axis tracking and back-tracking angles have been calculated 

using similar equations as Lorenzo et al. [16]. The coordinates for the PV panel can be defined 

as  done  previously  for  the  fixed  vertical  PV.  An  illustration  of  the  one-axis  and  two-axis 

tracking systems used in this study is presented in Figure 5, and Figure 6, respectively. 

Figure 5 One-axis tracking agrivoltaic system. 

Figure 6 Two-axis tracking agrivoltaic system. 

 
  
 
2.3  Model comparison  

Two  commercial  software  are  used  to  compare  the  shading  factors  of  the  proposed  model: 

PVSyst¬Æ and SketchUp¬Æ. To make the comparison fair, the design of the three studied systems 

modelled in PVSyst¬Æ and SketchUp¬Æ are identical to the dimensions described in Table 1. 

The beam and diffuse shading factors have been calculated for four representative days, one 

for each season (i.e., the equinox of spring, the solstice of summer, the equinox of autumn, and 

the  solstice  of  winter).  The  shading  factor  comparison  refers  to  K√§rrbo  Pr√§stg√•rd  (Latitude 

59.6099¬∞N, Longitude 16.5448¬∞E, Altitude 20m), V√§ster√•s, Sweden. In this location, the first 

agrivoltaic  system  in  Sweden  was  installed  in  2021.  The  system  is  currently  installed  on  a 

pasture  grass  field.  The  data  is  gathered  from  Meteonorm  software,  providing  monthly 

meteorological  data  for  any  location  on  the  earth.  Using  stochastic  models,  it  generates 

synthetic hourly values from the monthly values [20]. The time resolution for validation is 1-

hour. The methodology employed to obtain the shading factors from both products is briefly 

presented in this section.  

2.3.1  SketchUp¬Æ 

SketchUp¬Æ is a 3D geometry modelling tool used by architects, engineers, and designers. The 

tool  contains  a  real-time  shadow  engine  that  can  be  used,  for  instance,  for  sun  exposure 

analysis. In this study, SketchUp¬Æ Make 2017 is used with the TIG Shadow Projector v7.0 

[21]  plugin  to  obtain  the  amount  of  shading  on  a  surface  for  a  specific  time  and  location. 

Consequently,  the  beam  shading  factors for  the three  agrivoltaic  configurations  are  derived 

from this tool. The real-time shadow engine from SketchUp¬Æ simulates the sun's position at a 

specific time of the year. Therefore, the engine visualizes the shadings on the ground created 

by  the  solar  modules  of  the  different  agrivoltaic  configurations.  Except  for  the  vertical 

configuration,  which  is  fixed,  the  geometries  (rotation angles)  of  the  one-axis  and  two-axis 

agrivoltaic systems are manually adjusted at every time step according to the optimized values 

from  the  tracking  systems.  Figure  7  shows  the  schematics  of  the  different  systems  in 

SketchUp¬Æ  and  an  example  of  the  results  displayed  by  the  plugin.  Concerning  the  diffuse 

shading factor, unfortunately, the validation could not be performed using SketchUp¬Æ.  

Figure 7 Schematics using SketchUp¬Æ Make 2017 and the plugin TIG Shadow Projector of 
the three AV systems: vertical (left), one-axis tracking (middle), and two-axis tracking 
(right). The yellow lines point towards the true North. The area of analysis is the grass-
coloured rectangle. 

2.3.2  PVsyst¬Æ 

PVsyst¬Æ  is  one  of  the  most  powerful  software  to  model  and  simulate  PV  systems  and  is 

designed for architects, researchers, and engineers [22]. The software has a 3D shading scene 

to analyse the shadings from a specific PV system design and shading scene. In this study, the 

3D shading scene was used to calculate both the diffuse shading factor and beam shading factor 

for  the  three agrivoltaic  configurations.  In  PVsyst¬Æ, to  calculate  the  shading  factors  on  the 

ground  instead  of  on  the  PV  array  as  it  is  conventionally  performed,  the  scene  had  to  be 

designed in a specific way as the software does not have any agrivoltaic/ground shading scene 

solution. The crop area was covered with a horizontal PV module corresponding to the grass, 

and the vertical and tracker modules were converted to shading objects. The shading factors 

can be calculated hourly by re-constructing the shading scene for the trackers to adjust their 

tracking position. Figure 8 shows a schematic of the different shading scenes in PVsyst¬Æ. 

Figure 8 Schematics using PVsyst¬Æ Shading scene of the three AV systems: vertical (left), 
one-axis tracking (middle), and two-axis tracking (right). The red line point towards the true 
East. 

 
   
 
2.4  Model testing 

The model developed in Matlab¬Æ is tested at three different locations in Europe with all three 

developed designs. The test is conducted by calculating the yearly PAR distribution at these 

sites. The data on PAR and GHI are collected from the Integrated Carbon Observation System 

(ICOS) [23]. The locations were chosen based on the availability of data at cropland sites. The 

locations with available hourly data used in this paper are presented in Table 2. 

Table 2 Data of ICOS stations. 

Station 

Latitude (¬∞) 

Longitude (¬∞) 

Elevation (m)  Year 

Lanna, Sweden 

58.33 

Estrees-Mons, France 

49.87 

Klingenberg, Germany 

50.89 

13.1 

3.02 

13.52 

75 

85 

478 

2018 

2018 

2018 

The PAR is decomposed into its diffuse and direct components. This decomposition of PAR is 

critical in agrivoltaic systems due to the variable shadings caused by the panels on the crops, 

creating  a  non-homogenous  PAR/diffuse  PAR  distribution  during  the  day  [24].  The 

decomposition model used in this study is YANG2 and is given by [25]: 

1 ‚àí ùê∂

1 + ùëí(cid:3081)(cid:3116)(cid:2878)(cid:3081)(cid:3117)(cid:3038)(cid:3295)(cid:2878)(cid:3081)(cid:3118)(cid:3002)(cid:3020)(cid:3021)(cid:2878)(cid:3081)(cid:3119)(cid:3027)(cid:2878)(cid:3081)(cid:3120)(cid:2940)(cid:3038)(cid:3295)(cid:3278)(cid:2878)(cid:3081)(cid:3122)(cid:3038)(cid:3279)

((cid:3294)) + ùõΩ(cid:2873)ùëò(cid:3031)(cid:3032),                                                        (25) 

,                                                                                                                                              (26) 

ùëò(cid:3031) = ùê∂ +

ùëò(cid:3047) =

ùê∫ùêªùêº
ùê∏(cid:3032)(cid:3051)(cid:3047)

Œîùëò(cid:3047)(cid:3030) =

ùê∫(cid:3030)(cid:3046)
ùê∏(cid:3032)(cid:3051)(cid:3047)

‚àí ùëò(cid:3047),                                                                                                                                 (27) 

ùëò(cid:3031)(cid:3032) = max (cid:3436)0,1 ‚àí

ùê∫(cid:3030)(cid:3046)
ùê∫ùêªùêº

(cid:3440),                                                                                                                  (28) 

where the model coefficients used in this study have been fitted to three ICOS stations from 

Sweden [24] being C = 0.0888, Œ≤(cid:2868) = ‚àí26258, Œ≤(cid:2869) = 7.2506, Œ≤(cid:2870) = ‚àí0.0458, Œ≤(cid:2871) = 0.0099, 
((cid:2929)) is the satellite-derived diffuse fraction, G(cid:2913)(cid:2929) 
Œ≤(cid:2872) = ‚àí0.0839, Œ≤(cid:2873) = 0.5002, Œ≤(cid:2874) = ‚àí2.1731. k(cid:2914)
is the clear sky GHI  [W/m2], AST  is  the apparent solar time [h],  ùê∏(cid:3032)(cid:3051)(cid:3047)  is  the  extraterrestrial 
radiation [W/m2], and ùëò(cid:3047) is the clearness index. The ùëò(cid:3031) value from the YANG2 model can be 
used in the relationship defined by Spitters et al. [26] to get the correct PAR estimates: 

(cid:3017)(cid:3002)(cid:3019) =

ùëò(cid:3031)

ùëÉùê¥ùëÖ(cid:3031)(cid:3036)(cid:3033)(cid:3033)(cid:3048)(cid:3046)(cid:3032)
ùëÉùê¥ùëÖ(cid:3047)(cid:3042)(cid:3047)(cid:3028)(cid:3039)

=

[1 + 0.3(1 ‚àí (ùëò(cid:3031)

(cid:3026)(cid:3002)(cid:3015)(cid:3008)(cid:2870))(cid:2870))]ùëò(cid:3031)
(cid:3026)(cid:3002)(cid:3015)(cid:3008)(cid:2870))(cid:2870)) cos(cid:2870)(90 ‚àí ùõΩ) cos(cid:2871)(ùõΩ)

(cid:3026)(cid:3002)(cid:3015)(cid:3008)

1 + (1 ‚àí (ùëò(cid:3031)

,                                    (29) 

where, ùõΩ is the solar elevation angle [¬∞]. The satellite data is obtained through the Copernicus 

Atmosphere  Monitoring  Service  radiation  service  (CAMS)  which  has  a  spatial  coverage  of 

‚àí66¬∞ to 66¬∞ in both latitudes and longitudes  and a temporal resolution of  15-min [27]. The 

ground area is discretized by 0.25m √ó 0.25m. The discretization makes it possible to analyse 

the  variation  of  PAR  using  different  agrivoltaic  system  designs  at  various  locations.  To 

compare different agrivoltaic systems, a light homogeneity index (LHI)  can be used,  and is 

defined  as  the  ratio  of  sample  standard  deviation  to  mean  and  is  given  by  the  following 

equation: 

ùêøùêªùêº = 100 ‚àô (cid:4684)1 ‚àí

1
ùëõ ‚àí 1

‚àë (ùë•(cid:3036) ‚àí ùë•ÃÖ)(cid:2870)

(cid:3041)
(cid:3041)(cid:2879)(cid:2869)
ùë•ÃÖ

(cid:4685),                                                                                (30) 

where, n is the number of discretized areas on the ground, xi is the total PAR including shadings 

from the agrivoltaic system, ùë•ÃÖ is the average yearly PAR. An LHI of 100% corresponds to a 

PAR  light  distribution  that  is  equal  throughout  the  ground  area  and  can  in  other  terms  be 

defined as a complete homogenous light distribution. 

3  Results and discussion 

In this section, the shading factor validation is first presented and is then followed by presenting 

the  PAR  distribution  for  the  vertical,  one-axis,  and  two-axis  agrivoltaic  systems  in  Lanna, 

Estrees-Mons, and Klingenberg. Figure 9 presents the validation results for the vertical, one-

axis, and two-axis agrivoltaic systems for all days.  

r
o

t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

r
o

t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

r
o

t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

Figure 9 Beam shading factor time series for vertical, one axis, and two axis agrivoltaic 
systems for four representative days. Comparison between the Matlab¬Æ model developed in 
this study and the models developed in PVsyst¬Æ and SketchUp¬Æ. 

The MBE and RMSE for the beam shading factors are summarized in Table 3. The Matlab¬Æ 

model  shows  a  good  correlation  with  both  PVsyst¬Æ  and  SketchUp¬Æ  in  all  the  investigated 

agrivoltaic layouts models.  

Table 3 Beam shading factor error metrics between Matlab¬Æ, PVsyst¬Æ, and SketchUp¬Æ. 

Beam shading factor 

PVsyst¬Æ 

SketchUp 

System 

MBE 

Vertical 

0.0008 

One-axis 

0 

RMSE 

0.0040 

0.0006 

MBE 

0.0011 

0 

RMSE 

0.0039 

0.0012 

 
 
 
 
 
 
 
Two-axis 

0.0003 

0.0006 

0.0026 

0.0055 

In Figure 10, the scatter plots illustrate the comparison between the Matlab¬Æ, PVsyst¬Æ, and 

SketchUp¬Æ models. The R2 values for all models have shown a performance above 99%, which 

shows that the Matlab¬Æ models have a good correlation with commercially available products. 

t
s
y
s
V
P

r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

t
s
y
s
V
P
r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

t
s
y
s
V
P
r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

1

0.8

0.6

0.4

0.2

0

0

1

0.8

0.6

0.4

0.2

0

0

1

0.8

0.6

0.4

0.2

0

0

Vertical - PVsyst

Data
1:1 line
Fit line

R2 = 0.9998

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab
One-axis - PVsyst

Data
1:1 line
Fit line

R2 = 1

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab
Two-axis - PVsyst

Data
1:1 line
Fit line

R2 = 1

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab

p
U
h
c
t
e
k
S

r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

p
U
h
c
t
e
k
S
r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

p
U
h
c
t
e
k
S
r
o
t
c
a

f

i

g
n
d
a
h
s
m
a
e
B

1

0.8

0.6

0.4

0.2

0

0

1

0.8

0.6

0.4

0.2

0

0

1

0.8

0.6

0.4

0.2

0

0

Vertical - SketchUp

Data
1:1 line
Fit line

R2 = 0.9998

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab
One-axis - SketchUp

Data
1:1 line
Fit line

R2 = 0.9999

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab
Two-axis - SketchUp

Data
1:1 line
Fit line

R2 = 0.999

0.2

0.4

0.6

0.8

1

Beam shading factor Matlab

Figure 10 Scatter plots for beam shading factor. Comparison between the Matlab¬Æ model 
developed in this study and the models developed in PVsyst¬Æ and SketchUp¬Æ. 

For the assumptions made concerning the isotropy of the sky, the diffuse shading factor must 

be determined only once for the fixed tilt agrivoltaic system layout. Nevertheless, for the one-

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
axis and two-axis agrivoltaic systems layouts, the diffuse shading factor must be determined 

hourly due to the involved rotations. Figure 11 presents the diffuse shading factor time series 

for  the  one-  and  two-axis  agrivoltaic  systems  for  all  the  representative  days.  The  diffuse 

shading factors from the Matlab¬Æ model are accurately calculated compared to PVsyst¬Æ. The 

diffuse shading factor was obtained by manually adjusting the near shading scene in PVsyst¬Æ. 

r
o

t
c
a

f

i

g
n
d
a
h
s
e
s
u

f
f
i

D

r
o
t
c
a

f

i

g
n
d
a
h
s
e
s
u

f
f
i

D

0.2

0.15

0.1

0.05

0

0.15

0.1

0.05

0

One-axis Agrivoltaic System

Matlab
PVsyst

Equinox of spring Solstice of summer Equinox of autumn

Solstice of winter

Two-axis Agrivoltaic System

Matlab
PVsyst

Equinox of spring Solstice of summer Equinox of autumn

Solstice of winter

Figure 11 Diffuse shading factor time series for one axis and two axis agrivoltaic systems. 
Comparison between the Matlab¬Æ model developed in this study and the model developed in 
PVsyst¬Æ. 

The MBE and RMSE for the diffuse shading factors are summarized in Table 4. The model 

developed  in  Matlab¬Æ  is  estimating  the  diffuse  shading  factors  accurately  for  all  four 

representative days, for both the one-axis and two-axis tracker as seen in Figure 11.   

 
 
 
 
 
Table 4 Diffuse shading factor error metrics between the model developed in this study in 
Matlab¬Æ and PVsyst¬Æ. 

Diffuse shading factors 

System 

PVsyst¬Æ 

MBE 

RMSE 

Vertical 

0.0018 

One-axis 

‚àí0.0002 

Two-axis 

‚àí0.0002 

0.0018 

0.0004 

0.0004 

In Figure 12, the scatter plots illustrate the comparison between the Matlab¬Æ and PVsyst¬Æ for 

one-axis and two-axis agrivoltaic systems. The R2 shows a good correlation between all models 

in Matlab¬Æ and PVsyst¬Æ. 

Figure 12 Scatter plots for diffuse shading factor. Comparison between the Matlab¬Æ model 
developed in this study and the model developed in PVsyst¬Æ one-axis and two-axis 
agrivoltaic systems. 

The  validation  of  the  developed  model  in  Matlab¬Æ  has  shown  a  good  correlation  and  can 

therefore  be  used  for  accurate  shading  calculations  under  agrivoltaic  systems.  Figure  13 

presents the yearly PAR distribution for the three different agrivoltaic configurations developed 

in this study for Lanna in Sweden, Estrees-Mons in France, and Klingenberg in Germany. 

 
 
Figure 13 Yearly PAR distribution for the vertical, one-axis, and two-axis designs for Lanna 
in Sweden, Estrees-Mons in France, and Klingenberg in Germany. 

The PAR distribution can be used to analyse several agrivoltaic systems layouts to identify the 

most suitable  layout  for  a specific  crop  or  crop  rotation  at  any  location.  The  model  can be 

deployed to reduce crop yield simulation uncertainties under agrivoltaic systems significantly. 

As  seen  in  Figure  11,  the  PAR  varies  depending  on  the  choice  of  system  design  and 

geographical  location.  The  two-axis  tracking  system  showed  the  highest  yearly  PAR.  For 

instance,  in  Estrees-Mons  the  mean  PAR  was  495  [kWh/m2,  year].  The  yearly  mean  PAR 

varies  significantly  dependent  on  system  design.  In  Estrees-Mons,  the  difference  in  yearly 

mean PAR between the two-axis and the vertical system was 117 [kWh/m2, year]. It is also 

essential to have a low variation of PAR throughout the reference crop area, as a high variation 

of PAR could heavily affect the crop yield. 

Additionally, crop water stress can be increased due to PAR heterogeneity throughout the field. 

To avoid a system design with high PAR heterogeneity, the LHI is used for all three system 

designs to assess PAR homogeneity. In Table 5, the LHI for the vertical, one-axis, and two-

axis  designs  are  presented.  100%  corresponds  to  a  homogenous  distribution  and  0% 

corresponds to a non-homogenous distribution. 

 
 
Table 5 Light homogeneity index for the vertical, one-axis, and two-axis designs for Lanna in 
Sweden, Estrees-Mons in France, and Klingenberg in Germany. 

Vertical 
One-axis 
Two-axis 

Lanna 
92.68% 
91.83% 
95.25% 

LHI 
Estrees-Mons 
93.76% 
92.03% 
95.39% 

Klingenberg 
93.48% 
91.84% 
95.26% 

All three designs had a high LHI above 91% at all locations. However, the system design with 

the highest LHI was the two-axis system with an LHI above 95% at all three locations and at 

the same time having the highest yearly PAR reaching the crop area. The LHI gives a better 

understanding of the variation of PAR over the field. However, it is still essential to know the 

total reduction of PAR for the specific system as a complement to the LHI (Table 6). The total 

yearly PAR reduction can be calculated by fractioning the PAR without shading on the ground 

and the PAR with the respective agrivoltaic system. 

Table 6 Total yearly PAR reduction for the vertical, one-axis, and two-axis designs for Lanna 
in Sweden, Estrees-Mons in France, and Klingenberg in Germany. 

Vertical 
One-axis 
Two-axis 

Lanna 
34.72% 
22.46% 
11.41% 

Total yearly PAR reduction 
Estrees-Mons 
32.12% 
23.14% 
11.17% 

Klingenberg 
32.24% 
23.01% 
11.82% 

The yearly PAR reduction varies significantly depending on the choice of agrivoltaic design. 

The choice of an agrivoltaic system is fundamental as the shading significantly impacts the 

amount of yearly PAR reaching the crops. In this case, the variation of yearly PAR reduction 

could vary from 11% to 34%, dependent on the choice of agrivoltaic system. It can be noticed 

that the two-axis agrivoltaic system had the lowest yearly PAR reduction at all studied sites. 

However, a low yearly PAR reduction does not necessarily represent  an optimal agrivoltaic 

system design, as the crop's photosynthetic rate  is a function of light intensity which varies 

between species. This shows that it is important to accurately design the agrivoltaic system by 

finding the optimal synergy between the crop and PV systems. The Matlab¬Æ model developed 

in this study can be used as a universal model for agrivoltaic systems at any location in the 

world  and  gives  the  freedom  to  analyze  shading  factors  and  how  these  affect  the  PAR 

distribution  at  the  crop  level  and  consequently  the  crop  yield  for  any  agrivoltaic  system. 

Additionally, the model in the study can be integrated into modelling platforms such as those 

developed  by  Campana  et  al.  [12]  and  Amaducci  et  al.  [14]  to  maximize  crop  yield  and 

 
 
 
 
electricity  production,  and PV  modules  orientation,  especially  for  those  agrivoltaic  systems 

layouts equipped with tracking systems. 

4  Conclusions 

In this study, three mathematical models are developed in Matlab¬Æ for accurately calculating 

the beam and diffuse shading factors, which can be used to estimate the shaded beam horizontal 

irradiance and shaded diffuse horizontal irradiance at a ground level. This modelling effort has 

been carried out to accurately depict the PAR distribution and reduction at ground level, which 

is of fundamental importance in assessing agrivoltaic system effects on crop yield. The three 

investigated  models  were  for  fixed  vertical,  one-axis  tracking,  and  two-axis  tracking  PV 

systems for agrivoltaic applications. The models were validated with the commercial software 

PVsyst¬Æ  and SketchUp¬Æ.  The main  conclusions  that  can  be  drawn  from  this  article  are  as 

follows: 

ÔÇ∑  All mathematical models developed in this study showed high accuracies compared to 

PVsyst¬Æ and SketchUp¬Æ and can be considered robust for shading calculations under 

agrivoltaic systems. The beam shading factor and diffuse shading factor calculated with 

the  developed  Matlab¬Æ  model  showed  an  R2  of  0.99-1  compared  to  PVsyst¬Æ  and 

SketchUp¬Æ. 

ÔÇ∑  Besides comparing the hourly model results with commercially available products, in 

this study, the model development has also focused on the high temporal and spatial 

resolution  of  PAR  distribution  at  the  crop  level.  This  assessment  is  of  fundamental 

importance for studying the effects of shading on crops and crop rotation to identify the 

most suitable agrivoltaic system layout depending on crops and geographical locations. 

By calculating a light homogeneity index and yearly PAR reduction it could be seen 

that the light homogeneity and PAR reduction could vary significantly dependent on 

agrivoltaic system designs from 91% to 95% and from 11% to 34%, respectively. The 

two-axis agrivoltaic system had the highest light homogeneity and lowest yearly PAR 

reduction in Estrees-Mons with a light homogeneity index of 95.39% and total yearly 

PAR reduction of 11.17%.  

The models developed in Matlab¬Æ are universal models that can be easily adapted to other 

type  of  agrivoltaic  system  layouts  and  integrated  with  agrivoltaic  system  modelling 

platforms for the dual assessment of electricity and crop production. 

5  Acknowledgments 

The  authors  acknowledge  the  financial  support  received  from  the  Swedish  Energy  Agency 

through the project ‚ÄúSOLVE solar energy research center‚Äù, grant number 52693-1. The main 

author also acknowledges the financial support received from European Energy Sverige AB. 

The authors also acknowledge the financial support received from the Swedish Energy Agency 

through the project "Evaluation of the first agrivoltaic system in Sweden", grant number 51000-

1. The author Pietro Elia Campana acknowledges Formas - a Swedish Research Council for 

Sustainable Development, for the funding received through the early career project ‚ÄúAvoiding 

conflicts between the sustainable development goals through agro-photovoltaic systems‚Äù, grant 

number FR-2021/0005. 

References  

[1]  V. Quaschning, R. Dr. Hanitsch, SHADE CALCULATIONS IN PHOTOVOLTAIC 

SYSTEMS, (1995). 

[2]  J. Bany, J. Appelbaum, The effect of shading on the design of a field of solar collectors, 

Sol. Cells. 20 (1987) 201‚Äì228. https://doi.org/10.1016/0379-6787(87)90029-9. 
[3]  Y. Cascone, V. Corrado, V. Serra, Calculation procedure of the shading factor under 

complex boundary conditions, Sol. Energy. 85 (2011) 2524‚Äì2539. 
https://doi.org/10.1016/j.solener.2011.07.011. 

[4]  M. Silva, J.J. Roberts, P.O. Prado, Calculation of the Shading Factors for Solar Modules 

with MATLAB, Energies. 14 (2021) 4713. https://doi.org/10.3390/en14154713. 

[5]  E.G. Melo, M.P. Almeida, R. Zilles, J.A.B. Grimoni, Using a shading matrix to estimate 
the shading factor and the irradiation in a three-dimensional model of a receiving 
surface in an urban environment, Sol. Energy. 92 (2013) 15‚Äì25. 
https://doi.org/10.1016/j.solener.2013.02.015. 

[6]  K. Proctor, G. Murthy, C. Higgins, Agrivoltaics Align with Green New Deal Goals 

While Supporting Investment in the US‚Äô Rural Economy, Sustainability. 13 (2020) 137. 
https://doi.org/10.3390/su13010137. 

[7]  E.H. Adeh, S.P. Good, M. Calaf, C.W. Higgins, Solar PV Power Potential is Greatest 

Over Croplands, Sci. Rep. 9 (2019) 11442. https://doi.org/10.1038/s41598-019-47803-3. 

[8]  A.S. Pascaris, R. Handler, C. Schelly, J.M. Pearce, Life cycle assessment of pasture-
based agrivoltaic systems: Emissions and energy use of integrated rabbit production, 
Clean. Responsible Consum. 3 (2021) 100030. 
https://doi.org/10.1016/j.clrc.2021.100030. 

[9]  G.A. Barron-Gafford, M.A. Pavao-Zuckerman, R.L. Minor, L.F. Sutter, I. Barnett-
Moreno, D.T. Blackett, M. Thompson, K. Dimond, A.K. Gerlak, G.P. Nabhan, J.E. 
Macknick, Agrivoltaics provide mutual benefits across the food‚Äìenergy‚Äìwater nexus in 
drylands, Nat. Sustain. 2 (2019) 848‚Äì855. https://doi.org/10.1038/s41893-019-0364-5. 

 
 
[10]  Agrivoltaic Systems, A Promising Experience, Energy Ind. Rev. (2021). 

https://energyindustryreview.com/analysis/agrivoltaic-systems-a-promising-experience/ 
(accessed June 2, 2022). 

[11]  S. Tazawa, Effects of various radiant sources on plant growth (Part 1), Jpn. Agric. Res. 

Q. 33 (1999) 163‚Äì176. 

[12]  P.E. Campana, B. Stridh, S. Amaducci, M. Colauzzi, Optimisation of vertically mounted 

agrivoltaic systems, J. Clean. Prod. 325 (2021) 129091. 
https://doi.org/10.1016/j.jclepro.2021.129091. 

[13]  J.R. Williams, C.A. Jones, J.R. Kiniry, D.A. Spanel, The EPIC crop growth model, 

Trans. ASAE. 32 (1989) 497‚Äì0511. 

[14]  S. Amaducci, X. Yin, M. Colauzzi, Agrivoltaic systems to optimise land use for electric 

energy production, Appl. Energy. 220 (2018) 545‚Äì561. 
https://doi.org/10.1016/j.apenergy.2018.03.081. 

[15]  Edera.digital, REM Tec - La soluzione per il fotovoltaico legata all‚Äôagricoltura, (2021). 

https://remtec.energy/en/agrovoltaico (accessed December 31, 2021). 

[16]  E. Lorenzo, L. Narvarte, J. Mu√±oz, Tracking and back-tracking: Tracking and Back-

Tracking, Prog. Photovolt. Res. Appl. 19 (2011) 747‚Äì753. 
https://doi.org/10.1002/pip.1085. 

[17]  P.R. Evans, Rotations and rotation matrices, Acta Crystallogr. D Biol. Crystallogr. 57 

(2001) 1355‚Äì1359. https://doi.org/10.1107/S0907444901012410. 

[18]  linear algebra - Rotation around non-zero point, Math. Stack Exch. (2016). 

https://math.stackexchange.com/questions/1964905/rotation-around-non-zero-point 
(accessed December 31, 2021). 

[19]  D.H.W. Li, J.C. Lam, Predicting solar irradiance on inclined surfaces using sky radiance 

data, Energy Convers. Manag. 45 (2004) 1771‚Äì1783. 
https://doi.org/10.1016/j.enconman.2003.09.020. 

[20]  Intro, Meteonorm De. (n.d.). https://meteonorm.com/ (accessed August 3, 2022). 
[21]  Shadow Projector | SketchUcation, (n.d.). https://sketchucation.com/plugin/1292-

tig_shadowprojector (accessed August 9, 2022). 

[22]  PVsyst, PVsyst. (2022). https://www.pvsyst.com/ (accessed January 4, 2022). 
[23]  Integrated Carbon Observation System, ICOS. (n.d.). https://www.icos-cp.eu/ (accessed 

June 2, 2022). 

[24]  S. Ma Lu, S. Zainali, B. Stridh, A. Avelin, S. Amaducci, M. Colauzzi, P.E. Campana, 
Photosynthetically active radiation decomposition models for agrivoltaic systems 
applications, Sol. Energy. (2022) S0038092X22003917. 
https://doi.org/10.1016/j.solener.2022.05.046. 

[25]  D. Yang, J. Boland, Satellite-augmented diffuse solar radiation separation models, J. 
Renew. Sustain. Energy. 11 (2019) 023705. https://doi.org/10.1063/1.5087463. 
[26]  C.J.T. Spitters, H.A.J.M. Toussaint, J. Goudriaan, Separating the diffuse and direct 

component of global radiation and its implications for modeling canopy photosynthesis 
Part I. Components of incoming radiation, Agric. For. Meteorol. 38 (1986) 217‚Äì229. 
https://doi.org/10.1016/0168-1923(86)90060-2. 

[27]  Data | Copernicus, (n.d.). https://atmosphere.copernicus.eu/data (accessed June 2, 2022). 

 
