MNRAS 000, 1–9 (2021)

Preprint 27 April 2022

Compiled using MNRAS LATEX style ﬁle v3.0

PyNAPLE: Lunar Surface Impact Crater Detection

D. Sheward,1(cid:63) C. Avdellidou,2,3 A. Cook,1 E. Sefton-Nash,3 M. Delbo,2 B. Cantarella,4 and L. Zanatta4
1Department of Physics, Aberystwyth University, Ceredigion, SY23 3BZ, UK
2Université Côte d’Azur, Laboratoire Lagrange, Observatoire de la Côte d’Azur, CS 34229-F 06304 Nice Cedex 4, France
3ESTEC, European Space Agency, Keplerlaan 1, 2201 AZ Noordwijk, The Netherlands
4Sezione di Ricerca Luna dell’Unione Astroﬁli Italiani

2
2
0
2

r
p
A
6
2

]
P
E
.
h
p
-
o
r
t
s
a
[

1
v
5
6
2
2
1
.
4
0
2
2
:
v
i
X
r
a

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT

In the last 20 years, over 600 impact ﬂashes have been documented on the lunar surface. This wealth of data presents a
unique opportunity to study the meteoroid ﬂux of the Earth-Moon environment, and in recent years the physical properties of
the impactors. However, other than through serendipitous events, there has not been yet a systematic search and discovery of
the craters associated to these events. Such a meteoroid-crater link would allow us to get insight into the crater formation via
these live observations of collisions. Here we present the PyNAPLE (Python NAC Automated Pair Lunar Evaluator) software
pipeline for locating newly formed craters using the location and epoch of an observed impact ﬂash. We present the ﬁrst results
from PyNAPLE, having been implemented on the 2017-09-27 impact ﬂash.

A rudimentary analysis on the impact ﬂash and linked impact crater is also performed, ﬁnding that the crater’s ejecta pattern
indicates an impact angle between 10-30◦, and although the rim-to-rim diameter of the crater is not resolvable in current LRO
NAC images, using crater scaling laws we predict this diameter to be 24.1-55.3 m, and using ejecta scaling predict a diameter of
27.3-37.7 m. We discuss how PyNAPLE will enable large scale analyses of sub-kilometer scale cratering rates and reﬁnement
of both scaling laws, and the luminous eﬃciency.

Key words: Software: Development – Moon – Meteoroids – Techniques: Image Processing – Planets and Satellites: Surfaces

1 INTRODUCTION

Impact craters have been observed on several types of solar sys-
tem bodies, such as planets, natural satellites, asteroids, comets, and
transneptunian objects. Moreover, the larger atmosphereless bodies
such as Mercury, the Moon, and Ganymede have impact craters cov-
ering the majority of the surface. By studying these impact craters
we aim to understand how the most violent process of impacts shape
the planetary surfaces, reveal the chronology of surfaces (Neukum
et al. 2001; Hartmann 2005), as well as the mixing of materials on
them (DellaGiustina et al. 2021; Tatsumi et al. 2021; Avdellidou
et al. 2018).

Cratering studies are predominately done in hypervelocity impact
laboratories where the impact conditions can be controlled, such as
the impact speed, impact angle, and the materials of the target and
impactor. Moreover, in the laboratory the impact outcome can also
be monitored both during and post-impact such as the amount and
speed of the ejecta (Housen & Holsapple 2011, 2012), the size and
morphology of the crater (Housen et al. 1999; Housen & Holsapple
2003; Housen et al. 2018; Avdellidou et al. 2020), the survival of
the projectile (Avdellidou et al. 2016, 2017; Daly & Schultz 2015,
2016), etc. However, laboratory experiments are restricted by the
relatively low speeds (<8 km s−1, Burchell et al. 1999) and the small

(cid:63) E-mail: djs22@aber.ac.uk (DS)

© 2021 The Authors

size of the projectile (a few mm) that can be used as an impactor at
such speeds.

A number of crater scaling laws have also been developed which
describe the relationship between the impactor energy and the size of
the resulting crater (Horedt & Neukum 1984; Melosh 1989). These
crater scaling laws however are of questionable accuracy; each scal-
ing law proposed is generally accurate only for the energy, mass,
and velocity ranges of the experiments from which the laws were
derived, becoming increasingly inaccurate as these ranges are devi-
ated from.

The study of the impacts themselves have been the subject
of several missions. ISRO’s Chandrayaan-1 Moon Impact Probe
(Goswami & Annadurai 2009), and NASA’s Lunar Crater Obser-
vation and Sensing Satellite (LCROSS) (Heldmann et al. 2008)
missions were both impacted into the Lunar surface in order to
observe for volatiles in the ejecta cloud, and the formed impact
craters have been subsequently studied using NASA Lunar Recon-
naissance Orbiter (LRO) data (Hayne et al. 2010; Colaprete et al.
2010; Schultz et al. 2010). Furthermore, the sample return mission
Hayabusa2 (JAXA) performed an artiﬁcial impact on the surface of
the near-Earth asteroid Ryugu (Arakawa et al. 2020). Nevertheless
such large-scale experiments are rare and expensive for systematic
studies.

Every year the Earth is bombarded with 15000 tonnes of rock,
metal, and ice, from space in the form of meteoroids. While the ma-

 
 
 
 
 
 
2

D. Sheward et al.

jority of this material ablates in the atmosphere as a meteor, this
material can cause substantial damage through both direct colli-
sions with the ground, and through exploding as an air-burst such
as in Cheylabinsk in 2013 (Popova et al. 2013), and Tunguska in
1908 (Bagnall 1988). It is estimated that the frequency of impacts
on Earth by a cm-size object is 1000 times greater than a meter-
size one (Suggs et al. 2014). However, such small impactors never
reach the ground to form a crater, due to them completely ablating in
the atmosphere. For this reason, in the last 20 years the attention is
shifted towards the atmosphereless Moon, where the most common
impact study is the monitoring for transient luminous event caused
by impacting meteoroids, known as lunar impact ﬂashes (LIF). Dur-
ing an impact event the kinetic energy (KE) of the impactor is par-
titioned, and a small fraction (<0.5%) is transformed to luminous
energy (Elum).

These LIF are bursts of light, typically lasting a few milliseconds
but are detectable through moderately sized telescopes, are there-
fore available for observing by both professionals and amateur as-
tronomers alike. These LIFs have been observed since 1999 (Ortiz
et al. 1999, 2000), with unconﬁrmed reports as early as 1953 (John-
son & Buratti 2001), and in total over 600 LIFs have been reported
in the literature or in LIF databases (Ortiz et al. 2002, 2006, 2015;
Madiedo et al. 2014, 2015b, 2018; Ait Moulay Larbi et al. 2015;
Bonanos et al. 2018; Avdellidou et al. 2021).

There have been analysis methods developed where several pa-
rameters of the impact process itself (Suggs et al. 2014; Madiedo
et al. 2015a; Avdellidou et al. 2021) as well as physical properties
of the impactors (Avdellidou & Vaubaillon 2019; Avdellidou et al.
2021) can be determined. These methods allowed the construction
of the size frequency distribution of the cm-dm meteoroids (Suggs
et al. 2014; Avdellidou et al. 2021) as well as the distribution of
the temperatures (Avdellidou & Vaubaillon 2019; Avdellidou et al.
2021) of the ﬂash events that appear to verify the theoretical estima-
tions (Cintala 1992; Nemtchinov et al. 1998). The identiﬁcation of
the craters caused by the impacts observed as LIFs is of a paramount
importance, in order to establish the desired link between the size of
the impactor and the size of the crater. In the recent past, the Lunar
Reconnaissance Orbiter discovered over 220 fresh craters (Speyerer
et al. 2016). Only two fresh impact craters, however, have been lo-
cated following LIF observations; one by the Marshall Space Flight
Center on 2013-03-17 (Moser et al. 2014; Robinson et al. 2015), and
the other by MIDAS on 2013-09-11 (Madiedo et al. 2014; Robin-
son 2014). The detection of the ﬁrst crater was serendipitous rather
than systematic, and the detection of the second crater involved per-
forming targeted LRO observations to aid in their search - a process
which is not viable for the general scientiﬁc community.

In this work we present the PyNAPLE (Python Nac Automated
Pair Lunar Evaluator) algorithm pipeline, developed to use LIF ob-
servations and subsequently identify new craters on the Moon us-
ing the images from the LRO. PyNAPLE utilises broadly the same
methodology as described by Speyerer et al. (2016), however apply-
ing it in a more targeted manner. PyNAPLE has been designed with
the intention of being utilised as a publicly available tool for both
amateurs and professionals to use, and its primary aim is to produce
a substantial data set of impact ﬂash linked impact craters.

In section 2 we discuss the datasets that PyNAPLE is designed
to utilise, which are also used to calibrate and test the algorithm.
In section 3 we discuss its operating procedure, section 4 discusses
the tests performed on PyNAPLE, and section 5 presents the ﬁrst
result of a conﬁrmed crater. In section 6 we perform a short analy-
sis on the crater and we discuss how PyNAPLE will enable larger
scale statistical analyses of impact crater formation at the sub-metre

MNRAS 000, 1–9 (2021)

impactor scale, with the intent of utilising this data to reﬁne crater
scaling laws, and examine the accuracy of the luminous eﬃciency
values used for lunar impacts.

2 DATASETS

2.1 Images from LROC Instrument

The Lunar Reconnaissance Orbiter Camera (LROC) consists of a
Wide Angle Camera (WAC), and two Narrow Angle Cameras (NAC)
(Robinson et al. 2010). These NACs are panchromatic line-scan
cameras with 5064 pixels, which combine to give 0.5 m px−1 resolu-
tion at 50 km altitude. As of February 2022, the LROC has obtained
over 3 million images, totalling over 1 petabyte of data. The LROC
began its imaging of the lunar surface 2009-09-15, and is expected to
keep operating at least until 2026, giving a 17-year span over which
impact ﬂash linked craters can be detected by PyNAPLE.

LROC images are released publicly on a monthly basis approxi-
mately three months after collection, giving the minimum time be-
tween observation to crater detection of 3 months. While the imag-
ing performed by the LRO is not continuous, having readout times
between subsequent images, the area covered by the LRO WAC
in the month-long image release period generally encompasses the
whole Moon. The surface area covered by LRO NAC images in this
time is approximately an order of magnitude less than the area the
LRO WAC covers, having only partial coverage of the lunar sur-
face in a stochastic pattern. Due to the nature of the LRO mission
having targets of interest for which the spacecraft will re-orient to
observe, and inconsistent capture and readout times for images, the
gap between LRO NAC images can be erratic. The ability to pre-
dict whether a certain point on the lunar surface will be imaged in
a given month is therefore not possible without knowledge of the
LROs target schedule.

PyNAPLE utilises LRO NAC images as its basis for locating
changes. While WAC images oﬀer greater surface coverage of the
lunar surface, its nominal resolution of 100 m px−1 is not sensitive
enough for the majority of impact crater detection; the ejecta blan-
kets caused by the most common observable impact ﬂashes would be
less than a pixel in size at this scale. NAC images are instead used,
and provide almost total coverage between 75◦and -75◦, with the
sub-metre resolution being more suitable to resolve ﬁner details of
the typically >50 m craters. Using this large dataset of images pro-
vides a consistency between images which aids to simplify image
processing and prevent any artefacts produced from using dissimilar
images collected by diﬀering instruments.

2.2 Lunar Impact Flash Observations

The main function of PyNAPLE is to search for new craters at loca-
tions where impacts have been recorded on the Moon via the obser-
vation of their impact ﬂashes.

Several observational campaigns exist for the purpose of ob-
serving and recording LIFs. NASAs Meteoroid Environment Of-
ﬁce (MEO) runs an observational campaign since 2005 and collates
observed events into a publicly available list of events1, however,
the actual video frames are not made available (Suggs et al. 2008).
Over 120 events have been analysed and published by their team
(Suggs et al. 2014). NELIOTA is an ESA-funded project running

1 https://www.nasa.gov/centers/marshall/news/lunar/lunar_impacts.html

PyNAPLE: Lunar Surface Impact Crater Detection

3

since 2017 and provides publicly available data2 from the LIFs ob-
served (Xilouris et al. 2018). MIDAS is a Spanish based observation
campaign that releases ﬁndings in published works. The MIDAS
team developed their own software for LIF detection and analysis
which is not publicly available (Madiedo et al. 2015a). While these
campaigns each have diﬀerent methods of observing, the general
concepts are the same; observing during local night using mostly
visible systems to monitor the lunar night-side. Currently, only NE-
LIOTA provides observations detected simultaneously in visible (R-
Band) and near-infrared (I-Band) wavelength range.

LIFs are usually reported together with the time of the impact, the
peak magnitude and the duration of the ﬂash as well as the seleno-
graphic coordinates where it occurred. These publicly available LIF
observations are the input in PyNAPLE, which allows searches for
the resultant impact craters.

3 PYNAPLE ALGORITHM

PyNAPLE was designed with three main focuses; simplicity, full
automation, and conﬁgurability. In order to meet the ﬁrst two com-
ponents, PyNAPLE has been built to run with only a latitude, longi-
tude, and epoch of a LIF, and run until all temporal pairs have been
processed within the search space without the need for further user
input, using the optimised default values. Moreover, the conﬁgura-
bility of PyNAPLE is important, and therefore tolerances, matching
algorithms, and search space size and increment are all able to be
altered from the default through the use of a the conﬁguration ﬁle.
For the purposes of discussion, the default values are used within
this section.

The PyNAPLE algorithm works in two stages, data collection,
and data processing. The data collection stage requires an online
connection, as PyNAPLE utilises online repositories to collate the
image and SPICE data. The data processing step is implemented
using the United States Geological Survey (USGS) Integrated Soft-
ware for Imagers and Spectrometers (ISIS3) to process the images
(Sides et al. 2017). PyNAPLE serves as a Python based wrapper for
these two stages, serving to simplify and automate the entire process.
The general ﬂow of the PyNAPLE algorithm is shown in Fig. 1.

The data collection stage of PyNAPLE utilises two publicly avail-
able online LROC data repositories to generate the image lists, the
Lunar Orbital Data Explorer3 (LODE) (Wang et al. 2009), and Ari-
zona State University’s (ASU) LROC Image Search4. The decision
was made to operate this way for two reasons. Firstly, PyNAPLE is
already resource intensive for both storage and processing - by using
an online service the amount of local data could be kept to a mini-
mum. Secondly, the nature of the two online repositories meant both
were faster for diﬀerent tasks - LODE is faster for looking up the
ephemeris data and parameters of all the images in a given area, and
ASU LROC Image Search is quicker for downloading the required
images. An added beneﬁt of this decision is that it limits the num-
ber of requests to either service, and therefore keeps the server load
caused by PyNAPLEs requests distributed and at a minimum.

By connecting to LODE, PyNAPLE generates two lists of images
of the location, before and after the impact. These image lists are
then checked, and any images with incidence angle, θi > 70◦are dis-
carded, in order to minimise the amount of shadows present in the
image. These two lists are then checked for temporal pairs that can

2 https://neliota.astro.noa.gr
3 ode.rsl.wustl.edu/moon/indexProductSearch.aspx
4 https://wms.lroc.asu.edu/lroc/search

be formed. Temporal pairs are a pair of "before" and "after" images,
which can be aligned and divided in order to attenuate areas where
no change has occurred, as the pixel digital number, DN→0, and ac-
centuate details which have changed between images, as DN→255.
In order to successfully identify physical changes of the lunar sur-
face, distinguishing them from changes in illumination conditions,
images selected for use in temporal pairs are subject to constraints.
The change in incidence angle, ∆θi, should be < 15◦. This is done to
minimise the diﬀerence in illumination of the images; when θiA = θiB
shadows within the image will be the similar and cancel out during
division. As ∆θi increases, shadows in the images will start to diﬀer,
and therefore the number of false detections will increase. Similarly,
the phase angles, ϕ, of the two images must be either both positive
or both negative, such that ϕaϕb > 0, or having ∆ϕ < 20◦, ensuring
the direction and size of any shadows present are similar between
images.

These tolerances are important, as forming temporal pairs out-
side them causes the images to be too observationally diﬀerent for
the "cancellation" eﬀect of the image division to occur. This vi-
sual dissimilarity can be seen in Fig. 2. Although Speyerer et al.
(2016) in their survey implemented the stricter values of θi < 50◦,
and ∆θi < 3◦in their search for surface changes, their work took a
broader approach to change detection and was more focused on ﬁnd-
ing any changes which had occurred within the any temporal pairs
at any location. Conversely, our work focuses on ﬁnding a speciﬁc
crater within a speciﬁc locale, and we thusly deﬁne looser tolerances
in order to increase the number of potential temporal pairs, giving a
higher probability of detection.

Once the temporal pairs are selected in compliance with the con-
straints described have been identiﬁed, the experimental data records
(EDRs) for each image are downloaded from Arizona State Univer-
sity’s LROC Image Search.

The image pairs are then processed through several USGS ISIS3
programs. For each pair, both images are ﬁrst initialised using
SPICE data with spiceinit and spicefit, and then calibrated us-
ing lronaccal and lronacecho. This ensures that both the images
have accurate location and instrument pointing data, and processes
the images to remove the average bias, dark current, and remove the
channel echo eﬀect discovered in LRO NAC images in 2011 (Humm
et al. 2016).

The images are then map projected into the same user-speciﬁed
projection using cam2map, and tonematch is run to normalise the
images. A control network is then generated for the image pair, ﬁrst
using autoregtemplate to deﬁne the matching algorithm and chip
sizes, and then registering the images using coreg. This control net-
work is a list of points on the surface which have been correctly
matched between the two images, and serves as the basis for warp-
ing the image to remove any inconsistencies due to the camera in-
strument being in diﬀering locations between images.

Using warp, the "after" image is warped onto the "before" im-
age, ideally creating an "after" image with the same observational
geometry as the "before" image with sub-pixel accuracy. As this ac-
curacy is not ensured at this stage, the registration and warp process
is then repeated with smaller chip size and more strict matching al-
gorithm tolerance, in order to bring each pixel in the "after" image
into alignment with the "before" image pixel which corresponds to
the same part of the lunar surface. Any pixels which do not have a
corresponding pixel at this stage are removed, in order to keep ﬁle
sizes and processing time to a minimum.

Once sub-pixel accuracy has been ensured, division can occur us-
ing ratio and the "before" image as the denominator, producing an
image which highlights any changes that have occurred between the

MNRAS 000, 1–9 (2021)

4

D. Sheward et al.

Figure 1. The PyNAPLE algorithm works in two distinct sections, data collection and image processing, and utilises the publicly-available online LROC image
repositories; the Lunar Orbital Data Explorer, and ASUs LROC Image Search, and the image processing capabilities of USGSs ISIS3. Rectangular boxes are
data, diamond boxes are processes, and cylindrical boxes are online resources.

images. This process is then repeated for each temporal pair in the
list. Upon completing the ﬁnal pair, the search space in which im-
age pairs are evaluated is increased by 0.25◦in both the latitude and
longitude direction. If the search space is not yet at the user-deﬁned
maximum, the process will repeat using the larger search space.

3.1 Dependencies and Requirements

PyNAPLE has several dependencies on third-party software. Due to
the image processing taking place in ISIS3, the base ISIS3 software
is required with LRO module and SPICE kernels, which in total oc-
cupies approximately 260 Gb. Several Python packages are also re-
quired, most of which are ubiquitous, however any missing packages
get installed upon ﬁrst running PyNAPLE.

MNRAS 000, 1–9 (2021)

PyNAPLE: Lunar Surface Impact Crater Detection

5

(A) M146255155RE,

2. Two LROC images,

Figure
(B)
M187520776LE, taken at incidence angles θi=68.0◦, and θi=8.3◦, respec-
tively. While both images are of the same location, the diﬀering illumination
causes the images to be visually dissimilar, preventing the formation of a
temporal pair. Images cropped from NAC images, NASA/GSFC/Arizona
State University.

and

The size of the NAC images also factors into the storage require-
ments, each image once having SPICE data attached occupies be-
tween 1-2 Gb of space. Due to the large size of the images, and the
operations being performed on them, PyNAPLE also requires a fair
amount of computing resources. As each image is processed on a
single core, the processor speed of the machine greatly aﬀects the
speed at which temporal pairs can be processed.

Due to the resource intensive and pipeline critical step of regis-
tering the image pairs with sub-pixel accuracy 8 Gb of RAM is a
necessity to handle image registration. While this could be reduced
by using a control network containing less control points, this would
lower the quality of the image alignment, and is not a favourable
trade oﬀ.

4 TESTING

Before applying PyNAPLE to locate newly formed craters, we ﬁrst
tested the algorithm using an impact crater discovered by the LRO
team, following the LIF report by the MEO on 2013-03-17 (Suggs
et al. 2014).

The ﬁrst test performed was to input the coordinates and epoch
of the 2013-03-17 impact ﬂash, to conﬁrm that the crater could be
located under best-case-scenario parameters. In this test, the crater
was located in the ﬁrst temporal pair processed, showing that the
algorithm was eﬀective. The second test was again performed using
the 2013-03-17 impact, however the coordinates were changed so
that the crater was 1◦outside the initial search area in both latitude
and longitude. This tested the PyNAPLE algorithms eﬀectiveness
when the crater is further away from the supplied coordinates, as is
typically expected when using coordinates estimates from an impact
ﬂash. The third test performed was to provide the exact coordinates
of the impact crater to PyNAPLE, however changing the epoch to

Figure 3. Top: The full frame of the 2017-09-27 impact ﬂash at its peak.
Bottom: The cropped sequence of the impact ﬂash from Camera 1.

be later than the crater formation time frame. As there were now
images from before the event which contained the crater, the newly
formed crater would only appear in some of the temporal pairs, and
therefore not be possible to be the linked crater.

Once PyNAPLE suﬃciently passed these tests, the algorithm used
publicly available LIF data for which the produced craters have not
yet been identiﬁed.

5 RESULTS

5.1 2017-09-27 Impact Flash

At 18:56:12 UT on 2017-09-27, a meteoroid impacted the lunar sur-
face releasing a ﬂash of light observed by La Sezione di Ricerca
Luna dell’Unione Astroﬁli Italiani (SdR UAI), from Melazzo, AL,
Italy. The ﬂash was observed by two separate telescope-camera
systems, and is shown in Fig. 3. The ﬁrst system consisted of a
20 cm Newtonian telescope (f/5 reduced to f/2.9) equipped with an
ASI120MM CMOS camera with resolution 640×480 pixels, while
the second system consisted of a 10 cm Newtonian telescope (f/4)
with an ASI120MM running at resolution 512×384 pixels. Both
cameras operated with fast acquisition at 25 and 30 fps respec-
tively, and 2×2 binning. No photometric ﬁlters were attached to the
telescope-camera system, and therefore provided a sensitivity win-
dow dictated by the spectral response of the cameras, from approxi-
mately 400 nm to 700 nm.

The ﬂash was resolvable above the background noise in 30 frames
in the ﬁrst system, and 24 frames in the second system, giving a
minimum duration of approximately 1 s. After applying a Gaussian
ﬁt correction to the saturated ﬂash, photometry can be applied to the
reconstructed point spread function to obtain the apparent magnitude
of the ﬂash.

While there were no observations of an ideal reference star,
Gaia DR2 4094972869712553088, was observable within the ﬂash
frames. As this is a variable star with only a small number of scien-
tiﬁc observations the exact magnitude of the star at the time of ob-
servation is unknown, and therefore the mean value of magnitude 7,

MNRAS 000, 1–9 (2021)

6

D. Sheward et al.

Figure 4. The calculated apparent magnitudes from the ﬁrst 17 frames of the
2017-09-27 impact ﬂash.

as observed by Gaia Data Release 2 (Gaia Collaboration et al. 2018),
was used for photometry.

The evolution of the ﬁrst 17 frames of the ﬂash from each camera
are shown in Fig. 4. Only 17 frames are shown as after this point
the signal from the ﬂash is dominated by the noise level, and the
calculated values for magnitude are unreliable. Photometry on the
Gaussian corrected ﬂash gives the apparent magnitude of the peak as
approximately +4.0. Multiple aperture photometry was performed
on the Gaussian corrected ﬂash in AstroImageJ, using the star Gaia
DR2 4094972869712553088 as the ﬂux reference.

The coordinates of the lunar impact ﬂash were obtained by per-
forming geolocation through visual comparisons between the impact
frames and LRO WAC images, using USGS lunar maps for refer-
ence.

5.2 Crater Detection

In total, PyNAPLE searched an area of 2o× 2◦centred on the esti-
mated selenographic coordinates of latitude, φ=8.0, longitude, λ=-
76.5. 169 images were evaluated for suitability, 100 "before" and 69
"after" images, from which 82 temporal pairs were formed covering
48% of the search space.

After examining the resultant ratio images, a candidate crater was
discovered at latitude, φ=8.0288, longitude, λ=-76.546 in three im-
ages, M1315871095R, M1344064055L, and M1359341218L; Fig. 5
shows the crater imaged in the temporal pair of M1180620010R and
M1315871095R.

While there is an interval of 1156 days between the latest "before"
image and the earliest "after" image, due to the fact the crater is ob-
served in all images taken later than 2017-09-27, and is not present
in any images from before 2017-09-27, it is a reasonable assumption
that the crater was resultant from the observed 2017-09-27 LIF.

Further evidence supporting this hypothesis is that an impact ﬂash
of this duration occurs much less frequently than typical 1-2 frame
(a few 10s of milliseconds) LIFs more commonly observed (Suggs
et al. 2014; Avdellidou et al. 2021). As the impact crater has a much
greater extent than typically observed newly formed impact craters,
the coincidence of these being independent events has a low proba-
bility.

MNRAS 000, 1–9 (2021)

6 DISCUSSION

Due to the nature of the LRO’s orbit, the time between subsequent
images of a point on the lunar surface can be multiple years. This
means that while the LROC collects a high volume of image data,
the available images for a given point can be scarce. This scarcity
can be exacerbated further when forming "before" and "after" image
lists when the event is only a few years old. Consequently, in the
case of our identiﬁed crater, the number of "after" images of the
formed crater is limited, and in each of the available "after" images
the crater rim is unresolvable above the high albedo of the freshly
excavated regolith. This limits the analyses that can be performed
for the reﬁnement of crater scaling laws using this impact event,
until more images are obtained of the impact site where the crater
morphology and rim diameter can be observed.

As an upper limit for crater size can be obtained, however, and
morphology can be inferred from the ejecta pattern. The main con-
tiguous ejecta blanket is elliptical with a major axis diameter of
90 m, and a minor axis diameter of 65 m. From these measurements,
and the relationship for continuous ejecta size from crater diameter
by Moore et al. (1974), shown in Eq. 1, we can estimate the rim-to-
rim diameter of the crater to be between 27.3-37.7 m.

Rce = 2.348R1.006

(1)

where Rce is the radius of the continuous ejecta blanket, and R is the
radius of the crater.

The asymmetrical nature of the ejecta blanket indicates that the
impact was oblique; the butterﬂy ejecta pattern with an up-range
exclusion zone indicates that the angle of impact θi < 30o, and the
lack of a down-range exclusion zone indicates θi > 10o (Melosh
1989).

In order to achieve the desired link between impactor and crater,
the physical properties of the former upon the impact should be es-
timated. In recent years there have been methods developed to es-
timate the impact speed, V, as well as the mass of the impactor, m
(Suggs et al. 2014; Madiedo et al. 2015a; Avdellidou et al. 2021).
The luminous energy, Elum, radiated by the ﬂash and recorded at
each frame during the observations is calculated as:

(2)

2.5 π f ∆λD2t

Elum = 3.75 × 10−8 × 10− mag
where mag is the apparent magnitude at each frame, f is a unit-
less parameter denoting the isotropy of the ﬂash, taken here as f =2,
denoting the light originated from the lunar surface, ∆λ is the wave-
length range, ∆λ = 300 nm, and D is the Earth-Moon distance. In-
tegrating the Elum for all the time that the ﬂash was observed we
estimated that the total Elum released was 1.3×107 J. As mentioned
before, the released Elum is a small fraction η (luminous eﬃciency)
of the total KE of the impactor and is given by:
KE = Elum
η

(3)

Using two frequently-used estimations for the luminous eﬃciency
η1=5×10−4 and η2=1.5×10−3 (Bouley et al. 2012), we calculated
the KE of the impacting meteoroid to be KE1=2.6×1010 J, and
KE2=8.7×109 J respectively.

Knowing the KE, the next step is to estimate the impact speed V.
By computing the angle between known active meteoroid streams at
the time of impact and the location of the impact, an estimate can
be made as to the parent stream responsible for the impactor. While
it cannot solve for certain the parent stream of the meteoroid, some
exclusions can be made to eliminate candidate streams. Meteoroid

PyNAPLE: Lunar Surface Impact Crater Detection

7

Figure 5. (A) The "before" image, M1180620010R, taken on 2015-03-10. (B) The "after" image, M1315871095R, taken on 2019-06-22, (C) The ratio of the
two images. All three images are at the same scale of 1.12 m pix−1, the scale bar is 500 m, and each segment 100 m. Cropped from PyNAPLE processed NAC
images from NASA/GSFC/Arizona State University.

streams not active at the time of impact can be immediately elimi-
nated as candidates. Meteoroid streams which have a radiant more
than 90◦oﬀset from the normal of the impact can be eliminated, as
the gravitational eﬀect of the Moon on the trajectory is negligible,
and therefore only streams with a radiant visible to the impact site
are valid. If after exclusions there are no remaining candidate par-
ent streams, the impactor belongs to the sporadic meteoroid back-
ground.

The active streams during the 2017-09-27 impact are shown in
Tab. 1. Due to the radiant being >90◦from the impact site, the Day-
time Sextantids can be immediately excluded. Both the Southern
Taurids, and Southern Delta Piscids have the radiant visible to the
impact site, and can both be considered candidate streams. Usually,
in order to distinguish between two candidate streams, the stream
with the smaller angular separation between the lunar solar longi-
tude, and the solar longitude of the meteoroid streams peak. This
parameter can be somewhat ignored if one of the streams has a
much higher Zenithal Hourly Rate (ZHR) and the separation be-
tween stream peaks is not large.

There is some debate over whether the Southern Taurids and
Southern Delta Piscids are distinct streams, with indication they
could in-fact originate from the same source (Triglav Cekada & Arlt
2005). Consequently impactors from these two streams would com-
prise of similar materials with similar densities. Due to the streams
having ∆VG=2.0 km s−1, and the radiant of the two streams having an
angular separation of only 11◦, distinguishing between these streams
would have a negligible eﬀect on any subsequent calculations. Thus
we used the average speed of the streams VG=27.6 km s−1 for the
mass estimation.

However, because the parent stream was not determined for cer-
tain and we cannot exclude the possibility the impactor to originate
from the background population of the meteoroids, we estimate its
mass also in this case. Several average values for the speed of the
background population have been adopted so far from the diﬀer-
ent LIF studies, ranging from 16 to 24 km s−1 (Steel 1996; Ivanov
2006; McNamara et al. 2004; Le Feuvre & Wieczorek 2011). Here
we adopt an intermediate one of V=20.0 km s−1.

Using Eq. 3 we estimated the mass of the impactor to be between
22.8 and 130 kg, following both scenarios where the impactor origi-

Table 1. The active streams at the time of the 2017-09-27 impact. VG is the
group velocity of the stream. Values for solar longitude, λ(cid:12), and VG are taken
from Jenniskens et al. (2016).

Stream

Code

λ(cid:12)

ZHR

VG (km s−1)

Daytime Sextantids
Southern Taurids
Southern Delta Piscids

DSX
STA
SPI

188◦
216◦
176◦

20
5
3

32.9
26.6
28.6

nates from a stream or from the background population, repeated for
the two diﬀerent η values.

The next step was to use the impactors parameters and utilising an
impact scaling law to predict the diameter of the crater. The crater
scaling law by Melosh, described in Eqs. 4 and 5, was selected as
it is the most recent and is frequently-used in recent lunar impact
analysis (Schmidt & Housen 1987; Melosh 1989).

Dc = γ−0.26m0.26V 0.44

γ = 0.31g0.84ρ−0.26

p

ρ1.26
t

(cid:33)1.67

(cid:32)

sin45
sinθ

(4)

(5)

where Dc is the crater diameter, m is the impactor mass, V is the im-
pactor velocity, g is the gravitational acceleration, ρp is the impactor
density, ρt is the target density, θ is the impact angle with respect to
the vertical. The units are in the MKS system.

Following the same logic, Dc calculations were performed for
both cases of impactors origin; the sporadic background population,
and for the STA/SPI meteoroid streams. As previously discussed, the
STA and SPI meteoroid streams are similar in velocity, direction and
projectile density. For this reason, a nominal value of V=27.6 km s−1
was used. The projectile density was taken as ρp=2,500 kg m−3, the
bulk density of the STA meteoroids (Matloviˇc et al. 2017). For calcu-
lations assuming a sporadic background meteoroid, V=20.0 km s−1
and ρp=1,800 kg m−3 were used. For both calculations target the
bulk density of lunar soil was used, ρt=1,500 kg m−3, and the value
of lunar gravity g=1.625 m s−2 was used. A minimum and maxi-
mum impacting angle were taken as θi=10◦and θi=30◦respectively,

MNRAS 000, 1–9 (2021)

8

D. Sheward et al.

Table 2. The diameter of the resultant impact crater, calculated using the
crater scaling law described in Eq. 4 & 5 for each luminous eﬃciency η1 =
5 × 10−4 and η2 = 1.5 × 10−3 using the maximum and minimum impacting
angles for the observed crater morphology.

Origin

SPI/STA

Sporadic

θi

10◦
30◦
10◦
30◦

Dη1

Dη2

55.3 m 41.6 m
52.3 m 39.4 m
32.0 m 24.1 m
50.7 m 38.1 m

as denoted by the range of angles possible for the morphology of the
observed crater.

Assuming an STA/SPI and sporadic origin of the meteoroid, cal-
culations estimated a Dc between 39.4-55.3 m and 24.1-50.7 m re-
spectively, Tab. 2 contains a more in depth breakdown of this range.
Both of these ranges are in agreement with the crater diameter es-
timated from the continuous ejecta blanket (27.3-37.7 m), showing
that the small diﬀerence in the impact speed did not aﬀect the result.
However, further assessment to distinguish the most likely candidate
would require unsaturated images of the crater.

As PyNAPLE has now located its ﬁrst linked crater from an ob-
served impact ﬂash, a larger scale implementation of the PyNAPLE
algorithm can commence. By utilising the publicly-available lunar
impact ﬂash data collected since 2009 (LROs mission start), a wide
scale mission to locate and identify the linked craters can be per-
formed. This is done with the intention of forming a dataset of
craters for which the impact energy and resultant size are precisely
known, therefore enabling a statistical analysis of the craters formed.
Furthermore, discovering and measuring craters for which we also
have the physical properties of their impactor will allow the more
precise estimation of the luminous eﬃciency, which currently may
vary by an order of magnitude. A fresh crater could also act as a
good surface exploration site to study how space weathering aﬀects
fresh craters in the short term.

7 CONCLUSIONS

We presented a fully automated pipeline for the collation, forma-
tion, and processing of LRO NAC temporal pairs. PyNAPLE is the
ﬁrst algorithm designed to detect fresh craters using the coordinates
and epoch of lunar impact ﬂashes. PyNAPLE is fully conﬁgurable,
oﬀering the ability to ﬁne tune the matching algorithms, map pro-
jections, and tolerances of the data selection and pattern matching
stages to optimize PyNAPLE for individual needs. We discussed the
trio of tests performed on PyNAPLE, and the successful location of
a newly formed crater with high probability of being formed from
the ﬂash.

Preliminary analyses were performed on the 2017-09-27 linked
impact crater, allowing us to conclude that the impact occurred at
an angle of between 10-30◦, forming a crater predicted by scaling
laws to be between 24.1-55.3 m in size, and the ejecta blanket to
crater rim relationship predicting a diameter between 27.3-37.7 m.
This ﬁnding demonstrated that PyNAPLE is a functioning tool for
the detection of new craters from new lunar impact ﬂash data.

MNRAS 000, 1–9 (2021)

ACKNOWLEDGEMENTS

This work was supported by the Programme National de Planetolo-
gie (PNP) of CNRS/INSU, co-funded by CNES and by the program
"Flash!" supported by Credits Scientiﬁques Incitatifs (CSI) of the
Universite Nice Sophia Antipolis. CA was supported by the French
National Research Agency under the project "Investissements d’
Avenir" UCAJEDI with the reference number ANR-15-IDEX-01.
DJS, CA and MD acknowledge support from the ANR "ORIGINS"
(ANR-18-CE31-0014).

This work presents results from the European Space Agency
(ESA) space mission Gaia. Gaia data are being processed by the
Gaia Data Processing and Analysis Consortium (DPAC). Funding
for the DPAC is provided by national institutions, in particular the in-
stitutions participating in the Gaia MultiLateral Agreement (MLA).
The Gaia mission website is https://www.cosmos.esa.int/gaia. The
Gaia archive website is https://archives.esac.esa.int/gaia.
ISIS3 software courtesy of the U.S. Geological Survey.

DATA AVAILABILITY

With PyNAPLE’s completion it will now be made publicly available
on Github5 for both professionals and amateurs to use.

REFERENCES

Ait Moulay Larbi M., Daassou A., Baratoux D., Bouley S., Benkhaldoun Z.,
Lazrek M., Garcia R., Colas F., 2015, Earth Moon and Planets, 115, 1

Arakawa M., et al., 2020, Science, 368, 67
Avdellidou C., Vaubaillon J., 2019, MNRAS, 484, 5212
Avdellidou C., Price M. C., Delbo M., Ioannidis P., Cole M. J., 2016, MN-

RAS, 456, 2957

Avdellidou C., Price M. C., Delbo M., Cole M. J., 2017, MNRAS, 464, 734
Avdellidou C., Delbo’ M., Fienga A., 2018, MNRAS, 475, 3419
Avdellidou C., et al., 2020, Icarus, 341, 113648
Avdellidou C., et al., 2021, Planet. Space Sci., 200, 105201
Bagnall P. M., 1988, Journal of the British Astronomical Association, 98,

184

Bonanos A. Z., et al., 2018, A&A, 612
Bouley S., et al., 2012, Icarus, 218, 115
Burchell M. J., Cole M. J., McDonnell J. A. M., Zarnecki J. C., 1999, Mea-

surement Science and Technology, 10, 41
Cintala M. J., 1992, J. Geophys. Res., 97, 947
Colaprete A., et al., 2010, Science, 330, 463
Daly R. T., Schultz P. H., 2015, in Lunar and Planetary Science Conference.

p. 1972

Daly R. T., Schultz P. H., 2016, Icarus, 264, 9
DellaGiustina D. N., et al., 2021, Nature Astronomy, 5, 31
Gaia Collaboration et al., 2018, A&A, 616, A1
Goswami J. N., Annadurai M., 2009, in 40th Annual Lunar and Planetary

Science Conference. Lunar and Planetary Science Conference. p. 2571

Hartmann W. K., 2005, Icarus, 174, 294
Hayne P. O., Greenhagen B. T., Foote M. C., Siegler M. A., Vasavada A. R.,

Paige D. A., 2010, Science, 330, 477

Heldmann J., et al., 2008, in AAS/Division for Planetary Sciences Meeting

Abstracts #40. p. 13.03

Horedt G. P., Neukum G., 1984, Earth Moon and Planets, 31, 265
Housen K. R., Holsapple K. A., 2003, Icarus, 163, 102
Housen K. R., Holsapple K. A., 2011, Icarus, 211, 856
Housen K. R., Holsapple K. A., 2012, Icarus, 219, 297
Housen K. R., Holsapple K. A., Voss M. E., 1999, Nature, 402, 155

5 github.com/dsheward-astro/PyNAPLE

PyNAPLE: Lunar Surface Impact Crater Detection

9

Housen K. R., Sweet W. J., Holsapple K. A., 2018, Icarus, 300, 72
Humm D. C., et al., 2016, Space Sci. Rev., 200, 431
Ivanov B. A., 2006, Icarus, 183, 504
Jenniskens P., et al., 2016, Icarus, 266, 355
Johnson L., Buratti B. J., 2001, in AAS/Division for Planetary Sciences

Meeting Abstracts #33. p. 10.04

Le Feuvre M., Wieczorek M. A., 2011, Icarus, 214, 1
Madiedo J. M., Ortiz J. L., Morales N., Cabrera-Caño J., 2014, MNRAS,

439, 2364

Madiedo J. M., Ortiz J. L., Morales N., Cabrera-Caño J., 2015a, Planet.

Space Sci., 111, 105

Madiedo J. M., Ortiz J. L., Organero F., Ana-Hernández L., Fonseca F.,

Morales N., Cabrera-Caño J., 2015b, A&A, 577, A118

Madiedo J. M., Ortiz J. L., Morales N., 2018, MNRAS, 480, 5010
Matloviˇc P., Tóth J., Rudawska R., Kornoš L., 2017, Planetary and Space

Science, 143, 104–115

McNamara H., Jones J., Kauﬀman B., Suggs R., Cooke W., Smith S., 2004,

Earth Moon and Planets, 95, 123

Melosh H. J., 1989, Impact cratering : a geologic process
Moore H. J., Hodges C. A., Scott D. H., 1974, Lunar and Planetary Science

Conference Proceedings, 1, 71

Moser D., Suggs R., Suggs R. J., 2014, in Muinonen K., Penttilä A., Granvik
M., Virkki A., Fedorets G., Wilkman O., Kohout T., eds, Asteroids,
Comets, Meteors 2014. p. 365

Nemtchinov I. V., Shuvalov V. V., Artemieva N. A., Ivanov B. A., Kosarev
I. B., Trubetskaya I. A., 1998, in Lunar and Planetary Science Confer-
ence.

Neukum G., Ivanov B. A., Hartmann W. K., 2001, Space Sci. Rev., 96, 55
Ortiz J. L., Aceituno F. J., Aceituno J., 1999, A&A, 343, L57
Ortiz J. L., Sada P. V., Bellot Rubio L. R., Aceituno F. J., Aceituno J., Gutiér-

rez P. J., Thiele U., 2000, Nature, 405, 921

Ortiz J. L., Quesada J. A., Aceituno J., Aceituno F. J., Bellot Rubio L. R.,

2002, ApJ, 576, 567

Ortiz J. L., et al., 2006, Icarus, 184, 319
Ortiz J. L., Madiedo J. M., Morales N., Santos-Sanz P., Aceituno F. J., 2015,

MNRAS, 454, 344

Popova O. P., et al., 2013, Science, 342, 1069
Robinson M., 2014, Another New Crater!, http://lroc.sese.asu.edu/

posts/810

Robinson M. S., et al., 2010, Space Sci. Rev., 150, 81
Robinson M. S., et al., 2015, Icarus, 252, 229
Schmidt R. M., Housen K. R., 1987, International Journal of Impact Engi-

neering, 5, 543

Schultz P. H., Hermalyn B., Colaprete A., Ennico K., Shirley M., Marshall

W. S., 2010, Science, 330, 468

Sides S. C., et al., 2017, in 48th Annual Lunar and Planetary Science Con-

ference. Lunar and Planetary Science Conference. p. 2739

Speyerer E. J., Povilaitis R. Z., Robinson M. S., Thomas P. C., Wagner R. V.,

2016, Nature, 538, 215

Steel D., 1996, Space Sci. Rev., 78, 507
Suggs R. M., Cooke W. J., Suggs R. J., Swift W. R., Hollon N., 2008, Earth

Moon and Planets, 102, 293

Suggs R. M., Moser D. E., Cooke W. J., Suggs R. J., 2014, Icarus, 238, 23
Tatsumi E., et al., 2021, Nature Astronomy, 5, 39
Triglav Cekada M., Arlt R., 2005, WGN, Journal of the International Meteor

Organization, 33, 41

Wang J., et al., 2009, in 40th Annual Lunar and Planetary Science Confer-

ence. Lunar and Planetary Science Conference. p. 1193

Xilouris E. M., et al., 2018, A&A, 619, A141

This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.

MNRAS 000, 1–9 (2021)

