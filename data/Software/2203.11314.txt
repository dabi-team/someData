2
2
0
2

r
a

M
1
2

]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[

1
v
4
1
3
1
1
.
3
0
2
2
:
v
i
X
r
a

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

1

Benchmarking the performance of a low-cost
Magnetic Resonance Control System at multiple
sites in the open MaRCoS community
Teresa Guallart-Naval‚Ä†, ‚Ä°, Thomas O‚ÄôReilly¬ß, Jos√© M. Algar√≠n‚Ä†, Ruben Pellicer-Guridi ¬∂, Yolanda Vives-Gilabert (cid:107),
Lincoln Craven-Brightman‚àó‚àó, Vlad Negnevitsky‚Ä†‚Ä†, Benjamin Menk√ºc‚Ä°‚Ä°, Fernando Galve‚Ä†, Jason P. Stockmann‚àó‚àó,
Andrew Webb¬ß, and Joseba Alonso‚Ä†
‚Ä†MRILab, Institute for Molecular Imaging and Instrumentation (i3M), Spanish National Research Council (CSIC)
and Universitat Polit√®cnica de Val√®ncia (UPV), Valencia, Spain
‚Ä°Tesoro Imaging S.L., Valencia, Spain
¬ßDepartment of Radiology, Leiden University Medical Center, Leiden, Netherlands
¬∂Asociaci√≥n de investigaci√≥n MPC, Donostia-San Sebasti√°n, Spain
(cid:107)Intelligent Data Analysis Laboratory, Department of Electronic Engineering, Universitat de Val√®ncia, Valencia,
Spain
‚àó‚àóMassachusetts General Hospital, A. A. Martinos Center for Biomedical Imaging, Charlestown, MA, United
States
‚Ä†‚Ä†Oxford Ionics Ltd, Oxford, United Kingdom
‚Ä°‚Ä°University of Applied Sciences and Arts Dortmund, Dortmund, Germany

Abstract‚Äî

Purpose: To describe the current properties and capabilities of an
open-source hardware and software package that is being developed
by many sites internationally with the aim of providing an inexpensive
yet Ô¨Çexible platform for low-cost MRI.
Methods: This paper describes three diÔ¨Äerent setups from 50 to
360 mT in diÔ¨Äerent settings, all of which used the MaRCoS console
for acquiring data, and diÔ¨Äerent types of software interfaces (custom-
built GUI or PulSeq overlay) to acquire the data.
Results: Images are presented from both phantoms and in vivo from
healthy volunteers to demonstrate the image quality that can be
obtained from the MaRCoS hardware/software interfaced to diÔ¨Äerent
low-Ô¨Åeld magnets.
Conclusions: The results presented here show that a number of
diÔ¨Äerent sequences commonly used in the clinic can be programmed
into an open-source system relatively quickly and easily, and can
produce good quality images even at this early stage of development.
Both the hardware and software will continue to develop, and it is an
aim of this paper to encourage other groups to join this international
consortium.

I. Introduction

M ARCOS (Magnetic Resonance Control System) is a

low-cost, high-performance console developed to fulÔ¨Åll
the requirements of a rapidly expanding low-Ô¨Åeld Magnetic
Resonance Imaging (LF-MRI) community [1]‚Äì[3]. LF-MRI is
developing as a customizable and aÔ¨Äordable complement to
standard high-Ô¨Åeld MRI (> 1 T), which is an expensive medi-
cal imaging modality in terms of purchase cost, maintenance,
siting and training, and consequently is concentrated in large
hospitals in the economically developed world [4]‚Äì[8]. In the
last few years, LF-MRI has demonstrated its value for point-of-
care imaging [9]‚Äì[15], home healthcare [16], quantitative MRI

Corresponding author: J. Alonso (joseba.alonso@i3m.upv.es).

and Ô¨Ångerprinting [17], [18], hard-tissue imaging [19]‚Äì[21],
artifact-free imaging of metallic implants [16], [22], as well as
educational purposes [23], among others. These achievements
are enabled by a new generation of scanners combining reÔ¨Åned
hardware engineering with powerful computational algorithms,
including machine learning architectures. Improvements are
being integrated in all engineering and imaging stages: during
the scanner design process [24]‚Äì[26], for pulse sequence
design [18], during signal acquisition [15], for image recon-
struction [19], [27], and for data analysis and image post-
processing [28].

The LF-MRI community is integrated by numerous and
diverse research groups and spin-oÔ¨Ä companies, each target-
the developed LF-
ing speciÔ¨Åc applications. Consequently,
MRI scanners are often special-purpose and custom-made.
DiÔ¨Äerent groups have historically pursued diÔ¨Äerent solutions
as regards the console (or electronic control system) which
compiles the pulse sequences, executes them, digitizes the
detected signals and frequently also processes and displays
the reconstructed MR images. Some employ commercially
available systems such as from Pure Devices GmbH (Rimpar,
Germany), Magritek Ltd (Wellington, New Zealand) or Niu-
mag Corporation (Suzhou, China). Despite being much less
expensive than clinical consoles, these nevertheless constitute
a substantial fraction of the total cost of an LF-MRI system,
and are often run with proprietary and non-interchangeable
software/hardware. These drawbacks limit prototype produc-
tion by a wider community and hinder new developments.
To overcome these limitations, several home-spun designs
have emerged during the last decade, mainly based on Field
Programmable Gate Arrays (FPGA) [29]‚Äì[36]. The MaRCoS
initiative is an attempt to centralize these eÔ¨Äorts to become

 
 
 
 
 
 
JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

2

Fig. 1. MaRCoS system architecture, showing the main components in the
software and hardware stacks. Figure taken from Ref. [1].

a versatile, low-cost and open-source solution fostering the
development of present and future LF-MRI technologies. The
MaRCoS community is therefore open and has the ambition
of expanding the range of tools this platform provides as
new needs arise. We now have a Ô¨Årst functional version of
MaRCoS and a Python-based Graphical User Interface (GUI),
both publicly available in open repositories [37], [38].

In this paper, we benchmark the performance of MaRCoS
in three diÔ¨Äerent LF-MRI systems: a 360 mT educational
tabletop scanner at Massachusetts General Hospital (MGH)
in Boston, USA; a 50 mT low-cost human Halbach system
for brain and extremity imaging at Leiden University Medical
Center (LUMC) in Leiden, the Netherlands; and a similar
Halbach system (70 mT) at the Institute for Molecular Imaging
and Instrumentation (i3M) in Valencia, Spain. After a brief
introduction to the MaRCoS architecture and the individual
systems in Sec. II, we demonstrate MaRCoS‚Äô versatility in
terms of imaging capabilities with a variety of pulse sequences
(Sec. III-A). To this end, we have programmed and run spin
echo (SE), rapid imaging with refocused echoes (RARE),
gradient echo (GRE), short tau inversion recovery (STIR),
and non-Cartesian pulse sequences to image phantoms with
diÔ¨Äerent contrasts, resolutions and reconstruction techniques
across all three sites. In addition, we present in Sec. III-B the
Ô¨Årst in vivo images taken with MaRCoS on the i3M system.
These images demonstrate the value of MaRCoS for potential
screening applications, which we discuss in Sec. IV.

II. Methods

A. MaRCoS

All images in this work have been acquired with MaRCoS.
Among the various control systems developed by the LF-
MRI community, we chose to create MaRCoS based on
OCRA (Open-source Console for Real-time Acquisition, [32],
[33]) because it included: i) mature and aÔ¨Äordable hardware
available oÔ¨Ä-the-shelf with ample expansion possibilities, and
ii) validated open-source Ô¨Årmware and software designs.

The MaRCoS system architecture is based on a Red Pitaya
SDRlab (Fig. 1), following the OCRA design. The Red Pitaya
includes an ARM processor, a Xylinx Zynq FPGA, two fast
to fast analog outputs, and several digital
analog inputs,
input and output ports. The FPGA Ô¨Årmware (Ô¨Çocra) digitally

Fig. 2. Fully open-source tabletop MRI scanner for education and research
at MGH. a) Complete setup including 0.36 T dipole magnet, FHDO gradient
power ampliÔ¨Åer board, Red Pitaya-based console, and home-built RF hard-
ware. b) Inner view with phantom inside the scanner.

controls the peripherals, such as radio-frequency (RF) trans-
mit/receive chains and gradient coils used in MRI. The ARM
processor runs the MaRCoS server, which is the intermediate
communication layer between the control computer and the
FPGA. The control computer is equipped with a Python-based
GUI where pulse sequences can be programmed and executed.
This GUI translates the sequences and provides all parameters
to the MaRCoS client (also written in Python), which in
turn communicates with the client in the Red Pitaya. Once a
sequence repetition is executed, the MR signal is recorded and
the data is pre-processed by Ô¨Çocra and sent to the client. When
the sequence is complete, the data can be processed by user-
deÔ¨Åned algorithms (e.g. image reconstruction, segmentation,
Ô¨Åltering, ùëò-space correction, etc.) and displayed on the GUI.
Optionally, sequences can be also programmed outside the
GUI environment. At
there are two further
the moment,
possibilities: to write them as text or Numpy arrays, or in the
PulSeq open-source framework [39]. The latter is a vendor-
agnostic environment that enables sequence programming for a
growing range of commercial MRI systems. For more detailed
information on MaRCoS we refer to [1].

B. LF-MRI systems

1) MGH: The MaRCoS console was paired with a 0.36 T
tabletop MRI scanner made using open-source hardware com-
ponents. The tabletop scanner has a 1 cm Ô¨Åeld of view
(FOV) and was originally developed as an educational tool for
university courses at Massachusetts Institute of Technology.
Co-planar shielded gradient coils driven by a low-cost, low-
voltage gradient power ampliÔ¨Åer (GPA-FHDO) [40] are nested
between two 6" diameter permanent magnets set up in a dipole
conÔ¨Åguration. The RF system consists of a small solenoid
coil connected to a low-cost TR-switch, preampliÔ¨Åer, and 1 W
RFPA. The hardware suite was summarized in Cooley et
al. [23]. The setup was previously paired with a MEDUSA
console [29] and later adapted for use with OCRA. With Red
Pitaya-based consoles, the total system cost is below 10 kUSD.
Pulse sequences are written in the PulSeq Matlab environment

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

3

with an extra layer of magnets to reach ùêµ0 ‚âà 72 mT. The
Ô¨Åeld homogeneity is shimmed from 15,700 down to 3,100 ppm
(parts per million) over a DSV of 20 cm in diameter. This is
achieved with ‚âà 1, 100 smaller permanent magnets placed in
rings inside and concentric to the main magnet, following an
optimized result obtained with a non-linear integer minimiza-
tion method. The diameter and length of the whole system are
around 53 and 51 cm respectively, and it weighs approximately
200 kg. The gradient coils are wound on and glued to twelve
3D-printed Nylon molds, and the whole assembly is supported
by a methacrylate cylinder. Gradient waveforms are generated
with either an OCRA1 board [42] or the open-source GPA-
FHDO board [40] connected to the Red Pitaya via Serial
Peripheral Interface (SPI), and ampliÔ¨Åed by AE Techron 7224
power ampliÔ¨Åers (Indiana, USA). The single transmit/receive
(Tx/Rx) RF antenna is a solenoid coil tuned and impedance-
matched to the proton Larmor frequency (3.076 MHz). The
RF coil holder was printed in polylactic acid (PLA), and the
wire was Ô¨Åxed with cyanoacrylate adhesive. The coil is inside
a grounded faraday cage for noise immunity and to prevent
interference between the gradients and the RF system, and
again a conductive cloth is used for in vivo imaging. The RF
low-noise and power ampliÔ¨Åers, as well as the Tx/Rx switch,
were purchased from Barthel HF-Technik GmbH (Aachen,
Germany).

C. Pulse sequences and image reconstruction

To give an idea of the potential applications of MaRCoS we
have demonstrated its functionality in the aforementioned MRI
scanners. To this end, we show numerous images in Sec. III
which benchmark the performance of MaRCoS in terms of
programming Ô¨Çexibility and its capability to execute multiple
pulse sequences and to reconstruct and process the acquired
data. All sequence parameters are compiled in Table I for
readability.

In terms of pulse sequences, in Sec. III we show images
of phantoms taken with SE, RARE, STIR, GRE and radial
(non-Cartesian) acquisitions. Figure 5 shows an example of
sequence programming (3D-RARE) with the MaRCoS GUI
and a graphical representation of the programmed sequence
in the integrated viewer. Furthermore, we have demonstrated
low-Ô¨Åeld images with diÔ¨Äerent contrast mechanisms (ùúå, ùëá1 and
ùëá2) and tested two image reconstruction modules programmed
in Python and integrated into the GUI: a standard Fourier
Transform (FT) based method; and Non-Uniform Fast Fourier
Transform (NUFFT), which can be used for non-Cartesian
reconstruction [43].

III. Results & Discussion

A. Phantom images

In the following sections we present phantom images ac-
quired in the diÔ¨Äerent setups:
the i3M images have been
taken with a variety of pulse sequences, the LUMC images
show multi-Rx capabilities as required for parallel imaging,
and the MGH section demonstrates the compatibility between
MaRCoS and PulSeq.

Fig. 3. 50 mT system at LUMC. a) Photograph of the scanner inside the
Faraday cage. b) Photograph during an in vivo acquisition.

Fig. 4. 70 mT system at i3M. a) Photograph of the inside and a phantom
used by the American College of Radiation for their MRI accreditation
program [41]. b) Photograph of the outside and a volunteer during an in
vivo acquisition.

and then imported into the MaRCoS framework using custom
interpreter software (see below).

2) LUMC: The custom-built 50 mT (2.15 MHz) Halbach-
based MRI scanner (Fig. 3) is constructed using 2,948 12 mm
cuboid N48 neodymium iron boron magnets arranged in a
cylindrical Halbach conÔ¨Åguration. The magnet
is 50.6 cm
long and has a 27 cm diameter bore. The magnetic Ô¨Åeld
homogeneity is optimized over a 20 cm diameter spherical
volume (DSV) placed at the centre of the magnet. A set of
three linear gradient coils were constructed using a target Ô¨Åeld
method, adapted for the transverse ùêµ0 orientation intrinsic to
cylindrical Halbach arrays. A custom built 1 kW RF ampliÔ¨Åer
with 56 dB gain is used to amplify the RF pulses. The
gradient waveforms are ampliÔ¨Åed using a custom-built three-
axis current-controlled gradient ampliÔ¨Åer, powered using two
Delta Elektronika SM 18-50 DC power supplies (Zierikzee,
the Netherlands). The entire setup is placed inside a Faraday
cage constructed from aluminum extrusion and 2 mm thick
aluminum plates. An RF shield is placed inside the inner
surface of the bore. During in-vivo experiments the body
extends out of the Faraday and couples signiÔ¨Åcant amounts of
electromagnetic interference (EMI) into the RF coil. In order
to reduce this EMI the body is placed under a conductive
cloth (4711 series, Holland Shielding systems BV, Dordrecht,
the Netherlands). Further details on the system can be found
in Refs. [12], [24].

3) i3M: The MaRCoS-powered, portable system at i3M
is shown in Fig. 4 and described in Ref. [16]. The scanner
design is largely based on the LUMC system described above,

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

4

Fig. 5. Programming and execution of a 3D-RARE pulse sequence in MaRCoS: a) GUI window for deÔ¨Ånition of sequence parameters and execution; b)
snippet of Python code; and c) MaRCoS viewer.

pulses. This shortens the scan time from 15 min (Fig. 6a)) to
90 s, but the image is slightly blurred due to small variable
delays in the echo formation. The STIR sequence (Fig. 6c))
is executed with an inversion time (TI) of 45 ms, previously
calibrated to null the contribution from the smaller cylinder
at the right in the phantom, which contains a substance with
ùëá1 and ùëá2 characteristic times diÔ¨Äerent from the rest of the
sample. The diÔ¨Äerence in ùëá1 values is small, however, so
this sequence retrieves signiÔ¨Åcantly less signal per unit time
the total scan
than the rest. For the SNR in the image,
time took around an hour. Finally,
the images in Fig. 6e)
and f) show reconstructions after a radial ùëò-space acquisition.
Both are reconstructed from the exact same data, one with
a standard Fast Fourier Transform (FFT) after regridding
with triangulation-based linear interpolation, the other with
a NUFFT, where ùëò-space points are weighted by density [43].
The latter performs notably better in terms of border deÔ¨Ånition,
but the reconstruction is overall noisier and contains a circular
artifact towards the outer region of the Ô¨Åeld of view. All in
all, diÔ¨Äerent sequences perform signiÔ¨Åcantly diÔ¨Äerent and can
be advantageous for diÔ¨Äerent applications. We Ô¨Ånd 3D-RARE
most reliable in a large variety of situations, and have chosen
it for the in vivo acquisitions below.

2) LUMC:

In this experiment we evaluate the multi-Rx
capabilities of MaRCoS. To this end we built a dual antenna
comprising a saddle coil (188 mm diameter, 202 mm long) for
both transmit and receive, and a solenoid (156 mm diameter,
150 mm long) for receive only (Fig. 7d)). Coupling between
the coils is inherently suppressed due to their orthogonal ùêµ1
orientations (ùëÜ12 < 25 dB). The phantom (120 mm diameter,
144 mm long) images in Fig. 7 were acquired with a 3D-
SE sequence (Table I). The image data from the individual

Fig. 6.
sequences at i3M.

Images of a certiÔ¨Åed phantom [41], acquired with diÔ¨Äerent pulse

1) i3M: First we show the performance of MaRCoS with
Ô¨Åve 3D pulse sequences and two reconstruction algorithms.
To this end, we use a structured phantom used in the MRI
accreditation program of the American College of Radiology
[41]. The images in Fig. 6 are all raw reconstructions, without
Ô¨Åltering or post-processing. All pulse sequence parameters are
included in Table I. SE and GRE sequences (Fig. 6a) and d)
respectively) are the simpler ones and serve as reference to
evaluate the reconstruction quality of the rest. SE performs
slightly better than GRE, since the former is less sensitive
to magnetic Ô¨Åeld inhomogeneities. The RARE acquisition
(Fig. 6b)) is run with an echo train length (ETL) of ten ùúã-

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

5

TABLE I
Image acquisition parameters. ETL stands for Echo Train Length, and ESP for Echo Spacing. TE in RARE sequences corresponds to the effective
echo time.

TE
(ms)

Other
params.

Avgs.

Scan time
(min)

Figure

6a)

6b)

6c)

6d)

6e) & f)

7

8)

9a) & e)

9b) & f)

9c) & g)

9d) & h)

10a) & d)

10b) & e)

10c) & f)

Sample /
Scanner

Phantom /
i3M

Phantom /
i3M

Phantom /
i3M
Phantom /
i3M

Phantom /
i3M

Phantom /
LUMC

Phantom /
MGH

Elbow /
i3M

Forearm /
i3M

Wrist /
i3M

Hand /
i3M

Calf /
i3M

Calf /
i3M

Calf /
i3M

Sequence

FOV
(mm3)

# pixels

BW
(kHz)

3D-SE

130 √ó 130 √ó 130

60 √ó 60 √ó 30

3D-RARE

130 √ó 130 √ó 130

60 √ó 60 √ó 30

3D-STIR

130 √ó 130 √ó 130

60 √ó 60 √ó 30

3D-GRE

130 √ó 130 √ó 130

60 √ó 60 √ó 30

3D-SE
(radial)

130 √ó 130 √ó 130

60 √ó 60 √ó 30

3D-SE

150 √ó 150 √ó 150

100 √ó 100 √ó 20

2D-RARE

15 √ó 15

128 √ó 128

30

30

30

60

30

20

30

TR
(ms)

500

500

500

10

100

1000

5000

20

20

20

2

20

30

53

3D-RARE

120 √ó 120 √ó 120

120 √ó 120 √ó 25

30

400

20

3D-RARE

120 √ó 120 √ó 100

120 √ó 120 √ó 25

30

400

20

3D-RARE

200 √ó 160 √ó 80

120 √ó 120 √ó 20

30

400

20

3D-RARE

180 √ó 180 √ó 50

120 √ó 120 √ó 10

30

400

20

3D-RARE

140 √ó 140 √ó 180

90 √ó 90 √ó 36

22.5

200

20

3D-RARE

140 √ó 140 √ó 180

90 √ó 90 √ó 18

22.5

1000

60

3D-RARE

120 √ó 100 √ó 180

80 √ó 60 √ó 18

20

1000

20

Center-out
ETL = 10
ESP = 20 ms

TI = 20 ms

Flip angle = 15 deg
Radial in ùë¶, ùëß
Equispaced in ùë•
Spokes per slice = 95

Axial
ETL = 32
ESP = 9.5 ms
Center-out
ETL = 10
ESP = 20 ms
Center-out
ETL = 10
ESP = 20 ms
Center-out
ETL = 10
ESP = 20 ms
Center-out
ETL = 10
ESP = 20 ms
Center-out
ETL = 5
ESP = 20 ms
Out-out
ETL = 5
ESP = 20 ms
Center-out
ETL = 5
ESP = 20 ms

1

1

4

1

1

1

4

6

6

7

15

1.5

60

9

4.8

33.3

1

12

12

11.2

13

10.4

6

2

4

13

11

14

channels were Ô¨Åltered with a scaled sine-bell-squared Ô¨Ålter
prior to reconstruction with FFT. To combine the images, the
data of each channel were normalized to their respective noise
measurement prior to summing the magnitude images from the
individual channels. The brightness of the single-Rx images
was scaled from zero to the maximum value of each of the
channels.

3) MGH: A Python interpreter was created to interface
between the open-source PulSeq sequence programming en-
vironment and MaRCoS [39]. Previous PulSeq interpreters
were used with commercial high-Ô¨Åeld MRI scanners, but
our work is the Ô¨Årst extension to an open-source console.
PulSeq uses simple syntax in Matlab [44] or Python [45] to
generate a .seq text Ô¨Åle that speciÔ¨Åes all gradient, RF, and
readout events occurring during a pulse sequence. This enables
students and MRI physicists to rapidly code up sequences in
the user-friendly PulSeq programming language. The .seq Ô¨Åle
is converted to console-speciÔ¨Åc executable code using the in-
terpreter software. The PulSeq-MaRCoS interpreter software is
available on GitHub [46]. Figure 8 shows image data acquired
using the PulSeq-MaRCoS framework with a 2D-RARE spin-

echo-train pulse sequence. The axial projection of the star-
shaped phantom (10 mm in diameter) is reconstructed from
the acquired ùëò-space data with FFT.

B. In vivo performance

The i3M in vivo acquisitions in Fig. 9 show images of the
right upper limb of a healthy volunteer. These correspond
to four independent scans of the hand, wrist, forearm and
elbow. They are all ùëá1-weighted 3D-RARE acquisitions (see
Table I) and have been taken in less than 12 min each. The
SNR, contrast and spatial resolution suÔ¨Éce to identify diÔ¨Äerent
tissues in the anatomy, including muscle, fat, tendons, bone
and bone marrow.

To demonstrate diÔ¨Äerent tissue contrasts, we acquired im-
ages from the right calves of two additional volunteers. The
images in the top row of Fig. 10 correspond to ùëá1, ùëá2 and ùúå-
weighted acquisitions, where the Ô¨Årst two are with the same
subject. The bottom row shows the result of applying a BM4D
Ô¨Ålter [47] to the above images. All pulse sequence parameters
are provided in Table I.

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

6

PulSeq, greatly facilitates the development of pulse sequences
to users with diÔ¨Äerent demands and expertise. MaRCoS is
in continuous evolution by virtue of an open, active, inter-
national network of collaborators, and we have planned a
sizable upgrade for the coming months. This will include;
new pulse sequences, such as steady-state free precession
[4], zero echo time [48] and spiral [49]; data oversampling
capabilities and advanced image reconstruction methods [50];
daisy-chaining of multiple Red Pitaya units for multi-Rx MRI
beyond what we show in this work, as required for parallel
imaging and acceleration techniques [51]; real-time decision-
making capabilities during sequence execution, for potential
optimization of pulses/gradients/delays via feedback control
during data acquisition; and integration with post-processing
and deep learning modules for sequence optimization, image
reconstruction, denoising or segmentation tasks [52]. The
MaRCoS GUI will also continue to be developed to facilitate
operation by users with diÔ¨Äerent degrees of expertise, and to
become readily usable in clinical environments by standardiz-
ing data formats and structure and complying with clinical
procedural requirements. The MaRCoS community has the
commitment to keep this project open-source and welcomes
the participation of new users and contributors.

Contributions

TGN and JMA acquired data on the i3M scanner. RPG,
TGN, JMA, FG and JA conceived and built the i3M scanner.
TOR acquired data on the LUMC scanner. TOR and AW
conceived and built
the LUMC scanner. LCB wrote the
Python interpreter to convert PulSeq Ô¨Åles to MaRCoS/Ô¨Çocra
format. JPS wrote PulSeq sequence code and acquired data
on the MGH scanner. VN and BM developed MaRCoS. YVG
developed the MaRCoS GUI. JA, AW and JPS wrote the paper,
with input from all authors.

Acknowledgment

We thank Thomas Witzel and Marcus Prier for discus-
sions. This work was supported by the Ministerio de Cien-
cia e Innovaci√≥n of Spain through research grant PID2019-
111436RB-C21. Action co-Ô¨Ånanced by the European Union
through the Programa Operativo del Fondo Europeo de De-
sarrollo Regional (FEDER) of the Comunitat Valenciana (ID-
IFEDER/2018/022 and IDIFEDER/2021/004).

Ethical statement
In vivo experiments were carried out following Spanish reg-
ulations and under the research agreement from La Fe Hospital
in Valencia (IIS-F-PG-22-02, agreement number 2019-139-
1). Informed consents to participate and for publication were
obtained from the volunteers prior to study commencement.

Code availability

MaRCoS,

publicly
at

the GUI
available

are
ries
https://github.com/yvives/PhysioMRI_GUI
https://github.com/stockmann-lab/mgh_marcos, respectively.

interface
and
PulSeq
reposito-
from open-source
https://github.com/vnegnev/marcos_server,
and

the

Fig. 7. Images of a structured phantom acquired with simultaneous reception
from two Rx coils at LUMC. a) Reconstruction using the data from the
solenoid coil. b) Reconstruction using the data from the saddle coil. c)
Reconstruction using the combined data from both coils. d) Photograph of
the double-coil antenna, with the solenoid inside and the saddle coil outside.

Fig. 8.
Image data of a star-shaped phantom acquired at MGH with a
RARE spin-echo-train pulse sequence diagram generated by the open-source
PulSeq sequence-programming environment in MATLAB. All excitation and
refocusing RF pulses are 80 ¬µs long. a) ùëò-space magnitude. b) ùëò-space phase.
c) Image magnitude. d) Image phase.

IV. Conclusion & Outlook

With this work we have demonstrated some of the main
capabilities of low-Ô¨Åeld systems equipped with the Ô¨Årst stable
release of MaRCoS, including pulse sequences for in vivo
extremity imaging in clinically viable times and with suÔ¨Écient
quality for initial screening for common pathologies. Our
results show that this platform is capable of driving many dif-
ferent system conÔ¨Ågurations, which has been possible thanks
to collaboration and a commitment to detailed documentation.
The diÔ¨Äerent sequence programming capabilities, from the
self-developed GUI to more widespread ‚Äúoverlays‚Äù such as

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

7

Fig. 9. In vivo images of the right upper limb taken at i3M with 3D-RARE sequences and reconstructed with FFT. Images a)-d) show all slices for the elbow,
forearm, wrist and hand, respectively. Images e)-h) show magniÔ¨Åed views of slices selected from a)-d).

[3] L. Craven-Brightman, T. O‚ÄôReilly, B. Menk√ºc, M. Prier, R. Pellicer-
Guridi, J. Alonso, L. L. Wald, M. Zaitsev, J. Stockmann, T. Witzel,
A. Webb, and V. Negnevitsky, ‚ÄúResearch and educational applications
of an open source, low cost MRI console with an accessible pulse
the 2021
sequence programming environment,‚Äù in Proceedings of
ISMRM & SMRT annual meeting and exhibition.
ISMRM, 2021,
p. Abstract 0748. [Online]. Available: https://cds.ismrm.org/protected/
21MPresentations/abstracts/0748.html

[4] M. Sarracanie, C. D. LaPierre, N. Salameh, D. E. J. Waddington,
T. Witzel, and M. S. Rosen, ‚ÄúLow-Cost High-Performance MRI,‚Äù
ScientiÔ¨Åc Reports, vol. 5, no. 1, p. 15177, dec 2015. [Online]. Available:
http://www.nature.com/articles/srep15177

[5] J. P. Marques, F. F. Simonis, and A. G. Webb, ‚ÄúLow-Ô¨Åeld MRI: An
MR physics perspective,‚Äù Journal of Magnetic Resonance Imaging,
vol. 49, no. 6, pp. 1528‚Äì1542,
[Online]. Available:
https://onlinelibrary.wiley.com/doi/abs/10.1002/jmri.26637

jun 2019.

[6] M. Sarracanie

and N. Salameh,

‚ÄúLow-Field MRI: How Low
Can We Go? A Fresh View on an Old Debate,‚Äù Frontiers in
Physics, vol. 8, p. 172,
[Online]. Available: https:
jun 2020.
//www.frontiersin.org/article/10.3389/fphy.2020.00172/full

[7] L. L. Wald, P. C. McDaniel, T. Witzel, J. P. Stockmann, and C. Z.
Cooley, ‚ÄúLow-cost and portable MRI,‚Äù Journal of Magnetic Resonance
Imaging, vol. 52, no. 3, pp. 686‚Äì696, sep 2020. [Online]. Available:
https://onlinelibrary.wiley.com/doi/10.1002/jmri.26942

[8] S. S. Bhat, T. T. Fernandes, P. Poojar, M. da Silva Ferreira, P. C. Rao,
M. C. Hanumantharaju, G. Ogbole, R. G. Nunes, and S. Geethanath,
‚ÄúLow-Field MRI of Stroke: Challenges and Opportunities,‚Äù Journal
of Magnetic Resonance Imaging, vol. 54, no. 2, pp. 372‚Äì390, aug
2021.
[Online]. Available: https://onlinelibrary.wiley.com/doi/full/10.
1002/jmri.27324

[9] P. C. McDaniel, C. Z. Cooley, J. P. Stockmann, and L. L. Wald,
‚ÄúThe MR Cap: A single-sided MRI system designed for potential
point-of-care limited Ô¨Åeld-of-view brain imaging,‚Äù Magnetic Resonance
in Medicine, vol. 82, no. 5, pp. 1946‚Äì1960, nov 2019. [Online].
Available: https://onlinelibrary.wiley.com/doi/full/10.1002/mrm.27861

[10] M. Nakagomi, M. Kajiwara, J. Matsuzaki, K. Tanabe, S. Hoshiai,
Y. Okamoto, and Y. Terada, ‚ÄúDevelopment of a small car-mounted
magnetic resonance imaging system for human elbows using a 0.2 T
permanent magnet,‚Äù Journal of Magnetic Resonance, vol. 304, pp. 1‚Äì6,
jul 2019.

[11] C. Z. Cooley, P. C. McDaniel, J. P. Stockmann, S. A. Srinivas, S. F.
Cauley, M. ≈öliwiak, C. R. Sappo, C. F. Vaughn, B. Guerin, M. S.
Rosen, M. H. Lev, and L. L. Wald, ‚ÄúA portable scanner for magnetic

In vivo images of the right calves of two healthy volunteers taken
Fig. 10.
at i3M with 3D-RARE sequences and reconstructed with FFT. Images a)-c)
show, respectively, a selected slices for the ùëá1, ùëá2 and ùúå-weighted acquisitions.
Images d)-f) are the same as a)-c), but BM4D-Ô¨Åltered. ùëá1 and ùëá2-weighted
images are from the same subject.

Conflict of interest

TG is a researcher at Tesoro Imaging S.L. JMA, FG and JA
are co-founders of PhysioMRI Tech S.L. JPS is a consultant for
Neuro42, Inc. All other authors declare no competing interests.

References

[1] V. Negnevitsky et al., ‚ÄúMaRCoS technical paper,‚Äù In preparation, 2022.
[2] V. Negnevitsky, T. O‚ÄôReilly, R. Pellicer-Guridi, Y. Vives-Gilabert,
L. Craven-Brightman, D. Schote, J. M. Algar√≠n, M. Prier, J. Stockmann,
T. Witzel, B. Menk√ºc, J. Alonso, and A. Webb, ‚ÄúMaRCoS: a
high-performance open-source control system for aÔ¨Äordable MRI,‚Äù
in Book of Abstracts ESMRMB 2021 38th Annual ScientiÔ¨Åc
Meeting, vol. 34.
[Online]. Available:
Springer, 2021, p. 172.
https://doi.org/10.1007/s10334-021-00947-8

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

8

resonance imaging of the brain,‚Äù Nature Biomedical Engineering 2020
5:3, vol. 5, no. 3, pp. 229‚Äì239, nov 2020.
[Online]. Available:
https://www.nature.com/articles/s41551-020-00641-5

[12] T. O‚ÄôReilly, W. M. Teeuwisse, D. Gans, K. Koolstra, and A. G.
Webb, ‚ÄúIn vivo 3D brain and extremity MRI at 50 mT using a
permanent magnet Halbach array,‚Äù Magnetic Resonance in Medicine,
p. mrm.28396, jul 2020. [Online]. Available: https://onlinelibrary.wiley.
com/doi/abs/10.1002/mrm.28396

[13] K. N. Sheth, M. H. Mazurek, M. M. Yuen, B. A. Cahn, J. T. Shah,
A. Ward, J. A. Kim, E. J. Gilmore, G. J. Falcone, N. Petersen,
K. T. Gobeske, F. Kaddouh, D. Y. Hwang, J. Schindler, L. Sansing,
C. Matouk, J. Rothberg, G. Sze, J. Siner, M. S. Rosen, S. Spudich,
and W. T. Kimberly, ‚ÄúAssessment of Brain Injury Using Portable,
Low-Field Magnetic Resonance Imaging at the Bedside of Critically
Ill Patients,‚Äù JAMA Neurology, vol. 78, no. 1, pp. 41‚Äì47, jan 2021.
[Online]. Available: https://jamanetwork.com/journals/jamaneurology/
fullarticle/2769858

[14] M. H. Mazurek, M. M. Yuen, B. A. Cahn, M. S. Rosen, K. T.
Gobeske, E. J. Gilmore, D. Hwang, F. Kaddouh, J. A. Kim, G. Falcone,
N. Petersen, J. Siner, S. Spudich, G. Sze, W. T. Kimberly, and K. N.
Sheth, ‚ÄúLow-Field, Portable Magnetic Resonance Imaging at the Bedside
to Assess Brain Injury in Patients with Severe COVID-19 (1349),‚Äù
Neurology, vol. 96, no. 15 Supplement, 2021.

[15] Y. Liu, A. T. L. Leong, Y. Zhao, L. Xiao, H. K. F. Mak, A. Chun,
O. Tsang, G. K. K. Lau, G. K. K. Leung, E. X. Wu, and X. . Linfang, ‚ÄúA
low-cost and shielding-free ultra-low-Ô¨Åeld brain MRI scanner,‚Äù Nature
Communications 2021 12:1, vol. 12, no. 1, pp. 1‚Äì14, dec 2021. [Online].
Available: https://www.nature.com/articles/s41467-021-27317-1
[16] T. Guallart-Naval, J. M. Algar√≠n, R. Pellicer-Guridi, F. Galve, Y. Vives-
Gilabert, R. Bosch, E. Pall√°s, J. M. Gonz√°lez, J. P. Rigla, P. Mart√≠nez,
F. J. Lloris, J. Borreguero, A. Marcos-Perucho, V. Negnevitsky, L. Mart√≠-
Bonmat√≠, A. R√≠os, J. M. Benlloch, and J. Alonso, ‚ÄúPortable magnetic
resonance imaging of patients indoors, outdoors and at home,‚Äù arXiv
preprint arXiv:2203.03455, 2022.

[17] T. O‚ÄôReilly and A. G. Webb, ‚ÄúIn vivo T1 and T2 relaxation
time maps of brain tissue, skeletal muscle, and lipid measured in
healthy volunteers at 50 mT,‚Äù Magnetic Resonance in Medicine,
vol. 87, no. 2, pp. 884‚Äì895,
[Online]. Available:
https://onlinelibrary.wiley.com/doi/full/10.1002/mrm.29009

feb 2021.

[18] M. Sarracanie, ‚ÄúFast Quantitative Low-Field Magnetic Resonance Imag-
ing With OPTIMUM - Optimized Magnetic Resonance Fingerprinting
Using a Stationary Steady-State Cartesian Approach and Accelerated
Acquisition Schedules,‚Äù Investigative Radiology, 2021. [Online]. Avail-
able:
https://journals.lww.com/investigativeradiology/Fulltext/9000/
Fast_Quantitative_Low_Field_Magnetic_Resonance.98659.aspx

[19] J. M. Algar√≠n, E. D√≠az-Caballero, J. Borreguero, F. Galve, D. Grau-
Ruiz, J. P. Rigla, R. Bosch, J. M. Gonz√°lez, E. Pall√°s, M. Corber√°n,
C. Gramage, S. Aja-Fern√°ndez, A. R√≠os, J. M. Benlloch, and J. Alonso,
‚ÄúSimultaneous imaging of hard and soft biological tissues in a low-Ô¨Åeld
dental MRI scanner,‚Äù ScientiÔ¨Åc Reports, vol. 10, no. 1, p. 21470, 2020.
[Online]. Available: https://doi.org/10.1038/s41598-020-78456-2
[20] J. M. Gonz√°lez, J. Borreguero, E. Pall√°s, J. P. Rigla, J. M. Algar√≠n,
R. Bosch, F. Galve, D. Grau-Ruiz, R. Pellicer, A. R√≠os, J. M. Benlloch,
and J. Alonso, ‚ÄúPrepolarized MRI of Hard Tissues and Solid-State
Matter,‚Äù arXiv preprint arXiv:2110.03417, 2021.

[21] J. Borreguero, F. Galve, J. M. Algar√≠n, J. M. Benlloch, and J. Alonso,
‚ÄúSlice-selective Zero Echo Time imaging of ultra-short T2 tissues based
on spin-locking,‚Äù arXiv preprint arXiv:2201.06305, 2022.

[22] C. D. Van Speybroeck, T. O‚ÄôReilly, W. Teeuwisse, P. M. Arnold,
and A. G. Webb, ‚ÄúCharacterization of displacement forces and image
artifacts in the presence of passive medical
implants in low-Ô¨Åeld,‚Äù
Physica medica, vol. 84, pp. 116‚Äì124, apr 2021. [Online]. Available:
https://pubmed.ncbi.nlm.nih.gov/33894581/

[23] C. Z. Cooley, J. P. Stockmann, T. Witzel, C. LaPierre, A. Mareyam,
F. Jia, M. Zaitsev, Y. Wenhui, W. Zheng, P. Stang, G. Scott, E. Adal-
steinsson, J. K. White, and L. L. Wald, ‚ÄúDesign and implementation of a
low-cost, tabletop MRI scanner for education and research prototyping,‚Äù
Journal of Magnetic Resonance, vol. 310, p. 106625, jan 2020.
[24] T. O‚ÄôReilly, W. Teeuwisse, and A. Webb, ‚ÄúThree-dimensional MRI in
a homogenous 27 cm diameter bore Halbach array magnet,‚Äù Journal of
Magnetic Resonance, vol. 307, p. 106578, oct 2019. [Online]. Available:
https://linkinghub.elsevier.com/retrieve/pii/S1090780719302174

[25] B. De Vos, P. Fuchs, T. O‚ÄôReilly, A. Webb, and R. Remis, ‚ÄúGradient
Coil Design and Realization for a Halbach-Based MRI System,‚Äù IEEE
Transactions on Magnetics, vol. 56, no. 3, mar 2020.

[26] K. Wenzel, H. Alhamwey, T. O‚ÄôReilly, L. T. Riemann, B. Silemek, and
L. Winter, ‚ÄúB0-Shimming Methodology for AÔ¨Äordable and Compact

Low-Field Magnetic Resonance Imaging Magnets,‚Äù Frontiers in Physics,
vol. 9, p. 411, jul 2021.

[27] N. Koonjoo, B. Zhu, G. C. Bagnall, D. Bhutto, and M. S. Rosen,
‚ÄúBoosting the signal-to-noise of low-Ô¨Åeld MRI with deep learning
image reconstruction,‚Äù ScientiÔ¨Åc Reports 2021 11:1, vol. 11, no. 1, pp.
1‚Äì16, apr 2021. [Online]. Available: https://www.nature.com/articles/
s41598-021-87482-7

[28] T. C. Arnold, S. N. Baldassano, B. Litt, and J. M. Stein,
low-Ô¨Åeld MRI: Harnessing
‚ÄúSimulated diagnostic performance of
open-access datasets to evaluate novel devices,‚Äù Magnetic Resonance
Imaging, vol. 87, pp. 67‚Äì76,
jan 2022. [Online]. Available: https:
//linkinghub.elsevier.com/retrieve/pii/S0730725X21002575

[29] P. P. Stang, S. M. Conolly, J. M. Santos, J. M. Pauly, and G. C. Scott,
‚ÄúMedusa: A scalable MR console using USB,‚Äù IEEE Transactions on
Medical Imaging, vol. 31, no. 2, pp. 370‚Äì379, feb 2012.

[30] W. Tang, W. Wang, W. Liu, Y. Ma, X. Tang, L. Xiao, and J. H. Gao,
‚ÄúA home-built digital optical MRI console using high-speed serial
links,‚Äù Magnetic Resonance in Medicine, vol. 74, no. 2, pp. 578‚Äì588,
aug 2015. [Online]. Available: https://onlinelibrary.wiley.com/doi/10.
1002/mrm.25403

[31] C. J. Hasselwander, Z. Cao, and W. A. Grissom, ‚Äúgr-MRI: A software
package for magnetic resonance imaging using software deÔ¨Åned radios,‚Äù
Journal of Magnetic Resonance, vol. 270, pp. 47‚Äì55, sep 2016.
[32] S. Anand, J. P. Stockmann, L. L. Wald, and T. Witzel, ‚ÄúA low-cost
(<$500 USD) FPGA-based console capable of real-time control,‚Äù in
Proceedings of the 2018 ISMRM & SMRT annual meeting and exhibition
in Paris.

ISMRM, 2018, p. 948.

[33] ‚ÄúOCRA MRI.‚Äù [Online]. Available: https://openmri.github.io/ocra/
[34] K. Takeda,

‚ÄúChapter 7 - Highly Customized NMR Systems
Using an Open-Resource, Home-Built Spectrometer,‚Äù ser. Annual
Reports on NMR Spectroscopy, G. A. Webb, Ed. Academic
Press, 2011, vol. 74, pp. 355‚Äì393.
[Online]. Available: https:
//www.sciencedirect.com/science/article/pii/B9780080970721000078

[35] C. A. Michal, ‚ÄúA low-cost multi-channel software-deÔ¨Åned radio-based
NMR spectrometer and ultra-aÔ¨Äordable digital pulse programmer,‚Äù
Concepts
in Magnetic Resonance Part B: Magnetic Resonance
Engineering, vol. 48B, no. 3, p. e21401, 2018. [Online]. Available:
https://onlinelibrary.wiley.com/doi/abs/10.1002/cmr.b.21401

[36] A. Ang, M. Bourne, S. Obruchkov, and R. Dykstra, ‚ÄúConstruction of
a pxie platform for instrumentation development,‚Äù in 2017 Eleventh
International Conference on Sensing Technology (ICST), 2017, pp. 1‚Äì4.
[37] ‚ÄúMaRCoS GitHub.‚Äù [Online]. Available: https://github.com/vnegnev/

marcos_extras/wiki

[38] ‚ÄúMaRCoS GUI GitHub.‚Äù [Online]. Available: https://github.com/yvives/

PhysioMRI_GUI

[39] K. J. Layton, S. Kroboth, F. Jia, S. Littin, H. Yu, J. Leupold, J. F. Nielsen,
T. St√∂cker, and M. Zaitsev, ‚ÄúPulseq: A rapid and hardware-independent
pulse sequence prototyping framework,‚Äù Magnetic Resonance in
Medicine, vol. 77, no. 4, pp. 1544‚Äì1552, apr 2017. [Online]. Available:
https://onlinelibrary.wiley.com/doi/10.1002/mrm.26235

[40] ‚ÄúGPA-FHDO.‚Äù [Online]. Available: https://github.com/menkueclab
[41] O. Sipil√§, T. M√§kel√§ et al., ‚ÄúRepeated quality control measurements with
the small ACR MRI phantom.‚Äù European Congress of Radiology-ECR,
2013.

[42] ‚ÄúOCRA1 - SPI controlled 4 channel 18 BIT DAC and RF
attenuator.‚Äù [Online]. Available: https://zeugmatographix.org/ocra/2020/
11/27/ocra1-spi-controlled-4-channel-18bit-dac-and-rf-attenutator/
[43] L. Greengard and J.-Y. Lee, ‚ÄúAccelerating the nonuniform fast fourier
transform,‚Äù SIAM Review, vol. 46, no. 3, pp. 443‚Äì454, 2004. [Online].
Available: https://doi.org/10.1137/S003614450343200X

[44] ‚ÄúPulSeq Git Repository.‚Äù [Online]. Available: https://github.com/pulseq/

pulseq

[45] ‚ÄúPyPulSeq Git Repository.‚Äù [Online]. Available: https://github.com/

imr-framework/pypulseq

[46] ‚ÄúMGH_MARCOS Project.‚Äù [Online]. Available: https://github.com/

stockmann-lab/mgh_marcos

[47] M. Maggioni, V. Katkovnik, K. Egiazarian, and A. Foi, ‚ÄúNonlocal
transform-domain Ô¨Ålter for volumetric data denoising and reconstruc-
tion,‚Äù IEEE Transactions on Image Processing, vol. 22, no. 1, pp. 119‚Äì
133, 2013.

[48] D. M. Grodzki, P. M. Jakob, and B. Heismann, ‚ÄúUltrashort echo time
imaging using pointwise encoding time reduction with radial acquisition
(PETRA),‚Äù Magnetic Resonance in Medicine, vol. 67, no. 2, pp. 510‚Äì
518, feb 2012.

[49] A. E. Campbell-Washburn, R. Ramasawmy, M. C. Restivo, I. Bhat-
tacharya, B. Basar, D. A. Herzka, M. S. Hansen, T. Rogers, W. P.
Bandettini, D. R. McGuirt, C. Mancini, D. Grodzki, R. Schneider,

JOURNAL OF LATEX CLASS FILES, VOL. X, NO. X, MARCH 2022

9

W. Majeed, H. Bhat, H. Xue, J. Moss, A. A. Malayeri, E. C. Jones, A. P.
Koretsky, P. Kellman, M. Y. Chen, R. J. Lederman, and R. S. Balaban,
‚ÄúOpportunities in Interventional and Diagnostic Imaging by Using High-
Performance Low-Field-Strength MRI,‚Äù Radiology, vol. 293, no. 2, pp.
384‚Äì393, nov 2019.

[50] F. Galve, J. Alonso, J. M. Algar√≠n, and J. M. Benlloch, ‚ÄúModel-driven
reconstruction with phase-constrained highly-oversampled MRI,‚Äù arXiv
preprint arXiv:2007.15674, 2020.

[51] K. P. Pruessmann, M. Weiger, M. B. Scheidegger, and P. Boesiger,
‚ÄúSENSE: Sensitivity encoding for fast MRI,‚Äù Magnetic Resonance in
Medicine, vol. 42, no. 5, pp. 952‚Äì962, nov 1999.

[52] A. S. Lundervold and A. Lundervold, ‚ÄúAn overview of deep
f√ºr
learning in medical
Medizinische Physik, vol. 29, no. 2, pp. 102‚Äì127, 2019, special
[Online]. Available:
Issue: Deep Learning in Medical Physics.
https://www.sciencedirect.com/science/article/pii/S0939388918301181

imaging focusing on mri,‚Äù Zeitschrift

