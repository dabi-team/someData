Received: Added at production

Revised: Added at production

Accepted: Added at production

DOI: xxx/xxxx

RESEARCH ARTICLE

Group sequential methods for interim monitoring of randomized
clinical trials with time-lagged outcome

Anastasios A. Tsiatis | Marie Davidian*

1Department of Statistics, North Carolina
State University, North Carolina, USA

Summary

Correspondence
*Marie Davidian, Department of Statistics,
North Carolina State University, Raleigh,
NC 27695-8203, USA. Email:
davidian@ncsu.edu

The primary analysis in two-arm clinical trials usually involves inference on a
scalar treatment eï¬€ect parameter; e.g., depending on the outcome, the diï¬€erence of

treatment-speciï¬c means, risk diï¬€erence, risk ratio, or odds ratio. Most clinical trials
are monitored for the possibility of early stopping. Because ordinarily the outcome

on any given subject can be ascertained only after some time lag, at the time of an
interim analysis, among the subjects already enrolled, the outcome is known for only

a subset and is eï¬€ectively censored for those who have not been enrolled suï¬ƒciently
long for it to be observed. Typically, the interim analysis is based only on the data

from subjects for whom the outcome has been ascertained. A goal of an interim anal-
ysis is to stop the trial as soon as the evidence is strong enough to do so, suggesting

that the analysis ideally should make the most eï¬ƒcient use of all available data, thus
including information on censoring as well as other baseline and time-dependent

covariates in a principled way. A general group sequential framework is proposed

for clinical trials with a time-lagged outcome. Treatment eï¬€ect estimators that take
account of censoring and incorporate covariate information at an interim analysis are

derived using semiparametric theory and are demonstrated to lead to stronger evi-
dence for early stopping than standard approaches. The associated test statistics are

shown to have the independent increments structure, so that standard software can
be used to obtain stopping boundaries.

KEYWORDS:
augmented inverse probability weighting, early stopping, inï¬‚uence function, proportion of information

2
2
0
2

r
p
A
2
2

]
E
M

.
t
a
t
s
[

1
v
9
3
7
0
1
.
4
0
2
2
:
v
i
X
r
a

1

INTRODUCTION

In many randomized clinical trials, the primary analysis involves a comparison of two treatments, typically an active or experi-
mental agent versus a control, which is formalized as inference on a scalar treatment eï¬€ect parameter. When the primary outcome
is a continuous measure, this parameter is usually the diï¬€erence of treatment-speciï¬c means. For a binary outcome, the treatment
eï¬€ect parameter may be the risk diï¬€erence, risk ratio, or odds ratio; and the odds ratio under the assumption of a proportional
odds model is often the treatment eï¬€ect parameter of interest in trials involving an ordinal categorical outcome. The primary
analysis is ordinarily based on a test statistic constructed using an estimator for the parameter of interest, e.g., the diï¬€erence of
sample means or maximum likelihood (ML) estimator for the odds ratio in a proportional odds model. The overall sample size

 
 
 
 
 
 
2

TSIATIS and DAVIDIAN

is established so that the power to detect a clinically meaningful departure from the hypothesis of no treatment eï¬€ect at a given
level of signiï¬cance using the test statistic at the ï¬nal analysis achieves some desired value, e.g., 90%.

Most later-stage clinical trials are monitored for the possibility of early stopping for eï¬ƒcacy or futility by a data and safety
monitoring board (DSMB), with interim analyses planned at either ï¬xed, predetermined analysis times or when speciï¬ed pro-
portions of the total â€œstatistical informationâ€ to be gained from the completed trial have accrued 1. Ordinarily, at the time of an
interim analysis, the test statistic to be used for the ï¬nal analysis is computed based on the available data and compared to a
suitable stopping boundary constructed to preserve the overall operating characteristics of the trial 2,3.

Because of staggered entry into the trial, the data available at the time of an interim analysis are from subjects who have
already enrolled. Moreover, the primary outcome ğ‘Œ is ordinarily not known immediately but is ascertained after some lag time
ğ‘‡ , say. In some trials, the lag time ğ‘‡ is the same for all participants, as in the case where ğ‘Œ is a continuous outcome that will be
measured at a prespeciï¬ed follow-up time î‰€ğ¹ , e.g., î‰€ğ¹ = one year, so that ğ‘‡ = î‰€ğ¹ for all subjects, and the treatment parameter is
the diï¬€erence in treatment means of ğ‘Œ at one year. Here, at the time of an interim analysis, ğ‘Œ will be available only for subjects
enrolled for at least one year, so that the analysis can be based only on the data for these subjects.

In other settings, the time lag ğ‘‡ may be diï¬€erent for diï¬€erent participants, as is the case in many clinical trials of COVID-
19 therapeutics conducted by the Accelerating COVID-19 Therapeutic Interventions and Vaccines (ACTIV) public-private
partnership. In an ongoing clinical trial coordinated through the ACTIV-3b: Therapeutics for Severely Ill Inpatients with COVID-
19 (TESICO) master protocol 4, patients hospitalized with acute respiratory distress syndrome are randomized to receive an
active agent or placebo and followed for up to î‰€ğ¹ = 90 days. The primary outcome ğ‘Œ is an ordinal categorical variable with six
levels. The ï¬rst ï¬ve categories reï¬‚ect a subjectâ€™s status at 90 days following enrollment: 1, at home and oï¬€ oxygen for at least
77 days (the most favorable category); 2, at home and oï¬€ oxygen for at least 49 but no more than 76 days; 3, at home and oï¬€
oxygen for at least 1 but no more than 48 days; 4, not hospitalized and either at home on oxygen or receiving care elsewhere; and
5, still hospitalized or in hospice care. Category 6 (the worst) corresponds to death within the 90 day follow-up period. While
Categories 1-5 cannot be ascertained until a subject has been followed for the full 90 days, that a subjectâ€™s outcome is Category
6 is known at the time of death. Thus, the time lag before ascertainment is ğ‘‡ = î‰€ğ¹ = 90 days for subjects with ğ‘Œ = 1, â€¦ , 5 and
is equal to the (random) time of death ğ‘‡ â‰¤ î‰€ğ¹ = 90 for those with ğ‘Œ = 6. In TESICO, the treatment eï¬€ect parameter is the odds
ratio for active agent relative to placebo under an assumed proportional odds model. Similarly, in a clinical trial coordinated
through the ACTIV-2: A Study for Outpatients With COVID-19 master protocol (Study A5401) 5, subjects within seven days
of self-reported COVID-19 onset are randomized to receive an active agent or placebo and followed for up to î‰€ğ¹ = 28 days for
the binary outcome ğ‘Œ , where ğ‘Œ = 1 if the subject dies or is or hospitalized within 28 days and ğ‘Œ = 0 otherwise. For subjects
who die or are hospitalized at time ğ‘‡ prior to 28 days, ğ‘Œ = 1 is ascertained after a time lag ğ‘‡ â‰¤ î‰€ğ¹ = 28, whereas that ğ‘Œ = 0
can be ascertained only after the full 28 days, and ğ‘‡ = î‰€ğ¹ = 28. Here, the treatment parameter is the relative risk (risk ratio) of
hospitalization/death for active agent versus placebo.

At the time of an interim analysis in TESICO and A5401, the available data include the outcomes for all enrolled subjects
who have been followed for at least 90 and 28 days, so for whom ğ‘‡ = î‰€ğ¹ = 90 or 28, respectively, along with the outcomes for
enrolled subjects who do not have 90 or 28 days of follow up but have already been observed to die (ğ‘Œ = 6) in TESICO or to be
hospitalized or die (ğ‘Œ = 1) in A5401 (ğ‘‡ â‰¤ î‰€ğ¹ = 90 or 28). Thus, information on Category 6 in TESICO will accumulate more
rapidly than that on the other categories; similarly, information on hospitalization/death in A5401 will accrue more quickly than
information on subjects who remain alive and unhospitalized at day 28. Intuitively, basing an interim analysis on all observed
outcomes will naively overrepresent ğ‘Œ = 6 and ğ‘Œ = 1 and lead to potentially biased inference on the treatment eï¬€ect parameters.
To characterize this issue more precisely, if ğ¶ is the time from a subjectâ€™s entry into the study to the time of an interim
analysis, then ğ‘Œ is known at the time of an interim analysis if ğ¶ > ğ‘‡ . Otherwise, the ascertainment time ğ‘‡ is censored at ğ¶
and ğ‘Œ is not observed. Basing the analysis on all subjects with ğ¶ > ğ‘‡ without taking appropriate account of the fact that ğ‘Œ is
not available for those with ğ¶ â‰¤ ğ‘‡ leads to the bias noted above. These considerations suggest that a valid interim analysis can
be obtained by using only the data from enrolled subjects followed for the full, maximum follow-up period î‰€ğ¹ , i.e., for whom
ğ¶ â‰¥ î‰€ğ¹ . In studies like those above involving a continuous outcome or ordinal categorical outcome, as in TESICO, the standard
interim analysis is based on the estimator to be used at the ï¬nal analysis using only the data on subjects with ğ¶ â‰¥ î‰€ğ¹ , as there
is no apparent general approach to â€œadjustingâ€ for the censoring. In the case of a binary outcome as in A5401, the standard
interim analysis does use the information on censoring; e.g., if the treatment eï¬€ect is the risk ratio, the estimator is the ratio of
the treatment-speciï¬c Kaplan-Meier estimators for the probability of death or hospitalization at î‰€ğ¹ = 28 days.

A goal of an interim analysis is to stop the trial as early as possible if there is suï¬ƒciently strong evidence to do so. It is thus
natural to consider whether or not it is possible to make more eï¬ƒcient use of the available data at the time of an interim analysis

TSIATIS and DAVIDIAN

3

to enhance precision and thus the strength of the evidence for stopping. One step toward increasing eï¬ƒciency of interim analyses
would be a general approach to accounting for censoring for any outcome and treatment eï¬€ect parameter to allow incorporation
of partial information; e.g., in TESICO, a subject who is at day 45 since study entry and still in the hospital at the time of an
analysis, so for whom ğ¶ = 45 < î‰€ğ¹ = 90, can end up only in Categories 3â€“6, so have ğ‘Œ = 3, 4, 5, or 6, at 90 days. In addition,
there may be baseline covariates as well as intermediate measures of the outcome or other post-treatment variables that could
be exploited to increase precision at an interim analysis.

In this article, we propose a general group sequential framework for clinical trials with a possibly censored, time-lagged
outcome, which leads to practical strategies for interim monitoring. Treatment eï¬€ect estimators are proposed via application of
semiparametric theory 6,7, which dictates how censoring can be taken into account and baseline and time-dependent covariate
information can be exploited in a principled way to increase precision and thus yield stronger evidence for early stopping.
Estimation of the risk ratio via treatment-speciï¬c Kaplan-Meier estimators as described above emerges as a simple special case,
which can be improved upon through incorporation of covariates. We show that the test statistics based on these estimators have
an independent increments structure 8, which allows standard software for constructing stopping boundaries 2,3,9 to be used. Two
interim monitoring strategies are discussed: an information-based monitoring approach under which the trial will continue, with
possibly a larger sample size than originally planned, until the full, target statistical information accrues; and a ï¬xed-sample
size approach appropriate in settings where the planned sample size cannot be increased due to resource and other constraints.
We focus on the common case of two treatments; extension of the developments to more than two treatments is possible 10 and
could be adapted to group sequential methods for multi-arm trials 11,12.

In Section 2 we introduce the basic statistical framework and assumptions, and we sketch the estimation approach and state
the independent increments property in Section 3. In Section 4, we describe practical implementation of the resulting approach
to interim monitoring. We demonstrate the performance of the methods in a series of simulation studies in Section 5, and we
present a case study exemplifying the use of the methods for a simulated trial based on TESICO. Technical details and sketches
of proofs of results are given in the Appendix.

2

STATISTICAL FRAMEWORK

2.1 General model

As in Section 1, denote the outcome by ğ‘Œ . Let ğ´ denote the treatment indicator, where ğ´ = 0 (1) corresponds to control
(active/experimental treatment), and ğœ‹ = pr(ğ´ = 1) is the probability of being assigned to active treatment; and let ğ‘‹ be a vector
of baseline covariates. Treatment eï¬€ects are often characterized in terms of a model for (features of) the distribution of (ğ‘Œ , ğ´)
or (ğ‘Œ , ğ´, ğ‘‹), which involves parameters (ğ›¼ğ‘‡ , ğ›½), where ğ›½ is the scalar treatment eï¬€ect parameter of interest and ğ›¼ is a vector of
nuisance parameters, and the model is parameterized such that ğ›½ = 0 corresponds to the null hypothesis of no treatment eï¬€ect.

In the case of the ï¬rst example in Section 1 of continuous ğ‘Œ , ğ›½ = ğ¸(ğ‘Œ

ğ´ = 1) âˆ’ ğ¸(ğ‘Œ

ğ´ = 0); equivalently,

For an ordinal categorical outcome with ğ‘ categories, as in TESICO with ğ‘ = 6, the outcome can be represented as either a
scalar random variable ğ‘Œ taking values 1, â€¦ , ğ‘ or a random vector ğ‘Œ = {ğ¼(ğ¶ğ‘ğ‘¡ = 1), â€¦ , ğ¼(ğ¶ğ‘ğ‘¡ = ğ‘ âˆ’ 1)}, where ğ¶ğ‘ğ‘¡ takes
values 1, â€¦ , ğ‘. Using the ï¬rst deï¬nition, the treatment eï¬€ect can be deï¬ned through an assumed proportional odds model

|

ğ¸(ğ‘Œ

ğ´ = ğ‘) = ğ›¼ + ğ›½ğ‘,

ğ‘ = 0, 1.
|

|

(1)

logit{pr(ğ‘Œ â‰¤ ğ‘—

ğ´ = ğ‘)} = ğ›¼ğ‘— + ğ›½ğ‘,

ğ‘— = 1, â€¦ , ğ‘ âˆ’ 1,

ğ›¼ = (ğ›¼1, â€¦ , ğ›¼ğ‘âˆ’1)ğ‘‡ ,

ğ‘ = 0, 1,

(2)

where logit(ğ‘) = log{ğ‘âˆ•(1 âˆ’ ğ‘)}, so that ğ›½ is the log odds ratio of interest. If the conditional (on ğ‘‹) treatment eï¬€ect is of interest,
ğ‘‹ = ğ‘¥, ğ´ = ğ‘)} = ğ›¼ğ‘— + ğ›½ğ‘ + ğœ‰ğ‘‡ ğ‘¥, where now ğ›¼ = (ğ›¼1, â€¦ , ğ›¼ğ‘âˆ’1, ğœ‰ğ‘‡ )ğ‘‡ . If ğ‘Œ is binary as in A5401
replace (2) by logit{pr(ğ‘Œ â‰¤ ğ‘—
and the relative risk (risk ratio) pr(ğ‘Œ = 1

ğ´ = 0) is the focus, taking

ğ´ = 1)âˆ•pr(ğ‘Œ = 1

|

|

corresponds to log relative risk ğ›½.

ğ¸(ğ‘Œ

ğ´ = ğ‘) = exp(ğ›¼ + ğ›½ğ‘),
|

|

ğ‘ = 0, 1,

(3)

In general, estimators for the parameter of interest ğ›½ in (1)-(3) and other models based on the data available at the ï¬nal analysis,
at which time (ğ‘Œ , ğ´, ğ‘‹) are known for all ğ‘› participants, are obtained by solving, jointly in ğ›¼ and ğ›½, appropriate estimating
equations. Namely, with independent and identically distributed (iid) data (ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–), ğ‘– = 1, â€¦ , ğ‘›, available, and ğ‘ equal to the

|

4

TSIATIS and DAVIDIAN

dimension of (ğ›¼ğ‘‡ , ğ›½)ğ‘‡ , Ì‚ğ›¼ and Ì‚ğ›½ solve in ğ›¼ and ğ›½ equations of the form

where îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½) is a ğ‘-dimensional vector of functions such that ğ¸{îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)} = 0, and ğ›¼0 and ğ›½0 are the true
values of ğ›¼ and ğ›½ under the assumption that the model is correctly speciï¬ed. For example, under models (1) and (3)

ğ‘–=1
âˆ‘

ğ‘›

îˆ¹(ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; ğ›¼, ğ›½) = 0,

(4)

(a) îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½) =

(ğ‘Œ âˆ’ ğ›¼ âˆ’ ğ›½ğ´)

and

(b) îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½) =

{ğ‘Œ âˆ’ exp(ğ›¼ + ğ›½ğ´)},

(5)

(
ğ‘›
ğ‘–=1 ğ¼(ğ´ğ‘– = ğ‘), ğ‘ = 0, 1, the treatment-speciï¬c sample means, the estimator
respectively. Writing ğ‘Œ ğ‘ =
obtained from (5)(a) is Ì‚ğ›½ = ğ‘Œ 1 âˆ’ ğ‘Œ 0 and that from (5)(b) is Ì‚ğ›½ = log(ğ‘Œ 1âˆ•ğ‘Œ 0), which is the estimator for the relative risk used in
A5401. Under model (2), with expit(ğ‘¢) = ğ‘’ğ‘¢âˆ•(1 + ğ‘’ğ‘¢),

)
ğ‘›
ğ‘–=1 ğ‘Œğ‘–ğ¼(ğ´ğ‘– = ğ‘)âˆ•

âˆ‘

âˆ‘

)

(

1
ğ´

1
ğ´

ğ¼(ğ‘Œ â‰¤ 1) âˆ’ expit(ğ›¼1 + ğ›½ğ´)
â‹®
ğ¼(ğ‘Œ â‰¤ ğ‘ âˆ’ 1) âˆ’ expit(ğ›¼ğ‘âˆ’1 + ğ›½ğ´) â
âŸ
âŸ
â 

â›
âœ
âœ
â

îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½) = îˆ°(ğ´)

,

(6)

where îˆ°(ğ´) is a (ğ‘Ã—ğ‘âˆ’1) matrix of functions of ğ´; the ML estimator 13 takes îˆ°(ğ´) = ğ·ğ‘‡ (ğ´; ğ›¼, ğ›½)ğ‘‰ âˆ’1(ğ´; ğ›¼, ğ›½), where ğ·(ğ´; ğ›¼, ğ›½)
is the (ğ‘ âˆ’ 1 Ã— ğ‘) gradient matrix of the vector {ğ¼(ğ‘Œ â‰¤ 1) âˆ’ expit(ğ›¼1 + ğ›½ğ´), â€¦ , ğ¼(ğ‘Œ â‰¤ ğ‘ âˆ’ 1) âˆ’ expit(ğ›¼ğ‘âˆ’1 + ğ›½ğ´)}ğ‘‡ in (6) with
respect to ğ›¼1, â€¦ , ğ›¼ğ‘âˆ’1, ğ›½, and ğ‘‰ (ğ´; ğ›¼, ğ›½) is its (ğ‘ âˆ’ 1 Ã— ğ‘ âˆ’ 1) conditional covariance matrix given ğ´.

In general, given a particular model and estimating equations deï¬ned by the corresponding function îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½), let

îˆ³(ğ›¼, ğ›½) be the last row of the (ğ‘ Ã— ğ‘) matrix

ğœ•îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½)
ğœ•ğ›¼ğ‘‡ ğœ•ğ›½
where the matrix inside the expectation is the (ğ‘ Ã— ğ‘) matrix of partial derivatives of the ğ‘ components of îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½) with
respect to (ğ›¼ğ‘‡ , ğ›½)ğ‘‡ . Then, with îˆ³(ğ›¼0, ğ›½0) denoting this expression evaluated at ğ›¼0, ğ›½0,

}]

(7)

{

ğ¸

âˆ’

[

,

âˆ’1

ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) = îˆ³(ğ›¼0, ğ›½0)îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
is referred to as the inï¬‚uence function of the corresponding estimator for ğ›½ and has mean zero. From the theory of M-estimation 14
and semiparametric theory 7, it can be shown the estimator Ì‚ğ›½ obtained by solving in ğ›½ the estimating equation

(8)

ğ‘›

ğ‘š(ğ‘Œ , ğ´, ğ‘‹; Ì‚ğ›¼, ğ›½) = 0,

(9)

where Ì‚ğ›¼ is any root-ğ‘› consistent estimator for ğ›¼, has inï¬‚uence function (8). Tsiatis et al. 10 show this explicitly in the case of
(6). Such estimators are consistent for the true value ğ›½0 and asymptotically normal, where the variance of the limiting normal
distribution of ğ‘›1âˆ•2( Ì‚ğ›½ âˆ’ ğ›½0) is equal to var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)} = ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)2}, so that approximate (large sample)
standard errors and test statistics are readily derived.

ğ‘–=1
âˆ‘

From semiparametric theory 7, there is a one-to-one correspondence between inï¬‚uence functions and estimators. Thus, if the
form of inï¬‚uence functions in a speciï¬c model involving a parameter ğ›½ can be derived, estimating equations leading to estimators
for ğ›½ can be developed. As we demonstrate in Section 3, inï¬‚uence functions corresponding to estimators for ğ›½ based on the data
available at an interim analysis can be derived from the inï¬‚uence function (8), and the resulting estimators exploit baseline and
time-dependent covariate information to gain precision.

2.2

Data and assumptions

To characterize the data that would be available at an interim analysis, we ï¬rst describe more fully the data that would be
available at the ï¬nal analysis if the trial were carried out to completion. Subjects enter the trial in a staggered fashion; thus, if
the trial starts at calendar time 0, denote by ğ¸ the calendar time at which a subject enters the trial. As in Section 1, let ğ‘‡ denote
the time lag in ascertaining the outcome ğ‘Œ ; thus, ğ‘‡ is the time since entry at which ğ‘Œ is determined, measured on the scale of
subject time. We assume that ğ‘Œ can be determined with certainty by the maximum follow-up period î‰€ğ¹ for any subject, so that
pr(ğ‘‡ â‰¤ î‰€ğ¹ ) = 1. In addition to baseline covariates ğ‘‹, time-dependent covariate information may be collected on each participant
up to the time ğ‘Œ is ascertained. Denote by ğ¿(ğ‘¢) the vector of such information at time ğ‘¢ following entry into the study, and let

TSIATIS and DAVIDIAN

5

Ì„ğ¿(ğ‘¢) = {ğ¿(ğ‘ ) âˆ¶ 0 â‰¤ ğ‘  â‰¤ ğ‘¢} be the history of the time-dependent covariate information through time ğ‘¢. Thus, Ì„ğ¿(ğ‘‡ ) represents
the covariate history for a subject for whom ğ‘Œ is ascertained after time lag ğ‘‡ .

With these deï¬nitions, for a trial with planned total sample size ğ‘›, the data available at the ï¬nal analysis are iid

{ğ¸ğ‘–, ğ‘‹ğ‘–, ğ´ğ‘–, ğ‘‡ğ‘–, ğ‘Œğ‘–, Ì„ğ¿ğ‘–(ğ‘‡ğ‘–)},

ğ‘– = 1, â€¦ , ğ‘›;

(10)

we refer to (10) as the full data. As in Section 2.1, estimation of ğ›½ at the ï¬nal analysis is based only on the data on ğ‘Œ , ğ´, and
possibly ğ‘‹ (in the case of conditional inference), and ğ¸, ğ‘‡ , and Ì„ğ¿(ğ‘‡ ) are not used, and we call (8) a full data inï¬‚uence function.
Now consider the data that would be available at an interim analysis at calendar time ğ‘¡ following the start of the trial at calendar
time 0. It proves convenient for the developments in Section 3 to represent these data in terms of the full data (10) that would
be available at the ï¬nal analysis were the trial to be carried out to completion. At ğ‘¡, data will be observed only for subjects for
whom ğ¸ â‰¤ ğ‘¡. For such subjects, deï¬ne ğ¶(ğ‘¡) = ğ‘¡ âˆ’ ğ¸ to be the censoring time, i.e., the time from a participantâ€™s entry into
the study to the time of the interim analysis. If the time lag ğ‘‡ a subject would have in ascertaining the outcome is such that
ğ‘‡ â‰¤ ğ¶(ğ‘¡), then ğ‘Œ would be available at ğ‘¡; otherwise, ğ‘Œ would not yet be observed. Accordingly, deï¬ne ğ‘ˆ (ğ‘¡) = min{ğ‘‡ , ğ¶(ğ‘¡)}
and Î”(ğ‘¡) = ğ¼{ğ‘‡ â‰¤ ğ¶(ğ‘¡)}, so that ğ‘Œ is available at the time of the interim analysis only if Î”(ğ‘¡) = 1. With these deï¬nitions, the
data available at an interim analysis at calendar time ğ‘¡ can be represented as iid

îˆ»(ğ‘¡)

ğ‘– = ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ¸ğ‘–, ğ‘‹ğ‘–, ğ´ğ‘–, ğ‘ˆğ‘–(ğ‘¡), Î”ğ‘–(ğ‘¡), Î”ğ‘–(ğ‘¡)ğ‘Œğ‘–, Ì„ğ¿ğ‘–{ğ‘ˆğ‘–(ğ‘¡)}

,

ğ‘– = 1, â€¦ , ğ‘›,

(11)

where then ğ‘›(ğ‘¡) =

ğ‘›
ğ‘–=1 ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡) is the number of subjects of the ğ‘› planned enrolled in the trial by calendar time ğ‘¡.

]

[

âˆ‘

As noted in Section 1, an interim analysis that uses all of the available data, including those from subjects for whom ğ‘‡ < î‰€ğ¹ ,
can naively overrepresent some values of the outcome over others. In terms of (11), the data on which this naive analysis would
be based involve only subjects ğ‘– who are enrolled and whose outcome is available, i.e., for whom ğ¼{ğ¸ğ‘– â‰¤ ğ‘¡), Î”ğ‘–(ğ‘¡) = 1} = 1.
In contrast, a valid analysis that uses only the data from subjects enrolled for at least the full, maximum follow-up period î‰€ğ¹
involves subjects ğ‘– for whom ğ¼{ğ¸ğ‘– â‰¤ ğ‘¡, ğ¶ğ‘–(ğ‘¡) â‰¥ î‰€ğ¹ } = 1. In the next section, we appeal to semiparametric theory as noted
at the end of Section 2.1 to deduce methods yielding valid inference on ğ›½ based on the available data (11) that can improve
substantially on this analysis and thus lead to more eï¬ƒcient interim analyses.

3

INFERENCE BASED ON INTERIM DATA

3.1

Treatment eï¬€ect estimation

We ï¬rst present general estimating equations using the available data (11) at an interim analysis at time ğ‘¡ that yield treatment
eï¬€ect estimators oï¬€ering gains in precision relative to the estimator based only on subjects for whom ğ¼{ğ¸ğ‘– â‰¤ ğ‘¡, ğ¶ğ‘–(ğ‘¡) â‰¥ î‰€ğ¹ } = 1.
Letting â€œâŸ‚âŸ‚â€ denote statistical independence, assume that ğ‘‹ âŸ‚âŸ‚ ğ´, which is guaranteed by randomization. Also assume that

ğ¸ âŸ‚âŸ‚ {ğ‘‹, ğ´, ğ‘‡ , ğ‘Œ , Ì„ğ¿(ğ‘‡ )};

(12)

(12) implies that subjects enter according to a completely random process, which is reasonable in many trials. Because ğ¶(ğ‘¡) =
ğ‘¡ âˆ’ ğ¸, (12) also implies that ğ¶(ğ‘¡) âŸ‚âŸ‚ {ğ‘‹, ğ´, ğ‘‡ , ğ‘Œ , Ì„ğ¿(ğ‘‡ )}. We discuss weakening these assumptions in Section 7. We also require
that pr{ğ¶(ğ‘¡) > î‰€ğ¹ } > 0, so that there is positive probability of seeing subjects for whom the ï¬nal outcome has been ascertained
at an interim analysis at ğ‘¡ and so that the ï¬rst interim analysis must occur at least î‰€ğ¹ time units after the start of the trial.

We ï¬rst summarize the theoretical underpinnings of the practical, more eï¬ƒcient interim monitoring approach we propose in
Section 4. Under the above assumptions, if ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) is the inï¬‚uence function of a given estimator for a treatment eï¬€ect
parameter ğ›½ in a model for (ğ‘Œ , ğ´, ğ‘‹) as in Section 2.1, so based on the full data (10), then semiparametric theory yields that
inï¬‚uence functions for estimators for ğ›½ based on the available data îˆ»(ğ‘¡) in (11) at an interim analysis at time ğ‘¡ are of the form

ğ¼(ğ¸ â‰¤ ğ‘¡)
pr(ğ¸ â‰¤ ğ‘¡)

Î”(ğ‘¡)ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
îˆ·ğ‘¡{ğ‘ˆ (ğ‘¡)}

ğ‘¡

+

âˆ«
0

ğ‘‘ğ‘€ (ğ‘¡)

ğ‘ (ğ‘¢)ğœ‡(ğ‘š, ğ‘¢; ğ›¼0, ğ›½0)

îˆ·ğ‘¡(ğ‘¢)

â›
âœ
âœ
âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ (ğ‘‹) +
â

ğ‘¡

âˆ«
0

ğ‘‘ğ‘€ (ğ‘¡)

ğ‘ (ğ‘¢)

â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} âˆ’ ğœ‡(â„, ğ‘¢)

,

[

]â
âŸ
âŸ
â 

(13)

6

TSIATIS and DAVIDIAN

where ğ‘“ (ğ‘‹) is an arbitrary function of ğ‘‹; â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} is an arbitrary function of ğ‘¢, ğ‘‹, ğ´, and Ì„ğ¿(ğ‘¢); and

ğœ‡(ğ‘š, ğ‘¢; ğ›¼0, ğ›½0) = ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

ğ‘‡ â‰¥ ğ‘¢},

ğœ‡(â„, ğ‘¢) = ğ¸

â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

ğ‘‡ â‰¥ ğ‘¢

,

îˆ·ğ‘¡(ğ‘¢) = pr{ğ¶(ğ‘¡) â‰¥ ğ‘¢
ğ‘ (ğ‘¢) = ğ‘‘ğ‘ (ğ‘¡)

ğ¸ â‰¤ ğ‘¡},
ğ‘ (ğ‘¢)î‰… (ğ‘¡)(ğ‘¢), ğ‘ (ğ‘¡)

ğ‘ (ğ‘¢)âˆ’ğ‘‘Î›(ğ‘¡)

ğ‘‘ğ‘€ (ğ‘¡)
Here, îˆ·ğ‘¡(ğ‘¢) is the survival distribution for the censoring variable ğ¶(ğ‘¡) at the time of the interim analysis, ğ‘ (ğ‘¡)
the censoring counting process and at-risk process, and Î›(ğ‘¡)

ğ‘ (ğ‘¢) = ğ¼{ğ‘ˆ (ğ‘¡) â‰¤ ğ‘¢, Î”(ğ‘¡) = 0}, î‰… (ğ‘¡)(ğ‘¢) = ğ¼{ğ‘ˆ (ğ‘¡) â‰¥ ğ‘¢}, Î›(ğ‘¡)
|

ğ‘ (ğ‘¢) is the cumulative hazard function for censoring.

[

|

ğ‘ (ğ‘¢) = âˆ’ log{îˆ·ğ‘¡(ğ‘¢)}.
|
ğ‘ (ğ‘¢) and î‰… (ğ‘¡)(ğ‘¢) are

]

Let Ì‚îˆ·ğ‘¡(ğ‘¢) be the Kaplan-Meier estimator for îˆ·ğ‘¡(ğ‘¢) using the data {ğ‘ˆğ‘–(ğ‘¡), 1 âˆ’ Î”ğ‘–(ğ‘¡)} for ğ‘– such that ğ¸ğ‘– â‰¤ ğ‘¡, and deï¬ne Ì‚Î›(ğ‘¡)

ğ‘ (ğ‘¢) =
ğ‘›
âˆ’ log{ Ì‚îˆ·ğ‘¡(ğ‘¢)}, ğ‘‘ Ì‚ğ‘€ (ğ‘¡)
ğ‘–=1 ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)ğ´ğ‘–âˆ•ğ‘›(ğ‘¡), the proportion of enrolled subjects at ğ‘¡
assigned to active treatment. Then it can be shown that estimating equations corresponding to the inï¬‚uence functions in (13)
based on the available data (11) yielding estimators for ğ›½ are of the form

ğ‘ğ‘– (ğ‘¢) = ğ‘‘ğ‘ (ğ‘¡)

ğ‘– (ğ‘¢), and Ì‚ğœ‹ğ‘¡ =

ğ‘ğ‘– (ğ‘¢) âˆ’ ğ‘‘ Ì‚Î›(ğ‘¡)

ğ‘ (ğ‘¢)î‰… (ğ‘¡)

âˆ‘

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ‘›

ğ‘–=1
âˆ‘

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), ğ›½}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡)}

âˆ’ (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)ğ‘“ (ğ‘‹ğ‘–) +

ğ‘¡

âˆ«
0

â¡
â¢
â¢
â£

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢)â„{ğ‘¢, ğ‘‹ğ‘–, ğ´ğ‘–, Ì„ğ¿ğ‘–(ğ‘¢)}
â¤
â¥
â¥
â¦

= 0,

(14)

where Ì‚ğ›¼(ğ‘¡) is a consistent estimator for ğ›¼ based on the available data at ğ‘¡. For a speciï¬c model, corresponding full data inï¬‚uence
function ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0), and choice of the functions ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}, to be discussed momentarily, an estimator
for ğ›½ based on the data available at interim analysis time ğ‘¡ is the solution to (14).

Taking ğ‘“ (ğ‘‹) â‰¡ 0 and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} â‰¡ 0 in (14) yields the estimating equation

ğ‘›

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ‘–=1
âˆ‘

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), ğ›½}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡)}

]

[

= 0,

(15)

whose solution is a so-called inverse probability weighted complete case (IPWCC) estimator, which eï¬€ectively bases estima-
tion of ğ›½ on only subjects for whom ğ‘Œ is available at ğ‘¡, but with inverse weighting by the censoring distribution â€œadjustingâ€
appropriately for the lag time in ascertaining the outcome. Judicious nonzero choices of ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} facilitate
exploiting baseline and time-dependent covariate information to gain eï¬ƒciency over the IPWCC estimator solving (15) through
the two rightmost â€œaugmentationâ€ terms in the bracketed expression in (14), leading to what is referred to as an augmented
inverse probability weighted complete case (AIPWCC) estimator for ğ›½; the optimal such choices are discussed below.

A counterintuitive result from semiparametric theory is that, for any arbitrary ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}, it is possible to
improve the precision of the above estimators by replacing the Kaplan-Meier estimator Ì‚îˆ·ğ‘¡(ğ‘¢) by treatment-speciï¬c Kaplan-
Meier estimators Ì‚îˆ·ğ‘¡(ğ‘¢, ğ‘), say, obtained using the data {ğ‘ˆğ‘–(ğ‘¡), 1 âˆ’ Î”ğ‘–(ğ‘¡)} for ğ‘– such that ğ¸ğ‘– â‰¤ ğ‘¡ and ğ´ğ‘– = ğ‘, ğ‘ = 0, 1, even though
because of (12) the distribution of ğ¶(ğ‘¡) is not treatment dependent. This substitution leads to inï¬‚uence functions for estimators
for ğ›½ based on the available data of the form

ğ¼(ğ¸ â‰¤ ğ‘¡)
pr(ğ¸ â‰¤ ğ‘¡)

Î”(ğ‘¡)ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
îˆ·ğ‘¡{ğ‘ˆ (ğ‘¡), ğ´}

â›
âœ
âœ
âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ (ğ‘‹) +
â

ğ‘¡

âˆ«
0

ğ‘¡

+

âˆ«
0

ğ‘‘ğ‘€ (ğ‘¡)

ğ‘ (ğ‘¢, ğ´)ğœ‡(ğ‘š, ğ‘¢, ğ´; ğ›¼0, ğ›½0)

îˆ·ğ‘¡(ğ‘¢, ğ´)

(16)

ğ‘‘ğ‘€ (ğ‘¡)

ğ‘ (ğ‘¢, ğ´)

â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} âˆ’ ğœ‡(â„, ğ‘¢, ğ´)

,

ğ¸ â‰¤ ğ‘¡, ğ´}, ğœ‡(ğ‘š, ğ‘¢, ğ´; ğ›¼0, ğ›½0) = ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹ğ›¼0, ğ›½0)
ğ‘ (ğ‘¢, ğ´)î‰… (ğ‘¡)(ğ‘¢), Î›(ğ‘¡)
ğ‘ (ğ‘¢) âˆ’ ğ‘‘Î›(ğ‘¡)
ğ‘‘ğ‘€ (ğ‘¡)

ğ‘ (ğ‘¢, ğ´) = ğ‘‘ğ‘ (ğ‘¡)

[

]â
âŸ
âŸ
â 

ğ‘‡ â‰¥ ğ‘¢, ğ´}, ğœ‡(â„, ğ‘¢, ğ´) = ğ¸

ğ‘ (ğ‘¢, ğ´) = âˆ’ log{îˆ·ğ‘¡(ğ‘¢, ğ´)}.

|

â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

ğ‘‡ â‰¥ ğ‘¢, ğ´

,

[

]

|

âˆ’ (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)ğ‘“ (ğ‘‹ğ‘–) +

ğ‘¡

âˆ«
0

ğ‘ğ‘– (ğ‘¢, ğ‘) = ğ‘‘ğ‘ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢) âˆ’ ğ‘‘ Ì‚Î›(ğ‘¡)

ğ‘ (ğ‘¢, ğ‘)î‰… (ğ‘¡)

ğ‘– (ğ‘¢). The estimating equations (17) with

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢, ğ´ğ‘–)â„{ğ‘¢, ğ‘‹ğ‘–, ğ´ğ‘–, Ì„ğ¿ğ‘–(ğ‘¢)}
â¤
â¥
â¥
â¦

= 0,

(17)

ğ‘›

ğ‘–=1
âˆ‘

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), ğ›½}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

]

[

= 0,

(18)

where now

îˆ·ğ‘¡(ğ‘¢, ğ´) = pr{ğ¶(ğ‘¡) â‰¥ ğ‘¢

Estimating equations corresponding to (16) are then

|

ğ‘›

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), ğ›½}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

ğ‘–=1
âˆ‘
ğ‘ (ğ‘¢, ğ‘) = âˆ’ log{ Ì‚îˆ·ğ‘¡(ğ‘¢, ğ‘)}; and ğ‘‘ Ì‚ğ‘€ (ğ‘¡)
where now Ì‚Î›(ğ‘¡)
ğ‘“ (ğ‘‹) â‰¡ 0 and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} â‰¡ 0,

â¡
â¢
â¢
â£

îˆ·ğ‘¡(ğ‘¢)
|

|

TSIATIS and DAVIDIAN

7

yield an IPWCC estimator, and, again, nonzero choices of ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} lead to an AIPWCC estimator.

When ğ‘Œ is a binary outcome, as in study A5401, it can be shown that the IPWCC estimator Ì‚ğ›½(ğ‘¡) solving (18) is algebraically
identical to the logarithm of the ratio of treatment-speciï¬c Kaplan-Meier estimators for the probability of death or hospitalization
at î‰€ğ¹ days. Thus, as noted in Section 1, the standard estimator for the risk ratio at an interim analysis is a special case of the
general formulation here. Moreover, because this estimator is equivalent to an IPWCC estimator, it should be possible to obtain
more eï¬ƒcient inference on the risk ratio at an interim analysis via an AIPWCC estimator.

Semiparametric theory provides the optimal choices of ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} yielding the most precise AIPWCC

estimator solving either of (14) or (17), given by

ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) = ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

ğ‘‹, ğ´ = 1) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

ğ‘‹, ğ´ = 0),

â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} =

|

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

ğ‘‡ â‰¥ ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

.

(19)

The conditional expectations in (19) are not likely to be known in practice. We propose an approach to approximating ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)
and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} in Section 4. We recommend estimating ğ›½ at an interim analysis at time ğ‘¡ by Ì‚ğ›½(ğ‘¡) solving an estimating
equation of the form (17) with the approximations for ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} substituted.

From semiparametric theory, estimators solving estimating equations of the form (14) or (17) are consistent for ğ›½0 (for ğ‘›(ğ‘¡)
and ğ‘› large) and asymptotically normal, where, as at the end of Section 2.1, the variance of the large sample distribution of
Ì‚ğ›½(ğ‘¡) can be obtained from the variance of the corresponding inï¬‚uence function. Thus, the resulting approximate standard errors
ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)} can be used to form a Wald-type test statistic, ğ‘‡ (ğ‘¡) = Ì‚ğ›½(ğ‘¡)âˆ•ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)} appropriate for addressing the null hypothesis
of no treatment eï¬€ect, H0âˆ¶ ğ›½0 = 0.

We conclude this section by noting an important implication of these results. In the case where the full data (10) are available,
as would be the case at the conclusion of the trial if not stopped early, the preceding developments lead to covariate-adjusted
estimators for ğ›½ based on the full data that have the potential to yield increased eï¬ƒciency over the usual full data analyses outlined
in Section 2.1. In particular, considering (17), if ğ‘¡ğ‘’ğ‘›ğ‘‘ is the calendar time at which the trial concludes with the full data accrued
(ğ‘¢, ğ´ğ‘–) = 0,
and outcomes for all subjects ascertained, ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡ğ‘’ğ‘›ğ‘‘) = 1, Î”ğ‘–(ğ‘¡ğ‘’ğ‘›ğ‘‘) = 1, îˆ·ğ‘¡ğ‘’ğ‘›ğ‘‘
ğ‘– = 1, â€¦ , ğ‘›, and (17) becomes

{ğ‘ˆğ‘–(ğ‘¡ğ‘’ğ‘›ğ‘‘), ğ´ğ‘–} = 1, and ğ‘‘ Ì‚ğ‘€ (ğ‘¡ğ‘’ğ‘›ğ‘‘ )

ğ‘ğ‘–

ğ‘›

ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡ğ‘’ğ‘›ğ‘‘), ğ›½} âˆ’ (ğ´ğ‘– âˆ’ Ì‚ğœ‹)ğ‘“ (ğ‘‹ğ‘–)

= 0,

where Ì‚ğœ‹ = ğ‘›âˆ’1

ğ‘–=1
âˆ‘
[
ğ‘›
ğ‘–=1 ğ´ğ‘–, with corresponding inï¬‚uence function

]

âˆ‘

ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ (ğ‘‹).

(20)

(21)

As above, the optimal choice of ğ‘“ (ğ‘‹) leading to the most precise estimator solving (20) is that given in (19). The estimating
equation (20) is of the form of those in Zhang et al. 15. Thus, the proposed approach leads naturally to estimators for a ï¬nal
analysis that exploit baseline covariate information to improve eï¬ƒciency through the â€œaugmentation termâ€ (ğ´ âˆ’ ğœ‹)ğ‘“ (ğ‘‹).

3.2

Interim analysis

In practice, interim analyses will be carried out at times ğ‘¡1 < â‹¯ < ğ‘¡ğ¾ , with the possibility of stopping the trial early, e.g., for
eï¬ƒcacy if evidence of a large treatment eï¬€ect emerges at an interim analysis. That is, focusing on eï¬ƒcacy, the trial may be
stopped at the ï¬rst interim analysis time at which the relevant test statistic exceeds some appropriate stopping boundary; that is, if

ğ‘‡ (ğ‘¡ğ‘—)

â‰¥ ğ‘ğ‘—,

ğ‘— = 1, â€¦ , ğ¾,

|

|

for a two-sided alternative or ğ‘‡ (ğ‘¡ğ‘—) â‰¥ or â‰¤ ğ‘ğ‘—, ğ‘— = 1, â€¦ , ğ¾, for a one-sided alternative, where ğ‘ğ‘—, ğ‘— = 1, â€¦ , ğ¾, are the
stopping boundaries. As is well-studied in the group sequential testing literature, the stopping boundaries ğ‘1, â€¦ , ğ‘ğ¾ are chosen
to take into account multiple comparisons and ensure that the resulting procedure preserves the desired overall type 1 error 1,2,3,9.
Standard methods 2,3,9 for deriving stopping boundaries are based on the premise that the sequentially-computed test statistics
ğ‘‡ (ğ‘¡1), â€¦ , ğ‘‡ (ğ‘¡ğ¾ ) have the so-called independent increments structure 8,16.

In the Appendix, we sketch an argument demonstrating that, with the optimal choices of ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} given in
(19), the proposed test statistics, properly normalized, have the independent increments structure. Owing to this property, the
practical strategies for interim monitoring presented in Section 4 can be implemented using standard software for computation
of stopping boundaries; in the simulations in Section 5, we use the R package ldbounds 17.

8

4

PRACTICAL IMPLEMENTATION AND INTERIM MONITORING STRATEGIES

TSIATIS and DAVIDIAN

4.1

Treatment eï¬€ect estimation

Generalizing the approach in Tsiatis et al. 10 in the special case of a proportional odds model (2), we propose estimation of ğ›½ at
an interim analysis at time ğ‘¡ using an AIPWCC estimator solving (17), which can be obtained via a two-step algorithm.

Assume that the treatment eï¬€ect ğ›½ of interest is deï¬ned within a model for which, given full data at the end of the study, the
estimator for ğ›½ would be obtained jointly with that for ğ›¼ by solving an estimating equation of the form in (4) for a particular
estimating function îˆ¹(ğ‘Œ , ğ´, ğ‘‹; ğ›¼, ğ›½). Because the optimal choices ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} in (19) are not known, we
approximate them by linear combinations of basis functions. Letting ğ‘“0(ğ‘‹), ğ‘“1(ğ‘‹), â€¦ , ğ‘“ğ‘€ (ğ‘‹) be functions of ğ‘‹ speciï¬ed by
the analyst, with ğ‘“0(ğ‘‹) â‰¡ 1, approximate ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) by

ğ‘€

ğœ“ğ‘šğ‘“ğ‘š(ğ‘‹).

(22)

Similarly, specify basis functions of {ğ‘¢, ğ‘‹, Ì„ğ¿(ğ‘¢)}, â„1{ğ‘¢, ğ‘‹, Ì„ğ¿(ğ‘¢)}, â€¦ , â„ğ¿{ğ‘¢, ğ‘‹, Ì„ğ¿(ğ‘¢)}, and approximate â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ‘, Ì„ğ¿(ğ‘¢)} by

ğ‘š=0
âˆ‘

ğ¿

ğœ™ğ‘,ğ“â„ğ“{ğ‘¢, ğ‘‹, Ì„ğ¿(ğ‘¢)},

ğ‘ = 0, 1.

(23)

With suitably chosen basis functions, experience in other contexts 6,10,15 suggests that this approach can lead to AIPWCC
estimators that achieve substantial eï¬ƒciency gains over IPWCC estimators.

ğ“=1
âˆ‘

The AIPWCC estimator for ğ›½ obtained by substituting (22) and (23) in (17) has inï¬‚uence function (16) with these same sub-
stitutions. Because from semiparametric theory the variance of the estimator depends on the variance of the inï¬‚uence function,
as at the end of Section 2.1, we ï¬nd the coeï¬ƒcients ğœ“ğ‘š, ğ‘š = 1, â€¦ , ğ‘€, and ğœ™ğ‘,ğ“, ğ“ = 1, â€¦ , ğ¿, ğ‘ = 0, 1, that minimize this
variance, which, from the form of (16), is a least squares problem, as detailed below.

With these considerations, the two-step algorithm is as follows. At an interim analysis at time ğ‘¡:

Step 1. Estimate ğ›¼ and ğ›½ by solving jointly in ğ›¼ and ğ›½

ğ‘›

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ‘–=1
âˆ‘

Î”ğ‘–(ğ‘¡)îˆ¹(ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; ğ›¼, ğ›½)
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

[

]

= 0

to obtain Ì‚ğ›¼(ğ‘¡) and Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡); Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡) is an IPWCC estimator solving (18). Then obtain an estimator Ì‚îˆ³{Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)} for îˆ³(ğ›¼, ğ›½). If
the expectation in (7) is analytically tractable, Ì‚îˆ³{Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)} is the last row of (7) with Ì‚ğ›¼(ğ‘¡) and Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡) substituted for ğ›¼ and ğ›½;
if not, take the estimator Ì‚îˆ³{Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)} to be the last row of

ğ‘›

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

Î”ğ‘–(ğ‘¡)
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

ğœ•îˆ¹(ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; ğ›¼, ğ›½)
ğœ•ğ›¼ğ‘‡ ğœ•ğ›½

âˆ’

ğ‘›(ğ‘¡)âˆ’1

[

ğ‘–=1
âˆ‘

For each subject ğ‘– for whom ğ¸ğ‘– â‰¤ ğ‘¡, based on (8), construct

âˆ’1

.

ğ›¼=Ì‚ğ›¼(ğ‘¡),ğ›½= Ì‚ğ›½ ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)]
|
|
|
|

ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)} = Ì‚îˆ³{Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}îˆ¹{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}.

Step 2. Estimate the coeï¬ƒcients ğœ“ğ‘š, ğ‘š = 1, â€¦ , ğ‘€, and ğœ™ğ‘,ğ“, ğ“ = 1, â€¦ , ğ¿, ğ‘ = 0, 1, in the approximations (22) and (23) by
â€œleast squares,â€ as suggested above. Namely, for each subject ğ‘– for whom ğ¸ğ‘– â‰¤ ğ‘¡, deï¬ne the â€œdependent variableâ€

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}
where, in the integrand in the second term of the above expression, for ğ´ğ‘– = ğ‘, ğ‘ = 0, 1,

Ì‚ğ”œğ‘–(ğ‘¡) =

âˆ«
0

+

Ì‚îˆ·ğ‘¡(ğ‘¢, ğ´ğ‘–)

ğ‘¡

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢, ğ´ğ‘–)Ì‚ğœ‡{ğ‘š, ğ‘¢, ğ´ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}

,

Ì‚ğœ‡{ğ‘š, ğ‘¢, ğ‘; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}
Ì‚îˆ·ğ‘¡(ğ‘¢, ğ‘)

=

ğ‘›

{

ğ‘˜=1
âˆ‘
ğ‘›

Ã—

ğ¼(ğ¸ğ‘˜ â‰¤ ğ‘¡)î‰… (ğ‘¡)

ğ‘˜ (ğ‘¢)ğ¼(ğ´ğ‘˜ = ğ‘)

âˆ’1

}

ğ¼(ğ¸ğ‘˜ â‰¤ ğ‘¡)Î”ğ‘˜(ğ‘¡)ğ‘š{ğ‘Œğ‘˜, ğ´ğ‘˜, ğ‘‹ğ‘˜; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡)}
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘˜(ğ‘¡), ğ‘}

î‰… (ğ‘¡)

ğ‘˜ (ğ‘¢)ğ¼(ğ´ğ‘˜ = ğ‘)

.

}

ğ‘˜=1 {
âˆ‘

TSIATIS and DAVIDIAN

9

Likewise, for each of these subjects and suitably chosen basis functions as discussed above, deï¬ne the ğ‘€ + 1 + 2ğ¿ â€œcovariatesâ€

(ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)ğ‘“ğ‘š(ğ‘‹ğ‘–), ğ‘š = 0, 1, â€¦ , ğ‘€;

ğ¼(ğ´ğ‘– = 0)

ğ¼(ğ´ğ‘– = 1)

ğ‘¡

ğ‘¡

âˆ«
0

âˆ«
0

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢, 0)

â„ğ“{ğ‘¢, ğ‘‹ğ‘–, Ì„ğ¿ğ‘–(ğ‘¢)} âˆ’ Ì‚ğœ‡(â„ğ“, ğ‘¢, 0)

,

ğ“ = 1, â€¦ , ğ¿,

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢, 1)

[

[

]

â„ğ“{ğ‘¢, ğ‘‹ğ‘–, Ì„ğ¿ğ‘–(ğ‘¢)} âˆ’ Ì‚ğœ‡(â„ğ“, ğ‘¢, 1)

,

ğ“ = 1, â€¦ , ğ¿,

]

ğ‘›

âˆ’1 ğ‘›

where, for ğ‘ = 0, 1

Ì‚ğœ‡(â„ğ“, ğ‘¢, ğ‘) =

{

ğ¼(ğ¸ğ‘˜ â‰¤ ğ‘¡)î‰… (ğ‘¡)

ğ‘˜ (ğ‘¢)ğ¼(ğ´ğ‘˜ = ğ‘)

}

â„ğ“{ğ‘¢, ğ‘‹ğ‘˜, Ì„ğ¿ğ‘˜(ğ‘¢)}î‰… (ğ‘¡)

ğ‘˜ (ğ‘¢)ğ¼(ğ´ğ‘˜ = ğ‘).

ğ‘˜=1
âˆ‘

Then obtain estimators Ì‚ğœ“ğ‘š, ğ‘š = 0, 1, â€¦ , ğ‘€, and Ì‚ğœ™ğ‘,ğ“, ğ“ = 1, â€¦ , ğ¿, ğ‘ = 0, 1, by linear regression of Ì‚ğ”œğ‘–(ğ‘¡) on the above
covariates. Based on this regression, obtain â€œpredicted valuesâ€ for each subject ğ‘– for whom ğ¸ğ‘– â‰¤ ğ‘¡ as

ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘ğ‘– = (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)

Ì‚ğœ“ğ‘šğ‘“ğ‘š(ğ‘‹ğ‘–) +

ğ‘€

ğ‘¡

âˆ«
0

ğ‘‘ Ì‚ğ‘€ (ğ‘¡)

ğ‘ğ‘– (ğ‘¢, ğ´ğ‘–)

ğ¿

ğ“=1
âˆ‘

Ì‚ğœ™ğ´ğ‘–,ğ“

â„ğ“{ğ‘¢, ğ‘‹ğ‘–, Ì„ğ¿ğ‘–(ğ‘¢)} âˆ’ Ì‚ğœ‡(â„ğ“, ğ‘¢, ğ´ğ‘–)

.

[

]

The estimator for ğ›½ is then obtained as the one-step update

ğ‘˜=1
âˆ‘

ğ‘š=0
âˆ‘

(24)

(25)

and an approximate standard error for Ì‚ğ›½(ğ‘¡) is given by

ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)} = ğ‘›(ğ‘¡)âˆ’1

ğ‘›

Ì‚ğ›½(ğ‘¡) = Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡) âˆ’ ğ‘›(ğ‘¡)âˆ’1

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘ğ‘–,

ğ‘›

ğ‘–=1
âˆ‘

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡){ Ì‚ğ”œğ‘–(ğ‘¡) âˆ’ ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘ğ‘–}2

1âˆ•2

.

]

[

ğ‘–=1
âˆ‘

By an argument similar to that in the Supplementary Material of Tsiatis et al. 10, the estimator (24) is asymptotically equivalent
to an AIPWCC estimator solving (17).

In some settings, scant time-dependent covariate information may be available. Here, a special case of the general AIPWCC
formulation that still attempts to gain eï¬ƒciency from only baseline covariates ğ‘‹ is to solve an estimating equation of the form in
(17) but with ğ‘“ (ğ‘‹) as in (19) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} = 0. Implementation is as above, but with the â€œdependent variableâ€ in Step
2 regressed only on the ğ‘€ + 1 â€œcovariatesâ€ (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)ğ‘“ğ‘š(ğ‘‹ğ‘–), ğ‘š = 0, 1, â€¦ , ğ‘€, to obtain estimators Ì‚ğœ“ğ‘š, ğ‘š = 0, 1, â€¦ , ğ‘€, and by
ğ‘€
ğ‘š=0 Ì‚ğœ“ğ‘šğ‘“ğ‘š(ğ‘‹ğ‘–) in the one-step update (24) and its associated standard error (25). For deï¬niteness,
redeï¬ning ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘ğ‘– = (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)
we refer to the resulting estimator as â€œAIPW1â€ and that incorporating time-dependent covariates above as â€œAIPW2.â€

âˆ‘

4.2

Interim analysis

There is a vast literature on early stopping of clinical trials using group sequential and other methods; such methods are readily
applied if the independent increments property holds. We now discuss information-based and ï¬xed-sample size monitoring
strategies for using these approaches with the proposed treatment eï¬€ect estimators, for which, as argued in the Appendix and
demonstrated empirically in Section 5, the independent increments property holds exactly or approximately.

In the general information-based monitoring approach 1, monitoring and group sequential tests are based on the proportion
of the total information to be gained from the completed trial available at interim analysis times ğ‘¡, where in the present context
information is approximated at time ğ‘¡ using the large-sample approximate standard error of the relevant estimator Ì‚ğ›½(ğ‘¡), ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}.
If a group sequential test is desired with type 1 error ğ›¼ for testing H0âˆ¶ ğ›½0 = 0 and power (1 âˆ’ ğ›¾) against a clinically meaningful
alternative value ğ›½0 = ğ›½ğ´, say, then the maximum information ğ‘€ğ¼ required to achieve this objective at the ï¬nal analysis with a
two-sided test is

ğ‘§ğ›¼âˆ•2 + ğ‘§ğ›¾
ğ›½ğ´
where ğ‘§ğ›¿ is the (1 âˆ’ ğ›¿) quantile of the standard normal distribution, and ğ¼ğ¹ is an inï¬‚ation factor to account for the loss of power
that results due to repeated testing relative to doing a single ï¬nal analysis. For example, the inï¬‚ation factor associated with using

ğ‘€ğ¼ =

ğ¼ğ¹ ,

)

(

2

10

TSIATIS and DAVIDIAN

Oâ€™Brien-Fleming stopping boundaries 3 is modest, equal to about 1.03; see Tsiatis 1. Information at an interim analysis at time ğ‘¡
is approximated as

Inf(ğ‘¡) =

ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}

âˆ’2.

Thus, the proportion of information at interim analysis time ğ‘¡ is approximated as

[
ğ‘(ğ‘¡) =

]

Inf(ğ‘¡)
ğ‘€ğ¼

.

(26)

Given the proportion of information (26) together with, e.g., the Lan-DeMets spending function 9, standard software can be used
to obtain stopping boundaries such that the resulting group sequential testing procedure has the desired operating characteristics.
Typically, in determining the overall sample size for a clinical trial to achieve the desired power to detect a meaningful
diï¬€erence at a given level of signiï¬cance, the analyst must make assumptions on the values of nuisance parameters. If these
assumptions are not correct, the trial could be underpowered. An oft-cited advantage of information-based monitoring is that
interim analyses would continue until the information Inf(ğ‘¡) achieves the maximum information ğ‘€ğ¼, guaranteeing the desired
operating characteristics regardless of the values of nuisance parameters. However, if the assumptions leading to the target
sample size are not correct, the information available at the time this planned sample size is reached and all participants have the
outcome ascertained may be less than ğ‘€ğ¼. If evidence emerges during the trial that ğ‘€ğ¼ is unlikely to be achieved, the sample
size might be reestimated and increased so that the full information threshold ğ‘€ğ¼ is met.

ğ‘›
ğ‘–=1 ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡) is the number of subjects who have enrolled by time ğ‘¡; of these subjects, ğ‘›ğ´(ğ‘¡) =

In many trials, however, resource constraints or other factors may make exceeding the originally planned sample size impos-
sible, thus rendering principled information-based monitoring infeasible. If a ï¬xed, maximum sample size ğ‘›ğ‘šğ‘ğ‘¥, say, is planned
and inalterable, then the proportion of information available at an interim analysis at any time ğ‘¡ on which stopping boundaries
can be determined must instead be based on ğ‘›ğ‘šğ‘ğ‘¥. In terms of the data (11) available at an interim analysis at ğ‘¡, as before, ğ‘›(ğ‘¡) =
ğ‘›
ğ‘–=1 ğ¼{ğ¸ğ‘– â‰¤ ğ‘¡, ğ¶ğ‘–(ğ‘¡) â‰¥ î‰€ğ¹ } is
the number who have been enrolled for the maximum follow-up period and thus have the outcome ascertained with certainty,
âˆ‘
and it is likely that ğ‘›ğ´(ğ‘¡) < ğ‘›(ğ‘¡). In general, a typical interim analysis at ğ‘¡ for ï¬xed ğ‘›ğ‘šğ‘ğ‘¥ would be based only on the data from
these ğ‘›ğ´(ğ‘¡) subjects, and, accordingly, the proportion of information available at ğ‘¡ would be ğ‘(ğ‘¡) = ğ‘›ğ´(ğ‘¡)âˆ•ğ‘›ğ‘šğ‘ğ‘¥, with ğ‘(ğ‘¡) = 1 at
the ï¬nal analysis. However, here, the proposed IPWCC and AIPWCC estimators allow censoring due to the time lag in ascer-
taining the outcome to be taken into account and incorporation of covariates to increase eï¬ƒciency, so make use of additional
information in (11) beyond that available on just the ğ‘›ğ´(ğ‘¡) subjects for whom the outcome has been ascertained by time ğ‘¡. Thus,
if monitoring is based on test statistics constructed from these estimators, the proportion of information available at ğ‘¡ should be
between ğ‘›ğ´(ğ‘¡)âˆ•ğ‘›ğ‘šğ‘ğ‘¥ and ğ‘›(ğ‘¡)âˆ•ğ‘›ğ‘šğ‘ğ‘¥.

âˆ‘

With these considerations, for ï¬xed-sample size monitoring, we propose characterizing the proportion of information available
at an interim analysis at time ğ‘¡ in terms of what we refer to as the eï¬€ective sample size ğ‘›ğ¸ğ‘†ğ‘†(ğ‘¡), say, at ğ‘¡. Intuitively, we deï¬ne
ğ‘›ğ¸ğ‘†ğ‘†(ğ‘¡) to be the number of participants, had they been enrolled for the maximum follow-up period î‰€ğ¹ and had their outcome
ascertained with certainty, that would be required to lead to an estimator for ğ›½ based only on data from such subjects with the
same precision as that achieved by an IPWCC or AIPWCC estimator for ğ›½ based on all of the available data at ğ‘¡. The proportion
of information at ğ‘¡ would then be ğ‘›ğ¸ğ‘†ğ‘†(ğ‘¡)âˆ•ğ‘›ğ‘šğ‘ğ‘¥.

To deï¬ne eï¬€ective sample size formally, with ğ‘›âˆ— subjects for whom the outcome has been fully ascertained, indexed by
ğ‘— = 1, â€¦ , ğ‘›âˆ—, consider the estimator Ì‚ğ›½âˆ— obtained by solving in ğ›½ the full data estimating equation (9) based on these ğ‘›âˆ— subjects,

ğ‘›âˆ—

ğ‘š(ğ‘Œğ‘—, ğ´ğ‘—, ğ‘‹ğ‘—; Ì‚ğ›¼, ğ›½) = 0

for some consistent estimator Ì‚ğ›¼. Then from the semiparametric theory, Ì‚ğ›½âˆ— has standard error approximately equal to the square
root of var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)}âˆ•ğ‘›âˆ—. The eï¬€ective sample size at an interim analysis at time ğ‘¡ for the IPWCC estimator Ì‚ğ›½(ğ‘¡)
calculated using the available data (11) at ğ‘¡ is the value ğ‘›âˆ— such that var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)}âˆ•ğ‘›âˆ— = ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}2. Accordingly,
deï¬ne the eï¬€ective sample size when monitoring is based on the IPWCC estimator as

ğ‘—=1
âˆ‘

ğ‘›ğ¸ğ‘†ğ‘† (ğ‘¡) =

var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}2

.

(27)

Because var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)} is not known, in practice we must estimate it based on the available data, which can be
accomplished via the estimator

Ì‚var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)} = ğ‘›(ğ‘¡)âˆ’1

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ‘›

ğ‘–=1
âˆ‘

Î”ğ‘–(ğ‘¡)ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½(ğ‘¡)}2
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

.

(28)

TSIATIS and DAVIDIAN

Thus, in practice, we obtain the approximate eï¬€ective sample size as

ğ‘›ğ¸ğ‘†ğ‘† (ğ‘¡) =

Ì‚var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)}
ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}2

.

11

(29)

The eï¬€ective sample size for an AIPWCC estimator Ì‚ğ›½(ğ‘¡) (either AIPW1 or AIPW2) calculated using the available data at ğ‘¡
via the two-step algorithm is deï¬ned similarly, but with the full data inï¬‚uence function ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) in (27) replaced by
the inï¬‚uence function ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) as in (21). An estimator for var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
based on the available data is given by

ğ‘–=1
âˆ‘

ğ‘š=0
âˆ‘

Ì‚var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)} = ğ‘›(ğ‘¡)âˆ’1

ğ¼(ğ¸ğ‘– â‰¤ ğ‘¡)

ğ‘›

Î”ğ‘–(ğ‘¡)[ğ‘š{ğ‘Œğ‘–, ğ´ğ‘–, ğ‘‹ğ‘–; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½(ğ‘¡)} âˆ’ ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘âˆ—
Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}

ğ‘– ]2

,

ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘âˆ—

ğ‘– = (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)

Ì‚ğœ“ğ‘šğ‘“ğ‘š(ğ‘‹ğ‘–),

ğ‘€

(30)
where now the â€œpredicted valuesâ€ ğ‘ƒ ğ‘Ÿğ‘’ğ‘‘âˆ—
ğ‘– are obtained by a weighted least squares regression with â€œdependent variableâ€
ğ‘š{ğ‘Œ , ğ´, ğ‘‹; Ì‚ğ›¼(ğ‘¡), Ì‚ğ›½(ğ‘¡)}, â€œcovariatesâ€ (ğ´ğ‘– âˆ’ Ì‚ğœ‹ğ‘¡)ğ‘“ğ‘š(ğ‘‹ğ‘–), ğ‘š = 0, 1, â€¦ , ğ‘€, and â€œweightsâ€ Î”ğ‘–(ğ‘¡)âˆ• Ì‚îˆ·ğ‘¡{ğ‘ˆğ‘–(ğ‘¡), ğ´ğ‘–}. Thus, for Ì‚ğ›½(ğ‘¡) the
AIPW1 or AIPW2 estimator, ğ‘›ğ¸ğ‘†ğ‘†(ğ‘¡) is deï¬ned as in (29) with the numerator given by (30).

With the appropriate deï¬nition of ğ‘›ğ¸ğ‘†ğ‘† (ğ‘¡), we approximate the corresponding proportion of information available at ğ‘¡ with

interim analyses based on an IPWCC or AIPWCCC estimator as

ğ‘(ğ‘¡) =

ğ‘›ğ¸ğ‘†ğ‘†(ğ‘¡)
ğ‘›ğ‘šğ‘ğ‘¥

.

(31)

From (28) and (30), ğ‘(ğ‘¡) = 1 at the ï¬nal analysis. As for information-based monitoring, given the proportion of information
(31), one can use standard software with, e.g., the Lan-DeMets spending function 9 to obtain stopping boundaries.

In the simulation studies in the next section, we study the methods under ï¬xed-sample monitoring, as in our experience this
approach is most common in practice. Moreover, while performance of information-based monitoring with statistics that possess
the independent increments property has been well-studied 8,18, because our approach to characterizing proportion of information
in ï¬xed-sample monitoring based on the proposed eï¬€ective sample size measure is new, evaluation of its performance is required.

5

SIMULATION STUDIES

We present results from several simulation studies, each involving 10000 Monte Carlo replications. For each simulation scenario,
we considered a uniform enrollment process during the calendar time interval [0, ğ¸ğ‘šğ‘ğ‘¥] with a maximum, ï¬xed sample size ğ‘›ğ‘šğ‘ğ‘¥
and maximum follow up time î‰€ğ¹ , and ï¬xed-sample size monitoring with interim analyses planned at calendar times ğ‘¡1 < â‹¯ < ğ‘¡ğ¾
and a ï¬nal analysis at time ğ‘¡ğ‘’ğ‘›ğ‘‘ = ğ¸ğ‘šğ‘ğ‘¥ + î‰€ğ¹ = ğ‘¡ğ¾+1 > ğ‘¡ğ¾ , for a total of ğ¾ + 1 possible analyses. For simplicity, in each scenario,
we took ğ‘›ğ‘šğ‘ğ‘¥ to be the sample size required to achieve roughly 80% or 90% power for a single analysis at ğ‘¡ğ‘’ğ‘›ğ‘‘ and did not include
an inï¬‚ation factor 1. At each of the ğ¾ + 1 analysis times, we estimated the relevant treatment eï¬€ect parameter ğ›½ four ways:

i using the estimator Ì‚ğ›½î‰€ğ¹

(ğ‘¡ğ‘—) obtained by carrying out the full data analysis based only on subjects enrolled for at least the

maximum follow-up period î‰€ğ¹ , so using subjects ğ‘– for whom ğ¼{ğ¸ğ‘– â‰¤ ğ‘¡, ğ¶ğ‘–(ğ‘¡) â‰¥ î‰€ğ¹ } = 1;

ii using the IPWCC estimator Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘—) = Ì‚ğ›½ğ‘–ğ‘›ğ‘–ğ‘¡(ğ‘¡ğ‘—) based on the available data (11), obtained at Step 1 of the two-step algorithm;

iii using the AIPWCC estimator Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡ğ‘—) based on the available data (11), obtained at Step 2 of the two-step algorithm using

only baseline covariates ğ‘‹ to gain eï¬ƒciency, as at the end of Section 4.1;

iv using the AIPWCC estimator Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡ğ‘—) based on the available data (11) , obtained at Step 2 of the algorithm using both

baseline and time-dependent covariates ğ‘‹ and Ì„ğ¿(ğ‘¢).

At the ï¬nal analysis at time ğ‘¡ğ‘’ğ‘›ğ‘‘ at which the outcome has been ascertained on all ğ‘›ğ‘šğ‘ğ‘¥ subjects, Ì‚ğ›½î‰€ğ¹
(ğ‘¡ğ‘’ğ‘›ğ‘‘) and Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘’ğ‘›ğ‘‘) yield
(versions of) the intended full data analysis; and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡ğ‘’ğ‘›ğ‘‘) and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡ğ‘’ğ‘›ğ‘‘) are identical and yield the covariate-adjusted
analysis exploiting baseline covariate information discussed at the end of Section 3.1. In all scenarios, for the null hypothesis
H0âˆ¶ ğ›½0 = 0 and one-sided alternative hypotheses and level of signiï¬cance ğ›¼ = 0.025, we used the R package ldbounds 17 with
a Lan-DeMets spending function to compute both Oâ€™Brien-Fleming 3 and Pocock 2 stopping boundaries at each analysis time
ğ‘¡ğ‘—, ğ‘— = 1, â€¦ , ğ¾ + 1. For Ì‚ğ›½î‰€ğ¹
(ğ‘¡ğ‘—), this calculation was based on the proportion of information ğ‘(ğ‘¡ğ‘—) = ğ‘›ğ´(ğ‘¡ğ‘—)âˆ•ğ‘›ğ‘šğ‘ğ‘¥; for each of

12

TSIATIS and DAVIDIAN

the IPWCC and AIPWCC estimators Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘—), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡ğ‘—), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡ğ‘—), the stopping boundaries were obtained using the
approximate proportion of information (31) based on the relevant approximate eï¬€ective sample size ğ‘›ğ¸ğ‘†ğ‘† (ğ‘¡ğ‘—) given in (29).

For each scenario, we present the following results from two simulation studies, one under H0, so with data generated with

ğ›½0 = 0, and one under an alternative of interest ğ›½0 = ğ›½ğ´:

i for each estimator, Monte Carlo estimates of cov{ Ì‚ğ›½(ğ‘ ), Ì‚ğ›½(ğ‘¡)}, ğ‘  < ğ‘¡, and var{ Ì‚ğ›½(ğ‘¡)}, ğ‘ , ğ‘¡ âˆˆ {ğ‘¡1, â€¦ , ğ‘¡ğ¾ , ğ‘¡ğ‘’ğ‘›ğ‘‘}; if the independent

increments property holds, cov{ Ì‚ğ›½(ğ‘ ), Ì‚ğ›½(ğ‘¡)} = var{ Ì‚ğ›½(ğ‘¡)}, ğ‘  < ğ‘¡;

ii for each estimator at each ğ‘¡ âˆˆ {ğ‘¡1, â€¦ , ğ‘¡ğ¾ , ğ‘¡ğ‘’ğ‘›ğ‘‘}, Monte Carlo mean and standard deviation of Ì‚ğ›½(ğ‘¡), Monte Carlo mean of

ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}, and Monte Carlo mean square error (MSE) for Ì‚ğ›½î‰€ğ¹

(ğ‘¡) divided by that for Ì‚ğ›½(ğ‘¡);

iii for each estimator and stopping boundary, the Monte Carlo proportion of data sets for which H0 was rejected, Monte Carlo

estimate of expected sample size, and Monte Carlo estimate of expected stopping time.

|

|

The ï¬rst two simulation scenarios, demonstrating the methods for an ordinal categorical outcome and a binary outcome,
respectively, are based on the TESICO study with î‰€ğ¹ = 90 days, using the generative models adopted by Tsiatis et al. 10, with
ğ‘›ğ‘šğ‘ğ‘¥ = 602, ğ¸ğ‘šğ‘ğ‘¥ = 240 days, and ğ¾ = 4 interim analyses planned at calendar times (ğ‘¡1, â€¦ , ğ‘¡4) = (150, 195, 240, 285) days,
with the ï¬nal analysis at ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330 days. For each simulated subject, ğ´ was generated as Bernoulli with pr(ğ´ = 1) = ğœ‹ = 0.5,
where ğ‘ = 0 (1) corresponds to placebo (active agent). To produce data for which the proportional odds model (2) holds, we
generated Î¥ âˆ¼ ğ‘ˆ (0, 1) and set Î“ = (1 âˆ’ ğ´)Î¥ + ğ´Î¥(1âˆ•OR)âˆ•{1 âˆ’ Î¥ + Î¥(1âˆ•ğ‘’ğ›½)}, where as in (2) ğ›½ is the log odds ratio, so that
the distribution of Î“ given ğ´ = 1 satisï¬es logit{pr(Î“ â‰¤ ğ‘¢
ğ´ = 0)} + ğ›½. For ğ‘Œ an ordinal outcome,
ğ´ = 1)} = logit{pr(Î“ â‰¤ ğ‘¢
ğ´ = 0) = 0.12, 0.23, 0.17, 010, 0.05, 0.33 for ğ‘— = 1, â€¦ , 6 as in Table 1 of Tsiatis et al. 10 and thus generated
we took pr(ğ‘Œ = ğ‘—
ğ‘Œ according to in which interval Î“ fell as determined by the cutpoints [0.00, 0.12, 0.35, 0.52, 0.62, 0.67, 1.00]. Then if Î“ < 0.52,
so ğ‘Œ = 1, 2, or 3, we took the time in hospital to be ğ» = î‰€ğ¹ Î“âˆ•0.52 and the number of days at home and oï¬€ oxygen as î‰€ğ¹ âˆ’ ğ»,
and ğ‘‡ = î‰€ğ¹ . If 0.52 â‰¤ Î“ < 0.62 or 0.62 â‰¤ Î“ < 0.67, corresponding to ğ‘Œ = 4 or 5, again ğ‘‡ = î‰€ğ¹ ; if Î“ â‰¥ 0.67, corresponding to
death, time of death ğ‘‡ = (1 âˆ’ ğ´)ğ‘‡0 + ğ´ğ‘‡1, where ğ‘‡0 âˆ¼ ğ‘ˆ (0, 30) if ğ´ = 0 and ğ‘‡1 âˆ¼ ğ‘ˆ (20, 50) if ğ´ = 1. A baseline covariate was
generated as ğ‘‹ âˆ¼ îˆº {1.5(Î¥ âˆ’ 0.5), 1}, so that ğ‘‹ is independent of ğ´, correlated with ğ‘Œ , and does not aï¬€ect the proportional
odds model. Two time dependent covariates were generated as ğ¿1(ğ‘¢) = ğ¼(î‰ƒ < ğ‘¢), where î‰ƒ = ğ»ğ¼(Î“ < 0.52) + î‰€ğ¹ ğ¼(Î“ â‰¥ 0.52),
so that ğ¿1(ğ‘¢) = 1 if the subject was still in the hospital at time ğ‘¢; and ğ¿2(ğ‘¢) = (î‰€ğ¹ âˆ’î‰ƒ)ğ¿1(ğ‘¢), the number of days the subject was
expected to be out of the hospital at day î‰€ğ¹ , and ğ¿(ğ‘¢) = {ğ¿1(ğ‘¢), ğ¿2(ğ‘¢)}. For a scenario with binary outcome, we generated the
data according to the foregoing scheme, except that we deï¬ned ğ‘Œ = 1, corresponding to death, if Î“ â‰¥ 0.67, and ğ‘Œ = 0 otherwise.
For the ï¬rst scenario with ordinal categorical outcome, we generated data as above under the null hypothesis, so with ğ›½ =
ğ›½0 = 0, and ğ›½ = ğ›½ğ´ = log(1.5), corresponding to the alternative for which TESICO was powered (80% at the ï¬nal analysis
with ğ‘› = 602) 10, and Hğ´ âˆ¶ ğ›½0 > 0. Here, Ì‚ğ›½î‰€ğ¹
(ğ‘¡) is the ML estimator for ğ›½ in (2) obtained using the R function polr in the
MASS package 19. Following Tsiatis et al. 10, to simplify implementation, we constructed Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)
using the estimating function (6) with îˆ°(ğ´) = ğ·ğ‘‡ (ğ´; ğ›¼, ğ›½)ğ‘‰ âˆ’1
ğ‘–ğ‘›ğ‘‘ (ğ´; ğ›¼, ğ›½), where ğ‘‰ğ‘–ğ‘›ğ‘‘(ğ´; ğ›¼, ğ›½) is chosen according to the â€œworking
(ğ‘¡ğ‘’ğ‘›ğ‘‘) and Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘’ğ‘›ğ‘‘) are not identical. As shown by
independenceâ€ assumption, so that with full data at the ï¬nal analysis, Ì‚ğ›½î‰€ğ¹
Tsiatis et al. 10 and borne out in the simulations below, the eï¬ƒciency loss for Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘’ğ‘›ğ‘‘) relative to Ì‚ğ›½î‰€ğ¹

(ğ‘¡ğ‘’ğ‘›ğ‘‘) is negligible.

|

Under (a) the null hypothesis and (b) the alternative, the Monte Carlo sample covariance matrices of the 10000 estimates

{ Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡1), â€¦ , Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡4), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡ğ‘’ğ‘›ğ‘‘)} are

0.041 0.027 0.022 0.019 0.019
0.027 0.028 0.021 0.019 0.018
0.022 0.021 0.022 0.019 0.019
0.019 0.019 0.019 0.019 0.018
0.019 0.018 0.019 0.018 0.018

0.042 0.027 0.022 0.019 0.019
0.027 0.029 0.022 0.019 0.019
0.022 0.022 0.022 0.019 0.019
0.019 0.019 0.019 0.019 0.019
0.019 0.019 0.019 0.019 0.019

,

â
âŸ
âŸ
âŸ
âŸ
âŸ
â 

(b) â›
âœ
âœ
âœ
âœ
âœ
â

(a) â›
âœ
âœ
âœ
âœ
âœ
â

,

(32)

â
âŸ
âŸ
âŸ
âŸ
âŸ
â 

clearly demonstrating that the independent increments property holds approximately for this estimator. Analogous results for the
other three estimators are given in the Appendix, showing that the independent increments property holds approximately for all.
Under the null hypothesis and the alternative, Table 1 presents Monte Carlo mean and standard deviation, the Monte Carlo
average of standard errors ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}, and MSE ratio deï¬ned above as the Monte Carlo MSE for the indicated estimator divided
by that for Ì‚ğ›½î‰€ğ¹
. Thus, the MSE ratio reï¬‚ects eï¬ƒciency of the indicated estimator relative to the usual ML estimator using data
only on subjects enrolled for the maximum follow-up period î‰€ğ¹ . From the table, all estimators are consistent, with standard
errors that track the Monte Carlo standard deviations, under both hypotheses. The eï¬ƒciency gains over Ì‚ğ›½î‰€ğ¹
(ğ‘¡) achieved at interim

TSIATIS and DAVIDIAN

13

TABLE 1 For Scenario 1 with ordered categorical outcome, performance of estimators for ğ›½ under (a) the null hypothesis ğ›½ = 0
and (b) the alternative ğ›½ = log(1.5) = 0.405 at each interim analysis time (ğ‘¡1, â€¦ , ğ‘¡4) = (150, 195, 240, 285) days and at the
ï¬nal analysis at ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330 days MC Mean is the mean of 10000 Monte Carlo estimates; MC SD is the Monte Carlo standard
deviation, Ave MC SE is the mean of Monte Carlo standard errors, and MSE ratio is the ratio of Monte Carlo mean square error
for the AIPW2 estimator divided by that for the indicated estimator.

MC Mean MC SD

Ave MC SE MSE ratio

MC Mean MC SD

Ave MC SE MSE ratio

(a) Null Hypothesis

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

0.294
0.221
0.185
0.162
0.146

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

0.221
0.178
0.154
0 .140
0.135

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

0.294
0.221
0.185
0.162
0.146

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

0.224
0.180
0.155
0.141
0.136

0.294
0.221
0.184
0.162
0.146

0.221
0.178
0.156
0.141
0.135

0.294
0.220
0.185
0.163
0.147

0.224
0.180
0.158
0.142
0.137

-0.002
-0.002
-0.003
-0.001
0.000

-0.004
-0.002
-0.002
-0.001
0.000

0.408
0.406
0.404
0.406
0.406

0.405
0.406
0.405
0.406
0.406

1.000
1.000
1.000
1.000
1.000

1.775
1.534
1.399
1.327
1.169

-0.004
-0.002
-0.002
-0.001
0.000

-0.005
-0.002
-0.002
-0.001
0.000

(b) Alternative Hypothesis

1.000
1.000
1.000
1.000
1.000

1.733
1.508
1.378
1.314
1.159

0.406
0.406
0.405
0.406
0.406

0.406
0.408
0.408
0.407
0.406

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

0.232
0.189
0.166
0.152
0.147

0.232
0.189
0.164
0.151
0.146

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.203
0.168
0.149
0.138
0.135

0.235
0.191
0.167
0.153
0.148

0.198
0.165
0.145
0.136
0.135

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

0.235
0.191
0.165
0.152
0.147

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.204
0.169
0.150
0.139
0.137

0.200
0.167
0.147
0.137
0.136

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

1.603
1.330
1.239
1.139
0.991

2.095
1.717
1.542
1.380
1.169

1.566
1.336
1.221
1.131
0.985

2.078
1.702
1.523
1.373
1.159

analyses by using any of Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) are substantial. The IPWCC estimator achieves gains solely through
accounting for censoring; the AIPWCC estimators improve on these gains by additionally incorporating covariates. Notably,
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) yields a two-fold gain at the initial interim analysis. For all three estimators, the eï¬ƒciency gains are most pronounced
at the early interim analyses where censoring is the most substantial and diminish as censoring decreases as the trial progresses.
At the ï¬nal analysis, Ì‚ğ›½î‰€ğ¹
(ğ‘¡ğ‘’ğ‘›ğ‘‘) and Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘’ğ‘›ğ‘‘) show very similar performance, with Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡ğ‘’ğ‘›ğ‘‘) exhibiting minimal relative loss of
eï¬ƒciency, as noted above. As expected, Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡ğ‘’ğ‘›ğ‘‘) and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡ğ‘’ğ‘›ğ‘‘) are identical and, due to the incorporation of adjustment
for baseline covariates, result a 16%-17% gain in eï¬ƒciency over the usual ï¬nal analysis.

Table 2 presents interim monitoring results using each estimator with both Oâ€™Brien-Fleming and Pocock stopping boundaries
under the null hypothesis and under the alternative ğ›½ = log(1.5). Under the null, the nominal level ğ›¼ = 0.025 is achieved for

14

TSIATIS and DAVIDIAN

TABLE 2 For Scenario 1 with ordered categorical outcome, interim analysis performance using each estimator with Oâ€™Brien-
Fleming and Pocock stopping boundaries under (a) the null hypothesis ğ›½ = 0 and (b) the alternative ğ›½ = log(1.5) = 0.405, with
maximum sample size ğ‘›ğ‘šğ‘ğ‘¥ = 602 and ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330 days. P(reject) is the proportion of Monte Carlo data sets for which the null
hypothesis was rejected; MC E(SS) is the Monte Carlo average of number of subjects enrolled at the time the stopping boundary
was crossed (standard deviation); and MC E(Stop) is the Monte Carlo average stopping time (days) (standard deviation). The
standard error for entries for P(reject) in (a) is â‰ˆ 0.0016.

P(reject)

MC E(SS)

MC E(Stop)

P(reject)

MC E(SS)

MC E(Stop)

(a) Null Hypothesis

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.024
0.024
0.024
0.024

0.784
0.771
0.836
0.841

Oâ€™Brien-Fleming

601.9 (2.7)
601.6 (7.8)
601.7 (6.7)
601.2 (11.4)

329.3 (7.5)
328.4 (12.1)
328.5 (11.3)
327.9 (14.9)

0.023
0.024
0.024
0.027

(b) Alternative Hypothesis

Oâ€™Brien-Fleming

592.7 (31.5)
564.6 (62.5)
562.7 (62.7)
531.9 (81.7)

284.2 (44.7)
257.1 (55.9)
251.5 (53.4)
231.7 (58.0)

0.710
0.701
0.774
0.783

Pocock

599.7 (21.4)
598.8 (25.9)
598.9 (25.5)
598.0 (28.9)

Pocock

548.1 (85.3)
516.3 (100.3)
508.3 (100.6)
483.4 (103.5)

327.4 (19.5)
326.7 (22.4)
326.8 (22.0)
326.1 (24.7)

260.5 (68.7)
239.0 (74.7)
230.1 (72.2)
215.1 (72.3)

all estimators. Under the alternative, power for Ì‚ğ›½î‰€ğ¹
(ğ‘¡) is slightly shy of the desired 80%, as expected with no inï¬‚ation factor;
by comparison, the AIPWCC estimators yield improved power due to inclusion of covariate information. Under the alternative
and both types of boundaries, basing interim analyses on Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) results in impressive reductions in
expected sample size and expected stopping time relative to Ì‚ğ›½î‰€ğ¹

(ğ‘¡), with the gains especially impressive for Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡).

For the second scenario with binary outcome, we generated data as above under the null hypothesis and with the log odds
ratio equal to 1.5, which implies a log relative risk (risk ratio) for death (ğ‘Œ = 1) of ğ›½ = ğ›½0 = ğ›½ğ´ = log(0.247âˆ•0.33) = âˆ’0.290
as in (3) and alternative hypothesis Hğ´âˆ¶ ğ›½0 < 0. We took ğ‘›ğ‘šğ‘ğ‘¥ = 900, which corresponds roughly to 90% power to detect this
alternative. The Monte Carlo sample covariance matrices of the 10000 estimates { Ì‚ğ›½(ğ‘¡1), â€¦ , Ì‚ğ›½(ğ‘¡4), Ì‚ğ›½(ğ‘¡ğ‘’ğ‘›ğ‘‘)} for each of the four
estimators under both the null and alternative settings are shown in the Appendix and exhibit patterns analogous to those in (32),
demonstrating that all estimators have approximately the independent increments property. Also shown in the Appendix for each
estimator at each analysis time are the Monte Carlo mean and standard deviation, the Monte Carlo average of standard errors
ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡)}, and MSE ratio deï¬ned above as the Monte Carlo MSE for the estimator divided by that for Ì‚ğ›½î‰€ğ¹
(ğ‘¡) under the null and
alternative hypotheses. All estimators are consistent, and standard errors are very close to the Monte Carlo standard deviations.
Under both null and alternative hypotheses, the estimator Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), which takes censoring at interim analysis times into account
and as noted previously is identical to the ratio of treatment-speciï¬c Kaplan-Meier estimators often used in practice, achieves
substantial eï¬ƒciency gains over Ì‚ğ›½î‰€ğ¹
(ğ‘¡), with a two-fold increase at the ï¬rst interim analysis and 24% at the last at ğ‘¡4 = 285 days.
These estimators are equivalent, as expected, at the ï¬nal analysis. The AIPWCC estimators Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡) and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) achieve
even greater gains. Here, Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) does not oï¬€er improved performance over Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡); this behavior is not surprising, as
the time-dependent covariates ğ¿(ğ‘¢) = {ğ¿1(ğ‘¢), ğ¿2(ğ‘¢)} reï¬‚ecting length of hospital stay do not provide information on death.
As expected, these estimators are identical at ğ‘¡ğ‘’ğ‘›ğ‘‘ and oï¬€er 10%-12% gains in eï¬ƒciency over the standard analysis through
adjustment for the baseline covariate.

Table 3 shows interim monitoring results using each estimator with Oâ€™Brien-Fleming and Pocock stopping boundaries under
the null hypothesis and under the alternative ğ›½ğ´ = âˆ’0.290. Again, overall testing procedures achieve the nominal level. Power
gains over Ì‚ğ›½î‰€ğ¹
(ğ‘¡) under the alternative are achieved using the AIPWCC estimators. As for the ï¬rst scenario, basing interim
analyses on Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) yields substantial reductions in expected sample size and stopping time over
Ì‚ğ›½î‰€ğ¹

(ğ‘¡) under the alternative, especially for the AIPWCC estimators.

TSIATIS and DAVIDIAN

15

TABLE 3 For Scenario 2 with binary outcome, interim analysis performance using each estimator with Oâ€™Brien-Fleming and
Pocock stopping boundaries under (a) the null hypothesis ğ›½ = 0 and (b) the alternative ğ›½ = log(0.247âˆ•0.33) = âˆ’0.290, with
maximum sample size ğ‘›ğ‘šğ‘ğ‘¥ = 900 and ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330 days. Entries are as in Table 2. The standard error for entries for P(reject) in
(a) is â‰ˆ 0.0016.

P(reject)

MC E(SS)

MC E(Stop)

P(reject)

MC E(SS)

MC E(Stop)

(a) Null Hypothesis

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.024
0.024
0.023
0.024

0.770
0.767
0.806
0.809

Oâ€™Brien-Fleming

900.0 (2.3)
898.8 (15.8)
899.0 (14.0)
899.0 (14.9)

329.4 (6.5)
328.0 (14.5)
328.1 (13.8)
328.0 (14.2)

0.022
0.023
0.025
0.026

(b) Alternative Hypothesis

Oâ€™Brien-Fleming

887.5 (44.3)
808.3 (121.4)
801.8 (122.5)
799.9 (123.4)

285.9 (44.0)
241.3 (61.3)
236.1 (59.6)
235.5 (59.7)

0.690
0.700
0.746
0.748

Pocock

896.3 (33.6)
894.3 (42.3)
894.1 (42.8)
894.1 (42.7)

Pocock

827.2 (122.4)
744.9 (157.6)
733.2 (157.3)
731.6 (157.3)

327.4 (19.8)
326.5 (23.7)
326.3 (24.3)
326.2 (24.4)

264.4 (67.2)
228.3 (76.7)
221.4 (74.7)
220.6 (74.7)

The ï¬nal simulation scenario involves a continuous outcome, with ğ‘›ğ‘šğ‘ğ‘¥ = 300, ğ¸ğ‘šğ‘ğ‘¥ = 156 weeks, and î‰€ğ¹ = 52 weeks, so
that enrollment takes place over 3 years, with ğ¾ = 4 interim analyses planned at calendar times 104, 130, 156, 182 weeks and the
ï¬nal analysis at ğ‘¡ğ‘’ğ‘›ğ‘‘ = 208 weeks. We generated treatment assignment ğ´ as Bernoulli with pr(ğ´ = 1) = ğœ‹ = 0.5, where ğ‘ = 0 (1)
corresponds to placebo (active agent); and a categorical baseline covariate ğ‘‹1 was generated with pr(ğ‘‹1 = ğ‘—) = 0.4, 0.3, 0.2, 0.1
for ğ‘— = 1, â€¦ , 4. With (ğ‘ 1, â€¦ , ğ‘ 5) = (0, 4, 12, 24, 52) weeks, ğœ = 4.5, ğ· a (2 Ã— 2) matrix with vech(ğ·) = (80, âˆ’0.5, 0.08),
and ğœ‰ = (ğœ‰1, ğœ‰2)ğ‘‡ , we generated longitudinal measurements for each subject ğ‘– according to the linear mixed eï¬€ects model
ğ‘ğ‘–ğ‘— = 65ğ¼(ğ‘‹1 = 1) + 60ğ¼(ğ‘‹1 = 2) + 55ğ¼(ğ‘‹1 = 3) + 49ğ¼(ğ‘‹1 = 4) + {ğœ‰1(1 âˆ’ ğ´) + ğœ‰2ğ´}ğ‘ ğ‘— + ğ‘0ğ‘– + ğ‘1ğ‘–ğ‘ ğ‘— + ğ‘’ğ‘–ğ‘—, where
ğ‘ğ‘– = (ğ‘0ğ‘–, ğ‘1ğ‘–)ğ‘‡ âˆ¼ îˆº (0, ğ·) independent of ğ‘’ğ‘–ğ‘— âˆ¼ îˆº (0, ğœ2). The outcome for subject ğ‘– is then ğ‘Œğ‘– = ğ‘ğ‘–5, the longitudinal
measure at î‰€ğ¹ weeks. As would be likely in practice, we included in ğ‘‹ only the single baseline covariate ğ‘ğ‘–1, the value of the
longitudinal measure at time 0 and did not also include ğ‘‹1, and we took the single time-dependent covariate ğ¿(ğ‘¢) at time ğ‘¢ to
be the most recently observed value of the longitudinal measurements ğ‘ğ‘–ğ‘—. Under the null hypothesis, ğœ‰ = (âˆ’0.3, âˆ’0.3)ğ‘‡ ; under
the alternative, ğœ‰ = (âˆ’0.3, âˆ’0.18)ğ‘‡ corresponding to ğ›½ = ğ›½0 = ğ›½ğ´ = 6.24, for which ğ‘›ğ‘šğ‘ğ‘¥ = 300 yields roughly 90% power at
the ï¬nal analysis. Results shown in the Appendix demonstrate that the independent increments property holds approximately for
(ğ‘¡) and Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡) are identical because ğ‘‡ = î‰€ğ¹ for all subjects, so that both are based only
all estimators. Here, the estimators Ì‚ğ›½î‰€ğ¹
on subjects followed for at least î‰€ğ¹ weeks. Standard errors ğ‘†ğ¸{ Ì‚ğ›½î‰€ğ¹
(ğ‘¡)} are obtained from the routine formula for a diï¬€erence in
sample means assuming common treatment-speciï¬c variance, while ğ‘†ğ¸{ Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)} follows from the IPWCC inï¬‚uence function;
these standard errors are asymptotically equivalent but diï¬€er slightly for ï¬nite samples. Incorporation of the baseline covariate
yields 10%-20% gains in eï¬ƒciency; further incorporation of the last outcome carried forward as a time-dependent covariate
leads to eï¬ƒciency gains for Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) of 34% to 47%.

Interim monitoring results are shown in Table 4 and are analogous to those in Tables 2 and 3. Under the null hypothesis, the
Monte Carlo rejection probability for Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) with Pocock boundaries exceeds slightly the nominal 0.025 level. Again, under
the alternative, the AIPWCC estimators result in earlier expected sample sizes and stopping times.

We remark that all scenarios reï¬‚ect the general result that basing interim analyses on the proposed AIPWCC estimators leads
to not only more eï¬ƒcient inferences but also, because of the increased precision, to a greater proportion of the total statistical
information being available at each interim analysis time than would be available using the usual methods. This feature implies
that Oâ€™Brien-Fleming boundaries will be less conservative for the proposed estimators, leading to potential gains in expected
sample size and stopping times.

16

TSIATIS and DAVIDIAN

TABLE 4 For Scenario 3 with continuous outcome, interim analysis performance using each estimator with Oâ€™Brien-Fleming
and Pocock stopping boundaries under (a) the null hypothesis ğ›½ = 0 and (b) the alternative ğ›½ = 6.24, with maximum sample
size ğ‘›ğ‘šğ‘ğ‘¥ = 300 and ğ‘¡ğ‘’ğ‘›ğ‘‘ = 208 days. Entries are as in Table 2. The standard error for entries for P(reject) in (a) is â‰ˆ 0.0016.

P(reject)

MC E(SS)

MC E(Stop)

P(reject)

MC E(SS)

MC E(Stop)

(a) Null Hypothesis

Oâ€™Brien-Fleming

299.9 (3.1)
299.8 (3.4)
299.9 (2.6)
299.8 (4.0)

207.4 (5.5)
207.4 (5.8)
207.5 (5.0)
207.0 (7.4)

0.025
0.025
0.026
0.029

(b) Alternative Hypothesis

Oâ€™Brien-Fleming

286.3 (26.0)
286.0 (26.4)
286.5 (25.5)
265.9 (37.3)

167.8 (30.6)
167.4 (30.7)
165.5 (28.9)
146.7 (31.2)

0.823
0.826
0.896
0.892

Pocock

298.6 (11.3)
298.6 (11.5)
298.6 (11.2)
298.1 (13.2)

Pocock

259.9 (45.2)
259.1 (45.4)
255.9 (45.2)
239.8 (45.3)

206.2 (12.7)
206.1 (12.9)
206.2 (12.7)
205.7 (14.5)

151.9 (41.9)
151.1 (41.9)
146.0 (39.6)
133.5 (37.8)

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

Ì‚ğ›½î‰€ğ¹
(ğ‘¡)
Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.026
0.026
0.025
0.026

0.875
0.876
0.930
0.930

6

APPLICATION

To demonstrate how use of the methods would proceed in practice as a trial progresses, we consider the setting of TESICO
with ordinal categorical outcome, where the treatment eï¬€ect of interest is the log odds ratio ğ›½ in an assumed proportional odds
model as in (2). Because this trial is ongoing, we cannot base this demonstration on data from the trial; accordingly, we present
use of the methods for a simulated data set generated according to the ï¬rst simulation scenario in Section 5 with ğ›½ = log(1.5),
which is based on this study. As in Section 5, the planned maximum sample size is ğ‘›ğ‘šğ‘ğ‘¥ = 602, with full enrollment reached by
ğ¸ğ‘šğ‘ğ‘¥ = 240 day. Interim analyses are planned at 150, 195, 240, and 285 days, with the ï¬nal analysis to be conducted at ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330
days, at which time all ğ‘›ğ‘šğ‘ğ‘¥ participants will have completed the trial with their outcomes ascertained. For deï¬niteness, we use
Oâ€™Brien-Fleming stopping boundaries and focus on the null and alternative hypotheses H0âˆ¶ ğ›½0 = 0 versus Hğ´âˆ¶ ğ›½0 > 0, with
overall level of signiï¬cance ğ›¼ = 0.025.

Table 5 shows how the trial would proceed if the analyses were conducted at each interim analysis time ğ‘¡ using each of the
(ğ‘¡), Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡). For each estimator, the proportion of information at each of the interim
estimators Ì‚ğ›½î‰€ğ¹
analysis times was calculated as described in Section 4.2 and was used to obtain the stopping boundary. At the ï¬rst interim
analysis at 150 days, the proportion of information for the ML estimator Ì‚ğ›½î‰€ğ¹
(ğ‘¡), which uses only those subjects among the ğ‘›(ğ‘¡)
enrolled who have been followed for at least the maximum follow-up time î‰€ğ¹ , is 0.257, whereas that for Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) is 0.462,
almost twice as large. This striking diï¬€erence is reï¬‚ected in the corresponding stopping boundaries: at the ï¬rst interim analysis
at 150 days, the test statistic based on Ì‚ğ›½î‰€ğ¹
(ğ‘¡) is 2.496, far from the boundary of 4.265, whereas that based on Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) is 2.966,
almost reaching the boundary of 3.099. Basing the analyses on Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡) results in suï¬ƒcient evidence to stop the trial at the
second interim analysis at 195 days with 487 subjects enrolled, while suï¬ƒcient evidence to stop using Ì‚ğ›½î‰€ğ¹
(ğ‘¡) does not emerge
until the fourth interim analysis at 285 days, with all ğ‘›ğ‘šğ‘ğ‘¥ = 602 subjects enrolled. Basing the analyses on Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡) and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)
results in stopping the trial at 240 days, with again all 602 planned subjects enrolled.

7

DISCUSSION

We have proposed a general framework for design and conduct of group sequential trials in the common situation where the out-
come is known with certainty only after some time lag. The methods account for censoring at the time of an interim analysis and

TSIATIS and DAVIDIAN

17

TABLE 5 Interim analysis results for analyses at time (ğ‘¡1, â€¦ , ğ‘¡5) = (150, 195, 240, 285, 330) for the simulated TESICO trial;
ğ‘›(ğ‘¡ğ‘—) is the number of subjects enrolled at ğ‘¡ğ‘—. For each of the estimators Ì‚ğ›½î‰€ğ¹
(ğ‘¡) (the ML estimator based on data from all sub-
jects followed for at least the maximum follow-up period î‰€ğ¹ at ğ‘¡), the IPWCC estimator Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), and the AIPWCC estimators
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡) and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡), Est (SE) are the estimate Ì‚ğ›½(ğ‘¡ğ‘—) (standard error ğ‘†ğ¸{ Ì‚ğ›½(ğ‘¡ğ‘—)}) at ğ‘¡ğ‘—, ğ‘‡ is associated the Wald test statis-
tic, ğ‘(ğ‘¡ğ‘—) is the proportion of information at ğ‘¡ğ‘—, and ğ‘ğ‘— is the Oâ€™Brien-Fleming stopping boundary. Entries are boldfaced at the
interim analysis at which the trial would be stopped using the indicated estimator.

ğ‘¡ğ‘—

150
195
240
285
330

ğ‘¡ğ‘—

150
195
240
285
330

ğ‘›(ğ‘¡ğ‘—)

368
487
602
602
602

ğ‘›(ğ‘¡ğ‘—)

368
487
602
602
602

Est (SE)

0.730 (0.292)
0.619 (0.224)
0.457 (0.187)
0.459 (0.162)
â€“

Est (SE)

0.565 (0.218)
0.497 (0.182)
0.409 (0.156)
â€“
â€“

(ğ‘¡)

Ì‚ğ›½î‰€ğ¹
ğ‘‡

2.496
2.765
2.445
2.828
â€“

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

ğ‘‡

2.586
2.739
2.615
â€“
â€“

ğ‘(ğ‘¡ğ‘—)

0.257
0.432
0.611
0.809
â€“

ğ‘(ğ‘¡)

0.382
0.564
0.757
â€“
â€“

ğ‘ğ‘—

4.265
3.218
2.657
2.277
â€“

ğ‘ğ‘—

3.444
2.777
2.362
â€“
â€“

Est (SE)

0.547 (0.230)
0.476 (0.193)
0.423 (0.166)
â€“
â€“

Est (SE)

0.590 (0.199)
0.532 (0.167)
â€“
â€“
â€“

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)
ğ‘‡

2.380
2.473
2.551
â€“
â€“
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)
ğ‘‡

2.966
3.185
â€“
â€“
â€“

ğ‘(ğ‘¡)

0.408
0.581
0.785
â€“
â€“

ğ‘(ğ‘¡)

0.462
0.670
â€“
â€“
â€“

ğ‘ğ‘—

3.318
2.733
2.313
â€“
â€“

ğ‘ğ‘—

3.099
2.521
â€“
â€“
â€“

incorporate baseline and time-dependent evolving covariate information to improve eï¬ƒciency over standard analyses, facilitat-
ing earlier stopping with potentially smaller numbers of enrolled subjects. We have demonstrated analytically and empirically
that the proposed test statistics possess the independent increments structure, so that standard methods and software for speci-
fying stopping boundaries can be used. The methods can be applied under both information-based monitoring and ï¬xed-sample
monitoring strategies. For the latter, we have proposed the idea of eï¬€ective sample size to characterize the proportion of infor-
mation available at an interim analysis. Simulation studies demonstrate that the methods preserve the operating characteristics
of a monitored trial and that substantial reductions in expected sample size and stopping time can be achieved.

As noted above, the proposed methodology is relevant in the large class of problems where the outcome would be known with
certainty for all subjects at the ï¬nal analysis. For some trials with possibly censored time-to-event outcome, interest may focus
on the hazard ratio under the assumption of proportional hazards. Here, there is no prespeciï¬ed, maximum follow-up time î‰€ğ¹
at which the outcome is known with certainty, so that the proposed framework is not applicable.

The methods as presented are based on the assumption (12) that entry time is independent of all other variables, including
baseline covariates ğ‘‹, which implies that any interim analysis time ğ‘¡ ğ¶(ğ‘¡) âŸ‚âŸ‚ {ğ‘‹, ğ´, ğ‘‡ , ğ‘Œ , Ì„ğ¿(ğ‘‡ )}. This assumption is made
tacitly in any clinical trial that focuses on inference on an unconditional treatment eï¬€ect parameter. If the distribution of ğ‘‹
changes over the course of a trial, then (12) is violated, and, intuitively, subjects enrolled at the time of an interim analysis
may not be representative of the population of interest at the ï¬nal analysis. This is a general phenomenon and not unique to
our methodology. If (12) is violated in this way, then the treatment eï¬€ect parameter may not be static over time. Under these
circumstances, conditional (on ğ‘‹) inference may be more appropriate; e.g., as in the case of the conditional proportional odds
model for ordinal categorical outcome in Section 2.1. Under the modiï¬ed assumption ğ¸ âŸ‚âŸ‚ {ğ´, ğ‘‡ , ğ‘Œ , Ì„ğ¿(ğ‘‡ )}
ğ‘‹ (independence
conditional on ğ‘‹), the proposed methods can be extended to support such conditional inference through incorporation of relevant
inï¬‚uence functions and modeling of the censoring distribution as a function of ğ‘‹.

|

ACKNOWLEDGMENTS

The authors thank Drs. Birgit Grund and Michael Hughes for helpful discussions.

18

TSIATIS and DAVIDIAN

SUPPORTING INFORMATION

R code implementing the simulations reported in Section 5 is available from the authors

APPENDIX

A DEMONSTRATION OF INDEPENDENT INCREMENTS PROPERTY

For deï¬niteness, we consider AIPWCC estimators Ì‚ğ›½(ğ‘¡) with inï¬‚uence function (13) with ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} in (19)
substituted for ğ‘“ (ğ‘‹) and â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}, i.e., the eï¬ƒcient inï¬‚uence function; results for the IPWCC estimator follow from the
argument.

We wish to describe the joint distribution of such estimators at interim analysis times ğ‘¡1 < â‹¯ < ğ‘¡ğ¾ (calendar time). It suï¬ƒces
to consider the bivariate distribution of { Ì‚ğ›½(ğ‘ ), Ì‚ğ›½(ğ‘¡)}, ğ‘  < ğ‘¡. The large-sample properties of { Ì‚ğ›½(ğ‘ ), Ì‚ğ›½(ğ‘¡)} are determined by the
covariance matrix of the corresponding inï¬‚uence functions for Ì‚ğ›½(ğ‘ ) and Ì‚ğ›½(ğ‘¡).

Using

ğ¼(ğ¸ â‰¤ ğ‘¡)
pr(ğ¸ â‰¤ ğ‘¡)

Î”(ğ‘¡)ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
îˆ·ğ‘¡{ğ‘ˆ (ğ‘¡)}

=

ğ¼(ğ¸ â‰¤ ğ‘¡)
pr(ğ¸ â‰¤ ğ‘¡)

ğœ‡(â„ğ‘œğ‘ğ‘¡, ğ‘¢) = ğ¸

â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

â¡
â¢
â¢
â£
ğ‘‡ â‰¥ ğ‘¢

=

ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ ğœ‡(ğ‘š, ğ‘¢; ğ›¼0, ğ›½0)}

,

ğ‘¡

âˆ«
0

ğ‘ (ğ‘¢)

ğ‘‘ğ‘€ (ğ‘¡)
îˆ·ğ‘¡(ğ‘¢)

â¤
(A1)
â¥
â¥
â¦

=

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

[

îˆ·ğ‘¡(ğ‘¢)

ğ‘‡ â‰¥ ğ‘¢}
]
|

=

[

ğœ‡(ğ‘š, ğ‘¢; ğ›¼0, ğ›½0)
îˆ·ğ‘¡(ğ‘¢)

,

ğ¸

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)

ğ‘‡ â‰¥ ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

ğ‘‡ â‰¥ ğ‘¢

îˆ·ğ‘¡(ğ‘¢)
|

]

|

and denoting the available data at interim analysis times ğ‘  and ğ‘¡ by îˆ»(ğ‘ ) and îˆ»(ğ‘¡) as in (11), the eï¬ƒcient inï¬‚uence function for
Ì‚ğ›½(ğ‘¡) is given by

|

ğ‘šğ‘¡(îˆ»(ğ‘¡); ğ›¼0,ğ›½0) =

ğ¼(ğ¸ â‰¤ ğ‘¡)
pr(ğ¸ â‰¤ ğ‘¡)

ğ‘¡

âˆ’

âˆ«
0

ğ‘ (ğ‘¢)

ğ‘‘ğ‘€ (ğ‘¡)
îˆ·ğ‘¡(ğ‘¢)

[

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

â›
âœ
âœ
ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹; ğ›¼0, ğ›½0)
â

ğ‘‡ â‰¥ ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

.

(A2)

(A3)

]â
âŸ
âŸ
â 

Similarly, denote the eï¬ƒcient inï¬‚uence function for Ì‚ğ›½(ğ‘ ) as ğ‘šğ‘ (îˆ»(ğ‘ ); ğ›¼0, ğ›½0). For brevity, we suppress dependence of these
inï¬‚uence functions on ğ›¼0, ğ›½0 henceforth.

To demonstrate the independent increments property, it suï¬ƒces to show that

ğ¸{ğ‘šğ‘ (îˆ»(ğ‘ ))ğ‘šğ‘¡(îˆ»(ğ‘¡))} = var{ğ‘šğ‘¡(îˆ»(ğ‘¡))} = ğ¸{ğ‘šğ‘¡(îˆ»(ğ‘¡))2}.

(A4)

To this end, recalling that ğ¶(ğ‘¡) = ğ‘¡ âˆ’ ğ¸, it is convenient to deï¬ne

Ìƒğ‘ (ğ‘¡)

ğ‘ (ğ‘¢) = ğ¼{ğ¶(ğ‘¡) â‰¤ ğ‘¢} = ğ¼(ğ¸ â‰¥ ğ‘¡ âˆ’ ğ‘¢),

Ìƒî‰… (ğ‘¡)(ğ‘¢) = ğ¼{ğ¶(ğ‘¡) â‰¥ ğ‘¢} = ğ¼(ğ¸ â‰¤ ğ‘¡ âˆ’ ğ‘¢),

|

and note that îˆ·ğ‘¡(ğ‘¢) = pr{ğ¶(ğ‘¡) â‰¥ ğ‘¢
density ğ‘(ğ‘¢), and recalling that Î›(ğ‘¡)
|

ğ‘ (ğ‘¢) = âˆ’ log{îˆ·ğ‘¡(ğ‘¢)}, it follows that
îˆ·ğ‘¡(ğ‘¢) = ğ‘„(ğ‘¡ âˆ’ ğ‘¢)âˆ•ğ‘„(ğ‘¡),

|
ğ‘‘Î›(ğ‘¡)

ğ‘ (ğ‘¢) = {ğ‘(ğ‘¡ âˆ’ ğ‘¢)âˆ•ğ‘„(ğ‘¡ âˆ’ ğ‘¢)} ğ‘‘ğ‘¢.

ğ¸ â‰¤ ğ‘¡} = pr(ğ¸ â‰¤ ğ‘¡ âˆ’ ğ‘¢

ğ¸ â‰¤ ğ‘¡). Denoting the distribution of ğ¸ by ğ‘„(ğ‘¢) = pr(ğ¸ â‰¤ ğ‘¢), with

Thus, if we write

ğ‘‘ Ìƒğ‘€(ğ‘¡ âˆ’ ğ‘¢) = ğ‘‘ Ìƒğ‘ (ğ‘¡)

ğ‘ (ğ‘¢) âˆ’ ğ‘‘Î›(ğ‘¡)

ğ‘ (ğ‘¢) Ìƒî‰… (ğ‘¡)(ğ‘¢) = âˆ’ğ‘‘ğ¼(ğ¸ â‰¥ ğ‘¡ âˆ’ ğ‘¢) âˆ’

ğ‘(ğ‘¡ âˆ’ ğ‘¢)
ğ‘„(ğ‘¡ âˆ’ ğ‘¢)

ğ¼(ğ¸ â‰¤ ğ‘¡ âˆ’ ğ‘¢) ğ‘‘ğ‘¢,

(A5)

TSIATIS and DAVIDIAN

19

then using ğ‘ (ğ‘¡)

ğ‘ (ğ‘¢) = ğ¼{ğ¶(ğ‘¡) â‰¤ ğ‘¢, ğ‘‡ â‰¥ ğ‘¢} and î‰… (ğ‘¡)(ğ‘¢) = ğ¼{ğ¶(ğ‘¡) â‰¥ ğ‘¢, ğ‘‡ â‰¥ ğ‘¢}, the martingale integral (A3) can be written as

ğ‘¡

âˆ’

âˆ«
0

= âˆ’

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¡ âˆ’ ğ‘¢)ğ¼(ğ‘‡ â‰¥ ğ‘¢)
ğ‘„(ğ‘¡ âˆ’ ğ‘¢)âˆ•ğ‘„(ğ‘¡)

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)}

ğ‘¡

[
ğ‘‘ Ìƒğ‘€(ğ‘¥)ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
ğ‘„(ğ‘¥)âˆ•ğ‘„(ğ‘¡)

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

(A6)

|

]

with change of variable ğ‘¥ = ğ‘¡ âˆ’ ğ‘¢. If we deï¬ne the ï¬ltration îˆ² (ğ‘¥) to be the sigma algebra generated by {ğ¼(ğ¸ â‰¥ ğ‘¥), ğ¸ğ¼(ğ¸ â‰¥
ğ‘¥), ğ‘Œ , ğ´, ğ‘‹, Ì„ğ¿(ğ‘‡ )}, then the integral (A6) is the realization of a îˆ² (ğ‘¥)-measurable martingale process. Note that the ï¬ltration
îˆ² (ğ‘¥) deï¬nes information about ğ¸ to the right (after) ğ‘¥ rather than as for the usual ï¬ltration that deï¬nes information to the left
(before) ğ‘¥. Thus, (A3) can be written as

|

[

]

âˆ’

ğ¼(ğ¸ â‰¤ ğ‘¡)
ğ‘„(ğ‘¡)

ğ‘¡

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
ğ‘„(ğ‘¥)âˆ•ğ‘„(ğ‘¡)

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

= âˆ’

ğ‘¡

âˆ«
0

and the variance of (A3) is

[

ğ‘‘ Ìƒğ‘€(ğ‘¥)ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
ğ‘„(ğ‘¥)

|

]

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

,

[

|

]

ğ‘¡

ğ‘(ğ‘¥) ğ‘‘ğ‘¥âˆ•ğ‘„(ğ‘¥)
ğ‘„2(ğ‘¥)

ğ¼(ğ¸ â‰¤ ğ‘¥)ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

[

|

2

]

â
âŸ
âŸ
â 

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

]

)

ğ¸

âˆ«
â›
0
âœ
âœ
=
â

ğ‘¡

âˆ«
0

ğ‘(ğ‘¥) ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

([

Consequently,

var{ğ‘šğ‘¡(îˆ»(ğ‘¡))} =

|
var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
ğ‘„(ğ‘¡)

ğ‘¡

+

âˆ«
0

ğ‘(ğ‘¥) ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

,

([

|

]

)

(A7)

and similarly for var{ğ‘šğ‘ (îˆ»(ğ‘ ))}.

From (A4), we thus wish to show that ğ¸{ğ‘šğ‘ (îˆ»(ğ‘ ))ğ‘šğ‘¡(îˆ»(ğ‘¡))} is equal to var{ğ‘šğ‘¡(îˆ»(ğ‘¡))} in (A7). Using the preceding

developments, we can write

ğ‘šğ‘¡(îˆ»(ğ‘¡)) =

ğ¼(ğ¸ â‰¤ ğ‘¡)
ğ‘„(ğ‘¡)

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

ğ‘¡

âˆ’

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

ğ‘šğ‘ (îˆ»(ğ‘ )) =

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘ )

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

|

]

ğ‘ 

âˆ’

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

accordingly,

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘  âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥);

|

]

ğ¸{ğ‘šğ‘ (îˆ»(ğ‘ ))ğ‘šğ‘¡(îˆ»(ğ‘¡))} = (ğ´8) Ã— (ğ´10) + (ğ´8) Ã— (ğ´11) + (ğ´9) Ã— (ğ´10) + (ğ´9) Ã— (ğ´11).

We consider each of these terms in turn.

(A8)

(A9)

(A10)

(A11)

20

Using ğ‘  â‰¤ ğ‘¡, it is straightforward that

ğ¸{(ğ´8) Ã— (ğ´10)} = ğ¸

TSIATIS and DAVIDIAN

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}2

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘ )ğ‘„(ğ‘¡)

[

=

var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
ğ‘„(ğ‘¡)

]

.

(A12)

Similarly,

ğ¸{(ğ´8) Ã— (ğ´11)} = ğ¸

âˆ’

â›
âœ
âœ
Ã—
â

ğ‘ 

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘¡)

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘  âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥)

]

â
âŸ
âŸ
â 

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
ğ‘„(ğ‘¡)

ğ‘ 

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

= ğ¸

â›
âœ
âœ
Ã—
â

= 0

|

|

ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘  âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥)

]

â
âŸ
âŸ
â 

(A13)

because {ğ‘š(ğ‘Œ , ğ´, ğ‘‹)âˆ’(ğ´âˆ’ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)} is îˆ² (ğ‘ )-predictable, so that the expectation is zero by the martingale property of stochastic
integrals.

By the martingale property,

ğ¸{(ğ´9) Ã— (ğ´11)} =

ğ‘ 

âˆ«
0

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

([

The expectation in the intetgral in (A14) can be written as

[

Ã—

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘  âˆ’ ğ‘¥)}

|

]

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

]

)

(A14)

|

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

([
âˆ’ ğ¸

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)} âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

]

ğ‘‡ â‰¥ ğ‘  âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘  âˆ’ ğ‘¥)}

)

(A15)

Ã—

([
ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

|

|
ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
|

.

]

The diï¬€erence of conditional expectations in brackets in (A15) is some function ğ‘”{ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}, in which case the last two
lines of (A15) can be written as

]

[

|

)

ğ¸

ğ‘”{ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

(
= ğ¸

= ğ¸

ğ‘”{ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}
[

ğ¸
ğ‘”{ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}
{

(

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}
ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)} âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

]

|

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

[

)

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}
]
)

âˆ£ ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)

|

|

|

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

}

)

]

= 0.

(
It follows that

ğ¸{(ğ´9) Ã— (ğ´11)} =

[

ğ‘ 

âˆ«
0

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

([

|

2

]

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

(A16)

)

âˆ’ğ¸

âˆ’ğ¸

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘ )

â›
âœ
âœ
Ã—
â

â›
âœ
âœ
Ã—
â

ğ‘ 

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘ )

ğ‘¡

âˆ«
ğ‘ 

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

TSIATIS and DAVIDIAN

Finally, consider

ğ¸{(ğ´9) Ã— (ğ´10)} = âˆ’ğ¸

ğ‘¡

Ã—

âˆ«
0

We can write (A17) as

ğ¼(ğ¸ â‰¤ ğ‘ )
ğ‘„(ğ‘ )

â›
âœ
ğ‘‘ Ìƒğ‘€(ğ‘¥)
âœ
â
ğ‘„(ğ‘¥)

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

21

(A17)

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

[

|

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

]

â
âŸ
âŸ
â 

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

(A18)

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

|

]

â
âŸ
âŸ
â 

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

(A19)

Because {ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)} is îˆ² (ğ‘ )-predictable, (A18) is equal to zero. Thus, consider (A19). Recalling from (A5)
that

|

]

â
âŸ
âŸ
â 

ğ‘‘ Ìƒğ‘€(ğ‘¥) = âˆ’ğ‘‘ğ¼(ğ¸ â‰¥ ğ‘¥) âˆ’

ğ¼(ğ¸ â‰¤ ğ‘¥)ğ‘‘ğ‘¥

ğ‘(ğ‘¥)
ğ‘„(ğ‘¥)

and noting that for ğ‘¥ â‰¥ ğ‘ 

ğ¼(ğ¸ â‰¤ ğ‘ ){âˆ’ğ‘‘ğ¼(ğ¸ â‰¥ ğ‘¥)} = 0,

ğ¼(ğ¸ â‰¤ ğ‘ )ğ¼(ğ¸ â‰¤ ğ‘¥) = ğ¼(ğ¸ â‰¤ ğ‘ ),

it follows that (A19) can be written as

ğ¸

âˆ«
â›
ğ‘ 
âœ
âœ
=
â

ğ‘¡

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
ğ‘„(ğ‘ )

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¼(ğ¸ â‰¤ ğ‘ )

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

ğ‘¡

âˆ«
ğ‘ 

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¸

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

[

|

]

(

[

|

]

)
(A20)

â
âŸ
âŸ
â 

Write the expectation in the integrand of (A20) as

ğ¸

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

([
+ ğ¸
Ã—

ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

|
{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)
([

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)} âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)

]
ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)
]

.

)

(A21)

Because the term in brackets in (A21) is some function ğ‘”âˆ—{ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}, say, it follows by an argument similar to that above
that the last two lines are equal to zero, and thus (A17) is equal to

)

]

[

|

|

ğ¸{(ğ´9) Ã— (ğ´10)} =

ğ‘¡

âˆ«
ğ‘ 

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¸

{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

.

(A22)

([

|

]

)

22

TSIATIS and DAVIDIAN

Combining the results in (A12), (A13), (A16), and (A22) demonstrates the desired result that
var{ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ (ğ´ âˆ’ ğœ‹)ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹)}
ğ‘„(ğ‘¡)

ğ¸{ğ‘šğ‘ (îˆ»(ğ‘ ))ğ‘šğ‘¡(îˆ»(ğ‘¡))} =

ğ‘¡

+

âˆ«
0

ğ‘(ğ‘¥)ğ‘‘ğ‘¥
ğ‘„2(ğ‘¥)

ğ¸

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¡ âˆ’ ğ‘¥)}

2ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥)

,

([

|

]

)

which is (A7).

Note that the inï¬‚uence function for the IPWCC estimator solving (15) is given by (13) with ğ‘“ (ğ‘‹) = â„{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} â‰¡ 0.

Using the equality (A1) and the deï¬nition of Ìƒğ‘€(ğ‘¥), the inï¬‚uence function for the IPWCC estimator can be written as

ğ‘šğ¼ğ‘ƒ ğ‘Š
ğ‘¡

(îˆ»(ğ‘¡)) =

ğ¼(ğ¸ â‰¤ ğ‘¡)
ğ‘„(ğ‘¡)

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’

ğ‘¡

âˆ«
0

ğ‘‘ Ìƒğ‘€(ğ‘¥)
ğ‘„(ğ‘¥)

[

That ğ¸{ğ‘šğ¼ğ‘ƒ ğ‘Š
IPWCC estimator also has the independent increments property.

(îˆ»(ğ‘ ))} = var{ğ‘šğ¼ğ‘ƒ ğ‘Š

(îˆ»(ğ‘ ))ğ‘šğ¼ğ‘ƒ ğ‘Š

ğ‘ 

ğ‘¡

ğ‘¡

ğ‘š(ğ‘Œ , ğ´, ğ‘‹) âˆ’ ğ¸{ğ‘š(ğ‘Œ , ğ´, ğ‘‹)

ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥}

ğ¼(ğ‘‡ â‰¥ ğ‘¡ âˆ’ ğ‘¥).

(îˆ»(ğ‘¡))} follows by an argument analogous to that above, demonstrating that the

|

]

In the practical implementation discussed in Section 4, the optimal choices ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} are approximated
using linear combinations of basis functions. Accordingly, the resulting AIPWCC estimators obtained via the two-step algorithm
may not be fully eï¬ƒcient and thus are not guaranteed to have the independent increments property. However, as demonstrated in
our simulation studies, because the approximations to ğ‘“ ğ‘œğ‘ğ‘¡(ğ‘‹) and â„ğ‘œğ‘ğ‘¡{ğ‘¢, ğ‘‹, ğ´, Ì„ğ¿(ğ‘¢)} are often quite good, the estimators them-
selves are good approximations to the eï¬ƒcient estimator and thus exhibit behavior very close to that of independent increments,
so that the operating characteristics of the trial are preserved.

B ADDITIONAL SIMULATION RESULTS

Simulation Scenario 1: Ordinal Categorical Outcome: Under the null hypothesis, based on 10000 Monte Carlo data sets, the
Monte Carlo sample covariance matrices of { Ì‚ğ›½(ğ‘¡1), â€¦ , Ì‚ğ›½(ğ‘¡4), Ì‚ğ›½(ğ‘¡ğ‘’ğ‘›ğ‘‘)}, where Ì‚ğ›½(ğ‘¡) is each of Ì‚ğ›½î‰€ğ¹
(ğ‘¡), Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and
Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡), are given by

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 0.086 0.049 0.034 0.026 0.021
[2,] 0.049 0.049 0.034 0.026 0.021
[3,] 0.034 0.034 0.034 0.026 0.021
[4,] 0.026 0.026 0.026 0.026 0.021
[5,] 0.021 0.021 0.021 0.021 0.021

betahat_IPW
[1,] 0.054 0.036 0.027 0.023 0.022
[2,] 0.036 0.036 0.027 0.023 0.022
[3,] 0.027 0.027 0.028 0.023 0.022
[4,] 0.023 0.023 0.023 0.023 0.022
[5,] 0.022 0.022 0.022 0.022 0.022

betahat_AIPW1

[,1] [,2] [,3] [,4] [,5]
[1,] 0.049 0.031 0.023 0.019 0.018
[2,] 0.031 0.032 0.023 0.019 0.018
[3,] 0.023 0.023 0.024 0.020 0.019
[4,] 0.019 0.019 0.020 0.020 0.018
[5,] 0.018 0.018 0.019 0.018 0.018

TSIATIS and DAVIDIAN

betahat_AIPW2

[,1] [,2] [,3] [,4] [,5]
[1,] 0.041 0.027 0.022 0.019 0.019
[2,] 0.027 0.028 0.021 0.019 0.018
[3,] 0.022 0.021 0.022 0.019 0.019
[4,] 0.019 0.019 0.019 0.019 0.018
[5,] 0.019 0.018 0.019 0.018 0.018

Under the alternative ğ›½ğ´ = log(1.5), the analogous Monte Carlo sample covariance matrices are

23

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 0.087 0.048 0.034 0.026 0.021
[2,] 0.048 0.049 0.034 0.026 0.021
[3,] 0.034 0.034 0.034 0.027 0.022
[4,] 0.026 0.026 0.027 0.027 0.022
[5,] 0.021 0.021 0.022 0.022 0.022

betahat_IPW

[,1] [,2] [,3] [,4] [,5]
[1,] 0.055 0.036 0.028 0.023 0.022
[2,] 0.036 0.036 0.028 0.023 0.022
[3,] 0.028 0.028 0.028 0.024 0.022
[4,] 0.023 0.023 0.024 0.024 0.022
[5,] 0.022 0.022 0.022 0.022 0.022

betahat_AIPW1

[,1] [,2] [,3] [,4] [,5]

[1,] 0.050 0.032 0.024 0.020 0.019
[2,] 0.032 0.032 0.024 0.020 0.019
[3,] 0.024 0.024 0.025 0.020 0.019
[4,] 0.020 0.020 0.020 0.020 0.019
[5,] 0.019 0.019 0.019 0.019 0.019

betahat_AIPW2
[1,] 0.042 0.027 0.022 0.019 0.019
[2,] 0.027 0.029 0.022 0.019 0.019
[3,] 0.022 0.022 0.022 0.019 0.019
[4,] 0.019 0.019 0.019 0.019 0.019
[5,] 0.019 0.019 0.019 0.019 0.019

These results clearly demonstrate that the independent increments property holds approximately for all estimators.

Simulation Scenario 2: Binary Outcome: Under the null hypothesis, based on 10000 Monte Carlo data sets, the Monte Carlo
sample covariance matrices of { Ì‚ğ›½(ğ‘¡1), â€¦ , Ì‚ğ›½(ğ‘¡4), Ì‚ğ›½(ğ‘¡ğ‘’ğ‘›ğ‘‘)}, where Ì‚ğ›½(ğ‘¡) is each of Ì‚ğ›½î‰€ğ¹
(ğ‘¡), Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡), are
given by

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 0.039 0.022 0.015 0.012 0.009
[2,] 0.022 0.021 0.015 0.011 0.009
[3,] 0.015 0.015 0.015 0.011 0.009
[4,] 0.012 0.011 0.011 0.011 0.009
[5,] 0.009 0.009 0.009 0.009 0.009

TSIATIS and DAVIDIAN

24

betahat_IPW

[,1] [,2] [,3] [,4] [,5]
[1,] 0.018 0.013 0.011 0.009 0.009
[2,] 0.013 0.013 0.010 0.009 0.009
[3,] 0.011 0.010 0.010 0.009 0.009
[4,] 0.009 0.009 0.009 0.009 0.009
[5,] 0.009 0.009 0.009 0.009 0.009

betahat_AIPW1

[,1] [,2] [,3] [,4] [,5]
[1,] 0.017 0.012 0.009 0.008 0.008
[2,] 0.012 0.012 0.009 0.008 0.008
[3,] 0.009 0.009 0.009 0.008 0.008
[4,] 0.008 0.008 0.008 0.008 0.008
[5,] 0.008 0.008 0.008 0.008 0.008

betahat_AIPW2

[,1] [,2] [,3] [,4] [,5]
[1,] 0.017 0.012 0.009 0.008 0.008
[2,] 0.012 0.012 0.009 0.008 0.008
[3,] 0.009 0.009 0.009 0.008 0.008
[4,] 0.008 0.008 0.008 0.008 0.008
[5,] 0.008 0.008 0.008 0.008 0.008

Under the alternative ğ›½ğ´ = log(0.247âˆ•0.33) = âˆ’0.290, the analogous Monte Carlo sample covariance matrices are

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 0.049 0.027 0.019 0.015 0.012
[2,] 0.027 0.027 0.019 0.014 0.012
[3,] 0.019 0.019 0.019 0.014 0.011
[4,] 0.015 0.014 0.014 0.014 0.011
[5,] 0.012 0.012 0.011 0.011 0.011

betahat_IPW

[,1] [,2] [,3] [,4] [,5]
[1,] 0.023 0.017 0.013 0.012 0.012
[2,] 0.017 0.017 0.013 0.012 0.011
[3,] 0.013 0.013 0.013 0.011 0.011
[4,] 0.012 0.012 0.011 0.011 0.011
[5,] 0.012 0.011 0.011 0.011 0.011

betahat_AIPW1

[,1] [,2] [,3] [,4] [,5]

[1,] 0.022 0.015 0.012 0.010 0.010
[2,] 0.015 0.015 0.012 0.010 0.010
[3,] 0.012 0.012 0.012 0.010 0.010
[4,] 0.010 0.010 0.010 0.010 0.010
[5,] 0.010 0.010 0.010 0.010 0.010

TSIATIS and DAVIDIAN

25

TABLE B1 For Scenario 2 with binary outcome, performance of estimators for ğ›½ under (a) the null hypothesis ğ›½ = 0 and (b)
the alternative ğ›½ = log(0.247âˆ•0.33) = âˆ’0.290 at each interim analysis time (ğ‘¡1, â€¦ , ğ‘¡4) = (150, 195, 240, 285) days and at the
ï¬nal analysis at ğ‘¡ğ‘’ğ‘›ğ‘‘ = 330 days MC Mean is the mean of 10000 Monte Carlo estimates; MC SD is the Monte Carlo standard
deviation, Ave MC SE is the mean of Monte Carlo standard errors, and MSE ratio is the ratio of Monte Carlo mean square error
for the AIPW2 estimator divided by that for the indicated estimator.

MC Mean MC SD

Ave MC SE MSE ratio

MC Mean MC SD

Ave MC SE MSE ratio

(a) Null Hypothesis

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

0.193
0.145
0.121
0.106
0.095

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

0.128
0.109
0.097
0.090
0.090

0.216
0.162
0.135
0.118
0.107

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

0.146
0.123
0.109
0.102
0.101

0.197
0.146
0.122
0.106
0.096

0.130
0.110
0.097
0.090
0.090

0.220
0.164
0.136
0.119
0.107

0.147
0.124
0.110
0.102
0.101

0.003
0.000
0.000
0.000
0.000

0.000
0.000
-0.001
0.000
0.000

-0.291
-0.291
-0.292
-0.291
-0.290

-0.291
-0.291
-0.291
-0.290
-0.290

1.000
1.000
1.000
1.000
1.000

2.302
1.761
1.587
1.389
1.123

0.000
0.000
-0.001
0.000
0.000

0.001
0.000
-0.001
0.000
0.000

(b) Alternative Hypothesis

1.000
1.000
1.000
1.000
1.000

2.246
1.734
1.545
1.377
1.109

-0.292
-0.291
-0.291
-0.290
-0.290

-0.291
-0.291
-0.291
-0.290
-0.290

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

0.136
0.115
0.102
0096
0.096

0.134
0.114
0.101
0.095
0.095

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.130
0.110
0.097
0.090
0.090

0.153
0.130
0.115
0.107
0.107

0.128
0.109
0.096
0.090
0.090

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

0.151
0.129
0.114
0.107
0.107

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

0.147
0.124
0.109
0.102
0.101

0.145
0.123
0.109
0.101
0.101

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

2.097
1.600
1.433
1.237
1.000

2.300
1.759
1.591
1.389
1.123

2.072
1.591
1.412
1.242
1.000

2.249
1.736
1.548
1.373
1.109

betahat_AIPW2

[,1] [,2] [,3] [,4] [,5]

[1,] 0.022 0.015 0.012 0.010 0.010
[2,] 0.015 0.015 0.012 0.010 0.010
[3,] 0.012 0.012 0.012 0.010 0.010
[4,] 0.010 0.010 0.010 0.010 0.010
[5,] 0.010 0.010 0.010 0.010 0.010

These results clearly demonstrate that the independent increments property holds approximately for all estimators.

Table B1 presents performance of the estimators under the null and alternative hypotheses.

26

TSIATIS and DAVIDIAN

Simulation Scenario 3: Continuous Outcome: Under the null hypothesis, based on 10000 Monte Carlo data sets, the Monte
(ğ‘¡), Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡), Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡), and Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡),
Carlo sample covariance matrices of { Ì‚ğ›½(ğ‘¡1), â€¦ , Ì‚ğ›½(ğ‘¡4), Ì‚ğ›½(ğ‘¡ğ‘’ğ‘›ğ‘‘)}, where Ì‚ğ›½(ğ‘¡) is each of Ì‚ğ›½î‰€ğ¹
are given by

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 11.67 7.84 5.85 4.65 3.85
[2,] 7.84 7.89 5.87 4.69 3.90
[3,] 5.85 5.87 5.83 4.65 3.87
[4,] 4.65 4.69 4.65 4.63 3.86
[5,] 3.85 3.90 3.87 3.86 3.88

\betahat_IPW

[,1] [,2] [,3] [,4] [,5]
[1,] 11.67 7.84 5.85 4.65 3.85
[2,] 7.84 7.89 5.87 4.69 3.90
[3,] 5.85 5.87 5.83 4.65 3.87
[4,] 4.65 4.69 4.65 4.63 3.86
[5,] 3.85 3.90 3.87 3.86 3.88

\betaht_AIPW1

[,1] [,2] [,3] [,4] [,5]
[1,] 10.65 6.81 4.82 3.82 3.14
[2,] 6.81 7.08 5.04 3.86 3.19
[3,] 4.82 5.04 5.13 3.96 3.16
[4,] 3.82 3.86 3.96 3.94 3.16
[5,] 3.14 3.19 3.16 3.16 3.17

betahat_AIPW2

[,1] [,2] [,3] [,4] [,5]
[1,] 7.92 5.47 4.27 3.50 3.17
[2,] 5.47 5.44 4.17 3.49 3.16
[3,] 4.27 4.17 4.15 3.48 3.16
[4,] 3.50 3.49 3.48 3.46 3.16
[5,] 3.17 3.16 3.16 3.16 3.17

Under the alternative ğ›½ğ´ = 6.24, the analogous Monte Carlo sample covariance matrices are

betahat_Tf

[,1] [,2] [,3] [,4] [,5]
[1,] 11.71 7.87 5.88 4.67 3.86
[2,] 7.87 7.92 5.90 4.71 3.91
[3,] 5.88 5.90 5.85 4.67 3.89
[4,] 4.67 4.71 4.67 4.65 3.88
[5,] 3.86 3.91 3.89 3.88 3.89

27

TSIATIS and DAVIDIAN

betahat_IPW

[,1] [,2] [,3] [,4] [,5]
[1,] 11.71 7.87 5.88 4.67 3.86
[2,] 7.87 7.92 5.90 4.71 3.91
[3,] 5.88 5.90 5.85 4.67 3.89
[4,] 4.67 4.71 4.67 4.65 3.88
[5,] 3.86 3.91 3.89 3.88 3.89

betahat_AIPW1

[,1] [,2] [,3] [,4] [,5]
[1,] 10.69 6.84 4.84 3.83 3.15
[2,] 6.84 7.10 5.06 3.87 3.20
[3,] 4.84 5.06 5.15 3.97 3.18
[4,] 3.83 3.87 3.97 3.95 3.17
[5,] 3.15 3.20 3.18 3.17 3.18

betahat_AIPW2

[,1] [,2] [,3] [,4] [,5]
[1,] 7.94 5.49 4.29 3.52 3.18
[2,] 5.49 5.46 4.18 3.51 3.17
[3,] 4.29 4.18 4.16 3.49 3.18
[4,] 3.52 3.51 3.49 3.47 3.18
[5,] 3.18 3.17 3.18 3.18 3.18

Table B2 presents performance of the estimators under the null and alternative hypotheses.

28

TSIATIS and DAVIDIAN

TABLE B2 For Scenario 3 with continuous outcome, performance of estimators for ğ›½ under (a) the null hypothesis ğ›½ = 0 and
(b) the alternative ğ›½ = 6.24 at each interim analysis time (ğ‘¡1, â€¦ , ğ‘¡4) = (104, 130, 156, 182) days and at the ï¬nal analysis at
ğ‘¡ğ‘’ğ‘›ğ‘‘ = 208 days MC Mean is the mean of 10000 Monte Carlo estimates; MC SD is the Monte Carlo standard deviation, Ave
MC SE is the mean of Monte Carlo standard errors, and MSE ratio is the ratio of Monte Carlo mean square error for the AIPW2
estimator divided by that for the indicated estimator.

MC Mean MC SD

Ave MC SE MSE ratio

MC Mean MC SD

Ave MC SE MSE ratio

(a) Null Hypothesis

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

3.415
2.781
2.407
2.151
1.962

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

3.222
2.609
2.247
1.975
1.772

3.421
2.786
2.411
2.154
1.966

Ì‚ğ›½î‰€ğ¹

(ğ‘¡)

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 1(ğ‘¡)

3.227
2.613
2.250
1.979
1.775

3.416
2.809
2.414
2.152
1.969

3.264
2.660
2.265
1.985
1.780

3.422
2.815
2.419
2.157
1.973

3.269
2.665
2.269
1.989
1.783

0.012
0.010
-0.001
-0.005
0.005

0.007
-0.006
0.002
-0.001
0.008

6.230
6.208
6.216
6.213
6.223

6.225
6.212
6.220
6.217
6.226

1.000
1.000
1.000
1.000
1.000

1.095
1.115
1.136
1.176
1.225

0.012
0.010
-0.001
-0.005
0.005

-0.009
-0.003
0.001
-0.001
0.008

(b) Alternative Hypothesis

1.000
1.000
1.000
1.000
1.000

1.096
1.115
1.137
1.176
1.225

6.230
6.208
6.216
6.213
6.223

6.210
6.216
6.219
6.217
6.226

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

3.416
2.809
2.414
2.152
1.969

3.380
2.763
2.395
2.142
1.956

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

2.813
2.332
2.037
1.859
1.780

3.422
2.815
2.419
2.157
1.973

2.721
2.284
2.014
1.839
1.772

Ì‚ğ›½ğ¼ğ‘ƒ ğ‘Š (ğ‘¡)

3.386
2.768
2.399
2.146
1.959

Ì‚ğ›½ğ´ğ¼ğ‘ƒ ğ‘Š 2(ğ‘¡)

2.818
2.336
2.041
1.863
1.783

2.726
2.288
2.017
1.842
1.775

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

ğ‘¡1
ğ‘¡2
ğ‘¡3
ğ‘¡4
ğ‘¡ğ‘’ğ‘›ğ‘‘

1.000
1.000
1.000
1.000
1.000

1.474
1.452
1.405
1.340
1.225

1.000
1.000
1.000
1.000
1.000

1.474
1.452
1.405
1.341
1.225

TSIATIS and DAVIDIAN

References

29

1. Tsiatis A. Information-based monitoring of clinical trials. Stat Med 2006; 25: 3236â€“3244.

2. Pocock S. Group sequential methods in the design and analysis of clinical trials. Biometrika 1977; 64: 191â€“199.

3. Oâ€™Brien P, Fleming T. A multiple testing procedure for clinical trials. Biometrics 1979; 35: 549â€“556.

4. ClinicalTrials.gov, National Library of Medicine (US) . ACTIV-3b: Therapeutics for Severely Ill Inpatients With COVID-19

(TESICO). NCT04843761. https://clinicaltrials.gov/ct2/show/NCT04843761; .

5. ClinicalTrials.gov, National Library of Medicine (US) . ACTIV-2: A Study for Outpatients With COVID-19. NCT04518410.

https://clinicaltrials.gov/ct2/show/NCT04518410; .

6. Lu X, Tsiatis A. Semiparametric estimation of treatment eï¬€ect with time-lagged response in the presence of informative

censoring. Lifetime Data Anal 2011; 17: 566â€“593.

7. Tsiatis A. Semiparametric Theory and Missing Data. New York, NY: Springer . 2006.

8. Scharfstein D, Tsiatis A, Robins J. Semiparametric eï¬ƒciency and its implication on the design and analysis of group

sequential studies. J Am Stat Assoc 1997; 92: 1342â€“1350.

9. Lan K, DeMets D. Discrete sequential boundaries for clinical trials. Biometrika 1983; 70: 659â€“663.

10. Tsiatis A, Davidian M, Holloway S. Estimation of the odds ratio in a proportional odds model with censored time-lagged

outcome in a randomized clinical trial. Biometrics 2021; 78: 1â€“13.

11. Hellmich M. Monitoring clinical trials with multiple arms. Biometrics 2001; 57: 892â€“898.

12. Wason J. Design of multi-arm, multi-stage trials in oncology. In: Halabi S, Michiels S., eds. Textbook of Clinical Trials in

Oncology: A Statistical Perspective. New York: Chapman and Hall/CRC Press. 2019 (pp. 155-182).

13. Agresti A. An Introduction to Categorical Data Analysis. New York, NY: Wiley . 2019.

14. Stefanski L, Boos D. The calculus of M-estimation. Amer Statist 2002; 56: 29â€“38.

15. Zhang M, Tsiatis A, Davidian M. Improving eï¬ƒciency of inferences in randomized clinical trials using auxiliary covariates.

Biometrics 2008; 64: 707â€“715.

16. Kim KM, Tsiatis AA. Independent increments in group sequential tests: a review. SORT - Statistics and Operations Research

Transactions 2020; 44: 223â€“264.

17. Casper C, Cook T, Perez OA. Package ldbounds: Lan-DeMets method for group sequential boundaries. Comprehensive R

Archive Network. https://cran.r-project.org/package=ldbounds; .

18. Mehta CR, Tsiatis AA. Flexible sample size considerations using information-based interim monitoring. Drug Info J 2001;

35: 1095â€“1112.

19. Venables W, Ripley B. Modern Applied Statistics with S, 4th edition. New York, NY: Springer . 2002.

