2
2
0
2

n
u
J

7
1

]
T
A
.
h
t
a
m

[

1
v
8
1
8
8
0
.
6
0
2
2
:
v
i
X
r
a

PROJECTED DISTANCES FOR MULTI-PARAMETER
PERSISTENCE MODULES

NICOLAS BERKOUK AND FRANÇOIS PETIT

Abstract. We introduce the new notions of projected distances and projected
barcodes for multi-parameter persistence modules. Projected barcodes are de-
ﬁned as derived pushforward of persistence modules onto R. Projected distances
come in two ﬂavors: the integral sheaf metrics (ISM) and the sliced convolution
distances (SCD). We conduct a systematic study of the stability of projected
barcodes and show that the ﬁbered barcode is a particular instance of pro-
jected barcodes. We prove that the ISM and the SCD provide lower bounds
for the convolution distance. Furthermore, we show that the γ-linear ISM and
the γ-linear SCD which are projected distances tailored for γ-sheaves can be
computed using TDA software dedicated to one-parameter persistence mod-
ules. Moreover, the time and memory complexity required to compute these
two metrics are advantageous, since our approach does not require computing
nor storing an entire n-persistence module.

Contents

Introduction

1.
2. Sheaves
2.1. Composition of kernels and integral transforms
2.2. Convolution distance
2.3. Constructible sheaves up to inﬁnity
3. γ-sheaves
3.1. Distances comparison
3.2. The dimension one case
3.3. Fibered barcodes
4. Linear dimensionality reduction
4.1. Linear direct image of sheaves
4.2. Linear direct image of γ-sheaves
4.3. Sub-level set persistence
4.4. Properties γ-compactly generated sheaves
5. Projected barcodes
5.1. Motivations and example
5.2. F-Projected barcodes

2
4
5
6
10
11
12
15
18
20
20
22
25
27
30
31
32

N. B. was supported by the Swiss Innovation Agency (Innosuisse project 41665.1 IP-ICT).
F. P. was supported by the IdEx Université Paris Cité, ANR-18-IDEX-0001.

1

 
 
 
 
 
 
2

NICOLAS BERKOUK AND FRANÇOIS PETIT

Integral sheaf metrics

5.3. Fibered versus Projected Barcodes
6.
6.1. Generalities
6.2. A comparison result
6.3. Lipschitz ISM
6.4. Distance kernel
6.5. Linear ISM
6.6. Sliced convolution distance
6.7. A Question
7. Metric for multi-parameter persistence modules
7.1. γ-linear ISM
7.2. γ-sliced convolution distance
7.3. Some aspects of the computation of the γ-linear ISM and the γ-sliced

convolution distance

References

34
37
37
39
39
41
42
42
43
44
44
48

49
51

1. Introduction

In this paper, we approach the study of multi-parameter persistence modules
through the lens of derived and microlocal sheaf theory of Masaki Kashiwara and
Pierre Schapira [15] as initiated in [16]. In this setting, building upon [16], the
authors have proved, in previous work [3], that a multi-parameter persistence
module can be identiﬁed to a γ-sheaf (see equation (3.2)).

Multi-parameter persistence is diﬃcult both in theory (there cannot exist any
notion of barcode after [5]), and in practice (the interleaving distance is NP-
hard to compute [4]). Using tools from sheaf theory, we develop new invariants
and pseudo-metrics that can be eﬃciently computed on speciﬁc classes of multi-
parameter persistence modules thanks to [1, 2]: sub-level and level sets multi-
parameter persistence modules.

It follows from [23] that these pseudo-metrics provide lower bounds for the
interleaving distance, and we show how to eﬃciently approximate them using
only one-parameter persistence software such as [28, 29], for sub-level and level
sets persistence modules. Moreover, the time and memory complexity required to
compute these distances are advantageous, since our approach does not require
computing nor storing an entire n-persistence module in the machine.

Our strategy is to reduce the study of multi-parameter persistence modules to
one-parameter persistence modules. Such an idea has already been implemented
in topological data analysis with, for instance, the ﬁbered barcode and the match-
ing distance [7, 18]. These objects are obtained by considering restrictions of
multi-parameter persistence modules along aﬃne lines. In a sheaf theoretic lan-
guage, this corresponds to pulling back persistence modules along the inclusion
of a line into the parameter space. In the sheaf theoretic setting, the pullback

PROJECTED DISTANCES

3

operation has an adjoint operation, which is called the pushforward. This later
operation is diﬃcult to describe in the language of persistence modules, though
it is straightforward to construct and enjoys several properties in the setting of
sheaves. Here, considering multi-parameter persistence modules as sheaves, we
study their derived pushforward by real-valued functions. Roughly speaking, this
operation can be thought as projecting a sheaf on the real line. Doing so and un-
der suitable ﬁniteness assumptions, one obtains a constructible sheaf on R which
admits a barcode decomposition. Varying the map used to pushforward the sheaf
within a prescribed family of functions F, one gets a family of barcodes called the
F-projected barcodes (Deﬁnition 5.1). Motivated by computability constraints, we
mostly focus our attention on the case of pushforwards of γ-sheaves by linear
forms.

Following the same strategy of reducing the study of multiparameter persis-
tent modules to the study of family of one-dimensional persistent modules, we
introduce the notion of integral sheaf metric (see equations (6.1) and (6.2)). The
distance between two sheaves is the supremum of the distances between the push-
forwards of the sheave by morphisms belonging to a family F. Again, using a
similar approach, we introduce sliced convolution distances (see equations (6.6)
and (7.3))

Implementing such an approach requires relating precisely the classical theory
of persistent modules and sheaf theory. This has largely been achieved thanks
to several works: [1, 2, 3, 13, 16, 20]. Heuristically, this correspondence goes as
follows.

Persistence theory
level sets persistence
sub-level sets persistence
interleaving distances
tame

Sheaf theory
sheaves for the usual topology
sheaves for the γ-topology
convolution distances
γ-constructible at inﬁnity

In Section 3, using results of [23], we reﬁne this correspondence by extending
to all γ-sheaves the isometry of [3] between the interleaving distance and the
convolution distance (Theorem 3.7).

Our analysis will treat both ﬂavors of persistence in the sheaf language. The ﬁrst
one –level-sets persistence– is simpler, because after [2], the level-sets persistence
modules associated to a function f : X → R is (almost-)equivalent to the derived
pushforward of the constant sheaf on X by f . The stability and general properties
of the projected barcodes and ISM for level-sets persistence follow easily from a
recent result [23], expressing that pushforwards functors by C-Lipschitz maps are
C-Lipschitz for the convolution distances. We also obtain non-degeneracy results
for the ISM using projective duality.

Our strategy for sub-level sets persistence modules is more involved and pro-
ceeds in three steps. We start with a careful study of pushforwards of γ-sheaves

4

NICOLAS BERKOUK AND FRANÇOIS PETIT

by linear forms using microlocal techniques (Proposition 4.5). This allows to de-
scribe the pushforward of a γ-sheaf by a linear form lying outside of the union
of the polar cone of γ and its antipodal. We then make precise in Proposition
4.17 the intuition that sub-level sets persistence is the gammaiﬁcation of level-sets
persistence. Importantly, this allows us to prove that under mild conditions, the
pushforward by a linear form u satisfying a certain positivity assumption of the
sub-level sets persistence module associated to a function f : X → Rn is the
one-parameter sub-level sets persistence module associated to u ◦ f . Elaborating
on these results, we derive several results of theoretical and practical importance.
We prove in Corollary 4.27 that multi-parameter sub-level sets persistence is
at least as sensitive as the most sensitive of its coordinate functions. To the
best of our knowledge, this result was not known from the Topological Data
Analysis (TDA) community. We further prove in Proposition 5.13 that the ﬁbered
barcode and matching distances can be expressed as projected barcodes and ISM.
Therefore, the framework of projected barcodes and ISM can be considered as
a generalization of ﬁbered barcodes.
In Subsections 6.6 and 7.2, we introduce
sliced version of the convolution distance for sheaves satisfying suitable ﬁniteness
conditions

Our theoretical study allows to provide an approximation scheme by gradient
ascent of the γ-linear ISM, using only one-parameter persistence software. Sim-
ilarly, the γ-sliced convolution distance between multi-parameter sub-level sets
persistence module can be approximated using only one-parameter persistence
software. As a proof of concept, we implemented these computations in Python
and present an experiment. The implications for topological machine learning of
the γ-linear ISM will be explored further in a companion paper.

2. Sheaves

This section introduces the necessary background on sheaf theory, convolution
distance, and its links with persistence. The main reference for general results on
sheaves is [15]. The convolution distance for sheaves has been introduced in [16]
and generalized in [23]. A useful notion for our purpose is the one of constructible
sheaves up to inﬁnity, which was introduced recently by Schapira in [26].

Recall that a topological space is good if it is Hausdorﬀ, locally compact, count-
able at inﬁnity and of ﬁnite ﬂabby dimension. Let k be a ﬁeld and let X be a
good topological space.

We denote by D(kX) the derived category of sheaves of k-vector space on X,
by Db(kX) the bounded derived categories of sheaves, that is the full subcategory
of D(kX) whose objects are the F ∈ D(kX) such that there exists n ∈ N such
that for every k ∈ Z with |k| ≥ n, Hk(F ) = 0. We write Db
comp(kX) for the full
subcategory of Db(kX) spanned by the objects with compact support

PROJECTED DISTANCES

5

In this text, we will freely make use of techniques from microlocal sheaf theory
for which, we refer the reader to [15]. Nonetheless, microlocal techniques will
mostly appears in proofs and not in the results themselves. Hence a reader only
interested in the results may ignore them. Let M be a smooth manifold.

• We denote by or M its orientation sheaf and by ωM its dualizing sheaf.
Recall that ωM = or M [dim M ]. We will also need the duality functors

M (·) := RH om kM
D0

(·, kM ),

DM (·) := RH om kM

(·, ωM ).

• If Z is a locally closed subset of M , we denote by kZ the sheaf associated

to the locally closed subset Z.

• We write T ∗M for the cotangent bundle of M and set ˙T ∗M = T ∗M \ 0M ,

with 0M the zero section of T ∗M .

• For F ∈ Db(kM ), we denote by SS(F ) the microssuport of F . It is a closed
conical co-isotropic subset of T ∗M . We refer the reader to [15, Chapter
V] for a detailed presentation of this notion.

• Following [15, §6.1], let V be a susbet of T ∗M . We deﬁne the full subcat-

egory Db

V (kM ) of Db(kM ) by setting:
Ob(Db

V (kM )) = {F ∈ Ob(Db(kM ))| SS(F ) ⊂ V }

• Let Ω = T ∗M \ V , we set

Db(kM ; Ω) = D(kM )/ Ob(Db

V (kM ))

for the localisation of D(kM ) with respects to the null system generated by
V (kM ). The category Db(kM ; Ω) is a triangulated category.
the object of Db
• We will encounter the technical notion of cohomologically constructible

sheaf for which we refer the reader to [15, §3.4].

2.1. Composition of kernels and integral transforms. In this section, we
set up a few notations and present an associativity criterion for non-proper com-
position of kernels.

Given topological spaces Xi (i = 1, 2, 3), we write Xij for Xi × Xj, X123 for
X1 × X2 × X3, pi : Xij → Xi and pij : X123 → Xij for the projections. One deﬁnes
the composition of kernels for Kij ∈ Db(kXij ) as

K12 ◦
2
np
◦
2

K12

K23 := Rp13!(p−1

12 K12 ⊗ p−1

23 K23),

K23 := Rp13∗(p−1

12 K12 ⊗ p−1

23 K23).

To a sheaf K ∈ Db(kX12), one associate the following functor
ΦK : Db(kX1) → Db(kX2), F 7→ Rp2!(K ⊗ p−1
Example 2.1. Let V be a real vector space of dimension n+1. We set ˙V := V\{0}
and R× for the multiplicative group R \ {0}. We consider Pn := ˙V/R× the

1 F )

6

NICOLAS BERKOUK AND FRANÇOIS PETIT

projective space of dimension n. The dual projective space P∗n is deﬁned similarly
with V replaced by V∗. We consider the subset

(2.1)

A = {(x, y) ∈ Pn × P∗n| hx, yi = 0}

and the sheaf kA. The integral transform associated to the kernel kA

ΦkA : Db(Pn) → Db(P∗n), F 7→ kA ◦ F

induces an equivalence of categories

ΦkA : Db(Pn, ˙T ∗Pn) → Db(P∗n, ˙T ∗P∗n)

This is a consequence of [15, Thm 7.2.1] and we refer the reader to [12] for a
detailed study.

The proper composition of kernel − ◦
2

− is associative. This is not the case of

the non-proper one −

−. Nonetheless, we have the following result.

np
◦
2

Theorem 2.2 ([23, Thm 2.1.8]). Let Xi (i = 1, 2, 3, 4), be four C ∞-manifolds and
let Ki ∈ Db(kXi,i+1), (i = 1, 2, 3). Assume that K1 is cohomologically constructible,
q1 is proper on Supp(K1) and SS(K1) ∩ (T ∗

X1X1 × T ∗X2) ⊂ T ∗

X12X12. Then

K1

np
◦
2

(K2

np
◦
3

K3) ’ (K1

np
◦
2

K2)

np
◦
3

K3.

2.2. Convolution distance. It is possible to equip the derived categories of
sheaves on a good metric space (X, dX) with a pseudo-metric [23]. This pseudo-
metric generalized the convolution distance of [16] from normed ﬁnite dimensional
real vector spaces to good metric spaces. Hence, we will also refer to this extension
as the convolution distance. The deﬁnition of a good metric space and the con-
struction of this pseudo-metric on Db(kX) are involved and we do not need them
explicitly. Hence, we do not recall them here and only review the deﬁnition of the
convolution distance in the special case of sheaves on a normed ﬁnite dimensional
real vector space. Nonetheless, we will state and prove some of the results at the
level of generality of sheaves on a good metric spaces.

We consider a ﬁnite dimensional real vector space V endowed with a norm k · k.
We equip V with the topology induced by the norm k·k. Following [16], we brieﬂy
present the convolution distance. We introduce the following notations:

s : V × V → V, s(x, y) = x + y

pi : V × V → V (i = 1, 2) p1(x, y) = x, p2(x, y) = y.
The convolution bifunctor ? : Db(kV) × Db(kV) → Db(kV) and the non-proper
np
? : Db(kV) × Db(kV) → Db(kV) are deﬁned as follows. For

convolution bifunctor

PROJECTED DISTANCES

7

F, G ∈ Db(kV), we set

F ? G := Rs!(F (cid:2) G),
np
? F := Rs∗(F (cid:2) G).

F

We consider the morphism

u : V × V → V,

(x, y) 7→ x − y.

We will need the following elementary formula relating non-proper convolution
and non-proper composition.

Lemma 2.3. Let F, G ∈ Db(kV). Then

np
◦ G ’ F

(i) (u−1F )
np
◦ u−1G ’ u−1(F

(ii) u−1F

np
? G

np
? G)

Proof. We will only prove (i), the proof of (ii) being similar.

u−1F

np
◦ G ’ Rp1∗(u−1F ⊗ p−1

2 G)
’ Rp1∗((u × id)−1p−1
’ Rp1∗(u × id)−1(F (cid:2) G)
’ Rp1∗R(s × id)∗(F (cid:2) G)
’ F

np
? G.

1 F ⊗ (u × id)−1p−1

2 G)

(cid:3)

For r ≥ 0, let Kr := kBr with Br = {x ∈ V | kxk ≤ r}. For r < 0, we set

Kr := k{x∈V| kxk<−r}[n] (where n is the dimension of V).

The following proposition is proved in [16].

Proposition 2.4. Let r, r0 ∈ R and F ∈ Db(kV). There are functorial isomor-
phisms

(Kr ? Kr0) ? F ’ Kr+r0 ? F and K0 ? F ’ F.

If r ≥ r0 ≥ 0, there is a canonical morphism χr,r0 : Kr → Kr0 in Db(kV). It
induces a canonical morphism χr,r0 ? F : Kr ? F → Kr0 ? F . In particular when
r0 = 0, we get

(2.2)

χr,0 ? F : Kr ? F → F.

Following [16], we recall the notion of c-isomorphic sheaves.

Deﬁnition 2.5. Let F, G ∈ Db(kV) and let c ≥ 0. The sheaves F and G are
c-isomorphic if there are morphisms f : Kr ? F → G and g : Kr ? G → F such
that the diagrams

8

NICOLAS BERKOUK AND FRANÇOIS PETIT

K2r ? F

K2r?f

Kr ? G

χ2r,0?F

K2r ? G

K2r?g

Kr ? F

g

f

(cid:47) F ,

(cid:47) G .

χ2r,0?G

are commutative. The pair of morphisms f, g is called a pair of r-isomorphisms.

Deﬁnition 2.6. For F, G ∈ Db(kV), their convolution distance is

distV(F, G) := inf({r ≥ 0 | F and G are r − isomorphic} ∪ {∞}).

It is proved in [16] that the convolution is, indeed, a pseudo-extended metric,
that is, it satisﬁes the triangular inequality. The following properties of the con-
volution distance are well-known to the specialists. We include them with proofs
for the convenience of the reader as we do not know references for them.

Lemma 2.7. Let (V, k·k) be a real ﬁnite dimensional normed vector space. Let
F, G ∈ Db(kV).

(i) Let v ∈ V τv : V → V, x 7→ x − v, then

distV(τv∗F, τv∗G) = distV(F, G).

(ii) let λ ∈ R≥0 and hλ : V → V, x 7→ λx. Then

distV(hλ∗F, hλ∗G) = λ distV(F, G).

Proof. (i) For F ∈ Db(kX), there are the following natural isomorphism

Kr ? τv∗F ’ s!(id × τ−v)−1(Kr (cid:2) F )
’ τv∗(Kr ? F ).

Let F, G ∈ Db(kV) and assume that they are c-isomorphic. Let f : Kr ? F → G
and g : Kr ? G → F be a pair of c-isomorphisms. Then, we have the morphisms

f 0 : Kr ? τv∗F ’τv∗(Kr ? F ) τv ∗f−→ τv∗G,
g0 : Kr ? τv∗G ’τv∗(Kr ? G) τv ∗f−→ τv∗F

It is straightforward to verify that (f 0, g0) is a pair of c-isomorphisms. On shows
similarly that if τv∗F and τv∗G are c-isomorphic, then F and G are c-ismorphic.

(cid:47)
(cid:47)
(cid:55)
(cid:55)
(cid:47)
(cid:47)
(cid:47)
(cid:55)
(cid:55)
(cid:47)
(ii) We ﬁrst observe that

PROJECTED DISTANCES

Kr ? hλ∗F ’ hλ∗(Kr ? F )
1/λKr) ? F

’ (h−1
’ Kλr ? F.

Then, we notice that hλ∗(χr,0) ’ χλr,0 which conclude the proof.

We now recall several key inequalities for the convolution distance.

9

(cid:3)

Proposition 2.8 ([16, Prop. 2.6]).

(i) Let F, G ∈ Db(kV) and a ∈ R≥0.

If

distV(F, G) ≤ a then distV(DV(F ), DV(G)) ≤ a,
(ii) Assume that distV(Fi, Gi) ≤ ai (i = 1, 2) then one has

distV(F1 ? F2, G1 ? G2) ≤ a1 + a2.

Lemma 2.9. For F, G ∈ Db

Rc(kV), distV(DV(F ), DV(G)) = distV(F, G).

Proof. By Proposition 2.8, we have that distV(DV(F ), DV(G)) ≤ distV(F, G). As
F and G are constructible, it follows from [15, Prop. 3.4.3], that DV(DV(F )) ’ F
and similarly for G. It follows that

distV(F, G) = distV(DV(DV((F )), DV(DV((G)))

≤ distV(DV(F ), DV(G)).

Hence, distV(F, G) = distV(DV(F ), DV(G)).

(cid:3)

Let X be a topological space, (V, k·k) be a normed ﬁnite dimensional real vector

space and f1, f2 : X → V be two continuous maps. We set

kf1 − f2k∞ = sup
x∈X

kf1(x) − f2(x)k .

Theorem 2.10 ([16, Thm. 2.7]). Let X be a good topological space and f1, f2 :
X → V be two continuous maps. Then for any F ∈ Db(kX), we have

distV(Rf1!F, Rf2!F ) ≤ kf1 − f2k∞

distV(Rf1∗F, Rf2∗F ) ≤ kf1 − f2k∞ .

Theorem 2.11 ([23, Corollary 2.5.9.]). Let (X, dX) and (Y, dY ) be two good metric
spaces and f : X → Y a K-Lipschitz map. Then, for every F, G ∈ Db(kX)

distX(Rf!F, Rf!G) ≤ K distY (F, G),

If moreover X and Y are ﬁnite dimensional vector spaces and dX and dY are
euclidean distances, then one also has

distY (Rf∗F, Rf∗G) ≤ K distX(F, G).

10

NICOLAS BERKOUK AND FRANÇOIS PETIT

2.3. Constructible sheaves up to inﬁnity. We review in this section the notion
of sheaves constructible up to inﬁnity, which was recently introduced by Schapira
in [26]. The geometric setting is the following. Let (V, k·k) be a real vector space
of dimension n endowed with a norm. We denote by P the projectivisation of V.
That is, we consider the n dimensional projective space P(V ⊕ R). We also write
P∗ for the projectivization of V∗. We have the open immersion:

j : V → P,

x 7→ [x, 1].

In particular, j is an open embedding of real analytic manifolds, whose image is
relatively compact.

Proposition 2.12 ([26, Lemma 2.7]). Let F ∈ Db
alent.

Rc(kV). The following are equiv-

(i) The micro-support SS(F ) is subanalytic in T ∗P,
(ii) The microsupport SS(F ) is contained in a locally closed R+-conic subanalytic

isotropic subset of T ∗P,
Rc(kP),

(iii) j!F ∈ Db
(iv) Rj∗F ∈ Db

Rc(kP).

Deﬁnition 2.13. If F ∈ Db
we say that F is constructible up to inﬁnity. We denote by Db
triangulated subcategory of Db
to inﬁnity.

Rc(kV) satisﬁes any (hence all) of the conditions above,
Rc(kV∞) the full
Rc(kV) whose objects are sheaves constructible up

The following is a special case of [26, Deﬁnition 2.5].

Deﬁnition 2.14. Let V and W be two ﬁnite dimensional real vector spaces, and
P and P0 their respective projectivization. A map f : V → W is subanalytic up
to inﬁnity if its graph Γf ⊂ V × W is subanalytic in P × P0.

Notations 2.15. We write

(i) A(V∞) for the set of morphism of analytic manifolds from V to R which are

subanalytic up to inﬁnity.

(ii) SC(V∞) for the set of continuous maps from V to R which are subanalytic

up to inﬁnity.

Let V and W be two ﬁnite dimensional real vector spaces, P and P0 their re-

spective projectivization and f : V → W an element of SC(V∞).

Proposition 2.16. Let F ∈ Db
f −1G, f !G, Rf∗F , and Rf!F are constructible up to inﬁnity.

Rc(kV∞) and G ∈ Db

Rc(kW∞). Then, the sheaves

Proof. This follows immediately from [26, Lem. 1.1] and [26, Cor. 2.1’]

(cid:3)

Corollary 2.17 ([26, Corollary 2.13]). With the same notations, one has Rf∗F ’
DWRf!DVF and f !G ’ DVf −1DWG.

PROJECTED DISTANCES

11

3. γ-sheaves

The interplay between sheaves on a real vector space and persistence theory
necessitates the use of a topology on a vector space introduced by Kashiwara
and Schapira [15], called the γ-topology. In this section, we ﬁrst recall the basic
deﬁnitions associated to the γ-topology. There is a notion of interleaving distance
between sheaves on the γ-topology, which the authors proved to coincide under
some properness hypothesis with the convolution distance [3, Corollary 5.9]. Here,
we strengthen this result by removing the properness assumption. We then recall
some results speciﬁc to the dimension one case, where γ-sheaves have a graded-
barcode [1]. We end the section with the notion of ﬁbered barcode which was
introduced in [7] for persistence modules, that we translate in our γ-sheaf setting.
Let V be a ﬁnite dimensional real vector space. We write a : x 7→ −x for the
If A is a subset of V, we write Aa for the image of A by the

antipodal map.
antipodal map. A subset γ of the vector space V is a cone if

(i) 0 ∈ γ,
(ii) R>0 γ ⊂ γ.
A convex cone γ is proper if γa ∩ γ = {0}. The polar cone γ◦ of a cone γ ⊂ V is
the cone of V∗

γ◦ = {ξ ∈ V∗ | ∀v ∈ γ, hξ, vi ≥ 0}.

From now on, we assume that γ is a

(3.1)

closed proper convex cone with non-empty interior.
We say that a subset A of V is γ-invariant if A = A + γ. The set of γ-invariant
open subset of V is a topology on V called the γ-topology. We denote by Vγ
the vector space V endowed with the γ-topology. We write φγ : V → Vγ for the
continuous map whose underlying function is the identity.

We set, following [16],

(3.2)

Db

γ◦,a(kV) = {F ∈ Db(kV) | SS(F ) ⊂ V × γ◦,a},

We call an object of Db

γ◦,a(kV) a γ-sheaf. This terminology is motivated by the

following result.
Theorem 3.1 ([16, Thm. 1.5]). Let γ be a proper closed convex cone in V. The
functor Rφγ ∗ : Db
γ◦,a(kV) → Db(kVγ ) is an equivalence of triangulated categories
with quasi-inverse φ−1
γ .

The canonical map kγa → k{0} induces a morphism

(3.3)

np
? kγa → F.

F

Proposition 3.2 ([14, Prop. 3.9]). Let F ∈ Db(kV). Then F ∈ Db
only if the morphism (3.3) is an isomorphism.

γ◦,a(kV) if and

The following lemma is closely related.

12

NICOLAS BERKOUK AND FRANÇOIS PETIT

Lemma 3.3 ([15, Prop. 3.5.4]). The endofunctors kγa
through Db

γ◦,a(kV) and deﬁnes a projector Db(kV) → Db

γ◦,a(kV).

np
? (·) of Db(kV) factors

This functor is the "gammaiﬁcation” functor.

Let v ∈ V, we set

τv : V → V, x 7→ x − v.
For v, w ∈ V such that w + γ ⊂ v + γ, we can use proposition 3.2 to construct a
morphism of functors from Db

γ◦ a(kV) to Db

γ◦ a(kV)

(3.4)

χµ

v,w : τv∗ → τw∗.

We refer the reader to [3, §4.1.2] for details.

Deﬁnition 3.4. Let F , G ∈ Db
γ◦,a(kV), and v ∈ γa. We say that F and G are
v-interleaved if there exists f ∈ Hom kV(τv∗F, G) and g ∈ Hom kV(τv∗G, F ) such
that the following diagram commutes.

χ2v,0(F )

τ2v∗F

∼ (cid:47)

(cid:47) τv∗τv∗F

τv ∗f (cid:47)

(cid:47) τv∗G

g

(cid:47) F

τ2v∗G

∼ (cid:47)

(cid:47) τv∗τv∗G τv ∗g

(cid:47) τv∗F

f

(cid:47) G.

χ2v,0(G)

Deﬁnition 3.5. The interleaving distance between F and G with respect to
v ∈ γa is

dv
I (F, G) := inf({r ≥ 0 | F and G are r · v − interleaved} ∪ {∞}).

The interleaving distance was introduced in [8]. We refer the reader to [10] for

details.

γ◦, a(kV) with the convolution distance on Db

3.1. Distances comparison. In this subsection, we compare the interleaving
distance on Db
γ◦, a(kV). We sharpen
Proposition 5.8 and Corollary 5.9 of [3] by removing the γ-properness assumption.
The architecture of the proof is the same as in [3]. The γ-properness hypothesis
is removed thanks to Theorem 2.2.

Here, V is endowed with a closed proper convex cone γ with non-empty interior.

Let v ∈ Int(γa) and consider the set

Bv := (v + γ) ∩ (−v + γa).

(cid:42)
(cid:42)
(cid:40)
(cid:40)
(cid:34)
(cid:34)
(cid:47)
(cid:52)
(cid:52)
(cid:54)
(cid:54)
(cid:47)
(cid:60)
(cid:60)
(cid:47)
PROJECTED DISTANCES

13

The set Bv is a symmetric closed bounded convex subset of V such that 0 ∈ IntBv.
It follows that the gauge

(3.5)

gBv (x) = inf{λ > 0 |x ∈ λBv}

is a norm, the unit ball of which is Bv. We denote this norm by k · kv.From now
on, we consider V equipped with this norm. Recall the map

u : V × V → V,

(x, y) 7→ x − y.

Θ = {(x, y) ∈ V × V|x − y ∈ γa} = u−1(γa).

Consider

and notice that

∆r = {(x, y) ∈ V × V| kx − ykv ≤ r} = u−1(Br)

where Br is the closed ball of center 0 and radius r in V for the norm k · kv.

The following formulas follow from Lemma 2.3.

(3.6)

(3.7)

kΘ

k∆r

np
? F.

np
◦ F ’ kγa
np
◦ kΘ ’ k∆r+Θ.

Lemma 3.6. Let F ∈ Db(kV). Then
np
◦ F ’ k∆r

np
◦ kΘ)

(k∆r

np
◦ (kΘ

np
◦ F ).

Proof. Let π : T ∗V → V be the cotangent bundle of V. We denote by ud the dual
of the tangent morphism of u. It ﬁts in the following commutative diagram

T ∗(V × V)

ud

(V × V) ×V ×T ∗V

uπ (cid:47)

T ∗V

π

π

V × V

u

π

(cid:47) V.

Since, we have the isomorphism k∆r ’ u−1kBr, it follows from [15, Prop. 5.4.5]
π (T ∗V) ∩
that SS(k∆r) = ud u−1
VV × T ∗V ⊂ T ∗
V×V(V × V). Since
T ∗
k∆r is constructible and the properness assumption is clearly satisﬁed, we apply
(cid:3)
Theorem 2.2 and get the desired isomorphism.

π (SS(Br)). A direct computation shows that ud u−1

V×V(V × V). Hence SS(k∆r) ∩ T ∗

VV × T ∗V ⊂ T ∗

Finally, there is also the following isomorphism

(3.8)

kr·v+γa ’ kBr+γa.

We now state and prove the sharpen version of [3, Prop. 5.8].

Theorem 3.7. Let v ∈ Int(γa), r ∈ R≥0 and F, G ∈ Db
are r · v-interleaved if and only if they are r-isomorphic.

γ◦, a(kV). Then F and G

(cid:41)
(cid:41)
(cid:111)
(cid:111)
(cid:47)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:47)
14

NICOLAS BERKOUK AND FRANÇOIS PETIT

Proof. Let F, G ∈ Db
Hence, we have the maps

γ◦, a(kV). Assume they are r · v-interleaved. We set w = r · v.

α : τw∗F → G

β : τw∗G → F

such that the below diagrams commute

τ2w∗F

τw ∗α (cid:47)

τw∗G

τw ∗β (cid:47)

(cid:47) F

τ2w∗G

τw ∗β (cid:47)

τw∗F

τw ∗α (cid:47)

(cid:47) G.

χµ

0,2w(F )

χµ

2w,0(G)

Using [1, Lem. 4.3], we obtain

k2w+γa

np
? F

k2w+γa

np
? α

kw+γa

np
? G

kw+γa

np
? β

(cid:47) F.

χ2w,0

np
? F

Moreover for every r ≥ 0, we have the following isomorphisms

krv+γa

np
? F ’ kBr+γa

np
? F

by Equation (3.8)

np
◦ F

np
◦ F

’ (k∆r

’ k∆r+Θ
np
◦ kΘ)
np
np
◦ (kΘ
◦ F )
np
◦ (kγa
np
◦ F

’ k∆r

’ k∆r

’ k∆r

np
? F )

by Lemma 2.3 (i)

by Equation (3.7)

by Lemma 3.6

by Equation (3.6)

by Proposition 3.2

’ kBr

np
? F

’ kBr ? F

by Lemma 2.3 (i)

(compacity of Br).

Hence, we obtain the commutative diagram

kB2c ? F

kBc ?α

kBc ? G

β

(cid:47) F .

Similarly we obtain the following commutative diagram

ρ0,2c?F

kB2r ? G

kBr ?β

kBr ? F

α

(cid:47) G .

ρ0,2r?G

(cid:47)
(cid:59)
(cid:59)
(cid:47)
(cid:59)
(cid:59)
(cid:47)
(cid:47)
(cid:54)
(cid:54)
(cid:47)
(cid:47)
(cid:47)
(cid:54)
(cid:54)
(cid:47)
(cid:47)
(cid:47)
(cid:54)
(cid:54)
(cid:47)
PROJECTED DISTANCES

15

Hence, F and G are r-isomorphic.

A similar argument proves that if F and G are r-isomorphic then they are
(cid:3)

r · v-interleaved.

Corollary 3.8. Let v ∈ Int(γa), F, G ∈ Db

distv

V(F, G) = dv

γ◦, a(kV). Then
I µ(F, G)

where distv
equation (3.5).

V is the convolution distance associated with the norm k · kv deﬁned in

γ◦, a(kV) and c ∈ R≥0. Assume
Proposition 3.9. Let v ∈ Int(γa), F, G ∈ Db
that F and G are c · v-interleaved. Then for all j ∈ Z, Hj(F ) and Hj(G) are
c · v-interleaved.

Proof. For all w ∈ Intγa, the functor τw∗ : Mod(kV) → Mod(kV) is exact. There-
fore, applying the functor Hj to a c · v-interleaving diagram between F and G
(cid:3)
produces a c · v-interleaving diagram between Hj(F ) and Hj(G).

Corollary 3.10. For v ∈ Intγa and F, G ∈ Db

γ◦, a(kV), one has:

(1) maxj dv
(2) maxj distv

I µ(Hj(F ), Hj(G)) ≤ dv

I µ(F, G),

V(Hj(F ), Hj(G)) ≤ distv

V(F, G).

Proof. The ﬁrst inequality is a direct consequence of Proposition 3.9. The second
(cid:3)
one is a consequence of the ﬁrst one, together with Corollary 3.8.
3.2. The dimension one case. When V is a one-dimensional real vector space,
the category Db
Rc(kV) enjoys a structure theorem which ensures the existence of a
graded-barcode for its objects, and allow to derive explicit computations for the
convolution distance. This was studied in detail in [16, 1]. These results extends
the key theorem of Crawley-Boevey [9] to constructible sheaves on the real line.
In this section, we recall the main results that will be useful in the following of
the article.

Theorem 3.11 ([16, Thm 1.17]). Let F ∈ ModRc(kR), then there exists a unique
locally ﬁnite multi-set of intervals of R noted B(F ) such that

F ’ M
I∈B(F )

kI.

Moreover, this decomposition is unique up to isomorphism.

Since for I and J some intervals of R, one has Extj(kI, kJ ) ’ 0 for all j > 1,

theorem 3.11 has the useful following corollary.

Corollary 3.12. Let F ∈ Db

Rc(kR). Then there exists an isomorphism in Db

Rc(kR):

F ’ M
j∈Z

Hj(F )[−j],

where Hj(F ) is seen as a complex concentrated in degree 0.

16

NICOLAS BERKOUK AND FRANÇOIS PETIT

Deﬁnition 3.13 ([1, Deﬁniton 2.13]). Let F ∈ Db
Rc(kR), we deﬁne its graded-
barcode B(F ) as the collection (Bj(F ))j∈Z where Bj(F ) := B(Hj(F )). Further-
more, to indicate that an interval I ⊂ R appears in degree j ∈ Z in the graded-
barcode of F , we will write I j ∈ B(F ). The element I j is called a graded-interval.
We recall here the construction of the category Barcode of [1], which is an
Rc(kR). Let Int(R) be the set of intervals of R and p1, p2 be
explicit skeleton of Db
the two ﬁrst coordinate projections of Int(R) × Z × Z≥0. Let B be a subset of
Int(R) × Z × Z≥0. Then B is said to be

• locally ﬁnite if p1(B) ∩ K is ﬁnite for all compact subsets of R;
• bounded if p2(B) ⊂ Z is bounded;
• well-deﬁned if the ﬁbers of the projection (p1, p2) have cardinality at most

1.

In a triple (I, j, n) ∈ B, the ﬁrst integer will stand for the degree on which the
interval I is seen and the second non-negative integer n stands for its multiplicity.

Deﬁnition 3.14 ([1, Deﬁnition 6.11]). The category Barcode has objects the
set

Ob(Barcode) = {B ⊂ Int(R) × Z × Z≥0, B is bounded, locally
ﬁnite and well-deﬁned}.

For any B and B0 ∈ Barcode, the set of their morphisms is

Hom Barcode(B, B0) = Y

(I,j,n)∈B
(I 0,j0,n0)∈B0

Hom Db

Rc(kR)

(cid:16)

I [−j], kn0
kn

I 0 [−j0]

(cid:17)

.

We deﬁne the composition in Barcode so that the mapping :
I [−j] ∈ Ob(Db
kn

ι : Ob(Barcode) 3 B 7→ M

Rc(kR))

becomes a fully faithful functor :

(I,j,n)∈B

ι : Barcode −→ Db

Rc(kR).

Note that this is possible only because the objects of Barcode are locally ﬁnite
(hence products and co-products coincide). Theorems 3.11 and 3.12 assert that ι is
essentially surjective, therefore is an equivalence. We also deduce from these the-
orems that Barcode is a skeletal category: it satisﬁes for any B1, B2 ∈ Barcode,
B1 ’ B2 if and only if B1 = B2.
Since ι is an equivalence, let us denote by B a quasi-inverse of ι. In [1], the
authors deﬁne a matching distance between the objects of Barcode called the
bottleneck distance, and denoted dB. They prove the following isometry theorem,
where R is endowed with the usual absolute value norm | · |, and denote by distR
the associated convolution distance on Db(kR).

PROJECTED DISTANCES

17

Theorem 3.15 ([1, Thm. 5.10]). The functor

B : (Db
is an isometric equivalence.

Rc(kR), distR) −→ (Barcode, dB)

In this article, we will mostly be interested in γ-sheaves, since they are the
sheaf theoretic analogue of persistence modules in a precise sense [3]. Therefore,
we unwrap the derived isometry theorem of [1] in the simpler setting of γ-sheaves
that will be useful for us in the following of the article. For the rest of this
section, we set γ = (−∞, 0]. Note that all results translate readily for the cone
γ0 = [0, +∞).

We recall that, given two sets X and Y , a partial matching between X and Y
is the data (σ, X , Y) of two subsets X ⊂ X and Y ⊂ Y , together with a bijection
σ : X → Y. In this situation, we use the notation (σ, X , Y) : X → Y .

Deﬁnition 3.16. Let F, G ∈ Db
Rc,γ◦, a(kR), and ε ≥ 0. A ε-matching between
B(F ) and B(G) is the data of a collection of partial matchings (σj, X j, Y j) :
Bj(F ) → Bj(G), satisfying the following, for all j ∈ Z:

(1) for all I ∈ X j such that I = [a, b) with a and b in R ∪ {±∞}, then
σj(I) = [a0, b0) with a0 and b0 in R∪{±∞}, and1 |a−a0| ≤ ε and |b−b0| ≤ ε,

(2) for all I = [a, b) ∈ Bj(F )\X j ∪ Bj(G)\Y j, then |a − b| ≤ 2ε.

Deﬁnition 3.17. For F, G ∈ Db

Rc,γ◦, a(kR), their bottleneck distance is deﬁned by:

dB(F, G) = inf{ε ≥ 0 | B(F ) and B(G) are ε-matched}.
Remark 3.18. The matchings between graded barcodes of γ-sheaves are deﬁned
in the same way as between barcodes of persistence modules. Therefore, one
can compute the bottleneck distance between barcodes of γ-sheaves using already
existing software [29, 28]. It is nevertheless far from being true when removing
the γ assumption on F and G.

Theorem 3.19 ([1, Thm 5.10]). Let F, G ∈ Db
equivalent, for all ε ≥ 0:

Rc,γ◦, a(kR), then the following are

(i) F and G are ε-isomorphic;
(ii) there exists a ε-matching between B(F ) and B(G);
(iii) for all j ∈ Z, Hj(F ) and Hj(G) are ε-isormophic.
Corollary 3.20. Let F, G ∈ Db

Rc,γ◦, a(kR), then

distR(F, G) = max
j∈Z

distR(Hj(F ), Hj(G))

= max
j∈Z

dB(B(Hj(F )), B(Hj(F ))).

Remark 3.21. Note that Corollary 3.20 is false if one only assumes F, G ∈
Db

Rc(kR).
1We set | + ∞ − +∞| = | − ∞ − (−∞)| = 0, and for all x ∈ R, | ± ∞ − x| = +∞.

18

NICOLAS BERKOUK AND FRANÇOIS PETIT

One consequence of the derived isometry theorem is the following closedness

property of the convolution distance, which we recall in full generality here.

Theorem 3.22 ([1, Thm 6.3]). Let F, G ∈ Db
equivalent, for all ε ≥ 0:
(i) distR(F, G) ≤ ε;
(ii) F and G are ε-isomorphic.
In particular, distR(F, 0) = 0 iﬀ F ’ 0.

Rc(kR), then the following are

3.3. Fibered barcodes.

3.3.1. Fibered Barcode. One of the challenges of multi-parameter persistence is to
provide a meaningful notion of distance between persistence modules which can
be computed in a reasonable time complexity. Indeed, it has been shown that the
usual interleaving distance between persistence modules is NP-hard to compute in
the muti-parameter case [4]. To overcome this issue, the authors of [7] introduced
the matching distance between multiparameter persistence modules, which is by
now popular in the TDA community, thanks to the software RIVET [19]. We
review this notion below, but formulate it in the language of γ-sheaves.

In this section, we assume that V = Rn and deﬁne the cone γ = (−∞, 0]n. Let

v = (1, ..., 1)t ∈ Int(γa) and k · kv is deﬁned as in equation (3.5). Then,

k(x1, ..., xn)kv = max{|x1|, ..., |xn|}.
Let us deﬁne Λ := {h ∈ Int(γa), khkv = 1}. Given h ∈ Λ, we denote by Lh the
one dimensional subspace of Rn spanned by h. Recall that γ induces on Rn the
standard product order ≤ given by:

(x1, ..., xn) ≤ (y1, ..., yn) ⇐⇒ xi ≤ yi for all i.
The poset (Lh, ≤) is isomorphic to (R, ≤). Therefore, it has the least upper

bound property. Following [19], we deﬁne the push function pLh : V → Lh by

pLh(x) = inf{y ∈ Lh | x ≤ y} = inf{y ∈ Lh | x ∈ y + γ}.
One can prove that we have the following formula, for x = (x1, ..., xn) ∈ V and

h = (h1, ..., hn) ∈ Λ:

(3.9)

pLh(x) =

(cid:18)

max
i

(cid:19)

xi
hi

· h.

In particular, one has for y ∈ Lh:

(3.10)

p−1
Lh

({y}) = y + ∂γ.

Lemma 3.23. For h = (h1, ..., hn) ∈ Λ, the map pLh is
respect to k · kv, and this coeﬃcient is optimal.

1
mini hi

-Lipschitz with

Proof. Let x, x0 ∈ V, since hi > 0 for all i, one has:

PROJECTED DISTANCES

19

pLh(x) = max

i

xi
hi

· h ∈ Lh.

Therefore,

kpLh(x) − pLh(x0)kv = | max

i

≤ max

i

|

xi
hi
xi
hi

− max

i

x0
i
hi

|

|

−

x0
i
hi
kx − x0kv.

≤

1
mini hi

The above inequality becomes an equality when i0 ∈ {1, ...n} is such that
hi0 = mini hi, x is the i0-th element of the canonical basis of Rn, and x0 = 0. (cid:3)

Let us deﬁne iLh(t) = t · h, which is an isometric linear map iLh : (R, | · |) →
(V, k · kv) whose image is Lh. For c ∈ V, we set τc : V → V, x 7→ x − c the
translation map.

Deﬁnition 3.24 ([7]). For F ∈ Db
of graded-barcodes (B(i−1
Lh

τ −1
c F ))(h,c)∈Λ×V.

Rc,γ◦,a(kV), its ﬁbered barcode is the collection

Deﬁnition 3.25 ([7]). For F, G ∈ Db
possibly inﬁnite quantity:

Rc,γ◦,a(kV), their matching distance is the

dm(F, G) = sup

(h,c)∈Λ×V

min
i

hi · dB(B(i−1
Lh

c F ), B(i−1
τ −1
Lh

τ −1
c G)).

Recall that we denote by distv

V the convolution distance associated with the

norm k · kv on Db(kV). Then one has the following stability result:

Proposition 3.26 ([7, 18]). Let F, G ∈ Db

Rc,γ◦,a(kV), then:

dm(F, G) ≤ distv

V(F, G)

Therefore, the matching distance is stable with respect to the convolution distance.
Under some ﬁniteness assumptions on F, G, it can be computed in polynomial time
(in the number of generators and relations of a ﬁnite free presentation of F and
G seen as persistence modules). In particular, the software RIVET [19] allows for
an eﬃcient computation of the matching distance when V is of dimension 2, and
gives an interactive visualization of the ﬁbered barcode.

20

NICOLAS BERKOUK AND FRANÇOIS PETIT

4. Linear dimensionality reduction

In this section, we study direct images of sheaves on a ﬁnite dimensional vector
space by linear forms. We examine in detailed the case of γ-sheaves and sub-
level sets persistence modules. We obtain several vanishing results and a formula
allowing to compute explicitly the pushforward by a linear form of a sub-level sets
multi-parameter persistence module.

Let (V, k·k) be a real vector space of dimension n endowed with a norm. Recall
that we denote by P the projectivisation of V. That is, we consider the n dimen-
sional projective space P(V ⊕ R). We also write P∗ for the projectivization of V∗.
We have the open immersion

j : V → P,

x 7→ [x, 1].

4.1. Linear direct image of sheaves. We need the following straightforward
generalization of the stability inequality. This is a version with support of the
usual stability inequality, as proved in [16].
Lemma 4.1. Let X be a good topological space and (V, k·k) be a real ﬁnite di-
mensional normed vector space. Let F ∈ Db(kX) and let S be a closed subset
containing Supp(F ). Then,
distV(Rf1!F, Rf2!F ) ≤ kf1|S − f2|Sk∞ distV(Rf1∗F, Rf2∗F ) ≤ kf1|S − f2|Sk∞ .
Proof. We only prove the ﬁrst inequality, the proof of the second one being similar.
Remark that F ’ iS !i−1

S F . Hence,

distV(Rf1!F, Rf2!F ) = distV(Rf1!iS !i−1

S F, Rf2!iS !i−1

S F ).

It follows from the stability theorem that

distV(Rf1!iS !i−1

S F, Rf2!iS !i−1

S F ) ≤ kf1|S − f2|Sk∞ .

Thus,

distV(Rf1!F, Rf2!F ) ≤ kf1|S − f2|Sk∞ .

Let S be a subset of V. We set kSk = supx∈S kxk.

Lemma 4.2. Let F ∈ Db

comp(kV), u, v ∈ V∗ and set S = Supp(F ). Then,

distR(Ru!F, Rv!F ) ≤ kSk |||u − v|||∞

Proof. It follows from Lemma 4.1 that

and for every x ∈ S

distR(Ru!F, Rv!F ) ≤ ku|S − v|Sk∞

|u(x) − v(x)| ≤ |||u − v|||∞ kxk∞
≤ |||u − v|||∞ kSk∞ .

Thus, k˜u|S − ˜v|Sk∞ ≤ |||u − v|||∞ kSk∞.

(cid:3)

(cid:3)

PROJECTED DISTANCES

21

Recall the following integral transform

ΦkA : Db(Pn) → Db(P∗n), F 7→ kA ◦ F

where the set A is deﬁned by equation (2.1).

We wish to extract information regarding F from the data of pushforwards of
F by linear forms. For that purpose, we will use projective duality as it allows to
construct a sheaf on P∗, via ΦkA, the stalks of which are the Ru!Ft where u is a
linear form and t an element of V.
Lemma 4.3. Let F ∈ Db(kV) and let [u; t] ∈ P∗. Then

ΦkA(Rj!F )[u;t] ’ (Ru!F )t.

Proof. Let [u; t] ∈ P∗ and set

There is the following commutative diagram

B[u;t] = {[x, y] ∈ P| u(x) = −ty}.

V

j

P

idV×[u;t]

idP×[u;t]

V × P∗ j×id (cid:47)

P × P∗

q1

V

j

p1
(cid:47) P.

ΦkA(Rj!F )[u;t] ’ RΓc(P × [u; t]; (kA ⊗ p−1

1 Rj!F )|P×[u;t])

’ RΓc(P × [u; t]; (kB[u;t]×[u;t] ⊗ (p1(idP × [u; t]))−1Rj!F )
’ RΓc(P; kB[u;t] ⊗ Rj!F )
’ RΓc(P; Rj!(j−1kB[u;t] ⊗ F ))
’ RΓc(P; Rj!(ku−1(t) ⊗ F ))
’ RΓc(V; ku−1(t) ⊗ F )
’ RΓc(u−1(t); F |u−1(t))
’ (Ru!F )t

Proposition 4.4. Let F ∈ Db(kV) such that for all u ∈ V∗, Ru!F ’ 0. Then,
F ’ 0.
Proof. Let [u; t] ∈ P∗. Then, it follows from Lemma 4.3 that

(cid:3)

ΦkA(Rj!F )[u;t] ’ (Ru!F )t.

Hence, ΦkA(Rj!F ) ’ 0 and

ΦkA : Db(P, ˙T ∗P) → Db(P∗, ˙T ∗P∗)

(cid:47)
(cid:47)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:47)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:47)
22

NICOLAS BERKOUK AND FRANÇOIS PETIT

is an equivalence of categories. This implies that Rj!F ’ 0 in Db(P, ˙T ∗P). Thus
VV. It follows from [15, Prop. 8.4.1] that Rj!F is either a non-zero
SS(F ) ⊂ T ∗
local system or the zero sheaf on P. Now, let [x, 0] ∈ P. Then

(Rj!F )[x;0] ’ RΓc(j−1([x; 0]), F |j−1([x;0])) and j−1([x; 0]) = ∅.
Thus, RΓc(j−1([x; 0]), F |j−1([x;0])) ’ 0 and (Rj!F )[x;0] ’ 0. This implies that Rj!F
(cid:3)
is not a non-zero local system. Hence, Rj!F ’ 0, which leads to F ’ 0.

4.2. Linear direct image of γ-sheaves. In this subsection, we study direct
images and direct images with proper supports of γ-sheaves by linear forms.
γ◦,a(kV) and u ∈ V∗.

Proposition 4.5. Let F ∈ Db

(i) If u ∈ γ◦,a (resp. γ◦), then Ru!F ∈ Db

λ◦,a(kV) with λ = R− (resp. λ = R+).

The same result holds for Ru!F replaced with Ru∗F .

(ii) If u /∈ γ◦ ∪ γ◦,a, then Ru!F is a constant sheaf.

If furthermore F has a
compact support, then Ru!F ’ 0. The same result holds for Ru!F replaced
with Ru∗F .

Proof. (i) Let F ∈ Db
1.17] asserts that

γ◦,a(kV), u ∈ V∗ and πR∗ : R × R∗ → R∗. Then [14, Corollary

(4.1)

Moreover,

(4.2)

SS(Ru!F ) ⊂ π−1

R∗ (ut)−1(γ◦,a).

(ut)−1(γ◦,a) = {ξ ∈ R∗|ξ(1)u ∈ γ◦,a}.

Assume that u ∈ γ◦,a \ {0} and let ξ ∈ (ut)−1(γ◦,a). Since the interior of γ is
non-empty, there exists x0 ∈ γ such that u(x0) < 0 and ξ(1)u(x0) ≤ 0. Thus
ξ(1) ≥ 0 which is equivalent to ξ ∈ λ◦,a with λ = R−. Equation (4.1) becomes
SS(Ru!F ) ⊂ R × λ◦,a

which proves the claim. The case where u ∈ γ◦ is treated in a similar way.
(ii) Since u /∈ γ◦ ∪ γ◦,a, there exist x, y ∈ γ such that u(x) < 0 and u(y) > 0.
R (ut)−1(γ◦,a) = R × {0}. It follows from [15, Prop. 8.4.1] that Ru!F
Hence, π−1
(resp. Ru∗F ) is a constant sheaf (possibly equal to zero) as V is contractible. If
the support of F is compact, then the support of Ru!F is diﬀerent from R and
(cid:3)
thus Ru!F ’ 0.

Corollary 4.6. Let F ∈ Db

γ◦,a,comp(kV). Then RΓ(V; F ) ’ 0.

Proof. Let u /∈ γ◦ ∪ γ◦,a. Then, by Proposition 4.5, Ru∗F ’ 0 and

RΓ(V; F ) ’ RaR∗Ru∗F ’ 0

where aR is the constant map V → {pt}.
Lemma 4.7. Let K ⊂ V be a compact and u ∈ Int(γ◦). Then u|K+γ is proper.

(cid:3)

PROJECTED DISTANCES

23

Proof. Since the interior of γ is nonempty, K is compact and u is linear, we can
assume without loss of generality that K ⊂ γ. Therefore, we are left to prove
that for any two real numbers a < b, the set Σ := u−1([a, b]) ∩ γ is compact. Since
u ∈ Int(γ◦), it follows that for every x ∈ γ \ {0}, u(x) > 0, which shows that
ker(u) ∩ γ = {0}. We set v ∈ Int(γ) such that u(v) = 1. Consequently, one has
the direct sum decomposition V = Rv ⊕ ker(u), and one has :

Σ = {t · v + h | t ∈ [a, b], h ∈ ker(u)} ∩ γ.

Since γ is closed and convex, so is Σ. Therefore, Σ is unbounded if and only
if there exists x ∈ Σ and y ∈ V \ {0} such that for all t ≥ 0, x + t · y ∈ Σ. Let
assume that there exists such x and y. Then, for all t ≥ 0, u(x + t · y) ∈ [a, b],
which implies that y ∈ ker(u). Moreover, for all t > 0,

1
t

· (x + t · y) =

x
t

+ y ∈ γ.

Since γ is closed, we obtain making t going to +∞ that y ∈ γ ∩ ker(u) = {0}.
This is absurd by hypothesis, so Σ is bounded. Since V is ﬁnite dimensional, it is
compact.

(cid:3)

Lemma 4.8. Let u ∈ Int(γ◦) (resp.
Ru∗kγ ’ kR−).

Int(γ◦,a)). Then Ru∗kγ ’ kR+ (resp.

Proof. Since u ∈ γ◦, it follows that γ ⊂ u−1(R+) and these two sets are closed.
Hence, there is a canonical map u−1kR+ ’ ku−1(R+) → kγ. By adjunction,
this provide a map α : kR+ → Ru∗kγ. We compute the stalks of this map.
It follows that for x ∈ R (Ru∗kγ)x ’
Since u ∈ Int(γ◦), it is proper on γ.
RΓc(u−1(x), kγ∩u−1(x)).

• If x /∈ R+, then u−1(x) ∩ γ = ∅. Thus RΓc(u−1(x), kγ∩u−1(x)) ’ 0 and αx

is an isomorphism.

• If x ∈ R+, then u−1(x) ∩ γ is non-empty and it is a compact convex subset
of u−1(x). This implies that RΓc(u−1(x), kγ∩u−1(x)) ’ k and αx is again
an isomorphism.

(cid:3)

We recall the notion of characteristic cone following [17, 27]. Let C be a closed

convex subset of V and let p ∈ V. Consider the set

Cp = {x ∈ V | ∀λ ≥ 0, λ(x − p) + p ∈ C}.

Hence Cp is the union of half-lines contained in C emanating from p. The set Cp
is an aﬃne convex cone and if q ∈ C then Cp = Cq + (p − q). The cone Cp is
called a characteristic cone of C.

24

NICOLAS BERKOUK AND FRANÇOIS PETIT

Lemma 4.9. Let V be a ﬁnite dimensional real vector space and let C be a closed
convex set such that a characteristic cone of C is not an aﬃne subspace of V.
Then

RΓc(V, kC) ’ 0.
Proof. We ﬁrst establish the lemma when V = R and C = [0, +∞[. Using a
stereographic projection from the north pole N of S1 ⊂ R2, we notice that R+ is
homeomorphic to a half-circle minus the north pole that is to [0, 1[. We consider
the following exact triangle

RΓc([0, 1]; k[0,1[) → RΓc([0, 1]; k[0,1]) → RΓc([0, 1]; k{1}) +1→ .
Since, the morphism RΓc([0, 1]; k[0,1]) → RΓc([0, 1]; k{1}) is an isomorphism, it

follows that RΓc([0, 1]; k[0,1[) ’ 0. Thus RΓc(R, k[0,+∞[) ’ 0.

Now, assume that V is a real vector space of dimension n and C is closed convex
set of V such that a characteristic cone of C is not an aﬃne subspace of V. By [17,
§5], it follows that C is homeomorphic to [0, 1]d × [0, +∞[ for some 0 ≤ d ≤ n − 1.
Hence,

RΓc(V, kC) ’ RΓc(C, kC)

’ RΓc([0, 1]d × [0, +∞[, k[0,1]d×[0,+∞[)
’ RΓc([0, 1]d, k[0,1]d) ⊗ RΓc([0, +∞[, k[0,+∞[)
’ 0.

(cid:3)

Lemma 4.10. Let V be a vector space. A closed proper cone γ of V does not
contain any non-trivial aﬃne subspace of V.

Proof. Let E be an aﬃne subspace of V contained in γ and let p ∈ E and v ∈ V.
The set L = {x ∈ V|x = p + λv, λ ∈ R} is an aﬃne subspace of E. Since γ is a
cone, for every n ∈ N∗, the points qn = 1
n (p − nv) belongs
to γ. Since γ is closed, the limits limn→∞ pn = v and limn→∞ rn = −v belongs
again to γ which is proper. Hence, v = 0 and L = {p}. This implies that E is
(cid:3)
trivial.

n (p + nv) and rn = 1

Proposition 4.11. Let u ∈ ∂γ◦ ∪ ∂γ◦, a. Then Ru!kγ ’ 0.
Proof. Let y ∈ R. Then

(Ru!kγ)y ’ RΓc(u−1(y); kγ∩u−1(y)).
We set C = γ ∩ u−1(y). Then, either C = ∅ and RΓc(u−1(y); kC) ’ 0 or C 6= ∅
and it is a closed convex set. Let x0 ∈ C. Since u ∈ ∂γ◦ ∪ ∂γ◦, a, it follows that
(ker(u) ∩ γ) \ (0) 6= ∅. As γ is a cone this implies that (ker(u) ∩ γ) contains a half-
line h. Since x0 ∈ γ and γ is a convex cone then x0 +h ⊂ γ. Moreover, h ⊂ ker(u),
thus u(x0 + h) = {y}. Hence, x0 + h is contained in C which implies that the

PROJECTED DISTANCES

25

characteristic cone Cx0 contains at least a ray and is not reduced to a point. Let
z ∈ C. We have the following inclusion of characteristic cone Cz ⊂ γz = γ + z.
Moreover, it follows from Lemma 4.10 that γ does not contain any non-trivial
aﬃne subspace of V. Hence Cz is not an aﬃne subspace of V. Then, applying
(cid:3)
Lemma 4.9, we get that (Ru!kγ)y ’ RΓc(V, kC) ’ 0.

4.3. Sub-level set persistence. In [16], Masaki Kashiwara and Pierre Schapira
provide a sheaf-theoretic construction of sub-level sets multiparameter persistence.
The aim of this section is to prove that the sheaf encoding the sub-level sets
multiparameter persistence of a pair (S, f ) where S is a good compact topological
space and f : S → V is a continuous map, is γ-compactly generated.

Deﬁnition 4.12. A sheaf F ∈ Db(kV) is γ-compactly generated if there exists G ∈
np
? kγ. We denote by Db
Db
γ-cg(kV) the full subcategory of
Db(kV) spanned by γ-compactly generated sheaves.

comp(kV) such that F ’ G

Remark 4.13. Any compactly supported γ-sheaves is γ-compactly generated.

We now recall Kashiwara-Schapira’s construction of the sub-level sets multipa-
rameter persistence module associated to a pair (S, f ) where S is a good topolog-
ical space and f : S → V is a continuous map. We denote by Γf the graph of f
and γ is a cone satisfying hypothesis (3.1). We set

Γγ
f = {(x, y) ∈ S × V|f (x) − y ∈ γ}

= Γf + γa.

We write p : S × V → V, (x, v) 7→ v for the projection onto V and s : V × V →
V, (v, w) 7→ v + w. We notice that s ◦ (p × idV) = p ◦ (idS × s).

Deﬁnition 4.14. The sublevel sets persistent sheaf of the pair (S, f ) is deﬁned
by :

PH(f ) := Rp∗kΓγ

f

∈ D(kV).

), for i ∈ Z.

We will use the notation PHi(f ) := Hi(Rp∗kΓγ
Remark 4.15. Let M be a real analytic manifold (for instance M = Rn) and
let S be a good topological space. We assume that γ is subanalytic and that we
have the data of iS : S → M a closed immersion whose image is a subanalytic
subset of M and that f : S → V is continuous and subanalytic in M i.e. the
graph (iS × idV)(Γf ) is subanalytic in M × V. Following [16], we will also assume
that

f

(4.3)

For eack K ⊂ V compact, the set {x ∈ S| f (x) ∈ K + γ} is compact.

Then the sheaf Rp∗kΓγ
projection we have

f

is constructible. Indeed, writing pM : M × V → V for the

Rp∗kΓγ

f

’ RpM ∗(RiS ∗kΓγ

f

) ’ RpM ∗kiS (Γγ
f )

26

NICOLAS BERKOUK AND FRANÇOIS PETIT

and the result follows immediately from [16, Thm. 1.11]. Furthermore, if M is
compact, then Rp∗kΓγ

is constructible up to inﬁnity.

f

Remark that Γf × γa ⊂ (idS × s)−1(Γγ

f ). This provides a canonical map

φ : (idS × s)−1kΓγ
f
Precomposing this map with the morphism

→ kΓf ×γa.

kΓγ

f

→ R(idS × s)∗(idS × s)−1kΓγ

f

induced by the unit of the adjunction ((idS × s)−1, R(idS × s)∗) leads to the fol-
lowing map

(4.4)

kΓγ

f

→ R(idS × s)∗(idS × s)−1kΓγ

f

φ−→ R(idS × s)∗kΓf ×γa.

Lemma 4.16. The morphism (4.4) is an isomorphism.

Proof. We show that the morphism (4.4) is an isomorphism by checking it at the
level of the stalks. The map idS × s is proper on Γf × γa and induces a bijection
idS × s : Γf × γa → Γγ
f . Let (x, y) ∈ S × V. We notice that

(cid:16)

R(idS × s)∗kΓf ×γa

(cid:17)

(x,y)

(cid:16)

’ RΓ

(idS × s)−1 (x, y) ; kΓf ×γa∩(idS ×s)−1(x,y)

(cid:17)

.

First, if (x, y) /∈ Γγ

f , then Γf ×γa ∩(idS ×s)−1(x, y) = ∅ and the stalk at (x, y) of
the morphism (4.4) is an isomorphism. Second, if (x, y) ∈ Γγ
f , then Γf ×γa ∩(idS ×
s)−1(x, y) = (x, f (x), y −f (x)). Thus, RΓ((idS ×s)−1(x, y), kΓf ×γa∩(idS ×s)−1(x,y)) ’
k. Morphism (4.4) induces a non-zero map from k to k which is an isomorphism.
(cid:3)

Proposition 4.17. Assume that f is proper. Then

Rp∗kΓγ

f

’ (Rf∗kS)

np
? kγa.

Proof. Applying the functor Rp∗ to the isomorphism (4.4), we get

Rp∗kΓγ

f

’ Rp∗R(idS × s)∗kΓf ×γa.

Moreover,

Rp∗R(idS × s)∗kΓf ×γa ’ Rs∗R(p × idV)∗kΓf ×γa
’ Rs∗R(p × idV)!kΓf ×γa
(cid:2) kγa)
’ Rs∗(Rp!kΓf
(cid:2) kγa)
’ Rs∗(Rp∗kΓf
’ Rs∗(Rf∗kS (cid:2) kγa).

(Properness of f )

(Künneth isomorphism)

(Properness of f )

Corollary 4.18. Let S be a good compact topological space and f : S → V be a
continuous map. The sheaf PH(f ) is γ-compactly generated.

(cid:3)

PROJECTED DISTANCES

27

4.4. Properties γ-compactly generated sheaves. In this subsection, we study
the properties of γ-compactly generated sheaves and deduce from them results for
sub-level sets multiparameter persistent sheaves.

Lemma 4.19. Let u ∈ Int(γ◦).

(i) If F ∈ Db
(ii) Let S be a good compact topological space, f : S → V be a continuous map.

comp(kV). Then, Ru∗(F

np
? kγa) ’ (Ru∗F )

np
? kR−.

Then, Ru∗Rp∗kΓγ

f

’ (R(uf )∗kS)

np
? kR−. In other words,

Proof. (i) We have

Ru∗ PH(f ) ’ PH(u ◦ f ).

Ru∗(F

np
? kγa) ’ Ru∗Rs∗(F (cid:2) kγa)

’ Rs∗(R(u × u)∗(F (cid:2) kγa)).

Since u ∈ Int(γ◦), it follows from Lemma 4.7 that u is proper on γa. As Supp(F )
is compact, this implies that u × u is proper on Supp(F ) × γa. Hence, applying
Künneth formula

Rs∗(R(u × u)∗F (cid:2) kγa) ’ Rs∗(Ru∗F (cid:2) Ru∗kγa)

’ Rs∗(Ru∗F (cid:2) kR−)

(Lemma 4.8)

’ (Ru∗F )

np
? kR−.

(ii) Since S is compact, the support of Rf∗kS is compact. Hence, applying (i)
with F := Rf∗kS, we have

Ru∗((Rf∗kS)

np
? kγa) ’ (R(uf )∗kS)

np
? kR−.

(cid:3)

Remark 4.20. We emphasize that the pushforward by a linear form u of the
module PH(f ) is in general diﬀerent of the module PH(u ◦ f ). Let X and Y be
good topological spaces and consider two functions f : X → R and g : Y → R.
Then, the quantity sup|||u|||≤1 distR(Ru∗ PH(f ),Ru∗ PH(g)) is a lower bound of the
interleaving distance distV(PH(f ), PH(g)) whereas this is in general not the case
for distR(PH(u ◦ f ), PH(u ◦ g)) as shown by the following proposition.

Consider R2 equipped with the usual cone γ = R2

≤0, whose associated norm is
k · k∞. Let X = {(−1, 1) · t | t ∈ [0, 1]} and for s ∈ R≥0, Ys = Conv(X ∪ (0, s)),
where Conv stands for the the convex hull of a set. Let f : X → R2 and gs : Ys →
R2 be the inclusions. We also set p : R2 → R deﬁned by p(x, y) = y−x
2 , which is a
1-Lipschitz linear form on R2.

Proposition 4.21. The following holds:

28

NICOLAS BERKOUK AND FRANÇOIS PETIT

Figure 1. The sets X (left) and Ys (right)

distR2(PH(f ), PH(gs)) = 0 and distR(PH(p ◦ f ), PH(p ◦ gs)) =

Proof. For s ≥ 0, since Ys is compact, gs is proper and one has

PH(gs) ’ (Rgs∗kYs)

np
? kγa ’ kYs

np
? kγa.

(cid:12)
(cid:12)
(cid:12)
(cid:12)

s
2

(cid:12)
(cid:12)
− 1
(cid:12)
(cid:12)

.

Moreover, the sum map is proper on Ys × γa, so that kYs

np
? kγa ’ kYs ? kγa.
Similarly, one proves that PH(f ) ’ kX ? kγa. Since X and Ys are both compact
and convex, by [15, Ex II.20], one has kYs ? kγa ’ kYs+γa ’ kX+γa ’ kX ? kγa.
Therefore, we have proved that PH(f ) ’ PH(gs), which in particular implies that
distR2(PH(f ), PH(gs)) = 0.

Similarly as above, one has PH(p ◦ f ) ’ (R(p ◦ f )∗kX) ? kR+ ’ k[1,∞) and
2 ,∞). By the derived isometry theorem [1, Theorem 5.10], one
(cid:12)
s
(cid:12)
(cid:12).
2 − 1

PH(p ◦ gs) ’ k[ s
concludes that distR(PH(p ◦ f ), PH(p ◦ gs)) =

(cid:12)
(cid:12)
(cid:12)

(cid:3)

Lemma 4.22. Let u ∈ ∂γ◦ ∪ ∂γ◦,a and F a γ-compactly generated sheaf. Then
Ru!F ’ 0
Proof. Since F is γ-compactly generated there exist F 0 ∈ Db
comp(kV) such that
F ’ F 0 ? kγa. Then Ru!F ’ Ru!F 0 ? Ru!kγa ’ 0 where the last isomorphism
(cid:3)
follows from Proposition 4.11.
Corollary 4.23. Let F be a γ-compactly generated sheaf. Then RΓc(V, F ) ’ 0.

PROJECTED DISTANCES

29

Proposition 4.24. Let F ∈ Db(kV). Assume that F is γ-compactly generated
and that for all u ∈ Int(γ◦), Ru!F ’ 0. Then F ’ 0.
Proof. (a) By hypothesis, for every u ∈ Int(γ◦) ∪ Int(γ◦, a), Ru!F ’ 0.
(b) Let u ∈ ∂γ◦ ∪ ∂γ◦, a. It follows from Lemma 4.22 that Ru!F ’ 0.
(c) Let u be in the complement of γ◦ ∪ γ◦,a and let v ∈ Int(γ◦) ∪ Int(γ◦,a). Then,
by Proposition 4.5, Ru!F is a constant sheaf on R (possibly the zero sheaf).
That is there exists a k-vector space M such that Ru!F ’ MR. Hence,
RΓc(R, Ru!F ) ’ RΓc(V, F )

’ RΓc(R, Rv!F ).

Moreover, RΓc(R, Ru!F ) ’ RΓc(R, MR) ’ M [−1] and RΓc(R, Rv!F ) ’ 0.
Hence M ’ 0. This implies that Ru!F ’ 0.

Thus, for every u ∈ V∗, Ru!F ’ 0. It follows from Corollary 4.4 that F ’ 0. (cid:3)
comp(kV), u, v ∈ Int(γa,◦) (resp. Int(γ◦)) and set S =

Lemma 4.25. Let F ∈ Db
Supp(F ). Then,

distR(Ru!(F ? kγa), Rv!(F ? kγa)) ≤ kSk |||u − v|||∞.

Proof. It follows from Lemma 4.19 that

distR(Ru!(F ? kγa), Rv!(F ? kγa)) = distR(Ru!F ? kR+, Rv!F ? kR+)

Using Proposition 2.8 (ii) followed by Lemma 4.2, we obtain

distR(Ru!F ? kR+, Rv!F ? kR+) ≤ distR(Ru!F, Rv!F )

≤ kSk |||u − v|||∞

which complete the proof.
Proposition 4.26. Let F, G ∈ Db

comp(kV) and p ∈ γ◦ ∪ γ◦,a. Then,

(cid:3)

distR(Rp!F ? kλ, Rp!G ? kλ) ≤ |||p||| distV(F ? kγa, G ? kγa)
where |||·||| is the operator norm associated with the norm k·k on V and λ = [0, +∞[
if p ∈ γ◦,a and λ = [−∞, 0[ if p ∈ γ◦.

Proof. We proceed in two steps.
(i) If p ∈ Int(γ◦,a) ∪ Int(γ◦), we have

distR(Rp!F ? kλ, Rp!G ? kλ) = distR(Rp!(F ? kγa), Rp!(G ? kγa)) Lem. 4.19

≤ |||p||| distV(F ? kγa, G ? kγa) Thm. 2.11

(ii) We now assume that p ∈ ∂γ◦ ∪ ∂γ◦,a. Without loss of generality, we can
further assume that p ∈ ∂γ◦. Thus there exists a sequence (pn)n∈N of elements of
Int(γ◦) such that limn→∞ pn = p. Then

distR(Rp!F ? kλ, Rp!G ? kλ) ≤ distR(Rp!F ? kλ, Rpn!F ? kλ)

+ distR(Rpn!F ? kλ, Rpn!G ? kλ)
+ distR(Rpn!G ? kλ, Rp!G ? kλ).

30

NICOLAS BERKOUK AND FRANÇOIS PETIT

Moreover, it follows from the ﬁrst step that

distR(Rpn!F ? kλ, Rpn!G ? kλ) ≤ |||pn||| distV(F ? kγa, G ? kγa)

and

distR(Rp!F ? kλ, Rpn!F ? kλ) ≤ distR(Rp!F, Rpn!F )

≤ kSupp(F )k |||pn − p|||∞.

This implies that

distR(Rp!F ? kλ, Rp!G ? kλ) ≤ |||pn||| distR(F ? kγa, G ? kγa)

+ kSupp(F )k |||pn − p|||∞
+ kSupp(G)k |||pn − p|||∞

Taking the limit when n → ∞, we get

distR(Rp!F ? kλ, Rp!G ? kλ) ≤ |||p||| distR(F ? kγa, G ? kγa).

(cid:3)

Corollary 4.27. Let X and Y be compact good topological spaces and f : X → Rn,
x 7→ (f1(x), . . . , fn(x)) and g : Y → Rn, x 7→ (g1(x), . . . , gn(x)) be continuous
maps. Consider the cone γ =] − ∞, 0]n. Then for every 1 ≤ i ≤ n

distR(PH(fi), PH(gi)) ≤ distRn(PH(f ), PH(g)).
Proof. Let pi : Rn → R be the projection on the i-th coordinate. Notice that
pi ∈ ∂γ and |||pi|||∞ = 1. Hence, applying Lemma 4.19 and Proposition 4.26, we
get

distR(PH(fi), PH(gi)) = distR(PH(pi ◦ f ), PH(pi ◦ g)) ≤ distV(PH(f ), PH(g)).

(cid:3)

Remark 4.28. The above corollary shows that passing from persistence to multi-
persistence tend to increase the distance between persistence modules. A possible
interpretation is that multipersistence has a better sensitivity than persistence
but it cannot be claimed that it is more robust to outliers.

5. Projected barcodes

In this section, we introduce the notion of projected barcodes. The projected
barcodes of a multipersistence module F on V (that is a γ-sheaf) is the family of
barcodes obtained by considering the direct images of F by various maps from V
to R. While the ﬁbered barcode is obtained by pulling back a multipersistence
module on an aﬃne line, we propose instead to study the pushforwards of a γ-
sheaf onto R. We start by providing an example showing that two non isomorphic
multipersistence modules that have the same ﬁbered barcodes can have diﬀerent
projected barcodes. We then formally introduce the notion of F-projected bar-
codes and study its properties.

PROJECTED DISTANCES

31

Figure 2. The sheaves F and G in Db

Rc(kR2).

5.1. Motivations and example. The ﬁbered barcode has been successfully used
in a variety of machine learning tasks as a summary of multiparameter persistence
modules [6]. Nevertheless, it is easy to build examples of γ-sheaves (hence persis-
tence modules) with the same ﬁbered barcodes (hence at matching distance zero)
though they are not isomorphic and are at a strictly positive convolution distance.
Let us describe below one of this well-known situation.

In this example, we consider V = R2, endowed with γ = (−∞, 0]2. We set
v = (1, 1), therefore k(x, y)kv = max(|x|, |y|) = k(x, y)k∞. We keep the notation
Λ := {h ∈ Int(γa), khkv = 1}. We let a > 2 and deﬁne the two sheaves F and
G in Db
Rc,γ◦,a(kV) as follows: F = k[1,a)×[0,a) ⊕ k[0,a)×[1,a) and G = kA ⊕ k[1,a)×[1,a),
where

The sheaf kA ﬁts into the following short exact sequence

A = [0, a) × [0, a) \ [0, 1) × [0, 1).

0 → k[0,1)×[0,1) → k[0,a)×[0,a) → kA → 0.

32

NICOLAS BERKOUK AND FRANÇOIS PETIT

Some classical computations (see for instance [30, Example 2.1]) give i−1
τ −1
c F ’
Lh
c G for all (h, c) ∈ Λ × V. Therefore, one cannot distinguish F and G by
i−1
τ −1
Lh
restrictions to one dimensional aﬃne subspaces. However, one has distV(F, G) =
1.

We now show that it is possible to produce barcodes out of F and G which are
diﬀerent. Our idea is to study the barcode decomposition obtained after applying
the direct image functor of a map from V to R, rather than restrictions, which
correspond to the inverse image functor of injections from R to V. Let p : V → R
be deﬁned by the formula p(x, y) = (x+y)

. Then we have

2

(cid:16)

(cid:17)2

2 ,a)

k[ 1

Rp∗F ’

2 ,a) ⊕ k[ 1

, Rp∗G ’ k[ 1
According to Deﬁnition 3.16, the partial matching between B(Rp∗F ) and B(Rp∗G)
given by

2 ,1) ⊕ k[1,a).

(cid:20) 1
2
2-matching, and a simple computations shows that for every 1

is a 1
2 > ε > 0,
there is no ε-matching between B(Rp∗F ) and B(Rp∗G). Using Theorem 3.19, one
deduces that

↔ [1, a) , ∅ ↔

(cid:20) 1
2

(cid:20)1
2

(cid:20)1
2

↔

, a

, a

, a

, 1

(cid:19)

(cid:19)

(cid:19)

(cid:19)

,

distR(Rp∗F, Rp∗G) = dB(B(Rp∗F ), B(Rp∗G)) =

1
2

.

Therefore, it is possible to distinguish F from G by using barcodes obtained
from pushforwards, rather than pullbacks. A natural question arising from this
observation is how to derive a well-behaved notion of collection of projected bar-
codes, mimicking the construction of the ﬁbered barcode. This is the matter of
the following subsection.

5.2. F-Projected barcodes.
5.2.1. Generalities. Recall that SC(V∞) denotes the set of continuous maps from
V to R which are subanalytic up to inﬁnity and let F be a subset of SC(V∞). We
regard F as a discrete category.

Deﬁnition 5.1. The F-projected barcodes is the functor

(5.1)

P : F × Db

Rc(kV∞) → Db

Rc(kR∞),

(u, F ) 7→ Ru!F.

and the non-proper projected barcodes is the functor

(5.2)

P : F × Db

Rc(kV∞) → Db

Rc(kR∞),

(u, F ) 7→ Ru∗F.

We will often study restriction of the (non-proper) projected barcodes to speciﬁc
Rc(kV∞). For instance, the category of compactly supported

subcategories of Db
constructible sheaves or the category of Db

Rc,γ◦,a(kV∞).

Notations 5.2. Let F ∈ Db

Rc(kV∞). We set PF := P(·, F ) and PF := P(·, F ).

PROJECTED DISTANCES

33

Remark 5.3. The proper and the non-proper projected barcodes are related via
the following formula which follows from Corollary 2.17. Let F ∈ Db
Rc(kV∞), Then,

PF = DR(PDV(F )).

We now provide a few examples of projected barcodes of interest.

5.2.2. Linear projected barcodes. Let (V, k·k) be a real ﬁnite dimensional vector
space and V∗ its dual endowed with the operator norm |||·|||.

We set S∗ = {u ∈ V∗| |||u||| = 1}. The linear projected barcodes is the functor

P S∗ : S∗ × Db

Rc(kV∞) → Db

Rc(kR∞),

(u, F ) 7→ Ru!F.

Proposition 5.4. The linear projected barcodes has the following properties.
F ’ 0, then F ’ 0,

Rc(kV∞). If P S∗

(i) Let F ∈ Db
(ii) The map P S∗ : S∗ × Db

Rc,comp(kV∞) → Db

Rc(kR∞), (u, F ) 7→ P S∗

F (u) is con-

tinuous.

(iii) Let u ∈ S∗. The map Db

Rc,comp(kV∞) → Db

Rc(kR∞), F 7→ P S∗

F (u) is Lipschitz.

Proof. (i) follows from Proposition 4.4.
(ii) Let us show that P is continuous. Let (u, F ) ∈ S∗ × Db
Rc,comp(kV∞) and
let ε > 0. For every v ∈ S∗ such that |||u − v|||∞ < ε/(2 kSupp(F )k) and G ∈
Db
Rc,comp(kV∞) such that distV(F, G) ≤ ε/2, we have

distR(P S∗

F (u), P S∗

G (v)) ≤ distR(P S∗

F (u), P S∗

F (v)) + distR(P S∗

F (v), P S∗

G (v))

≤ kSupp(F )k |||u − v|||∞ + |||v|||dist(F, G)
≤ kSupp(F )k |||u − v|||∞ + dist(F, G) ≤ ε

(iii) This follows from the above inequality by taking u = v.

(cid:3)

Remark 5.5. The ﬁrst point of the above proposition expresses that the linear
projected barcodes can be used as a nullity test of persistence modules, where the
space of test parameters is S∗, thus compact. This is a fundamental diﬀerence
with the ﬁbered barcode, whose parameter test space is not compact.

5.2.3. γ-Linear projected barcode. We introduce a notion of projected barcode
tailored for γ-sheaves, that is, for persistence modules. For sub-level sets persis-
tence modules, we explain in example 5.9 how it can be computed with standard
one-parameter persistence software.

Since, we this version of the projected barcode is aimed at γ-sheaves, it is
natural, in view of Proposition 4.5 and Lemma 4.7, to set F = Int(γ◦, a) ∩ S∗
where S∗ is the unit sphere of V∗ for the norm |||·||| . This version of the projected
barcode is called γ-linear projected barcode. For the sake of brevity, we set Qγ =
Int(γ◦,a) ∩ S∗.
Deﬁnition 5.6. The γ-linear projected barcode is the functor
Rc,γ◦,a(kV∞) → Db

P γ : Qγ × Db

(u, F ) 7→ Ru!F.

Rc,λ◦,a(kR∞),

where λ = R−.

34

NICOLAS BERKOUK AND FRANÇOIS PETIT

Remark 5.7. We focus our attention on the properties of the γ-projected barcode
for γ-sheaves which are γ-compactly generated. If F is γ-compactly generated ,
then for u ∈ Int(γ◦,a) Ru!F ’ Ru∗F . This is why, we only discuss the γ-projected
barcode and omit the study of the non-proper γ-linear projected barcode.

Proposition 5.8. The γ-linear projected barcode has the following properties
Rc,γ◦,a(kV∞) and assume that F is γ-compactly generated. If P γ

(i) Let F ∈ Db

F ’

0, then F ’ 0.
(ii) Let (u, F ) ∈ Qγ × Db

Rc,γ◦,a(kV∞) and assume that F is γ-compactly generated.

The map P γ : Qγ × Db

Rc(kR∞) is continuous in (u, F ).

Rc(kV∞) → Db
Proof. (i) The next result is a direct consequence of Proposition 4.24.
(ii) Let (u, F ) ∈ Qγ × Db
Rc,γ-cg(kV∞) and let ε > 0. Since F is γ-compactly
generated there exists a sheaf F 0 with compact support such that F ’ F 0 ? kγa.
For every v ∈ Qγ such that |||u − v|||∞ < ε/(2 kSupp(F 0)k) and G ∈ Db
Rc(kV∞)
such that distV(F, G) ≤ ε/2, we have
F (u), P γ

F (v), P γ

distR(P γ

G(v))

F (u), P γ
F 0(u), P γ

F (v)) + distR(P γ
G(v)) ≤ distR(P γ
≤ distR(P γ
F 0(v)) + |||v|||dist(F, G)
≤ kSupp(F 0)k |||u − v|||∞ + |||v|||dist(F, G)
≤ kSupp(F 0)k |||u − v|||∞ + dist(F, G) ≤ ε

(cid:3)

Example 5.9. Here, we specialize the situation to the case where V = R2 endowed
with the norm k(x, y)k∞ = max(|x|, |y|) and γ = (−∞, 0]2. Then (V∗, |||·|||∞) is
isometric to (R2, k·k1) where k(a, b)k1 = |a| + |b|. It follows that Qγ = {(a, b) ∈
R>0 × R>0 ; a + b = 1}. If for instance S is a compact real analytic manifold and
f : S → R2 is a subanalytic map with f = (f1, f2). Then by Lemma 4.19, the
projected barcode u 7→ P γ
PH(f )(u) is the collection of barcode associated to the
family of sublevel sets persistence modules (PH(a f1 + (1 − a) f2))a∈(0,1).

5.3. Fibered versus Projected Barcodes. In this subsection, we prove that
the ﬁbered barcode is a special instance of projected barcode.

We get back to the setting of Section 3.3.1, with V = Rn, γ = (−∞, 0]n and
v = (1, ..., 1). Note that for h ∈ Λ, λ := Lh ∩ γ is a cone of the one-dimensional
real vector space Lh satisfying hypothesis (3.1) as a cone of Lh. We denote, Lh,λ
the topological space Lh endowed with the λ-topology.

Proposition 5.10. Let h ∈ Λ, the following holds:

(1) pLh ◦ iLh = iLh as maps of sets,
(2) pLh and iLh are continuous for both the norm and the cone topologies.

Proof. (i) is clear.
(ii) We have already noticed that pLh is Lipschitz, therefore continuous for the

PROJECTED DISTANCES

35

norm topology. Observe that for x ∈ V, p−1
Lh
for any λ-open subset U ⊂ Lh, U = S
p−1
Lh

x∈U x + Int(γ). This proves the statement.

(x + Int(λ)) = x + Int(γ). Moreover,
x∈U x + Int(λ) by [3, Lemma 2.1]. Hence,
(cid:3)

(U ) = S

Let us precise some notations. When the context is clear, we drop the h of the
maps pLh and iLh. From now on, pL and iL refer to the morphisms of topological
spaces equipped with the norm topologies, whereas we write pγ
L for the
morphisms of topological spaces equipped with the cone topologies.

L and iγ

Proposition 5.11. There is an isomorphism of functors pγ

L∗ ’ (iγ

L)−1 in Mod(kVγ ).

L)−1(U )) = F (x + Int(γ)). By deﬁnition, (iγ

Proof. Let F ∈ Mod(kVγ ) and U ⊂ Lh,λ be a λ-open set. Since Lh is one di-
mensional, there exists x ∈ L such that U = x + Int(λ). Hence, pγ
L∗F (U ) =
F ((pγ
L)−1F is the sheaﬃﬁcation of
the presheaf (iγ
F (W ) is canoni-
cally isomorphic to F (x + Int(γ)), which leads to an isomorphism of pre-sheaves
L∗F is a sheaf, we conclude that so is (iγ
L)†F → pγ
(iγ
L)†F and
L)†F ’ pγ
(iγ
L)−1F . This isomorphism is functorial in F by functorial-
(cid:3)
ity of colimits.

L∗F . Since pγ
L∗F ’ (iγ

F (W ). The colimit lim

L)†F : V 7→ lim

−→V ⊂W

−→U ⊂W

We denote by φ : V → Vγ and φ0 : Lh → Lh,λ the morphisms of topological
Lφ.
L∗. For every G ∈ D+(kV),

spaces induced by the identity maps. We have the following relation φ0pL = pγ
We now construct a morphism of functors from iγ
L
we have

−1 to pγ

Hom (φ−1G, φ−1G) → Hom (φ−1pγ
L

−1Rpγ
L φ0−1RpL∗G, φ−1

L∗G, φ−1G)
’ Hom (p−1
γ G)
’ Hom (φ0−1RpL∗G, RpL∗φ−1

γ G).

The image of the identity map by the above sequence of morphisms provides a
map

(5.3)

φ0−1Rpγ

L∗G → RpL∗φ−1G.

Lemma 5.12. Let G ∈ D+(kVγ ), the morphism (5.3) is an isomorphism.

Proof. To prove that the morphism (5.3), it is suﬃcient to prove that it induces
L∗G) ∼−→ RΓ(U ; RpL∗φ−1G), for every open subset
an isomorphism RΓ(U ; φ0−1Rpγ
U ⊂ Lh of the form U = {t · h | t ∈ (a, b)}, for a < b in R. Let I be a bounded
from below complex of injective (in particular ﬂabby) sheaves on Vγ, which is
quasi-isomorphic to G.
It follows from equation (3.10) that

p−1
L (U ) = U + ∂γ = Int(b · h + γ) \ (a · h + γ).

36

NICOLAS BERKOUK AND FRANÇOIS PETIT

We denote by (e1, ..., en) the canonical basis of Rn. In this basis, b·h = (b1, . . . , bn)
and a · h = (a1, . . . , an). Then

b + Int(γ) =

n
\

{xi < bi}

a + γ =

i=1
n
\

{xi ≤ ai}

i=1

Hence,

Int(b + γ) \ (a + γ) =

  n
\

!

{xi < bi}

∩

  n
[

{xi > ai}

i=1
n
[

"  n
\

=

i=1

!

{xi < bi}

∩ {xj > aj}

!

#

i=1

For 1 ≤ j ≤ n, we set Rj = (Tn

j=1
i=1{xi < bi}) ∩ {xj > aj}. The Rj are convex
In particular,
j=1 Rj = Qn
i=1(ai, bi). Then RI is a convex open subset, satisfying
L (U ) + γ. Therefore, from [16, Prop. 3.5.3], there are isomorphisms

open subsets of V. For I ⊂ {1, ..., n}, we deﬁne RI = ∩i∈IRi.
R{1,...,n} = Tn
RI + γ = p−1
of chain complexes in C(Mod(k))

Γ(RI + γ; I) = Γ(p−1

L (U ) + γ; I) ∼−→ Γ(RI; φ−1I),

which commute with the restriction morphisms Γ(RJ ; φ−1I) −→ Γ(RI; φ−1I), for
J ⊂ I. Thus, one has the isomorphisms in C(Mod(k)) :

Γ(p−1

L (U ) + γ; I) ’ lim
←−
I

Γ(RI; φ−1I) ’ Γ(p−1(U ); φ−1I).

From the above, we conclude that in D+(Mod(k)):

RΓ(U ; φ0−1Rpγ

L∗G)
L (U + λ); G)
L (U ) + γ; G)

L∗G) ’ RΓ(U + λ; Rpγ
’ RΓ(p−1
= RΓ(p−1
’ Γ(p−1
L (U ) + γ; I)
’ Γ(p−1(U ); φ−1I)
’ RΓ(p−1(U ); φ−1G)
’ RΓ(U ; RpL∗φ−1G).

We now prove the result announced at the beginning of the subsection. Namely,

that the ﬁbered barcode is a special instance of projected barcode.

(cid:3)

Proposition 5.13. Let F ∈ D+
pL∗F ’ i−1

L F .

γ◦,a(kV), then there is a functorial isomorphism

Proof. We have the following commutative diagrams of topological spaces:

PROJECTED DISTANCES

37

Lh

φ0

Lh,λ

iL

V

Lh

φ

φ0

iγ
L (cid:47)

(cid:47) Vγ

Lh,λ

pL

pγ
L

V

φ

Vγ.

L F ’ i−1
i−1

Therefore, one has the following isomorphisms:
L φ−1Rφ∗F
’ (φ ◦ i)−1Rφ∗F
’ (iγ
’ φ0−1pγ
’ φ0−1Rφ0
’ RpL∗F.

L ◦ φ0)−1Rφ∗F
L∗Rφ∗F

∗RpL∗F

6. Integral sheaf metrics

(cid:3)

6.1. Generalities. In this section, we elaborate on our study of projected bar-
codes to introduce a family of pseudo-metrics on categories of sheaves inspired
by integral probability metrics [21]. Here, the probability measures are replaced
by sheaves and the integration of real-valued functions against the probability
measure by the pushforward of the sheaves by such functions. In this subsection,
we study the general properties of such metrics.

Let X be a good topological space. We denote by C 0(X) the algebra of con-
tinuous functions from X to R and by capital fraktur letters such that F, B, R
subsets of continuous functions. Given a class F of functions and writing distR for
the convolution distance on Db(kR), we introduce the following pseudo-metrics on
Db(kX)
(6.1)

(distR(Rf!F, Rf!G)),

δF(F, G) = sup
f ∈F

(6.2)

dF(F, G) = sup
f ∈F

(distR(Rf∗F, Rf∗G)).

These pseudo-metrics are called integral sheaf metrics (ISM) and F is called a

generator of δF (resp. dF).

Remark 6.1. (a) In the above formula, the convolution distance can be replaced
by any distance on Db(kX) as for instance the Wasserstein distance. Here, we
focus on the convolution distance.

(b) If F , G ∈ Db(kX) have compact supports, then we have δF(F, G) = dF(F, G).

(cid:47)
(cid:47)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:15)
(cid:111)
(cid:111)
(cid:15)
(cid:15)
(cid:111)
(cid:111)
38

NICOLAS BERKOUK AND FRANÇOIS PETIT

Proposition 6.2. The mappings δF, dF : Ob(Db(kX))×Ob(Db(kX)) → R+ ∪{∞}
are pseudo-metrics.

Proof. This follows from the fact that distR is a pseudo-distance.

(cid:3)

Deﬁnition 6.3. Let F ⊂ C 0(X). The set RF! of all functions f ∈ C 0(X) such
that

(6.3)

distR(Rf!F, Rf!G) ≤ δF(F, G); for all F, G ∈ Db(kX)

is called the maximal generator of δF. Similarly, we deﬁne for dF the set RF∗ and
call it the maximal generator of dF .

We have the following straightforward lemma.

Lemma 6.4. Let F ⊂ D and F , G ∈ Db(kX). Then,

(i) δF(F, G) ≤ δD(F, G),
(ii) RF! ⊂ RD!,
(iii) if D ⊂ RF!, then δF = δD.
Similar results hold for RF∗ and RD∗.

Proof. The points (i) and (ii) are clear. For (iii), it follows from (i) that for every
F and G in Db(kX) δF(F, G) ≤ δD(F, G). Applying (i) again we get

δD(F, G) ≤ δRF!(F, G) = δF(F, G).

Hence, δF = δD.

(cid:3)

Proposition 6.5. Let F be a generator of δF (resp. dF)

(i) f ∈ RF! implies af + b ∈ RF! for all a ∈ [−1, 1] and b ∈ R
(ii) if the sequence (fn)n∈N ⊂ RF! converges uniformly to f , then f ∈ RF!

Proof.
(ii) Let (fn)n∈N be a sequence of continuous functions of RF! converging uni-

(i) Follows from Lemma 2.7.

formly to a function f and let F, G ∈ Db(kX). Then,

distR(Rf!F, Rf!G) ≤distR(Rf!F, Rfn!F ) + distR(Rfn!F, Rfn!G)

+ distR(Rfn!G, Rf!G)
≤ 2 kf − fnk∞ + δF(F, G)

(Stability Theorem)

Hence, taking n to inﬁnity, the above inequality implies

distR(Rf!F, Rf!G) ≤ δF(F, G).

(cid:3)

PROJECTED DISTANCES

39

6.2. A comparison result. In this subsection, we relate the pseudo-distances
dF and δF when the underlying space is a real ﬁnite dimensional normed vector
space (V, k·k).

Proposition 6.6. Let F, G ∈ Db(kV), then

Proof. Let f : V → R be a continuous map. Then,

dF(DV(F ), DV(G)) ≤ δF(F, G).

Rf∗DV(F ) ’ DR(Rf!F ).

Hence,

distR(Rf∗DV(F ), Rf∗DV(G)) = distR(DV(Rf!F ), DV(Rf!G))

≤ distR(Rf!F, Rf!G)

(by Proposition 2.8 (ii))

which implies that dF(DV(F ), DV(G)) ≤ δF(F, G).
Proposition 6.7. Assume that F ⊂ A(V∞) and that F, G ∈ Db

Rc(kV∞). Then,

(cid:3)

dF(DV(F ), DV(G)) = δF(F, G).

Proof. Let F, G ∈ Db
constructible up to inﬁnity. Hence,

Rc(kV∞). By Proposition 2.16, Rf!F and Rf!G are again

distR(Rf∗DV(F ), Rf∗DV(G)) = distR(DV(Rf!F ), DV(Rf!G))

= distR(Rf!F, Rf!G)

(by Lemma 2.9).

The result follows by taking the supremum over F on both sides of the equality. (cid:3)

6.3. Lipschitz ISM. In order to get well behaved ISMs, it is natural to assume
that the set F in the deﬁnition of the ISM is a subset of the Lipschitz functions.
Let (X, d) be a good metric space, (V, k·k) be a normed ﬁnite dimensional real

vector space. We denote the space of Lipschitz functions from X to V by

Lip(X, V) = {f : X → V| f is Lipschitz on X}.

The space Lip(X, V) can be equipped with the following semi-norm

(6.4)
L(f ) = sup{kf (x) − f (y)k /d(x, y)| x, y ∈ X, x 6= y}.
We also set Lip≤1(X, V) = {f ∈ Lip(X, V)| L(f ) ≤ 1}. If V = R, we write Lip(X)
instead of Lip(X, V) and similarly for Lip≤1(X, V).

A pointed metric space (X, d, x0) is a metric space (X, d) together with a dis-
tinguished point x0 ∈ X. If X is a vector space, we always choose x0 = 0. For a
pointed metric space (X, d, x0), we set

Lip0(X, R) = {f : X → R| f is Lipschitz on X and f (x0) = 0}.
The following proposition is immediate in view of Theorem 2.11. It asserts that
Lipschitz ISMs provide lower bounds for the convolution distance for sheaves on
a good metric space.

40

NICOLAS BERKOUK AND FRANÇOIS PETIT

Proposition 6.8. Let (X, d) be a good metric space and F, G ∈ Db(kX). Assume
that F ⊂ Lip≤1(X). Then

(i) δF(F, G) ≤ distX(F, G),
(ii) if furthermore, X is a real ﬁnite dimensional vector space endowed with the

euclidean norm, dF(F, G) ≤ distX(F, G).

The following proposition is a direct corollary of Proposition 6.8 combined with

Theorem 2.10. It states that Lipschitz ISMs are stable.
Corollary 6.9. Let (V, k·k) be a ﬁnite dimensional and Z be a locally compact
space and let F ⊂ Lip≤1(V). Let F ∈ Db(kZ) and f1, f2 : Z → V be two continuous
maps. Then

δF(Rf1!F, Rf2!F ) ≤ kf1 − f2k∞

δF(Rf1∗F, Rf2∗F ) ≤ kf1 − f2k∞ .

If furthermore the norm k·k is euclidean, then

dF(Rf1!F, Rf2!F ) ≤ kf1 − f2k∞

dF(Rf1∗F, Rf2∗F ) ≤ kf1 − f2k∞ .

Lemma 6.10. Let F ⊂ {f ∈ Lip0(X, R)| L(f ) ≤ 1} and D = {f ∈ F| L(f ) =
1} ∩ F. Assume that for every f ∈ F \ {0}, f /L(f ) ∈ F. Then δF = δD and
dF = dD.

Proof. We only prove the statement for δF and δD as the proof is similar for dF
and dD.

Since D ⊂ F, δF ≥ δD.
We now prove the reverse inequality. Let f ∈ F \ {0}. Then g = f /L(f ) ∈ D

and for every F, G ∈ Db(kX)

distR(Rf!F, Rf!G) ≤

1
L(f )

Hence, δF ≤ δD.

distR(Rf!F, Rf!G) = distR(Rg!F, Rg!G).

(cid:3)

We now prove some inequalities that we will use to control the regularity of

Lipschitz ISM.

Lemma 6.11. Let (X, d) be a good metric space, f, g ∈ Lip(X) and F, G ∈
Db

comp(kX). Set S = Supp(F ) ∪ Supp(G). Then

|distR(Rf!F, Rf!G) − distR(Rg!F, Rg!G)| ≤ 2 diam(S)L(f − g).

Proof. Since S is compact, there exists (x0, x1) in S × S such that diam S =
d(x0, x1). Moreover distR is invariant by translation. Hence setting ˜f (x) = f (x) −
f (x0) and ˜g(x) = g(x) − g(x0), we get that

distR(Rf!F, Rf!G) = distR(R ˜f!F, R ˜f!G),
distR(Rg!F, Rg!G) = distR(R˜g!F, R˜g!G).

Thus,
|distR(Rf!F, Rf!G) − distR(Rg!F, Rg!G)| = |distR(R ˜f!F, R ˜f!G) − distR(R˜g!F, R˜g!G)|

PROJECTED DISTANCES

41

and
|distR(R ˜f!F, R ˜f!G) − distR(R˜g!F, R˜g!G)| ≤ |distR(R ˜f!F, R ˜f!G) − distR(R ˜f!F, R˜g!G)|
+ |distR(R ˜f!F, R˜g!G) − dist(R˜g!F, R˜g!G)|
≤ distR(R ˜f!F, R˜g!F ) + distR(R ˜f!G, R˜g!G)

≤ 2

(cid:13)
˜f |S − ˜g|S
(cid:13)
(cid:13)
≤ 2 sup
x∈S

(cid:13)
(cid:13)
(cid:13)∞

(d(x, x0))L(f − g)

≤ 2 diam(S) L(f − g).

(cid:3)

6.4. Distance kernel. We now give a ﬁrst example of ISM.

Let (V, k·k) be a ﬁnite dimensional normed vector space such that the distance

(x, y) 7→ kx − yk is subanalytic. We set

‘x0 : X → R,

x 7→ ‘x0(x) = kx − x0k .

For every x in V, the map ‘x is 1-Lipschitz and proper. Let X be a subset of V.
We set FX = {‘x, x ∈ X} and consider the Lipschitz ISM δFX generated by FX,
namely

δF(F, G) = sup
‘x∈FX

distR(R‘x!F, R‘x!G),

for F, G ∈ Db(kV).

Remark 6.12. (a) More generally the above ISM can be deﬁne on any real
analytic manifold endowed with a subanalytic distance.
(b) Since the applications ‘x are proper, we have that δF = dF.

We recall the deﬁnition of the local Euler-Poincaré index of an object F ∈
Rc(kX).

Db

χ(F ) : X → Z,

x 7→ χ(F )(x) := X
i∈Z

(−1)i dim(Hi(Fx)).

Proposition 6.13. Let F, G ∈ Db

Rc(kV) and assume that δFV(F, G) = 0. Then,

(i) for every x ∈ V and r > 0, RΓ(B0(x, r); F ) ’ RΓ(B0(x, r); G),
(ii) Fx ’ Gx
(iii) χ(F ) = χ(G)

Proof. It is clear that (i) implies (ii) and (ii) implies (iii). Hence, we only prove
Rc(kV). It follows from the deﬁnition of δFV, that for every x ∈ V
(i). Let F, G ∈ Db
distR(R‘x!F, R‘x!G) = 0. Moreover since for every x, ‘x is proper and subanalytic,
R‘x!F and R‘x!G are constructible. Hence, by [1, Thm. 6.3], we have that

(6.5)

R‘x0 !F ’ R‘x0 !G.

42

NICOLAS BERKOUK AND FRANÇOIS PETIT

Moreover,

RΓ(k[0,r[, R‘x0 !F ) ’ RHom kV(k[0,r[, R‘x0 !F )

’ RHom kV(‘−1
’ RHom kV(k‘−1
’ RΓ(B0(x0, r), F ).

x0 k[0,r[, F )
x0 ([0,r[), F )

Hence, Applying the functor RΓ(k[0,r[, ·) to both side of the isomorphism (6.5) we
(cid:3)
get that RΓ(B0(x0, r), F ) ’ RΓ(B0(x0, r), G).

6.5. Linear ISM. We assume that (V, k·k) is a real ﬁnite dimensional normed
vector space and denote by V∗ its dual. Again, by analogy with integral probabil-
ity metrics, it is natural to consider the set L = {u ∈ V∗|L(u) ≤ 1} and introduce
the distance δL i.e. for F, G ∈ Db(kV)

δL(F, G) =

sup
{u∈V∗|L(u)≤1}

distR(Ru!F, Ru!G).

Proposition 6.14. Let F ∈ Db

Rc(kV∞). If δL(F, 0) = 0, then F ’ 0.

Rc(kV∞) such that δL(F, 0) = 0. Since F ∈ Db

Rc(kV∞), it follows
Rc(kV∞). Applying Theorem 3.22, we deduce that for every u ∈ V∗,
(cid:3)

Proof. Let F ∈ Db
that Ru!F ∈ Db
Ru!F = 0. Now, Proposition 4.4 implies that F ’ 0.
Corollary 6.15. Let u, v ∈ V∗ and F, G ∈ Db
Supp(G). Then

comp(kV). Set S = Supp(F ) ∪

|dist(Ru!F, Ru!G) − dist(Rv!F, Rv!G)| ≤ 2 diam(S) |||u − v|||.
Proof. For a linear map u ∈ V∗, L(u) is equal to the operator norm |||u||| of u.
(cid:3)
Then, the inequality follows from Lemma 6.11.

The above proposition implies that for F, G ∈ Db

comp(kV) the map

ΥF,G : V∗ → R, u 7→ distR(Ru!F, Ru!G)
is Lipschitz on V∗. It follows from the Rademacher Theorem that the map ΥF,G is
C 1 almost everywhere. Since it is continuous and {u ∈ V∗|L(u) ≤ 1} is compact
ΥF,G reaches its supremum that is for F, G ∈ Db

comp(kV)

δL(F, G) = max
u∈L

ΥF,G(u).

6.6. Sliced convolution distance. The result of the preceding section allows to
introduce the notion of sliced convolution distance for sheaves in Db
comp(kV). For
the sake of simplicity, we assume that V is endowed with the euclidean norm k·k2
and let distV be the convolution distance associated with k·k2. Corollary 6.15 im-
comp(kV) the map ΥF,G : V∗ → R, u 7→ distR(Ru!F, Ru!G)
plies that for F, G ∈ Db

PROJECTED DISTANCES

43

is measurable. Hence, for p ∈ N∗, we set

(6.6)

Sp(F, G) :=

1
Vol(S∗)

(cid:18)Z

S∗

ΥF,G(u)p du

(cid:19) 1
p

where S∗ is the Euclidean sphere of radius 1 of V∗ and du is the canonical volume
form on S∗.

The following proposition is clear.

Proposition 6.16. The application Sp : Ob(Db
is a pseudo-distance and for F, G ∈ Db

comp(kV)

comp(kV)) × Ob(Db

comp(kV)) → R+

Sp(F, G) ≤ distV(F, G).

Lemma 6.17. Let F ∈ Db

Rc,comp(kV∞). If Sp(F, 0) = 0, then F ’ 0.

Proof. It follows from the hypothesis that the function ΥF,0 is zero almost every-
where on S∗ and as it is continuous, ΥF,0 = 0 on S∗. Lemma 2.7 (ii) implies that
(cid:3)
ΥF,0 = 0 on V∗. Then, the result follows from Proposition 6.14.

6.7. A Question. The following question as well as the study of integral sheaf
metrics was already mentioned in [22]. Here, we recall this question and remark
a few facts.

Question 6.18. Let F, G ∈ Db

Rc(kV). Does the following equality hold

distV(F, G) ?= sup
f ∈Lip≤1

(distR(Rf∗F, Rf∗G))

Remark 6.19. The fact that we are working over a vector space, hence con-
tractible, is essential for the question.
Indeed, let us provide a counterexam-
ple where the space is no longer contractible. Let S1 = {z ∈ C | |z| = 1}
equipped with its standard riemannian structure. Let m : S1 → S1 deﬁned
by m(z) = z2. Let F = kS1 and G = Rm∗F .
It is clear that F and G
are non-isomorphic local systems on S1. Therefore, by [23, Proposition 2.3.7],
distS1(F, G) = ∞. Let p : S1 → R be a 1-Lipschitz map. Then one has that
supp(Rp∗F ), supp(Rp∗G) ⊂ Im(p), in particular, the supports of Rp∗F and Rp∗G
are compact. Moreover, since p is 1-Lipschitz, diam(Im(p)) ≤ diam(S1) = 2. Since
Rp∗F and Rp∗G have isomorphic global sections, one deduces by [16, Remark 2.5
(i)] that distR(Rp∗F, Rp∗G) ≤ 2. To summarize, we have:

distS1(F, G) = ∞ and

sup
f ∈Lip≤1

(distR(Rf∗F, Rf∗G)) ≤ 2,

which contradicts the question over S1.

44

NICOLAS BERKOUK AND FRANÇOIS PETIT

7. Metric for multi-parameter persistence modules

In this section, we make use of the structure of γ-sheaves to construct metrics
which are eﬃciently computable in the case for sub-level sets persistent modules
by relying on software dedicated to one-parameter persistence modules and recent
advances on optimization of topological functionals [24]. One of these distance is
an ISM whereas the second is a sliced distance. We study the properties of these
two metrics.

7.1. γ-linear ISM. We now introduced an ISM tailored for γ-sheaves. In view of
Proposition 4.5, it is natural to consider the following pseudo-distance on Db
γ◦,a(kV)
(Note that though this pseudo-distance is well deﬁned on Db(kX), it is mostly
interesting Db

γ◦,a(kV)).

(7.1)

δγ◦(F, G) =

sup
{u∈γ◦|L(u)≤1}

distR(Ru!F, Ru!G)

Lemma 7.1. The following equality holds

δγ◦(F, G) =

sup
{u∈Int(γ◦)|L(u)≤1}

distR(Ru!F, Ru!G).

Proof. This follows from Lemma 4.11.

(cid:3)

Proposition 7.2. Let F, G ∈ Db
δγ◦(F, G) = ∞. Then δL(F, G) = δγ◦(F, G).

γ◦,a(kV) and assume that δL(F, G) < ∞ or

Proof. Since δγ◦ is a lower bound of δL, the case δγ◦(F, G) = ∞ is clear. Hence,
we assume that δL(F, G) < ∞. Let u /∈ γ◦ such that L(u) ≤ 1. It follows from
Proposition 4.5 that Ru!F is either a constant sheaf or the zero sheaf and similarly
for Ru!G. Moreover, distR(Ru!F, Ru!G) < ∞ since δL(F, G) < ∞. Thus it follows
from [23, Prop. 2.3.7], that Ru!F ’ Ru!G which implies that distR(Ru!F, Ru!G) =
0. Hence,

δL(F, G) =

=

sup
{u∈V∗|L(u)≤1}
sup
{u∈γ◦|L(u)≤1}

distR(Ru!F, Ru!G)

distR(Ru!F, Ru!G)

= δγ◦(F, G).

Corollary 7.3. Let F, G ∈ Db
δγ◦(F, G).

γ◦,a(kV) with compact supports. Then δL(F, G) =

Proof. Let F, G ∈ Db
γ◦,a(kV) with compact supports. Since they are γ-sheaves
with compact support RΓ(V; F ) ’ RΓ(V; G) ’ 0. Then [16, Example 2.4], implies
that distV(F, G) < ∞. Thus, δL(F, G) < ∞ and applying Proposition 7.2, the
(cid:3)
result follows.

(cid:3)

PROJECTED DISTANCES

45

We denote by Db
by the objects of Db

Rc,γ◦,a(kV) the full triangulated subcategory of Db(kV) spanned
γ◦,a(kV) ∩ Db

Rc(kV)

Proposition 7.4. Let F ∈ Db
If δγ◦(F, 0) = 0, then F ’ 0.

Rc,γ◦,a(kV). Assume that F is γ-compactly generated.

Proof. Since F is constructible, it follows from Theorem 3.22 that for every u ∈
(cid:3)
Int(γ◦), Ru!F ’ 0. Then Proposition 4.24 implies that F ’ 0.
Proposition 7.5. Let F, G ∈ Db

Rc,γ◦, a(kV∞), then

δγ◦(F, G) = max
j∈Z

(δγ◦(Hj(F ), Hj(G))

= max
j∈Z

sup
{u∈γ◦|L(u)≤1}

(dB(B(Hj(Ru!F )), B(Hj(Ru!F )))).

Proof. Let F, G ∈ Db

Rc,γ◦, a(kV).

δγ◦(F, G) =

sup
{u∈γ◦|L(u)≤1}

(distR(F, G))

=

sup
{u∈γ◦|L(u)≤1}

(max
j∈Z

distR(Hj(F ), Hj(G)))

= max
j∈Z

= max
j∈Z

= max
j∈Z

distR(Hj(F ), Hj(G)))

sup
(
{u∈γ◦|L(u)≤1}
(δγ◦(Hj(F ), Hj(G))

(Corollary 3.20)

sup
{u∈γ◦|L(u)≤1}

(dB(B(Hj(Ru!F )), B(Hj(Ru!G)))).

(cid:3)

Corollary 7.6. Let S and S0 be compact good topological spaces, f : S → V and
g : S0 → V be continuous maps. Assume that PH(f ) and PH(g) are constructible.
Then

δγ◦(PH(f ), PH(g)) = max
j∈Z

sup
{u∈γ◦|L(u)≤1}

(dB(B(PHj(u ◦ f )), B(PHj(u ◦ g)))).

Proof. It follows from Proposition 7.5 that

δγ◦(PH(f ), PH(g)) = max
j∈Z

sup
{u∈γ◦|L(u)≤1}

(dB(B(Hj(Ru! PH(f )), B(Hj(Ru! PH(g)))).

Let u ∈ Int(γ◦). Then u is proper on f (S) + γa and on g(S0) + γa. Hence, it is
proper on Supp(PH(f )) and Supp(PH(g)). Then by Lemma 4.19 (ii), Ru! PH(f ) ’
PH(u ◦ f ) and similarly Ru! PH(g) ’ PH(u ◦ g). This implies that

dB(B(Hj(Ru! PH(f )), B(Hj(Ru! PH(g))) = dB(B(PHj(u ◦ f )), B(PHj(u ◦ g)))

which conclude the proof.

(cid:3)

The above results leads naturally to introduce the following pseudo-metrics that

we call truncated γ-integral sheaves metrics.

46

NICOLAS BERKOUK AND FRANÇOIS PETIT

Deﬁnition 7.7. Let F, G ∈ Db
γ-integral sheaf metric is

Rc,γ◦, a(kV) and p ≤ q ∈ Z. The (p, q)-truncated

δp,q
γ◦ (F, G) = max
p≤j≤q

(δγ◦(Hj(F ), Hj(G))

Proposition 7.8. The map

δp,q
γ◦ : Ob(Db

Rc,γ◦, a(kV)) × Ob(Db

Rc,γ◦, a(kV)) → R+ ∪ {∞}

is a pseudo-metric and

δp,q
γ◦ (F, G) ≤ δγ◦(F, G) ≤ distV(F, G).

7.1.1. Gradient computation. In this section, we compute explicitly the gradient
of the functional u 7→ distR(Ru!F, Ru!G) when F and G are γ-sheaves arising from
sub-level set persistence. We do so in order to approximate δγ◦ by gradient ascent.

Let F, G ∈ Dγ-cg(kV). We ﬁrst study the regularity of the application

(7.2)

ΥF,G : Int(γ◦) → R, u 7→ distR(Ru!F, Ru!G)

Proposition 7.9. Let u, v ∈ Int(γ◦) and F, G ∈ Db
constant CF,G in R≥0 depending on F and G such that

γ-cg(kV). Then there exists a

|ΥF,G(u) − ΥF,G(v)| ≤ CF,G|||u − v|||.

Proof. The proof is similar to the one of Lemma 6.11. Since F and G are γ-
compactly generated, there exists F 0 and G0 ∈ Db
? kγa
and G ’ G0 np
? kγa. We set S = Supp(F 0) ∪ Supp(G0). Since S is compact,
there exists (x0, x1) in S × S such that diam S = d(x0, x1). Moreover distR is
invariant by translation. Hence, setting ˜u(x) = u(x) − u(x0) = τu(x0) ◦ u and
˜v(x) = v(x) − v(x0) = τv(x0) ◦ u we get that

comp(kV) such that F ’ F 0 np

distR(Ru!(F 0 np

? kγa), Ru!(G0 np

? kγa)) = distR(R˜u!(F 0 np

? kγa), R˜u!(G0 np

? kγa)).

Moreover,

R˜u∗(F 0 np

? kγa)

? kγa) ’ Rτu(x0)∗Ru!(F 0 np
’ Rτu(x0)∗(Ru∗F 0 np
’ (Rτu(x0)∗Ru∗)F 0 np
’ R˜u∗F 0 np

? kR−

? kR−

? kR−) by Lemma 4.19

and similarly with ˜u replace by ˜v and F 0 by G0. Hence

ΥF,G(u) = distR(R˜u∗F 0 np

? kR−, R˜u∗G0 np

? kR−).

Now using Proposition 2.8 (ii), we get

PROJECTED DISTANCES

|ΥF,G(u) − ΥF,G(v)| ≤ distR(Ru∗F 0 np

? kR−, Rv∗F 0 np

? kR−)+

distR(R˜u∗G0 np

? kR−, R˜v∗G0 np

? kR−)

≤ distR(R˜u∗F 0, R˜v∗F 0) + distR(R˜u∗G0, R˜v∗G0)
≤ 2 k˜u|S − ˜v|Sk∞ ≤ 2 diam(S)|||u − v|||.

47

(cid:3)

The Rademacher Theorem combined with the above inequality implies the fol-

lowing corollary.

Corollary 7.10. Let F, G ∈ Db
(7.2) is diﬀerentiable Lebesgue almost everywhere on Int(γ◦).

γ-cg(kV). The application ΥF,G : Int(γ◦) → R (see

We choose a basis (e1, ..., en) of V, and denote (e∗

n) the associated dual
basis of V∗. Given u ∈ Intγ◦, we will denote u1, ..., un ∈ R the coordinates of u
in the basis (e∗
n). Let K1 and K2 be two ﬁnite simplicial complexes with
geometric realizations |K1| and |K2|, f : |K1| → V and g : |K2| → V be PL maps.
We deﬁne:

1, ..., e∗

1, ..., e∗

T (u) = distR(Ru!Rf!k|K1| ? kR−, Ru!Rg!k|K2| ? kR−).
With T j(u) := distR(Hj(Ru!Rf!k|K1| ? kR−), Hj(Ru!Rg!k|K2| ? kR−)), we deduce by
(3.20) that:

T (u) = max
j∈Z

distR(Hj(Ru!Rf!k|K1| ? kR−), Hj(Ru!Rg!k|K2| ? kR−))

= max
j∈Z

T j(u).

Let F denote the bottleneck distance function between two barcodes. For short,
2(u) =
2 )}) be the barcode of Hj(Ru!Rf!k|K1| ? kR−) (resp. Hj(Ru!Rg!k|K2| ? kR−)).

we write fu = u◦f and gu = u◦g. For j ∈ Z, let Bj
{[b0j
Therefore, we deduce by 3.20 that:

1)} (resp. Bj

1(u) = {[bj

2 , d0j

1, dj

T j(u) = dB(Bj
= F(Bj

1(u), Bj
1(u), Bj

2(u))
2(u)).

1 ⊂ R (resp. Ej

We now follow the exposition of [11, section 13.2.2] for the gradient computa-
tion. Let Ej
2 ⊂ R) be the set of endpoints of the interval appearing
in Bj
1 (resp. Bj
2), which we assume to be all distinct. Therefore, there exists an
inverse function ρu
1 → K1 (resp. ρu
2 → K2) mapping each birth
and death in Bj
2) to the corresponding simplex in K1 (resp. K2) gener-
ating or annihilating this bar. Moreover, this function is locally constant in u in
a precise sense (see [25, section 5]).

j Ej
1 : F
1 (resp. Bj

2 : F

j Ej

Therefore, one has the following computations:

NICOLAS BERKOUK AND FRANÇOIS PETIT

∂F
∂b

(Bj

1(u), Bj

2(u))

∂b
∂e∗
i

(u)

(Bj

1(u), Bj

2(u))

∂fu
∂e∗
i

(ρu

1(b)) + X
b∈Ej
2

∂F
∂b

(Bj

1(u), Bj

2(u))

48

∂T j
∂e∗
i

(u) = X
b∈Ej

1tEj
2
∂F
∂b

= X
b∈Ej
1


= ui




∂F
∂b

X

b∈Ej
1

(Bj

1(u), Bj

2(u))e∗

i (f (ρu

1(b))) + X
b∈Ej
2

∂F
∂b

(Bj

1(u), Bj

2(u))e∗

i (g(ρu

2(b)))




∂gu
∂e∗
i

(ρu

2(b))



Note that [1, Prop. 5.3] asserts that in the context of γ-sheaves, the function
F coincides with the usual bottleneck distance of persistence. Therefore, one can
use [25, Lemma 3] to compute the quantity ∂F
2(u)) which is either worth
1, −1 or 0.

1(u), Bj

∂b (Bj

7.2. γ-sliced convolution distance. In this subsection, we introduce a version
of the sliced convolution distance tailored to γ-compactly generated sheaves. For
the sake of simplicity, we assume that V = Rn and that it is endowed with
the norm k·k∞ and that γ = (−∞, 0]n. We endow V∗ with the dual basis of
the canonical basis of Rn. We also equip V∗ with its canonical scalar product.
Then, the aﬃne plane of V∗ deﬁned by the equation Pn
i=1 ui = 1 is a Riemannian
submanifold of V∗. Hence, we equip it with its canonical Riemannian measure
that we denote du. We deﬁne Qγ = {u ∈ Int(γ◦)||||u|||∞ = 1}. In other words
Qγ = {(u1; . . . ; un) ∈ Rn
i=1 ui = 1}. We consider the restriction of du to Qγ
and set Vol(Qγ) = R
Qγ du.
Let F, G ∈ Db

γ-cg(kV). It follows from Proposition 7.9 that the map

>0| Pn

ΥF,G : Int(γ◦) → R,
is Lipschitz on Qγ, hence measurable.

u 7→ distR(Ru!F, Ru!G)

For p ∈ N∗, we deﬁne the pth γ-sliced convolution distance between F and G

by

(7.3)

Sγ,p(F, G) =

1
Vol(Qγ)

 Z

Qγ

distR(Ru!F, Ru!G)p du

! 1
p

.

Proposition 7.11. The application Sγ,p : Ob(Db
is a pseudo-distance and for F, G ∈ Db

γ-cg(kV)

γ-cg(kV)) × Ob(Db

γ-cg(kV)) → R+

Lemma 7.12. Let F ∈ Db

Rc,γ-cg(kV∞). If Sγ,p(F, 0) = 0, then F ’ 0.

Sγ,p(F, G) ≤ distV(F, G).

Proof. It follows from the hypothesis that the function Υγ
on Qγ and as it is continuous, Υγ
on γ◦. Then, the result follows from Proposition 7.4.

F,0 = 0 almost everywhere
F,0 = 0
(cid:3)

F,0 = 0 on Qγ. Lemma 2.7 implies that Υγ

PROJECTED DISTANCES

49

7.3. Some aspects of the computation of the γ-linear ISM and the γ-
sliced convolution distance. As a proof of concept, we showcase here the re-
sults of our implementation of the estimation of the γ-linear ISM in the following
context. We endow R2 with the cone γ = (−∞, 0]2 and the norm k·k∞. Therefore,
with p1 and p2 the coordinate projections, we have Qγ = {pt = t · p1 + (1 − t) · p2 |
t ∈ [0, 1]}.

We sampled 300 points uniformly on a circle of radius 1, to which we added a
radial uniform noise in [0, 0.1]. We call this ﬁrst dataset X. The second dataset
Y was obtained by using the same sampling process than for X, then appending
to it 10 outlier points drawn uniformly in [−1, 1]2.

Figure 3. The datasets X (left) and Y (right)

We then performed a Kernel Density Estimation for X and Y , outputting two
functions κX, κY : [−1, 1]2 → R+, leading to two bi-ﬁltrations of [0, 1]2: fX =
(dX, −κX) and fY = (dY , −κY ). We computed the bottleneck distance between
the projected barcodes B(PH(pt ◦ fX) and B(PH(pt ◦fY ), as the parameter t of the
1-Lispchitz projection varies. The γ-linear ISM is the maximum of these distances,
while the p-sliced distance correspond to the p-th root of the integral of the p-th
power of this function 4a.

distance type
value

Sγ,1
Sγ,3
0.055 0.0057 0.0027 0.0019 0.090

Sγ,2

Sγ,4

δγ◦

Table 1. Values of the diﬀerent distances between PH(fX) and
PH(fY )

.

50

NICOLAS BERKOUK AND FRANÇOIS PETIT

(a) Bottleneck distance between projected barcodes, in function of the
parameter of the 1-Lipschitz projection. Note that t = 0 corresponds to
the 1-ﬁltration induced by the (co)density estimator on each pointcloud
ﬁltration, while t = 1 corresponds to the 1-ﬁltration associated to the
distance function to the pointcloud.

(b) Value of Sγ,p(PH(fX ), PH(fY )), as p varies.

PROJECTED DISTANCES

51

References

[1] N. Berkouk and G. Ginot. A derived isometry theorem for sheaves. Advances in Mathemat-

ics, 394:108033, 2022.

[2] N. Berkouk, G. Ginot, and S. Oudot. Level-sets persistence and sheaf theory, 2019. Available

at https://arxiv.org/abs/1907.09759.

[3] N. Berkouk and F. Petit. Ephemeral persistence modules and distance comparison. Alge-

braic & Geometric Topology, 21(1):247–277, 2021.

[4] H. B. Bjerkevik, M. B. Botnan, and M. Kerber. Computing the interleaving distance is

np-hard, 2019. Available at https://arxiv.org/abs/1811.09165.

[5] G. Carlsson and A. Zomorodian. The theory of multidimensional persistence. Discrete and

Computational Geometry, 42:71–93, 06 2007.

[6] M. Carrie`re and A. Blumberg. Multiparameter persistence image for topological machine
learning. In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin, editors,
Advances in Neural Information Processing Systems, volume 33, pages 22432–22444. Curran
Associates, Inc., 2020.

[7] A. Cerri, B. D. Fabio, M. Ferri, P. Frosini, and C. Landi. Betti numbers in multidimensional
persistent homology are stable functions. Mathematical Methods in the Applied Sciences,
36(12):1543–1557, 2013.

[8] F. Chazal, D. Cohen-Steiner, M. Glisse, L. J. Guibas, and S. Y. Oudot. Proximity of Per-
sistence Modules and Their Diagrams. In Proceeding of the 25th Annual Symposium on
Computationnal Geometry, SCG ’09, pages 237–246, New York, NY, USA, 2009. Associa-
tion for Computing Machinery.

[9] W. Crawley-Boevey. Decomposition of pointwise ﬁnite-dimensional persistence modules.

Journal of Algebra and Its Applications, 14(05):1550066, 2015.

[10] V. de Silva, E. Munch, and A. Stefanou. Theory of interleavings on categories with a ﬂow.

Theory and Applications of Categories, 33(21):583–607, 2018.

[11] T. Dey and Y. Wang. Computational Topology for Data Analysis. Cambridge University

Press, 2022.

[12] H. Gao. Radon transform for sheaves, 2017. Available at https://arxiv.org/abs/arXiv:

1712.06453.

[13] S. Guillermou. The three cusps conjecture, 2016. Available at https://arxiv.org/abs/

1603.07876.

[14] S. Guillermou and P. Schapira. Microlocal Theory of Sheaves and Tamarkin’s Non Dis-
placeability Theorem. In R. Castano-Bernard, F. Catanese, M. Kontsevich, T. Pantev,
Y. Soibelman, and I. Zharkov, editors, Homological Mirror Symmetry and Tropical Geom-
etry, pages 43–85. Springer International Publishing, 2014.

[15] M. Kashiwara and P. Schapira. Sheaves on manifolds, volume 292 of Grundlehren der
Mathematischen Wissenschaften. Springer-Verlag, Berlin, 1990. With a chapter in French
by Christian Houzel.

[16] M. Kashiwara and P. Schapira. Persistent homology and microlocal sheaf theory. J. Appl.

Comput. Topol., 2(1-2):83–113, 2018.

[17] V. L. Klee. Some topological properties of convex sets. Transactions of the American Math-

ematical Society, 78(1):30–45, 1955.

[18] C. Landi. The rank invariant stability via interleavings. In E. W. Chambers, B. T. Fasy,
and L. Ziegelmeier, editors, Research in Computational Topology. Springer International
Publishing, 2018.

[19] M. Lesnick and M. Wright. Interactive visualization of 2-d persistence modules, 2015.
[20] E. Miller. Stratiﬁcations of real vector spaces from constructible sheaves with conical mi-

crosupport, 2020. Available at https://doi.org/10.48550/arxiv.2008.00091.

52

NICOLAS BERKOUK AND FRANÇOIS PETIT

[21] A. Müller. Integral probability metrics and their generating classes of functions. Advances

in Applied Probability, 29(2):429–443, 1997.

[22] F. Petit. On some aspects of the theory of DQ-modules. Habilitation à dirirger des

recherches, 2021. Université de Paris.

[23] F. Petit and P. Schapira. Thickening of the diagonal, interleaving distance and Fourier-Sato

transform. arXiv:2006.13150, 2020.

[24] A. Poulenard, P. Skraba, and M. Ovsjanikov. Topological Function Optimization for Con-

tinuous Shape Matching. Computer Graphics Forum, 37(5):13–25, 2018.

[25] A. Poulenard, P. Skraba, and M. Ovsjanikov. Topological function optimization for contin-

uous shape matching. Computer Graphics Forum, 37(5):13–25, 2018.

[26] P. Schapira. Constructible sheaves and functions up to inﬁnity, 2021. Available at https:

//arxiv.org/abs/2012.09652.

[27] J. J. Stoker. Unbounded convex points sets. American Journal of Mathematics, 62(1):165–

179, 1940.

[28] G. Tauzin, U. Lupo, L. Tunstall, J. B. Pérez, M. Caorsi, W. Reise, A. Medina-Mardones,
A. Dassatti, and K. Hess. giotto-tda: A topological data analysis toolkit for machine learn-
ing and data exploration, 2021.

[29] The GUDHI Project. GUDHI User and Reference Manual. GUDHI Editorial Board, 3.5.0

edition, 2022.

[30] O. Vipond. Local equivalence of metrics for multiparameter persistence modules, 2020.

Available at https://arxiv.org/abs/2004.11926.

Laboratory for Topology and Neuroscience, EPFL, Lausanne, Switzerland.
Email address: nicolas.berkouk@epfl.ch

Université Paris Cité, CRESS, INSERM, INRA, F-75004 Paris France
Email address: francois.petit@inserm.fr

