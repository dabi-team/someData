2
2
0
2

p
e
S
2
1

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
9
8
4
5
0
.
9
0
2
2
:
v
i
X
r
a

AIROPA IV: Validating Point Spread Function Reconstruction on
Various Science Cases

Sean K. Terrya,*, Jessica R. Lua, Paolo Turrib, Anna Ciurloc, Abhimat Gautamc, Tuan Doc,
Michael P. Fitzgeraldc, Andrea Ghezc, Matthew Hosek Jr.c, Gunther Witzeld
aDepartment of Astronomy, University of California, Berkeley, CA 94720, USA
bDepartment of Physics & Astronomy, University of British Columbia, Canada, V6T 1Z1
cDivision of Astronomy & Astrophysics, University of California Los Angeles, CA 90095, USA
dMax-Planck-Institut f¨ur Radioastronomie, Auf dem H¨ugel 69, Bonn, D-53121, Germany

Abstract. We present an analysis of six independent on-sky datasets taken with the Keck-II/NIRC2 instrument.
Using the off-axis point spread function (PSF) reconstruction software AIROPA, we extract stellar astrometry, pho-
tometry, and other ﬁtting metrics in order to characterize the performance of this package. We test the effectiveness of
AIROPA to reconstruct the PSF across the ﬁeld of view in varying atmospheric conditions, number and location of PSF
reference stars, stellar crowding and telescope position angle (PA). We compare the astrometric precision and ﬁtting
residuals between a static PSF model and a spatially varying PSF model that incorporates instrumental aberrations and
atmospheric turbulence during exposures. Most of the ﬁtting residuals we measure show little to no improvement in
the variable-PSF mode over the single-PSF mode. For one of the data sets, we ﬁnd photometric performance is signiﬁ-
cantly improved (by ∼10×) by measuring the trend seen in photometry as a function of off-axis location. For nearly all
other metrics we ﬁnd comparable astrometric and photometric precision across both PSF modes, with a ∼13% smaller
astrometric uncertainty in variable-PSF mode in the best case. We largely conﬁrm that the spatially variable PSF does
not signiﬁcantly improve the astrometric and other PSF ﬁtting residuals over the static PSF for on-sky observations.
We attribute this to unaccounted instrumental aberrations that are not characterized through afternoon adaptive optics
(AO) bench calibrations.

Keywords: adaptive optics – PSF reconstruction, photometry, astrometry.

* sean.terry@berkeley.edu

1 Introduction

With the next generation of adaptive optics (AO) instruments coming online soon, it is becoming
increasingly important to properly characterize the spatial and temporal dependence of the point
spread function (PSF) for data obtained with AO. The Keck-I and Keck-II AO systems have been
used to deliver very high-resolution imaging for well over two decades, and have been continu-
ously upgraded and ﬁtted with newer generation hardware. The future of both Keck telescopes is
ﬁlled with several promising next-generation updates.1, 2

As a result of imperfect knowledge of the spatially varying (i.e. off-axis) PSF in these AO
systems, very precise astrometry and photometry for a large majority of stellar sources in crowded
ﬁelds (for example) has been limited. The Anisoplanatic and Instrumental Reconstruction of Off-
axis PSFs for AO (AIROPA) is a suite of software packages that utilizes phase-diversity mea-
surements, atmospheric proﬁle data, and wave propagation through both turbulence and optical
systems. With this knowledge, AIROPA generates a model of the ﬁeld-dependent PSF for both
natural guide star (NGS) and laser guide star (LGS) modes. The software functions under the
assumption that every PSF that is extracted consists of a convolution of the on-axis PSF, the instru-
mental aberration, and the atmospheric anisoplanatism.3 Further descriptions of AIROPA and the
sub-modules that it is built upon are given in.4

For context we give a brief description of the input data needed for AIROPA. These data are

1

 
 
 
 
 
 
used to generate the optical transfer function (OTF) grids (instrumental + atmospheric), on-axis and
off-axis PSFs, and other ﬁles for the subsequent photometric and astrometric analyses. Instrumen-
tal aberration maps are generated by conducting ﬁber phase-diversity measurements at the detector
plane for NIRC2. A grid of phase maps is generated, where each map is the result of the difference
between the measured on-axis wavefront and off-axis wavefront across the 1024x1024 pixel ﬁeld.
Since the instrumental phase maps are mostly static,5 the instrumental OTF can be read in from
a pre-determined library of OTFs at various rotator angles. This signiﬁcantly increases efﬁciency
and reduces computation time for a given AIROPA analysis. The multi-aperture scintillation sensor
(MASS) and differential image motion monitor (DIMM) are instruments on the summit of Mauna
Kea that monitor the seeing and generate atmopheric proﬁles (C 2
n) at altitudes of 0.5, 1, 2, 4, 8,
and 16 kilometers (km) above the summit. The algorithm that feeds this seeing information into
AIROPA is called ARROYO,6 and is built upon a set of C++ libraries. The AIROPA-generated
OTF then represents the combination of the instrumental phase maps and atmospheric proﬁle that
are needed in order to construct the ﬁeld-dependent PSF model. The PSF extraction and ﬁtting is
performed on each science image and ﬁnal star lists are generated with photometry and astrometry
for each detected source. Additionally, we rely on a ﬁtting metric deemed the fraction of variance
unexplained (FVU), for determining how well the PSF model has ﬁt the data in each image. For a
schematic on the variable-PSF algorithm in AIROPA, we refer to Figure 1 in.7

This study is the fourth in a series of papers detailing the AIROPA package;4 introduces
AIROPA and gives an overview of the software structure. Characterization of the Keck-II/NIRC2
instrumental aberrations and AIROPA’s usage of this aberration data is given in,5 and7 perform
tests of AIROPA on simulated and on-sky Galactic Center (GC) images. In this paper we focus on
expanding the on-sky tests of AIROPA. The paper is organized as follows: Section 2.1 describes
the analysis of a very crowded ﬁeld through three independent GC datasets. In Section 2.2, we
describe a less-crowded ﬁeld for a typical high-resolution gravitational microlensing science case.
In Section 2.3 we detail the observations of globular cluster Messier 53 (M 53) taken at various
position angles (PA). In Section 3 we compare the photometric, astrometric, and FVU results for
each science case. Finally, we give a discussion and conclude the paper in Section 4.

2 Observations

All datasets presented in this work were acquired on Keck-II with the Near-Infrared Camera 2
(NIRC2) narrow camera instrument in laser guide star adaptive optics (LGSAO) mode and with
the Kp ﬁlter (λc = 2.12 µm). The pixel scale for the NIRC2 narrow camera is 9.952 mas/pix,8 and
all the data were taken between May 2015 and August 2017.

A total of six cleaned frames from each dataset were reduced identically with a NIRC2 pipeline
that corrects for differential atmospheric refraction (DAR), bad pixels, cosmic rays, and other
undesirable effects9, 10 and applies geometric distortion corrections.8, 10 North is up and east is left
in all observations, with one exception for the PA = 90◦ observations where east is up and south
is left. Figure 1 shows the median Strehl ratio (SR) and full width half maximum (FWHM) values
and standard deviations for all datasets analyzed in this work. The right panel of Figure 1 shows
the atmosphere proﬁle information from the DIMM/MASS instruments for each dataset, with grey
shaded regions representing the time of observation considered in this analysis. The observation
timestamps span 8:30 pm to 4:30 am local Hawaiian Standard Time (HST). Table 1 shows the
quality metrics: median SR, FWHM, and root-mean-square deviation of the wavefront error (RMS

2

Fig 1: Left: Median SR and FWHM values for all datasets analyzed in this work. Right: 0.5 µm DIMM/MASS
seeing proﬁles for each dataset, respectively. Grey shaded region represents the time of observation for each set.

WFE). The table also gives observation dates and total exposure times for all datasets.

There are many reasons to include a wide range of variable condition data across different
stellar ﬁelds on-sky, which include testing the effects of varying DIMM/MASS proﬁles on PSF
extraction (Section 2.1), testing the ﬁtting precision on datasets with more (or less) PSF reference
stars in the ﬁeld (i.e. crowded or sparse ﬁelds, Sections 2.2 and 2.3), and determining the reliability
of goodness-of-ﬁt and other PSF ﬁtting residuals for extracted sources (Sections 3.1, 3.2).

Table 1: Observational data presented in Sections 2.1, 2.2, and 2.3

Date [UT]

Strehl Ratio

FWHM [mas] RMS WFE [nm] Exp. Time [s]

Field

GC (GQ)

GC (AQ)

GC (PQ)

2017 Aug 11

0.41 ± 0.039

2017 Aug 23

0.29 ± 0.024

2016 May 03 0.21 ± 0.025

OB150029

2016 Jul 14

0.39 ± 0.037

M53 (PA 0)

2015 May 05 0.27 ± 0.081

M53 (PA 90)

2015 May 05 0.35 ± 0.026

53 ± 4.5

66 ± 3.5

82 ± 6.6

48 ± 1.9

62 ± 7.8

55 ± 1.3

320 ± 18

380 ± 13

430 ± 18

330 ± 17

390 ± 44

350 ± 12

168

168

168

180

300

300

2.1 Comparing Atmospheric Conditions in a Very Crowded Field: The Galactic Center

We expand upon the initial on-sky GC testing of7 by including “good quality,” “average quality,”
and “poor quality” datasets (hereafter GQ, AQ, and PQ respectively) for further AIROPA valida-
tions on the GC. The GC case was used as the main science driver for the original development of

3

406080100Median FWHM (mas)0.00.10.20.30.40.50.6Median Strehl RatioGC (GQ)GC (AQ)GC (PQ)OB150029M53 (PA 0)M53 (PA 90)0.00.51.00.5 m Seeing [arcsec]GC (PQ)0.00.51.0GC (AQ)0.00.51.0GC (GQ)dimmmass0.00.51.0OB1500290.00.51.0M53 (PA 0)8pm9pm10pm11pm12am1am2am3am4am5amLocal Time (HST)0.00.51.0M53 (PA 90)AIROPA. This case is ideal since there already exists a rich high-resolution dataset spanning sev-
eral decades, dozens of reference stars for PSF modeling, and a very bright, uniform tip/tilt (TT)
star that is ∼13 arcseconds off-axis. The longest-running high-resolution study of the stellar popu-
lation immediately surrounding Sgr A∗ is being conducted by the Galactic Center Orbit Initiative1.
This work has led to a deep and well-understood knowledge9–13 of the environment immediately
surrounding the central supermassive black hole.

Fig 2: Left: Good-quality Galactic Center frame. Middle: Average-quality Galactic Center frame. Right: Poor-quality
Galactic Center frame. All images have the same color scale, the axes represent on-sky separation (in arcsecond) from
the LGS position. North is up and East is left in all frames.

We rank the three GC datasets, GQ, AQ, and PQ based on the historical quality of all GC
epochs taken with NIRC2 since 2004.14 The GQ data were taken on 2017-08-11, The AQ data
were taken ∼two weeks after the GQ data, on 2017-08-23, and the PQ data were taken on 2016-
05-03. For all GC datasets, each frame was composed of 10 coadded exposures at 2.8 s per coadd
for a total exposure time of 28 s per frame. One note about the PQ dataset — there does not exist

1https://galacticcenter.astro.ucla.edu/

Fig 3: Grid of FWHM values from AIROPA variable-PSF mode on the GQ (left), AQ (middle) and PQ (right)
datasets. Colored circle data points correspond to locations and K-band magnitudes of primary PSF reference stars. A
solid line connects the on-aixs LGS position to the off-axis TT guide star position.

4

-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")-4-2024x (")-4-2024y (")505254565860FWHM (mas)10.010.511.011.512.012.5K mag-4-2024x (")-4-2024y (")606264666870FWHM (mas)10.010.511.011.512.012.5K mag-4-2024x (")-4-2024y(")9092949698100FWHM (mas)10.010.511.011.512.012.5K magphase-diversity calibration data from 2016, therefore the 2017 instrumental phase maps were used
to substitute for the 2016 phase maps. This is not an issue, as5 show that the phase maps can remain
stable (within ∼59 nm) across multiple years, and any potential difference between 2016 and 2017
phase-diversity is likely small enough for an analysis of the kind presented in this work. Figure 2
shows one frame from each of the three epochs, with the spatial scale given as the separation (in
arcseconds) from the on-axis position (i.e. location of the LGS). We note that there are two other
axes of importance; the direction of the TT star (given by the solid line in Figures 3, 4, and 5),
and the position of the image sharpening (typically offset from the center of the image). Figure 3
shows the grid of FWHM values measured by AIROPA variable-PSF mode for each frame, plotted
over the ﬁeld of view to give a visualization of the ﬁeld-dependent PSF. The FWHM grid values
are calculated for every PSF generated by AIROPA in a PSF grid ﬁle. The AIROPA grid ﬁles for
the ﬁelds analyzed in this work use a partition size (i.e. step width of the PSF grid) of 102 pix.

2.2 A Less Crowded Field: OGLE-2015-BLG-0029

The Optical Gravitational Lensing Experiment (OGLE) survey15 conducts wide-ﬁeld visible and
near-IR imaging of nearly the entire Galactic Bulge region at high cadence and detects over 1000
microlensing events every season. Most ground-based imaging data from current microlensing
surveys are focused on the regions 3° > l > 357° and −2.5° < b < 2.5°. The ﬁrst non-GC
data analyzed in this work is OGLE-2015-BLG-0029 (hereafter OB150029), located at RA =
17:59:46.60, dec = -28:38:41.80 (J2000) and Galactic coordinates (l, b = (1.828°, −2.523°)). This
target has been regularly monitored with NIRC2 since 2015 as part of a project to study isolated
stellar-mass black hole candidates.16

The OB150029 observations were taken on 2016-07-14 in LGSAO mode with the Kp ﬁlter.

Fig 4: Left: NIRC2 frame of the OB150029 ﬁeld taken on 2016-07-14 with the Kp ﬁlter. Right: FWHM grid from
AIROPA variable-PSF mode with selected PSF reference stars colored by magnitude and solid line connecting the
on-axis position to the TT guide star.

Each of the frames consist of six co-added images, each with ﬁve second integration time, for

5

-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")OB150029-4-2024x (")-4-2024y (")47484950515253FWHM (mas)13.013.514.014.5K maga total integration time of 30 seconds per frame. The airmass during the six-frame observing
window was ∼1.65, and the median SR, FWHM, and RMS WFE values for the six frames are
given in Table 1, as well as the DIMM/MASS data given on the right-hand panel of Figure 1. This
is the second-best dataset (behind GQ) in terms of quality metrics like the median SR and FWHM
and their variances across all six frames. Similar to the PQ dataset, there are no 2016 phase maps
available for NIRC2, therefore the 2017 maps were substituted. Figure 4 shows a NIRC2 image of
the ﬁeld, which is clearly less crowded than the GC, particularly in the bright star regime.

There are a total of 10 PSF reference stars in this ﬁeld that were used for AIROPA, compared
to a total of 25 PSF reference stars used for the GC analysis described in Section 2.1. The total
number and spatial location of selected PSF reference stars is important for constructing accurate
PSF models, and the 10 stars chosen for the OB150029 ﬁeld include the microlensing target itself
(i.e. brightest star in the ﬁeld), as well as stars within 1.5 mag of the target, and separations of ±4
arcseconds from the target. The TT guide star used for the observations has an R mag ∼15.1 and
separation of ∼13.8 arcseconds to the south-west of the target, as indicated by the solid line in the
right panel of Figure 4.

2.3 Comparing Different Position Angles: Globular Cluster M53

The globular cluster M53 (NGC 5024) located at RA = 13:12:54.51, dec = 18:10:13.95 (J2000)
was observed with the NIRC2 narrow camera Kp ﬁlter on 2015-05-04 as part of a project to char-
acterize the NIRC2 geometric distortion.8 This was accomplished by comparing the NIRC2 stellar
positions to precise astrometry from Hubble Space Telescope (HST) Advanced Camera for Sur-
veys (ACS) observations.17 The NIRC2 camera and AO system was realigned in April 2015, and
observations of M53 before and after this realignment show an increase in the average geometric
distortion from ∼0.5 mas pre-realignment to ∼1.1 mas post-realignment.

Importantly for the current study, the M53 NIRC2 observations were taken at two different
position angles (PA); 0° and 90°. These observations present a unique dataset for us to compare
the astrometric accuracy between single-PSF and variable-PSF modes in AIROPA as a function of
PA. The previous study of8 assumed a static PSF to derive the geometric distortion solution, which
implies that using a variable-PSF on NIRC2 datasets will likely show residual distortion that was
not modeled out by the static PSF used to derive the solution. Depending on the signiﬁcance of this
effect, some fraction of the difference in astrometric, photometric, or FVU results between the PSF
modes may be attributed to this (Figures 10, ??, and 13). Due to the gradient in the NIRC2 distor-
tion solution, the local pixel scale changes across the detector. This change, however small, is not
detected in any PSF modeling because the aberration maps that are used are tip-tilt removed. This
is very likely only a minor effect. As our intention in this paper is not to fully derive a new geomet-
ric distortion solution (with single and/or variable-PSF), we select only a subset of M53 NIRC2
images to remain consistent with the number of GC and microlensing frames used in previous
sections. While it may prove beneﬁcial to fully derive a new independent variable-PSF distortion
solution for NIRC2, this is beyond the scope of the current paper. As shown in7 and Figure 6, the
astrometric differences between single-PSF mode and variable-PSF mode become more severe at
larger radii from the central on-axis position. This is predominantly caused by the difference in
PSF shape between the spatially varying model and the static model, particularly closer to the sides
and edges of the NIRC2 frame.

The M53 dataset includes six frames taken at a position angle of 0◦ (north up, east left), and six

6

Fig 5: Left Column: M53 NIRC2 frame taken at PA = 0◦, with accompanying FWHM grid generated by AIROPA.
Right Column: Same as left, but for PA = 90◦. The solid line connects the on-axis LGS position to the TT guide star.
The color scale is identical for both images in the top row.

frames taken at a position angle of 90◦ (east up, south left). The PA = 0◦ dataset consists of four
frames taken at the central pointing, and two frames taken after a dither of ∆x = −0.14”, ∆y =
0.16”. The PA = 90◦ dataset consists of four frames taken at the central pointing, and two frames
taken after a dither of ∆x = +0.14”, ∆y = −0.19”. The total exposure time is 50 seconds per
frame for both PAs. Figure 5 shows one frame taken at PA 0◦ and the accompanying grid of
FWHM values from AIROPA variable-PSF mode, as well as a PA 90◦ frame and FWHM grid.
The same 10 PSF reference stars were used for each PA, as well as the same TT guide star, which
has magnitude R ∼ 13.5 located 24 arcseconds to the south-west (solid line in the lower panels of
Figure 5).

7

-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")-4.0-2.00.02.04.0x (")-4.0-2.00.02.04.0y (")PA 0PA 9002004006008001000x (pix)02004006008001000y (pix)6065707580FWHM (mas)7.58.08.59.09.510.0K mag02004006008001000x (pix)02004006008001000y (pix)5254565860626466FWHM (mas)78910K mag-4-2024x (")-4-2024y (")6062646668707274FWHM (mas)78910K mag-4-2024x (")-4-2024y (")5052545658606264FWHM (mas)78910K mag-4-2024x (")-4-2024y (")6062646668707274FWHM (mas)78910K mag-4-2024x (")-4-2024y (")5052545658606264FWHM (mas)78910K magNEES3 Results

We present the AIROPA single-PSF and variable-PSF results for each ﬁeld analyzed. As mentioned
earlier, to maintain consistency we selected a subset of six consecutive frames from each dataset
and used the averaged astrometry, photometry, and FVU in our ﬁnal analysis and comparisons. All
of the selected GC data (as well as the microlensing data) have exactly one dither between the ﬁrst
three frames and last three frames, while the M53 data have exactly one dither between the second
and third frames (i.e. ﬁrst two frames at one dither position, last four frames at a subsequent dither
position).

There are three primary metrics that we used to assess the performance of each PSF mode in

Fig 6: Top row: 2D positional difference in single vs. variable PSF modes. Quiver plot shows positional differences
as a function of ﬁeld location. Bottom row: 1D positional differences with errors derived from the RMS deviation of
six positional measurements.

AIROPA, these are the photometric uncertainty, astrometric uncertainty, and FVU of the residual
image at the given position. We do expect the varying conditions, data quality, PSF reference
stars, and stellar crowding to impact AIROPA’s effectiveness to reconstruct the PSF. Along with

8

5 mas-4-2024X (")-4-2024Y (")-4-2024Variable X (")6420246Single - Variable X (mas)-4-2024Variable Y (")6420246Single - Variable Y (mas)6420246Single-VariableX(mas)6420246Single - Variable Y (mas)GC (GQ)050100N0100200Ninstrumental aberrations and atmospheric anisoplanatism, the combination of these factors (on the
instrument and on-sky) work to effectively increase the overall noise present in the reconstructed
PSFs, stellar proﬁles, and extracted photometry, astrometry, and FVU. For each dataset, a relative
comparison of these metrics between the PSF modes will reveal any differences in the overall
PSF-R performance or results for each mode.

Table 2: Photometric, astrometric differences in single and variable PSF modes for bright sources
m ≤ 13

∆m(S−V ) [mag]

∆r(S−V ) [mas]

Field

GC (GQ)

GC (AQ)

GC (PQ)

OB150029

M53 (PA 0)

M53 (PA 90)

Nbright
140

127

112

19

32

28

r ≤ 3''

r > 3''

r ≤ 3''

r > 3''

−0.05 ± 0.02

0.01 ± 0.03

0.08 ± 0.52

1.01 ± 0.75

−0.03 ± 0.03

0.02 ± 0.05

0.08 ± 0.74

1.01 ± 0.98

−0.02 ± 0.02

0.03 ± 0.04

0.07 ± 0.84

0.76 ± 1.25

0.03 ± 0.02

0.09 ± 0.04

0.12 ± 0.39

1.02 ± 0.56

−0.01 ± 0.04

0.04 ± 0.05

0.15 ± 0.68

0.95 ± 0.96

0.02 ± 0.03

0.10 ± 0.05

0.12 ± 0.68

0.55 ± 1.40

In addition to the three primary metrics mentioned above, we also compare the M53 astrometry
and photometry from each PSF mode to several external catalogs. We make these comparisons in
an attempt to determine which PSF mode gives results that are more consistent with an external
reference. As shown in Figures 6 and 7, and in,7 there is a clear relative difference in astrometry and
photometry between the two PSF modes in AIROPA. However, information on relative differences
alone does not tell us which PSF mode produces results that are closest to truth. This requires
comparisons like those described in the subsequent M53 results sections.

The various astrometry, photometry, FVU, and source color results are presented in several
tables throughout the results section. Table 2 reports the difference in measured magnitudes and
source positions in the two PSF modes. The stars and subsequent measurements are grouped into
two radii; r ≤ 3'', where the anisoplanatic effect on the PSFs should have a smaller impact, and
r > 3'', where anisoplanatism signiﬁcantly affects the shape of PSFs. Ideally, a spatially varying
reconstructed PSF (i.e. AIROPA variable-PSF mode) properly accounts for the anisoplanatic effect
by shaping the modeled PSF according to the instrumental and atmospheric components of the
OTF at the larger off-axis locations. Table 3 gives the average photometric and astrometric errors,
and average FVU results for all datasets analyzed in this work. The table includes results for all
detected stars in each set, as well as results for the brightest stars (mK < 13), as the PSF residuals
at the brightest magnitudes are affected primarily by PSF systematic errors rather than noise.7 This
effect can be seen in the FVU comparisons for bright stars in each ﬁeld (Figures 7, 9 and the right
columns in Table 3).

9

Fig 7: Ratio of astrometric errors, photometric errors, and FVU values for the GC datasets; GQ (left column), AQ
(middle column), and PQ (right column). Values larger than one indicate the variable-PSF mode resulted in smaller
astrometric/photometric residuals and smaller FVU, respectively. All stars are plotted in faint grey. Blue data points
represent 0.5 mag bins, with error bars representing the 1σ standard deviation of the ratios for stars in each bin.

3.1 Galactic Center

For the very crowded GC datasets, identical reductions and analyses were performed across each of
the six-frame sets. The same 25 PSF reference stars were used in each analysis and the astrometric,
photometric, and FVU results are given in the following three sub-sections. Note that for each of
the three datasets, we impose a requirement that in order for a star to be included in the analysis, it
must be detected in at least ﬁve of the six cleaned frames.

3.1.1 GC: Good Quality (GQ)

The GQ dataset contains the largest number of stars detected of all data analyzed in this paper. A
total of 840 stars were detected in at least ﬁve of the six GQ frames. Figure 6 shows the averaged
difference (from the six frames) between the measured star positions in single-PSF and variable-
PSF modes. The astrometric differences are largest at off-axis locations farthest from the frame
center, in part due to the difference in PSF shape between the static and the spatially variable PSF
models. The top right panel of Figure 6 shows the ﬁeld position for each detected star and the
corresponding 2D position difference on the detector plane. The 1D differences are shown in the
bottom panels of Figure 6. The mean astrometric difference in each direction across the detector
for bright stars inside and outside of a 3'' off-axis radius is given in Table 2, along with the mean
magnitude differences.

The average photometric and astrometric precision for all GQ stars in both PSF modes is
σm∼0.04 mag and σr∼0.81 mas, respectively. Further, the average FVU metric is very similar
for the variable-PSF mode (4.67 × 10−2) and single-PSF mode (4.70 × 10−2). There may be evi-
dence of some improvement in the astrometric errors and FVUs for only the brightest stars in the

10

0.00.51.01.52.0r,Single/r,VariableVariable BetterSingle BetterGQ0.00.51.01.52.0m,Single/m,Variable1012141618K mag0.00.51.01.52.0FVUSingle/FVUVariableAQ1012141618K magPQ1012141618K mag020406080100120140Nﬁeld (i.e. left column of Figure 7), but any possible improvement here is signiﬁcantly less than
what has been measured on simulation tests under similar conditions.7

3.1.2 GC: Average Quality (AQ)

The total number of stars detected across the AQ frames is 576, approximately 30% less than
the GQ dataset. As expected, the average uncertainties are marginally larger than those from the
GQ dataset. When comparing the results from both PSF modes, we measure marginally smaller
uncertainties for the variable-PSF mode over the single-PFS mode. While these results imply that
variable-PSF is performing better than single-PSF mode, we note again that these improvements
are still well below what has been shown through simulated data tests.

The average photometric precision for the AQ stars is σm∼0.038 mag for variable-PSF mode
and σm∼0.040 mag for single-PSF mode. Further, the measured astrometric precision is σr∼1.07
mas for variable-PSF mode and σr∼1.11 mas for single-PSF mode. Finally, the average FVU
metric is smaller (∼10%) for the variable-PSF mode (4.52 × 10−2) compared to single-PSF mode
(5.01 × 10−2).

3.1.3 GC: Poor Quality (PQ)

As expected the PQ dataset had the smallest number of detected stars, at 445, this is ∼23% less
than the AQ dataset and ∼47% less than the GQ dataset. As a reminder, Table 1 gives the median
PSF FWHM for the PQ dataset, 82 ± 6.6 mas. This is approximately 30 mas larger than the GQ
PSF and approximately 16 mas larger than the AQ PSF.

Similarly to the previous GC datasets, the PQ results show a marginal improvement for the
variable-PSF mode compared to single-PSF mode. The astrometric precision for variable-PSF
mode (σr∼1.32 mas) is just 2% less than single-PSF mode (σr∼1.35 mas). A better improvement
is seen in the photometric precision comparison; variable-PSF mode gives a precision of σm∼0.042
mag which is ∼10% smaller than the single-PSF mode precision (σm∼0.047). Finally, the average
FVU measurement across all detected stars is once again quite similar between the two modes;
variable-PSF gives an average FVU of 4.51 × 10−2 while single-PSF gives an average FVU of
4.64 × 10−2.

3.2 OB150029

The microlensing target OB150029 is located in the least-crowded stellar ﬁeld analyzed in this
work, with a total of 63 stars cross-matched in at least ﬁve out of six frames. For this data, 10
reference stars were used for the initial PSF model. Coincidentally, this is the same amount of
reference stars as the M53 dataset, and is 60% fewer reference stars than the GC datasets. We note
this dataset has the second-highest measured SR, and smallest FWHM of all datasets analyzed
(Table 1). Additionally, as can be seen in the right panel of Figure 4, this dataset has the smallest
variance in FWHM as measured across the ﬁeld (∼6 mas).

For the microlensing target itself, the AIROPA analysis shows a modest improvement of
∼13% in the astrometric precision in variable-PSF mode (σr = 0.223 mas) over single-PSF mode
(σr = 0.252 mas). The upper-left panel of Figure 9 shows the ratio of astrometric residuals for
all stars detected in both PSF modes (binned by magnitude), OB150029 is shown by the red data
point. The photometric uncertainty and FVU evaluated on the target for both PSF modes are very
similar, within 5% for single-PSF and variable-PSF modes. It should not be surprising that the

11

Fig 8: Zoomed image of the target OB150029 (left) and residual images from the single-PSF (middle) and variable-
PSF (right) modes. Residual images have identical color scales, and green points show the location of star detections.

Fig 9: Same as Figure 7, but for OB150029 (left column), M53 PA 0 (middle column), and M53 PA 90 (right column).

PSF ﬁtting errors and metrics are quite similar between single-PSF and variable-PSF for the target
star in this case since the location of the target on the detector is nearly on-axis (see left panel
of Figure 8) and the PSF shapes are not signiﬁcantly different for the static PSF and the central
PSF from the variable-PSF mode. The residual images show effectively identical over-subtracted
and under-subtracted features for both PSF modes (middle and right panel of Figure 8). We note
there is an unrelated neighbor star approximately 0.36 arcseconds to the SW of the target, with a
ﬂux ratio of f /fOB150029 ∼ 0.1. While the stellar proﬁle of this fainter neighbor may have a small
absolute effect on the SW wing of the OB150029 PSF, the magnitude of this effect will be the
same for each case. Additionally, inspection of the residuals at the location of the nearby neighbor

12

-0.6-0.4-0.20.00.2x (")0.00.20.40.60.8y (")OB150029-0.6-0.4-0.20.00.2x (")0.00.20.40.60.8y (")Single-0.6-0.4-0.20.00.2x (")0.00.20.40.60.8y (")Variabley (")x (")-0.6-0.4-0.20.00.2-0.6-0.4-0.20.00.2-0.6-0.4-0.20.00.20.00.20.40.60.80.00.51.01.52.0r,Single/r,VariableVariable BetterSingle BetterOB150029OB1500290.00.51.01.52.0m,Single/m,Variable1012141618K mag0.00.51.01.52.0FVUSingle/FVUVariableM53 (PA 0)1012141618K magM53 (PA 90)1012141618K mag051015202530Nshow no statistically signiﬁcant signal above or below the background noise in both cases.

The left column of Figure 9 shows the relationship (i.e. ratio) between the ﬁtting metrics as a
function of magnitude, and Table 3 reports the results for each metric and PSF mode. Generally,
the same trend appears in the microlensing dataset as the GC datasets; a marginal improvement in
the precision and ﬁtting residuals in variable-PSF mode compared to single-PSF mode. The largest
improvement is seen in both astrometric precision and FVU for variable-PSF mode, ∼10% smaller
than the single-PSF mode results.

As a ﬁnal test for this microlensing dataset, we performed an identical AIROPA analysis while
omitting the target itself as a PSF reference star.
Ideally, the results of such a test will reveal
the inﬂuence (if any) that the target (i.e. brightest star in the ﬁeld) has on the PSF modeling and
extraction as well as the ﬁtting parameters and residuals measured by the single-PSF and variable-
PSF algorithms. The results of this re-analysis show indistinguishable results for the astrometric
and photometric precision for the microlensing target (σr = 0.223 mas, σm = 0.025 mag), as well
as an FVU value that is consistent (within 1σ) of the value measured while including the target as
a PSF reference star.

3.3 M53

As described in Section 2.3, the two M53 datasets have signiﬁcantly different data qualities. In
particular, the PA 0◦ dataset has the largest variance in SR, FWHM, and RMS WFE of all data in
this study. One cause of this is the observing window for the PA 0◦ data spans a time frame where
the DIMM and MASS monitors recorded a particularly high seeing measurement (right panel of
Figure 1, green-colored data). This is likely due to high cirrus cloud cover or other turbulent
layers in the high-altitude atmosphere during two of the PA 0◦ exposures. A relatively small total
number of PA 0◦ images were taken on the night (see Table 1 of8), and the frames that correspond
to the DIMM/MASS spike seen in Figure 1 happen to be the images that have the most observed
sources in common with with the PA 90◦ images that were taken approximately one hour later in
the same night. Because we want to maintain consistency amongst all datasets and to maximize
the total number of cross-referenced stars in both PAs, we chose to keep all of the PA 0◦ frames
for this particular dither position. This mostly affects the fainter stars in the ﬁeld, as can be seen
by comparing the limiting magnitudes in the PA 0◦ and PA 90◦ panels in Figure 9. We note that
AIROPA (and the Arroyo software) associates two PA 0◦ images with the large DIMM and MASS
measurement.

3.3.1 M53 PA 0

A total of 98 stars were cross-matched across at least ﬁve of the six PA 0◦ frames, with 10 of
the stars used to build the initial PSF model. The location and brightness of the selected PSF
reference stars are given by the colored data points in the bottom panels of Figure 5. The difference
in astrometry, photometry, and FVU between single-PSF and variable-PSF modes largely follow
the same trends seen in the GC and OB150029 analyses (Tables 2 and 3). Interestingly, the most
signiﬁcant difference for the M53 PA 0◦ single and variable PSF modes comes from the comparison
of the photometric uncertainties (middle panel of Figure 9). The results show that the variable-PSF
mode gives signiﬁcantly lower photometric errors than the single-PSF mode (Table 3 columns 3−4
for M53 PA 0◦).

It is worth noting a similar, yet less signiﬁcant trend in photometric precision is also seen in

13

Table 3: Average photometric, astrometric uncertainties, and FVU results for each dataset

σm [mag]

σr [mas]

(cid:104)F V U (cid:105)

Field

GC (GQ)

GC (AQ)

GC (PQ)

OB150029

M53 (PA 0)

M53 (PA 90)

PSF Mode

Single

Variable

Single

Variable

Single

Variable

Single

Variable

Single

Variable

Single

Variable

All mK < 13
0.036

0.018

All mK < 13
0.815

0.472

All

0.047 ± 0.070

mK < 13
0.005 ± 0.017

0.036

0.040

0.039

0.047

0.042

0.037

0.035

0.068

0.049

0.051

0.059

0.019

0.021

0.021

0.033

0.028

0.032

0.031

0.063

0.045

0.036

0.039

0.806

1.111

1.069

1.350

1.327

0.613

0.622

1.071

1.040

0.962

0.972

0.427

0.732

0.711

1.012

0.962

0.454

0.424

0.670

0.626

0.306

0.307

0.047 ± 0.070

0.005 ± 0.017

0.050 ± 0.062

0.011 ± 0.030

0.045 ± 0.057

0.008 ± 0.022

0.046 ± 0.052

0.012 ± 0.018

0.045 ± 0.051

0.011 ± 0.018

0.105 ± 0.079

0.021 ± 0.021

0.101 ± 0.078

0.019 ± 0.019

0.162 ± 0.147

0.037 ± 0.059

0.167 ± 0.156

0.036 ± 0.057

0.202 ± 0.162

0.002 ± 0.001

0.215 ± 0.176

0.002 ± 0.001

Note. Average photometric uncertainty in magnitudes is given by σm (columns 3-4), average astrometric uncertainty
in milliarcseconds is given by σr (columns 5-6). The mean FVU and 1σ error is given in columns 7-8.

the poorest quality GC data set (GC PQ). These trends suggest that for lower-quality, less uniform
point sources, the spatially variable PSF model more precisely measures the intensity weighted
integrated coordinate of the stars compared to the static PSF model. Additionally, the magnitudes
and colors of the M53 stars as a function of off-axis location show a signiﬁcant improvement in
variable-PSF mode when comparing to an absolute HST reference (Section 3.3.3).

3.3.2 M53 PA 90

The higher quality PA 90◦ data has a total of 160 stars cross-matched in the images, with the same
10 stars used as PSF reference stars (lower-right panel of Figure 5). Like the previous data sets,
there is little to no improvement in the variable-PSF ﬁtting metrics compared to the single-PSF
results. The difference in stellar positions and magnitudes also follow similar trends seen in the
previous data (Table 2). The average photometric error for all stars is ∼15% larger in the variable
mode compared to single mode. The average astrometric error is nearly identical in both modes,
at a ∼1% difference. The FVU value in both modes are within 1σ of each other (bottom row of
Table 3).

Finally, we investigated the difference between astrometric residuals in both PSF modes after
matching and transforming the PA 0◦ star list to the PA 90◦ list (and vice versa). We perform a
ﬁrst-order transformation using both stacked star lists from each PA as the master reference list
and star list to be transformed in both cases. If the variable-PSF mode performs better, then we
would expect astrometric residuals from this transformation process to be smaller for the spatially

14

Fig 10: Upper-left: Quiver plot showing single-PSF astrometric residuals from the PA=0 →
PA=90 transformation. Upper-right: Same as upper-left, but for variable-PSF mode. lower-left:
Distribution of astrometric residuals from both PSF mode transformations. lower-right: Correla-
tion between astrometric residuals for both PSF modes, colored by Kp magnitude.

varying PSF mode, particularly for larger off-axis stars in the frames. Figure 10 shows the resulting
astrometric quiver plots in the top panels, and the distribution and correlation between the astro-
metric residuals in both PSF modes in the bottom panels. The two distributions are very similar,
and correlations largely follow the line of unity with a dispersion of ∼a few mas (bottom right
panel of Figure 10), which show that the astrometric residuals from the variable-PSF mode are not
measurably smaller than the single-PSF residuals.

3.3.3 HST Cross Reference

Both PA’s star lists were independently transformed to an HST reference frame described in Section
this section, with the same intention of examining the difference in astrometric residuals between
single and variable modes. Figure ?? shows the PA 90◦ astrometric residual quiver plots in the
upper panels, and corresponding distribution of astrometric residuals as well as the correlation be-
tween single-PSF and variable-PSF residuals in the lower panels. The distribution of astrometric

15

10 mas-4-2024PA0 X - PA90 X (") -4-2024PA0 Y - PA90 Y (")Variable PSF10121416Kp (mag)10 mas-4-2024PA0 X - PA90 X (")-4-2024PA0 Y - PA90 Y (")Single PSF10121416Kp (mag)05101520Astrometric Residual (mas)051015202530NSingle PSFVariable PSFService+2016 (quad-sum)05101520Single PSF Residual (mas)05101520Variable PSF Residual (mas)1 pixelresiduals peaks at 1.52 mas in both PSF modes, this is consistent with the residual distortion on the
NIRC2 detector that was found in8 (denoted by the vertical black line in the bottom left panel of
Figure ??). The weighted mean and central 68% of both PSF mode distributions is given in Table
4. This table includes all variations of star list transformations that were performed on the M53
data sets (i.e. NIRC2, HST, and Gaia described below).

Further, we used the HST photometric measurements as an absolute standard to compare
the NIRC2 single-PSF and variable-PSF photometry against. We do this by generating a color-
magnitude diagram (CMD) for each PSF mode and PA, where we compare the HST I − Keck K
color against the Keck K magnitudes for all cross-matched stars in each catalog. The NIRC2 data
were photometrically calibrated to 2MASS Ks band magnitudes for this process. We cross-identify
two bright stars in common between the NIRC2 data and 2MASS (2MASS J13125435+1810172
and 2MASS J13125408+1810194). From this cross-identiﬁcation we calculate a zero-point offset
of 3.70 and apply this to all stars in each catalog, including a calibration error of 0.06 magnitudes.
We then used the open-source package SPISEA18 to generate a synthetic population for the
cluster. We used parameters for the cluster age, metallicity, and mass fraction from19 and.20 We
also adopted the extinction law of21 when generating the population. The top panels of Figure 11
show the single-PSF and variable-PSF CMDs. The data are colored by off-axis radial distance in
the NIRC2 frames, and the best-ﬁt isochrone from SPISEA is overlaid (black curve). Characteris-
tic errors in color and magnitude for the CMDs are given by the vertical columns. There is a clear
trend seen in the comparison between the CMD stars and the isochrone model in the single-PSF
CMD. The difference in color between the stars and isochrone model shows a relatively strong
dependence on radial distance in the NIRC2 frames. This same dependence is not seen in the
comparison of the variable-PSF CMD and best-ﬁt isochrone model. The lower panels of Figure 11
show the color difference measurements (and errors) as a function of off-axis distance. A linear ﬁt
is made to each distribution, and the resulting slopes are 0.041±0.008 mag arcsec−1 for single-PSF
mode and −0.002 ± 0.009 mag arcsec−1 for variable-PSF mode. These results suggest roughly an
order of magnitude improvement in the photometric performance of the variable-PSF mode com-
pared to single-PSF mode. This marks the ﬁrst deﬁnitive example of a signiﬁcant improvement
shown by variable-PSF mode over the single-PSF mode for on-sky science data.

16

Fig 11: Top row: The M53 HST I−Keck K vs. Keck K CMDs for both single-PSF and variable-
PSF star lists. The solid black curve gives the best-ﬁt SPISEA isochrone, with age, metallicity,
mass fraction, and extinction from.19–21 Bottom row: The measured color index difference (i.e.
empirical − isochrone) in single-PSF and variable-PSF modes as a function of off-axis radial
distance. The solid red line shows the linear best-ﬁt to each distribution, with the shaded grey
region showing the 1σ spread around the best-ﬁt. The distribution of color differences for single-
PSF mode has a clear trend in radial distance, while the distribution is largely constant for variable-
PSF mode.

17

123HST I  Keck K13141516171819Keck K (mag)[Fe/H] = -2.10[Z] = 0.02Age = 12.60 GyrSingle PSF1234567r (")123HST I  Keck K13141516171819Keck K (mag)Variable PSF1234567r (")0246r (")1.00.50.00.51.0 Color (mag)Single PSFSlope=0.041±0.008 mag arcsec10246r (")Variable PSFSlope=0.002±0.009 mag arcsec13.3.4 Gaia Cross Reference

We continue our comparison of the single-PSF and variable-PSF catalogs by transforming both
lists to the Gaia EDR3 catalog.22 While Gaia has delivered exquisite astrometric data for over one
billion sources now, there are a sizable fraction of spurious values reported by the instrument that
are not so reliable. Recently, it has been shown that numerous astrometric solutions reported by
Gaia suffer quite signiﬁcantly for low signal-to-noise sources as well as for sources in crowded
ﬁelds.23 Given that the central region of M53 is crowded, we perform a careful investigation of
Gaia astrometric quality ﬂags for the stars cross-matched between NIRC2 and Gaia. A consid-
eration that we make when matching the two PA’s to Gaia are the astrometric ﬁtting errors as
described in22 and.24 In particular the “astrometric excess noise ((cid:15))” parameter is described as the
excess uncertainty that must be added in quadrature to obtain a statistically acceptable astromet-
ric solution. Further, the excess term (cid:15) is introduced in order to effectively reduce the statistical
weight of observations that may be affected by things like instrument and attitude modeling errors.
Another error term we consider is the “astrometric excess noise signiﬁcance”, which is described
as a dimensionless measure of the signiﬁcance of the calculated (cid:15). A value of > 2 indicates that
the reported (cid:15) is “probably signiﬁcant”.25 Further details on these astrometric error terms can be
found in.25

Figure 12 shows the values reported by Gaia for the two astrometric error terms described
above. The star symbols in the ﬁgure represent 32 NIRC2 stars that were cross-identiﬁed in Gaia.
All other Gaia stars within a 30 arcsecond radius of the center of the NIRC2 frame are plotted as
well, and both distributions are colored by Gaia G magnitude. Given the higher astrometric preci-
sion in both the Keck and HST data, we choose to make a cut on the Gaia stars at (cid:15) < 5 mas and
signiﬁcance < 2 (shaded regions in Figure 12), which leaves 24 Gaia stars used for the ﬁnal trans-
formation. As a note, we tested more strict and less strict cutting thresholds for this process (i.e.
some stars rejected by their signiﬁcance value) and found similar results for each scenario. The cut
at (cid:15) < 5 mas left a sufﬁcient number of stars needed for a reliable ﬁrst-order transformation, while
rejecting likely astrometric outliers (which are mostly faint, low-SNR stars).

The quiver plots in the top panels of Figure 13 show the 2D astrometric residuals after trans-
forming the PA 0◦ stars to the Gaia reference frame. The distribution of astrometric residuals for
both PA’s peaks at σr∼5 mas, and the faintest stars have the largest residuals, as expected. Table
4 shows the weighted mean for each distribution, where the mean and errors are largest for Gaia.
As described earlier, there are several reasons why the Gaia residuals are largest - generally the
Gaia astrometric precision is worse than HST (and NIRC2), especially for crowded ﬁeld sources.
The astrometric excess noise and other error terms contribute overall larger residuals when trans-
forming NIRC2 into the Gaia reference frame. Finally, the calculation of the weighted mean and
central 68% of the distribution is more signiﬁcantly affected by the spread in residuals (and possi-
ble outliers) for the much smaller Gaia data set (24 stars).

4 Discussion and Conclusion

We have analyzed several on-sky NIRC2 datasets with the the single PSF mode and spatially vari-
able PSF mode in AIROPA. We ﬁnd that the performance of AIROPA is reliable across different
conditions including poor, average, and good quality seeing, crowded or sparse stellar ﬁelds, vary-
ing numbers and brightnesses of PSF reference stars, and in different telescope PA’s.

18

Fig 12: Astrometric excess noise signiﬁcance vs. astrometric excess noise as a function of Gaia G magnitude in
the 30 arcsecond ﬁeld surrounding the center of the NIRC2 images. The reference stars used for the NIRC2 → Gaia
transformation are marked as star symbols. Dotted vertical and horizontal lines denote the noise and noise signiﬁcance
thresholds used to cut reference stars.

Table 4: M53 astrometric residuals from NIRC2, HST, and Gaia

Ref. Frame

PA 90

HST

Gaia

PA 0

HST

Gaia

Nmatched
94

90

24

94

157

24

PA 0

(cid:104)σrs(cid:105) [mas]
2.53+1.59
−0.47
1.93+1.39
−0.44
7.61+2.76
−1.19

PA 90

2.43+1.56
−0.49
1.85+1.36
−0.43
7.39+2.72
−1.20

(cid:104)σrv(cid:105) [mas]
2.82+1.67
−0.51
2.04+1.43
−0.45
7.35+2.71
−1.12

2.89+1.70
−0.68
1.99+1.42
−0.45
7.80+2.79
−1.25

19

101100101102astrometric excess noise (mas)101100101102103104astrometric excess noise signif.30" StarsMatched Stars141516171819Gaia G (mag)Fig 13: Same as Figures 10 and ?? but for stars transformed to Gaia EDR3. The color bar is given
in Gaia G magnitude.

Our analysis of the datasets largely show only a marginal improvement in photometric or astro-
metric residuals between the static PSF model and spatially variable PSF model within AIROPA.
A comparison of the FVU metric between the two modes show similar results. This implies that
the ability of AIROPA to reconstruct the PSF for a wide range of on-sky data remains limited by
unaccounted for static or quasi-static aberrations in the telescope. We also show that the effect of
varying atmospheric conditions, number and spatial location of selected PSF reference stars, and
telescope PA do not have a signiﬁcant effect on the performance of AIROPA in either of the modes.
One metric that does show a signiﬁcant improvement in the variable-PSF mode over the single-
PSF mode is a comparison of the color spread of M53 stars in a Keck + HST CMD. We ﬁnd a
measurable trend in photometry as a function of off-axis location in the single-PSF mode star cat-
alog, whereas the variable-PSF mode star catalog shows no trend. After comparing the ﬁtted trend
line for each case, we ﬁnd that the photometric performance is improved by ∼10× for the spatially
variable PSF mode. This represents the ﬁrst signiﬁcant improvement from the variable-PSF mode
that has been found for on-sky science data.

Comparing the FVU metrics between PSF ﬁtting modes across all datasets shows at best a

20

10 mas-4-2024PA0 X - Gaia X (") -4-2024PA0 Y - Gaia Y (")Variable PSF141516171819Gaia G (mag)10 mas-4-2024PA0 X - Gaia X (")-4-2024PA0 Y - Gaia Y (")Single PSF141516171819Gaia G (mag)0102030Astrometric Residual (mas)0246810NSingle PSFVariable PSF010203040Single PSF Residual (mas)010203040Variable PSF Residual (mas)1 pixel∼5% improvement in bright stars for the spatially varying PSF model over a static PSF model.
This is signiﬁcantly less than what has been shown in tests on simulated GC data.7 For OB150029
we measure an astrometric precision that is ∼13% smaller for the variable-PSF mode over the
single-PSF mode. However, the FVU metric for this target does not follow the same improvement
seen in the astrometry. For the M53 data, we ﬁnd that the astrometric residuals between single and
variable-PSF modes are quite similar when transforming a stack of PA = 0◦ frames onto the PA =
90◦ reference frame. Further, when transforming the two PA’s to the Gaia and HST reference, we
ﬁnd comparable astrometric residuals in both PSF modes.

Finally, for most of the ﬁtting metrics (except for the Keck + HST photometric comparison),
we largely conﬁrm the result of7 which shows no signiﬁcant improvement in ﬁtting residuals for
the spatially variable PSF mode in AIROPA with on-sky data. It is hypothesized that there remains
static or quasi-static instrumental aberrations that persist in the telescope and are not being fully
characterized by afternoon phase-diversity measurements. This hypothesis is backed up by a recent
analysis that shows a dominant source of error in the PSF comes from primary segment misalign-
ments (O. Beltramo-Martin in private communication). The work shows several hundred nm of
wavefront error (WFE) coming from the primary piston segments, which can become misaligned
as quickly as hours after initial alignment. Currently, the Keck-II primary mirror segments are
realigned every two-weeks, however these results suggest the cadence may need to be increased
in order to minimize any contribution to the PSF error from this primary segment phasing. Fu-
ture on-sky phase-diversity measurements should help in identifying the source(s) of instrumental
aberrations that are not currently accounted for in ﬁber phase-diversity measurements.

Acknowledgments

The data presented herein were obtained at the W. M. Keck Observatory, which is operated as a
scientiﬁc partnership among the California Institute of Technology, the University of California
and the National Aeronautics and Space Administration. The Observatory was made possible by
the generous ﬁnancial support of the W. M. Keck Foundation. The authors wish to recognize and
acknowledge the very signiﬁcant cultural role and reverence that the summit of Maunakea has
always had within the indigenous Hawaiian community. We are most fortunate to have the oppor-
tunity to conduct observations from this mountain.

SKT acknowledges support from the NSF through grant AST-1836016. We acknowledge sup-
port from the W. M. Keck Foundation, the Heising-Simons Foundation, the Gordon and Betty
Moore Foundation, and the NSF (AST-1412615, AST-1518273). SKT thanks Taylor Weiss and
Jeremy Van Kosh for helpful software discussions and comments on this manuscript. We thank the
staff of Keck Observatory for their help with obtaining calibration data and overall support for our
program.

References

1 P. Wizinowich, J. Chin, C. Correia, et al., “Keck all sky precision adaptive optics,” in Adaptive
Optics Systems VII, 11448, 114480E, International Society for Optics and Photonics (2020).
2 C. Z. Bond, S. Cetre, S. Lilley, et al., “Adaptive optics with an infrared pyramid wavefront
sensor at keck,” Journal of Astronomical Telescopes, Instruments, and Systems 6(3), 039003
(2020).

21

3 T. Do, A. Ciurlo, G. Witzel, et al., “Point-spread function reconstruction for integral-ﬁeld
spectrograph data,” in Adaptive Optics Systems VI, 10703, 107030I, International Society for
Optics and Photonics (2018).

4 G. Witzel, J. R. Lu, A. M. Ghez, et al., “The airopa software package: milestones for testing
general relativity in the strong gravity regime with ao,” in Adaptive Optics Systems V, 9909,
99091O, International Society for Optics and Photonics (2016).

5 A. Ciurlo, P. Turri, G. Witzel, et al., “AIROPA II: Modeling Instrumental Aberrations for
Off-Axis Point Spread Functions in Adaptive Optics,” Journal of Astronomical Telescopes,
Instruments, and Systems (submitted).

6 M. Britton, “The anisoplanatic point-spread function in adaptive optics,” Publications of the

Astronomical Society of the Paciﬁc 118(844), 885 (2006).

7 P. Turri, J. R. Lu, G. Witzel, et al., “Airopa iii: testing simulated and on-sky data,” Journal of

Astronomical Telescopes, Instruments, and Systems 8(3), 039002 (2022).

8 M. Service, J. Lu, R. Campbell, et al., “A new distortion solution for nirc2 on the keck ii
telescope,” Publications of the Astronomical Society of the Paciﬁc 128(967), 095004 (2016).
9 A. Ghez, S. Salim, N. Weinberg, et al., “Measuring distance and properties of the milky way’s
central supermassive black hole with stellar orbits,” The Astrophysical Journal 689(2), 1044
(2008).

10 J. Lu, A. Ghez, S. D. Hornstein, et al., “A disk of young stars at the galactic center as deter-

mined by individual stellar orbits,” The Astrophysical Journal 690(2), 1463 (2008).

11 A. Ghez, S. Salim, S. D. Hornstein, et al., “Stellar orbits around the galactic center black

hole,” The Astrophysical Journal 620(2), 744 (2005).

12 T. Do, A. Hees, A. Ghez, et al., “Relativistic redshift of the star s0-2 orbiting the galactic

center supermassive black hole,” Science 365(6454), 664–668 (2019).

13 A. K. Gautam, T. Do, A. M. Ghez, et al., “An adaptive optics survey of stellar variability at

the galactic center,” The Astrophysical Journal 871(1), 103 (2019).

14 S. Jia, J. R. Lu, S. Sakai, et al., “The galactic center: Improved relative astrometry for veloc-
ities, accelerations, and orbits near the supermassive black hole,” The Astrophysical Journal
873(1), 9 (2019).

15 A. Udalski, M. Szymanski, J. Kaluzny, et al., “The optical gravitational lensing experiment,”

Acta Astronomica 42, 253–284 (1992).

16 J. R. Lu et al., “,” (in prep).
17 J. Anderson, A. Sarajedini, L. R. Bedin, et al., “The acs survey of globular clusters. v. gener-
ating a comprehensive star catalog for each cluster,” The Astronomical Journal 135(6), 2055
(2008).

18 M. W. Hosek Jr, J. R. Lu, C. Y. Lam, et al., “Spisea: A python-based simple stellar population

synthesis code for star clusters,” The Astronomical Journal 160(3), 143 (2020).

19 A. Dotter, A. Sarajedini, and J. Anderson, “Globular clusters in the outer galactic halo: New
hubble space telescope/advanced camera for surveys imaging of six globular clusters and
the galactic globular cluster age–metallicity relation,” The Astrophysical Journal 738(1), 74
(2011).

20 R. Wagner-Kaiser, D. Stenning, E. Robinson, et al., “Bayesian analysis of two stellar popula-
tions in galactic globular clusters. ii. ngc 5024, ngc 5272, and ngc 6352,” The Astrophysical
Journal 826(1), 42 (2016).

22

21 E. F. Schlaﬂy, A. M. Meisner, A. M. Stutz, et al., “The Optical-infrared Extinction Curve and

Its Variation in the Milky Way,” The Astrophysical Journal 821, 78 (2016).

22 Gaia Collaboration, A. G. A. Brown, A. Vallenari, et al., “Gaia Early Data Release 3. Sum-
mary of the contents and survey properties,” Astronomy & astrophysics 649, A1 (2021).
23 J. Rybizki, G. M. Green, H.-W. Rix, et al., “A classiﬁer for spurious astrometric solutions in
gaia edr3,” Monthly Notices of the Royal Astronomical Society 510(2), 2597–2616 (2022).
24 Gaia Collaboration, A. G. A. Brown, A. Vallenari, et al., “Gaia data release 2-summary of

the contents and survey properties,” Astronomy & astrophysics 616, A1 (2018).

25 L. Lindegren, U. Lammers, D. Hobbs, et al., “The astrometric core solution for the gaia
mission-overview of models, algorithms, and software implementation,” Astronomy & Astro-
physics 538, A78 (2012).

23

