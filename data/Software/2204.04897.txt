2
2
0
2

r
p
A
1
1

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
7
9
8
4
0
.
4
0
2
2
:
v
i
X
r
a

MNRAS 000, 1‚Äì25 (2021)

Preprint 12 April 2022

Compiled using MNRAS LATEX style Ô¨Åle v3.0

ProFuse: Physical Multi-Band Structural Decomposition of Galaxies and
the Mass‚ÄìSize‚ÄìAge Plane

A. S. G. Robotham,1,2‚òÖ S. Bellstedt,1 S. P. Driver,1

1ICRAR, M468, University of Western Australia, Crawley, WA 6009, Australia
2ARC Centre of Excellence for Astrophysics in Three Dimensions (ASTRO3D)

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
We present the new ProFuse R package, a simultaneous spectral (ultraviolet to far infrared) and spatial structural decomposition
tool that produces physical models of galaxies and their components. This combines the functionality of the recently released
ProFound (for automatic source extraction), ProFit (for extended source proÔ¨Åling) and ProSpect (for stellar population
modelling) software packages. The key novelty of ProFuse is that it generates images using a self-consistent model for the
star formation and metallicity history of the bulge and disk separately, and uses target images across a range of wavelengths to
deÔ¨Åne the model likelihood and optimise our physical galaxy reconstruction. The Ô¨Årst part of the paper explores the ProFuse
approach in detail, and compares results to published structural and stellar population properties. The latter part of the paper
applies ProFuse to 6,664 ùëß < 0.06 GAMA galaxies. Using re-processed ùë¢ùëîùëüùëñZYJHKs imaging we extract structural and stellar
population properties for bulges and disks in parallel. As well as producing true stellar mass based mass‚Äìsize relationships,
we further extend this correlation to explore the third dimensions of age and gas phase metallicity. The disks in particular
demonstrate strong co-dependency between mass‚Äìsize‚Äìage in a well deÔ¨Åned plane, where at a given disk stellar mass younger
disks tend to be larger. These Ô¨Åndings are in broad agreement with work at higher redshift suggesting disks that formed earlier
are physically smaller.

Key words: galaxies: evolution ‚Äì methods: data analysis ‚Äì software: public release

1 INTRODUCTION

Given the future multi-band broad wavelength deep large surveys
on the horizon and the huge quantities of money and person power
being invested (Weinberg et al. 2013), it is a reasonable endeavour
to develop software that can maximally utilise this information for
scientiÔ¨Åc insight. Domains that have long made use of such data on
large scales, but have never been formally combined, are extended
source decomposition (e.g. Peng et al. 2002; de Souza et al. 2004;
Erwin 2015; Robotham et al. 2017) and multi-band spectral energy
distribution (SED) Ô¨Åtting (e.g. da Cunha et al. 2008; Noll et al. 2009;
Robotham et al. 2020). ProFuse, presented for the Ô¨Årst time here, is
our eÔ¨Äort to combine these domains to produce physical models of
galaxies.

In Robotham et al. (2017) we described the Ô¨Årst public version
of the galaxy structural decomposition software package ProFit.
The published version of ProFit was released with only single band
Ô¨Åtting as an option, where multi-band Ô¨Åts could be achieved using
cascading priors (Ô¨Åt the deepest band Ô¨Årst, then use that solution as
an initial condition and/or a prior for Ô¨Åtting adjacent bands). Since
then, general purpose multi-band Ô¨Åtting has been possible where
images could either be a single wavelength and the end goal was

‚òÖ E-mail: aaron.robotham@uwa.edu.au

¬© 2021 The Authors

a single (potentially multi-component) proÔ¨Åle to describe the data
(with diÔ¨Äerent world coordinate system and depth etc), or images
could represent diÔ¨Äerent wavelengths and smoothly varying model
parameters could be Ô¨Åtted to describe them. While these approaches
achieved reasonable results qualitatively, they have the obvious weak-
ness of not being constrained by physics- it is quite possible to create
erroneously rapid changes in e.g. bulge colours that could never be
created by modern spectral templates (e.g. Bruzual & Charlot 2003;
Eldridge & Stanway 2009) with a plausible star formation history.

Before developing an SED Ô¨Åtting tool that could be combined with
ProFit, the general purpose source extraction and analysis package
ProFound was created (Robotham et al. 2018). This aided the gener-
ation of suitable segmentation maps and initial conditions for running
ProFit in a fully automated manner. ProFound has since been used
more widely as a general purpose photometry tool across a range of
wavelengths, and serves as the main photometry tool for the legacy
Galaxy And Mass Assembly (GAMA; Driver et al. 2011; Liske et al.
2015; Bellstedt et al. 2020a) survey, ongoing Deep Extragalactic
VIsible Legacy Survey (DEVILS; Davies et al. 2018, 2021), and
the future Wide-Area VISTA Extragalactic Survey (WAVES; Driver
et al. 2019). In the case of GAMA, its functionality (compared to
the published version) has been expanded to include the point spread
function (PSF) Ô¨Åtting of unresolved mid-infrared (MIR) and far-
infrared (FIR) images, allowing us to produce high quality SEDs

 
 
 
 
 
 
2

A. S. G. Robotham et al.

over 20 bands of UV-FIR data (Bellstedt et al. 2020a). It has also
been applied to radio data (Hale et al. 2019), proving its versatility
across a vast range of wavelengths.

The quality (depth and resolution) and wavelength breadth of the
full imaging data available in the Ô¨Ånal data release of GAMA (Driver
et al. in press) and ongoing DEVILS surveys lends itself ideally to
SED Ô¨Åtting, and with this goal in mind (and the longer term aim
of producing physical galaxy decomposition) the Bayesian inference
software tool ProSpect was created (Robotham et al. 2020). This
allows highly Ô¨Çexible star and metallicity formation histories to be
extracted from broad band SEDs, and has been used to invert the
physical growth of galaxies for hundreds of thousands of GAMA and
DEVILS sources to date (Bellstedt et al. 2020b; Thorne et al. 2021,
respectively). The design and modularity of this code was written
with later integration into ProFit in mind. This aspect is important
since a lack of coherent structure would have required a complete
refactoring of one or both code bases, which would be a signiÔ¨Åcant
task.

In this work we make the Ô¨Årst recognised eÔ¨Äort in fully combining
the extended source decomposition and SED domains in a rigor-
ously self-consistent generative Bayesian framework, combining the
inference power of the software tools ProFit (galaxy decomposi-
tion) and ProSpect (SED generation and Ô¨Åtting) to produce the new
R software package ProFuse1. To further aid and automate its ap-
plication, ProFuse also utilises the source extraction and analysis
software ProFound to automatically deÔ¨Åne structural initial condi-
tions and to identify and parameterise stars to produce per band PSFs
on-the-Ô¨Çy.

Comparable but ultimately dis-similar eÔ¨Äorts to extract compo-
nent wise spectral properties exist in the literature. In terms of the
broadband moderately-resolved data it is designed for, there are clear
similarities with MegaMorph (H√§u√üler et al. 2013; Vulcani et al.
2014), which allows for smooth functional forms to link properties
across adjacent bands. Johnston et al. (2017) extends this capabil-
ity to use these outputs (which in eÔ¨Äect produce the relative bulge
and disk image contribution as a function of spatial position and
wavelength) to then Ô¨Åt SEDs in coarsely binned integral Ô¨Åeld spec-
trograph (IFS) spaxels using pPXF (Cappellari & Emsellem 2004),
which then allows spatial inference of the star formation and metallic-
ity history and other properties that can be extracted from such SEDs
but spatially separated into bulges and disks. This combination of
decoupled structural decomposition followed by stellar properties
being extracted from the resultant SEDs is common to other recent
IFS eÔ¨Äorts, with the major diÔ¨Äerences being whether the focus is
on bulge-disk kinematic separation or stellar formation history sep-
aration (Coccato et al. 2011; Scott et al. 2017; Tabor et al. 2017;
M√©ndez-Abreu et al. 2019; Oh et al. 2020; Costantin et al. 2021).

Predating IFS work, conceptually similar eÔ¨Äorts using long-
slit based spectroscopic techniques have also been carried out
(MacArthur et al. 2009; Johnston et al. 2012, 2014). Simple splits
between bulge dominated and disk dominated regions of galaxies
allowed some insight into their dis-similar star formation histories
and gas and/or stellar metallicities. Going back further, investiga-
tions into the stellar populations of bulges and disks used coarser
photometric data and comparisons to relatively simple evolutionary
models (e.g. M√∂llenhoÔ¨Ä 2004). A common feature of all the above
literature eÔ¨Äorts is that there is a distinct separation between the stel-
lar modelling and structural decomposition steps (although the order
and precedence of these steps varies by application). The nearest to

a ‚Äòfully‚Äô self consistent spectral decomposition model is arguably
Taranu et al. (2017), which creates a 3D equilibrium model and
projects these particles to compute likelihoods. However, little spec-
tral information is incorporated beyond the computed kinematics and
optical ùëî and ùëü images.

ProFuse diÔ¨Äers from the above approaches in that it is fully gen-
erative and Bayesian in terms of how it solves the problem of recon-
structing physical structures (but in this paper and initial software re-
lease, more speciÔ¨Åcally bulges and disks). All structural components
Ô¨Åtted are allowed to have their own unique star formation histories
and structural properties, and these are forward generated onto model
images that are directly compared to observed data to compute the
model constraining likelihoods. The huge advantage of this approach
is that physically implausible spectra for each component (which in
broadband data would mean extreme colours) are naturally penalised
in the Ô¨Åtting process. It also means that structural properties (e.g.
disk and bulge sizes) receive information from all bands available.
Combining these steps together therefore maximises the data avail-
able for modelling, minimises the number of free parameters to Ô¨Åt,
hugely speeds up the modelling process, and allows us to infer com-
plex relationships between the parameters via well explored posterior
samples (e.g. does disk size correlate with the stellar age of the disk?
etc).

Importantly, ProFuse also opens up more physical avenues to
structural model selection, e.g. is a given galaxy a true bulge-disk
system, or a single smooth proÔ¨Åle? It has proven to be extremely
diÔ¨Écult to select preferred models on purely Ô¨Çux based structural
analysis (Allen et al. 2006; Lange et al. 2016; Cook et al. 2019),
and better automating this process will become signiÔ¨Åcant for ever
larger surveys. The Ô¨Çexibility of coupling resolved structure directly
with the stars that form the components will pay dividends in the
near future of deep, well-resolved, multi-band facilities (e.g. James
Webb, Vera Rubin, Euclid, Nancy-Grace Roman; see Gardner et al.
2006; Iveziƒá et al. 2019; Amendola et al. 2013; Spergel et al. 2015,
respectively).

ProFuse is designed as a full image through to inference tool,
where all the routine aspects of source identiÔ¨Åcation, segmentation,
sky subtraction and point spread function modelling are handled
automatically (or if desired, provided in a more manual manner). To
aid adoption and comprehension, long form reproducible examples
are included with the software natively and online2.

In this paper we discuss the core methodology and implementation
of ProFuse (Section 2), explore a detailed application to a test galaxy
(Section 3), and apply it to the low redshift sample of 6,664 GAMA
galaxies that have already been analysed with ProSpect in Bellstedt
et al. (2020b) (Section 4). We Ô¨Ånally investigate the most interesting
results relating to the stellar and structural properties of these bulges
and disks (Section 5).

Where relevant we use the same concordance ŒõCDM Planck Col-
laboration et al. (2016) cosmology as used in Bellstedt et al. (2020b),
i.e. H0 = 67.8 (kms/s)/Mpc, Œ©ùëÄ = 0.308 and Œ©Œõ = 0.692. We
note for comparison purposes that all stellar properties discussed
are equivalent to being stellar mass weighted (as opposed to light
weighted).

1 https://github.com/asgr/ProFuse

2 https://rpubs.com/asgr

MNRAS 000, 1‚Äì25 (2021)

ProFuse: Physical Multi-Band Structural Decomposition

3

2 METHODS

To achieve the fusion of the ProFit and ProSpect software pack-
ages some limitations on source Ô¨Çexibility had to be made (at least
in this Ô¨Årst implementation). The pragmatic solution was to limit the
proÔ¨Åle options available on the ProFit side to either single S√©rsic or
double S√©rsic proÔ¨Åles (S√©rsic 1963; Graham & Driver 2005). In our
experience to date (roughly Ô¨Åve years of usage) these options rep-
resent nearly all popular use cases for Ô¨Åtting extended extra-galactic
sources- the additional proÔ¨Åles available rarely get used (the excep-
tion being the MoÔ¨Äat proÔ¨Åle for PSF Ô¨Åtting, usually to Ô¨Åt unresolved
sources). Beyond this proÔ¨Åle limitation there is a large amount of
Ô¨Çexibility in terms of how ProFuse can be used for inference, with
eÔ¨Äectively all the SED Ô¨Åtting power of ProSpect available to use
for the both the bulge and disk components (if two components are
desired). Naturally there is a ramp up in complexity of use as users
apply more sophisticated models, but as much as is possible Pro-
Fuse simpliÔ¨Åes the user interface and abstracts away much of the
complicated model building.

The over-arching conceptual Ô¨Çow of how ProFuse works is as

follows:

(i) The user provides a list of all target images, the redshift (ùëß), and
ùë• and ùë¶ image pixel location of the target source in each image and the
desired cutout size (default 600 √ó 600 pixels). Optionally the sky and
sky-RMS images can also be provided (if these are not provided, they
will be determined internally). A Ô¨Ålter name (over 300 exist within
ProSpect) or response table/function must be provided for each
target image. PSFs can also be optionally provided to accompany each
image. Currently, ProFuse only allows a single image to be provided
per band (where longer term the option to have multiple target images
in each band will be added) but within that limitation the diÔ¨Äerent
input images may have diÔ¨Äerent world coordinate system (scale,
size, translation and rotation) allowing native images to be provided
rather than a common projection scheme. This has the eÔ¨Äect of
minimising data volumes (since in practice you would need to project
to the smallest pixel scale image) and reducing pixel covariance
(unavoidable as you up-sample an image). Magnitude zero points (to
bring images into the AB system) must be provided, and per image
gain can also be optionally provided (in terms of the usual electrons
per ADU).

(ii) The user speciÔ¨Åes the type of model. On the ProFit side, local
and global options are allowed for 1 (single S√©rsic), 1.5 (disk + PSF
bulge), 2 (double S√©rsic with Ô¨Åxed or free bulge and/or disk), or 2.5
(triple S√©rsic with Ô¨Åxed or free bulge and/or thin/thick disk) proÔ¨Åles,
e.g. you maybe want to Ô¨Åt all images with a common S√©rsic proÔ¨Åle but
allow the size (ùëÖùëí) to vary per band (either smoothly or discretely).
On the ProSpect side all the usual options available in the normal
SED Ô¨Åtting mode are available, so completely separate models can
be speciÔ¨Åed for the bulge and disk. Table 1 gives an overview of
the highest level options available in ProFuse. More Ô¨Çexibility (e.g.
proÔ¨Åle types other than those listed here, but available in ProFit)
is available via manual editing of the Ô¨Åtting objects, but only expert
users should attempt this.

(iii) The user runs the resulting Ô¨Åtting object through an inference
engine of their choosing. For the tests outlined in this paper we make
use of the dual phase Highlander package developed for use with
ProFit and ProSpect (Thorne et al. 2021) (discussed in more detail
later).

Steps (i) and (ii) above are in practice a single (but lengthy) call
to a setup function in ProFuse. Internally this creates the complex
Ô¨Åtting objects for the user to later run inference on, and these objects

Figure 1. Example of the automatic PSF extraction and modelling that Pro-
Fuse carries out if no PSF is provided. The ùëü -band example here found the
four most similar bright PSFs (left panel) and Ô¨Åtted them simultaneously
with a global MoÔ¨Äat proÔ¨Åle (second panel). The 2D residuals (third panel)
and collapsed histogram (fourth panel) demonstrates the PSF model is highly
accurate in this case. Any analytic model available to ProFit can be used to
model the PSFs, including ellipticity and boxiness parameters if deemed nec-
essary. The results here are for example galaxy TGS426Z278 used in Section
3.

can be saved to aid later re-analysis (e.g. running the same model
with more sample chains etc). In principle these Ô¨Åtting objects can
be constructed entirely manually (allowing more granular control),
but this is a complex task and should in general be avoided. If Ô¨Åner
control is needed a better route is to run the setup routine as normal,
and then make changes to the Ô¨Åtting object returned.

Inside the setup function diÔ¨Äerent routines will run depending on
the data provided. In a minimal run of the user only providing the
images and basic Ô¨Åtting instructions the following happens internally:

(i) The images are cutout (by default 600√ó600 in size) and centred
on the target extended source. This means very large mosaics of data
can be provided as the input (pointers to on-disk images can be used),
with the minimal in-memory cutouts made internally.

(ii) ProFound is run on each image using settings that can be
provided by the user (otherwise it will use default parameters, which
in practice work well on a range of image data). This creates seg-
mentation maps per band, along with sky and sky-RMS images.
ProFound also generates reasonable initial starting points for the
model requested, but in practice the Highlander optimisation en-
gine suggested is designed to extract good solutions even from very
poor initial conditions.

(iii) If no PSF is provided in a particular band (users need not
supply a PSF for every band) then candidate stars are identiÔ¨Åed in
size magnitude space via identiÔ¨Åcation of the stellar locus3 (note
this only works well when there are a good number of stars (roughly
a dozen) on an image, if this is not possible then a PSF should be
provided manually). By default the four most PSF-like objects are
extracted and simultaneously Ô¨Åtted with a MoÔ¨Äat proÔ¨Åle using ProFit
and the Highlander inference engine. Figure 1 shows extracted and
modelled stars using the example data included with the software,
where we can see that the model is extremely good, with almost pure
noise residuals in the third and fourth panels.

(iv) An inverse variance weighted stack is made of all images.
(v) The stacked image is re-analysed with ProFound to make

3 This is done automatically by detecting the magnitude range where com-
pact sources dominate the number counts, and sigma clipping the sizes to
Ô¨Ånd the robust subset of PSF-like objects. Users can optionally specify the
magnitude range to use if the automatic detection does not work well, but in
our experience is this is very rarely necessary.

MNRAS 000, 1‚Äì25 (2021)

020406080100050100x/pixy/pixData020406080100x/pixModel020406080100x/pixData‚àíModel-3-2-10123c4

A. S. G. Robotham et al.

Model Type

N Comp

Single
Bulge-Disk
Bulge-Disk
Bulge-Disk-Disk

1
1.5
2
2.5

Bulge
Str.

S√©rsic
PSF
S√©rsic
S√©rsic

SED

Free
Free
Free
Free

Disk 1
Str.

.
S√©rsic
S√©rsic
S√©rsic

SED

.
Free
Free
Free

Disk 2
Str.

.
.
.
Coupled

SED

.
.
.
Free

Table 1. Overview of high level Ô¨Åtting Ô¨Çexibility. For the structural component (‚ÄòStr.‚Äô) the main options are for a free S√©rsic proÔ¨Åle, a PSF proÔ¨Åle, or a ‚Äòcoupled‚Äô
component where the second disk must follow the geometry (axial ratio and ellipticity) of the Ô¨Årst disk. For the ‚ÄòSED‚Äô component, all the options available to
ProSpect can be accessed when labelled ‚ÄòFree‚Äô.

the Ô¨Ånal segmentation map and to determine reasonable starting
conditions for ProFit for either 1, 1.5, 2 or 2.5 component proÔ¨Åles.
This also determines reasonable Ô¨Åtting limits for all relevant free
parameters automatically (something that had to be done by users
manually in the published version of ProFit). All images are now
cut down to the minimal rectangle that contains all identiÔ¨Åed object
pixels.

(vi) If the gain is not provided for all images, then using Poisson
statistics a reasonable approximate gain is determined for each re-
quired image using the sky pixels. The image, sky image, gain and
segmentation map is combined with the sky-RMS image to make a
Ô¨Ånal sigma image to be used for each image inside ProFit.

(vii) The data created or provided in the above step is passed into
the usual ProFit data setup function for each image, creating a meta
list of the diÔ¨Äerent data structures required per image.

(viii) Internal methods are determined to reshape a set of tar-
get parameters and generate the correct models for the ProFit and
ProSpect components of the multi-band model.

The output of the above is a fairly large Ô¨Åtting object (in terms
of components), since each target image will contain cutout versions
of the image, sky, sky-RMS, PSF, sigma and segmentation maps.
In general the actual in-memory object size is quite small since
everything is cut down to the minimum viable image size, e.g. the
example galaxy provided in the package vignette has 9 bands of
imaging and only takes on 40 MB in-memory. Given the ability
to automatically extract the PSF by extracting stars and Ô¨Åtting a
common MoÔ¨Äat proÔ¨Åle, even the setup stage can take a few minutes
for a common target of 9 bands of optical and near infrared (NIR)
data. If PSFs are provided then the setup should only take a few
seconds for anything but the largest target galaxies (the ProFound
stages are very fast in practice).

2.1 Parameter Priors

In the most automated mode of ProFuse priors cannot be provided
explicitly. This is largely because the user would need prior knowl-
edge of the source extraction and initial conditions to be able to
specify these in a meaningful manner. To combat this limitation
ProFuse was designed to have two modes of operation: in the Ô¨Årst
everything including the Ô¨Åtting is carried out in a single call; in the
second (as intimated above) an intermediate Ô¨Åtting object is made
that can be further edited (e.g. priors can be embedded), and Ô¨Åtting
can then be carried out.

In practice, adding priors for the ProSpect and ProFit compo-
nents of ProFuse requires some knowledge of both of those codes, so
the average user will probably not attempt such advanced execution.
In which case the priors are automatically generated as improper Uni-
form priors between limits of physicality and computation for both
ProFit and ProSpect (in logarithmic space for all scale parameters).

MNRAS 000, 1‚Äì25 (2021)

E.g. star formation rates and sizes are not allowed to be negative, and
the centre of the object has to exist within the bounds of the data.

Given people often apply a limit to the S√©rsic index (ùëõ), this
parameter uniquely in ProFuse has the option to deÔ¨Åne an upper
limit when Ô¨Åtting. The default is 5.3, oÔ¨Äering a ‚àº 30% margin above
the ùëõ = 4 de Vaucouleurs proÔ¨Åle index (de Vaucouleurs 1948). In
practice this should usually be set to higher values, e.g. the upper
limit of 8 used in Kelvin et al. (2012) and used later in this work for
our analysis of GAMA. Since poor sky subtraction can cause very
strong systematics in recovered S√©rsic index (Kelvin et al. 2012) we
use the lower default of value of 5.3 to reduce catastrophic failures.

2.2 Parameter Inference

Once this Ô¨Åtting object has been set up, users are able to carry out
parameter inference with an engine of their choice (there are many
hundreds available just within R) for as long as they deem necessary.
Optimal inference is a massive and unsolved problem in statistics
in itself, so this paper will not aim to provide a comprehensive dis-
cussion of the options available. Pragmatically we can suggest the
use of the Highlander package as oÔ¨Äering a good mixture of speed
and quality of Ô¨Åt (as discussed and used in Thorne et al. 2021).
Highlander works by alternating phases of ùëÅ-dimensional genetic
algorithm based optimisation (Covariance Matrix Adapting Evolu-
tionary Strategy; CMA-ES) followed by phases of Component-wise
Hit-And-Run Metropolis Markov Chain Monte Carlo (CHARM-
MCMC). This can be done as many times as desired, but the default
is two phases of each, with a Ô¨Ånal longer CHARM phase recom-
mended if posterior parameter exploration is desired. The default for
each phase is 1,000 iterations (where a single iteration means sam-
pling over all ùëÅ parameters, so this naturally scales with the number
of parameters being Ô¨Åtted).

In very complex Ô¨Åts using more components, we have found better
global solutions from increasing the number of total Ô¨Åtting phases
whilst also reducing the iterations per phase. This encourages a more
aggressive hyper-dimensional search for good solutions, where the
down side is less time is spent exploring the optimal solution region.
To combat this it is possible to separately specify the number of
posterior samples during the Ô¨Ånal CHARM exploration phase, where
this should usually be in the range of 1,000‚Äì10,000 for a well explored
posterior.

In all cases the likelihood being optimised by any inference engine
will be the sum of ProFit ùëëùëéùë°ùëé‚àíùëöùëúùëëùëíùëô log-likelihoods as outlined in
Robotham et al. (2017). The result of this is the model will naturally
attempt to better explain the pixel data with smaller uncertainty (usu-
ally corresponding to deeper images) but will be penalised for poorly
Ô¨Åtting any band present. Unresolved images (usually the MIR and
FIR) can (and ideally, should) also be provided, because whilst they
provide little constraint on any ProFit structural parameters, they
oÔ¨Äer useful information regarding the star formation history (partic-
ularly recent star formation in the case of the FIR) for ProSpect. We

ProFuse: Physical Multi-Band Structural Decomposition

5

discuss the incorporation of unresolved data in more detail in Section
2.4.

2.3 AGN Modelling

As well as allowing for the above 1, 1.5, 2, and 2.5 component
extended models using ProSpect to construct the stellar history of a
galaxy, it is possible to also generate an AGN component and spatially
associate it with the bulge component of the galaxy. Physically this
likely makes most sense when Ô¨Åtting a 1.5 component model (with
a PSF bulge) since you are already anticipating that the bulge will
be entirely unresolved in the regime where the AGN dominates the
light enough to make Ô¨Åtting for it viable (as will be the case for a
true AGN). A simple version of AGN Ô¨Åtting with ProSpect was
discussed in the original paper, but it has since been over-hauled to
oÔ¨Äer the full Ô¨Çexibility needed based on the models provided by Fritz
et al. (2006) as discussed in detail in Thorne et al. (2022).

2.4 Unresolved Data

Another aspect of ProFuse that should make it powerful in general
application is its natural ability to predictively assign unresolved
Ô¨Çux (often in the MIR and FIR) to the correct component given the
ProSpect model uncovered. E.g. in the case of extreme star formation
in the disk and an old red-and-dead stellar population representing the
bulge, it is clear that almost all of the unresolved FIR Ô¨Çux identiÔ¨Åed
in the image correctly belongs to the disk. This need not always be
the case though, ProFuse is able to equally identify situations where
we observe signiÔ¨Åcant recent star formation in the bulge (e.g. a star
burst event) and allocate an appropriate (non-zero) fraction of the
FIR Ô¨Çux to the bulge in this case. This is practically impossible to
do under the normal circumstances of running ProFit on each band
separately, since there would be no reasonable route to inform the
FIR priors in such a manner that both of the above scenarios are
allowed.

ProFuse further oÔ¨Äers a Ô¨Åtting mode where marginally- or un-
resolved data can be Ô¨Çagged as such (by setting the doprofit option
to FALSE), and the structural decomposition is not applied to that
band. Instead only the total Ô¨Çux within the speciÔ¨Åed (or automatically
detected) Ô¨Åtting region is used to compute a likelihood. This means
that the sum of the various components in these bands should ideally
match the integrated Ô¨Çux, with the usual penalty of the Ô¨Çux uncer-
tainty giving more or less weight to this tension. These additional
likelihood terms increase the computation time (given the addition of
extra ProSpect band passes to compute) and requires more interim
data storage for the Ô¨Åtting model. Since GAMA is somewhat unusual
in having access to 20 bands of UV-FIR data, we have focussed on
resolved Ô¨Åtting of the optical and NIR bands in the rest of this pa-
per since this will be more representative of the typical use case for
non-GAMA surveys in the future.

Figure 2. Example galaxy TGS426Z278. Top panel is the full 9-band ùë¢‚ÄìKs
inverse variance weighted stack; bottom panel is the RGB image mapped from
asinh scaled Hùëñùëî band images. The example was cut out large enough such
that at least 4 stars could be identiÔ¨Åed in all band ùë¢‚ÄìKs. The green region
shows the pixels selected for Ô¨Åtting based on the ProFound segmentation
image extracted from the 9-band stacked image (top panel).

3 APPLICATION TO AN EXAMPLE GALAXY

To aid users, a comprehensive example is provided with the package.
This makes use of pixel-matched 9-band (ùë¢ùëîùëüùëñZYJHKs) imaging
taken from the GAMA survey (Bellstedt et al. 2020a) that comes
included as part of the ProFound package. The example multi-band
data that comes with ProFound has a few extended sources available
to test Ô¨Åtting with ProFuse, but here we focus on one of the more
extended examples in the Ô¨Åeld as shown in Figure 2. The example
galaxy (unique name TGS426Z278) has been targeted by 2dFGRS

(Colless et al. 2001) and has a redshift ùëß = 0.0447. Visually it is
clearly a spiral galaxy, with some evidence of a redder central region
(visually white in the image due to the scaling) which suggests it
might be reasonable to Ô¨Åt a bulge and disk model.

Running the 9-band automatic setup takes about two minutes,
which includes identifying, extracting and Ô¨Åtting the PSFs in all
bands. With the Ô¨Åtting object assembled, we use Highlander to
Ô¨Åt a simple circular de Vaucouleurs proÔ¨Åle (de Vaucouleurs 1948)
(analogous to a S√©rsic index ùëõ = 4 proÔ¨Åle) bulge and exponential

MNRAS 000, 1‚Äì25 (2021)

6

A. S. G. Robotham et al.

Figure 3. Best-Ô¨Åtting SFHs for the bulge and disk using ProFuse on example
galaxy TGS426Z278 (as seen in Figure 2) using 9-bands of imaging data.

(analogous to a S√©rsic index ùëõ = 1) elliptical disk model with a
skewed Normal star formation history (SFH) and linearly mapped
metallicity history (ZH) with free Ô¨Ånal ùëç (see Robotham et al. 2020,
for details of the SFH and ZH implementation). For convenience, the
skewed Normal SFH used has the form:

ùëÜùêπ ùëÖ(age) = ùëöSFR

ùëíùëã (age) 2
2

ùëã (age) =

(cid:18) (cid:20) age ‚àí ùëöpeak
ùëöperiod

,

(cid:21)

(cid:19)asinh

(cid:18) age‚àíùëöpeak
ùëöperiod

(cid:19)

ùëíùëöskew

(1)

,

(2)

where ùëöSFR is the peak star formation rate, ùëöpeak is the age of the
peak in star formation, ùëöperiod is the standard deviation of the star
formation period, and ùëöskew is the skew of the Normal (where 0 is
perfectly Normal, +ve is skewed to younger ages and -ve is skewed
to older ages). The linear ZH model used forms metals in linear
proportion to the fraction of stars formed, e.g. when half the stars in
a given galaxy have been formed the metallicity will, by construction,
be half that of the free Ô¨Ånal ùëç.

This is probably the simplest plausible bulge-disk system that
can be Ô¨Åtted to such data, and the resultant model (with all initial
parameters determined automatically) requires 16 free parameters.

We use Highlander for parameter inference with two phases of
CMA and CHARM with 1,000 iterations during each phase (where
an ‚Äòiteration‚Äô means a sequential modiÔ¨Åcation of all parameters, so
this naturally scales with model complexity). The example requires
roughly one hour of CPU time to achieve a reasonable solution across
all 9 images on a single modern laptop core. This is slower than
running ProFit separately on a single image (which might take 10‚Äì
20 minutes with similar Highlander settings), but since the number
of parameters is eÔ¨Äectively less and we Ô¨Åt all 9-bands simultaneously
with a ProFuse model the total time is 2‚Äì4 times less. This is ignoring
the ProSpect side, which on its own typically takes 10 minutes for
a single version of the SFH and ZH model (which we are Ô¨Åtting
separately for the bulge and disk in ProFuse).

The end result is a physical model with SFHs, ZHs, stellar masses
and star formation rates (and all other ProSpect properties) for the
bulge and disk that runs factors faster than the laborious approach
of attempting to Ô¨Åt all bands separately with ProFit and then using
ProSpect to Ô¨Åt the resultant bulge and disk properties. The latter
approach is also prone to catastrophic failure unless some artiÔ¨Åcial

MNRAS 000, 1‚Äì25 (2021)

Figure 4. Example Data-Model results for 3 bands (giH) of the 9 bands used
to constrain the target model of example galaxy TGS426Z278 (as seen in
Figure 2). In each row of panels we see the imaging data (left panel), model
(second panel), spatial residual (third panel) and error normalised histogram
(right panel). These are very similar to the standard analysis Ô¨Ågures generated
by ProFit and presented in Robotham et al. (2017). The desired outcome in
all cases is for the third panel (the residual ‚ÄòData - Model‚Äô) to be close to
yellow, with no dramatic over subtraction (blue) or under subtraction (red)
by our model. Unsurprisingly, given the smoothness of the model, the spiral
arms tend to remain red in the bluer ùë¢ and ùëñ bands, but there is little spiral
structure in the H band and residuals are close to featureless.

(and unphysical) coupling between bands it attempted (H√§u√üler et al.
2013; Vulcani et al. 2014).

The result of the Ô¨Åt is a full SFH for both components, as seen
in Figure 3. The model also produces per-band predictions of the
bulge and disk model, where we show data and model residuals for
the ùëî, ùëñ and H bands in Figure 4. As should be expected given the
elliptical smoothness of the model, we have stronger residuals in the
bluer bands where strong spiral arm features are present, and little
structural residual in the NIR. The third useful output that can be
assembled is the observed SED for the separated bulge and disk in
Figure 5. The clear interpretation here is that the disk is signiÔ¨Åcantly
brighter than the bulge at all wavelengths (brighter luminosities in
this Figure) and the bulge is redder in colour (steeper drop oÔ¨Ä in
luminosity for bluer wavelengths). The end result of this is we have
extracted a classical bulge and exponential disk galaxy. A simple
reconstruction of the per pixel bulge-to-disk mass ratio is shown in
Figure 6, revealing a particularly compact bulge.

A natural consequence of using ProFuse is we get all
the
component-wise properties from ProSpect automatically, e.g. we
recover a total stellar mass formed (assuming a Chabrier Initial Mass

05x1091x101001234Age (Yr)SFR (Msol / Yr)BulgeDisk050100150050100150x/pixy/pixData050100150x/pixModel050100150x/pixData‚àíModel‚àí6‚àí4‚àí20246œág050100150050100150x/pixy/pixData050100150x/pixModel050100150x/pixData‚àíModel‚àí4‚àí20246œái050100150050100150x/pixy/pixData050100150x/pixModel050100150x/pixData‚àíModel‚àí4‚àí202œáHProFuse: Physical Multi-Band Structural Decomposition

7

Bulge SED:

Disk SED:

Figure 5. Extracted bulge (top panels) and disk (bottom panels) SEDs from
ProFuse for the example galaxy TGS426Z278. Within the grid of panels
the top shows the ProSpect intrinsic luminosity spectrum (pure light blue
dashed, attenuated in dark green, re-emitted by dust in brown, Ô¨Ånal observable
in black). The lower panels show the star formation and metallicity enrichment
histories (SFH left axis, ZH right axis). In this case the AGN component was
marginalised out.

Function (Chabrier 2003), as used in ProSpect) of 1.2 √ó 1010M(cid:12)for
the disk and 6.9 √ó 109M(cid:12)for the bulge, i.e. a disk that is 1.7 times
more massive than the bulge. The total stellar mass formed by the
bulge and disk is therefore 1.9 √ó 1010M(cid:12), i.e. this is a very typical
slightly sub-ùëÄ‚àó galaxy. In comparison the light models generated
vary between the disk being a factor 25 times brighter (ùë¢ band) and

Figure 6. The model predicted intrinsic total mass formed ùêµ/ùëá ratio per
pixel (without PSF convolution). The mass in the disk dominates almost ev-
erywhere, but as should be expected the bulge contribution increases towards
the centre.

2.9 times brighter (Ks band), reÔ¨Çecting the signiÔ¨Åcantly more ancient
star formation history of the bulge and the subsequent dimming of
its stellar populations over time. We see a much bigger diÔ¨Äerence in
the current star formation rates, deÔ¨Åned in ProSpect as the average
SFR over the last 100 Myrs. These are 1.35 M(cid:12)/yr for the disk, and
statistically 0 M(cid:12)/yr for the bulge, i.e. 100% of the current star for-
mation is occurring in the disk (not the 96% that would be implied
from pure ùë¢ band Ô¨Çux scaling).

Spatially we also have access to the normal outputs of ProFit
(depending on which Ô¨Åtting options were selected). In this case the
main spatial parameters of interest are the bulge and disk ùëÖùëí, which
are 2.2‚Äô and 10.9‚Äù respectively. Given the redshift of the example
galaxy (ùëß = 0.0447) this corresponds to 2.0 kpc (bulge) and 9.8 kpc
(disk), which is reasonable for a slightly sub-ùëÄ‚àó galaxy.

The interpretative possibilities from the full ProFuse Ô¨Åts are ex-
tremely rich, the above only touching upon some of the simpler
analyses that can be extracted. A caveat to these Ô¨Åts, and results in
following sections, is that we are assuming a particular model for
the SFH and ZH (and also a certain IMF and dust template etc), and
other models (e.g. closed box metallicity evolution) might individu-
ally produce equally reasonable results. However, this combination
of models have been shown to reproduce the cosmic star formation
history of the Universe (Bellstedt et al. 2020b; Thorne et al. 2021),
the variation of evolution observed in simulated semi-analytic galax-
ies (Robotham 2020), and even the evolution of the mass metallicity
relationship (Bellstedt et al. 2021). Investigating the full impact of
relaxing these assumptions is beyond the scope of this initial work,
but we have at least demonstrated it is a meaningful foundation to
build from.

4 APPLICATION TO THE LOW-REDSHIFT GAMA

SAMPLE

ProFuse was designed with the upcoming era of rich multi-
wavelength surveys in mind. Like the foundational SED code
ProSpect used to generate the light output, ProFuse works best
when we have access to a broad wavelength range since this can
constrain the SFH and ZH of the bulge and disk components. It
is also important that the galaxies in question are reasonably well-
resolved, where the expected ùëÖùëí of the components are certainly

MNRAS 000, 1‚Äì25 (2021)

103104105106107102103104105106Wavelength (Ang)Luminosity Density (Lsol/Ang)Total LumStar Un‚àíAttenStars AttenDust EmitAGN024681012024Age (Gyr)SFR (Msol/Yr)00.010.020.03SFRZ103104105106107103104105106107Wavelength (Ang)Luminosity Density (Lsol/Ang)Total LumStar Un‚àíAttenStars AttenDust EmitAGN02468101200.51Age (Gyr)SFR (Msol/Yr)00.0020.004SFRZ050100150020406080100x / pixy / pix00.51B/T8

A. S. G. Robotham et al.

Figure 7. A schematic view of how the presence of separated SFHs in bulge
and disk (two in this case) can produce quite complex colour gradients. Spec-
tral structural decomposition (SSD) with ProFuse oÔ¨Äers a route to untangle
such complex observations. The caveat to applying such a complex model is
that the data needs to be deep enough and resolved enough to justify it.

no smaller than the average PSF across all bands. At low redshift
the ideal data set to test ProFuse on is therefore the GAMA sur-
vey since it oÔ¨Äers well-resolved and reasonably deep imaging data
covering the ùë¢‚ÄìKs bands (Driver et al. 2016). It also has shallower
less well-resolved data that covers the UV (GALEX; Morrissey et al.
2007), MIR (WISE; Wright et al. 2010) and FIR (Herschel; Pilbratt
et al. 2010), but very few objects are both detected and resolved in
GAMA in these wavelengths so we have dropped them from this
proof-of-concept analysis. As above, we use Highlander to carry
out our inference, where we increased the number of iterations to
1,000 (CMA) and 1,000 (CHARM) run twice back-to-back (where
again an iteration in this context means all available parameters are
modiÔ¨Åed once).

The ideal sample to test ProFuse with has already been well jus-
tiÔ¨Åed and studied in previous GAMA papers: the ùëß < 0.06 sample
that has proved itself well suited to single band bulge-disk decompo-
sition Lange et al. (2016), and also ProSpect SED Ô¨Åtting Bellstedt
et al. (2020b). This sample contains 6,664 galaxies with complete

MNRAS 000, 1‚Äì25 (2021)

coverage in the optical ùë¢ùëîùëüùëñ (VST/KiDS; Shanks et al. 2015; Kuƒ≥ken
et al. 2019) and NIR ZYJHKs (VISTA/VIKING; Edge et al. 2013)
bands. In this initial work we will explore the three simplest models
that are likely to explain our data in a reasonable manner: a single
component elliptical free S√©rsic index model [FS from here]; the
same bulge-disk model as discussed in Section 3 (with the same lim-
itations on proÔ¨Åle and geometry) [BD from here]; and a bulge disk
model where the bulge is limited to be just a PSF [PD from here]. We
expect one of the two bulge-disk models (BD or PD) to work better
for galaxies that have a canonical classical bulge and star forming
disk, and the FS model to work better for early-type galaxies with
a more homogenous stellar population but non-circular geometry.
For all three models we achieved a better than 99% Ô¨Åtting success
rate (i.e. less than 1% of galaxies were missing one or more models),
which is exceptionally high compared to published automated galaxy
proÔ¨Åling work (Kelvin et al. 2012; Cook et al. 2019). Much of this
success is due to the presence of multiple bands compensating for
data quality issues that often just aÔ¨Äect a single image.

We also processed all of this low redshift GAMA sample using the
three component bulge and double disk mode [BDD from here]. For
this run the interest was whether we needed this added complexity
due to regularly Ô¨Ånding strong colour gradients along the GAMA
galaxy disks as found in other work (e.g. MacArthur et al. 2004;
M√∂llenhoÔ¨Ä et al. 2006; Bakos et al. 2008). In principle linear or
complex colour gradients can be formed in BDD mode since both the
disk components have entirely decoupled SFHs and ZHs. A simple
cartoon of this paradigm is shown in Figure 7.

Whether these disk components can be thought of as physically
separate is debatable of course, since a kinematically simple disk
might possess colour gradients due to its formation history, as can
kinematically distinct thick and thin disks. In practice, with our
GAMA quality data, very few galaxies require the additional com-
plexity of BDD versus BD, and the double disks serve to degenerately
recreate the properties of the single disk in the BD mode. Some global
comparisons are made to demonstrate this fact in Appendix A, but
we will ignore the BDD mode for the main analysis in this paper
since the simpler BD mode mimics its general behaviour.

For the ProSpect component of our ProFuse GAMA modelling,
we closely followed the approaches of Bellstedt et al. (2020b) and
Thorne et al. (2021). To better compare to this previous work we
use the optional Bruzual & Charlot (2003) stellar template library in
ProSpect, which implicitly assumes a Chabrier (2003) initial mass
function. Each of our components is allowed to have a skewed Normal
SFH and linearly mapped metallicity evolution with free Ô¨Ånal ùëç. We
set the initial Charlot & Fall (2000) dust parameters to ùúèscreen = 0.16
and ùúèbirth = 0.63 for our components, which is informed by the
distribution modes recovered in Thorne et al. (2021).

For all 6,664 GAMA galaxies we generate a range of outputs
and diagnostics. Highlander outputs include the last iterations of
the CMA-ES and CHARM MCMC (including all 1,000 posterior
chains). Using these outputs we can reconstruct the SFH and ZH
with uncertainties from the chains, and compute total photometry to
compare to GAMA including UV/MIR/FIR bands that are available
in GAMA but not used as part of the ProFuse process due to the
lack of spatial information present.

Figure 8 is an example of the kind of summary plot that we have
generated for every galaxy for the three main modes explored in
detail below (FS/BD/PD). This example is the BD output for GAMA
7688, a moderately well-resolved source approximately at the 50ùë° ‚Ñé
percentile of our sample in terms of the intrinsic ùëÖùëí of our FS model.
Here we see a classic old red bulge and young blue disk formation
scenario, where we have signiÔ¨Åcant stellar mass in both the bulge and

Galaxy image (Hig - RGB)Bluer bands (<1 Gyr)Greener bands (1-5 Gyr)Redder bands (>5 Gyr)ProFuse ModelExtended DiscCompact DiscBulgeStar FormationLook-back TimeRadiusStellar Mass DensityObservationsPhysical PropertiesClear colour gradient in disk dominated regimeProFuse: Physical Multi-Band Structural Decomposition

9

Figure 8. Full set of visual diagnostics for GAMA 7688 (an example of a moderately resolved object, approximately at the 50ùë° ‚Ñé percentile of our sample). Top
panels show the 9-band data, model and residuals. The second panel from top is the SED output of the bulge/disk/total model compared to the 20 band GAMA
data including the implied spectral bulge-to-total Ô¨Çux ratio (where we can see the predicted ProFuse model recreates the unseen UV/MIR/FIR data very well).
The fourth panel from the top shows the SFH of the bulge/disk/total. The bottom panel shows the ZH for the bulge/disk/total. This particular galaxy prefers a
small old metal rich bulge and a younger more metal poor disk. In all panels light coloured lines are random posterior samples showing the spread in uncertainty
in the model convergence. This means, for instance, that we constrain the SFH and ZH of the disk remarkably well, but the bulge has a large variety of ancient
SFH allowed (since 10-12 Gyr stellar populations are extremely similar in SED appearance). Also, the bulge ZH shows a similarly large spread, reÔ¨Çecting the
classic degeneracy between age and metallicity.

MNRAS 000, 1‚Äì25 (2021)

ImageugriZYJHKsModelResidual103104105106ŒΩfŒΩ[Wm‚àí2]BulgeSEDDiskSEDTotalSEDBulgePhotometryDiskPhotometryTotalPhotometryProFoundphotometry103104105106107Wavelength[Ang]10‚àí210‚àí1100B/T0.00.20.40.6SFR[M(cid:12)yr‚àí1]024681012LookbackTime[Gyr]0.000.020.04Z10

A. S. G. Robotham et al.

Figure 9. Comparison of FS, BD and PD ProFuse reduced Chi-Squared
(ùúí2/ùúà). In general multiple models can often do a similarly reasonable job
of Ô¨Åtting the data, but the Ô¨Çexibility of the BD model is clearly better for
a certain subset of galaxies (presumably those comprised of true extended
bulges and disks).

disk components (ùêµ/ùëá ‚àº 0.3). For reference Appendix B presents
examples of a marginally- and well-resolved GAMA galaxy in the
same plot summary format. In general ProFuse returns successfully
converged model solutions across a broad range of resolutions.

4.1 High Level Run Comparisons

Two obvious quantities of interest when deciding what mode to run in
is how often the Ô¨Åt is preferred and how long the Ô¨Åtting process takes.
There are many ways to specify the Ô¨Åt preference when carrying out
model selection, and in general this is considered to be an unsolved
problem in Bayesian analysis. For simplicity we just compare the
reduced Chi-Squared (ùúí2/ùúà) for the various runs on the same objects,
where in general values close to 1 will represent better Ô¨Åts (much
below 1 tends to indicate over-Ô¨Åtting, and much above 1 under-Ô¨Åtting).
Figure 9 presents the comparison of ùúí2/ùúà for the FS, BD and PD
runs. FS and BD models are of particular interest since they are at the
opposite extremes in terms of Ô¨Åt complexity (BD being technically
more complex with 16 parameters compared to 13 for FS). In general
the Ô¨Åtting is highly correlated, i.e. if we are able to achieve a good
BD Ô¨Åt then we can usually also Ô¨Ånd a reasonable FS Ô¨Åt. However, the
outliers to this statement tend to favour BD Ô¨Åts, hence the large cloud
of Ô¨Åts in the bottom-right of the Figure. Given the added Ô¨Çexibility
available to the BD model, this outcome is expected. It is notable
that the PD models have bigger extremes of poor Ô¨Åts. This appears to
be due to FS models being able to reasonably represent true bulge-
disk systems (but not as well as the BD model), and BD models can
approximately describe the light proÔ¨Åle of an elliptical galaxy (but
not as well as the FS model). PD models however cannot properly
capture elliptical galaxies in particular, causing a wing of poorer Ô¨Åts.
The added Ô¨Çexibility of the BD model does come with a signiÔ¨Åcant
penalty in terms of computation cost. Figure 10 compares the Ô¨Åtting

MNRAS 000, 1‚Äì25 (2021)

Figure 10. Comparison of FS, BD and PD ProFuse Ô¨Åtting time.

computation time in hours for both types of Ô¨Åts, where FS Ô¨Åts average
near to 2.5 hours per Ô¨Åt, whilst BD Ô¨Åts are closer to 3.5 hours with
more extreme outliers in general. In this case both runs were using
the same number of iterations in total. For a given image with a
Ô¨Åxed number of pixels to be modelled we expect the BD Ô¨Åt to take
about 70% longer to Ô¨Åt on average (taking the mean diÔ¨Äerence, 40%
taking the median diÔ¨Äerence). The extended Ô¨Åtting time is longer
than the 20% addition you would expect simply due to the increased
complexity of the model (moving from 13 to 16 parameters). This is
because the lower level ProFit software has to generate two galaxy
images in the BD mode, but only one for FS. This process is not
twice as long however, since there is no additional overhead in empty
image creation (which can be a signiÔ¨Åcant portion of creation time
for some models) and the free S√©rsic Ô¨Åtting available to the FS model
will sometimes create computational expensive proÔ¨Åles (generally
those with higher S√©rsic indices). The latter is why some of the Ô¨Åts
can very occasionally take longer for the FS model. The bimodality
present in the top panel of Figure 10 is due to compact bulges that
are PSF-like being evaluated rapidly, whilst more extended sources
take longer to evaluate. PD sit between FS and BS models in terms of
typical Ô¨Åtting time, which is consistent with their relative complexity.

4.2 Comparison Between ProSpect and ProFuse

We already have SED Ô¨Åtting based SFH and ZH results from
ProSpect for previous runs using the ProFound extracted 20-band
GAMA photometry (Driver et al. 2016; Bellstedt et al. 2020a, 2021).
This serves as a useful comparison data set for our new ProFuse anal-
ysis of the same low redshift galaxies. The FS model in particular
should be very similar since it was run with the same free ProSpect
parameters and only a single SED component. We should not expect
the results to be identical since the ProFound photometry used for
the earlier ProSpect analysis was not restricted by geometry, instead
ProFound uses summed Ô¨Çux within matched apertures that attempt
to approximate total photometry via curve of growth convergence

0.512510c2n (BD)1101001000count0.5125100.512510c2n (FS)c2n (PD)12510Time/Hr (BD)110100count1251012510Time/Hr (FS)Time/Hr (PD)ProFuse: Physical Multi-Band Structural Decomposition

11

Figure 11. Comparison of ProSpect and FS ProFuse stellar mass formed
as a function of ProSpect stellar mass. Colouring is by S√©rsic index, where
black represents disk-like proÔ¨Åles and yellow spheroidal-like proÔ¨Åles.

Figure 12. Comparison of ProSpect and FS ProFuse SFR as a function of
ProSpect stellar mass. Colouring is by S√©rsic index, where black represents
disk-like proÔ¨Åles and yellow spheroidal-like proÔ¨Åles.

in resolved bands and PSF photometry otherwise. The other major
diÔ¨Äerence is for ProFuse we are only using 9-band optical-NIR data
(at least in this initial work), whilst ProSpect used the full UV-FIR
available to GAMA.

One of the more fundamental properties returned from SED Ô¨Åtting
is the stellar mass (either formed or remaining). Figure 11 demon-
strates the similarity of the formed stellar mass between ProSpect
and the FS ProFuse model. They are consistent at the 0.1 dex level
over the whole sample analysed here, with the FS ProFuse model
tending to Ô¨Ånd more formed stellar mass on average. Given ProFuse
is able to integrate its light proÔ¨Åles to arbitrarily large radii (inÔ¨Ånity
by default) it should be expected that more mass can be found. On
average such proÔ¨Åles are able to capture more Ô¨Çux beyond the limited
apertures extracted with ProFound, and this is reÔ¨Çected in the bias
we see here for lower stellar masses and is consistent with the pre-
dicted Ô¨Çux diÔ¨Äerence computed in the Ks band (which is a reasonable
single band tracer of stellar mass Robotham et al. 2020). There is no
strong trend with S√©rsic index ùëõ though (shown in colour here), which
suggests we are not suÔ¨Äering run-away integration issues for large ùëõ
(Kelvin et al. 2012). We note that much larger discrepancies than this
can be generated when switching between stellar population models
(e.g. Bruzual & Charlot 2003; Eldridge & Stanway 2009) using the
same SFH and ZH (see Thorne et al in prep.).

Two other key outputs of interest from ProSpect (and therefore
also available in ProFuse) are the recent SFR (the star formation rate
over the last 100 Myrs) and the Ô¨Ånal gas phase metallicity (ùëçÔ¨Ånal).
Figure 12 presents the comparison of star formation rates, whilst
Figure 13 presents the comparison of Ô¨Ånal gas phase metallicities.

The star formation rate displays more bias and dependence on
the stellar mass than the stellar mass diÔ¨Äerences presented above.
Given the ProFuse model does not use the UV and MIR/FIR as
observational constraints this is not entirely surprising- without these
data the recent star formation history has much more Ô¨Çexibility. The
spread of the data noticeably increases for the most massive galaxies
which are also the ones that have relatively little star formation (on
average) hence small diÔ¨Äerences between ProSpect and ProFuse
becoming relatively large in this regime.

The ùëçÔ¨Ånal metallicity shows the least consistency between
ProSpect and ProFuse, but given the diÔ¨Écultly in inferring gas
phase metallicity from broad band data the agreement is subjectively
reasonable.

Figure 13. Comparison of ProSpect and FS ProFuse Ô¨Ånal gas phase metal-
licity (ùëçÔ¨Ånal). The density of points is reÔ¨Çected by the Viridis colour scale
shown.

4.3 Comparison Between ProFuse Models

With the three diÔ¨Äerent ProFuse models we naturally expect to
see diÔ¨Äerences in the inferred parameters, but in general we should
hope we Ô¨Ånd consistency in the physical parameters we extract and
compute. Two of the most fundamental parameters we extract from
the ProSpect side of ProFuse are the stellar mass and star formation
rate. Figure 14 demonstrates the consistency we see in the inferred
stellar mass formed as a function of the ProSpect stellar mass formed
(so this is consistent for each panel), and Figure 15 demonstrates the
SFR agreement for the diÔ¨Äerent models.

In general the stellar mass formed agrees well (consistent with the
above results comparing the FS model to ProSpect). The main trend

MNRAS 000, 1‚Äì25 (2021)

108109101010110.512ProSpect Stellar Mass / MsolProSpect/FS Stellar Mass0.511.52Med n108109101010110.1110ProSpect Stellar Mass / MsolProSpect/FS SFR0.511.52Med n10-310-210-310-2Z Final (ProSpect)Z Final (FS)110100count12

A. S. G. Robotham et al.

Figure 14. Comparison of stellar masses for our FS, BD and PD models
compared as a function of the ProSpect stellar mass recovered in Bellstedt
et al. (2020b).

Figure 15. Comparison of star formation rates for our FS, BD and PD models
compared as a function of the ProSpect stellar mass recovered in Bellstedt
et al. (2020b).

we see is that the BD model recovers more stellar mass for lower
stellar mass galaxies, and less for more massive galaxies. The PD
model recovers the least stellar mass, which should not be surprising
given the strong geometric constraints imposed by the model (a purely
PSF bulge and exponential disk). We see larger dispersion with the
SFR results and more complex behaviour. Whilst the FS model has
larger outliers in SFR compared to the PD/BD models, the latter
tend to systematically Ô¨Ånd larger star formation rates thanks to the
separate disk model.

It is a bit more complex to directly compare the gas-phase metal-
licity of a two component system to a single component one since
we have to make some assumptions about the gas enrichment model,
but a reasonable approximation can be achieved as follows. For any
system the gas-phase metallicity can be deÔ¨Åned as mass in metals
divided by the mass in gas

ùëçgas =

ùëÄmetal
ùëÄgas

,

where for the linear metallicity mapping used in ProSpect we will
form a constant amount of metals per unit stellar mass formed (this
is implicit in the model). This means

ùëÄmetal = ùõºùëÄstar

where ùõº is an arbitrary scaling of the stars formed into metals (the
actual value of this will not matter, as we see in later working). It is
therefore clear that

ùëÄgas =

ùõºùëÄstar
ùëçgas

.

When summing components to Ô¨Ånd the average gas-phase metal-

licity we compute

MNRAS 000, 1‚Äì25 (2021)

¬Øùëçgas =

=

ùëÄmetal1 + ùëÄmetal2
ùëÄgas1 + ùëÄgas2
ùõºùëÄstar1 + ùõºùëÄstar1
ùõºùëÄstar2
ùõºùëÄstar1
ùëçgas2
ùëçgas1

+

.

The ùõº divides out, leading us to

¬Øùëçgas =

ùëÄstar1 + ùëÄstar1
ùëÄstar2
ùëÄstar1
ùëçgas2
ùëçgas1

+

.

ùëÄstar and ùëçgas are naturally computed by ProSpect, making a
global ¬Øùëçgas derivable for our two component BD and PD ProFuse
models. Figure 16 shows the agreement between ùëçÔ¨Ånal for the three
ProFuse models, where ùëçÔ¨Ånal is simply ùëçgas at the epoch of observa-
tions. Given the diÔ¨Éculty in computing ùëçÔ¨Ånal the level of agreement
is encouraging. The BD model appears to show the most disagree-
ment compared to the FS model

4.4 Selecting the Best Model

Model selection is a complex problem, and is formally speaking
unsolved except in the most trivial cases in Bayesian analysis. The
reasoning is simple: except in the regime where one of your models
is the correct interpretation of reality, classic goodness-of-Ô¨Åt metrics
cannot be blindly used to select preferred models. Since almost all
astronomy models are in detail ‚Äòwrong‚Äô (which is not to say they are
not useful) this means in practical terms human insight is usually
required to deÔ¨Åne preferred models (e.g. Allen et al. 2006; Cook
et al. 2019).

It is still instructive to compare some traditional goodness-of-Ô¨Åts
metrics to investigate the similarity in Ô¨Åtting quality we tend to Ô¨Ånd

0.1110FS/BD Stellar Mass110100count1071081091010101110120.1110ProSpect Stellar Mass / MsolFS/PD Stellar Mass0.1110FS/BD SFR110100count1071081091010101110120.1110ProSpect Stellar Mass / MsolFS/PD SFRProFuse: Physical Multi-Band Structural Decomposition

13

Figure 16. Comparison of metallicity for our FS, BD and PD models.

Figure 17. Comparison of the Deviance Information Criterion (DIC) for our
FS, BD and PD models.

with ProFuse. Figures 9 and 17 show the reduced ùúí2 (ùúí2/ùúà, where
ùúà is the degrees-of-freedom) and the Deviance Information Criteria
(DIC, the log-likelihood of the Ô¨Åt modiÔ¨Åed by the eÔ¨Äective degrees-
of-freedom) respectively. In both of these Ô¨Ågures the lower value
is generally considered to be the preferred one, with the caveat we
should not prefer ùúí2/ùúà much less than 1 since this would imply over-
Ô¨Åtting of the data. The heaviest concentration of ùúí2/ùúà is seen at 1
for all three models, with the longer tail stretching to larger values
that implies under-Ô¨Åtting (i.e. the model needs to be more complex
to achieve a reasonable Ô¨Åt to the data). The ùëß scaling is logarithmic,
so the vast majority of all 3 models are clustered near 1 (as can be
seen in the PDF projections surrounding the main panels), which is
interesting since it suggests there are many situations where all 3
models (despite being quite dissimilar in design) do a reasonable job
of representing the data.

In general we see a marginal preference on average for the BD
model followed by the FS and lastly the PD. This broadly follows
the known Ô¨Çexibility of the model, but given the DIC in particular
penalises the model complexity it suggests the BD model often oÔ¨Äers
a notable improvement in the Ô¨Åtting even accounting for the increased
Ô¨Çexibility.

To determine the preferred model for a particular galaxy we use
a combination of the above Ô¨Åtting preferences using the DIC for the
diÔ¨Äerent components in combination with the removal of models
with extremely faint bulges (where they provide less than 1% of the
stellar mass) or stellar mass dominant bulges (more than 50% of
the stellar mass). On this GAMA sample we Ô¨Ånd 68.3% of galaxies
prefer a FS model, 15.3% BD and 16.4% PD.

Figure 18 shows the fractions for the models, with the FS model
split further by S√©rsic index (where ùëõ < 1.5 is interpreted as a pure
disk and ùëõ > 1.5 is a form of spheroidal or elliptical proÔ¨Åle, as per
Trujillo et al. 2006). As might be expected, the pure disk fraction
drops steadily with stellar mass and galaxies requiring bulge-disk
models peaks at around ùëÄ‚àó. In comparison, spheroidal-like galaxies
become more common for more massive galaxies, representing ‚àº

Figure 18. Comparison of model selection preferences as a function of stellar
mass. Pure disks dominate for lower stellar mass galaxies, and pure spheroid
galaxies (ellipticals) dominate at the massive end.

30% of galaxies at 1011M(cid:12). Note adjusting the pure disk ùëõ < 1.5
threshold does adjust these fractions, but the distribution is quite
smooth and the general trends seen in Figure 18 are preserved.

4.4.1 Comparison to Previous GAMA Structural Fits

GAMA has produced a number of structural Ô¨Åtting outputs over
more than a decade. Given diÔ¨Äerences in setups, not all can be easily
compared to the new ProFuse Ô¨Åts, in particular we are directly
creating stellar mass ùëÖùëí rather than band speciÔ¨Åc light ùëÖùëí. To date
two free S√©rsic (FS) models have already been published and released
publicly: Kelvin et al. (2012) and Casura et al. (in prep.). The former
of these was run on a mixture of Sloan Digitial Sky Survey optical
images (SDSS; Abazajian et al. 2009) and VISTA/VIKING NIR

MNRAS 000, 1‚Äì25 (2021)

10-310-2Z Final (BD)110100count10-310-210-310-2Z Final (FS)Z Final (PD)103104105106107BD DIC1101001000count103104105106107103104105106107FS DICPD DIC1081091010101100.20.40.60.81Stellar Mass / Msol [ProSpect]FractionPure Disk (FS & n < 1.5)Bulge‚àíDisk (BD | PD)Pure Spheroid (FS & n > 1.5)BDPD14

A. S. G. Robotham et al.

Figure 19. Comparison of ùëÖùëí between ProFuse, GALFIT (aka SIGMA in
this work) and ProFit. In general all three agree quite well, with SIGMA
agreeing better with ProFuse for the most compact sources.

Figure 20. Comparison of S√©rsic index (ùëõ) between ProFuse, GALFIT (aka
SIGMA in this work) and ProFit. SIGMA agrees better with ProFuse in
general, with the ProFit ùëñ-band Ô¨Åts tending to have systematically higher
S√©rsic index (ùëõ).

images using GALFIT (speciÔ¨Åcally a pipeline named SIGMA), and
the latter KiDS ùëîùëüùëñ bands using ProFit. Because we Ô¨Åt in stellar
mass space directly, in general you might expect the redder bands
available to be the most comparable to ProFuse (Robotham et al.
2020), however there is also a tradeoÔ¨Ä in depth and PSF quality (see
Driver et al. 2016) meaning we need to balance the comparison. To
compare to Kelvin et al. (2012) we selected the Z-band, which is the
deepest of the VISTA/VIKING data. To compare to Casura et al. (in
prep.) we selected the ùëñ-band, which is the reddest of the three bands
analysed, and quite deep with a good PSF in general.

Figure 19 compares the FS model ùëÖùëí for the three models dis-
cussed above. In general all are quite consistent, with perhaps the
most compact sources being more similar between ProFuse and
SIGMA (ProFit tends to Ô¨Ånd slightly larger sources in this regime).
The reason for this shift could be the PSF quality (including the
ability to model it), and perhaps a real physical shift due to galaxies
appearing larger in bluer bands (Kelvin et al. 2012). The treatment
of the background is also diÔ¨Äerent between all three eÔ¨Äorts, and this
can have a marked impact on the Ô¨Åtted parameters, in particular the
size and S√©rsic index (Kelvin et al. 2012). In general the level of
agreement here suggests no pathologically worrying behaviour in
any of the three analyses.

Figure 20 compares the FS model S√©rsic index (ùëõ) for the three
models discussed above. The S√©rsic index is one of the harder param-
eters to infer consistently because of its dependency on both the PSF
modelling in the core and the sky subtraction in the wings. For this
reason we might expect to see poorer agreement between all three
models. That caveat aside, we clearly see highly correlated behaviour
between all three analyses. The ProFit Ô¨Åts do show more spread and
a systematic trend towards larger values of ùëõ, which could also be
related to the slightly larger sizes seen in Figure 19. The agreement
with SIGMA is very encouraging, and suggests the Z-band is a rea-
sonable predictor of stellar mass structural parameters in the absence
of the full generative modelling executed with ProFuse.

MNRAS 000, 1‚Äì25 (2021)

ProFuse FS

ProFuse BD | PD

Total

Elliptical
Not Elliptical
Total

387 (81.6%) [8.5%]
4,167 (67.3%) [91.5%]
[4,554]

87 (18.4%) [4.1%]
2,023 (32.7%) [95.9%]
[2,110]

(474)
(6,190)

Table 2. Two way comparison table of our preferred ProFuse models and
the ‚Äòelliptical‚Äô morphological classiÔ¨Åcations. The percentages in parentheses
correspond to the diÔ¨Äerent normalising totals. The two percentages that we
would want to be as close to 100% as possible (since the cross associations
are unambiguous) are highlighted in red.

4.4.2 Comparison to GAMA Morphological ClassiÔ¨Åcations

GAMA has its own human-constructed catalogue of morphological
classiÔ¨Åcations as described in GAMA Date Release 4 (Driver et al., in
press), referred to as MorphGAMA from here. The most meaningful
cross comparison that can be made unambiguously from that earlier
work is to compare our preferred FS models with the ‚Äòelliptical‚Äô
classes therein. Table 2 presents the main results of the two way
classiÔ¨Åcations between these approaches.

Notably the MorphGAMA ‚Äòellipticals‚Äô are selected as a ProFuse
FS model with high Ô¨Ådelity (81.6% of ‚Äòellipticals‚Äô are Ô¨Çagged as
having a preferred FS model, coloured red for clarity). The BD
and PD preferred models hugely prefer the ‚Äònot elliptical‚Äô class in
MorphGAMA (95.9%, coloured red for clarity). The most complex
overlap is where the ‚Äònot ellipticals‚Äô are assigned with ProFuse. Most
reside in the FS model class (67.3%). This might seem surprising,
but this class also contains all our pure disk (or at least, extremely
disk dominated) models. Of these 4,167 galaxies only 13.8% pos-
sess S√©rsic index ùëõ steeper than 2.5, which would be the regime of
canonical elliptical galaxies. This means 86.2% are quite disk-like
in appearance, explaining why they might have been classed as ‚Äònot
elliptical‚Äô whilst also being in our FS population as disk-like models.

12510FS Re / " [ProFit i]0204060count1251012510FS Re / " [ProFuse]FS Re / " [SIGMA Z]0.512510FS n [ProFit i]0204060count0.5125100.512510FS n [ProFuse]FS n [SIGMA Z]ProFuse: Physical Multi-Band Structural Decomposition

15

Figure 21. Mean age of bulges and disks for galaxies with BD/PD preferred
models.

Overall the agreement between our automatic ProFuse model
selection and the MorphGAMA classiÔ¨Åcations is excellent in the
regime where they can be directly compared. To create internal con-
sistency, and reduce dependence on human visual classiÔ¨Åcation, we
will focus on the ProFuse model selections when creating sub classes
for analysis in the remainder of this paper.

5 BULGE AND DISK PROPERTIES

Investigating all aspects of the SFH and ZH decomposition of our
preferred bulge-disk models is deferred to later work (Bellstedt et
al. in prep.) but some of the higher level outcomes will be presented
brieÔ¨Çy.

Where relevant we present the bulges from our PD/BD Ô¨Åts, the FS
Ô¨Åts with S√©rsic index ùëõ > 1.5 (the latter we generically refer to as
‚Äòspheroids‚Äô in Figures), and combined PD/BD disks with FS Ô¨Åts with
S√©rsic index ùëõ < 1.5. For completeness the BD/PD/FS separated
versions of the disks can be found in Appendix C1 (but we note that
our disks appear to share universal properties once controlling for
stellar mass, regardless of being a PD/BD or FS model).

5.1 Star Formation Properties

An interesting result from this initial application of ProFuse is to
compare the mean stellar ages of our preferred BD/PD model bulges
and disks (where we have high conÔ¨Ådence that the real galaxy con-
tains both bulge and disk components). Figure 21 presents the direct
comparisons for all 2,110 galaxies which prefer a BD/PD model, and
it is immediately clear our ProFuse disks are signiÔ¨Åcantly younger
in most cases (87.4% of the examples here). This preference of
disks being systematically younger than bulges agrees well with work
from MacArthur et al. (2009) (for a small well-resolved sample) and
Fraser-McKelvie et al. (2018) (for a larger but less well-resolved
study). However, there have been counter examples to this general

Figure 22. Component age versus metallicity. Top panel shows BD/PD bulges
and middle panel FS spheroids. Our older bulges tend to also be the most
metal enriched. Bottom panel shows disks. We see a much broader range of
metallicities in disks compared to bulges.

trend (Johnston et al. 2014; Barsanti et al. 2021), but these papers
used cluster galaxy selections compared to the environmentally di-
verse and almost volume complete sample used here.

Extending the comparison of ages, Figure 22 demonstrates the age
versus metallicity behaviour of our BD/PD/FS combined samples. It
is notable that the FS spheroids (including elliptical galaxies) have a
diÔ¨Äerent distribution in terms of mean age compared to bulges, show-
ing evidence for both a young (‚àº6Gyr) and old (‚àº10Gyr) population.
The more massive ellipticals possess broadly similar properties to
the BD/PD bulges. We do see a tail of younger BD/PD bulges in

MNRAS 000, 1‚Äì25 (2021)

02x1094x1096x1098x1091x10101.2x101002x1094x1096x1098x1091x10101.2x1010Bulge Mean Age (Yr)Disk Mean Age (Yr)0510152025303540count02x1094x1096x1098x1091x10101.2x101010-310-2Bulge Mean Age (Yr)Bulge Z110100countBD/PD Bulges02x1094x1096x1098x1091x10101.2x101010-310-2FS Mean Age (Yr)Spheroid Z110100countFS Spheriods02x1094x1096x1098x1091x10101.2x101010-310-2Disk Mean Age (Yr)Disk Z110100countBD/PD/FS Disks16

A. S. G. Robotham et al.

Figure 23. Component stellar mass versus age versus metallicity. Top panel
shows BD/PD bulges and middle panel FS spheroids. Our bulges appear quite
uni-modal in this parameter space, whilst we see a bimodal population of old
metal-rich spheroids and young metal poor spheroids. Bottom panel shows
disks, which show a strong mass-metallicity relationship. Size scaling reÔ¨Çects
the logarithmic counts in cells.

less massive systems that overlaps with the younger low-mass FS
spheroid population, but the FS spheroids are entirely missing an-
cient low-mass high-metallicity systems that exist in large number in
the BD/PD bulges. Beyond these diÔ¨Äerences in stellar age, we Ô¨Ånd a
strong preference for our BD/PD bulges and FS spheroids to be metal
rich. Our disks inhabit a much broader distribution of metallicities,
spanning down to quite low values. The few old (‚àº 10Gyr) disks that
do exist possess high metallicities.

MNRAS 000, 1‚Äì25 (2021)

Delving further, Figure 23 presents the component stellar mass
versus mean age, coloured by the median metallicity of objects within
the hexagonal cells. Our bulges are predominantly unimodal, being
almost entirely old (‚àº10 Gyr) and quite metal rich. Our FS spheroids
are bimodal, having an older moderately enriched population above
1010M(cid:12), and a distinctly younger and metal poorer population below
this mass. This suggests there are strong caveats in attempting to
combine bulge and spheroid components in general, and suggests
quite diÔ¨Äerent formation pathways for bulge-like components in the
low mass regime in particular. BD/PD bulges above 1010M(cid:12)become
rarer, this population being dominated by FS spheroids (canonical
elliptical galaxies) that are older and more metal rich, but notably
not as old and metal rich as our BD/PD bulges in general. At a
given stellar mass our bulges appear to be older on average than our
spheroids. The span of ages and the diÔ¨Äerences between the bulge
and spheroid populations is consistent with Ô¨Ågure 25 of Costantin
et al. (2021), which spans a narrower mass range around ùëÄ‚àó. The
bulge population in Costantin et al. (2021) has a distinct clustering
between 8-10 Gyrs, as we see here.

The disks in Figure 23 display quite diÔ¨Äerent behaviour to the
bulges and spheroids. They are younger than the bulge/spheroids (as
we expect) but possess an extremely strong positive metallicity trend
as a function of the component stellar mass, but as a smooth con-
tinuous function rather than a bimodality. Our most massive disks
are approaching solar metallicity, whilst at 108M(cid:12)our disks are ex-
tremely metal poor (in fact hitting our lower template limit). It is
notable from Appendix C1 that our BD/PD and FS disks display
similar behaviour in the mass regimes where they overlap, suggest-
ing these components have similar formation pathways regardless of
the presence of a signiÔ¨Åcant bulge.

5.2 Structural Properties

Figure 24 presents the main results for our bulge-like components
(top and middle panels) and disks (bottom panel). The bulge-like
components have two distinct features: at lower mass near constant
size (‚àº 1kpc) below 1010M(cid:12), and a distinct turn up in size for the
spheroids above 1010M(cid:12). The lower mass components are dominated
by true bulges and compact single component spheroids, while the
more massive bulge-like components are almost entirely massive
elliptical galaxies. These two populations are also evident in Lange
et al. (2016), where in Ô¨Ågure 9 sub-panel ùëë the ‚Äòelliptical‚Äô class of
galaxies shows a distinct upturn at the high mass extreme. Arguably
the constant-size compact bulges are also discernible in Ô¨Ågure 9 sub-
panel ùëñ (although in this work it was still Ô¨Åt with a positive slope
regression, as discussed later).

The disk components in Figure 24 are extremely consistent with
the various disk populations identiÔ¨Åed in Lange et al. (2016) Ô¨Ågure
9, spanning sizes of ‚àº 1kpc at 108M(cid:12), and ‚àº 5kpc at 1011M(cid:12). In
our ProFuse decompositions the apparent spread in the disk sizes
reduces considerably between our smallest (108M(cid:12)) and largest (3 √ó
1011M(cid:12)) disks: 0.38 dex and 0.15 dex respectively. Appendix C2
shows the PD/BD and FS disk populations signiÔ¨Åcantly overlap, and
predominantly describe the same locus of mass‚Äìsize.

In terms of the structural decomposition, ProFuse points towards a
single consistent disk component (regardless of whether it possesses
a signiÔ¨Åcant bulge or not) and two classes of bulge-like populations:
compact low mass systems (either embedded in a disk, or as an
isolated component) and more extended massive elliptical objects.
From our earlier discussion regarding the star formation properties
of ProFuse components it seems further clear that compact bulges
in disks and compact isolated spheroids have distinctly diÔ¨Äerent for-

1081091010101102x1094x1096x1098x1091x10101.2x1010Bulge Stellar Mass / MsolBulge Mean Age (Yr)10-410-310-210-1Med Bulge ZBD/PD Bulges1081091010101102x1094x1096x1098x1091x10101.2x1010Spheroid Stellar Mass / MsolSpheroid Mean Age (Yr)10-410-310-210-1Med Sph. ZFS Spheroids1081091010101102x1094x1096x1098x1091x10101.2x1010Disk Stellar Mass / MsolDisk Mean Age (Yr)10-410-310-210-1Med Disk ZBD/PD/FS DisksProFuse: Physical Multi-Band Structural Decomposition

17

5.2.1 HyperFit of the Mass‚ÄìSize Relationship

The true bulge components presented in Figure 24 are consistent
with having no size dependency on component stellar mass. The
distribution in ùëÖùëí size is approximately Normal, and can be expressed
as:

log10

(cid:19)

(cid:18) ùëÖùëí
kpc

= 0.02¬±0.02 ¬± 0.35¬±0.04,

(3)

where the Ô¨Årst term represents the population mean and the second
term is the standard deviation. The new size distribution for bulges
and the older Lange et al. (2016) work are shown in Figure 24. Whilst
we Ô¨Ånd no size dependency with bulge mass, the combined bulges
in Lange et al. (2016) were Ô¨Åtted with a positive slope.

The mass‚Äìsize relationship of disks shows a clear component stel-
lar mass dependency in Figure 24. Similar to the work of Lange et al.
(2015) and Lange et al. (2016) we use HyperFit to deÔ¨Åne this distri-
bution as a log-linear relationship incorporating intrinsic scatter as
part of the Ô¨Åtting model (Robotham & Obreschkow 2015). HyperFit
minimises the perpendicular residual plane, using simultaneous er-
rors in the mass and size dimensions to correctly weight the data. This
gives the following best Ô¨Åt relationship (the upper numbers represent
the errors on the Ô¨Åtting terms):

(cid:19)

(cid:19)

log10

(cid:18) ùëÖùëí
kpc

= 0.26¬±0.04 log10

(cid:18) M‚àó
1010M(cid:12)
where ùëÖùëí is the half-mass size along the major axis and M‚àó is the
stellar mass of the disk component. This new mass‚Äìsize relationship
for disks and the older Lange et al. (2016) work are shown in Figure
24 as black and red lines respectively.

+ 0.62¬±0.04,

(4)

The above regression has a Normal orthogonal intrinsic scatter
of 0.23¬±0.03. In the Lange et al. (2016) the slope term for all late-
type galaxies (which is the closest analogue to the above sample)
is 0.208¬±0.004 and the oÔ¨Äset term is 0.61¬±0.04. Within the stated
errors of both Ô¨Åts these results are consistent, but our slope term is
marginally steeper (a bit more than 1ùúé diÔ¨Äerence).

5.3 Combing Star Formation and Structural Properties

Building on the above results, we can now explore stellar proper-
ties that appear to be associated with the mass‚Äìsize relationship for
bulges/spheroids and disks. Here we focus on mass‚Äìsize‚Äìage and
mass‚Äìsize‚Äìùëç as having the most compelling results, but the more
direct ùëî ‚àí ùëñ colour and current speciÔ¨Åc SFR (sSFR) of the disk are
presented in Appendix D for completeness.

5.3.1 Mass‚ÄìSize‚ÄìAge Relationship

Figure 25 presents the mass‚Äìsize relationship coloured by the median
age within a hexagonal cell. There are no strong co-dependent trends
seen for our bulge and spheroid populations, but the disks show strong
co-dependence between stellar mass, size and age. The major trend
is for more massive disks to also be older (as seen above), but we also
see strong trends in age when looking vertically along a stellar mass
window, where the larger disks for a given stellar mass are notably
younger.

The presence of such a strong age dependence at a Ô¨Åxed mass for
our disk populations suggests a plane that describes mass, size and
age. We again Ô¨Åt this using HyperFit (minimising the perpendicular
plane residuals, as above), giving the following best Ô¨Åt relationship
(the upper numbers represent the errors on the Ô¨Åtting terms):

MNRAS 000, 1‚Äì25 (2021)

Figure 24. Component stellar mass versus size. Top panel shows BD/PD
bulges and middle panel FS spheroids. We can see a distinct population of
similarly sized bulges on the LHS and elliptical galaxies on the RHS of this
Ô¨Ågure. Bottom panel shows disks. We see a strong relationship between stellar
mass and size across the full range of this Figure. Where relevant the size-
mass relationship found in 5.2.1 are shown as black lines (dotted indicates
the intrinsic scatter), and the previous work of Lange et al. (2016) is shown
as a red line.

mation histories: the former being extremely old and the latter much
younger (possessing similar mean ages to our disk components). The
low-mass compact young spheroids are canonically the same popu-
lation as the ‚Äòlittle blue spheroids‚Äô presented in MoÔ¨Äett et al. (2019)
it would seem.

10810910101011110Bulge Stellar Mass / MsolBulge Re / kpc110100countBD BulgesThis workLange (2016)10810910101011110Spheroid Stellar Mass / MsolSpheroid Re / kpc110100countFS Spheroids10810910101011110Disk Stellar Mass / MsolDisk Re / kpc110100countBD/PD/FS DisksThis workLange (2016)18

A. S. G. Robotham et al.

Figure 25. Component stellar mass versus size versus age. Top panel shows
BD/PD bulges and middle panel FS spheroids. We can see the distinctly older
elliptical galaxies on the RHS of this Figure. Bottom panel shows disks. We
see a strong co-dependency between stellar mass, size and age that is well
represented by a plane.

log10

(cid:19)

(cid:18) ùëÖùëí
kpc

= 0.47¬±0.02 log10

‚àí0.16¬±0.01 (cid:18) Age
109yr

(cid:19)

(cid:19)

(cid:18) M‚àó
1010M(cid:12)
+ 1.56¬±0.06,

(5)

(6)

where ùëÖùëí is the half-mass size along the major axis, M‚àó is the
stellar mass of the disk component and ‚ÄòAge‚Äô is the mean component
stellar age. The above plane has a Normal orthogonal intrinsic scat-

MNRAS 000, 1‚Äì25 (2021)

ter of ¬±0.28¬±0.01. Our mass dependence term has become notably
steeper when adding the age dimension, which reÔ¨Çects the presence
of visual diagonal striping in the bottom panel of Figure 25. As
should be expected from our visual analysis, the ‚ÄòAge‚Äô term has a
negative slope, i.e. younger disks tend to be larger. The result is that
a disk that is 2 Gyrs older (in terms of mean stellar age) might be
expected to be a factor ‚àº 2 more compact for the same component
stellar mass.

For clarity, Figure 26 presents the bottom panel of Figure 25 with
the HyperFit plane added as parallel lines of 2 Gyr steps in age (as
reÔ¨Çected by their colour). This novel mass‚Äìsize‚Äìage plane appears to
do a reasonable job of describing the diversity of observations over
this mass range. Importantly for the robustness of this result and the
existence of a true mass‚Äìsize‚Äìage plane, we Ô¨Ånd in Appendix C2
that even pure disks with no bulge show the same age structure. As
such, our results are not attributable to being a complex systematic
of our BD or PD models, and the plane is present even when Ô¨Åtting
the simplest FS model with only one uniÔ¨Åed SFH and ZH.

There is little published literature that allows for a direct com-
parison of these results, which is not surprising since self-consistent
stellar-population structural decomposition in the manner of Pro-
Fuse is a novel approach. The IFS work of Scott et al. (2017) is prob-
ably the most directly comparable work, which uses data from the
Sydney-AAO Multi-object Integral (SAMI; Bryant et al. 2015) sur-
vey along with the ProFit derived galaxy sizes provided by GAMA
Robotham et al. (2017); MoÔ¨Äett et al. (2019). The top panel of
Figure 9 in that work shows very similar global behaviour for the
mass‚Äìsize‚Äìage plane, where systematically the youngest galaxies are
also the largest for all stellar masses. Figure 12 in that work also at-
tempts to split the sample into disk-like (LHS) and spheroidal (RHS)
samples, and broadly the result of larger younger disks is still clear.
As in our work, the spheroidal population has less clear trends in the
most comparable top-right panel.

McDermid et al. (2015) investigated early type galaxies using data
from the ATLAS3D IFS survey (Cappellari et al. 2011), although
including S0 galaxies with disks. Figure 6 in that work presents
LOESS smoothed relationship of dynamical mass versus size as a
function of stellar age and metallicity. Clear trends in age are present
in the same sense as we Ô¨Ånd for our ProFuse disks (younger galaxies
being larger for a given dynamical mass). Whilst the dynamic range
and sample size in McDermid et al. (2015) is much smaller than
we have here, the age-size dependency appears to be in qualitative
agreement (2 Gyrs in age being a factor two diÔ¨Äerence in size). This
agreement is perhaps surprising since we only see strong evidence for
mass‚Äìsize‚Äìage dependency for our disk sample, our unambiguously
early-type class of preferred Ô¨Åts (the more massive FS spheroids) do
not show such behaviour.

Other analogue works are those of Barone et al. (2021) and Maltby
et al. (2018). The former of these works (Barone et al. 2021) is
focussed on the stellar population Ô¨Åtting of quiescent galaxies (a
cut we do not make here), but broadly has the same outcome that
younger stellar populations are the more extended in term of ùëÖùëí.
The latter work (Maltby et al. 2018) does not explicitly extract stellar
ages, but does describe a consistent picture where disk-like galaxies
with more current star formation (which will tend to make them
‚Äòyounger‚Äô by our mass-weighted age deÔ¨Ånition) are also the most
extended. Comparable Ô¨Åndings are also presented in Courteau et al.
(2007), where rather than age cuts they Ô¨Ånd bluer later-type spirals
(crudely analogous to being younger) are more extended for a given
luminosity (analogous to our disk stellar mass).

The general picture of larger younger disks is consistent with the
apparent growth in galaxies since ùëß ‚àº 2.5 as presented in Trujillo et al.

10810910101011110Bulge Stellar Mass / MsolBulge Re / kpc0246810Med Age/GyrBD Bulges10810910101011110Spheroid Stellar Mass / MsolSpheroid Re / kpc0246810Med Age/GyrFS Spheroids10810910101011110Disk Stellar Mass / MsolDisk Re / kpc0246810Med Age/GyrBD/PD/FS DisksProFuse: Physical Multi-Band Structural Decomposition

19

Figure 26. Same as the bottom panel of 25, but with the HyperFit best Ô¨Åtting plane shown as parallel lines with 2 Gyr steps in age.

(2006, 2007). Those works found a factor ‚àº 3 size growth for disk-
like objects galaxies since ‚àº 10.5 Gyrs look-back time, however they
considered the sizes of galaxies at a given epoch which themselves
would have a range of ages. In fact, cutting our sample to select
disks with a mean stellar age older than 10.5 Gyrs returns a mass‚Äì
size relationship that has the same slope (within error) but a factor
1.65 lower. This suggests a picture where disks that formed entirely
at an early epoch must have grown by a factor 1.5‚Äì2 for our low
redshift GAMA results to be consistent with apparent sizes of higher
redshift disk-like galaxies. Notably this size evolution is not enough
to make these disks as large as those formed more recently (i.e. they
are still distinguishable in our mass‚Äìsize‚Äìage plane). Whether this
disk growth could be secular in nature is unknown, but there are
far more mechanisms that allow galaxies to become larger over time
than smaller (Trujillo et al. 2011).

The most directly comparable theoretical work is Tonini et al.
(2017), which is based on an extension to the Semi-Analytic Galaxy
Evolution Croton et al. (SAGE; 2016) model. Figure 9 in that work
presents a similar mass‚Äìsize‚Äìage plane, with similar trends of age
across the size dimension (younger galaxies again being more mas-
sive). The apparent dynamic range of the eÔ¨Äect is visually similar
too, spanning disk ages from a few Gys at the largest extreme and
10 Gyrs for the most compact. Detailed comparisons to predictions
from semi-analytic models (Lagos et al. 2018) and appropriate higher
resolution hydrodynamical simulations (Schaye et al. 2015) are de-
ferred to future work (Bellstedt et al., in prep.). Obvious avenues of

interest given associated works are the degree to which disk sizes can
evolve without any star formation (in a secular fashion), the role of
galaxy-galaxy interactions, and the impact new star formation has on
the distribution of stellar material already formed. Given the appar-
ent lack of requirement for a BDD model to Ô¨Åt our GAMA sample
(which can produce radial gradients in the SFH) it is also not yet
clear how important inside-out growth mechanisms are to explain
these results.

5.3.2 Mass‚ÄìSize‚Äìùëç Relationship

Extending our analysis to metallicity, Figure 27 presents the mass‚Äì
size relationship coloured by the median disk ùëçgas within a hexagonal
cell. There are no strong trends seen for our bulge and spheroid
populations, and the disks show weak co-dependence between stellar
mass, size and ùëçgas. The horizontal dependency is naturally strong
(due to the expected mass-metallicity relationship, e.g. Lara-L√≥pez
et al. 2010), but the lack of strong diagonal banding suggests there
is no intrinsic co-dependent plane between the three parameters,
instead the stellar mass is independently able to predict the size and
metallicity.

This null result appears to be very consistent with Scott et al.
(2017). In the middle-left panel (late-type galaxies, which we can
take as analogues of our disks) of Ô¨Ågure 11 we see strong mass‚Äì
ùëç trends, but little evidence of any vertical trends of Z varying
with size in any systematic manner. In the middle-right panel (early-

MNRAS 000, 1‚Äì25 (2021)

10810910101011110Disk Stellar Mass / MsolDisk Re / kpc0246810Med Age/GyrBD/PD/FS Disks20

A. S. G. Robotham et al.

Figure 28. The model predicted observed ùëî ‚àí ùëñ colour per pixel (with PSF
convolution, observed frame, and dust attenuated). The bluer disk light dom-
inates everywhere, but as should be expected the redder bulge contribution
increases towards the centre.

galaxy focus of McDermid et al. (2015), and perhaps even the use of
dynamical masses.

Given the above, there is no justiÔ¨Åcation to attempt a four dimen-
sional mass‚Äìsize‚Äìage‚Äìùëç hyper plane, but in conclusion we do Ô¨Ånd
compelling evidence for a true co-dependency between mass, size
and age. The full implications of this novel three dimensional plane
will be further explored in future work (Bellstedt et al., in prep), in-
cluding the impact of our choice of stellar population library (BC03
in this work).

6 LIMITATIONS AND FUTURE PATHS

Whilst we present ProFuse as a step forward in physically moti-
vated spatial decomposition for large photometric samples, there are
a number of limitations with the current software. A few of the
more obvious and physically relevant are listed and discussed in the
following subsections.

6.1 Radial Trends

Whilst many authors suggest wavelength trends in multiple properties
(Kelvin et al. 2014; H√§u√üler et al. 2013), it is non-trivial to create a
generative model that recreates such variations naturally. ProSpect
does support simple disk colour gradients via the option of Ô¨Åtting a
coupled disk model (BDD above). In this case the disk geometries of
two disks are all coupled except for ùëÖùëí which is allowed to vary (and
optionally ùëõ). Each disk is also allowed to have completely distinct
ProSpect SEDs, i.e. diÔ¨Äerent SFHs and ZHs etc (see Figure 7 for
a schematic view of this model). The natural consequence of this is
the possibility of radial colour gradients along the disk components
either due to radial trends in SFH or ZH (and possibly even the
dust screen). This is the simplest ProFuse model that can naturally
explain colour gradients along disks (see Appendix A for a discussion
of this).

Whilst the above is an option (with additional Ô¨Åtting expense with a
more Ô¨Çexible and possibly more degenerate model) it should be noted
that even the simpler bulge-disk model discussed above produces nat-
ural colours gradients spatially just due to the extended interactions
between the single SED (and therefore single colour) bulge and disk

Figure 27. Component stellar mass versus size versus metallicity. Top panel
shows BD/PD bulges and middle panel FS spheroids. The addition of metal-
licity does not seem to produce any discernible trends. Bottom panel shows
disks. We see a some co-dependency between stellar mass, size and metallic-
ity, but the horizontal stellar mass metallicity relationship clearly dominates.

type galaxies, which we can take as analogues of our spheroids) of
Ô¨Ågure 11 there is again little evidence of an age‚Äìùëç trend, and only a
small amount of mass‚Äìùëç dependency. The latter cannot be strongly
concluded given the small amount of dynamic range in mass present
for the early-type galaxies in that work.

McDermid et al. (2015) Ô¨Ånd equally strong evidence for a mass‚Äì
size‚Äìùëç plane as a mass‚Äìsize‚Äìage plane. This would appear to be in
some tension with this work, which may be related to the early-type

MNRAS 000, 1‚Äì25 (2021)

10810910101011110Bulge Stellar Mass / MsolBulge Re / kpc10-410-310-210-1Med ZBD Bulges10810910101011110Spheroid Stellar Mass / MsolSpheroid Re / kpc10-410-310-210-1Med ZFS Spheroids10810910101011110Disk Stellar Mass / MsolDisk Re / kpc10-410-310-210-1Med ZBD/PD/FS Disks050100150020406080100x / pixy / pix0.40.60.811.2g ‚àí iProFuse: Physical Multi-Band Structural Decomposition

21

components. This is because diÔ¨Äering scale lengths and geometries
will naturally produce diÔ¨Äerent observed colour trends over the full
scale of the galaxy- the combined image will never be as simple
as a distinct uniformly coloured bulge and disk. This can be seen
clearly for our example galaxy (from Section 3) in Figure 28, where
we show the observed ùëî ‚àí ùëñ colour across the full image. Whilst the
bulge and the disk both have a Ô¨Åxed colour by construction, the com-
bined model displays complex variations throughout. Particularly in
the inner regions, the simple constant colour circular bulge and ellip-
tical disk models show non-trivial interactions, especially along the
minor-axis direction.

6.2 Bulge-Disk Model Geometry

For bulge-disk Ô¨Åtting, the elliptical disk and circular bulge geom-
etry currently enforced is not so much a code limitation (it is not
computationally expensive to allow for more complex geometries)
but a pragmatic restriction to reduce the strong Ô¨Åt degeneracies that
often occur with increased Ô¨Çexibility. The most serious consequence
of the enforced circular bulge is only canonical ‚Äòclassical‚Äô bulges
can be generated in ProFuse, and the often non-spherical family of
bluer pseudo-bulges cannot be well represented by the current model
(e.g. see Athanassoula 2005). Given the wealth of data available in
the residuals it is relatively easy to identify these failing cases that
truly do justify a diÔ¨Äerent physical model, and at least these can be
removed for relevant analysis. In practice for the low redshift GAMA
sample we found few examples of galaxies that strongly compelled a
more Ô¨Çexible pseudo-bulge like geometry that e.g. were truly better
Ô¨Åtted with the more Ô¨Çexible BDD mode.

On top of the bulge restriction, it is clear that true elliptical galaxy
geometries are compromised since they are not elegantly described
by the sum of a circular de Vaucouleurs proÔ¨Åle bulge and elliptical
exponential disk. Again, it is easy to identify these compromised
cases. In this situation they are generally better represented by a
single component (i.e. only one ProSpect SFH can be generated
for the whole galaxy) elliptical free S√©rsic proÔ¨Åle model (FS above),
which is allowed in the current version of ProFuse.

6.3 Model Selection

The general use case involves running at least the simpliÔ¨Åed bulge-
disk model and the single component S√©rsic model and determining
the most representative of the data from those (as we have done
above in our initial analysis of GAMA with the BD and FS models).
In a well behaved example the comparison of the DICs will often be
enough, but some physical intuition is required to weed out situations
where a model is numerically better (more ‚Äòlikely‚Äô) but physically
less meaningful.

Ironically, given the pursuit of ever deeper and better resolved data,
the above model selection problem generally gets worse the better
the data are. This is because we enter into the statistical regime of
approximate models where in detail all models are ‚Äòwrong‚Äô. Even in
this case, it is reasonable, and in practice often possible, to attempt to
select the most physically informative model. The GAMA data above
at the typical redshift of ùëß ‚àº 0.04 are in a good regime of depth and
resolution for the ProFuse approach, where a signiÔ¨Åcant fraction of
our models produce very clean ùëëùëéùë°ùëé‚àíùëöùëúùëëùëíùëô residuals. More thought
and eÔ¨Äort would need to be applied to solving this problem when the
data resolve features our model cannot describe, e.g. the increase in
the visually irregular structure of galaxies at higher redshift (Driver
et al. 1995).

6.4 Bar Model

Currently ProFuse does not oÔ¨Äer a bar model component, be that
Ferrer or some sort of modiÔ¨Åed S√©rsic proÔ¨Åle (see Robotham et al.
2017, for a detailed discussion of the proÔ¨Åles available). This is a
relatively simple addition longer term, and is likely to be one of
the Ô¨Årst extensions when expanding beyond this initial application
to moderately resolved GAMA data. An interesting question for the
bar component is whether its physical SED model should be directly
coupled to the disk (where the only free ProSpect component would
be the fraction of mass in the bar) or left to have a completely
independent SED model. Even if the SFH and ZH end up being
coupled, there would be a case to allow for a diÔ¨Äerent bar speciÔ¨Åc
dust model rather than assuming a completely constant dust screen
for the whole disk and bar.

Regarding the impact this lack of bar modelling has on the sim-
pler model explored in this paper, it has been noted that, similar
to spiral arms, the ellipse-averaged contribution of a bar is similar
to a smooth disk proÔ¨Åle. That is to say the average intrinsic radial
proÔ¨Åle (when computed within geometrically linked annuli) is often
not hugely modiÔ¨Åed by the presence of spiral arms and/or a bar even
though the azimuthal distribution of light is hugely modiÔ¨Åed (M√∂l-
lenhoÔ¨Ä 2004; Laurikainen et al. 2005). The positive in terms of the
ProFuse modelling is that the average disk properties should there-
fore be well conserved (assuming it is reasonable to exactly couple
the star formation history of the bar to that of the disk), whilst the
clear negative is that no separate accounting of mass inferred in the
bulge versus the canonical disk is possible. We make a more general
observation that only extremely well-resolved galaxies would lend
themselves to meaningful bar modelling, and by visual inspection
only a few percent of the GAMA galaxy decompositions analysed
for this work have convincingly clear bars that would lend themselves
to non-degenerate Ô¨Åtting (where the ‚Äòbar‚Äô component does not simply
model irregular features in the bulge or disk).

6.5 Uncoupled Screen Dust

Currently the dust model for both the bulge and disk are entirely
independent, and one does not know about the other. In practice this
means bulge light that, given the speciÔ¨Åc geometry of the system,
would be attenuated by the disk dust is currently only attenuated
by the bulge dust. However, to do this meaningfully takes a path
towards full 3D radiative transfer Ô¨Åtting. For now we note that it is
relatively easy to identify these problem cases from their edge-on
disk geometry (very high ellipticity disks). These also tend to be
the systems with visually obvious dust lane features, which are also
not well described by the simple bulge-disk ProFuse model (e.g.
see Figure 29). We note positively that such extreme systems in a
volume limited sample appear to be statistically rare, so few of our
galaxy insights are signiÔ¨Åcantly biased by this modelling limitation.
For such cases, it is also possible to mask out dust lane features.

6.6 Intra-Halo Light ProÔ¨Åle

A near term ambition will be to add the option of a projected intra-
halo light (IHL) component to ProSpect. This should allow us to
probe the low surface brightness outskirts of galaxies, where poten-
tially strong priors can be placed on the age of stellar populations
in this component. Such analysis should be revealing since theory
suggests many elements of halo assembly (including in particular
merger activity) and even cosmology can be associated with the IHL
(e.g. Power & Robotham 2016; Drakos et al. 2019a,b; Ca√±as et al.

MNRAS 000, 1‚Äì25 (2021)

22

A. S. G. Robotham et al.

Figure 29. Example ProFuse Ô¨Åt showing the ùëü band data (left panel), model (second panel), spatial residual (third panel) and error normalised histogram (right
panel). The data show clear evidence of a thin dust lane what is not produceable by the ProFuse model, it being limited to dust screens for each component. This
is particularly clear in the third panel where we see a blue model over-subtraction in the inner part of the proÔ¨Åle where the dust lane is observationally dimming
the light.

2020). The most appropriate proÔ¨Åle to use for the projected IHL is a
matter of much uncertainty since it is often hard to detected at all, let
alone distinctly proÔ¨Åle (Merritt et al. 2016). Theoretically deÔ¨Åning
the optimal stellar populations to extract is part of planned future
work (Proctor et al., in prep.).

bulge and spheroid populations show little compelling requirement
for a mass‚Äìsize‚Äìage or mass‚Äìsize‚Äìùëç plane, our disks display strong
co-dependency in the mass‚Äìsize‚Äìage plane. We Ô¨Ånd a strong trend
in age along both the mass (as expected) and size dimensions, where
younger system are larger for a given mass.

7 CONCLUSIONS

Below we summarise the major outcomes from this work:

‚Ä¢ We present ProFuse, a natural extension and fusion of the struc-

tural analysis tool ProFit and the SED Ô¨Åtting tool ProSpect.

‚Ä¢ The current implementation of ProFuse can Ô¨Åt physically self-
consistent models of galaxies comprised of axis-symmetric bulges
(unresolved PSF or S√©rsic proÔ¨Åle) and disks (up to two S√©rsic pro-
Ô¨Åles).

‚Ä¢ In this initial implementation we process the low redshift
GAMA sample of Bellstedt et al. (2020b) that already has results
from our previous ProSpect Ô¨Åts. We process the sample of 6,664
galaxies in four diÔ¨Äerent modes: single free S√©rsic [FS]; de Vau-
couleurs bulge and exponential disk [BD]; PSF bulge and exponential
disk [PD] and Ô¨Ånally de Vaucouleurs bulge and double exponential
disk [BDD]. Determining the BDD model was very rarely preferred
(the quality of data does not reveal strong colour gradients in our
disks), we focussed our analysis on the FS, BD and PD models.

‚Ä¢ We Ô¨Ånd globally consistent behaviour between our new GAMA
ProFuse Ô¨Åts and our published ProSpect results, giving conÔ¨Ådence
that our new methodology is working in a comprehensible manner.
‚Ä¢ We Ô¨Ånd our disks are systematically (and almost always)
younger than our bulges for galaxies preferring a BD or PD model.
‚Ä¢ In terms of mass-age-Z separation, our bulges appear to be tri-
modal: we Ô¨Ånd a very metal rich old population of true bulges, and
two populations for our preferred FS (spheroidal) galaxies. One is
more massive older metal rich elliptical, and the other less massive
younger metal poor spheroids. The latter appear to be analogues to
the Little Blue Spheroid (LBS) population discussed in the literature.
‚Ä¢ The mass-age-Z separation of disks is simpler and eÔ¨Äectively

uni-modal: we Ô¨Ånd a smooth mass‚Äìùëç dependency.

‚Ä¢ Expanding the analysis to include the structural properties of
ProFuse we Ô¨Ånd the most compelling and novel results. Whilst our

MNRAS 000, 1‚Äì25 (2021)

The most interesting result is certainly the extraction of a com-
pelling mass‚Äìsize‚Äìage plane for galaxy disks, and as much as can
be compared this seems to be in agreement with previous works (al-
though none are directly comparable given diÔ¨Äerences in data and
approach). Further observational and theoretical work on the Pro-
Fuse modelling of GAMA is planned (Bellstedt et al. in prep.), and
future extensions to the DEVILS and WAVES surveys are planned.
Longer term, multi-band space based missions (e.g James Webb,
Vera Rubin, Euclid and Nancy Grace Roman observatories) oÔ¨Äer the
best prospects to extending our analysis to higher redshifts.

ACKNOWLEDGEMENTS

ASGR acknowledges support via the Australian Research Council
Future Fellowships Scheme (FT200100375).

This work made use of the following software:Robotham et al.
(2016a,b); Robotham (2018, 2016); Robotham & Obreschkow
(2016); Robotham (2020). This was all written in the R language
(R Core Team 2021).

GAMA is a joint European-Australasian project based around a
spectroscopic campaign using the Anglo-Australian Telescope. The
GAMA input catalogue is based on data taken from the Sloan Dig-
ital Sky Survey and the UKIRT Infrared Deep Sky Survey. Com-
plementary imaging of the GAMA regions is being obtained by a
number of independent survey programmes including GALEX MIS,
VST KiDS, VISTA VIKING, WISE, Herschel-ATLAS, GMRT and
ASKAP providing UV to radio coverage. GAMA is funded by the
STFC (UK), the ARC (Australia), the AAO, and the participating
institutions. The GAMA website is http://www.gama-survey.org/ .

Based on observations made with ESO Telescopes at the La Silla

Paranal Observatory under programme ID 179.A-2004.

Based on observations made with ESO Telescopes at the La Silla

Paranal Observatory under programme ID 177.A-3016.

This work was supported by resources provided by the Pawsey Su-

0204060020406080x/pixy/pixData0204060Model0204060Data - Model‚àí20‚àí100œárx/pixx/pixProFuse: Physical Multi-Band Structural Decomposition

23

percomputing Centre with funding from the Australian Government
and the Government of Western Australia.‚Äù

Thank you to Luke J. M. Davies for assistance in creating Figure
7. ASGR‚Äôs original fever dream sketch was successfully translated
into something comprehensible thanks to his eÔ¨Äorts and Keynote
prowess.

Thank you to the anonymous referee for their constructive com-
ments on the original version of this manuscript. Figures 11 and 12
in particular are much improved based on their suggestions.

DATA AND CODE AVAILABILITY

All the R packages discussed, including the new software ProSpect,
are already available publicly on primary author A. Robotham‚Äôs main
GitHub accounts4. The main multi-band example data are included
as part of the ProFound package. The analysis of GAMA galaxies
made use of publicly available GAMA data.

All GAMA data discussed in this work, including reprocessed
images and comparison data, will be released as part of the compre-
hensive GAMA Data Release 4 (DR4; Driver et al, in press).

REFERENCES

Abazajian K. N., et al., 2009, ApJS, 182, 543
Allen P. D., Driver S. P., Graham A. W., Cameron E., Liske J., de Propris R.,

2006, MNRAS, 371, 2

Amendola L., et al., 2013, Living Reviews in Relativity, 16, 6
Athanassoula E., 2005, MNRAS, 358, 1477
Bakos J., Trujillo I., Pohlen M., 2008, ApJ, 683, L103
Barone T. M., et al., 2021, arXiv e-prints, p. arXiv:2107.01054
Barsanti S., et al., 2021, ApJ, 906, 100
Bellstedt S., et al., 2020a, MNRAS, 496, 3235
Bellstedt S., et al., 2020b, MNRAS, 498, 5581
Bellstedt S., et al., 2021, MNRAS, 503, 3309
Bruzual G., Charlot S., 2003, MNRAS, 344, 1000
Bryant J. J., et al., 2015, MNRAS, 447, 2857
Ca√±as R., Lagos C. d. P., Elahi P. J., Power C., Welker C., Dubois Y., Pichon

C., 2020, MNRAS, 494, 4314

Cappellari M., Emsellem E., 2004, PASP, 116, 138
Cappellari M., et al., 2011, MNRAS, 413, 813
Chabrier G., 2003, PASP, 115, 763
Charlot S., Fall S. M., 2000, ApJ, 539, 718
Coccato L., Morelli L., Corsini E. M., Buson L., Pizzella A., Vergani D.,

Bertola F., 2011, MNRAS, 412, L113
Colless M., et al., 2001, MNRAS, 328, 1039
Cook R. H. W., Cortese L., Catinella B., Robotham A., 2019, MNRAS, 490,

4060

Costantin L., et al., 2021, ApJ, 913, 125
Courteau S., Dutton A. A., van den Bosch F. C., MacArthur L. A., Dekel A.,

Edge A., Sutherland W., Kuƒ≥ken K., Driver S., McMahon R., Eales S., Emer-

son J. P., 2013, The Messenger, 154, 32

Eldridge J. J., Stanway E. R., 2009, MNRAS, 400, 1019
Erwin P., 2015, ApJ, 799, 226
Fraser-McKelvie A., Arag√≥n-Salamanca A., MerriÔ¨Åeld M., Tabor M.,
Bernardi M., Drory N., Parikh T., Argudo-Fern√°ndez M., 2018, MN-
RAS, 481, 5580

Fritz J., Franceschini A., Hatziminaoglou E., 2006, MNRAS, 366, 767
Gardner J. P., et al., 2006, Space Sci. Rev., 123, 485
Graham A. W., Driver S. P., 2005, Publ. Astron. Soc. Australia, 22, 118
Hale C. L., Robotham A. S. G., Davies L. J. M., Jarvis M. J., Driver S. P.,

Heywood I., 2019, MNRAS, 487, 3971
H√§u√üler B., et al., 2013, MNRAS, 430, 330
Iveziƒá ≈Ω., et al., 2019, ApJ, 873, 111
Johnston E. J., Arag√≥n-Salamanca A., MerriÔ¨Åeld M. R., Bedregal A. G., 2012,

MNRAS, 422, 2590

Johnston E. J., Arag√≥n-Salamanca A., MerriÔ¨Åeld M. R., 2014, MNRAS, 441,

333

Johnston E. J., et al., 2017, MNRAS, 465, 2317
Kelvin L. S., et al., 2012, MNRAS, 421, 1007
Kelvin L. S., et al., 2014, MNRAS, 439, 1245
Kuƒ≥ken K., et al., 2019, A&A, 625, A2
Lagos C. d. P., Tobar R. J., Robotham A. S. G., Obreschkow D., Mitchell

P. D., Power C., Elahi P. J., 2018, MNRAS, 481, 3573

Lange R., et al., 2015, MNRAS, 447, 2603
Lange R., et al., 2016, MNRAS, 462, 1470
Lara-L√≥pez M. A., et al., 2010, A&A, 521, L53
Laurikainen E., Salo H., Buta R., 2005, MNRAS, 362, 1319
Liske J., et al., 2015, MNRAS, 452, 2087
MacArthur L. A., Courteau S., Bell E., Holtzman J. A., 2004, ApJS, 152, 175
MacArthur L. A., Gonz√°lez J. J., Courteau S., 2009, MNRAS, 395, 28
Maltby D. T., Almaini O., Wild V., Hatch N. A., Hartley W. G., Simpson C.,

Rowlands K., Socolovsky M., 2018, MNRAS, 480, 381

McDermid R. M., et al., 2015, MNRAS, 448, 3484
M√©ndez-Abreu J., S√°nchez S. F., de Lorenzo-C√°ceres A., 2019, MNRAS,

484, 4298

Merritt A., van Dokkum P., Abraham R., Zhang J., 2016, ApJ, 830, 62
MoÔ¨Äett A. J., et al., 2019, MNRAS, 489, 2830
M√∂llenhoÔ¨Ä C., 2004, A&A, 415, 63
M√∂llenhoÔ¨Ä C., Popescu C. C., TuÔ¨Äs R. J., 2006, A&A, 456, 941
Morrissey P., et al., 2007, ApJS, 173, 682
Noll S., Burgarella D., Giovannoli E., Buat V., Marcillac D., Mu√±oz-Mateos

J. C., 2009, A&A, 507, 1793
Oh S., et al., 2020, MNRAS, 495, 4638
Peng C. Y., Ho L. C., Impey C. D., Rix H.-W., 2002, AJ, 124, 266
Pilbratt G. L., et al., 2010, A&A, 518, L1
Planck Collaboration et al., 2016, A&A, 594, A13
Power C., Robotham A. S. G., 2016, ApJ, 825, 31
R Core Team 2021, R: A Language and Environment for Statistical Comput-
ing. R Foundation for Statistical Computing, Vienna, Austria, https:
//www.R-project.org/

Robotham A. S. G., 2016, Celestial: Common astronomical conversion rou-

tines and functions (ascl:1602.011)

McIntosh D. H., Dale D. A., 2007, ApJ, 671, 203

Robotham A. S. G., 2018, ProFound: Source Extraction and Application to

Croton D. J., et al., 2016, ApJS, 222, 22
Davies L. J. M., et al., 2018, MNRAS, 480, 768
Davies L. J. M., et al., 2021, MNRAS, 506, 256
Drakos N. E., Taylor J. E., Berrouet A., Robotham A. S. G., Power C., 2019a,

Modern Survey Data (ascl:1804.006)

Robotham A. S. G., 2020, ProSpect: Spectral generation package

(ascl:2002.007)

Robotham A. S. G., Obreschkow D., 2015, Publ. Astron. Soc. Australia, 32,

MNRAS, 487, 993

e033

Drakos N. E., Taylor J. E., Berrouet A., Robotham A. S. G., Power C., 2019b,

MNRAS, 487, 1008

Driver S. P., Windhorst R. A., GriÔ¨Éths R. E., 1995, ApJ, 453, 48
Driver S. P., et al., 2011, MNRAS, 413, 971
Driver S. P., et al., 2016, MNRAS, 455, 3911
Driver S. P., et al., 2019, The Messenger, 175, 46

Robotham A. S. G., Obreschkow D., 2016, Hyper-Fit: Fitting routines
for multidimensional data with multivariate Gaussian uncertainties
(ascl:1601.002)

Robotham A. S. G., Taranu D., Tobar R., 2016a, libproÔ¨Åt: Image creation

from luminosity proÔ¨Åles (ascl:1612.003)

Robotham A. S. G., Taranu D., Tobar R., 2016b, ProFit: Bayesian galaxy

Ô¨Åtting tool (ascl:1612.004)

Robotham A. S. G., Taranu D. S., Tobar R., MoÔ¨Äett A., Driver S. P., 2017,

4 https://github.com/asgr and https://github.com/ICRAR

MNRAS, 466, 1513

MNRAS 000, 1‚Äì25 (2021)

24

A. S. G. Robotham et al.

Robotham A. S. G., Davies L. J. M., Driver S. P., Koushan S., Taranu D. S.,

Casura S., Liske J., 2018, MNRAS, 476, 3137

Robotham A. S. G., Bellstedt S., Lagos C. d. P., Thorne J. E., Davies L. J.,

Driver S. P., Bravo M., 2020, MNRAS, 495, 905

Schaye J., et al., 2015, MNRAS, 446, 521
Scott N., et al., 2017, MNRAS, 472, 2833
S√©rsic J. L., 1963, Boletin de la Asociacion Argentina de Astronomia La Plata

Argentina, 6, 41

Shanks T., et al., 2015, MNRAS, 451, 4238
Spergel D., et al., 2015, arXiv e-prints, p. arXiv:1503.03757
Tabor M., MerriÔ¨Åeld M., Arag√≥n-Salamanca A., Cappellari M., Bamford

S. P., Johnston E., 2017, MNRAS, 466, 2024

Taranu D. S., et al., 2017, ApJ, 850, 70
Thorne J. E., et al., 2021, MNRAS, 505, 540
Thorne J. E., et al., 2022, MNRAS, 509, 4940
Tonini C., Mutch S. J., Wyithe J. S. B., Croton D. J., 2017, MNRAS, 465,

4133

Trujillo I., et al., 2006, ApJ, 650, 18
Trujillo I., Conselice C. J., Bundy K., Cooper M. C., Eisenhardt P., Ellis R. S.,

2007, MNRAS, 382, 109

Trujillo I., Ferreras I., de La Rosa I. G., 2011, MNRAS, 415, 3903
Vulcani B., et al., 2014, MNRAS, 441, 1340
Weinberg D. H., Mortonson M. J., Eisenstein D. J., Hirata C., Riess A. G.,

Rozo E., 2013, Phys. Rep., 530, 87
Wright E. L., et al., 2010, AJ, 140, 1868
da Cunha E., Charlot S., Elbaz D., 2008, MNRAS, 388, 1595
de Souza R. E., Gadotti D. A., dos Anjos S., 2004, ApJS, 153, 411
de Vaucouleurs G., 1948, Annales d‚ÄôAstrophysique, 11, 247

APPENDIX A: BD VERSUS BDD MODE

All 6,664 GAMA galaxies used for the low redshift analysis in this
paper were also run with a bulge plus double disk BDD mode. In
practice the amount of stellar mass attributed to the disk and the bulge
to total ratio of the model remains broadly similar (see Figures A1 and
A2 respectively). In much better resolved galaxies such a complexity
of operation might be warranted, since disk colour gradients in disks
have been recovered in many galaxies (MacArthur et al. 2004; Bakos
et al. 2008). However, at the quality of the GAMA data at a typical
redshift of ‚àº 0.04 strong disk colour gradients are rare. This is further
demonstrated by Figure A3, where we largely infer very similar sizes
for the ùë¢ band and Ks band disks. The model is suÔ¨Éciently Ô¨Çexible
that strong colour gradients can be generated if necessary, so we
conclude that the added complexity of the BDD mode over the BD
(with the subsequent increase in computational cost) is not warranted
for the GAMA sample analysed here.

APPENDIX B: ProFuse FITS OF GAMA GALAXIES AT
VARIOUS RESOLUTIONS

For reference we present examples of a marginally- and well-resolved
GAMA galaxy from our sample of 6,664 used in this work. The
marginally resolved source (GAMA 7615, see Figure B1) is at ap-
proximately the 20ùë° ‚Ñé percentile of the sample in terms of the intrinsic
ùëÖùëí of our FS model. The well-resolved source (GAMA 3895257, see
Figure B2) is at approximately the 80ùë° ‚Ñé percentile of the sample in
terms of the intrinsic ùëÖùëí of our FS model.

MNRAS 000, 1‚Äì25 (2021)

Figure A1. Comparison of disk stellar masses between BD and BDD modes.
For the BDD we are showing the sum of both disk components. The disks
being formed in the more complex BDD are representing almost exactly the
same amount of stellar mass.

Figure A2. Comparison of bulge divided by total stellar masses between BD
and BDD modes. Despite the signiÔ¨Åcantly more complex double disk model,
the amount of stellar mass being attributed to the bulge is broadly the same.
This is signiÔ¨Åcant since in principle the BDD mode can better describe a
pseudo-bulge component (compact and disk-like), if this was often required.

1071081091010101110710810910101011BD Stellar Mass / MsolBDD Stellar Mass / Msol1101001000count0.050.10.20.510.050.10.20.51BD Stellar Mass B/TBDD Stellar Mass B/T110100countProFuse: Physical Multi-Band Structural Decomposition

25

APPENDIX D: OTHER POTENTIAL THIRD DIMENSIONS
TO MASS‚ÄìSIZE PLANE

Figure D1 presents other third dimensions of interest when exploring
extensions to the mass‚Äìsize plane for disks. The top panel shows
the simple ùëî ‚àí ùëñ colour, with a strong colour mass dependence and
some evidence of banding. However, it is much more vertical than
we see for our age axis in Figure 26, which is much like we found
when investigating the dependency on metallicity. The bottom panels
shows the sSFR of the disk, and this is even less convincing with only
a small residual trend of the most massive disks to have lower sSFR.
The current star formation of a disk appears to be a poor predictor
for its size given a disk stellar mass.

This paper has been typeset from a TEX/LATEX Ô¨Åle prepared by the author.

Figure A3. Comparison of inferred disk Re (from the mass-weighted average
of both disk components) for the bluest (ùë¢) and reddest (Ks) bands used for
this work. Over the full wavelength range we only see a variation of ‚àº10%
for a small fraction of the sample.

APPENDIX C: TWO COMPONENT (BD/PD) AND SINGLE
COMPONENT (FS) DISKS

In the main body of the paper the BD/PD disks were merged together
with FS models, where disk-like models were taken as those with
ùëõ < 1.5 (as suggested in Trujillo et al. 2006). Whilst disks in these
models broadly overlap, here we brieÔ¨Çy explore whether there are
discernible diÔ¨Äerences between our two component (BD/PD) and
single component (FS) disks.

C1 Star Formation Properties

Figure C1 presents the age versus metallicity properties for disks, split
into the two component BD/PD model disks (top panel) and pure FS
model disks (bottom panel). All disks display very similar properties
in the stellar mass range of overlap, where (not surprisingly) we Ô¨Ånd
that our pure disk FS model (no bulge) systems are predominantly
found at lower stellar mass, whilst the bulge-disk systems span up to
the most massive galaxies in GAMA.

C2 Structural Properties

Figure C2 presents the component mass‚Äìsize relationships for disks,
split into the two component BD/PD model disks (top panel) and
pure FS model disks (bottom panel). The BD/PD two component
and FS pure disks create very similar planes with metallicity, but
span slightly diÔ¨Äerent mass regimes (as seen in the main body of the
paper). The main conclusion to be drawn is combining them together
into a single population is generally reasonable when considering the
mass‚Äìsize plane.

MNRAS 000, 1‚Äì25 (2021)

110100110100Re / pix [u]Re / pix [Ks]1101001000count26

A. S. G. Robotham et al.

Figure B1. Full set of visual diagnostics for GAMA 7615 (an example of a marginally resolved object, approximately at the 20ùë° ‚Ñé percentile of our sample). The
preferred model BD is shown. Other information as per Figure 8.

MNRAS 000, 1‚Äì25 (2021)

ImageugriZYJHKsModelResidual103104105ŒΩfŒΩ[Wm‚àí2]BulgeSEDDiskSEDTotalSEDBulgePhotometryDiskPhotometryTotalPhotometryProFoundphotometry103104105106107Wavelength[Ang]10‚àí210‚àí1100B/T0.000.010.020.030.04SFR[M(cid:12)yr‚àí1]024681012LookbackTime[Gyr]0.000.020.04ZProFuse: Physical Multi-Band Structural Decomposition

27

Figure B2. Full set of visual diagnostics for GAMA 3895257 (an example of a well-resolved object, approximately at the 80ùë° ‚Ñé percentile of our sample). The
preferred model BD is shown. Other information as per Figure 8. The posterior sampling lines are present, but the Ô¨Åt is so well converged that they are diÔ¨Écult
to discern below the expectation Ô¨Åt lines.

MNRAS 000, 1‚Äì25 (2021)

ImageugriZYJHKsModelResidual105106107ŒΩfŒΩ[Wm‚àí2]BulgeSEDDiskSEDTotalSEDBulgePhotometryDiskPhotometryTotalPhotometryProFoundphotometry103104105106107Wavelength[Ang]10‚àí210‚àí1100B/T0246SFR[M(cid:12)yr‚àí1]024681012LookbackTime[Gyr]0.000.020.04Z28

A. S. G. Robotham et al.

Figure C1. Component stellar mass versus age versus metallicity. Top panel
shows BD/PD disks, bottom panel shows FS disks (ùëõ < 1.5). Size scaling
reÔ¨Çects the logarithmic counts in cells.

Figure C2. Component stellar mass versus size versus age. Top panel shows
BD/PD disks, bottom panel shows FS disks (ùëõ < 1.5). Size scaling reÔ¨Çects
the logarithmic counts in cells.

MNRAS 000, 1‚Äì25 (2021)

1081091010101102x1094x1096x1098x1091x10101.2x1010Disk Stellar Mass / MsolDisk Mean Age (Yr)10-410-310-210-1Med Disk ZBD/PD Disks1081091010101102x1094x1096x1098x1091x10101.2x1010Disk Stellar Mass / MsolDisk Mean Age (Yr)10-410-310-210-1Med Disk ZFS Disks10810910101011110Disk Stellar Mass / MsolDisk Re / kpc0246810Med Age/GyrBD/PD Disks10810910101011110Disk Stellar Mass / MsolDisk Re / kpc0246810Med Age/GyrFS DisksProFuse: Physical Multi-Band Structural Decomposition

29

Figure D1. Other mass‚Äìsize plane third dimensions explored for disks. Top
panel shows the observed frame ùëî ‚àí ùëñ colour of the disk, and the speciÔ¨Åc SFR
(sSFR) of the disk.

MNRAS 000, 1‚Äì25 (2021)

10810910101011110Disk Stellar Mass / MsolDisk Re / kpc00.511.52(g ‚àí i)BD/PD/FS Disks10810910101011110Disk Stellar Mass / MsolDisk Re / kpc-15-14-13-12-11-10-9log10(sSFR)BD/PD/FS Disks