Eur. Phys. J. C manuscript No.
(will be inserted by the editor)

Reconstruction of interactions in the ProtoDUNE-SP
detector with Pandora

The DUNE Collaboration

A. Abed Abud130,35, B. Abi158, R. Acciarri67, M. A. Acero11,
M. R. Adames195, G. Adamov72, M. Adamowski67, D. Adams20,
M. Adinolﬁ19, C. Adriano30, A. Aduszkiewicz81, J. Aguilar128,
Z. Ahmad206, J. Ahmed209, B. Aimard52, F. Akbar176,
B. Ali-Mohammadzadeh93,31, K. Allison43, S. Alonso Monsalve35,
M. AlRashed120, C. Alt59, A. Alton12, R. Alvarez39, P. Amedo86,85,
J. Anderson7, C. Andreopoulos179,130, M. Andreotti94,68,
M. Andrews67, F. Andrianala5, S. Andringa129, N. Anﬁmov118,
A. Ankowski185, M. Antoniassi195, M. Antonova85, A. Antoshkin118,
S. Antusch13, A. Aranda-Fernandez42, L. Arellano136, L. O. Arnold45,
M. A. Arroyave58, J. Asaadi198, L. Asquith193, A. Aurisano40,
V. Aushev126, D. Autiero110, V. Ayala Lara105, M. Ayala-
Torres41, F. Azfar158, A. Back91, H. Back159, J. J. Back209,
C. Backhouse204, I. Bagaturia72, L. Bagby67, N. Balashov118,
S. Balasubramanian67, P. Baldi24, B. Baller67, B. Bambah82,
F. Barao129,112, G. Barenboim85, G. Barker209, W. Barkhouse151,
C. Barnes140, G. Barr158, J. Barranco Monarca77, A. Barros195,
N. Barros129,61, J. L. Barrow137, A. Basharina-Freshville204,
A. Bashyal7, V. Basque136, C. Batchelor57, J. Battat210,
F. Battisti158, F. Bay4, M. C. Q. Bazetto30, J. L. Bazo
Alba171, J. F. Beacom156, E. Bechetoille110, B. Behera44,
E. Belchior Batista das Chagas30, L. Bellantoni67, G. Bellettini102,169,
V. Bellini93,31, O. Beltramello35, N. Benekos35, C. Ben-
itez Montiel9, F. Bento Neves129, J. Berger44, S. Berkman67,
P. Bernardini96,180, R. M. Berner14, A. Bersani95, S. Bertolucci92,17,
M. Betancourt67, A. Betancur Rodr´ıguez58, A. Bevan174,
Y. Bezawada23, A. T. Bezerra62, T. J. Bezerra193, A. Bhardwaj132,
V. Bhatnagar161, M. Bhattacharjee89, D. Bhattarai146,
S. Bhuller19, B. Bhuyan89, S. Biagi104, J. Bian24, M. Biassoni97,
K. Biery67, B. Bilki15,108, M. Bishai20, A. Bitadze136, A. Blake127,
F. d. M. Blaszczyk67, G. C. Blazey152, E. Blucher37, J. Boissevain131,
S. Bolognesi34, T. Bolton120, L. Bomben97,107, M. Bonesini97,142,
C. Bonilla-Diaz32, F. Bonini20, A. Booth174, F. Boran15,
S. Bordoni35, A. Borkum193, N. Bostan154, P. Bour49,
D. Boyden152, J. Bracinik16, D. Braga67, D. Brailsford127,
A. Branca97, A. Brandt198, J. Bremer35, C. Brew179, S. J. Brice67,
C. Brizzolari97,142, C. Bromberg141, J. Brooke19, A. Bross67,
G. Brunetti97,142, M. Brunetti209, N. Buchanan44, H. Budd176,
I. Butorov118, I. Cagnoli92,17, T. Cai216, D. Caiulo110,
R. Calabrese94,68, P. Calaﬁura128, J. Calcutt157, M. Calin21,

2
2
0
2

n
u
J

9
2

]
x
e
-
p
e
h
[

1
v
1
2
5
4
1
.
6
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
2

S. Calvez44, E. Calvo39, A. Caminata95, A. Campos Benitez207,
D. Caratelli27, D. Carber44, J. M. Carceller204, G. Carini20,
B. Carlus110, M. F. Carneiro20, P. Carniti97, I. Caro Terrazas44,
H. Carranza198, T. Carroll213, J. F. Casta˜no Forero6,
A. Castillo183, C. Castromonte105, E. Catano-Mur212, C. Cattadori97,
F. Cavalier162, G. Cavallaro97, F. Cavanna67, S. Centro160,
G. Cerati67, A. Cervelli92, A. Cervera Villanueva85, M. Chalifour35,
A. Chappell209, E. Chardonnet163, N. Charitonidis35, A. Chatterjee170,
S. Chattopadhyay206, M. S. Chavarry Neyra105, H. Chen20,
M. Chen24, Y. Chen14, Z. Chen190, Z. Chen-Wishart177,
Y. Cheon203, D. Cherdack81, C. Chi45, S. Childress67,
R. Chirco87, A. Chiriacescu21, K. Cho123, S. Choate152,
D. Chokheli72, P. S. Chong166, A. Christensen44, D. Christian67,
G. Christodoulou35, A. Chukanov118, M. Chung203, E. Church159,
V. Cicero92,17, P. Clarke57, G. Cline128, T. E. Coan189,
A. G. Cocco99, J. Coelho163, J. Collot76, N. Colton44,
E. Conley55, R. Conley185, J. Conrad137, M. Convery185,
S. Copello95, P. Cova98,164, L. Cremaldi146, L. Cremonesi174,
J. I. Crespo-Anad´on39, M. Crisler67, E. Cristaldo9, J. Crnkovic67,
R. Cross127, A. Cudd43, C. Cuesta39, Y. Cui26, D. Cussans19,
J. Dai76, O. Dalager24, H. Da Motta33, L. Da Silva Peres66,
C. David216,67, Q. David110, G. S. Davies146, S. Davini95,
J. Dawson163, K. De198, S. De2, P. Debbins108, I. De
Bonis52, M. Decowski150,3, A. De Gouvea153, P. C. De
Holanda30, I. L. De Icaza Astiz193, A. Deisting177, P. De
Jong150,3, A. Delbart34, V. De Leo182,103, D. Delepine77,
M. Delgado97,142, A. Dell’Acqua35, N. Delmonte98,164, P. De
Lurgio7, J. R. De Mello Neto66, D. M. DeMuth205, S. Dennis29,
C. Densham179, G. W. Deptuch20, A. De Roeck35, V. De
Romeri85, G. De Souza30, R. Devi115, R. Dharmapalan80,
M. Dias202, J. Diaz91, F. D´ıaz171, F. Di Capua99,147, A. Di
Domenico182,103, S. Di Domizio95,71, L. Di Giulio35, P. Ding67,
L. Di Noto95,71, G. Dirkx88, C. Distefano104, R. Diurba14,
M. Diwan20, Z. Djurcic7, D. Doering185, S. Dolan35, F. Dolek15,
M. Dolinski54, L. Domine185, Y. Donon35, D. Douglas141,
A. Dragone185, G. Drake67, F. Drielsma185, L. Duarte202,
D. Duchesneau52, K. Duﬀy158,67, P. Dunne88, B. Dutta196,
H. Duyang186, O. Dvornikov80, D. Dwyer128, A. Dyshkant152,
M. Eads152, A. Earle193, D. Edmunds141, J. Eisch67, L. Emberger136,138,
S. Emery34, P. Englezos178, A. Ereditato214, T. Erjavec23,
C. Escobar67, L. Escudero Sanchez29, G. Eurin34, J. J. Evans136,
E. Ewart91, A. C. Ezeribe184, K. Fahey67, A. Falcone97,142,
M. Fani’131, C. Farnese100, Y. Farzan111, D. Fedoseev118,
J. Felix77, Y. Feng109, E. Fernandez-Martinez134, P. Fer-
nandez Menendez85, F. Ferraro95,71, L. Fields154, P. Filip48,
F. Filthaut150,175, R. Fine131, G. Fiorillo99,147, M. Fiorini94,68,
V. Fischer109, R. S. Fitzpatrick140, W. Flanagan51, B. Fleming214,
R. Flight176, S. Fogarty44, W. Foreman87, J. Fowler55,
W. Fox91, J. Franc49, K. Francis152, D. Franco214, J. Freeman67,

3

J. Freestone136, J. Fried20, A. Friedland185, S. Fuess67,
I. K. Furic69, K. Furman174, A. P. Furmanski145, A. Gabrielli92,17,
A. Gago171, H. Gallagher201, A. Gallas162, A. Gallego-
Ros39, N. Gallice98,143, V. Galymov110, E. Gamberini35,
T. Gamble184, F. Ganacim195, R. Gandhi78, S. Ganguly67,
F. Gao170, S. Gao20, D. Garcia-Gamez73, M. ´A. Garc´ıa-
Peris85, S. Gardiner67, D. Gastler18, J. Gauvreau155, P. Gauzzi182,103,
G. Ge45, N. Geﬀroy52, B. Gelli30, A. Gendotti59, S. Gent188,
Z. Ghorbani-Moghaddam95, P. Giammaria30, T. Giammaria94,68,
N. Giangiacomi200, D. Gibin160,100, I. Gil-Botella39, S. Gilligan157,
C. Girerd110, A. Giri90, D. Gnani128, O. Gogota126, M. Gold148,
S. Gollapinni131, K. Gollwitzer67, R. A. Gomes63, L. Gomez
Bermeo183, L. S. Gomez Fajardo183, F. Gonnella16, D. Gonz´alez
Caama˜no86, D. Gonzalez-Diaz86, M. Gonzalez-Lopez134,
M. C. Goodman7, O. Goodwin136, S. Goswami168, C. Gotti97,
E. Goudzovski16, C. Grace128, R. Gran144, E. Granados77,
P. Granger34, C. Grant18, D. Gratieri70, P. Green136,
S. Green29, S. Greenberg22,128, L. Greenler213, J. Greer19,
J. Grenard35, C. Griﬃth193, M. Groh44, J. Grudzinski7,
K. Grzelak208, W. Gu20, E. Guardincerri131, V. Guarino7,
M. Guarise94,68, R. Guenette136,79, E. Guerard162, M. Guerzoni92,
D. Guﬀanti97, A. Guglielmi100, B. Guo186, A. Gupta185,
V. Gupta150, K. Guthikonda124, P. Guzowski136, M. M. Guzzo30,
S. Gwon38, C. Ha38, K. Haaf67, A. Habig144, H. Hadavand198,
R. Haenni14, A. Hahn67, J. Haiston187, P. Hamacher-
Baumann158, T. Hamernik67, P. Hamilton88, J. Han170,
D. A. Harris216,67, J. Hartnell193, T. Hartnett179, J. Harton44,
T. Hasegawa122, C. Hasnip158, R. Hatcher67, K. W. Hatﬁeld24,
A. Hatzikoutelis181, C. Hayes91, K. Hayrapetyan174, J. Hays174,
E. Hazen18, M. He81, A. Heavey67, K. M. Heeger214,
J. Heise192, S. Henry176, M. Hernandez Morquecho87,
K. Herner67, J. Hewes40, C. Hilgenberg145, T. Hill83, S. J. Hillier16,
A. Himmel67, E. Hinkle37, L. R. Hirsch195, J. Ho79, J. Hoﬀ67,
A. Holin179, E. Hoppe159, G. A. Horton-Smith120, M. Hostert145,
A. Hourlier137, B. Howard67, R. Howell176, I. Hristova179,
M. S. Hronek67, J. Huang23, Z. Hulcher185, G. Iles88,
N. Ilic200, A. M. Iliescu92, R. Illingworth67, G. Ingratta92,17,
A. Ioannisian215, B. Irwin145, L. Isenhower1, R. Itay185,
C. M. Jackson159, V. Jain2, E. James67, W. Jang198, B. Jargowsky24,
F. Jediny49, D. Jena67, Y. Jeong38,108, C. Jes´us-Valls84,
X. Ji20, J. Jiang190, L. Jiang207, S. Jim´enez39, A. Jipa21,
F. Joaquim129,112, W. Johnson187, N. Johnston91, B. Jones198,
M. Judah170, C. Jung190, T. Junk67, Y. Jwa45, M. Kabirnezhad158,
A. Kaboth177,179, I. Kadenko126, I. Kakorin118, A. Kalitkina118,
D. Kalra45, F. Kamiya65, D. M. Kaplan87, G. Karagiorgi45,
G. Karaman108, A. Karcher128, M. Karolak34, Y. Karyotakis52,
S. Kasai125, S. P. Kasetti132, L. Kashur44, N. Kazaryan215,
E. Kearns18, P. Keener166, K. J. Kelly35, E. Kemp30,
O. Kemularia72, W. Ketchum67, S. H. Kettell20, M. Khabibullin106,

4

A. Khotjantsev106, A. Khvedelidze72, D. Kim196, B. King67,
B. Kirby45, M. Kirby67, J. Klein166, A. Klustova88, T. Kobilarcik67,
K. Koehler213, L. W. Koerner81, D. H. Koh185, S. Kohn22,128,
P. P. Koller14, L. Kolupaeva118, D. Korablev118, M. Kordosky212,
T. Kosc76, U. Kose35, V. Kostelecky91, K. Kothekar19,
R. Kralik193, L. Kreczko19, F. Krennrich109, I. Kreslo14,
W. Kropp24, T. Kroupova166, S. Kubota79, Y. Kudenko106,
V. A. Kudryavtsev184, S. Kuhlmann7, S. Kulagin106, J. Kumar80,
P. Kumar184, P. Kunze52, R. Kuravi128, N. Kurita185,
C. Kuruppu186, V. Kus49, T. Kutter132, J. Kvasnicka48,
D. Kwak203, A. Lambert128, B. Land166, C. E. Lane54,
K. Lang199, T. Langford214, M. Langstaﬀ136, J. Larkin20,
P. Lasorak88, D. Last166, A. Laundrie213, G. Laurenti92,
A. Lawrence128, I. Lazanu21, R. LaZur44, M. Lazzaroni98,143,
T. Le201, S. Leardini86, J. Learned80, P. LeBrun110, T. LeCompte185,
C. Lee67, S. Lee117, G. Lehmann Miotto35, R. Lehnert91,
M. Leigui de Oliveira65, M. Leitner128, L. M. Lepin136,
S. Li185, Y. Li20, H. Liao120, C. Lin128, Q. Lin185, S. Lin132,
R. A. Lineros32, J. Ling191, A. Lister213, B. R. Littlejohn87,
J. Liu24, Y. Liu37, S. Lockwitz67, T. Loew128, M. Lokajicek48,
I. Lomidze72, K. Long88, T. Lord209, J. LoSecco154, W. C. Louis131,
X. Lu209, K. Luk22,128, B. Lunday166, X. Luo27, E. Luppi94,68,
T. Lux84, V. P. Luzio65, J. Maalmi162, D. MacFarlane185,
A. Machado30, P. Machado67, C. Macias91, J. Macier67,
A. Maddalena75, A. Madera35, P. Madigan22,128, S. Magill7,
K. Mahn141, A. Maio129,61, A. Major55, J. A. Maloney50,
G. Mandrioli92, R. C. Mandujano24, J. C. Maneira129,61,
L. Manenti204, S. Manly176, A. Mann201, K. Manolopoulos179,
M. Manrique Plata91, V. N. Manyam20, M. Marchan67,
A. Marchionni67, W. Marciano20, D. Marfatia80, C. Mariani207,
J. Maricic80, R. Marie162, F. Marinho64, A. D. Marino43,
T. Markiewicz185, D. Marsden136, M. Marshak145, C. Marshall176,
J. Marshall209, J. Marteau110, J. Mart´ın-Albo85, N. Martinez120,
D. A. Martinez Caicedo187, P. Mart´ınez Mirav´e85, S. Martynenko190,
V. Mascagna97,107, K. Mason201, A. Mastbaum178, F. Matichard128,
S. Matsuno80, J. Matthews132, C. Mauger166, N. Mauri92,17,
K. Mavrokoridis130, I. Mawby209, R. Mazza97, A. Mazzacane67,
E. Mazzucato34, T. McAskill210, E. McCluskey67, N. McConkey136,
K. S. McFarland176, C. McGrew190, A. McNab136, A. Mefodiev106,
P. Mehta116, P. Melas10, O. Mena85, H. Mendez172, P. Mendez35,
D. P. M´endez20, A. Menegolli101,165, G. Meng100, M. Messier91,
W. Metcalf132, M. Mewes91, H. Meyer211, T. Miao67,
G. Michna188, V. Mikola204, R. Milincic80, G. Miller136,
W. Miller145, J. Mills201, O. Mineev106, A. Minotti97,142,
O. G. Miranda41, S. Miryala20, C. Mishra67, S. Mishra186,
A. Mislivec145, M. Mitchell132, D. Mladenov35, I. Mocioiu167,
K. Moﬀat56, N. Moggi92,17, R. Mohanta82, T. A. Mohayai67,
N. Mokhov67, J. A. Molina9, L. Molina Bueno85, E. Montagna92,17,
A. Montanari92, C. Montanari101,67,165, D. Montanari67,

5

D. Montanino96,180, L. M. Monta˜no Zetina41, S. Moon203,
M. Mooney44, A. F. Moor29, D. Moreno6, D. Moretti97,
C. Morris81, C. Mossey67, M. Mote132, E. Motuk204, C. A. Moura65,
J. Mousseau140, G. Mouster127, W. Mu67, L. Mualem28,
J. Mueller44, M. Muether211, S. Mufson91, F. Muheim57,
A. Muir53, M. Mulhearn23, D. Munford81, H. Muramatsu145,
M. Murphy207, S. Murphy59, J. Musser91, J. Nachtman108,
Y. Nagai60, S. Nagu133, M. Nalbandyan215, R. Nandakumar179,
D. Naples170, S. Narita113, A. Nath89, A. Navrer-Agasson136,
N. Nayak24, M. Nebot-Guinot57, K. Negishi113, J. K. Nelson212,
J. Nesbit213, M. Nessi35, D. Newbold179, M. Newcomer166,
H. Newton53, R. Nichol204, F. Nicolas-Arnaldos73, A. Nikolica166,
E. Niner67, K. Nishimura80, A. Norman67, A. Norrick67,
R. Northrop37, P. Novella85, J. A. Nowak127, M. Oberling7,
J. Ochoa-Ricoux24, A. Olivier176, A. Olshevskiy118, Y. Onel108,
Y. Onishchuk126, J. Ott24, L. Pagani23, G. Palacio58, O. Palamara67,
S. Palestini35, J. M. Paley67, M. Pallavicini95,71, C. Palomares39,
W. Panduro Vazquez177, E. Pantic23, V. Paolone170, V. Papadimitriou67,
R. Papaleo104, A. Papanestis179, S. Paramesvaran19, S. Parke67,
E. Parozzi97,142, Z. Parsa20, M. Parvu21, S. Pascoli56,17,
L. Pasqualini92,17, J. Pasternak88, J. Pater136, C. Patrick57,204,
L. Patrizii92, R. B. Patterson28, S. Patton128, T. Patzak163,
A. Paudel67, B. Paulos213, L. Paulucci65, Z. Pavlovic67,
G. Pawloski145, D. Payne130, V. Pec48, S. J. Peeters193,
A. Pena Perez185, E. Pennacchio110, A. Penzo108, O. L. Peres30,
J. Perry57, D. Pershey55, G. Pessina97, G. Petrillo185,
C. Petta93,31, R. Petti186, V. Pia92,17, F. Piastra14, L. Pickering177,
F. Pietropaolo35,100, V. L. Pimentel46,30, G. Pinaroli20,
K. Plows158, R. Plunkett67, F. Pompa85, X. Pons35, N. Poonthottathil109,
F. Poppi92,17, S. Pordes67, J. Porter193, S. Porzio14, M. Potekhin20,
R. Potenza93,31, B. V. Potukuchi115, J. Pozimski88, M. Pozzato92,17,
S. Prakash30, T. Prakash128, M. Prest97, S. Prince79, F. Psihas67,
D. Pugnere110, X. Qian20, J. Raaf67, V. Radeka20, J. Rademacker19,
B. Radics59, A. Raﬁque7, E. Raguzin20, M. Rai209, M. Rajaoalisoa40,
I. Rakhno67, A. Rakotonandrasana5, L. Rakotondravohitra5,
R. Rameika67, M. Ramirez Delgado166, B. Ramson67,
A. Rappoldi101,165, G. Raselli101,165, P. Ratoﬀ127, S. Raut190,
H. Razaﬁnime40, R. Razakamiandra5, E. M. Rea145, J. S. Real76,
B. Rebel213,67, R. Rechenmacher67, M. Reggiani-Guzzo136,
J. Reichenbacher187, S. D. Reitzner67, H. Rejeb Sfar35,
A. Renshaw81, S. Rescia20, F. Resnati35, M. Ribas195,
S. Riboldi98, C. Riccio190, G. Riccobene104, L. C. Rice170,
J. S. Ricol76, A. Rigamonti35, Y. Rigaut59, E. V. Rinc´on58,
H. Ritchie-Yates177, D. Rivera131, A. Robert76, J. Ro-
cabado Rocha85, L. Rochester185, M. Roda130, P. Rodrigues158,
J. V. Rodrigues da Silva Leite202, M. J. Rodriguez Alonso35,
J. Rodriguez Rondon187, S. Rosauro-Alcaraz162, P. Rosier162,
B. Roskovec24, M. Rossella101,165, M. Rossi35, J. Rout116,
P. Roy211, A. Rubbia59, C. Rubbia74, B. Russell128, D. Ruterbories176,

6

A. Rybnikov118, A. Saa-Hernandez86, R. Saakyan204, S. Sacerdoti163,
N. Sahu90, P. Sala98,35, N. Samios20, O. Samoylov118, M. Sanchez109,
V. Sandberg131, D. A. Sanders146, D. Sankey179, N. Saoulidou10,
P. Sapienza104, C. Sarasty40, I. Sarcevic8, G. Savage67,
V. Savinov170, A. Scaramelli101, A. Scarﬀ184, A. Scarpelli20,
T. Schefke132, H. Schellman157,67, S. Schifano94,68, P. Schlabach67,
D. Schmitz37, A. W. Schneider137, K. Scholberg55, A. Schukraft67,
E. Segreto30, A. Selyunin118, C. R. Senise Jr.202, J. Sensenig166,
D. Sgalaberna59, M. Shaevitz45, S. Shafaq116, F. Shaker216,
M. Shamma26, R. Sharankova201, H. R. Sharma115, R. Sharma20,
R. K. Sharma173, K. Shaw193, T. Shaw67, K. Shchablo110,
C. Shepherd-Themistocleous179, A. Sheshukov118, S. Shin117,
I. Shoemaker207, D. Shooltz141, R. Shrock190, H. Siegel45,
L. Simard162, J. Sinclair185, G. Sinev187, J. Singh133, J. Singh133,
L. Singh47, P. Singh174, V. Singh47, R. Sipos35, F. Sippach45,
G. Sirri92, A. Sitraka187, K. Siyeon38, K. Skarpaas185,
E. Smith91, P. Smith91, J. Smolik49, M. Smy24, E. Snider67,
P. Snopok87, D. Snowden-Iﬀt155, M. Soares Nunes194,
H. Sobel24, M. Soderberg194, S. Sokolov118, C. J. Solano
Salinas105, S. S¨oldner-Rembold136, S. Soleti128, N. Solomey211,
V. Solovov129, W. E. Sondheim131, M. Sorel85, A. Sotnikov118,
J. Soto-Oton39, F. Soto Ugaldi105, A. Sousa40, K. Soustruznik36,
F. Spagliardi158, M. Spanu97,142, J. Spitz140, N. J. Spooner184,
K. Spurgeon194, M. Stancari67, L. Stanco100,160, C. Stanford79,
R. Stein19, H. Steiner128, A. F. Steklain Lisbˆoa195, J. Stewart20,
B. Stillwell37, J. Stock187, F. Stocker35, T. Stokes132, M. Strait145,
T. Strauss67, L. Strigari196, A. Stuart42, J. G. Suarez58,
J. Su´arez Sunci´on105, H. Sullivan198, A. Surdo96, V. Susic13,
L. Suter67, C. Sutera93,31, Y. Suvorov99,147, R. Svoboda23,
B. Szczerbinska197, A. M. Szelc57, N. Talukdar186, H. Tanaka185,
S. Tang20, B. Tapia Oregui199, A. Tapper88, S. Tariq67,
E. Tarpara20, N. Tata79, E. Tatar83, R. Tayloe91, A. Teklu190,
P. Tennessen128,4, M. Tenti92, K. Terao185, C. A. Ternes85,
F. Terranova97,142, G. Testera95, T. Thakore40, A. Thea179,
C. Thorn20, S. Timm67, V. Tishchenko20, L. Tomassetti94,68,
A. Tonazzo163, D. Torbunov145, M. Torti97,142, M. Tortola85,
F. Tortorici93,31, N. Tosi92, D. Totani27, M. Toups67, C. Touramanis130,
R. Travaglini92, J. Trevor28, S. Trilov19, W. H. Trzaska119,
Y. Tsai24, Y. Tsai185, Z. Tsamalaidze72, K. Tsang185,
N. Tsverava72, S. Z. Tu114, S. Tufanli35, C. Tull128, J. Tyler120,
E. Tyley184, M. Tzanov132, L. Uboldi35, M. A. Uchida29,
J. Urheim91, T. Usher185, S. Uzunyan152, M. R. Vagins121,24,
P. Vahle212, S. Valder193, G. D. Valdiviesso62, E. Valencia77,
R. Valentim202, Z. Vallari28, E. Vallazza97, J. W. Valle85,
S. Vallecorsa35, R. Van Berg166, R. G. Van de Water131,
D. Vanegas Forero139, D. Vannerom137, F. Varanini100,
D. Vargas Oliva200, G. Varner80, J. Vasel91, S. Vasina118,
G. Vasseur34, N. Vaughan157, K. Vaziri67, S. Ventura100,
A. Verdugo39, S. Vergani29, M. A. Vermeulen150, M. Verzocchi67,

7

M. Vicenzi95,71, H. Vieira de Souza163, C. Vignoli75, C. Vilela35,
B. Viren20, T. Vrba49, T. Wachala149, A. V. Waldron88,
M. Wallbank40, C. Wallis44, T. Walton67, H. Wang25,
J. Wang187, L. Wang128, M. H. Wang67, X. Wang67, Y. Wang25,
Y. Wang190, K. Warburton109, D. Warner44, M. Wascko88,
D. Waters204, A. Watson16, K. Wawrowska179,193, P. Weatherly54,
A. Weber135,67, M. Weber14, H. Wei132, A. Weinstein109,
D. Wenman213, M. Wetstein109, A. White198, L. H. Whitehead29,
D. Whittington194, M. J. Wilking190, A. Wilkinson204,
C. Wilkinson128, Z. Williams198, F. Wilson179, R. J. Wilson44,
W. Wisniewski185, J. Wolcott201, T. Wongjirad201, A. Wood81,
K. Wood128, E. Worcester20, M. Worcester20, K. Wresilo29,
C. Wret176, W. Wu67, W. Wu24, Y. Xiao24, B. Yaeggy40,
E. Yandel27, G. Yang190, K. Yang158, T. Yang67, A. Yankelevich24,
N. Yershov106, K. Yonehara67, Y. Yoon38, T. Young151,
B. Yu20, H. Yu20, H. Yu191, J. Yu198, Y. Yu87, W. Yuan57,
R. Zaki216, J. Zalesak48, L. Zambelli52, B. Zamorano73,
A. Zani98, L. Zazueta212, G. Zeller67, J. Zennamo67, K. Zeug213,
C. Zhang20, S. Zhang91, Y. Zhang170, M. Zhao20, E. Zhivun20,
G. Zhu156, E. D. Zimmerman43, S. Zucchelli92,17, J. Zuklin48,
V. Zutshi152, R. Zwaska67

1Abilene Christian University, Abilene, TX 79601, USA

2 University of Albany, SUNY, Albany, NY 12222, USA
3 University of Amsterdam, NL-1098 XG Amsterdam, The Netherlands
4 Antalya Bilim University, 07190 D¨o¸semealtı/Antalya, Turkey
5 University of Antananarivo, Antananarivo 101, Madagascar
6 Universidad Antonio Nari˜no, Bogot´a, Colombia
7 Argonne National Laboratory, Argonne, IL 60439, USA
8 University of Arizona, Tucson, AZ 85721, USA
9 Universidad Nacional de Asunci´on, San Lorenzo, Paraguay
10 University of Athens, Zografou GR 157 84, Greece
11 Universidad del Atl´antico, Barranquilla, Atl´antico, Colombia
12 Augustana University, Sioux Falls, SD 57197, USA
13 University of Basel, CH-4056 Basel, Switzerland
14 University of Bern, CH-3012 Bern, Switzerland
15 Beykent University, Istanbul, Turkey
16 University of Birmingham, Birmingham B15 2TT, United Kingdom
17 Universit`a del Bologna, 40127 Bologna, Italy
18 Boston University, Boston, MA 02215, USA
19 University of Bristol, Bristol BS8 1TL, United Kingdom
20 Brookhaven National Laboratory, Upton, NY 11973, USA
21 University of Bucharest, Bucharest, Romania
22 University of California Berkeley, Berkeley, CA 94720, USA
23 University of California Davis, Davis, CA 95616, USA
24 University of California Irvine, Irvine, CA 92697, USA
25 University of California Los Angeles, Los Angeles, CA 90095, USA
26 University of California Riverside, Riverside CA 92521, USA
27 University of California Santa Barbara, Santa Barbara, CA 93106, USA
28 California Institute of Technology, Pasadena, CA 91125, USA
29 University of Cambridge, Cambridge CB3 0HE, United Kingdom
30 Universidade Estadual de Campinas, Campinas - SP, 13083-970, Brazil
31 Universit`a di Catania, 2 - 95131 Catania, Italy
32 Universidad Cat´olica del Norte, Antofagasta, Chile
33 Centro Brasileiro de Pesquisas F´ısicas, Rio de Janeiro, RJ 22290-180, Brazil
34 IRFU, CEA, Universit´e Paris-Saclay, F-91191 Gif-sur-Yvette, France

8

35 CERN, The European Organization for Nuclear Research, 1211 Meyrin, Switzerland
36 Institute of Particle and Nuclear Physics of the Faculty of Mathematics and Physics of

the Charles University, 180 00 Prague 8, Czech Republic
37 University of Chicago, Chicago, IL 60637, USA
38 Chung-Ang University, Seoul 06974, South Korea
39 CIEMAT, Centro de Investigaciones Energ´eticas, Medioambientales y Tecnol´ogicas,

E-28040 Madrid, Spain

40 University of Cincinnati, Cincinnati, OH 45221, USA
41 Centro de Investigaci´on y de Estudios Avanzados del Instituto Polit´ecnico Nacional

(Cinvestav), Mexico City, Mexico

42 Universidad de Colima, Colima, Mexico
43 University of Colorado Boulder, Boulder, CO 80309, USA
44 Colorado State University, Fort Collins, CO 80523, USA
45 Columbia University, New York, NY 10027, USA
46 Centro de Tecnologia da Informacao Renato Archer, Amarais - Campinas, SP - CEP

13069-901

47 Central University of South Bihar, Gaya, 824236, India
48 Institute of Physics, Czech Academy of Sciences, 182 00 Prague 8, Czech Republic
49 Czech Technical University, 115 19 Prague 1, Czech Republic
50 Dakota State University, Madison, SD 57042, USA
51 University of Dallas, Irving, TX 75062-4736, USA
52 Laboratoire d’Annecy de Physique des Particules, Univ. Grenoble Alpes, Univ. Savoie

Mont Blanc, CNRS, LAPP-IN2P3, 74000 Annecy, France

53 Daresbury Laboratory, Cheshire WA4 4AD, United Kingdom
54 Drexel University, Philadelphia, PA 19104, USA
55 Duke University, Durham, NC 27708, USA
56 Durham University, Durham DH1 3LE, United Kingdom
57 University of Edinburgh, Edinburgh EH8 9YL, United Kingdom
58 Universidad EIA, Envigado, Antioquia, Colombia
59 ETH Zurich, Zurich, Switzerland
60 E¨otv¨os Lor´and University, 1053 Budapest, Hungary
61 Faculdade de Ciˆencias da Universidade de Lisboa - FCUL, 1749-016 Lisboa, Portugal
62 Universidade Federal de Alfenas, Po¸cos de Caldas - MG, 37715-400, Brazil
63 Universidade Federal de Goias, Goiania, GO 74690-900, Brazil
64 Universidade Federal de S˜ao Carlos, Araras - SP, 13604-900, Brazil
65 Universidade Federal do ABC, Santo Andr´e - SP, 09210-580, Brazil
66 Universidade Federal do Rio de Janeiro, Rio de Janeiro - RJ, 21941-901, Brazil
67 Fermi National Accelerator Laboratory, Batavia, IL 60510, USA
68 University of Ferrara, Ferrara, Italy
69 University of Florida, Gainesville, FL 32611-8440, USA
70 Fluminense Federal University, 9 Icara´ı Niter´oi - RJ, 24220-900, Brazil
71 Universit`a degli Studi di Genova, Genova, Italy
72 Georgian Technical University, Tbilisi, Georgia
73 University of Granada & CAFPE, 18002 Granada, Spain
74 Gran Sasso Science Institute, L’Aquila, Italy
75 Laboratori Nazionali del Gran Sasso, L’Aquila AQ, Italy
76 University Grenoble Alpes, CNRS, Grenoble INP, LPSC-IN2P3, 38000 Grenoble,

France

77 Universidad de Guanajuato, Guanajuato, C.P. 37000, Mexico
78 Harish-Chandra Research Institute, Jhunsi, Allahabad 211 019, India
79 Harvard University, Cambridge, MA 02138, USA
80 University of Hawaii, Honolulu, HI 96822, USA
81 University of Houston, Houston, TX 77204, USA
82 University of Hyderabad, Gachibowli, Hyderabad - 500 046, India
83 Idaho State University, Pocatello, ID 83209, USA
84 Institut de F´ısica d’Altes Energies (IFAE)—Barcelona Institute of Science and

Technology (BIST), Barcelona, Spain

85 Instituto de F´ısica Corpuscular, CSIC and Universitat de Val`encia, 46980 Paterna,

Valencia, Spain

86 Instituto Galego de Fisica de Altas Enerxias, A Coru˜na, Spain

9

87 Illinois Institute of Technology, Chicago, IL 60616, USA
88 Imperial College of Science Technology and Medicine, London SW7 2BZ, United

Kingdom

89 Indian Institute of Technology Guwahati, Guwahati, 781 039, India
90 Indian Institute of Technology Hyderabad, Hyderabad, 502285, India
91 Indiana University, Bloomington, IN 47405, USA
92 Istituto Nazionale di Fisica Nucleare Sezione di Bologna, 40127 Bologna BO, Italy
93 Istituto Nazionale di Fisica Nucleare Sezione di Catania, I-95123 Catania, Italy
94 Istituto Nazionale di Fisica Nucleare Sezione di Ferrara, I-44122 Ferrara, Italy
95 Istituto Nazionale di Fisica Nucleare Sezione di Genova, 16146 Genova GE, Italy
96 Istituto Nazionale di Fisica Nucleare Sezione di Lecce, 73100 - Lecce, Italy
97 Istituto Nazionale di Fisica Nucleare Sezione di Milano Bicocca, 3 - I-20126 Milano,

Italy

98 Istituto Nazionale di Fisica Nucleare Sezione di Milano, 20133 Milano, Italy
99 Istituto Nazionale di Fisica Nucleare Sezione di Napoli, I-80126 Napoli, Italy
100 Istituto Nazionale di Fisica Nucleare Sezione di Padova, 35131 Padova, Italy
101 Istituto Nazionale di Fisica Nucleare Sezione di Pavia, I-27100 Pavia, Italy
102 Istituto Nazionale di Fisica Nucleare Laboratori Nazionali di Pisa, Pisa PI, Italy
103 Istituto Nazionale di Fisica Nucleare Sezione di Roma, 00185 Roma RM, Italy
104 Istituto Nazionale di Fisica Nucleare Laboratori Nazionali del Sud, 95123 Catania,

Italy

105 Universidad Nacional de Ingenier´ıa, Lima 25, Per´u
106 Institute for Nuclear Research of the Russian Academy of Sciences, Moscow 117312,

Russia

107 University of Insubria, Via Ravasi, 2, 21100 Varese VA, Italy
108 University of Iowa, Iowa City, IA 52242, USA
109 Iowa State University, Ames, Iowa 50011, USA
110 Institut de Physique des 2 Inﬁnis de Lyon, 69622 Villeurbanne, France
111 Institute for Research in Fundamental Sciences, Tehran, Iran
112 Instituto Superior T´ecnico - IST, Universidade de Lisboa, 1049-001 Lisboa, Portugal
113 Iwate University, Morioka, Iwate 020-8551, Japan
114 Jackson State University, Jackson, MS 39217, USA
115 University of Jammu, Jammu-180006, India
116 Jawaharlal Nehru University, New Delhi 110067, India
117 Jeonbuk National University, Jeonrabuk-do 54896, South Korea
118 Joint Institute for Nuclear Research, Dzhelepov Laboratory of Nuclear Problems, 6

Joliot-Curie, Dubna, Moscow Region, 141980 RU

119 University of Jyvaskyla, FI-40014, Finland
120 Kansas State University, Manhattan, KS 66506, USA
121 Kavli Institute for the Physics and Mathematics of the Universe, Kashiwa, Chiba

277-8583, Japan

122 High Energy Accelerator Research Organization (KEK), Ibaraki, 305-0801, Japan
123 Korea Institute of Science and Technology Information, Daejeon, 34141, South Korea
124 K L University, Vaddeswaram, Andhra Pradesh 522502, India
125 National Institute of Technology, Kure College, Hiroshima, 737-8506, Japan
126 Taras Shevchenko National University of Kyiv, 01601 Kyiv, Ukraine
127 Lancaster University, Lancaster LA1 4YB, United Kingdom
128 Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA
129 Laborat´orio de Instrumenta¸c˜ao e F´ısica Experimental de Part´ıculas, 1649-003 Lisboa

and 3004-516 Coimbra, Portugal

130 University of Liverpool, L69 7ZE, Liverpool, United Kingdom
131 Los Alamos National Laboratory, Los Alamos, NM 87545, USA
132 Louisiana State University, Baton Rouge, LA 70803, USA
133 University of Lucknow, Uttar Pradesh 226007, India
134 Madrid Autonoma University and IFT UAM/CSIC, 28049 Madrid, Spain
135 Johannes Gutenberg-Universit¨at Mainz, 55122 Mainz, Germany
136 University of Manchester, Manchester M13 9PL, United Kingdom
137 Massachusetts Institute of Technology, Cambridge, MA 02139, USA
138 Max-Planck-Institut, Munich, 80805, Germany
139 University of Medell´ın, Medell´ın, 050026 Colombia

10

140 University of Michigan, Ann Arbor, MI 48109, USA
141 Michigan State University, East Lansing, MI 48824, USA
142 Universit`a del Milano-Bicocca, 20126 Milano, Italy
143 Universit`a degli Studi di Milano, I-20133 Milano, Italy
144 University of Minnesota Duluth, Duluth, MN 55812, USA
145 University of Minnesota Twin Cities, Minneapolis, MN 55455, USA
146 University of Mississippi, University, MS 38677 USA
147 Universit`a degli Studi di Napoli Federico II , 80138 Napoli NA, Italy
148 University of New Mexico, Albuquerque, NM 87131, USA
149 H. Niewodnicza´nski Institute of Nuclear Physics, Polish Academy of Sciences,

Cracow, Poland

150 Nikhef National Institute of Subatomic Physics, 1098 XG Amsterdam, Netherlands
151 University of North Dakota, Grand Forks, ND 58202-8357, USA
152 Northern Illinois University, DeKalb, IL 60115, USA
153 Northwestern University, Evanston, Il 60208, USA
154 University of Notre Dame, Notre Dame, IN 46556, USA
155 Occidental College, Los Angeles, CA 90041
156 Ohio State University, Columbus, OH 43210, USA
157 Oregon State University, Corvallis, OR 97331, USA
158 University of Oxford, Oxford, OX1 3RH, United Kingdom
159 Paciﬁc Northwest National Laboratory, Richland, WA 99352, USA
160 Universt`a degli Studi di Padova, I-35131 Padova, Italy
161 Panjab University, Chandigarh, 160014 U.T., India
162 Universit´e Paris-Saclay, CNRS/IN2P3, IJCLab, 91405 Orsay, France
163 Universit´e de Paris, CNRS, Astroparticule et Cosmologie, F-75006, Paris, France
164 University of Parma, 43121 Parma PR, Italy
165 Universit`a degli Studi di Pavia, 27100 Pavia PV, Italy
166 University of Pennsylvania, Philadelphia, PA 19104, USA
167 Pennsylvania State University, University Park, PA 16802, USA
168 Physical Research Laboratory, Ahmedabad 380 009, India
169 Universit`a di Pisa, I-56127 Pisa, Italy
170 University of Pittsburgh, Pittsburgh, PA 15260, USA
171 Pontiﬁcia Universidad Cat´olica del Per´u, Lima, Per´u
172 University of Puerto Rico, Mayaguez 00681, Puerto Rico, USA
173 Punjab Agricultural University, Ludhiana 141004, India
174 Queen Mary University of London, London E1 4NS, United Kingdom
175 Radboud University, NL-6525 AJ Nijmegen, Netherlands
176 University of Rochester, Rochester, NY 14627, USA
177 Royal Holloway College London, TW20 0EX, United Kingdom
178 Rutgers University, Piscataway, NJ, 08854, USA
179 STFC Rutherford Appleton Laboratory, Didcot OX11 0QX, United Kingdom
180 Universit`a del Salento, 73100 Lecce, Italy
181 San Jose State University, San Jos´e, CA 95192-0106, USA
182 Sapienza University of Rome, 00185 Roma RM, Italy
183 Universidad Sergio Arboleda, 11022 Bogot´a, Colombia
184 University of Sheﬃeld, Sheﬃeld S3 7RH, United Kingdom
185 SLAC National Accelerator Laboratory, Menlo Park, CA 94025, USA
186 University of South Carolina, Columbia, SC 29208, USA
187 South Dakota School of Mines and Technology, Rapid City, SD 57701, USA
188 South Dakota State University, Brookings, SD 57007, USA
189 Southern Methodist University, Dallas, TX 75275, USA
190 Stony Brook University, SUNY, Stony Brook, NY 11794, USA
191 Sun Yat-Sen University, Guangzhou, 510275
192 Sanford Underground Research Facility, Lead, SD, 57754, USA
193 University of Sussex, Brighton, BN1 9RH, United Kingdom
194 Syracuse University, Syracuse, NY 13244, USA
195 Universidade Tecnol´ogica Federal do Paran´a, Curitiba, Brazil
196 Texas A&M University, College Station, Texas 77840
197 Texas A&M University - Corpus Christi, Corpus Christi, TX 78412, USA
198 University of Texas at Arlington, Arlington, TX 76019, USA

11

199 University of Texas at Austin, Austin, TX 78712, USA
200 University of Toronto, Toronto, Ontario M5S 1A1, Canada
201 Tufts University, Medford, MA 02155, USA
202 Universidade Federal de S˜ao Paulo, 09913-030, S˜ao Paulo, Brazil
203 Ulsan National Institute of Science and Technology, Ulsan 689-798, South Korea
204 University College London, London, WC1E 6BT, United Kingdom
205 Valley City State University, Valley City, ND 58072, USA
206 Variable Energy Cyclotron Centre, 700 064 West Bengal, India
207 Virginia Tech, Blacksburg, VA 24060, USA
208 University of Warsaw, 02-093 Warsaw, Poland
209 University of Warwick, Coventry CV4 7AL, United Kingdom
210 Wellesley College, Wellesley, MA 02481, USA
211 Wichita State University, Wichita, KS 67260, USA
212 College of William and Mary, Williamsburg, VA 23187, USA
213 University of Wisconsin Madison, Madison, WI 53706, USA
214 Yale University, New Haven, CT 06520, USA
215 Yerevan Institute for Theoretical Physics and Modeling, Yerevan 0036, Armenia
216 York University, Toronto M3J 1P3, Canada

Received: date / Accepted: date

Abstract The Pandora Software Development Kit and algorithm libraries pro-
vide pattern-recognition logic essential to the reconstruction of particle interactions
in liquid argon time projection chamber detectors. Pandora is the primary event
reconstruction software used at ProtoDUNE-SP, a prototype for the Deep Un-
derground Neutrino Experiment far detector. ProtoDUNE-SP, located at CERN,
is exposed to a charged-particle test beam. This paper gives an overview of the
Pandora reconstruction algorithms and how they have been tailored for use at
ProtoDUNE-SP. In complex events with numerous cosmic-ray and beam back-
ground particles, the simulated reconstruction and identiﬁcation eﬃciency for trig-
gered test-beam particles is above 80% for the majority of particle type and beam
momentum combinations. Speciﬁcally, simulated 1 GeV/c charged pions and pro-
tons are correctly reconstructed and identiﬁed with eﬃciencies of 86.1±0.6% and
84.1±0.6%, respectively. The eﬃciencies measured for test-beam data are shown
to be within 5% of those predicted by the simulation.

Keywords Pattern-recognition · Event reconstruction · Neutrino detectors ·
Time projection chambers · DUNE · ProtoDUNE-SP

1 Introduction

ProtoDUNE-SP [1] was a liquid argon time projection chamber (LArTPC) detec-
tor prototype for the Deep Underground Neutrino Experiment (DUNE) far detec-
tor [2]. Installation of the detector at the CERN Neutrino Platform was completed
in August 2018, and charged-particle test-beam data were collected from August
2018 until the start of the CERN long shutdown period in December 2018.

The primary engineering goal of the ProtoDUNE-SP detector was to prototype
the production of large-scale LArTPCs for use at the DUNE far detector (FD) [3].
Alongside the validation of production and installation procedures, ProtoDUNE-
SP had goals related to testing the event reconstruction and performing detector
calibration in a controlled environment. The primary physics goals were measure-
ments of the interaction cross-sections for various charged particle species on a

12

liquid argon target that will be very valuable for modelling neutrino interactions
at DUNE.

Pandora is a software package that has been developed for event reconstruc-
tion in high energy physics and is now in use at ProtoDUNE-SP [4]. It consists
of a framework, the Pandora Software Development Kit (SDK) [5], and a num-
ber of experiment-speciﬁc content libraries containing pattern-recognition logic.
Originally developed for event reconstruction at future linear e+e− colliders [6, 7],
Pandora has since been successfully applied in LArTPC experiments, such as Mi-
croBooNE [8]. Pandora brings a multi-algorithm philosophy to LArTPC event
reconstruction, applying over 100 algorithms to develop the reconstruction from
the input hits to a hierarchy of fully-reconstructed particles. Each algorithm is
designed to address a speciﬁc aspect of event reconstruction, and they collec-
tively provide robust and sophisticated pattern recognition. Pandora incorporates
machine-learning techniques, such as boosted decision trees (BDTs) [9, 10] and
support vector machines [11], to drive decisions made at certain junctions of the
event reconstruction.

The contents of this paper are as follows: Sec. 2 describes the ProtoDUNE-
SP experiment, Sec. 3 describes the Pandora reconstruction, Sec. 4 describes the
simulated and experimental data samples, Sec. 5 provides an assessment of the
cosmic-ray reconstruction, Sec. 6 examines the performance of the test-beam re-
construction, and Sec. 7 provides concluding remarks.

2 Experimental Details

2.1 Charged Particle Test Beam

A dedicated extension [12, 13] to the CERN H4 beamline was constructed for
ProtoDUNE-SP. The test beam contains a mixture of particle species: π+, e+, p,
µ+, and K +. The test beam can also run in negative polarity, but all test-beam
data collected in 2018 was taken in the positive polarity mode. The beam mo-
mentum can be varied from 0.3 to 7 GeV/c with a resolution of ∆p/p ≤ 3% [14],
providing particles with similar energies as those expected to be produced in neu-
trino interactions in the DUNE FD [15]. The test beam enters the detector through
a beam plug in the upstream face and is approximately 10 cm in diameter.

The beam line has numerous instruments that are used to trigger the detector
readout electronics, and to measure the momentum and the trajectory of the
test-beam particles prior to their entrance into the detector, and to identify their
species. Full details of the test-beam design can be found in Refs [4, 12, 13].

2.2 ProtoDUNE-SP

The ProtoDUNE-SP detector is extensively described in Refs [1] and [4]. A sim-
pliﬁed schematic of the detector is shown in Fig. 1. It had a cuboid geometry with
active-volume dimensions: 7.2 m (width), 6.1 m (height) and 7.0 m (length). It had
a total liquid argon mass of 0.77 kt making it the largest LArTPC constructed to

13

date1. The nominal electric ﬁeld in the active volume was 500 V/cm, generated by
the cathode plane (an array of Cathode Plane Assembly (CPA) modules), which
was held at -180 kV, and two sets of three Anode Plane Assemblies (APAs), one on
either side of the central cathode, which were eﬀectively grounded. The ﬁeld cage
ensured the uniformity of the electric ﬁeld and shields it from the cryostat walls.
The APAs are two-sided such that they can read out a drift volume on either side,
as required for the DUNE FD. Each side of the APA has a plane of collection
wires, referred to as the w planes, that collect the ionisation charges from that
side of the APA. In front of the collection plane there are two planes of induction
wires, the inner one is denoted v and the outer u, that wrap around both sides
of the APA. The w plane wires are vertical with a 4.790 mm pitch between the
wires. The u and v plane wires are aligned at ±35.7◦ to the vertical, with a pitch
of 4.669 mm between the wires.

Fig. 1: A simple drawing of the ProtoDUNE-SP detector. The black box represents
the active volume, divided into two parts by the central cathode (blue). The six
APAs are arranged into two planes (red) either side of the cathode. The test beam
enters through the beam plug, close to the right side of the cathode. The right-
handed coordinate system is shown in addition to the dimensions of the active
volume.

A right-handed Cartesian coordinate system was used to describe the detec-
tor geometry: x deﬁnes the drift axis and is either equal to or opposite to the
drift direction, y is the upwards vertical direction and z the remaining orthogonal
direction. The test beam was directed primarily along the positive z direction.
The origin of the coordinate system is at the bottom of the upstream end of the
cathode.

Each wire measures the induced or collected charge as a function of time for the
duration of each 3 ms readout window. The maximal drift time, deﬁned as the time
taken for charge to drift from the cathode to the APAs, is approximately 2250 µs.
The 3 ms readout window, relative to the beam trigger time, spans the range

1The dual-phase LArTPC ProtoDUNE-DP, which was built shortly after ProtoDUNE-SP, was
approximately the same size.

yxzAPA plane with 3 APAsCathode planeAPA plane with 3 APAsBeam plug7.2m6.1m7.0m14

Fig. 2: An example of the w view for a simulated 7 GeV/c π+ event at ProtoDUNE-
SP where the hits have been coloured to indicate their origin: triggered test-beam
particle (blue), beam halo (red) and cosmic-ray muon (black). The vertical axis is
equivalent to the z axis of the detector and the horizontal axis is converted from
the drift time. The test beam particles enter from the upstream end (bottom of
the image).

from −250 µs to 2750 µs and ensures that any charge deposited in the detector
at the beam trigger time will be collected. Various detector eﬀects are removed
to reduce noise from the raw waveforms. This process consists of the mitigation
of noisy readout wires, the removal of coherent and high-frequency noise from
the wire signals and the deconvolution of the wire signals. The deconvolution
procedure identiﬁes and accounts for signals on a given wire that are produced
via induction when adjacent wires observe charge [16, 17]. Hits are then formed
from the collected or induced charge waveforms by ﬁtting Gaussian functions to
peaks in the waveforms. Each wire plane yields a 2D image of particle interactions
in the LArTPC that forms the input to the pattern-recognition algorithms. A full
description of signal processing, noise removal and charge calibration is given in
Ref. [4].

Figure 2 shows the reconstructed hits for a typical simulated 3 ms readout win-
dow in ProtoDUNE-SP in the collection (w) view in the (drift coordinate, wire
position) parameter space. For the w view, the wire position is the same as the
z coordinate, and the drift time has been converted to the spatial x coordinate
using the drift velocity. The three colours represent hits from three classes of par-
ticles (and any subsequent particles produced in their interactions): blue shows
the triggered test-beam 7 GeV/c charged pion particle that initiated the readout of

x, drift positionw, wire positionTest beam directionw, wire positionx, drift position15

the detector and interacted almost immediately after entering the TPC; red shows
all other beam particles, henceforth called beam halo particles, which includes
particles from interactions in the beam line, those not focused by the beam-line
magnets due to their momentum, particle decays, and focused particles that ar-
rived within the readout window of the triggered beam particle; and black shows
cosmic rays (mostly muons). In general, test-beam particle interactions produce
complex particle hierarchies (containing secondary, tertiary, etc, particles from in-
teractions and decays) involving both track-like and shower-like energy deposits,
while cosmic-ray muons produce highly track-like topologies. Due to the surface
location of ProtoDUNE-SP, the majority of the collected charge signals originated
from cosmic-ray muons that traverse the detector throughout the 3 ms readout
window. The measured time of charge collected on the wires, tm, is a function of
the time that the particle entered the detector (t0) relative to the time that the
detector readout was triggered (ttrigger), and the distance in the drift coordinate
from the APA where the energy was deposited (x0):

tm = t0 − ttrigger + x0/vd,

(1)

where vd is the electron drift velocity. By deﬁnition in ProtoDUNE-SP, the trigger
time ttrigger = 0 and at the nominal electric ﬁeld the electron drift velocity is vd
= 1.59 mm/µs [4].

Equation 1 shows that there is an ambiguity between t0 and x0 unless t0 is
known. For the test-beam particle that triggers the TPC readout t0 = ttrigger by
deﬁnition and there is no ambiguity. In all other cases, the t0 for any particle is
initially undetermined and is assumed to arrive at the beam trigger time and hence
assigned a preliminary value of t0 = 0. The exact position inside the TPC where
charge was physically deposited is thus only well known for triggered test-beam
particles. For other particles (cosmic rays and beam-halo particles) this intrinsic
ambiguity in the drift coordinate makes it initially impossible to distinguish be-
tween charge deposited by a particle arriving before the beam trigger but far from
the APA, and charge deposited by a particle arriving after the beam trigger but
close to the APA, since in both cases the time at which the charge is collected by
the readout wires would be the same. Other LArTPCs have demonstrated that
this ambiguity can be resolved for some interactions by matching the charge in-
formation with precise timing information from a photon detector system [18, 19].
The six APAs are read out independently and give rise to six volumes with drift
ﬁelds (henceforth referred to as drift regions), three on either side of the cathode.
Since the APAs are read out on both sides, there are also six small volumes without
drift ﬁelds between the APAs and the cryostat wall (known as dummy regions),
where charge can be detected if a particle crosses the APA. Figure 3 shows how
adjacent drift regions (separated by the dashed lines) sharing a common drift
direction are concatenated together inside Pandora to form two drift volumes (red
and blue), and the two sets of dummy regions are also concatenated into dummy
volumes (cyan and magenta). The drift direction for a given drift region is either
along positive or negative x depending on the local cathode and APA orientation.
The merged drift volumes allow the pattern recognition to trivially correlate inputs
between adjacent (in the z direction) drift regions.

16

Fig. 3: A schematic top-down view of ProtoDUNE-SP. The six drift regions, each
read out by an individual APA, are separated by the dashed lines within the
larger drift volumes (red and blue) used inside Pandora. The dummy regions are
also combined into dummy volumes (cyan and magenta). The test beam enters
the detector close to the cathode and at z = 0.

2.3 Space Charge Eﬀects

Surface-based LArTPC detectors such as ProtoDUNE-SP are subject to space
charge eﬀects (SCE): the build up of slow-moving2 positive ions in the detector
due to the high rate of cosmic-ray muons. These ions are produced when charged
particles pass through the detector and ionise the liquid argon [21]. This eﬀect
distorts the electric ﬁeld by up to 25% in some regions of the detector and hence
the drift velocity of ionisation electrons within the LArTPC. Assuming the nominal
uniform electric ﬁeld, the positions of the reconstructed hits within the detector
are shifted with respect to their true positions, and the charges of the hits are
also distorted. The simulation uses a data-driven space charge distortion based on
measurements of cosmic-ray muons, as described in Ref. [4], which is asymmetric
with respect to the cathode. While the SCE is an important consideration for
surface detectors, its impact will be much smaller for deep underground detectors
such as the DUNE far detectors due to the signiﬁcantly lower rate of cosmic rays.

3 Pandora Event Reconstruction

The Pandora event reconstruction for ProtoDUNE-SP builds directly upon the
approaches and algorithms developed for MicroBooNE, described in Ref. [8]. In
this section, the emphasis is on how these algorithms have been carefully extended
and harnessed to reconstruct cosmic-ray muon and test-beam particles in a surface-
based LArTPC detector comprising multiple drift volumes.

2Approximately 5 × 10−5mm/µs [20]

z (m)x (m)CathodeAPA planeAPA planeDrift direction3.6Test-beam direction0.0- 3.60.07.017

The inputs to the Pandora pattern recognition are hits, and each hit represents
a signal detected on a speciﬁc wire at a speciﬁc time. As at MicroBooNE, the
input hits each have a drift time coordinate and a wire coordinate, and each hit
is associated with a speciﬁc readout plane. This means that three 2D images are
presented as inputs: the u, v and w views. For ProtoDUNE-SP, one additional
piece of information is collected per hit: an index identifying the drift volume
from which the hit originates. The wrapping of the induction wires requires that
a disambiguation procedure using time-based coincidences between the induction
views and the collection view is used to eliminate ghost hits. Full details of the
disambiguation procedure are given in Ref. [22].

Pandora uses a multi-algorithm approach to pattern recognition, and the three
2D images are considered by a series of over one hundred algorithms and tools,
which gradually identify features and build up a picture of events. The ﬁnal goal
is for each given particle to be reconstructed as a single object, that is both pure
(containing only hits from that particle) and complete (containing all hits from
that particle). Further details are presented in Ref. [8], but the overall approach
is to:

– Add hits to clusters. The hits from each readout plane are considered sep-
arately and clustered, with the aim of creating one cluster per input particle.
This procedure begins with a main clustering algorithm that is designed to
be conservative to prioritise making pure but incomplete clusters and avoiding
mistakes. A series of subsequent “topological association” algorithms exploit
the detector granularity to increase the cluster completeness, whilst maintain-
ing purity.

– Add clusters to particles. The clusters from each readout plane are carefully
compared, by exploiting the drift coordinate common to all planes, and by using
knowledge of the wire angles to correlate features in 3D. By comparing the
independent 2D pattern-recognition outcomes for the three planes, corrections
to the 2D clustering can be made, and clusters can be unambiguously associated
between planes. Clusters are bound together to form reconstructed particles.
– Add particles to hierarchies. Reconstructed particles contain clusters from
two or more readout planes, allowing a list of 3D hits to be created for each. A
series of further topological association algorithms (now operating in 3D) con-
tinue to grow particle completeness, without sacriﬁcing purity. The reconstruc-
tion concludes by organising the ﬁnal particles into a 3D hierarchy, representing
the ﬁnal state particles and any subsequent interactions or decays.

For MicroBooNE, two chains of Pandora algorithms were created to reconstruct
the input images under the hypothesis that the inputs were cosmic-ray muons (the
PandoraCosmic chain), or under the hypothesis that the inputs represented the
ﬁnal state particles emerging from a neutrino interaction (the PandoraNu chain).
In this section, details are presented of how the PandoraCosmic chain has been
adapted for a detector with multiple drift volumes. Details are then presented
of how the PandoraNu chain has been adapted to represent the interactions of
charged particles in a test beam (and renamed PandoraTestBeam). Finally, a de-
scription is provided of how these two algorithm chains have been carefully woven
together to provide a clear reconstruction output. The aim is to provide an unam-
biguous interpretation of the input hits at ProtoDUNE-SP as a list of identiﬁed
cosmic-ray muon hierarchies and a list of identiﬁed test-beam particle hierarchies.

18

This “consolidated” reconstruction is a reﬁnement of the two-pass approach pre-
viously documented.

3.1 PandoraCosmic

The PandoraCosmic algorithm chain was developed to provide a highly eﬃcient
reconstruction of cosmic-ray muon trajectories. Following the initial track-like clus-
tering and particle-creation algorithms, any remaining hits are used to seed and
grow shower particles. Parent track particles, representing the muons, are linked
to child shower particles, representing Michel electrons or delta rays. The muons
are assumed to be downward going, so their primary vertices are placed at their
highest reconstructed y coordinates.

Cosmic rays arrive throughout the detector readout window. As previously
mentioned, all hits passed to the pattern recognition are placed assuming that they
correspond to a particle arriving at t0 = ttrigger. For cosmic rays, this can result
in a shift in the drift coordinate at which their hits are placed. For trajectories
contained within a single drift volume, there is a constant oﬀset in the drift time
coordinate. This oﬀset may place the hits outside of the physical drift volume, and
this is useful information for tagging particles that are not the triggered test-beam
particle.

The ProtoDUNE-SP detector has four adjacent volumes (the two central drift
volumes and the two outer dummy volumes), which gives the potential for cosmic-
ray muons to cross between volumes, and this provides new information and a
new challenge. The hits from one muon (arriving at a time oﬀset from the trigger
time) will be shifted in each volume. But, as the drift direction alternates between
adjacent volumes, their drift coordinates will be shifted in opposite directions. In
the reconstruction, each drift volume is initially processed in isolation, resulting in
separately reconstructed 3D particles in each volume. The separate particles are
shifted by equal amounts from the cathode, but the direction of the shift alternates
between adjacent volumes.

By identifying the relevant reconstructed particles in each drift volume, based
on their directions and relative locations in the y-z plane, it is possible to identify
the arrival time of the underlying particle, and so correct the drift coordinates
for the associated hits. Shifting the particles by equal amounts3 (in appropriate
directions) in the drift coordinate should yield a single trajectory that is continuous
in both its position and direction across the boundary between drift volumes. The
separate component particles can then be stitched together. The t0 corrections
identiﬁed by this stitching process allow for a single coherent 3D particle trajectory
to be reconstructed, as demonstrated in Fig. 4. Performance metrics assessing the
stitching performance and a discussion of how the SCE aﬀects the measured t0
are presented in Sec. 5.1.

3There is some tolerance in these shifts between the two track segments to allow for an asym-
metric SCE or slight imperfections in the track reconstruction.

19

Fig. 4: A sketch of the stitching procedure showing a cosmic-ray muon crossing
from top-to-bottom in the (x,y) projection. The two initial reconstructed particles
(red and blue) have been independently reconstructed in the two central drift
volumes. Based on pointing information and consistent y-z coordinates, they have
been identiﬁed as parts of the same cosmic-ray muon and merged to form the
black particle after applying a shift in drift position to each of the two initial
reconstructed particles.

3.2 PandoraTestBeam

The PandoraTestBeam algorithm chain is a modiﬁed version of the PandoraNu
chain presented in Ref. [8]. This chain focuses on identifying an interaction vertex,
and reconstructing the individual track-like and shower-like particles that emerge
from this point. Many of the algorithms are shared with the PandoraCosmic chain,
but the vertex identiﬁcation algorithms are speciﬁc to this chain, and there is a
more sophisticated treatment of electromagnetic showers. The chain concludes
with algorithms to build a hierarchy, representing the particle ﬂow in the interac-
tion. The hierarchy is initially built under the preexisting neutrino hypothesis: a
parent particle has child particles that represent the ﬁnal-state particles emerging
from the interaction point, and these may themselves have further child particles.

PandoraTestBeam diverges from PandoraNu only in its ﬁnal stages, after an
initial hierarchy of particles has been constructed. A new test-beam particle cre-
ation algorithm reorganises the hierarchy as appropriate for the interaction of an
incoming charged test-beam particle. Particles initially reconstructed as emerging
from the interaction vertex are reconsidered and the particle that is most con-
sistent with actually being an incoming particle is identiﬁed. The reconstructed
placeholder parent particle is replaced with this identiﬁed primary beam particle,
which has both reconstructed start and interaction vertices. The parent-child links
in the hierarchy are repackaged to represent the newly-identiﬁed particle ﬂow. Fig-
ure 5 shows an example reconstructed particle hierarchy for a simulated test-beam
proton interaction.

yxCathodeAPA planeAPA planeDrift directionCosmic-ray muon trajectoryReconstructed track in left drift volumeReconstructed track in right drift volumeStitched track20

Fig. 5: An example of the 2D reconstruction output for a triggered test-beam
particle. The particle hierarchy has been reconstructed to reﬂect the presence of
an incoming track-like parent particle. The parent particle (red), child particles
(blue) and subsequent child particles (green) have been separately highlighted.

3.3 Consolidated Reconstruction

A detector readout window contains energy deposits from a number of cosmic
rays, and perhaps from beam halo particles and a triggered beam particle. The
aim of the Pandora consolidated reconstruction approach is to have one process
that intelligently uses the PandoraCosmic and PandoraTestBeam algorithm chains
so as to provide a clear and easy-to-interpret reconstruction output, with no double
counting of any input hits. The output is a number of tagged reconstructed cosmic-
ray particle hierarchies and a number of tagged reconstructed test-beam particle
hierarchies. A ﬂow diagram illustrating the consolidated reconstruction approach
is shown in Fig. 6 and the following sections describe the diﬀerent parts of this
combined workﬂow.

3.3.1 Cosmic-Ray Muon Reconstruction, Stitching and Tagging

In the ﬁrst step, hits from the four drift volumes are processed separately using
the PandoraCosmic chain. The reconstructed particles from each drift volume then
pass through the track stitching algorithm to fully reconstruct those particles that
traverse neighbouring drift volumes.

In the next step, the individual cosmic-ray hierarchies are evaluated, and any
hierarchies that represent clear cosmic-ray muons are tagged as complete, and
removed from subsequent reconstruction steps. At this stage of the reconstruction,
any hits from a triggered test-beam particle will also have been processed by the
PandoraCosmic algorithm chain. It is important to ensure that these hits are not

Track (p), Parent Beam Particle Shower (ɣ), Daughter of Parent Beam ParticleTrack (p), Daughter of Parent Beam ParticleTrack (𝜋+), Daughter of Parent Beam ParticleTrack (p), Daughter of Primary pShower (ɣ), Daughter of Primary 𝜋+Shower (p,ɣ), Daughter of Primary pTrack (𝜋+), Daughter of Primary pw, wire positionx, drift positionParent Beam Particle Interaction Vertex21

Fig. 6: Outline of the Pandora consolidated reconstruction. The PandoraTestBeam
and PandoraCosmic algorithm chains run on the same hits in a given slice (a
region of the detector containing hits originating from a single parent particle
interaction) and yield two reconstruction outputs that can be compared and the
optimal reconstruction selected.

removed in this step, so that they can later be processed by the PandoraTestBeam
chain. Three distinct checks are applied and a reconstructed particle hierarchy is
tagged as a clear cosmic-ray muon hierarchy if any of the following are satisﬁed:

– Any hits in the reconstructed particle (placed assuming arrival at the beam
trigger time) fall outside of the physical drift volume boundary, as illustrated
in Fig. 7.

– The reconstructed particle was stitched across the cathode or an APA plane
and the diﬀerence between the reconstructed t0 and the beam trigger time
exceeds 6.2 µs, corresponding to a shift of 1 cm in drift position in the stitching
process.

– The reconstructed particle crosses the top and bottom boundaries of the de-

tector.

Reconstructed particle hierarchies tagged as clear cosmic-ray muons are set
aside to form one part of the consolidated reconstruction output. The hits that
form these clear cosmic-ray muon hierarchies are not considered in the remaining
steps of the reconstruction.

3.3.2 Event Slicing

The hits remaining after the removal of the clear cosmic-ray muon hierarchies
are analysed further. The aim is to divide up the hits into slices, where each
slice represents an individual true particle hierarchy. For instance, one slice might

Input hitsTag cosmic-ray muonsClear cosmic-ray muonsRemaining hitsPandoraCosmicPandoraTestBeamIdentify test-beam particles Remaining cosmic-ray muonsTest-beam particles3D slicingPandoraCosmic22

(a)

(b)

(c)

Fig. 7: The reconstructed output using the PandoraCosmic algorithm chain in (a)
3D, (b) the x-y plane and (c) the x-z plane for a simulated event in ProtoDUNE-
SP. For illustrative purposes, only hits appearing in the beam-side central drift
volumes in ProtoDUNE-SP have been reconstructed. Particles in red are deemed
to be out of time, as they appear outside the physical boundary of the drift volumes
because no oﬀset in the drift position has been applied. Particles in grey are those
deemed to be in time. Out-of-time particles are tagged as cosmic-ray muons.

ideally represent a cosmic-ray muon (including delta-rays and a possible Michel
electron), one might represent a beam halo interaction and one might represent a
triggered test-beam particle interaction.

A technical detail is that the four drift volumes can now be combined within
Pandora. This is because the out-of-time hits have been removed by this stage, so
the remaining hits can be considered in the context of one “global” drift volume.
This volume extends to cover the space occupied by the constituent drift volumes,
and any uninstrumented regions at cathode or APA boundaries are registered as
detector gaps.

In order to perform the slicing in 3D, a subset of algorithms based on the
PandoraTestBeam chain are run, but (for speed) the ﬁnesse of vertex identiﬁcation
and building particle hierarchies is neglected. All that is required is that groups
of hits are associated in 3D, and separated from groups originating from diﬀerent
primary particles. By applying this fast reconstruction, correlations across the
three input views are considered when dividing up the event into separate slices.
This approach is more powerful than dividing up each view independently. An
example of the slicing procedure is shown in Fig. 8. The output of the slicing
algorithm is a list of hits produced for each reconstructed slice, and all hits that
were input to the slicing algorithm must be assigned to a slice. In the remaining
reconstruction stages the slices are processed separately.

3.3.3 Slice Identiﬁcation

After the event slicing, diﬀerent reconstruction hypotheses can be applied to each
slice. The idea is that, for each individual slice, the hypothesis that produces the

yxzyxzx23

(a)

(b)

(c)

(d)

Fig. 8: The eleven “slices” created during the reconstruction of a simulated 3 GeV/c
π+ ProtoDUNE-SP interaction after the removal of the clear cosmic rays. Fig-
ure (a) shows the 3D hits created by the ‘fast reconstruction’ used within the
slicing process, while ﬁgures (b), (c) and (d) show the 2D hits in the u, v and w
views respectively. Each unique colour represents a distinct slice, and the recon-
structed beam particle slice is shown in red.

most appropriate (“best”) reconstruction outcome can be selected. Each slice will
have exactly one outcome selected, and the consolidated event will be built from:
i) the clear cosmic-ray muon hierarchies and ii) one selected outcome for each
slice. The two hypotheses tested for ProtoDUNE-SP are the PandoraTestBeam
and PandoraCosmic chains. Each slice is therefore reconstructed independently
by the PandoraCosmic and PandoraTestBeam algorithm chains, providing two
possible reconstruction outcomes.

The next step is to select exactly one of the two diﬀerent reconstruction out-
comes for each slice and in ProtoDUNE-SP this decision is made using a BDT.
The following features are calculated for the two diﬀerent slice outcomes, and both
sets are used as inputs to the BDT:

– The number of reconstructed particles in the slice.
– The distance between the point at which the test beam is expected to enter

the detector and the closest 3D hit.

yxzw, wire numberx, drift positionw, wire numberx, drift positionw, wire numberx, drift position24

– The vertical distance between the top face of the detector and the closest

reconstructed 3D hit.

– The eigenvalues of the covariance matrix from a principal component analysis

of the reconstructed 3D hits.

– The opening angle between the principal axis of the reconstructed 3D hits and

the expected direction of the test beam.

These features are motivated by the fact that the entrance position and direc-
tion of the test beam is well understood. Cosmic-ray muons typically enter through
the top face of the detector and produce highly track-like topologies in the detector
in contrast to the typically more complex test-beam particle interactions.

A threshold is applied to the output score from the BDT and those slices
with scores exceeding the threshold are classiﬁed as test-beam particles, while
all remaining slices are classiﬁed as cosmic-ray muons. The PandoraTestBeam
reconstruction outcome is selected for all slices classiﬁed as test-beam particles,
while the PandoraCosmic reconstruction is chosen for all slices classiﬁed as cosmic-
ray muons.

Figure 9 shows the reconstruction output for a candidate 1 GeV/c π+ charge
exchange event in ProtoDUNE-SP data, where the test-beam particle has been
correctly distinguished from the cosmic-ray muon background. The zoomed view
shows that the parent π+ beam particle has been identiﬁed (purple, moving from
left to right) and correctly placed at the top of the reconstructed hierarchy, and
two π0 decay photons emanating from the primary interaction vertex have been
reconstructed (black and red) and added to the reconstructed hierarchy as child
particles. Alongside the 3D reconstructed output, this ﬁgure also shows the 2D
hits that form the reconstructed particles in the u, v and w views.

The ﬁnal consolidated event that is output from Pandora contains N cosmic-
ray muon hierarchies, consisting of clear cosmic-ray muons and those from slices
not passing the beam particle identiﬁcation, and M beam-particle hierarchies, one
from each slice passing the beam particle slice selection threshold.

4 Simulated and Experimental Data

Each event in simulation and data corresponds to one 3 ms readout window of
the detector, where the readout was initiated by the triggered test-beam particle.
In addition, a number of background particles of both cosmic-ray and test-beam
origin also traverse the detector, as shown in Fig. 2.

The test-beam particle generation uses a GEANT4 simulation of the beam-
line [12, 13]. The triggered test-beam particle is placed into the event with t0 =
ttrigger = 0 and other beam interactions are overlaid at random times, assuming
a uniform distribution, to give background beam interactions spanning the en-
tire 3 ms detector readout window. Cosmic rays are simulated using CORSIKA
v7.4 [23] and are generated over a 6 ms time range (centred on the trigger time)
in order to completely cover the entire 3 ms detector readout window. The simu-
lation of particle propagation and interaction in the ProtoDUNE-SP detector is
also performed by GEANT4, and the detector response simulation was performed
using LArSoft v08 27 01 [24]. The Pandora pattern recognition was performed
using LArPandoraContent version v03 15 02, which in turn depends on version
v03 03 02 of the Pandora SDK.

25

(a)

(b)

(c)

(d)

Fig. 9: The reconstruction output for a candidate 1 GeV/c π+ charge exchange
event from ProtoDUNE-SP data run 5387. Figure (a) shows the 3D reconstruction
output, highlighting the reconstructed particle hierarchy identiﬁed as the test-
beam particle interaction: the reconstructed beam π+ in purple comes from the
left before interacting to produce two visible reconstructed π0 decay photons in
red and black. Figures (b), (c) and (d) show the u, v and w view hits respectively
for the fully reconstructed event.

The experimental test-beam data samples considered in this article were col-
lected from August 2018 to December 2018. Due to time constraints, test-beam
data were collected only in the positive polarity mode at ﬁve diﬀerent particle
momentum settings: 1, 2, 3, 6 and 7 GeV/c. For this reason, only simulated inter-
actions at these same ﬁve momentum settings are shown in this article.

Both data and simulation events go through signal processing and hit ﬁnd-
ing stages, as described in Ref. [4]. The events are input into Pandora after the
reconstruction of hits from the signals identiﬁed on the detector readout wires.
The average time taken to reconstruct a full ProtoDUNE-SP event with Pandora
using the LArSoft framework is approximately 40 s on an Intel Core Processor
(Broadwell) 2.3 GHz CPU while using an average of 2.8 GB of memory.

yxzw, wire numberx, drift positionw, wire numberx, drift positionw, wire numberx, drift position26

5 Cosmic Ray Reconstruction Performance

The performance of the event reconstruction is ﬁrst evaluated using the simulation
and then compared to the experimental data. The method presented here to evalu-
ate the performance of ProtoDUNE-SP event reconstruction mirrors the approach
used in MicroBooNE [8]. This involves matching Monte-Carlo (MC) particles with
reconstructed particles based on the number of shared hits, which are those hits
common to the reconstructed and true particles.

Selection criteria are applied to ensure that the MC particles are “recon-
structable” and can be included in the performance metrics. The MC particles
are required to produce at least 15 hits in the detector, with at least ﬁve hits in
at least two of the three readout views. Furthermore, MC particle hits produced
by non-primary neutrons, and photons produced by track-like primaries, that de-
posit energy a long way from the primary particle are removed from the matching
criteria.

Matches between reconstructed and MC particles are made on a per-event
basis by ﬁnding the match involving the largest number of shared hits between
the reconstructed and MC particle. Once this match is made the reconstructed and
MC particles are declared unavailable, preventing further matches being made to
either particle. This process is then repeated for all remaining particles in the
event. At this stage all reconstructed and MC particles have at most one match.
Any remaining reconstructed particles that have no match are associated to the
MC particle (that by deﬁnition must already have a single match) with which they
share the most hits, irrespective of the number of matches the MC particle already
has.

Once the reconstructed particles have been matched to the MC particles, the

following metrics can be deﬁned for each matched pair:

– Eﬃciency: The fraction of MC particles that are matched to at least one
reconstructed particle. The Clopper-Pearson method [25] is used to calculate
the conﬁdence interval on eﬃciency measurements presented in this article.
– Purity: The fraction of hits in the reconstructed particle that are shared with

the MC particle.

– Completeness: The fraction of hits in the MC particle that are shared with

the reconstructed particle.

When MC particles are matched to reconstructed particles, matches are only
made if the purity of the match is greater than 50% in order to ensure that the
reconstructed particle is predominantly associated with a single MC particle. Fur-
thermore, a completeness of 10% is required in order to veto low-quality matches.
These cuts are not applied when reporting the completeness and purity of matches.

5.1 Simulation Reconstruction Performance

The left panel of Figure 10 shows the reconstruction eﬃciency for cosmic-ray
muons as a function of the total number of true hits produced by the particle
in the detector (including hits from delta-ray showers and Michel electrons). The
overall integrated reconstruction eﬃciency for cosmic-ray muons is 95.73 ± 0.03%.
The reconstruction eﬃciency increases as a function of the number of hits, rising

from 50% for 15 hits up to 99% for particles producing more than 400 hits. The
reconstruction ineﬃciency for particles producing fewer hits is due to cosmic-ray
muons being absorbed into larger neighbouring particles. This is more common
for cosmic-ray muons producing a small number of hits, but it is also possible for
large cosmic-ray muons if the surrounding topology is suﬃciently complex.

27

Fig. 10: Left: the reconstruction eﬃciency for simulated cosmic-ray muons as a
function of the true number of hits (summed over the three readout views) pro-
duced by the cosmic-ray muon. Right: the completeness and purity of the recon-
structed cosmic-ray muons.

The completeness and purity of the reconstructed cosmic-ray muons are shown
in right panel of Fig. 10, both of which have very clear peaks at one. These ﬁgures
show that 97.6% of reconstructed cosmic-ray muons have a purity greater than 80%
and 81.9% of reconstructed cosmic-ray muons have a completeness greater than
80%. The tail on the low side of the completeness distribution is caused by the
reconstruction splitting up a cosmic-ray muon track into two distinct particles.
Approximately 8% of the cosmic-ray muons are matched to two reconstructed
particles, meaning that the reconstruction failed to reconstruct the particle as
a single object. This can happen for a number of reasons, including failing to
stitch the tracks at the drift volume boundaries, crossing cosmic-ray topologies
and large delta-ray showers overlapping with with the muon tracks. The purity
is typically close to 100%, which indicates merging distinct cosmic-ray muons
together is unlikely.

It is possible to identify the time, t0, that a cosmic-ray muon enters the
LArTPC if the reconstructed particle was stitched between drift volumes by the
process discussed in Sec. 3.1 and shown visually in Fig. 4. The distribution of
the t0 residual, the diﬀerence between the reconstructed and true value of t0,
for stitched cosmic-ray muons is shown in Fig. 11. The dashed black histogram
shows the case where no space charge distortion was applied to the simulation
and the distribution is centred on zero, as expected. Once space charge is included
(the solid black distribution), a number of features become apparent when con-
sidering the cathode- (blue) and APA-stitched (red) components separately. The
APA-stitched distribution remains centred on zero because the charge deposited
close to the APA travels only a short distance and is unaﬀected by space charge
distortions. Conversely, charges drifting from the cathode are maximally aﬀected

210310410Number of Hits0.00.51.0Cosmic Ray Reconstruction Efficiency SimulationDUNE:ProtoDUNE-SP0.00.20.40.60.81.0Completeness or Purity0.00.20.40.60.81.01.2Fraction of EntriesCompletenessPurity SimulationDUNE:ProtoDUNE-SP28

since they travel the entire drift distance, resulting in a distribution that is shifted
by a few microseconds. The eﬀect of space charge is illustrated in Fig. 12, which
shows a diagram of a reconstructed cathode-stitched cosmic-ray muon compared
to the true trajectory. The bowing eﬀect results in an overestimation of the shift
in the drift direction, and hence the reconstructed t0. The magnitude of the SCE
varies across the LArTPC resulting in a broadening of the t0 residual distribu-
tion. Finally, the asymmetric nature of the space charge distortions at the cathode
causes a double-peak structure for cathode-stitched tracks, depending on whether
the particle crossed the cathode from positive to negative x or vice versa.

Fig. 11: The diﬀerence between the reconstructed and true t0 for simulated cosmic-
ray muons that have been stitched at either the CPA or APA with (solid black) or
without (dashed black) space charge distortions. The black distribution is shown
divided into the CPA- (blue) and APA-stitched (red) components. A time diﬀer-
ence of 20 µs corresponds to shift of about 3 cm in the drift direction.

In order to give context to the topologies that the reconstruction is faced
with at ProtoDUNE-SP, an estimate of the number of cosmic-ray muons passing
through the detector per event in simulation has been made. The number of re-
constructed cosmic-ray muons matched, via the procedure discussed at the start
of this section, to distinct cosmic-ray muon MC particles, i.e. that deposit more
than 100 hits in the detector, is shown as a function of the total number of dis-
tinct cosmic-ray muons on a per-event basis in Fig. 13. The distribution shows a
strong linear correlation, but the gradient is approximately 1.08, corresponding to
the aforementioned 8% of cosmic rays that were reconstructed as two particles.
However, it demonstrates that on average the cosmic-ray muons are well recon-
structed. The mean number of distinct cosmic-ray muons per event is 52 , while
the mean number of matched reconstructed particles to those cosmic-ray muons
is 56, with negligible uncertainties. These ﬁgures demonstrate that on a per-event
basis, cosmic-ray muons signiﬁcantly outnumber triggered test-beam particles.

20-10-01020s]m [0 - True t0Reconstructed t050010001500Number of Entries SimulationDUNE:ProtoDUNE-SPNo Space Charge EffectAll stitches (scaled)Space Charge EffectAll stitchesCPA onlyAPA only29

Fig. 12: A schematic diagram of how the space charge eﬀect causes distortions to
the reconstructed tracks in both the drift direction and the orthogonal directions.
For clarity, the amount of distortion has been exaggerated. The red and blue show
the tracks reconstructed in the two central drift volumes, while the black dotted
line represents the true trajectory of the cosmic-ray muon.

Fig. 13: The number of reconstructed cosmic-ray muons as a function of the number
of true cosmic-ray muons on a per-event basis. The cosmic-ray muons were required
to produce at least 100 hits in the detector.

5.2 Comparisons of Data and Simulation

Reconstruction metrics for cosmic-ray muon data have also been evaluated. Fig-
ure 14 shows the number of reconstructed particles tagged as distinct cosmic-ray
muons per event in ProtoDUNE-SP. For a cosmic-ray muon to be tagged as dis-
tinct it must deposit at least 100 hits in the detector. This cut is applied in order
to deﬁne a substantial, distinct signal in the detector. Furthermore, applying this
cut yields a minimum reconstruction eﬃciency of 90%, based on the simulated

yxCathodeAPA planeAPA planeDrift directionCosmic-ray muon trajectoryReconstructed track in left drift volumeReconstructed track in right drift volume020406080100120Number of Cosmic-Ray Muons020406080100120Number of Reconstructed Cosmic-Ray Muons050100150200250300350 SimulationDUNE:ProtoDUNE-SP30

eﬃciencies in Fig. 10, which ensures this metric gives an accurate reﬂection of the
true number of distinct cosmic-ray muons entering ProtoDUNE-SP.

Approximately 5% fewer cosmic-ray muons are reconstructed per event in data
than simulation, with the data distribution peaking at 51.8±0.1 and the simulated
distribution peaking at 54.9 ± 0.1. This could be due to an overestimation of the
cosmic ray ﬂux in the simulation. Preliminary studies show that additional geo-
metric selection criteria signiﬁcantly improve the agreement in the mean number
of reconstructed particles between data and simulation.

Fig. 14: The number of reconstructed distinct cosmic-ray muon particles per event
for data (black) and simulation (red). The cosmic-ray muons were required to
produce at least 100 hits in the detector.

Fig. 15: The reconstructed t0 distribution in ProtoDUNE-SP for cathode cross-
ing and anode crossing cosmic-ray muons obtained from the Pandora stitching
process in data and simulation. The distributions have been area normalised for
comparison. Figure reproduced from Ref. [4].

The distribution of the reconstructed t0 values for cathode crossing and anode
crossing cosmic-ray muons is shown in Fig. 15. The range of this distribution can
be predicted by considering the readout time window (−250 µs to 2750 µs) and
the time for charge to drift from the cathode to the APAs (2250 µs). The cathode-
crossing cosmic-ray muons have t0 values in the range −2500 µs to 500 µs: the
lower value is the start of the readout window minus the drift time, and the upper

020406080100Number of Reconstructed Cosmic Rays0.000.020.040.060.080.10Fraction of EventsSimulationDataDUNE:ProtoDUNE-SP3000-2000-1000-0100020003000s]m [0Reconstructed t0.000.010.020.030.040.05Fraction of eventsSimulationDataDUNE:ProtoDUNE-SP31

value is the end of the readout window minus the drift time. For APA-crossing
cosmic rays, the t0 values fall only within the readout window. Thus, the total
distribution spans the range −2500 µs < t0 < 2750 µs. Good agreement is seen
between data and simulation and the distributions fall within the expected time
window predicted above.

6 Test-Beam Reconstruction Performance

The reconstruction and identiﬁcation of the triggered test-beam particle is a key
part of the hadron cross-section analyses at ProtoDUNE-SP. This section evaluates
the performance on simulation and then provides comparisons between simulation
and experimental data. As described in Sec. 4, triggered test-beam particle inter-
actions were produced with beam momenta of 1, 2, 3, 6 and 7 GeV/c, and the full
events included additional beam halo particles and cosmic rays.

6.1 Simulation Reconstruction Performance

The reconstruction of the triggered test-beam particle end point is of particular
interest for cross-section analyses because it is critical to know where the particle
either interacted or stopped [26, 27]. The diﬀerences between the reconstructed and
true values for the end position coordinates of these particles are shown in Fig. 16
for 1 GeV protons and positively charged pions. The end point was corrected for
SCE distortions using the procedure described in Ref. [4] and the resulting distri-
butions are narrow and centred on zero, indicating good resolution and low bias.
The right distribution shows the diﬀerence between the reconstructed and true po-
sitions in 3D, where 68% of the beam particle end points are reconstructed within
2 cm of the true value.

Fig. 16: Left: the diﬀerence between the reconstructed and true end position of
1 GeV/c primary proton and charged pion test-beam particles shown for the x
(black), y (blue) and z (red) coordinates. Right: the three dimensional distance
between the reconstructed and true end points.

The eﬃciency to fully reconstruct triggered test-beam particles and to correctly
identify them as of beam origin has been studied. In addition to the full simulation

10-5-0510Reconstructed - True Position [cm]0.00.10.20.30.40.5Fraction of Entriesx coordinatey coordinatez coordinate SimulationDUNE:ProtoDUNE-SP + p Beam+peV/c G10246810Reconstructed - True Position [cm]0200400600800Fraction of Entries SimulationDUNE:ProtoDUNE-SP + p Beam+peV/c G132

(including the triggered test-beam particle, beam-halo particles and cosmic rays),
two additional simulated samples were used to understand the potential loss of
eﬃciency due to background particles. The cosmics removed sample has the cosmic
rays removed from the event and hence consists only of the triggered test-beam
particle and any beam-halo particles, and the cosmics and halo removed sample
further removes the beam-halo particles from the event, meaning only the triggered
test-beam particle remains.

Figure 17 shows six distributions that visualise the reconstruction performance
for the standard simulation (black), the cosmics removed sample (red), and the
cosmics and halo removed sample (cyan). Each column shows, from top to bot-
tom: the triggered test-beam particle reconstruction and identiﬁcation eﬃciency,
meaning that the particle was well reconstructed and correctly identiﬁed as being
the triggered test-beam particle; and the completeness and purity of the triggered
test-beam particle and subsequent hierarchy. The left column is for 1 GeV/c π+
interactions and the right column shows 1 GeV/c e+ events.

The top ﬁgures show the reconstruction and identiﬁcation eﬃciency for the
triggered test-beam particles as a function of the number of 2D hits they produce
in the detector (including hits produced by their interaction and decay products).
The eﬃciencies for the full simulation both increase as a function of the number of
hits and eventually plateau at ∼ 90% for charged pions and ∼ 95% for positrons.
Removing cosmic-ray muons from the simulation signiﬁcantly increases the eﬃ-
ciency over the whole range of the number of hits. At 1 GeV/c there are few beam
halo particles, so only a small eﬃciency increase is seen after the sequential re-
moval of the beam halo. As expected, the eﬃciency is approximately 100% after
the removal of all background particles, demonstrating that the performance on
the full simulation is limited by the physics of the interactions and complex over-
lapping topologies. Similar behaviour is seen for the other beam particle types
and the diﬀerent momentum setting values. The average reconstruction and iden-
tiﬁcation eﬃciency of the full simulation sample, for all particle types and beam
momentum settings, is given in Table 1 and shown graphically in Fig. 18. There
are more beam halo particles in the 6 and 7 GeV/c beam samples, which reduce
the eﬃciency for charged pions and protons because they can be hidden within a
beam halo positron shower. The eﬃciency remains high for high-energy positrons
since they produce very large electromagnetic showers.

The middle and bottom rows of Fig. 17 show the completeness and purity of
the reconstructed test-beam particle hierarchy, respectively. The four distributions
are peaked at, or close to, one, indicating that the triggered test-beam particle is
being reconstructed as a single, complete particle. Removing the cosmic-ray muons
signiﬁcantly improves both completeness and purity of the test-beam particle re-
construction. This improvement is expected as there are fewer hits to contaminate
the reconstructed beam slice, or to incorrectly split the reconstructed beam particle
in the slicing algorithm. Removing both cosmic-ray muons and beam halo parti-
cles enforces a purity of 100% as all possible sources of contamination have been
removed, and there is a small increase in the completeness. The eﬀect of removing
the cosmic rays is larger, which is to be expected as there are signiﬁcantly more
cosmic rays than beam halo particles, such that the slicing algorithm, a source of
incomplete triggered test-beam particles, is less active for events where cosmic-ray
muons have been removed irrespective of the presence of the second-order beam
halo eﬀect.

33

Fig. 17: Primary beam particle reconstruction and identiﬁcation eﬃciency (top
row) and the reconstructed particle completeness (middle row) and purity (bottom
row) for 1 GeV/c π+ (left column) and 1 GeV/c e+ (right column) beam. The black
distributions show the performance for the full ProtoDUNE-SP simulation, and
the red and cyan curves show events with no cosmic rays, and no cosmic rays and
no beam halo, respectively. In a number of places the red distribution is exactly
covered by the cyan points.

6.2 Comparison of Data and Simulation

In order to compare the triggered test-beam particle reconstruction and iden-
tiﬁcation eﬃciency between data and MC, a less strict deﬁnition of eﬃciently
reconstructed test-beam particles is used in comparison to the one described in
Section 6.1. The following selection is used to obtain the sample of events that are
highly likely to contain a beam particle, and hence form the denominator for the
eﬃciency calculation.

0500100015002000Number of Hits0.00.20.40.60.81.01.2Beam Particle Identification EfficiencyFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+peV/c G10500100015002000Number of Hits0.00.20.40.60.81.01.2Beam Particle Identification EfficiencyFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+eV/c eG10.50.60.70.80.91.0Completeness0.20.40.60.81.01.2Fraction of EventsFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+peV/c G10.50.60.70.80.91.0Completeness0.20.40.60.81.01.2Fraction of EventsFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+eV/c eG10.50.60.70.80.91.0Purity0.20.40.60.81.01.2Fraction of EventsFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+peV/c G10.50.60.70.80.91.0Purity0.20.40.60.81.01.2Fraction of EventsFull SimulationCosmics RemovedCosmics and Halo Removed SimulationDUNE:ProtoDUNE-SP Beam+eV/c eG134

Table 1: The reconstruction and identiﬁcation eﬃciency for the triggered test-
beam particle in ProtoDUNE-SP simulation for positrons, charged pions, protons
and charged kaons for diﬀerent beam momenta. Charged kaons are negligible in
number from 1 to 3 GeV/c. The simulated events include the triggered test-beam
particle, beam halo particles and numerous cosmic rays.

Momentum
[GeV/c]

Positrons (cid:0)e+(cid:1)

Reconstruction Eﬃciency [%]

Pions (cid:0)π+(cid:1)

Protons (p) Kaons (cid:0)K+(cid:1) Muons (cid:0)µ+(cid:1)

1
2
3
6
7

88.0+0.2
−0.2
89.9+1.2
−1.3
90.5+1.1
−1.2
90.9+0.9
−1.0
92.1+1.0
−1.1

86.1+0.6
−0.6
87.3+1.3
−1.5
87.5+0.5
−0.5
78.8+0.6
−0.6
75.3+0.9
−1.0

84.1+0.6
−0.6
86.8+1.9
−2.1
86.1+1.1
−1.2
78.9+1.8
−1.9
73.8+2.6
−2.8

–
–
–
80.7+2.5
−2.7
78.3+3.4
−3.8

88.6+2.1
−2.5
100.0+0.0
−9.2
94.0+2.2
−3.1
94.0+2.2
−3.5
85.7+5.5
−7.6

Fig. 18: The beam particle identiﬁcation eﬃciency for the test-beam particle in
ProtoDUNE-SP simulation for diﬀerent beam momenta. Data was not collected
at 4 GeV/c or 5 GeV/c, so no entries are shown for these momenta. For clarity,
antimuons are not shown due to their large statistical uncertainty.

Data:
1. The beam trigger is active.
2. A single track is reconstructed in the beam monitors immediately upstream

of ProtoDUNE-SP.

3. The detector high-voltage is stable at -180 kV.
4. The readout electronics on the beam-side of the detector are active.
5. There are at least 10 3D hits in the region where the beam particle enters
the detector. These 3D hits are reconstructed as part of the disambiguation
procedure described in Sec. 3, not by Pandora.

Simulation:
1. There is a triggered test-beam particle in the MC particle hierarchy
2. There are at least 10 3D hits in the region where the beam particle enters

the detector.

02468Beam Momentum [GeV/c]020406080100 Beam Particle Identification Efficiency [%]Particle TypePositronsCharged pionsProtonsKaons SimulationDUNE:ProtoDUNE-SP35

The eﬃciency is then deﬁned as the fraction of the selected events with a recon-
structed beam particle hierarchy.

There are some limitations in the ability of the beam instrumentation alone
to give the unambiguous particle identiﬁcation required to calculate the denomi-
nator of the reconstruction and identiﬁcation eﬃciency. Pions and antimuons are
not distinguished, and since triggered test-beam charged pions can decay in the
beamline to antimuons, they are included as a joint sample. For the 6 and 7 GeV/c
samples, positrons, charged pions and antimuons can not be distinguished, and are
hence not included in the comparisons.4 A summary of the momentum settings
used for data and MC comparisons is as follows: π+/µ+ from 1 to 3 GeV/c, e+
from 1 to 3 GeV/c, p from 1 to 7 GeV/c, and K + for 6 and 7 GeV/c.

Two additional simulation samples were produced to investigate the eﬀect of

potential systematic uncertainties.

1. The SCE-oﬀ sample does not have a simulation of the space charge eﬀect.
It gives an estimate of potential eﬃciency mismodelling due to diﬀerences in
the SCE between data and MC. Since a sample with increased SCE was not
available, the eﬃciency diﬀerence from using the SCE-oﬀ sample was used to
produce a symmetric band around the standard simulation eﬃciency values.
2. A sample with the beam halo component reduced by 15%. This sample was
motivated by Ref. [13] that shows that the MC overestimates the beam trigger
rate, and hence the event pileup. The diﬀerence between the eﬃciency mea-
sured from the standard simulation and this sample was taken as a symmetric
systematic uncertainty centred on the standard simulation eﬃciency.

Furthermore, to account for potential diﬀerences in the 3D hit ﬁnding between
data and MC, the selection criterion requiring 10 3D hits in the region where
the beam enters the detector was varied for the simulation to 8 and 12 and the
change in eﬃciency was taken as a systematic uncertainty, giving the higher and
lower limits on the systematic uncertainty band, respectively. This variation only
has a signiﬁcant eﬀect for the 1 GeV/c sample because the low energy particles
produce fewer hits than those at higher energies. The total systematic uncertainty
is calculated as the quadrature sum of the aforementioned individual systematic
uncertainties.

Figure 19 shows the reconstruction and identiﬁcation eﬃciency for triggered
test-beam charged pions, positrons, protons and kaons as a function of the beam
momentum setting. The simulation is shown with statistical uncertainties (darker
red) and the quadrature sum of statistical and systematic uncertainties (pale red).
Agreement is seen between the data and simulation and any discrepancies
are within 5%. As expected, the lowest eﬃciency is seen at 1 GeV/c where the
particles deposit the least energy in the detector. In particular, 1 GeV/c protons
are the most diﬃcult to reconstruct since they travel the shortest distance within
the detector.

The fraction of events with a reconstructed beam slice for the pion/muon
sample is slightly overestimated in MC compared to data. A number of factors
could cause this behaviour. The SCE is underestimated in the simulation [4],
which means that the reconstructed beam slices are slightly easier to identify in

4Physics analysis is possible as positrons are reconstructed as showers and can be easily se-
lected. However, calculation of the absolute eﬃciency in data is not possible.

36

Fig. 19: The triggered test-beam particle reconstruction eﬃciency for ProtoDUNE-
SP as a function of the beam momentum in data and simulation, for charged pions
and antimuons (top left), positrons (top right), protons (bottom left) and charged
kaons (bottom right). The pale red simulation band shows the total uncertainty
and the statistical-only uncertainty is shown in dark red.

the simulation. Furthermore, the ratio of muons to pions can diﬀer between data
and MC but it is not possible to distinguish these two types of particles due to their
similar masses, and a diﬀerence in the reconstruction eﬃciency between pions and
muons will induce a data vs MC discrepancy. Finally, in the experimental data,
there is a higher probability that beam pion and muon tracks will be broken at
the boundary between the ﬁrst two APAs due to the presence a malfunctioning
electron diverter [4] that distorts the electric ﬁeld, which could cause a small
reduction in eﬃciency. Newer versions of the simulation will account for these
three eﬀects. However, small diﬀerences in the integrated eﬃciency between data
and MC do not have a big impact for the cross-section analyses because the overall
normalisation cancels in the cross-section calculation.

7 Conclusions

A summary of Pandora, a pattern-recognition software package, has been pre-
sented alongside relevant modiﬁcations allowing it to be applied to simulated and
experimental data interactions in the ProtoDUNE-SP LArTPC detector. Pandora
is the primary event reconstruction used in all ProtoDUNE-SP physics analy-
ses and enables the measurement of hadronic cross sections on liquid argon, the
primary physics goal of the experiment. The performance of Pandora has been
extensively evaluated for simulated charged test-beam and cosmic-ray interactions

123Beam Momentum [GeV/c]0.00.20.40.60.81.01.2 Beam Particle Identification EfficiencySimulationDataDUNE:ProtoDUNE-SP Beam+m/+p123Beam Momentum [GeV/c]0.00.20.40.60.81.01.2 Beam Particle Identification EfficiencySimulationDataDUNE:ProtoDUNE-SP Beam+e1234567Beam Momentum [GeV/c]0.00.20.40.60.81.01.2 Beam Particle Identification EfficiencySimulationDataDUNE:ProtoDUNE-SPp Beam67Beam Momentum [GeV/c]0.00.20.40.60.81.01.2 Beam Particle Identification EfficiencySimulationDataDUNE:ProtoDUNE-SP Beam+K37

in the ProtoDUNE-SP detector. Several pattern-recognition metrics have been
evaluated enabling a comparison of data and simulation.

The eﬃciency to reconstruct the triggered test-beam particle and correctly
identify it as of beam origin exceeds 80% for the majority of particle types (e+,
π+, p, K +, µ+) and momentum setting combinations (1, 2, 3, 6 and 7 GeV/c). It
was also shown that the main cause of these ineﬃciencies arises from background
contamination from both cosmic and beam-halo sources. In background-removed
simulation samples the triggered test-beam particle reconstruction and identiﬁca-
tion eﬃciency is almost 100% in all cases. A comparison of data and MC shows
agreement within 5% for the reconstruction and identiﬁcation eﬃciency for dif-
ferent triggered beam-particle species across the beam momentum values, and
possible sources for the small observed eﬃciency diﬀerences were discussed.

Over the coming years, developments to the pattern-recognition are expected
from the introduction of new algorithms and the incorporation of deep-learning
techniques to drive some key decisions within the Pandora multi-algorithm ap-
proach. Examples include improved vertex ﬁnding, event slicing and hit classiﬁca-
tion. Whilst many of these new algorithms are being developed for the DUNE FD,
they will be tested on the ProtoDUNE-SP simulation and data. ProtoDUNE-SP
has been dismantled but a very similar upgraded detector called ProtoDUNE-HD
is under construction in the same cryostat, which is due to commence data taking
at the end of 2022.

Acknowledgements The ProtoDUNE-SP detector was constructed and operated on the
CERN Neutrino Platform. We gratefully acknowledge the support of the CERN management,
and the CERN EP, BE, TE, EN and IT Departments for NP04/ProtoDUNE-SP. This doc-
ument was prepared by the DUNE collaboration using the resources of the Fermi National
Accelerator Laboratory (Fermilab), a U.S. Department of Energy, Oﬃce of Science, HEP User
Facility. Fermilab is managed by Fermi Research Alliance, LLC (FRA), acting under Con-
tract No. DE-AC02-07CH11359. This work was supported by CNPq, FAPERJ, FAPEG and
FAPESP, Brazil; CFI, IPP and NSERC, Canada; CERN; MˇSMT, Czech Republic; ERDF,
H2020-EU and MSCA, European Union; CNRS/IN2P3 and CEA, France; INFN, Italy; FCT,
Portugal; NRF, South Korea; CAM, Fundaci´on “La Caixa”, Junta de Andaluc´ıa-FEDER,
MICINN, and Xunta de Galicia, Spain; SERI and SNSF, Switzerland; T ¨UB˙ITAK, Turkey;
The Royal Society and UKRI/STFC, United Kingdom; DOE and NSF, United States of
America. This research used resources of the National Energy Research Scientiﬁc Comput-
ing Center (NERSC), a U.S. Department of Energy Oﬃce of Science User Facility operated
under Contract No. DE-AC02-05CH11231.

References

1. A. Abed Abud et al. Design, construction and operation of the ProtoDUNE-
SP Liquid Argon TPC. JINST, 17(01):P01005, 2022. doi: 10.1088/1748-0221/
17/01/p01005. URL https://doi.org/10.1088/1748-0221/17/01/p01005.
2. B. Abi et al. Deep Underground Neutrino Experiment (DUNE), Far Detector
Technical Design Report, Volume I Introduction to DUNE. JINST, 15(08):
T08008, 2020. doi: 10.1088/1748-0221/15/08/T08008.

3. B. Abi et al. Deep Underground Neutrino Experiment (DUNE), Far Detector
Technical Design Report, Volume IV: Far Detector Single-phase Technology.
JINST, 15(08):T08010, 2020. doi: 10.1088/1748-0221/15/08/T08010.

38

4. B. Abi et al. First results on ProtoDUNE-SP liquid argon time projection
chamber performance from a beam test at the CERN Neutrino Platform.
JINST, 15(12):P12004, 2020. doi: 10.1088/1748-0221/15/12/P12004.

5. J. S. Marshall and M. A. Thomson. The Pandora Software Development Kit
for Pattern Recognition. Eur. Phys. J., C75(9):439, 2015. doi: 10.1140/epjc/
s10052-015-3659-3.

6. M.A. Thomson. Particle ﬂow calorimetry and the pandorapfa algorithm. Nu-
clear Instruments and Methods in Physics Research Section A: Accelerators,
Spectrometers, Detectors and Associated Equipment, 611(1):25–40, 2009. ISSN
0168-9002. doi: https://doi.org/10.1016/j.nima.2009.09.009.

7. J.S. Marshall, A. M¨unnich, and M.A. Thomson. Performance of particle ﬂow
calorimetry at clic. Nuclear Instruments and Methods in Physics Research
Section A: Accelerators, Spectrometers, Detectors and Associated Equipment,
700:153–162, 2013. ISSN 0168-9002. doi: https://doi.org/10.1016/j.nima.2012.
10.038.

8. R. Acciarri et al. The Pandora multi-algorithm approach to automated pattern
recognition of cosmic-ray muon and neutrino events in the MicroBooNE de-
tector. Eur. Phys. J., C78(1):82, 2018. doi: 10.1140/epjc/s10052-017-5481-6.
9. L. Breiman, J.H. Friedman, R.A. Olshen, and C.J. Stone. Classiﬁcation And

Regression Trees. Wadsworth, Stamford, 1984.

10. R. E. Schapire. The strength of weak learnability. Machine Learning, 5(2):

197–227, 1990. doi: 10.1007/BF00116037.

11. C. Cortes and V. Vapnik. Support-vector networks. Machine learning, 20(3):

273–297, 1995. doi: https://doi.org/10.1007/BF00994018.

12. N. Charitonidis and I. Efthymiopoulos. Low energy tertiary beam line design
for the CERN neutrino platform project. Phys. Rev. Accel. Beams, 20:111001,
Nov 2017. doi: 10.1103/PhysRevAccelBeams.20.111001.

13. A. C. Booth, N. Charitonidis, P. Chatzidaki, Y. Karyotakis, E. Nowak,
I. Ortega-Ruiz, M. Rosenthal, and P. Sala. Particle production, transport,
and identiﬁcation in the regime of 1 − 7 GeV/c. Phys. Rev. Accel. Beams, 22:
061003, Jun 2019. doi: 10.1103/PhysRevAccelBeams.22.061003.

14. B. Abi et al. The Single-Phase ProtoDUNE Technical Design Report.

arXiv:1706.07081 [physics.ins-det], 2017.

15. B. Abi et al. Long-baseline neutrino oscillation physics potential of the
DUNE experiment. Eur. Phys. J. C, 80(10):978, 2020. doi: 10.1140/epjc/
s10052-020-08456-z.

16. X. Qian, C. Zhang, B. Viren, and M. Diwan. Three-dimensional Imaging for
Large LArTPCs. JINST, 13(05):P05032, 2018. doi: 10.1088/1748-0221/13/
05/P05032.

17. C. Adams et al. Ionization electron signal processing in single phase LArT-
PCs. Part I. Algorithm Description and quantitative evaluation with Micro-
BooNE simulation. JINST, 13(07):P07006, 2018. doi: 10.1088/1748-0221/13/
07/P07006.

18. P. Abratenko et al. Neutrino event selection in the MicroBooNE liquid argon
time projection chamber using Wire-Cell 3D imaging, clustering, and charge-
light matching. JINST, 16(06):P06043, 2021. doi: 10.1088/1748-0221/16/06/
P06043.

19. D. Caratelli. Neutrino identiﬁcation with scintillation light in MicroBooNE.

JINST, 15(03):C03023, 2020. doi: 10.1088/1748-0221/15/03/C03023.

39

20. T. Yang. Calibration of calorimetric measurement in a liquid argon time

projection chamber. Instruments, 5(1), 2021. ISSN 2410-390X.

21. P. Abratenko et al. Measurement of space charge eﬀects in the MicroBooNE
LArTPC using cosmic muons. JINST, 15(12):P12037–P12037, 2020. doi:
10.1088/1748-0221/15/12/p12037.

22. Babak Abi et al. Deep Underground Neutrino Experiment (DUNE), Far De-

tector Technical Design Report, Volume II: DUNE Physics. 2020.

23. D. Heck, J. Knapp, J. N. Capdevielle, G. Schatz, and T. Thouw. CORSIKA:
A Monte Carlo code to simulate extensive air showers, 1998. Report Number
FKZA-6019.

24. E. D. Church. LArSoft: A Software Package for Liquid Argon Time Projection

Drift Chambers. arXiv:1311.6774 [physics.ins-det], 2013.

25. C. J. Clopper and E. S. Pearson. The use of Conﬁdence or Fiducial Limits
Illustrated in the Case of the Binomial. Biometrika, 26(4):404–413, 12 1934.
ISSN 0006-3444. doi: 10.1093/biomet/26.4.404.

26. Elena Gramellini. Measurement of the Negative Pion and Positive Kaon Total
Hadronic Cross Sections on Argon at the LArIAT Experiment. PhD thesis,
Yale U., 2018.

27. Elena Gramellini et al. Measurement of the (π−, Ar) total hadronic cross
section at the LArIAT experiment. arXiv:2108.00040 [physics.ins-det], 7 2021.

