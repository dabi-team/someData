Review
Open-source Radiative Modelling Tools for Extragalactic VHE
gamma-ray Sources

Cosimo Nigro 1

, Andrea Tramacere 2

2
2
0
2

l
u
J

7
2

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
5
2
5
3
1
.
7
0
2
2
:
v
i
X
r
a

Citation: Nigro, C.; Tramacere, A.

Open-source Radiative Modelling

Tools for Extragalactic VHE

gamma-ray Sources. Galaxies 2022, 1, 0.

https://doi.org/

Received:

Accepted:

Published:

Publisher’s Note: MDPI stays neutral

with regard to jurisdictional claims in

published maps and institutional afﬁl-

iations.

Copyright: © 2022 by the authors.

Submitted to Galaxies for possible open

access publication under the terms and

conditions of the Creative Commons

Attri- bution (CC BY) license (https://

creativecommons.org/licenses/by/

4.0/).

1

Institut de Física d’Altes Energies (IFAE), The Barcelona Institute of Science and Technology, Campus UAB, 08193
Bellaterra (Barcelona), Spain; cosimo.nigro@ifae.es

2 Department of Astronomy, University of Geneva, ch. d’Ecogia 16, CH-1290 Versoix, Switzerland;

andrea.tramacere@unige.ch

Abstract: In this review, we discuss various open-source software for modelling the broad-band emission
of extragalactic sources from radio up to the highest gamma ray energies. As we provide an overview
of the different tools available, we discuss the physical processes such tools implement and detail the
computations they can perform. We also examine their conformity with modern good software practices.
After considering the currently available software as a ﬁrst generation of open-source modelling tools, we
outline some desirable characteristics for the next generation.

Keywords: astrophysical jets; active galactic nuclei; gamma-ray bursts; radiative processes; open science;
reproducibility

1. Introduction

In the last two decades, the energy window in which active galactic nuclei (AGN) and
gamma-ray bursts (GRBs) can be observed has been extended towards high (E > 100 MeV)
and very-high (E > 100 GeV) energies [1–5]. The broad-band emission of extra-galactic
sources, from radio to gamma rays, is commonly modelled with the radiative processes of
non-thermal relativistic particles [6–8]. This modelling approach offers the promising prospect
to study astrophysical acceleration mechanisms and, ultimately, identify the sources of cosmic
rays [9]. Traditionally, once multi-wavelength (MWL) data are gathered and reduced, their
interpretation is performed with closed-source software1. In the years, the growing amount and
coverage of MWL data resulted in the production of several closed-source modelling software
with increasing complexity, all inevitably engendering the issue of reproducibility of results2.
Moreover, despite often implementing the same physical processes, these software were never
validated against each other, and only recently a systematic comparison of their results has been
publicly presented [10]. While appreciating that these tools forged the current understanding of
the emission of extra-galactic sources, we observe that their validation and the reproducibility
of their results remain inevitable limitations. In the context of the forthcoming era of high-
energy astrophysics, the limited accessibility of these closed-source software represent another
drawback. The next generation of gamma-ray observatories, as the Cherenkov Telescope Array
(CTA), will indeed provide open access to their data [11]. Preparing for this, astrophysicists

1

It is difﬁcult to establish if this software is proprietary, i.e. protected by a license and with limited distribution or
simply private, i.e. accessible without a license to a small group of developers. We therefore apply the more general
term closed-source, meaning it cannot be publicly studied, changed or distributed.

2 By reproducibility of results we mean the possibility for a user to download the software and the scripts associated
to a certain publication (and possibly the computational environment e.g. in the form of a container) and re-perform
the calculations in autonomy.

Version July 28, 2022 submitted to Galaxies

https://www.mdpi.com/journal/galaxies

 
 
 
 
 
 
Version July 28, 2022 submitted to Galaxies

2 of 23

have started to develop standardised data formats [12,13] and open-source analysis tools [14,15].
The amount of MWL data that the new observatories will make available in the future makes
the old closed-source modelling approach simply not sustainable, urging for it to be opened to
a wider number of astrophysicists. This introduces the necessity to provide modelling tools
with open-source licenses and adopting modern good software practices. In this review, we
present the outset of this shift in the modelling paradigm. We describe several open-source
software publicly available for interpreting the non-thermal emission of extragalactic jetted
sources. We focus our attention on tools capable to describe the highest-energy emission of
these sources. Our review has a strong bias towards AGN modelling since their emission up to
TeV energies is long consolidated while for GRBs this represents a more recent ﬁnding [4,5].
We also brieﬂy examine the capability of the presented frameworks to model jetted sources
of galactic origin (e.g. microquasars) characterised by the same radiative processes of their
extragalactic counterparts.

This review is thus structured. In Section 2, we provide a quick overview of the major
physical processes at play in extragalactic jetted sources, being their knowledge essential to
understand what is being implemented by the different modelling tools. Section 3 presents the
software publicly available, introducing the physical processes they model and their technical
speciﬁcations (e.g. language in which they are implemented, resources available, etc.). For
each tool, we also provide examples of its application. In Section 4 we critically review the
available tools and suggest some desirable characteristics for a future generation of open-
source modelling software. We close this review with some remarks on how to establish a more
reproducible process of physical modelling and interpretation.

2. Physical Background

This section is meant to provide a brief physical background to the understanding of the

astrophysical sources and physical processes modelled in each software.

2.1. Jetted extragalactic sources

The presence of relativistic jets is ubiquitous to radio-loud AGN and GRBs (and to some
galactic sources). Jets are generated in the environments surrounding accreting black holes
(BH), where collimated outﬂows of plasma can be launched with bulk velocities close to the
speed of light c [16,17]. The main differences between these two categories of extragalactic
sources reside in the velocity of the jet (Γ
100, with Γ bulk Lorentz factor of
the outﬂow), in the dissipation of energy along the jet, and in the luminosity and duration of
their emission.

AGN ∼

GRB ∼

10, Γ

(cid:12)

(cid:12)

(with M

AGN are galaxies characterised by strong nuclear activity, commonly associated to the
accretion onto a supermassive BH with mass MBH = 106–109 M
mass of the
Sun). Accretion efﬁciently converts gravitational energy in thermal radiation, with a range of
emission from infrared (IR) to X rays, and a total luminosity reaching up to 1046–1047 erg s−
1
[18]. The emission in radio-loud AGN extends from radio to gamma rays (up to few TeV in
some cases) and is dominated by the non-thermal radiation of the plasma ﬂowing in the jet. As
small plasmoids are observed streaming along the jet in the radio band [19], the non-thermal
emission is commonly attributed to a small region of the outﬂow. The so-called blazars represent
the class of jetted AGN most commonly observed at the highest energies. A small viewing
angle between the jet axis and the observer [20] results in a strong relativistic boosting of
their non-thermal radiation. Blazars show strong ﬂux variability, with time scales ranging
from minutes to decades [21,22], and high polarisation in the optical band [23]. Blazars can be
divided in two classes: BL Lacs, characterised by featureless optical spectra, and ﬂat spectrum
radio quasars (FSRQs), showing signiﬁcant line and thermal emission from hot gas orbiting
the central BH. The photon ﬁelds produced by line and thermal emitters, located at sub-pc

Version July 28, 2022 submitted to Galaxies

3 of 23

distances from the BH, should absorb via γγ pair production the gamma-ray spectra of FSRQs.
Due to the rare observations of these absorption features (1 object out of 10) [24,25], it is inferred
that the non-thermal emission region is located mostly at

pc scales.

GRBs are associated with the formation of a stellar-mass BH (MBH ∼

) following
the merger of compact objects or a catastrophic star collapse. The ensuing outﬂow of plasma
can be collimated in a jet [26], with particles accelerated in its progressive shocks. Non-thermal
emission occurs at two characteristic distances, both well under the pc scale, characterising two
different phases of the emission (prompt and afterglow) [3]. The afterglow phase is characterised
by the interaction of the shocked material with the external (or circumstellar) medium, that
results in the gradual decrease in the bulk Lorentz factor and in a fainting emission in some
cases detectable for days. GRB luminosities can achieve values of 1050–1052 erg s−

10 M

1.

(cid:12)

∼

2.2. Physical processes

The non-thermal emission spectrum of different types of extragalactic sources can be
described by a power law (PL) over a broad range of photon energies. This PL of photons is the
imprint of the PL energy distribution of the radiating particles, result of ﬁrst and second order
Fermi acceleration processes [27]. It is commonly assumed that particles are accelerated and
radiate in a ﬁnite region of the jet, that we will refer to as emission region. Being the radiation
emitted in a ﬁnite region moving at relativistic speeds, its intensity is relativistically boosted
by a factor depending on Γ and on geometry. If a simple spherical plasmoid is considered, as
1], is boosted by the fourth power of
in jetted AGN, the observed energy ﬂux, νFν [erg cm−
1
the Doppler factor δD =
β cos θ) , where β is the velocity of the outﬂow and θ the observer’s
Γ(1
viewing angle. For GRBs, being the emission region extended to the whole jet section, the
beaming pattern can be more complex [26, see Sect. 2].

2 s−

−

The spectral energy distribution (SED) of radio-loud AGN shows two main components:
a low-energy one, peaking in the IR to X-ray band, commonly attributed to synchrotron
radiation of relativistic electrons and positrons, and a high-energy component, peaking in
gamma rays, that can be either leptonic or hadronic in origin. In leptonic models, the high-energy
emission is due to inverse Compton (IC) scattering by e± [28] of target photon ﬁelds internal or
external to the emission region. In what is commonly referred to as synchrotron self-Compton
(SSC) scattering, the target photon ﬁeld is internal to emission region and is provided by the
synchrotron radiation of the very same accelerated e± [29]. In the so called external Compton
(EC) scenario, the photon ﬁelds target for Compton scattering can be provided either by the
AGN line and thermal emitters: accretion disk, broad line region (BLR), dust torus (DT) [30–32],
or by the synchrotron emission of other components of the jet [33,34], or even by the cosmic
microwave background (CMB) [35]. In hadronic models, on the other hand, the high-energy
emission is explained with the radiative processes of the secondaries originated in pp or pγ
interactions [10,36]. The soft photon ﬁelds target for IC or pγ interactions can also produce
absorption of the high-energy radiation via γγ pair production. The same absorption can occur
on the extragalactic background light (EBL) while the photons travel to Earth [37].

Given their very recent observations at the highest energies [4], the mechanisms of the
broad-band emission of GRBs are still under discussion. While some authors accommodate the
whole MWL emission, up to TeV energies, with synchrotron radiation [38], others observed the
presence of a second component at the highest energies, attributed, as in blazars, to SSC [39].
Hadronic models have also been suggested to accommodate the highest energy emission from
GRBs [40].

Assuming a particular physical scenario and tacking into account the corresponding
radiative processes, one can ﬁt the observed MWL SED (see e.g. Figures 1, 2, 3) and hence infer
the underlying particle energy distribution. The parameter space for these models is often
degenarate, with changes in different parameters giving rise to similar patterns in the observed

Version July 28, 2022 submitted to Galaxies

4 of 23

ﬂuxes. Time-resolved SED modelling, properly taking into account the interplay between
particles acceleration, cooling via radiative processes, and change of physical conditions in the
emission region, constitutes a powerful tool to identify the physical mechanism or parameter
responsible for a given observed emission. To obtain broad-band spectra at different times (see
e.g. Figure 4) it is necessary to solve a differential equation regulating the time evolution of the
underlying particle energy distribution [see e.g. 8, Eq. 7].

3. Open-source modelling tools

In this section we provide an overview of the open-source software publicly available to
model the broad-band emission of extragalactic jetted sources. We detail both their theoretical
background, list the physical processes they model, and offer an overview of their resources
and usage. In the following, we identify with the term validation the numerical comparison of
the results produced by a given tool with the output of another software or the reproduction of
results from the literature.

3.1. naima

Figure 1. Synchrotron (orange) and SSC (blue) models for the emission GRB 190829A computed with
naima. The shaded area represents the 68% conﬁdence interval obtained from the MCMC ﬁtting. Flux
measurements from Swift-XRT (black band), Fermi-LAT (green upper limit) and H.E.S.S. (red band) are
also displayed. Figure from [52], reproduced with permission of The American Association for the
Advancement of Science.

naima [41] is a python package designed to infer the non-thermal particle distributions
underlying an observed broad-band photon spectrum. naima represented the ﬁrst python
package modelling non-thermal radiative processes made publicly available. It is built entirely
in the ecosystem formed by NumPy [42], SciPy [43], and astropy [44,45] and is one of the
packages afﬁliated with the astropy project3. The packages forming this ecosystem provide
the foundations on which an increasing number of tools for astrophysics are being built. For
the calculation of the radiative processes, naima relies on a numerical approach: the observed
emission is computed by integrating the analytical functions representing or approximating a

3 https://www.astropy.org/afﬁliated/#afﬁliated-packages

10110310510710910111013Energy (eV)10-1210-1110-10E2dN=dE(ergs¡1cm¡2)T0+ [4.3, 7.9] hrsT0+ [27.2, 31.9] hrsGRB 190829ASynchICSSCSSC w/o cutoff limitVersion July 28, 2022 submitted to Galaxies

5 of 23

given emission process with the particle energy distribution. Both non-thermal leptons and
hadrons distributions can be considered. naima does not implement time evolution of the
particle energy distributions, but can accept as input an arbitrary energy distribution (such that,
for example, the result of a time evolution computed with another software can be considered).
naima implements both leptonic and hadronic radiative processes. Synchrotron radiation,
IC on isotropic photon ﬁelds, and non-thermal Bremsstrahlung radiation are available for
electrons. For protons, the photon spectrum produced by the decay of the neutral pion result
of pp interactions can be computed, though the spectrum of the secondary particles is not
computed. The only γγ absorption considered is the one on the EBL, following the model of
[46]. The code assumes co-moving densities of particles therefore it is inadequate to describe
extragalactic jetted sources such as blazars or GRBs, in which typically the emission region
moves at relativistic speed against a target (photon ﬁelds or other particles). The beaming
pattern due to the relativistic motion of the emission region is also not computed and it has to
be manually calculated by the user. There is no option to consider multiple emission regions.
Being the inference of the particle distribution underlying one or more radiative processes the
main objective of the package, routines for ﬂux points handling and SED ﬁtting are provided.
naima offers a wrapper to import its radiative models in sherpa [47,48], allowing the user to
use sherpa’s data handling and ﬁtting capabilities. Gammapy [15], a python package for the
analysis of gamma-ray data, includes a wrapper to the naima radiative models in its own source
code. Alternatively, a Markov chain Monte Carlo (MCMC) ﬁt can be performed interfacing
naima with emcee [49], as illustrated in [41] and in other examples in the documentation.
No validation of the radiative processes implementated in the package is provided in the
documentation or in [41].

naima has mostly been used to model galactic sources, especially supernova remnants or
pulsar wind nebulae (PWN). Nonetheless, for the simplest case of an emission region with
a simple geometry and moving at relativistic speed, the package can be adapted to model
jetted extragalactic sources (computing a ﬂux and boosting it a posteriori). This approach
was used for Mkr 421 in [51] and for GRB 190829A in [52]. The scripts using naima for the
interpretation of GRB 190829A, illustrated in Figure 1, are also available on GitHub4. In this
case, a spherical shell emission region is considered, with electrons accelerated by a forward
shock swiping material from a stellar wind or from the interstellar medium (ISM). Since naima
does not perform temporal evolution, a broken PL with an exponential cut-off is considered for
the electron distribution.

naima’s developement is hosted on GitHub5, where 8 contributors are listed. It follows
modern good software practices adopted by other python packages: it provides a documen-
tation hosted on Read the Docs6 and includes a test suite part of a Continuous Integration
(CI) system. naima can be installed via pip and conda. [41] constitutes the only reference
publication for the package.

4 https://github.com/Carlor87/GRBmodelling
5 https://github.com/zblz/naima
6 https://naima.readthedocs.io/en/latest/

Version July 28, 2022 submitted to Galaxies

6 of 23

3.2. GAMERA

Figure 2. Models for the broad-band emission from radio to gamma rays of OJ 287, for two datasets
observed during the years 2017–2020. The dotted-dashed and dashed line represent synchrotron and
SSC emission computed with GAMERA, the different colors represent different times of the electrons
distribution evolution. Optical / UV, X-ray, and gamma-ray ﬂux measurements are displayed with red,
blue, and magenta markers, respectively. Figure from [56], reproduced with permission of Astronomy
and Astrophysics.

Figure 3. MWL emission of PKS 1830-211 in different ﬂux states, modelled with GAMERA. The high-energy
component of the FSRQ emission is described with a combination of SSC and EC scattering on anisotropic
photon ﬁelds: disk (green line) and BLR (blue line), dominating. Figure from [55], reproduced with
permission of the authors and IOPPublishing.

GAMERA [53] is a C++ library providing a modular approach to the modelling of the emis-
sion of different types of sources, along with some tools for population studies. GAMERA

108101010121014101610181020102210241026ν (Hz)10−1510−1410−1310−1210−1110−1010−9νFν (erg cm−2  −1)SyncSSCTotal period = 183 day Segment-A108101010121014101610181020102210241026ν (Hz)10−1410−1310−1210−1110−1010−9νFν (erg cm−2  −1)SyncSSCTotal period = 225 day Segment-BVersion July 28, 2022 submitted to Galaxies

7 of 23

offers a python wrapper, gappa, returning the result of GAMERA’s computations as NumPy ar-
rays. As naima, GAMERA relies on a numerical approach for the radiative processes computa-
tion. Non-thermal electron and proton distribution can be considered and can be evolved
in time. It is possible to evolve the particle spectra considering cooling via all the radiative
processes implemented in the package, which are the same available in naima (synchrotron, IC,
Bremmsstrahlung for e± and decay of π0 from pp interactions). The numerical solution of the
particle transport equation is based on an algorithm that interprets the transport as an advective
ﬂow in energy space and solves it using a donor-cell advection algorithm. For constant energy
losses and no particle escape, GAMERA offers the possibility to use a semi-analytical method,
providing a faster computation. For Compton scatterinng, the full angular dependency of the
Compton cross section is considered, allowing to model the scattering of anisotropic photon
ﬁelds by anisotropic electrons. The effect of γγ absorption on anisotropic photon ﬁelds is also
modelled by the library. Several interacting emission regions can be considered. No validation
for the radiative processes computation is provided in [53]; though the pulsar wind nebula
model in [54] is reproduced, no numerical comparison of the SEDs is provided. GAMERA does
not directly implement data handling, nor provides wrappers to other ﬁtting packages. A
python script for SED ﬁtting is available in the documentation, but the model for ﬁtting has
to be manually modiﬁed by the user. GAMERA implements routines for ﬂux point7 simulation:
once an instrument response function (IRF) is provided, the observed ﬂux corresponding to a
speciﬁc radiative model can be obtained. Utilities representing the ﬁrst steps in a population
studies are provided with the library. In [53] it is shown how to generate a population of young
PWN in the Galaxy, though it is left to the user to compute their total emission.

GAMERA has been mostly employed for AGN modelling [55–57]. In Figure 2 we show
the model obtained with GAMERA ﬁtting the MWL emission of the BL Lac OJ 287 observed
during 2017–2020 [56]. The emission corresponds to an electron distribution with an injected
log-parabolic spectrum cooling via synchrotron and IC radiation. In Figure 3 we show instead
the application of GAMERA to model the highest energy component of the FSRQ PKS 1830-211
with EC scattering on photons produced by the BLR (anisotropic target photon ﬁeld).

GAMERA’s development is hosted on GitHub8, where 5 contributors are listed; its documen-
tation is hosted online9. No unit tests and no CI are setup. The C++ library is not distributed
with any package system and has to be manually downloaded from GitHub and built with
make. The python wrapper is not available via a standard package manager (pip, conda), a
static library has to be manually built by the user and appended to the search path for modules
in each python script.

3.3. JetSeT

JetSeT [59–61] is an open-source C/python framework to reproduce radiative and accel-
eration processes acting in extragalactic jets and galactic objects (beamed and unbeamed). Both
static and time-dependent modelling are implemented, allowing the user to ﬁt the numerical
models to observed data. JetSeT allows deﬁning several leptonic radiative scenarios: syn-
chrotron, SSC, EC on disk, BLR and DT photon ﬁelds, EC on the CMB. It also computes the γγ
absorption on the EBL models of [46,69,70]. Moreover, JetSeT models hadronic pp emission,
considering γ from π0 decay, and also the radiation from the secondaries of charged pions
(evolved to equilibrium). Neutrinos spectra result of the decay of these secondaries can also be
estimated. JetSeT incorporates template models, e.g. for the host galaxy and the big blue bump
(BBB) feature produced by the disk. The code implements a self-consistent temporal evolution

7 The energy ﬂux [erg cm−
8 https://github.com/libgamera/GAMERA
9 https://libgamera.github.io/GAMERA/docs/main_page.html

2 s−

1] measured by an instrument in a given energy bin.

Version July 28, 2022 submitted to Galaxies

8 of 23

of the plasma under the effect of radiative and adiabatic cooling, and both ﬁrst and second
order (stochastic) acceleration processes. JetSeT provides tools to handle observed data such as
grouping, deﬁnition of data sets, handling of upper limits and time ranges. All the data sets, the
output tables, and the produced SEDs can be returned as astropy tables with units. The model
ﬁtting can be assisted by a pre-ﬁt stage in which a phenomenological characterisation of the
SED is ﬁtted to the data (via power-law and log-polynomial ﬁt). The derived parameters, such
as spectral indices, curvatures, peak ﬂuxes and frequencies, are used to constrain the parameter
space of the synchrotron and SSC / EC scenarios. These constraints are taken into account in
the successive ﬁt stage, with the proper physical radiative models. From an implementation
point of view, JetSeT is fully object-oriented, with both inheritance and composition, and
provides a broad range of models, implemented inheriting from the BaseModel class. Models
can be combined together, using the FitModel class from the model_manager module, and then
plugged to a minimiser for ﬁtting. The main type of models are:

•

numerical models:

–

–
–

Jet class, handling both leptonic and hadronic (pp) emission for extragalactic jetted
objects, and the JetTimeEvol to perform temporal evolution of a leptonic plasma,
GalacticBeamed class for galactic jetted objects,
GalacticUnbeamed class for galactic objects without jets, such as PWN and SNR;

•

•

analytical models: handling the phenomenological models (e.g. power-law or log-polynomial
models) used for the pre-ﬁt stage. They can be additionally used to deﬁne user-deﬁned
analytical models to plug, via the model manager, to the ﬁtting routines;
template models: used to reproduce template of the galaxy emission or of the BBB, and also
used for the computation of the absorption on the EBL (with a dependency on redshift
and energy).

The parameters of the models are handled by a dedicated class which implements, via
composition and inheritance, complex and ﬂexible features. The parameters wrap astropy
Quantities, for easy interface with other astropy-based packages. Parameters can be linked via
mathematical expression, both within the same model or among different models. For example,
one can: deﬁne the magnetic ﬁeld as function of the blob size and position across the jet; the
BLR size as a function of the disk luminosity; or set an analytical dependency between the low
and high energy indexes of a broken PL particle distribution. Dedicated classes handle both
frequentist and bayesian model ﬁtting (see Figure 5, top panel). The frequentist model ﬁtting
class implements plugin to iminuit [63] and to the SciPy least square bound implementation.
The bayesian model ﬁtting can instead be performed using a MCMC sampler with a plugin
to emcee [49]. Best ﬁt SEDs and parameters, including MCMC results, can be stored to ﬁle.
A plugin to use sherpa and Gammapy is also implemented. The temporal evolution of the
leptonic plasma is implemented in the JetTimeEvol class. To follow the evolution of the
particle distribution, JetSeT proceeds through the numerical solution of a kinetic equation
based on the the quasi-linear approximation with the inclusion of a momentum diffusion term
in [64,65]. The numerical solution of the Fokker-Planck equation is obtained using the same
approach as [60], which is based on the method proposed by [66] and [67]. The temporal
evolution can connect together more than one region, allowing to simulate the acceleration and
radiative regions separately, injecting the particles from the acceleration to the radiative region.
The code allows to store particle distributions, SEDs, and light curves (with a user speciﬁed
sampling) and to convolve the light curves with the light crossing time through the emission
region. Each deﬁned model, including the models with temporal evolution, can be saved using
python’s pickling mechanism.

Version July 28, 2022 submitted to Galaxies

9 of 23

Figure 4. Top panel: time-resolved SEDs, computed with JetSeT, for a ﬂaring stage (red lines) followed by
a pre-expanding stage (blue lines) and an adiabatic expansion stage (orange lines) with βexp = 0.1. The
three bottom panels show the corresponding light curves at high energies, and in the radio at 5 and 40 GHz.
The red dashed lines mark the light-curve segment belonging to the ﬂaring stage and the orange vertical
dashed lines mark the beginning of the expansion, the orange line marks the expansion stage. Figure
adapted from [62].

JetSeT has been extensively used for modelling and ﬁtting radiative emission in blazars
both for BL Lacs and FSRQs. Temporal evolution capabilities have been used in a recent work
[62] to simulate the impact of the adiabatic expansion on radio to gamma-ray delays. In the
model in Figure 4 particles are initially injected and accelerated in an acceleration region,
where they undergo both acceleration and cooling. They then diffuse towards a radiative
region, where only radiative losses and adiabatic expansion take place. The effect of the
expansion, leading to a decrease in the magnetic ﬁeld, can be observed both in the SEDs (top
panel), showing a shift of the synchrotron self-absorption frequency, and in the light curves
(three bottom panels), showing the delays observed between gamma-ray and radio ﬂares. The
ﬂexibility of the code allows building complex and ﬂexible user deﬁned models, or plugins, as
demonstrated for the microquasars MAXI J1820+070 during the 2018 outburst [68]. The model
is composed of an irradiated disk with a Compton hump and a leptonic jet with an acceleration

1010101310161019102210251028E (eV)108101110141017102010231026  (Hz)102010181016101410121010108F   (erg cm2  s1)flarepre expansionexpansion0246810120246erg cm2 s1×1010flaregamma02468101202468erg cm2 s1×1035flareradio 5GHz024681012tobs (d)0246erg cm2 s1×1035flareradio 40GHzVersion July 28, 2022 submitted to Galaxies

10 of 23

Figure 5. Fitting MWL SEDs with JetSeT. Top panel: best-ﬁt of the Mrk 501 SED considering synchrotron
and SSC emission, the galaxy template and the absorption on the EBL. The gray band illustrates the
MCMC model posterior samples. Figure adapted from the JetSeT documentation. Bottom panel: best-ﬁt
model of the MWL emission of the microquasars MAXI J1820+070. The dashed lines represent the
individual components, the red line their sum. Figure from [68].

region and a synchrotron-dominated cooling region. Figure 5 (bottom panel) illustrates the
best ﬁt SED for this scenario obtained with JetSeT with the MWL data in [68].

1041011021051081011E (eV)108101110141017102010231026  (Hz)1013101210111010F   (erg cm2  s1)best fit model EBL corr.SSC no EBL corr.Synchost_galaxyMCMC posterior samplesMrk-501-ebl-abs108101110141017102010231026  (Hz)20resVersion July 28, 2022 submitted to Galaxies

11 of 23

Figure 6. γγ opacity for absorption on the BLR photon ﬁeld computed with agnpy. Left panel: validation
of agnpy result against the literature for a small viewing angle (θs = 0◦, blazar case). Right panel: internal
cross-check approximating, for large distances from the BH, the BLR as a monochromatic point source at
the BH position. A non-null viewing angle is considered in this case (θs = 20◦, radio-loud AGN case).
Figure from [71], reproduced with permission of Astronomy and Astrophysics.

JetSeT is hosted on GitHub10 and the documentation is hosted on Read the Docs11.
Continuous integration (CI) and continuous deployment (CD) are performed by GitHub
Actions. Test suites are performed for each new release, that are available via conda and
pip. Pre-releases, for source conda and pip, are hosted on GitHub12, and documented on
GitHub Pages13. Pre-releases can be easily installed using the script in the jetset-installer14
repository.

3.4. agnpy

agnpy [71] is a python package modelling the radiative processes in jetted AGN. As naima,
agnpy is entirely built in the python scientiﬁc ecosystem and is one of the packages afﬁliated
with the astropy project. As for the other packages, agnpy relies on a numerical approach
to compute the radiative processes of non-thermal electron distributions. Routines for time
evolution are not included in the package, though a module for the constraint of the spectral
parameters according to a simple parametrisation of the acceleration and radiation processes is
available. agnpy implements synchrotron radiation, SSC and EC on anisotropic (accretion disk,
BLR, DT) and isotropic (CMB) photon ﬁelds. Similarly to GAMERA, the full angular dependency
of the Compton cross section is taken into account, though only isotropic electron distributions
can be considered. γγ absorption on all the photon ﬁelds target for Compton scattering can
be computed (see e.g. Figure 6). Values for the opacity due to different EBL models [46,69,70]

10 https://github.com/andreatramacere/jetset
11 https://jetset.readthedocs.io/en/latest/
12 https://github.com/andreatramacere/jetset/releases
13 https://andreatramacere.github.io/jetsetdoc/html/index.html
14 https://github.com/andreatramacere/jetset-installer

10231025102710−1100101102103τγγabs.onsphericalshellBLR,r=1.1×1016cm<RLyα,µs=1agnpyFig.14,Finke(2016)10231025102710−610−510−410−310−2abs.onsphericalshellBLR,r=1.1×1020cm(cid:29)RLyα,µs6=1agnpy,fullcalculationagnpy,point-sourceapproximation102310251027ν/Hz−0.4−0.20.00.20.4τγγ,agnpyτγγ,ref−1Fig.14,Finke(2016)102310251027ν/Hz−0.4−0.20.00.20.4point-sourceapproximationVersion July 28, 2022 submitted to Galaxies

12 of 23

Figure 7. Fit of the MWL SED of Mrk 421 observed in [75], obtained wrapping the radiative provided
by agnpy within the classes for ﬂux points handling and model ﬁtting in Gammapy. Figure from [71],
reproduced with permission of Astronomy and Astrophysics.

are also included. The viewing angle θs of the observer to the jet axis is included among
the parameters of all the physical processes implemented, such that agnpy can be adopted
to describe radio-loud AGN, beside blazars. In its current state it is not possible to consider
multiple or complex emission regions beside the simple homogeneous sphere (blob). Utilities
for data handling and ﬁtting are not included in the package, a Gammapy wrapper is provided
instead. Living in the python scientiﬁc ecosystem, agnpy is seamlessly interfaceable with
the ﬁtting routines included in other tools such as sherpa, as shown in several examples in
the documentation and in [71]. In Figure 7, as an illustrative example, we show a ﬁt of the
MWL emission of Mrk421 obtained by wrapping agnpy with Gammapy. agnpy is thoroughly
validated by numerically checking the output of each radiative processes against results from
the main reference used for its implementation [7,31,72–74] and against JetSeT [71, see Sect.
4]. Examples of validation are illustrated in Figure 6 (left panel) and in Figure 10. Additional
internal consistency checks are implemented: for example EC spectra and γγ opacities are
compared against an approximation considering the target photon ﬁelds as a monochromatic
point source (see e.g. Figure 6, right panel). Deviations well within 30% are achieved when
comparing against the literature and against JetSeT, when the same physical assumptions
are considered. Differences within a factor 2 are instead obtained when comparing against
processes implemented with different assumptions (e.g. when comparing against the EC
implemented in JetSeT). agnpy is the ﬁrst non-thermal modelling tools openly presenting
such detailed numerical comparisons and integrating them in its test system. agnpy has been
used for modelling blazars, especially FSRQs thanks to its solutions for EC scattering and γγ
absorption [76–78].

agnpy is hosted on GitHub15, where 6 contributors are listed; its documentation is hosted
on Read the Docs16. The package includes a test suite part of its CI system. Numerical
comparisons against literature reference and JetSeT results are embedded in this tests. CD is

15 https://github.com/cosimoNigro/agnpy
16 https://agnpy.readthedocs.io/en/latest/

1011101410171020102310261029ν/Hz10−1410−1310−1210−1110−1010−9νFν/(ergcm−2s−1)agnpy,totalagnpy,synchrotronagnpy,SSCMrk421,Abdoetal.(2011)Version July 28, 2022 submitted to Galaxies

13 of 23

Figure 8. Electron distributions and corresponding MWL SED computed with BHJet at several distances
along the jet axis of a FSRQ. The black line in the SED plot represents the sum of the emission at all
heights. Figure from [87], reproduced with permission of the author.

also implemented, with each tagged version of the software made immediately available via
pip and conda. [71] constitutes the release paper of the software.

3.5. BHJet

BHJet [79–81] is a set of C++ libraries modelling the emission of accretion / ejection systems
of different scales: from black hole X-ray binaries (BHXB) to radio-loud AGN. It comprises the
following libraries: Kariba, describing the radiative processes and their underlying particle
distributions and the AgnJet and BlJet libraries, modelling jets with different physical proper-
ties. AgnJet describes a mildly relativistic, pressure-driven, jet [82–84] while BlJet describes
a Blandford-Königl [85], magnetic-driven jet. A numerical approach is used for the radiative
processes computations and a semi-analytical approach for the jet modelling calculations. As
the library aims to describe also accretion systems, both thermal and non-thermal electron
distributions can be considered. No time evolution is implemented, but a steady-state solution
of the differential equation regulating the particle cooling can be evaluated, accounting for
adiabatic, synchrotron and IC losses only in the Thomson regime. The radiative processes
modelled by Kariba are: black body radiation, cyclotron radiation due to thermal electrons,
synchrotron radiation due to non-thermal electrons, inverse Compton (SSC and EC on the
AGN components). Successive scattering orders can be considered for the IC (i.e. the IC
radiation can be target for further IC scattering). For both jet classes a ﬂuidodynamic equation
representing the velocity proﬁle can be solved, allowing to obtain the particle density and
the magnetic ﬁeld at each height of the jet, and hence for the steady-state solution of the
cooling calculated. BHJet can therefore be used to evaluate the MWL emission from the entire
outﬂow. No routines for SED ﬁtting are provided but the array returned by the radiative
processes computations is compatible with XSPEC [86]. Some validation is provided for the
radiative processes and the jet modelling in [81]. The Compton spectra are benchmarked
against calculations of the compPS17 code, included in XSPEC. The results of the semi-analytical
modelling of the jet evolution (e.g. magnetic ﬁeld, electron density) are instead compared
against general-relativistic magnetohydrodynamics (GRMHD) simulations and it is observed
that BHJet can approximately reproduce the magnetic ﬁeld value and the particle density in the
case of a mildly-relativistic pressure-driven jet or in the case of a highly-relativistic magnetised
jet. Before its public release, previous versions of the software have been extensively used for

17 https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XSmodelCompps.html

10−1710−1610−1510−1410−13Momentum(erg*s/cm)10−610−410−2100102104106Numberdensity(#/cm3)0.32.234.156.088.0log10(z)(rg)10111014101710201023Frequency(Hz)104210431044104510461047Luminosity(erg/s)Version July 28, 2022 submitted to Galaxies

14 of 23

Figure 9. SSC emission computed with FLAREMODEL from a uniform emission region. SED with dashed
line are obtained using the numerical ray-tracing approach, solid ones are obtained with the numerical
integration considering a uniform particle distribution. Figure from [88].

binaries and AGN modelling, [see 81, and references therein]. To illustrate an application of
BHJet to compute the spectrum of a VHE source, we show in Figure 8 the electron distribution
and the MWL SED of a FSRQ computed for several distances along the jet axis.

BHJet is available in GitHub18, where 4 contributors are listed. No documentation is
provided, but few example scripts to reproduce the results in [81] are available. The library is
not distributed with any package system and has to be manually downloaded from git and
built with make, along with the example scripts. [81] constitutes the release paper.

3.6. FLAREMODEL

FLAREMODEL [88] is a python package modelling astrophysical synchrotron sources. Con-
trary to the uniform (spherical) emission regions considered in the other packages, FLAREMODEL
allows to consider inhomogenous spherical emission regions. The basic routines are written in
C with options for multi-threading and wrapped with a python interface integrated with NumPy,
but not with astropy. Differently than the other codes, FLAREMODEL employs ray-tracing, i.e.
the propagation of imaginary rays is followed through a region with changing physical condi-
tions, hence allowing to consider non-isotropic particle distributions in the emission region.
Both thermal and non-thermal electron distributions can be employed. Their time evolution
is modelled considering adiabatic and synchrotron losses, while IC cooling is not included.
Beside synchrotron radiation, also SSC emission can be computed. Multiple emission regions
can not be considered. A SED ﬁtting routine built on lmfit [89] is made available. Validation is
provided in [88] for the computations implemented in the package. The synchrotron emissivity
and absorption coefﬁcients are compared against those computed with the symphony code [91].
The synchrotron emission obtained by [90] for a sphere with power-law radial density and

18 https://github.com/matteolucchini1/BHJet

1012101410161018102010−210−1100νLν [norm.]10121014101610181020Frequency [ν]02040601-Ratio [%]Version July 28, 2022 submitted to Galaxies

15 of 23

magnetic ﬁeld is reproduced. A consistency check, illustrated in Figure 9, is performed for
the SSC from a uniform sphere, comparing the solution obtained with ray-tracing against the
numerical simpliﬁcation assuming a uniform particle distribution. Examples of time evolution
under synchrotron and adiabatic cooling are provided in [88]. The software was used in [92] to
model the synchrotron emission of Sgr A(cid:63).

FLAREMODEL is hosted on GitHub19, where 1 contributor is listed. The documentation
includes basic notebook tutorials20, reproducing the ﬁgures in [88], constituting the release
paper for the software. FLAREMODEL is distributed via pip.

4. Discussion and conclusions
4.1. Review of the current packages

We have examined in our review six packages modelling the non-thermal broad-band
emission of jetted extragalactic sources from radio to gamma rays. We brieﬂy consider also
their capability to describe galactic sources characterised by the same emission mechanisms.
In Table 1 we present a global overview of the physical processes implemented by each
software. All the tools provide leptonic synchrotron and SSC emission models. BHJet and
FLAREMODEL provide the most sophisticated calculations for these radiative processes, with the
ﬁrst taking into account the emission from the whole plasma outﬂow and several orders of IC
scattering, and the latter employing ray-tracing to consider a non-uniform emission region.
Having being used to model low-energy sources, BHJet and FLAREMODEL are also the only
libraries including thermal electron distributions. By considering the full angular dependency
of the Compton cross section, GAMERA can compute IC scattering with anisotropic electrons
and anisotropic target radiation ﬁelds. Similarly, agnpy provides IC scattering on anisotropic
radiation ﬁeld (with isotropic electrons though). Both GAMERA and agnpy can compute γγ
absorption on anisotropic photon ﬁelds, while naima and JetSeT provide only absorption
on the EBL. Regarding hadronic radiative processes, a description of the pp interaction is
implemented in naima, GAMERA and JetSeT, while none of the tools includes photo-hadronic
(pγ) emission models [10]. In naima and GAMERA, only the π0 decay in gamma rays is modelled,
while JetSeT models the decay of charged pions, computing the equilibrium distributions
of secondaries e± pairs and their radiation (synchrotron, IC, and Bremsstrahlung). JetSeT
also computes the spectrum of ν produced in pion decays. For hadronic interactions both
GAMERA and naima follow the parametrisation of [93], while JetSeT implements the one of [94].
GAMERA, JetSeT and FLAREMODEL can numerically solve the differential equation describing
the particles temporal evolution. Anyhow, while FLAREMODEL and GAMERA take into account
only the radiative cooling processes, JetSeT provides also ﬁrst and second order acceleration
process, adiabatic expansion, and the possibility to have a decoupled radiative and acceleration
regions. The remaining packages offer simpliﬁed alternatives: naima allows for a custom
particle distribution in input, agnpy offers a constraint of the model parameters based on a
simple parametrisation of the acceleration and radiation processes, and BHJet provides the
analytical solution of the differential equation at equilibrium. Concerning the type of sources
that can be modelled, except for naima, all the tools reviewed can be directly applied to describe
the emission of jetted AGN. naima, originally designed to model galactic high-energy sources,
can be used to model jetted sources only through the manual implementation of the beaming
pattern of the radiation. Incidentally, naima was the only package used to model GRB emission.
BHJet and JetSeT (through its plugins describing a microquasar or the blob expansion) are
the only software considering the extended jet emission. The ﬁt of a MWL SED with a tool
ascribing the whole emission to a ﬁnite jet region underestimates the emission below a certain

19 https://github.com/ydallilar/ﬂaremodel
20 https://ﬂaremodel.readthedocs.io/en/latest/index.html

Version July 28, 2022 submitted to Galaxies

16 of 23

frequency in the radio band, as this is typically measured with a large integration region.
As an example, one can see how the points below 1011 Hz in Figure 7 cannot be reproduced
assuming synchrotron radiation from a blob, while these points are properly modelled in
the microquasar model of JetSeT, in Figure 5. We notice that the problem of integrating the
non-thermal emission over a simple geometrical model of the jet has already been treated in
the literature [62,95–98] and it would be an important implementation in the tools. Among
the software considered, BHJet is the only one suited to describe non-jetted low-power AGN
(see the M81(cid:63) example in [81]). None of the tools considered can be applied to describe other
classes of extragalactic gamma-ray emitters, as starbust galaxies [99].

In Table 2 we instead examine the compliance of individual tools with good modern
software practices. We notice that naima, JetSeT, agnpy, and FLAREMODEL are the ones simulta-
neously providing test suites, proper documentation and distribution via package managers.
Though all the packages provide some degree of interface to ﬁtting routines, naima, JetSeT,
agnpy, and FLAREMODEL, due to their interface with the python scientiﬁc ecosystem, are also
the ones better usable in combination with modern python data-analysis tools and indeed
provide wrappers to other data-analysis packages. We observe that in many of the software
release papers, some degree of validation is provided, the most complete example being the
cross-validation performed for agnpy and JetSeT in the release paper of the former [71]. Start-
ing from the same set of model parameters, the SEDs obtained with the different software
are compared against each other and against a reference SED from the literature (see Fig-
ure 10). The other packages showed also a signiﬁcant commitment to validation, with BHJet
benchmarking the Compton computation against the compPS code and the quantities obtained
from the semi-analytical description of the jet evolution against GRMHD results. FLAREMODEL
instead validated the synchrotron computations against the symphony software and and against
the literature. Additionally, the SSC was internally checked comparing the ray-tracing and
the numerical solutions (see Figure 9). Among the tools examined, FLAREMODEL is the only
providing options for multi-threading (at C level). JetSeT is instead the only framework with a
speciﬁc class representing the model parameters. Having this object-oriented description of
the parameters of the physical model allows one to impose physical limits, link them, and ulti-
mately facilitates their wrapping with external packages (implementing their own parameters
handling).

4.2. Desiderata for future modelling packages

The number and quality of software reviewed illustrates that the shift in paradigm towards
an open-source modelling approach, described in the introduction, is already taking place. We
might consider the tools covered by this review as a ﬁrst generation of open-source modelling
tools. Therefore, after having reviewed the available software, we outline in this section what
would be the desiderata for the future generation of radiative modelling tools.

•
•

•

testing: for such complex numerical models test suites are mandatory;
validation: this constitutes the most fundamental point. If a software has to be provided
to a large community of astrophysicists, it is essential to provide a numerical validation
against other software, or against reference templates. For example, benchmark SEDs,
corresponding to a given physical scenario and a given set of model parameters, can be
generated and shared as validation templates. This has already been proposed in [71];
interfaceability: as proposed by [100], instead of several different packages one could
envision a library of interfaceable fundamental solvers, specialized, interconnectable, and
respecting the single-responsibility principle. An example of combined workﬂow could
be: obtaining the particle energy distribution as a result of the time evolution performed
with one of these solvers, and then obtain the corresponding broad-band SED using the
radiative processes of another solver. This would imply for the tools to be developed

Version July 28, 2022 submitted to Galaxies

17 of 23

Figure 10. An example of validation: synchrotron and SSC SEDs generated with the same model
parameters using agnpy and JetSeT. Both spectra are compared against a result from the literature [7].
Figure from [71], reproduced with permission of Astronomy and Astrophysics.

•

on a more ﬁne-grained level, delegating the high-level interface to separate modules.
Additionally, these basic blocks should have a minimal data / model interface, to facilitate
the exchange of products. For example, particles distributions or radiative ﬁelds could
use standardised speciﬁcations to interface with the classes handling them in the different
solvers. Similarly, ﬁnal products such as broad-band SEDs could be provided in the
form of standardised (e.g. FITS [101] or astropy) tables with quantities (allowing units
conversion). Table metadata could be used to store the model parameters (e.g. parameters
of the particle distribution, radius of the emission region, magnetic ﬁeld intensity, etc.).
Using standardised inputs and outputs, with a proper interface between the fundamental
solvers, will make the validation process smooth and secure. High-level interfaces should
ﬁnally orchestrate the fundamental solvers, linking the parameters of the basic blocks and
facilitating the interface to other frameworks;
data access: as already demonstrated by the tools in this review, by living in the same
computational ecosystem, modelling and data-analysis tools can be easily interfaced. The
interface to speciﬁc analysis software, and eventually to online services providing astro-
physical data, broadens the horizon of model ﬁtting, allowing for example combination
of data from different experiments, or from current and future generations of instru-
ments. Moreover, having access to the instrument reduced data through the data-analysis
packages would allow to perform a more accurate ﬁt of the physical model, for example
folding it with the instrument IRF and computing a Poissonian likelihood of the observed
and expected counts (as commonly done in X-ray and gamma-ray astronomy [102] with
simple analytical models, PL, log-parabola, etc.). Due to the current limitations, a χ2 ﬁt
is commonly performed to ﬂux points that are often computed making assumption on
the underlying shape of the photon spectrum and never provided with a matrix quan-
tifying their correlations. naima, agnpy, and JetSeT already demonstrate the possibility

1010101210141016101810−1410−1210−10νFν/(ergcm−2s−1)synchrotronagnpyFig.7.4,Dermer&Menon(2009)jetset10151017101910211023102510−1410−1210−10synchrotronself-ComptonagnpyFig.7.4,Dermer&Menon(2009)jetset10101012101410161018ν/Hz−0.4−0.20.00.20.4νFν,agnpyνFν,ref−1Fig.7.4,Dermer&Menon(2009)jetset101510171019102110231025ν/Hz−0.4−0.20.00.20.4Fig.7.4,Dermer&Menon(2009)jetsetVersion July 28, 2022 submitted to Galaxies

18 of 23

•

of forward-fold ﬁt of high-energy astrophysical data through their sherpa and Gammapy
wrappers21;
accessibility: we remark that making the code available online with a license it is not
sufﬁcient to make it properly accessible. Care has to be taken by developers to write a
proper documentation. The latter not only serves didactic purposes, for example it can be
easily used in hands-on tutorials, but plays the fundamental role of forming future users
or developers.

4.3. Conclusions

In this review we have presented the state-of-the-art of open source, reproducible, frame-
works modelling the radiative processes in extragalactic VHE gamma-ray sources. We have
highlighted the main features of the presented packages in terms of the physical processes
they implement, and in terms of the good software practices they comply with. We consider
these packages as a ﬁrst generation of software paving the road for a future generation of
frameworks realising a fully-reproducible modelling of high-energy astrophysical sources.
Before concluding, broadening the scope of our review, we would like to remark the following
points concerning physical interpretation:

1.

2.

3.

The current packages represent mostly single- or few-developers projects, with a strong
commitment and effort from few individuals, who are offering a scientiﬁc product to the
community, fulﬁlling the full chain from coding, to documentation and distribution;
despite the aforementioned efforts, the attitude to publish scientiﬁc article based on
accessible and reproducible models is not yet standard. Closed-source software, if used in
scientiﬁc publications, should at minimum be accessible in form of binaries, to allow the
astrophysical community to reproduce and validate what has been published;
even though the presented products reach high-quality standards, none of them covers the
entire panoply of physical processes, and a large overlap of features among the products
is present. In this sense, the most desirable solution would be an effort to produce a
library of interfaceable fundamental solvers, with a strong support from the community,
the large collaborations, and the editorial boards.

21 Both sherpa and Gammapy can read the PHA OGIP standard adopted to represents counts and IRF of X-ray
(https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html) and Gamma-ray
(https://gamma-astro-data-formats.readthedocs.io/en/latest/spectra/ogip/index.html) instruments.

Version July 28, 2022 submitted to Galaxies

19 of 23

Table 1. Physical processes implemented in the software reviewed.

software

sources

approach

particles

processes

temp. ev.

emission region

thermal

naima
GAMERA

JetSeT

agnpy
BHJet

PWN, SNR, GRB
PWN, SNR, AGN
microquasars
jetted AGN, PWN
microquasars, SNR
jetted AGN
binaries, AGN

FLAREMODEL

synch. sources

numerical
numerical

numerical

numerical
numerical
semi-analytical
numerical
ray-tracing

(cid:55)
(cid:55)

(cid:55)

(cid:55)
(cid:51)

(cid:51)

non-thermal
e±
p
(cid:51)
(cid:51)

(cid:51)
(cid:51)

(cid:51)

(cid:51)
(cid:51)

(cid:51)

(cid:51)

(cid:55)
(cid:55)

(cid:55)

leptonic

synch.

SSC EC

Brems.

hadronic
pp

(cid:51)
(cid:51)

(cid:51)

(cid:51)
(cid:51)

(cid:51)

(cid:51)
(cid:51)

(cid:51)

(cid:51)
(cid:51)

(cid:51)

(cid:51)(CMB) (cid:51)
(cid:51)
(cid:51)

(cid:12)

(cid:51)

(cid:51)(cid:63)
(cid:51)

(cid:55)

(cid:51)

(cid:55)
(cid:55)

(cid:55)

(cid:51)†
(cid:51)†

(cid:51)‡

(cid:55)
(cid:55)

(cid:55)

absorption
γγ
(cid:51)(EBL)
(cid:51)(cid:63)

(cid:55)
(cid:51)

(cid:51)(EBL)

(cid:51)(cid:63)
(cid:55)

(cid:55)

(only cool.)
(cid:51)

(acc. + cool.)
(cid:55)
(cid:55)

not speciﬁed
multiple uniform

multiple uniform
acc. + rad.
single uniform
whole jet

(cid:51)

(only cool.)

single
radial dep.

† pp interaction: computing only gammas from π0 decay.
‡ pp interaction: computation of radiation from secondaries of charged pions (pairs evolved in time to equilibrium) and of ν spectra.
(cid:12) full angular dependency of the Compton cross section: anisotropic electrons and anisotropic photon ﬁelds.
(cid:63) full angular dependency of the Compton or γγ cross sections: anisotropic photon ﬁleds.

Version July 28, 2022 submitted to Galaxies

Table 2. Compliance of software reviewed with modern good software practices.

software

language

license

documentation

installation

CI or test units

naima
GAMERA
JetSeT
agnpy
BHJet
FLAREMODEL

python
C++, python
C, python
python
C++
C, python

BSD-31
not speciﬁed
BSD-3
BSD-3
MIT2
BSD-3

Read the Docs
GitHub Pages
Read the Docs
Read the Docs
no
Read The Docs

pip, conda
make ﬁle
pip, conda
pip, conda
make ﬁle
pip

yes
minimal
yes
yes
no
yes

CD

no
no
yes
yes
no
no

https://opensource.org/licenses/BSD-3-Clause
2 https://opensource.org/licenses/MIT

20 of 23

1

Funding: This work was supported by the European Commission’s Horizon 2020 Program under grant
agreement 824064 (ESCAPE—European Science Cluster of Astronomy and Particle Physics ESFRI Re-
search Infrastructures), by the the ERDF under the Spanish Ministerio de Ciencia e Innovación (MICINN,
grant PID2019-107847RB-C41), and from the CERCA program of the Generalitat de Catalunya.

Conﬂicts of Interest: The authors are the main developers of the agnpy (C. Nigro) and JetSeT (A.
Tramacere) packages described in the review.

Abbreviations

The following abbreviations are used in this manuscript:

AGN
GRB
MWL
CTA
BH
IR
FSRQ
PL
SED
IC
SSC
EC
BLR
DT
CMB
EBL
MCMC
PWN
ISM
IRF
BBB
CI
CD
BHXB
GRMHD general-relativistic magnetohydrodynamics

Active Galactic Nucleus
Gamma-ray Burst
multi-wavelength
Cherenkov Telescope Array
black hole
infrared
Flat Spectrum Radio Quasars
power law
spectral energy distribution
inverse Compton
synchrotron self-Compton
external Compton
broad line region
dust torus
cosmic microwave background
extragalactic background light
Markov chain Monte Carlo
pulsar wind nebula
interstellar medium
instrument response function
big blue bump
continuous integration
continuous deployment
black hole X-ray binary

Version July 28, 2022 submitted to Galaxies

21 of 23

References

Dermer, C. D.; Giebels, B. Active galactic nuclei at gamma-ray energies. Comptes rendus - Physique 2016, 17, p. 594-616.
Piron, F. Gamma-ray bursts at high and very high energies. Comptes rendus - Physique 2016, 17, p. 617–631.

1. Madejski, G.; Sikora, M. Gamma-Ray Observations of Active Galactic Nuclei. ARA&A 2016, 54, p.725–760.
2.
3.
4. Nava, L. Gamma-ray burst at the highest energies. Universe 2021, 7, 12, p. 503.
5. Noda, K. and Parsons, R. D. Gamma-Ray Bursts at TeV Energies: Observational Status. Galaxies 2022, 10, 1, p. 7.
6.
7.

Rybicki, G. B.; Lightman, A. P. Radiative Processes in Astrophysics; Wiley-VCH GmbH, Weinheim, Berlin.
Dermer, C. D. High Energy Radiation from Black Holes: Gamma Rays, Cosmic Rays, and Neutrinos; Princeton Univerisity Press: Princeton,
New Jersey, U.S.A.
Cerruti, M. Leptonic and Hadronic Radiative Processes in Supermassive-Black-Hole Jets. Galaxies 2020, 8, 4, p. 72.
Böettcher, M. Progress in Multi-wavelength and Multi-Messenger Observations of Blazars and Theoretical Challenges. Galaxies 2019,
7, 1, p. 72.

8.
9.

10. Cerruti, M. The Blazar Hadronic Code Comparison Project. In Proceedings of the 37th International Cosmic Ray Conference

(ICRC2021), Berlin, Germany, 12 - 23 July 2021; id. 979.

11. Lamanna, G. et al. Cherenkov Telescope Array Data Management. In Proceedings of the 34th International Cosmic Ray Conference

(ICRC2015). The Hague, The Netherlands, 30 July - 6 August, 2015; id. 947.

12. Deil, C. et al. Open high-level data formats and software for gamma-ray astronomy. In Proceedings of the 6th International Meeting

on High Energy Gamma-Ray Astronomy (Gamma2016). Heidelberg, Germany, 11 – 15 July 2016; Volume 1792, Issue 1, id.070006.

13. Nigro, C.; Hassan, T.; Olivera-Nieto, L. Evolution of Data Formats in Very-High-Energy Gamma-Ray Astronomy. Universe, 2021, 7, 10,

p. 374.

14. Knödlseder, J. et al. GammaLib and ctools. A software framework for the analysis of astronomical gamma-ray data. A&A, 2016, 593,

id.A1, 19 pp.

15. Deil, C. et al. Gammapy - A prototype for the CTA science tools. In Proceedings of the 35th International Cosmic Ray Conference

(ICRC2017), Bexco, Busan, Korea, 10-20 July, 2017; id. 766.

16. Blandford, R. D.; Znajek, R. L. Electromagnetic extraction of energy from Kerr black holes. MNRAS 1977, 179, p. 433–456.
17. Blandford, R. D.; Payne, D. G. Hydromagnetic ﬂows from accretion disks and the production of radio jets. MNRAS 1982, 199, p.

883–903.

18. Meier, D. L. Black Hole Astrophysics: The Engine Paradigm; Springer Verlag: Berlin, Heidelberg, Germany, 2012.
19. Cohen, M. H. et al. The Small-Scale Structure of Radio Galaxies and Quasi-Stellar Sources at 3.8 Centimeters. ApJ 1971, 170, p.207.
20. Blandford, R. D.; Rees, M. J. Some comments on radiation mechanisms in Lacertids. In Proccedings of the Pittsburgh Conference on

BL Lac Objects, Pittsburgh, Pennsylvania, U.S.A., 24-26 April 1978; p. 328–341.

21. Ulrich, M.; Maraschi, L.; Urry, M. C. Variability of Active Galactic Nuclei. ARA&A 1997, 35, p. 445–502.
22. Rieger, F. Gamma-Ray Astrophysics in the Time Domain. Galaxies 2019, 7, 1, p. 28.
23. Zhang, H. Blazar Optical Polarimetry: Current Progress in Observations and Theories. Galaxies 2019, 7, 4, p. 85.
24. Costamante, L. et al. On the origin of gamma-rays in Fermi blazars: beyond the broad-line region. MNRAS 2018, 477, 4, p. 4749–4767.
25. Meyer, M; Scargle, J. D.; Blandford, R. D. Characterizing the Gamma-Ray Variability of the Brightest Flat Spectrum Radio Quasars

Observed with the Fermi LAT. ApJ 2019, 877, 1, id. 39, 30 pp.

26. Kumar, P.; Zhang, B. The physics of gamma-ray bursts & relativistic jets. Physics Reports 2015, 561, p. 1–109.
27. Matthews, J. H.; Bell, A. R.; Blundell, K. M. Particle acceleration in astrophysical jets. New Astronomy Reviews 2020, 89, id. 101543.
28. Blandford, R. D.; Königl, A. Relativistic jets as compact radio sources. ApJ 1979, 232, p. 34–48.
29.

Jones, T. W.; O’Dell, S. L.; Stein, W. A. Physics of Compact Nonthermal Sources. I. Theory of Radiation Processes. ApJ 1974, 188, p.
353–368.
Sikora, M.; Begelman, M. C.; Rees, M. J. Comptonization of Diffuse Ambient Radiation by a Relativistic Jet: The Source of Gamma
Rays from Blazars? ApJ 1994, 421, p. 153.

30.

31. Dermer, C. D.; Schlickeiser, R. Transformation Properties of External Radiation Fields, Energy-Loss Rates and Scattered Spectra, and a

Model for Blazar Variability. ApJ 2002, 575, 2, p. 667–686.
Sikora, M. et al. On the Nature of MeV Blazars. ApJ 2002, 577, 1, p. 78-84.

32.
33. Tavecchio, F.; Ghisellini, G. Spine-sheath layer radiative interplay in subparsec-scale jets and the TeV emission from M87. MNRAS

2008, 385, 1, pp. L98–L102.

34. MacDonald, N. R. et al. Through the Ring of Fire: Gamma-Ray Variability in Blazars by a Moving Plasmoid Passing a Local Source of

Seed Photons. ApJ 2015, 804, 2, id. 111.

35. Tavecchio, F. et al. The X-Ray Jet of PKS 0637-752: Inverse Compton Radiation from the Cosmic Microwave Background? ApJ 2000,

544, 1, p. L23–L26.

36. Böettcher, M. et al. Leptonic and Hadronic Modeling of Fermi-detected Blazars. ApJ 2013, 768, 1, id. 54.
37. Cooray, A. Extragalactic background light measurements and applications. RSOS 2016, 3, 3, p. 150555.

Version July 28, 2022 submitted to Galaxies

22 of 23

38. H.E.S.S. Collaboration. Revealing x-ray and gamma ray temporal and spectral similarities in the GRB 190829A afterglow. Science 2021,

372, 6546, p. 1081–1085.

39. MAGIC Collaboration. Observation of inverse Compton emission from a long γ-ray burst. Nature 2019, 575, 7783, p. 459–463.
40. Razzaque, S. A Leptonic-Hadronic Model for the Afterglow of Gamma-ray Burst 090510. ApJ 2010, 724, 1, p. L109–L112.
41. Zabalza, V. naima: a Python package for inference of relativistic particle energy distributions from observed nonthermal spectra. In
Proceedings of the 34th International Cosmic Ray Conference (ICRC2015), The Hague, The Netherlands, 30 July - 6 August 2015; id.
992.

42. Harris, C.R. et al. Array programming with NumPy. Nature 2020, 585, p. 357-–362.
43. Virtanen, P. et al. SciPy 1.0: Fundamental Algorithms for Scientiﬁc Computing in Python. Nature Methods 2020, 17(3), p. 261–272.
44. Astropy Collaboration. Astropy: A community Python package for astronomy. A&A 2013, 558, A33, 9 pp.
45. Astropy Collaboration.The Astropy Project: Building an Open-science Project and Status of the v2.0 Core Package. ApJ 2018, 156, 3, id.

123, 19 pp.

46. Domínguez A. et al. Extragalactic background light inferred from AEGIS galaxy-SED-type fractions. MNRAS 2011, 410, 4, p.

47.

2556–2578.
Freeman, P. et al. Sherpa: a mission-independent data analysis application. In Proceedings of Society of Photo-Optical Instrumentation
Engineers (SPIE) Conference Series, Astrophysical Data Analysis, 2001; Vol. 4477, p. 76–87.

48. Doe, S. et al. Developing Sherpa with Python. In Proceedings of the Astronomical Data Analysis Software and Systems (ADASS) XVI,

Tucson, Arizona, USA, 15-18 October 2006; Volume 376, p. 543.
Foreman-Mackey, D. et al. emcee: The MCMC Hammer. PASP 2013, 125, p. 306.

49.
50. Aharonian, F. et al. Primary particle acceleration above 100 TeV in the shell-type supernova remnant RX J1713.7-3946 with deep HESS

observations. A&A 2007, 464, p. 235–243.

51. MAGIC Collaboration. Investigation of the correlation patterns and the Compton dominance variability of Mrk 421 in 2017. A&A

2021, 655, id. A89.

52. H.E.S.S. Collaboration. Revealing x-ray and gamma ray temporal and spectral similarities in the GRB 190829A afterglow. Sci 2021,

372, 6546, p. 1081–1085.

53. Hahn J., GAMERA - A Modular Framework For Spectral Modeling In VHE Astronomy. In Proceedings of the 34th International

Cosmic Ray Conference (ICRC2015), The Hague, The Netherlands, 30 July - 6 August 2015; id. 917.

54. Torres, D. F. et al. Time-dependent modeling of TeV-detected, young pulsar wind nebulae. JHEAP 2014, 1, p. 31–62.
55. Abhir, J. et al. Study of Temporal and Spectral variability for Blazar PKS 1830-211 with Multiwavelength Data. ApJ 2021, 915, p. 26.
56. Prince, R. et al. Multiwavelength analysis and modeling of OJ 287 during 2017-2020. A&A 2021, 654, id.A38.
57. Matthews, J. H.; Taylor, A. M. Particle acceleration in radio galaxies with ﬂickering jets: GeV electrons to ultrahigh energy cosmic rays.

MNRAS 2021, 503, 4, p. 5948–5964.

58. Mestre, E. et al. Probing the hadronic nature of the gamma-ray emission associated with Westerlund 2. MNRAS 2021, 505, p.

2731–2740.

59. Tramacere, A. et al. Swift observations of the very intense ﬂaring activity of Mrk 421 during 2006. I. Phenomenological picture of

electron acceleration and predictions for MeV/GeV emission. A&A 2009, 501, 3, p. 879–898.

60. Tramacere, A.; Massaro, E.; Taylor, A. M. Stochastic Acceleration and the Evolution of Spectral Distributions in Synchro-Self-Compton

Sources: A Self-consistent Modeling of Blazars’ Flares. ApJ 2011, 739, 2, id. 66, 16 pp.

61. Tramacere, A. JetSeT: Numerical modeling and SED ﬁtting tool for relativistic jets. ASCL, ascl:2009.001, https://ascl.net/2009.001.
62. Tramacere, A. et al. Radio-γ-ray response in blazars as a signature of adiabatic blob expansion. A&A 2022, 658, id.A173, 27 pp.
63. Dembinski, H. et al. scikit-hep/iminuit. Zenodo doi: 10.5281/zenodo.3949207, https://doi.org/10.5281/zenodo.3949207.
64. Ramaty, R. Energetic particles in solar ﬂares. In Proceedings of the Workshop Particle acceleration mechanisms in astrophysics, La

Jolla, California, 3 - 5 January 1979; p. 135–154.

65. Becker, P. A.; Le, T.; Dermer, C. D. Time-dependent Stochastic Particle Acceleration in Astrophysical Plasmas: Exact Solutions

Including Momentum-dependent Escape. ApJ 2006, 647, 1, p. 539–551.

66. Chang, J. S.; Cooper, G. A Practical Difference Scheme for Fokker-Planck Equations. Journal of Computational Physics 1970, 6, 1, p. 1–16.
67. Park, B. T.; Petrosian, V. Fokker-Planck Equations of Stochastic Acceleration: A Study of Numerical Methods. ApJS 1996, 103, p. 255.
68. Rodi, J., et al. A Broadband View on Microquasar MAXI J1820+070 during the 2018 Outburst. ApJ 2021, 910, 1, id.21, 12 pp.
69.

Franceschini, A.; Rodighiero, G.; Vaccari, M. Extragalactic optical-infrared background radiation, its time evolution and the cosmic
photon-photon opacity. A&A 2008, 438, 3, p. 837–852.
Finke, J. D.; Razzaque, S.; Dermer, C. D. Modeling the Extragalactic Background Light from Stars and Dust. ApJ 2010, 712, 1, p.
238–249.

70.

71. Nigro, C. et al. agnpy: An open-source python package modelling the radiative processes of jetted active galactic nuclei. A&A 2022,

660, A18, 20 pp.

Version July 28, 2022 submitted to Galaxies

23 of 23

72.

Finke, J. D.; Dermer, C. D.; Böttcher, M. Synchrotron Self-Compton Analysis of TeV X-Ray-Selected BL Lacertae Objects. ApJ 2008, 686,
1, p. 181–194.

73. Dermer, C. D. et al. Gamma-Ray Studies of Blazars: Synchro-Compton Analysis of Flat Spectrum Radio Quasars. ApJ 2009, 692, 1, p.

74.

32–46.
Finke J. D. External Compton Scattering in Blazar Jets and the Location of the Gamma-Ray Emitting Region. ApJ 2016, 830, 2, id. 94,
21 pp.

75. Abdo, A. A. et al. Fermi Large Area Telescope Observations of Markarian 421: The Missing Piece of its Spectral Energy Distribution.

ApJ 2011, 736, 2, id. 131, 22 pp.

76. MAGIC Collaboration. VHE gamma-ray detection of FSRQ QSO B1420+326 and modeling of its enhanced broadband state in 2020.

A&A 2021, 647, id.A163, 19 pp.

77. MAGIC Collaboration. Multiwavelength study of the gravitationally lensed blazar QSO B0218+357 between 2016 and 2020. MNRAS

2022, 510, 2, pp. 2344–2362.

78. Albert, A. et al. Long-term Spectra of the Blazars Mrk 421 and Mrk 501 at TeV Energies Seen by HAWC. ApJ 2022, 929, 2, id.125, 12 pp.
79. Markoff, S. et al. A jet model for the broadband spectrum of XTE J1118+480. Synchrotron emission from radio to X-rays in the

Low/Hard spectral state. A&A 2001, 372, pp. L25–L28.

80. Markoff, S. et al. Going with the Flow: Can the Base of Jets Subsume the Role of Compact Accretion Disk Coronae? ApJ 2005, 635, pp.

1203–1216.

81. Lucchini M. et al., Bhjet: a public multi-zone, steady state jet + thermal corona spectral model. arXiv 2021 arXiv:2108.12011.
82.
83.
84.

Falcke, H. and Biermann, P. L. The jet-disk symbiosis. I. Radio to X-ray emission models for quasars. A&A 1995, 293, 665-682.
Falcke, H. et al. The jet-disk symbiosis. II. Interpreting the radio/UV correlations in quasars. A&A 1995, 298, 375.
Falcke, H. and Biermann, P. L. The jet/disk symbiosis. III. What the radio cores in GRS 1915+105, NGC 4258, M 81 and SGR A* tell us
about accreting black holes. A&A 1999, 342, 49-56.

85. Blandford, R. D., Königl, A. Relativistic jets as compact radio sources. ApJ 1979, 232, pp. 34–38.
86. Arnaud, K. A. XSPEC: The First Ten Years. In Proceedings of the Astronomical Data Analysis Software and Systems (ADASS) V,

Tucson, AZ, USA, 22-25 Oct. 1995; Vol. 101, p. 17.

87. Lucchini, M.; Krauß, F.; Markoff, S. The unique case of the active galactic nucleus core of M87: a misaligned low-power blazar?

MNRAS 2019, 489, 2, p. 1633–1643.

88. Dallilar, Y. et al. Flaremodel: An open-source Python package for one-zone numerical modelling of synchrotron sources. A&A 2022,

658, id. A111.

89. Newville, M. et al. lmfit. Zenodo doi: 10.5281/zenodo.5570790, https://doi.org/10.5281/zenodo.5570790.
90. Band, D. L. and Grindlay, J. E. The synchrotron-self-Compton process in spherical geometries. I - Theoretical framework. ApJ 1985,

298, pp. 128–146.

91. Pandya, A. et al. Polarized Synchrotron Emissivities and Absorptivities for Relativistic Thermal, Power-law, and Kappa Distribution

Functions. ApJ 2016, 822, p. 34.

92. GRAVITY Collaboration. Constraining particle acceleration in Sgr A(cid:63) with simultaneous GRAVITY, Spitzer, NuSTAR, and Chandra

observations. A&A 2021, 654, id. A22.

93. Kafexhiu, E. et al. Parametrization of gamma-ray production cross sections for p p interactions in a broad proton energy range from

the kinematic threshold to PeV energies. PRD 2014, 90, 12, id.123014.

94. Kelner, S.; Aharonian, F.; Bugayov, V. Energy spectra of gamma rays, electrons, and neutrinos produced at proton-proton interactions

in the very high energy regime. PRD 2006, 74, 3, id. 034018.

95. Potter, W. J.; Cotter, G. Synchrotron and inverse-Compton emission from blazar jets - I. A uniform conical jet model. MNRAS 2012,

423, 1, p. 756–765.

96. Potter, W. J.; Cotter, G. Synchrotron and inverse-Compton emission from blazar jets - II. An accelerating jet model with a geometry

set by observations of M87. MNRAS 2013, 429, 2, p. 1189–1205.

97. Potter, W. J.; Cotter, G. Synchrotron and inverse-Compton emission from blazar jets - III. Compton-dominant blazars. MNRAS 2013,

431, 2, p.1840-1852

98. Potter, W. J.; Cotter, G. Synchrotron and inverse-Compton emission from blazar jets - IV. BL Lac type blazars and the physical basis

for the blazar sequence. MNRAS 2013, 436, 1, p. 304–314.

99. Ohm, S. Starburst galaxies as seen by gamma-ray telescopes. Comptes rendus - Physique 2016, 17, 6, p. 585–593.
100. Portegies Zwart, S. Computational astrophysics for the future. Science 2018, 361, 6406, p. 979–980.
101. Wells, D. C.; Greisen, E. W.; Harten, R. H. FITS - a Flexible Image Transport System. Astronomy and Astrophysics Supplement 1981, 44, p.

363.

102. Piron, F. et al. Temporal and spectral gamma-ray properties of Mkn 421 above 250 GeV from CAT observations between 1996 and

2000. A&A 2001, 374, p. 895–906.

