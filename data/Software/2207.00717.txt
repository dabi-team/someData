2
2
0
2

l
u
J

3
2

]

O
C
.
h
t
a
m

[

2
v
7
1
7
0
0
.
7
0
2
2
:
v
i
X
r
a

Asymptotics of multivariate sequences IV: generating functions
with poles on a hyperplane arrangement

Yuliy Baryshnikov∗, Stephen Melczer†, and Robin Pemantle‡

July 26, 2022

Abstract

Let F (z1, . . . , zd) be the quotient of an analytic function with a product of linear functions. Working
in the framework of analytic combinatorics in several variables, we compute asymptotic formulae for
the Taylor coeﬃcients of F using multivariate residues and saddle-point approximations. Because the
singular set of F is the union of hyperplanes, we are able to make explicit the topological decompositions
In addition to eﬀective and explicit asymptotic
which arise in the multivariate singularity analysis.
results, we provide the ﬁrst results on transitions between diﬀerent asymptotic regimes, and provide the
ﬁrst software package to verify and compute asymptotics in non-smooth cases of analytic combinatorics
in several variables.
It is also our hope that this paper will serve as an entry to the more advanced
corners of analytic combinatorics in several variables for combinatorialists.

1

Introduction

In this paper we study the coeﬃcients of meromorphic functions

F (z) = F (z1, . . . , zd) =

G(z)
j=1 (cid:96)j(z)pj

(cid:81)m

(1)

whose denominator is the product of positive integer powers of real linear functions (cid:96)j. Such functions arise,
among other places, in queuing theory.
Example 1.1. The so-called partition generating function for a closed multiclass queuing network with one
inﬁnite server has the form

F (z) =

(cid:81)m

j=1

ez1+z2+···+zd
(cid:16)
1 − (cid:80)d

i=1 ρijzj

(cid:17)

for real constants ρij > 0 depending on model parameters [8, Eq. (2.26)].

(2)

(cid:47)

Bertozzi and McKenna [8] approached the asymptotic analysis of the queuing system described in (2)
by noting that the multivariate Cauchy integral which evaluates these coeﬃcients can be represented as a

∗Department of Mathematics, University of Illinois, Urbana, IL 61801, USA, ymb@illinois.edu
†Department of Combinatorics & Optimization, University of Waterloo, 200 University Avenue West, Waterloo, ON N2L

3G1, Canada, smelczer@uwaterloo.ca

‡University of Pennsylvania, Department

of Mathematics,

209 S.

33rd Street, Philadelphia, PA 19104,

pemantle@math.upenn.edu

1

 
 
 
 
 
 
sum of integrals over basic homology cycles in the domain of holomorphy of the complex d-form z−rF (z)dz.
In certain low-dimensional cases, they were able to exploit linear relations among these cycles to determine
dominant asymptotics via multivariate residues. Since that time, the theory of multivariate coeﬃcient
extraction via the ﬁeld of analytic combinatorics in several variables (ACSV) [34, 24] has grown substantially.

The techniques of ACSV aim to characterize the asymptotic behaviour of the series coeﬃcients {ar} of
a convergent series expansion F (z) = (cid:80)
r arzr as r → ∞ with the normalized vector ˆr = r/|r| staying in a
bounded set, where |r| denotes the 1-norm |r| = |r1| + · · · + |rd|. Suppose that F (z) = G(z)/H(z), where
H(z) = (cid:81)m
j=1 hj(z)pj for polynomials hj each vanishing on a smooth variety (generalizing the case when H
is a product of linear factors). The series coeﬃcients {ar} exhibit uniform asymptotic behaviour in r aside
from certain degenerate cases having to do with nontransverse intersections of these varieties or boundary
directions ˆr where there are transitions in asymptotic behaviour. An asymptotic expansion for ar can usually
be obtained by taking an integer sum of saddle-point integrals I(σ) localized near certain contributing points
σ where the denominator H vanishes. Pemantle and Wilson [33] characterize the asymptotic behaviour of
the types of local integrals that come up in this paper (so-called transverse multiple points); see also [36] for
explicit formulae.

Computing the set of contributing points σ over which to sum local integrals to determine asymptotics can
be easy in some applications, but is diﬃcult (perhaps even undecidable) in general. When the denominator
under consideration is a product of linear factors, Bertozzi and McKenna [8] determine this set for a few
examples and speculated on the existence of a theory to compute the set in general. Outside of the linear
denominator case, which we cover extensively in this paper, when the singular set of F is a manifold then it
is known how to compute the contributing points both in the bivariate case [12] and when the contributing
points lie on the boundary of the domain of convergence of the power series [25]. There is currently no known
algorithm to determine contributing singularities for general meromorphic (or even rational) functions, and
such an algorithm would need to decide certain deep topological questions. However, the current state of
knowledge is enough for many problems of combinatorial origin.

In addition to queuing theory, other areas where generating functions having a form similar to (1)
arise include Markov modeling [15], lattice point enumeration [11], and discrete probability theory (see
Example 3.15 below). Gaussian and other limit theorems also follow from the asymptotic extraction of
coeﬃcients of multivariate generating functions.

When the denominator of F has only linear factors, the singular set of F forms a hyperplane arrangement,
which allows us to describe which critical points σ are contributing points that aﬀect asymptotic behaviour
of a coeﬃcient sequence. In this paper we give an algorithm to determine dominant asymptotics for any such
meromorphic function under two assumptions: (1) r is generic, meaning that r/|r| does not approach one of
a codimension 1 set of bad boundary directions, and (2) the numerator G(z) is polynomial. Algorithm 1 below
summarizes the procedure under the additional assumption that the functions (cid:96)j are linearly independent,
and a Maple implementation is detailed in Section 4.4. Later, Algorithm 2 handles the more general case
where the {(cid:96)j} can be linearly dependent. When G is allowed to be a more general entire function, the same
two algorithms give valid asymptotic formulae, with the proviso that the determination of which among
ﬁnitely many terms of the formula asymptotically dominate may require further investigation.
In non-
generic directions, while we have no complete algorithm, we show how the desired estimates can be written
as integral transforms and compute these in a variety of cases. We also give the ﬁrst results discussing
transitions in asymptotics around non-generic directions.

The remainder of the paper is structured as follows. General background related to ACSV is given in
Section 2. Results and motivating examples are given in Section 3. Section 4 gives the heart of the analysis,
under the assumption of linear independence of the {(cid:96)j}. Here, the topological decomposition of the cycle
of integration in Cauchy’s integral formula is decomposed into certain Morse-theoretically determined cycles
for which the integral has an easily computed asymptotic form. Section 5 extends the results to allow for

2

linear dependencies among the {(cid:96)j}. Finally, Section 6 studies a number of cases where r/|r| approaches a
boundary direction, giving complete results in a scaling window of width |r|1/2 in the case of an ordinary
boundary direction in terms of negative moments of Gaussian random variables.
Remark 1.2. Some of our exposition follows the textbook [24] of the second author, which was written
In addition to a self-contained presentation that makes clearer
at the same time as much of this paper.
the relationship between our arguments and more general results in Morse theory, the new contributions
of this paper include the ﬁrst software implementation to verify and compute asymptotics in non-smooth
cases of analytic combinatorics in several variables, the ﬁrst results on transitions of behaviour around non-
generic directions, a proof that all critical points must be real (giving a complete classiﬁcation of when critical
points can occur, and simplifying other arguments), and a classiﬁcation of when drops in the ‘neighbourhood’
exponential growth of a sequence can occur.

ACSV requires a number of techniques not always familiar to combinatorialists: Morse theory, computa-
tional algebraic geometry and the theory of singular integral transforms. Nevertheless, our aim is to provide
an introductory exposition. In order to help motivate the homological arguments taken in modern approaches
to this topic, we illustrate our techniques on several examples and provide a Maple implementation of our
work at

https://github.com/ACSVMath/ACSVHyperplane

2 ACSV background

The use of analytic techniques to derive asymptotic information about a sequence (an) from properties of
its generating function f (z) = (cid:80)∞
n=0 anzn is the domain of analytic combinatorics. When the generating
function f (z) represents an analytic function at the origin, Cauchy’s integral formula implies

C
where C is any positively oriented circle suﬃciently close to the origin. By deforming the domain of integra-
tion C, one can typically use classical integral methods to obtain asymptotic results. Standard references
include Flajolet and Sedgewick [13], Odlyzko [28], and Henrici [17].

an =

1
2πi

(cid:90)

f (z)

dz
zn+1 ,

More recently, ACSV has developed tools for the multivariate asymptotic analysis of generating functions.
Fix a dimension d ∈ N. Given a multi-dimensional vector z = (z1, . . . , zd) ∈ Cd and index i ∈ Zd, let
zi := zi1
d ∈ C. Generalizing from the univariate case, if the multivariate generating function
(cid:88)

1 · · · zid

F (z) =

arzr

represents a power series at the origin then the Cauchy integral formula gives an analytic representation

r∈Nd

ar =

(cid:18) 1
2πi

(cid:19)d (cid:90)

T

F (z)

dz
zr+1 ,

(3)

where T is the product of suﬃciently small positively oriented circles. The aim is often to determine
.
asymptotics of the sequence [zr]F (z) = ar as r = nˆr and n → ∞, for some ﬁxed direction ˆr ∈ Rd
>0
Although ar is only non-zero when r has non-negative integer coordinates, the theory as detailed in this
paper shows that asymptotics typically vary smoothly with r, allowing one to make asymptotic statements
about ar for generic directions ˆr or when a normalization of r approaches ˆr suﬃciently quickly (this will be
made precise below).

3

The earliest results in this area [6, 14, 19, 7] were based on showing that the sections (cid:80)

r:r1=k arzr are
well approximated by a quasi-power Ckzk
1 g(z2, . . . , zd)k, leading to a central limit theorem and Gaussian
behaviour of the generating function coeﬃcients. Since the early 2000s, a systematic program to determine
asymptotics of multivariate generating function coeﬃcients has been developed by the analytic combinatorics
in several variables project1 [32, 33, 5, 34, 3, 24]. In the earliest of these works [32, 33] the deformations
were accomplished by ad hoc surgeries. In [5], existence of the relevant deformations was shown to follow
from the theory of hyperbolic functions [1] and a Morse-theoretic structure was provided to compute and
interpret them; this Morse-theoretic approach was recently made rigorous in [3] by working around certain
standard assumptions of Morse theory that don’t hold in ACSV contexts.

Let F (z) be a meromorphic function with poles along an algebraic variety V, and let M = Cd

∗ \ V denote
the domain on which the integrand of the Cauchy integral (3) is holomorphic. The value of the Cauchy
integral depends only on the homology class of T in Hd(M) so, for instance, we can deform T in M without
changing the value of the integral.

As r → ∞ the magnitude of the Cauchy integrand of (3) is controlled by the points z for which |z|−r is
maximized. Integrals are usually easiest to approximate when the contribution from integration away from
the maximum value of the integrand is negligible, leading us to try and deform T to a minimax contour.
The key to computing integral transforms is that minimizing maxT |z|−r will produce a contour T where,
near the point where |z|−r is maximized, the integrand is in stationary phase, and may thus (typically) be
approximated using standard analytic techniques. This minimax problem is not aﬀected by rescaling r, so
the analysis depends only on the vector ˆr := r/|r| where |r| := r1 + · · · + rd is L1-norm of r (the L1-norm is
natural in many contexts, but can be replaced by another norm if desired).

Taking logarithms, we need to look near points z such that the height function

hˆr(z) := −

d
(cid:88)

j=1

ˆrj log |zj| .

(4)

is maximized. The decomposition of cycles into canonical height-minimizing cycles is the province of Morse
theory (when V is smooth) and stratiﬁed Morse theory (when V is a stratiﬁed space such as an algebraic
variety).

The result of a Morse-theoretic analysis is as follows. Any algebraic set V can be decomposed into a
ﬁnite set of smooth manifolds known as strata, each of which (under the assumptions of this paper) contains
a ﬁnite set of critical points for the height function (points where the diﬀerential of the height function
restricted to the strata is zero). Any cycle C may be written as the sum of certain ‘attachment cycles’ for
which height is maximized uniquely at one of these critical points2. These attachment cycles are known as
linking tori, the one near a critical point σ being denoted by τ σ. The integral over one of these linking
tori is a standard integral transform whose asymptotics are sometimes easy to compute (e.g., in the generic
directions referenced above) or are in the province of singular integral theory and are explicit to various
degrees depending on the geometry near the critical point. Restricting to the case where V is the union
of hyperplanes results in a bound on the complexity of the singular integral, and therefore a reasonably
complete answer.

The case where the denominator of F is the product of linear functions with real coeﬃcients simpliﬁes
for a second reason, beyond the bounded complexity of the geometry of V. The analysis from above may be
summarized by a homological computation

[T ] =

(cid:88)

σ∈Ω

kστ σ ,

(5)

1See acsvproject.com for a listing of papers in this project.
2The fact that the original cycle is in M ⊆ V c while the Morse theory is done on V will be reconciled in Section 4.

4

where Ω is the set of stratiﬁed critical points for h on V and the kσ are integer invariants that typically hard
to compute. When σ lies on the boundary of the domain of convergence of F (z) and the singular geometry
at σ is suﬃciently nice, it is known that kσ ∈ {±1, 0}. When this (rather strong and computationally
expensive) property cannot be established, the most promising method to date for determining the coeﬃ-
cients kσ relies on the fact that, when ˆr is a rational direction, the coeﬃcient sequences anr satisfy linear
diﬀerential equations with polynomial coeﬃcients [10, 22] which can be computed using so-called Creative
Telescoping methods [20]. Numeric analytic continuation [26] can then be used to rigorously determine the
constants appearing in asymptotics up to any ﬁxed accuracy, recovering the integers kσ. Representation
of the denominator of F as a product of real linear functions allows explicit computation of {kσ}, going
through the intermediate homology basis of imaginary ﬁbers, which relies in turn on convexity properties
following from the form of the denominator of F .

3 Notation and results

In this section we state our main results, after some basic deﬁnitions.

3.1 Deﬁnitions

We begin by introducing the quantities appearing in our analysis. We make use of terminology from ACSV,
the study of hyperplane arrangements, and topological constructions.

Hyperplane arrangements

Fix a ratio

where G(z) is an entire function and

F (z) = F (z1, . . . , zd) =

G(z)
H(z)

,

H(z) =

m
(cid:89)

j=1

(cid:96)j(z)pj

for integers pj ≥ 1 and real linear functions

(cid:96)j(z) = 1 − (b(j), z) = 1 − b(j)

1 z1 − · · · − b(j)

d zd .

We always assume that G and H are coprime, which in this case simply means that G does not identically
vanish on the zero set of one of the (cid:96)j (when G is a polynomial this means G and H are coprime polynomials).
The singular set

V = {z ∈ Cd : H(z) = 0}

is composed of a union of hyperplanes and thus deﬁnes a hyperplane arrangement [31], a well-studied com-
binatorial and topological object from which we borrow some of our terminology. The notation VR denotes
the real arrangement, a union of corresponding real hyperplanes in Rd that is the intersection of V with Rd.

Given complex-valued functions g1, . . . , gs, we let V(g1, . . . , gs) denote their set of common complex
zeroes. The hyperplane arrangement V = V((cid:96)1 · · · (cid:96)m) can be decomposed into closed ﬂats:
for each
subset {k1, . . . , ks} ⊂ {1, . . . , m} the ﬂat Vk1,...,ks := V((cid:96)k1, . . . , (cid:96)ks) is the intersection of the appropriate
hyperplanes. Because two ﬂats with distinct index sets could be equal, we let A be the collection of maximal

5

Figure 1: The real part of a simple arrangement of two hyperplanes in two dimensions

subsets of {1, . . . , m} corresponding to non-empty distinct ﬂats: this is the hyperplane arrangement
deﬁned by V. Thus, by deﬁnition, VS∪{k} (cid:54)= VS for any S ∈ A and k /∈ S.

Deﬁnition 3.1 (simple arrangements). The arrangement A (or singular set V, or rational function F (z)) is
said to be simple if for any subset {k1, . . . , ks} ⊆ [m] of indices such that the ﬂat Vk1,...,ks
is nonempty, the
coeﬃcient vectors b(k1), . . . , b(k1) are linearly independent. In other words, A is simple if hyperplanes with
common points have linearly independent normals.

The stratum SS corresponding to any S ∈ A is deﬁned as the ﬂat VS with all subﬂats removed,

SS := VS \

(cid:91)

VT .

VT (cid:40)VS

The collection of strata form a stratiﬁcation of V, i.e., a partition of V into disjoint smooth sets, and the
ﬂat VS is the closure of the stratum SS. The dimension of SS is the dimension of VS as an algebraic set.
It is also the dimension of S as a complex manifold and half the dimension of S as a real manifold. When V
is simple then A is the collection of all subsets of {1, . . . , m} such that the corresponding hyperplanes have
non-empty intersection, and the dimension of a stratum SS is simply d − |S|.
Example 3.2. Figure 1 shows an arrangement with two hyperplanes and three non-empty ﬂats.

(cid:47)

Critical points

>0

. By deﬁnition, a critical point of h = hr on a stratum S is a point where the diﬀerential of the
Let r ∈ Rd
restricted map h|S is zero. The critical points on a stratum satisfy an explicit set of algebraic equations, which
we now describe. Let k1, . . . , ks ∈ [m] be any indices such that {b(k1), . . . , b(ks)} are linearly independent,
deﬁning a ﬂat VS. Because the diﬀerential of the unrestricted map hr is given by its gradient, a critical point

6

on VS is characterized by a rank deﬁciency in the matrix






M (z) :=






−∇(cid:96)k1 (z)
...
−∇(cid:96)ks (z)
−∇h






=






r1/z1

b(k1)
...
b(ks)
· · ·








.

rd/zd

(6)

Up to a reordering of variables and the (cid:96)kj
, we may assume without loss of generality that M contains pivots
in its ﬁrst s diagonal entries. For j = s + 1, . . . , d, let Mj denote the (s + 1) × (s + 1) matrix constructed
from the ﬁrst s columns of M together with its (s + j)th column. Clearing denominators, the critical points
on VS are the real solutions of a polynomial system deﬁned by

(cid:96)k1 = · · · = (cid:96)ks = det M1 = · · · = det Md−s = 0 .

(7)

As expected, the critical points are unchanged by scaling r, and thus only depend on the normalized

vector ˆr = r/|r|.
Lemma 3.3. If σ is a critical point of hr then σ ∈ Rd.

Proof. Assume, without loss of generality, that σ lies in the stratum S1,...,s . Then there exist constants
λ1, . . . , λs ∈ C such that

λ1b(1) + · · · + λsb(s) =

, . . . ,

(cid:18) r1
σ1

(cid:19)

.

rd
σd

Write σ = x + iy and λj = aj + icj for x, y ∈ Rd and each aj, cj ∈ R. Taking the imaginary parts of both
sides of the above equation gives

c1b(1) + · · · + csb(s) = −

(cid:18) r1y1
x2
1 + y2
1

, . . . ,

(cid:19)

,

rdyd
x2
d + y2
d

and taking the dot product of both sides of this equation with y implies

(cid:16)

cj

b(j) · y

(cid:17)

= −

s
(cid:88)

j=1

d
(cid:88)

k=1

rky2
k
k + y2
x2
k

.

Since 1 − (x + iy) · b(j) = 0 for all 1 ≤ j ≤ s, we see that y · b(j) = 0 for all j, and thus

0 =

d
(cid:88)

k=1

rky2
k
x2
k + y2
k

.

Each term on the right-hand side of this equation is non-negative, and zero if and only if yk vanishes, so we
must have yk = 0 for all 1 ≤ k ≤ d, meaning σ = x ∈ Rd is real.

The function h is continuous and strictly convex on each orthant of Rd. If VS,R = VS ∩ Rd is the real
part of a ﬂat and the intersection of VS,R with an open orthant O ⊂ Rd is bounded, then VS,R ∩ O contains a
unique critical point of h, which is necessarily a local minimum by convexity of h. If VS,R ∩ O is unbounded,
which happens in every orthant when VS,R is parallel to at least one coordinate plane, then the inﬁmum of
h on VS,R ∩ O is −∞ and h has no critical point on VS,R ∩ O. Thus, for each index set S ∈ A the critical
points of the height function h = hˆr on the stratum SS are real, have non-zero coordinates (h is not deﬁned
when one of its coordinates is zero), and there is at most one in each quadrant of Rd.

We call a critical point of hr restricted to the ﬂat VS a critical point of the stratum SS, although it
may not lie in SS (it could be in a proper subﬂat). Each critical point σ lies in a unique stratum of lowest
dimension, which we denote S(σ).

7

Figure 2: The real part of the hyperplane arrangement (cid:96)1(x, y)(cid:96)2(x, y) = 0 in Example 3.6, together with
critical points, the lognormal cone ˜N (1, 1) and ˆr, when r = (1, 1) (left) and ˆr = (5, 1) (right).

Deﬁnition 3.4 (critical sets and generic directions). The critical set Ω of F (in the direction ˆr) is the
union of all critical points of hˆr on the strata SS as S ranges over all index sets S ∈ A. The direction ˆr is
said to be generic if no critical point of hˆr is a critical point of two distinct ﬂats.
Deﬁnition 3.5 (normal and lognormal cones). For any ﬂat VS, the (positive) normal cone N (S) is the
cone

N (S) =

ajb(j) : aj > 0

⊂ Rd




(cid:88)



j∈S






and for any σ ∈ S ∩ Rd the (positive) lognormal cone ˜Nσ(S) is the cone

˜Nσ(S) =




(cid:88)



j∈S

aj

˜b(j)

σ : aj > 0






⊂ Rd

spanned by the lognormal vectors ˜b(j)

σ :=

(cid:16)

1 σ1, . . . , b(j)
b(j)

d σd

(cid:17)

. For convenience, we write

N (σ) := N (S(σ)) and ˜N (σ) := ˜Nσ(S(σ)).

As we will see, the ACSV analysis depends on identifying singularities σ with −(∇hˆr)(σ) ∈ N (σ) or,
equivalently, with ˆr ∈ ˜N (σ).

Example 3.6. We introduce a running example that clariﬁes some of the deﬁnitions, using x and y in place
of z1 and z2 for clarity. Let F (x, y) := 1/((cid:96)1(x, y) · (cid:96)2(x, y)) where

(cid:96)1 = 1 −

2x + y
3

and

(cid:96)2 = 1 −

x + 2y
3

.

The real part of this hyperplane arrangement is illustrated in Figure 2. The ﬂats are the two lines V1 and
V2, and their intersection point V1,2 = {(1, 1)}.

For the ﬂat V1 the critical point equations in the direction r are (cid:96)1 = det M1 = 0, with the latter
expressing that the normal b(1) of (cid:96)1 is parallel to the gradient (∇hr)(x, y) = (r1/x, r2/y). This gives the
system

2x + y = 3

2x
r1

,

y
r2

=

8

with solution σ1 = (cid:0) 3ˆr1
(cid:1),
while the single point σ1,2 = (1, 1) in V1,2 is trivially critical. We note that σ1 lies in the stratum S1 unless
it coincides with σ1,2, which occurs when ˆr1 = 2/3. Similarly, σ2 lies in the stratum S2 unless ˆr1 = 1/3.
Thus, r is generic unless it is a multiple of (1, 2) or (2, 1).

(cid:1). A similar computation on the ﬂat V2 gives the critical point σ2 = (cid:0)3ˆr1, 3ˆr2

2 , 3ˆr2

2

Figure 2 shows the lognormal cone ˜N (1, 1) and the three critical points when r = (1, 1) and r = (5, 1).
Note that ˆr lies inside ˜N (1, 1) in the left sub-ﬁgure, but does not in the right sub-ﬁgure. The non-generic
directions are precisely those where r lies on the boundary of ˜N (1, 1).
(cid:47)

Topological deﬁnitions

We now ﬁx ˆr, write h(z) := hˆr(z), let M≤a denote the sublevel set {z ∈ M : h(z) ≤ a}, and set hmin to the
least critical height,

hmin := min{h(σ) : σ ∈ Ω} .
If a < hmin and C is a cycle in M≤a, then C can be continuously deformed in M so that max{h(z) : z ∈ C}
is as small as desired. This follows from a non-proper extension of the fundamental Morse lemma described
in [4] (because there are no so-called critical points at inﬁnity in our case), or more directly from a concrete
modiﬁcation of the downward gradient ﬂow on M, using a partition of unity to keep the ﬂow away from
all strata of V. It follows that the pairs Hd(M, M≤a) with a < hmin are naturally isomorphic. We denote
.
= to denote equality of classes in
any of these naturally equivalent pairs by (M, −∞) and use the symbol
Hd(M, −∞).

For those not topologically inclined, a class [T ] in Hd(M, −∞) can simply be viewed as a domain of
integration T for the Cauchy integral (3) which is deﬁned up to points in M of arbitrarily small height.
The idea is that points at small height are asymptotically negligible, so only the class of T matters in our
asymptotic calculations.

To that end, suppose that C

.
= 0, meaning C is a null-homologous chain in Hd(M, −∞). For each
.
= Ca, and let |Ca| = (2π)−dµ(Ca) where µ(Ca) is the area
a < hmin, let Ca be a chain in M≤a such that C
of Ca deﬁned by the d-dimensional Lebesgue measure. Because Ca is supported on Ma, the function F is
continuous on Ca, hence |F/ (cid:81)d

j=1 zj| has some maximum value fa on Ca. It follows that for all r,
(cid:12)
(cid:12)
(cid:12)
(cid:12)

F (z)z−r dz
z

F (z)z−r dz
z

= (2π)−d

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

(cid:90)

C

(2πi)−d

(cid:12)
(cid:12)
(cid:12)
(cid:12)

C
≤ fa|z|−r|Ca|
≤ fa|Ca|e|r|a

(8)

because |z|−r ≤ e|r|a on M≤a. This yields the following result.
.
= 0. Then the Cauchy integral integrated over C is smaller than any expo-

Proposition 3.7. Suppose C
nential. Speciﬁcally, for any a < 0 there exists K > 0 such that

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

C

F (z)z−r dz
z

(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤ Kea|r| .

Furthermore, if F grows at most polynomially then

(cid:90)

C

F (z)z−nˆr dz
z

= 0

for all n larger than some ﬁxed natural number.

9

Figure 3: An oblique rendering of 3-space is used to depict C2, where the z-axis denotes imaginary directions
in both the x and y coordinates. We take d = 2 and consider an arrangement of two intersecting hyperplanes.
Each colored set represents an imaginary ﬁber over a real basepoint (large dot). The alternating sum of
these is the linking torus for the point σ at the intersection of the two hyperplanes whose real parts are the
lines in the ﬁgure.

Proof. The ﬁrst part is an immediate consequence of (8). The second follows by ﬁxing r = nˆr and letting
a → −∞. Both fa and Ca grow at most exponentially in |a| (because fa grows at most polynomially in z),
hence for |r| greater than the sum of these, the right-hand side of (8) goes to zero. As these are all bounds
for the same ﬁxed integral, its value must be zero.

We close this section with two more topological deﬁnitions that will appear in the statements of results.

These are illustrated in Figure 3.

Deﬁnition 3.8 (imaginary ﬁbers). Let x ∈ Rd
∗
The imaginary ﬁber Cx is the chain

be any point not in the real hyperplane arrangement VR.

Cx = x + iRd = {x + iy : y ∈ Rd},

oriented via the standard orientation on Rd. Because the linear functions (cid:96)j deﬁning A have real coeﬃcients,
(cid:96)j(x + iy) = 0 only if (cid:96)j(x) = 0 = (cid:96)j(y), so the entire ﬁber Cx is disjoint from V. The point x is called
the basepoint of the ﬁber Cx. If B is a connected component of the real domain of holomorphicity
MR := Rd

∗ \ VR then the homotopy

tx + (1 − t)x(cid:48) + iRd for t ∈ [0, 1]

deﬁnes a homotopy between Cx and Cx(cid:48) for any x, x(cid:48) ∈ B. Thus, the homology class of Cx in Hd(M, −∞)
depends only on the component B of MR containing x, and we denote this homology class by CB.
Remark 3.9. The height function hˆr is unbounded from below on any unbounded component of MR. Thus,
.
= 0 whenever x lies in an unbounded component of MR since we can move x within B until its height
Cx
is less than hmin, at which point the whole ﬁber Cx lies in M<hmin
. The fact that imaginary ﬁbers of
components on which hˆr is bounded from below form a basis of Hd(M, −∞) was proved in [39, page 268].

Deﬁnition 3.10 (signs and linking tori). Let A be a simple arrangement, ˆr be ﬁxed, and σ ∈ Ω. Suppose
σ ∈ ∂B for some component B of the real complement MR = Rd
∗ \ VR of the arrangement. Let s be the
codimension of the stratum containing σ and let k1, . . . , ks be the indices such that the stratum Sσ is deﬁned
by (cid:96)k1 = · · · = (cid:96)ks = 0. For each of the 2k components B of MR with σ ∈ B, deﬁne the sign of B with
respect to σ by

sgnσ(B) := sgn

(cid:96)ki(x)

,

(cid:32) s
(cid:89)

(cid:33)

where x is any point of B. Thus, the sign is positive on the component not separated from the origin by
any of the s hyperplanes, and alternates across each hyperplane. We also deﬁne the absolute sign of B by

i=1

10

Figure 4: Linking tori for Example 3.6, with the signs associated to each basepoint pictured. A ‘linking
torus’ around the origin with the shown signs will be used to decompose the Cauchy integral representing
generating function coeﬃcients.

sgn(B) = sgn((cid:81)d
otherwise. The linking torus of σ is

j=1 xj) for any x ∈ B. In other words, the sign is +1 if B is in an even orthant and −1

τ σ :=

(cid:88)

B

sgn(B) sgnσ(B)CB,

where the sum is over all B with σ ∈ B.
Example 3.11 (linking tori for Example 3.6). Continuing Example 3.6, recall that the stratum S1,2 is the
singleton point σ1,2 := (1, 1). This is a stratum of codimension two, and the linking torus of σ1,2 is

τ12 := τσ1,2 = Ca − Cb + Cc − Cd,
where a, b, c, and d are points near σ in the four regions carved out by removing the two real lines (cid:96)1 and
(cid:96)2 from R2, enumerated in counterclockwise order with a in the region whose closure contains the origin (see
Figure 4).

Suppose r = (1, 1), so we are in the situation pictured in Figure 4. The critical point σ1 lies on the

codimension one stratum S1 and has linking torus

τ1 := τσ1 = Ce − Cf ,
where e lies in the halfspace deﬁned by (cid:96)1 whose closure contains the origin. Similarly, the critical point σ2
on S2 has linking torus

τ2 := τσ2 = Cg − Ch,
where g lies in the halfspace deﬁned by (cid:96)2 whose closure contains the origin. Note that many of the basepoints
in these linking tori lie in the same components of MR. In particular,

Cb = Ce,

Cd = Cg,

and Cc = Cf = Cg,

11

so the sum of the linking tori around the critical points is

τ1 + τ2 + τ1,2 = Ca − Cc.

In fact, since c lies in an unbounded component of MR we have τ1 + τ2 + τ1,2
again later in our analysis.

.
= Ca, which will come up
(cid:47)

Linking tori appear, in a more general form, in stratiﬁed Morse theory. The work of Goresky and
MacPherson [16, Chapter 10] shows how the topology of M is generated by certain attachment cycles near
σ as σ varies over the critical points of each stratum of V. The cycle near a codimension s critical point
σ has the structure of the product of the normal link, a local cycle which in this case is a small s-torus,
with the tangential cycle, a (d − s)-disk modulo its boundary (speciﬁcally the (d − s)-dimensional downward
gradient ﬂow subspace of h on V near σ). This toral tube intersects Rd in 2s points, and is in fact equal to
τ σ in Hd(M, −∞).

3.2 Results

We split our results into increasing complicated cases.

Simple arrangements in generic directions

All of our topological arguments can already be seen in the case of simple arrangements and generic directions.
First, we identify which collection of critical points will be important in the analysis, which is, in the general
(non-linear) case, a very hard and perhaps undecidable step.

Deﬁnition 3.12 (contributing points). Assume A is simple and ﬁx ˆr ∈ Rd
point if −∇hˆr(σ) ∈ N (σ) and let contrib ⊆ Ω denote the set of contributing points.

>0

. We call σ a contributing

Remarks. (i) The quantity −∇hˆr(σ) is given by (ˆr1/σ1, . . . , ˆrd/σd). If this is in the positive cone N (σ) then
it is in linear space spanned by normals to hyperplanes containing σ, so every contributing point is a critical
point. (ii) Suppose −∇hˆr(σ) is on the relative boundary of N (σ) (e.g., is in the span of some proper subset
of the vectors {b(k) : k ∈ S(σ)}). Then σ is a critical point for the larger ﬂat deﬁned by this proper subset
of hyperplanes and ˆr is not generic. In fact, non-genericity is equivalent to the existence of a critical point
σ ∈ Ω with −∇hˆr(σ) ∈ ∂N (σ).

The heart of this paper, proven in Section 4, is the following result.

Theorem 3.13. If A is simple and ˆr is generic then the domain of integration T in the Cauchy integral
representation (3) satisﬁes

.
=

T

(cid:88)

τ σ .

σ∈contrib

Theorem 3.13 gives a determination of the coeﬃcients {kσ} in Equation (5), namely kσ = 1 when
σ ∈ contrib and zero otherwise. Is this expected or surprising? If the torus T may be expanded up to the
point σ while remaining in T , then the condition σ /∈ contrib is precisely the condition needed to extend the
.
deformation to bypass σ and show that T
= C for some C in M<h(σ). Theorem 3.13 may be understood
to say that the converse holds and, moreover, it holds even if one has to pass through V at various points en
route to σ.

12

One might conjecture that Theorem 3.13 should hold for general rational functions, but this is false. A
counterexample is given in [2], where for certain critical points σ the coeﬃcient kσ may be seen not only to
be nonzero but to take on the surprising value of 3. In other words, when T passes through V en route to
σ, it twists so as to hit V near σ in an unpredictable manner. Hyperplane arrangements are special in that
they do not allow these kinds of shenanigans. We will give more intuition as to why when we discuss the
relation between real hyperplane arrangements and their complexiﬁcations in Section 4.2.

To complete the analysis for simple arrangements in generic directions, saddle point integration results are
quoted from [34], yielding in Theorem 4.16 from Section 4.3 an asymptotic expansion of [znr]F (z) in terms
of eﬀective constants which can be determined an automatic manner. In many cases the leading asymptotic
term is given explicitly. Algorithm 1 summarizes the steps needed to automatically produce these formulae.
Details on our Maple implementation of Algorithm 1 and additional examples are given in Section 4.4. The
main wrinkle in determining dominant asymptotics from the explicit formulae is the possibility that leading
constants in Theorem 4.16 may vanish due to cancellation, which is discussed in Section 4.5.

Algorithm 1: SimpleHyperplaneAsymptotics

Input: Rational function F (z) = G(z)/ (cid:81)m

j=1 (cid:96)j(z)pj with (cid:96)j(z) = 1 − (cid:0)b(j), z(cid:1) linearly independent

Generic direction r = (r1, . . . , rd)

Output: Asymptotic expansion of [znr]F (z) as n → ∞, uniform in compact set around r

if matrix with rows b(j) not full rank for a collection with common solution then

return fail, “not a simple arrangement”

end
get the ﬂats deﬁned by the (cid:96)j(z)
ﬁnd the (unique) critical point in each orthant for each ﬂat by solving Equation (7)
sort the saddles by height function hr and set σ equal to the highest critical point
while no contributing points have been found do

compute the cone N (σ)
if (−∇h)(σ) on boundary of N (σ) then

return fail, “r not a generic direction”

end
if (−∇h)(σ) /∈ N (σ) then

set σ to next lowest height critical point and repeat loop

end
Compute the ideal J (σ) in Equation (15)
if G ∈ J (σ) then

set σ to next lowest height critical point and repeat loop

else

σ is a contributing singularity
repeat above steps to identify contributing singularities of the same height as σ

end

end
calculate asymptotic Φσ at each contributing singularity σ of highest height using Theorem 4.16
return sum of the Φσ from the last step

Non-simple arrangements

Section 5 deals with non-simple F (z) in generic directions r using a partial fraction decomposition. When
F (z) = G(z)/ (cid:81)m
j=1 (cid:96)j(z)pj , with linear dependencies among the normals b(j) to (cid:96)j, it is possible to rewrite
F as (cid:80)s
i=1 Fi where each Fi is of this same form except that the vectors b(j) are linearly independent.

13

This is a known fact from the theory of matroids: the broken circuit complex deﬁned in [9] leads to the
canonical no broken circuit basis [31] for the matroid {b(j) : 1 ≤ j ≤ m}, which may be harnessed for
easy computation of the partial fraction decomposition F = (cid:80)s
i=1 Fi. The main result of Section 5 is the
following algorithm.

Algorithm 2: SimpleDecomp

Input: Rational function F (z) = G(z)/ (cid:81)m
Output: Collection F1(z), . . . , Fr(z) of rational functions with sup(Fj) ⊂ sup(F ) such that

j=1 (cid:96)j(z)pj

F = F1 + · · · + Fr and each Fj has independent support

S ← F (z)
while there exists a summand ˜F of S with broken circuit {i1, . . . , is} do

apply Equation (17) with ij > is such that {i1, . . . , is, ij} is dependent
add the result to S − ˜F

end
collect and simplify summands in S with the same denominator
while there exists summand ˜F of S with numerator in the ideal generated by sup( ˜F ) do

pick among all such ˜F one with maximal total degree in its denominator
write the numerator as a polynomial combination of the elements in its denominator
expand this new fraction and simplify, removing terms in the denominator
collect and simplify summands with the same denominator

end

Non-generic directions

Section 6 deals with non-generic directions r which, beyond some two-dimensional work of Lladser [23], has
not received much previous attention in the literature. Due to the results of Section 5, when addressing
non-generic directions one may assume without loss of generality that F is simple.

Nongeneric directions arise when the domains of dominant singularities from diﬀerent strata collide. If
S is a stratum of codimension k, then each σ ∈ S lies in the set crit(r) for a set of vectors r of dimension
k (projective dimension k − 1). As σ varies over S, these sets foliate an open cone K in Rd. Typically, as
r passes through ∂K there will be a point σ(r) ∈ crit(r) such that σ(r) ∈ contrib on one side of ∂K while
σ(r) /∈ contrib on the other side. Precisely when r ∈ ∂K, it is not deﬁned whether the critical point σ(r) is
in contrib because this is not deﬁned for non-generic directions (as mentioned above, −∇hˆr(σ) lies on the
boundary of the positive cone N (σ)).

The word typically above refers to the fact that these cones themselves are curved versions of central
hyperplane arrangements. Their boundaries are mostly smooth except when two or more bounding surfaces
intersect, corresponding to the stratum of σ dropping in dimension. Our most explicit results are limited to
the most common case, when there is a drop of 1 in dimension. In this sense there is still more work to be
done to obtain a complete understanding of non-generic directions.

We give two types of result. The ﬁrst is the behavior precisely along a non-generic direction when the
critical points of two strata, one of which is precisely one dimension less than the other, overlap. In this
setting, we consider anˆr as n → ∞ when ˆr is a ﬁxed non-generic rational direction; our results may be
extended to r = nˆr + O(1), though we do not pursue that here. Proposition 6.7 in Section 6 gives the
leading asymptotic behavior in terms of certain negative moments of Gaussian distributions, computed in
Proposition 6.2. The second type of result concerns the behavior of ar as r crosses ∂K. Patching from one

14

formula to the other occurs in a scaling window of width (cid:112)|r|, with our most explicit result occurs when all
divisors have power 1.

3.3 Applications

Before going into details we list a few applications of our results.
Example 3.14 (Example 1.1 continued). The simplest case of (2) is the two-server case, where (2) becomes

F (x, y) =

ex+y
(1 − ρ11x − ρ12y)(1 − ρ21x − ρ22y)

(9)

By scaling the x and y variables, asymptotics in all cases of interest follow from a study of

H(x, y) =

ex/ρ21+y/ρ22
(1 − ax − by)(1 − x − y)

where a = ρ11/ρ21 > 0 and b = ρ12/ρ22 > 0. By symmetry we may assume a ≥ b; if a = b then H is not
simple, so we postpone this case until the end of the example. The asymptotic expansion in Theorem 4.16
gives coeﬃcient asymptotics for H, as follows.

Parametrize directions by taking r = (r, 1) with r > 0. The ﬂat deﬁned by 1 − ax − by = 0 has the critical

point

(cid:18)

c1 =

r
(r + 1)a

,

1
(r + 1)b

(cid:19)

,

which is always contributing. Similarly, the ﬂat deﬁned by 1 − x − y = 0 has the critical point

c2 =

(cid:18) r

r + 1

(cid:19)

,

,

1
r + 1

which is always contributing. The ﬂat deﬁned by 1 − ax − by = 1 − x − y = 0 contains a single point
(cid:18) 1 − b
a − b

a − 1
a − b

c12 =

(cid:19)

,

,

which is always a critical point. The point c12 is contributing, and (r, 1) is a generic direction, if and only if
there exist A1, A2 > 0 such that

(−∇h)(c12) =

(cid:18) r(a − b)
1 − b

,

a − b
a − 1

(cid:19)

= A1(a, b) + A2(1, 1);

since we assume a ≥ b, this occurs precisely when 0 < b < 1 < a and

1 − b
a − 1

< r <

(b − a)a
(a − 1)b

.

The points c1, c2, and c12 have corresponding heights
(cid:19)

h1 = −r log

h2 = −r log

h12 = −r log

(cid:18) 1

r + 1

(cid:18) 1

(cid:19)

(cid:19)

+ log(arb)

(cid:18) r

r + 1

(cid:18) r

(cid:19)

r + 1
(cid:12)
1 − b
(cid:12)
(cid:12)
a − b
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

− log

− log

− log

(cid:12)
(cid:12)
(cid:12)
(cid:12)

15

r + 1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

a − 1
a − b

.

The theory developed below shows that h12 is the highest height contributing point whenever c12 is con-
tributing. Otherwise, h1 has the highest height among the contributing points if and only if arb > 1.
Theorem 4.16 determines asymptotics for each of the three diﬀerent asymptotic regimes: if 0 < b < 1 < a
and 1−b

then

a−1 < r < (b−a)a

(a−1)b

[xrnyn]H(x, y) ∼

(cid:18) a − b
1 − b

(cid:19)rn (cid:18) a − b
a − 1

(cid:19)n exp

(cid:104) (1−b)ρ22+(a−1)ρ21
(a−b)ρ21ρ22

(cid:105)

(1 − b)(a − 1)

a − b

.

If those conditions do not hold and arb > 1 then

[xrnyn]H(x, y) ∼

(cid:17)rn

(cid:16)

a +

a
r

(b + br)n

while if those conditions do not hold and arb < 1 then

exp

(cid:105)

(cid:104) aρ21+rbρ22
ab(r+1)ρ21ρ22
((a − 1)rb + a(b − 1))

ab(r + 1)3/2
√

,

2nπr

[xrnyn]H(x, y) ∼

(cid:19)rn

(cid:18)

1 +

1
r

(1 + r)n

exp

(cid:105)

(cid:104) ρ21+rρ22
(r+1)ρ21ρ22
(1 − b + r − ar)

(r + 1)3/2
√

.

2nπr

If a = b (cid:54)= 1 then we are in the non-simple case, and Algorithm 2 provides the decomposition

H(x, y) =

ex/ρ21+y/ρ22
(1 − ax − ay)(1 − x − y)

=

a
a − 1

·

ex/ρ21+y/ρ22
1 − ax − ay

−

1
a − 1

·

ex/ρ21+y/ρ22
1 − x − y

.

Thus, as coeﬃcient extraction distributes over a sum,

[xrnyn]H(x, y) ∼

(cid:17)rn

(cid:16)

a +

a
r

(a + ar)n

exp

(cid:104) ρ21+rρ22
a(r+1)ρ21ρ22
√
(a − 1)

2nπr

(cid:105)

√

a

r + 1

(cid:18)

+

1 +

(cid:19)rn

1
r

exp

(1 + r)n

(cid:105) √

r + 1

(cid:104) ρ21+rρ22
(r+1)ρ21ρ22
√
(a − 1)

2nπr

.

Finally, if a = b = 1 then H(x, y) = ex/ρ21+y/ρ22 /(1 − x − y)2 is simple but has a second order pole.
Theorem 4.16 then implies

[xrnyn]H(x, y) ∼

(cid:19)rn

(cid:18)

1 +

1
r

(1 + r)n √

n

exp

(cid:105)

(cid:104) ρ21+rρ22
(r+1)ρ21ρ22
√
2πr

(r + 1)3/2

.

(cid:47)
Example 3.15 (Pemantle and Wilson [34, Ex. 12.1.3]). Fix r, s ∈ N. A sequence of r + s independent biased
coin ﬂips occurs, with the ﬁrst n ﬂips coming up heads with probability 2/3 and the remaining r + s − n
ﬂips coming up heads with probability 1/3. A player wants to see r heads and s tails, and may pick n. On
average, how many choices of n will be winning choices?

By independence of the coin ﬂips, the probability that n is a winning choice equals

pr,s(n) =

(cid:88)

0≤a≤n

(cid:19)

(cid:18)n
a

(2/3)a(1/3)n−a

(cid:18)r + s − n
r − a

(cid:19)

(1/3)r−a(2/3)s−(n−a),

so fr,s = (cid:80)
generating function F (x, y) = (cid:80)

n≥0 pr,s(n) counts the expected number of winning values of n. It follows that the bivariate
r,s≥0 fr,sxrys is a product of rational functions with linear denominators,

F (x, y) =

1
(1 − 2x/3 − y/3)(1 − x/3 − 2y/3)

.

16

Theorem 4.16 then immediately implies that, for any (cid:15) > 0,

fr,s ∼






(cid:16) 2(r+s)
3s

(cid:16) 2(r+s)
3r

(cid:17)sn (cid:0) r+s
3r

(cid:1)rn

(cid:17)rn (cid:0) r+s
3s

(cid:1)sn

n−1/2 (r+s)3/2√

2
rsπ(s−2r)

√

: r < s/2 − (cid:15)

3

: s/2 + (cid:15) < r < 2s − (cid:15)

n−1/2 (r+s)3/2√

2
rsπ(r−2s)

√

: 2s + (cid:15) < r

as (r, s) → ∞. In particular, the expected number of winning values of n exponentially decreases in the ﬁrst
and last cases, but approaches the constant 3 when s/2 + (cid:15) < r < 2s − (cid:15). Moreover, in this case the leading
term is not an asymptotic series but the single term 3, as discussed in Remark 4.17 (see also [35]). It follows
that when (r, s) → ∞ with s/2 + (cid:15) < r < 2s − (cid:15), the error term |3 − fr,s| decreases exponentially in s.

This work allows, for the ﬁrst time, detailed information at slopes 1/2 and 2 and how behaviour transitions
around such directions. Proposition 6.3 implies that both f2s,s and fs,2s approach 3/2 as s → ∞. More
precisely, Proposition 6.7 implies that the transition, in which dominant asymptotics go from the constant
3 through the constant 3/2 to end up exponentially small, occurs in a scaling window of width s1/2:

where Ψ(z) = 2
π

(cid:82) z
0 e−u2/2 du is the Gaussian error function.

(cid:47)

f2s+t

√

s,s ∼

3
2

(Ψ(t) + 1) ,

4 Simple Arrangements in Generic Directions

Unless otherwise stated, in this section we assume that

F (z) =

G(z)
j=1 (cid:96)pj

(cid:81)m

j (z)

is simple and ˆr is generic.

(H1)

We begin by describing an iterative slide and replace approach to ﬁnding critical points which aﬀect dominant
asymptotics. This iterative algorithm, while correctly determining asymptotics, becomes unnecessary once
we prove Theorem 3.13. Our topological results allow one to shortcut the slide and replace algorithm, since
we know a priori that the easily determined contributing points will be those critical points selected by the
algorithm.

4.1 Slide and replace

Let B denote the collection of bounded components of MR. For σ ∈ crit denote by Adj (σ) ⊆ B the collection
{B : σ ∈ B} of bounded components of MR adjacent to σ. For B ∈ B, we recall that the imaginary ﬁber
CB is well deﬁned in Hd(M, −∞) and independent of the particular basepoint x ∈ B. Let U denote the
.
set unbounded components of MR, so CB
= 0 for any B ∈ U by Remark 3.9. In any orthant the height
function hˆr is strictly convex, so its minimizer on any bounded closed convex set is unique and occurs on
the boundary of the set.

Proposition 4.1. For B ∈ B, let xB denote the unique x ∈ B on which h is minimized. Then B (cid:55)→ xB
deﬁnes a one-to-one correspondence between B and crit.

Proof. The minimizer xB lies in ∂B and thus on some stratum S = SL. The intersection S ∩ B is a
neighbourhood of x in S, therefore x is a local minimum for h on S and thus x is the critical point for the

17

stratum S. We have shown that the range of the map B (cid:55)→ xB is contained in crit, and it remains to show
that the map is a bijection.

Pick any σ ∈ crit and let S = SL be the stratum containing σ. Writing the ﬂat VL as the common
zero set of (cid:96)1, . . . (cid:96)k, the k hyperplanes deﬁned by the (cid:96)j divide Rd into 2k regions each containing a unique
If k = 1 then b(1) is a non-zero
(possibly unbounded) component B of MR whose closure contains σ.
multiple of ∇h(σ), and σ is a local minimum for h precisely on the closure of the component B ∈ Adj (σ)
closer to the origin. When k > 1 none of these k hyperplanes are orthogonal to ∇h(σ), by our assumption
of genericity of r. Therefore there is a unique component B(σ) of MR such that, in a neighbourhood of σ, if
x is on the boundary of B(σ) and v is a vector from x pointing into B(σ) then h increases in the direction
v. Because the point σ is a minimum for h on S, it follows that σ is a local minimum for h on B(σ), hence
by convexity the global minimum for h on B(σ). Thus, we have xB(σ) = σ.

On the other hand, for any other component B(cid:48) (cid:54)= B adjacent to σ there is a point x on the boundary
of B(cid:48), which can be taken arbitrarily close to σ, and a vector v pointing into B(cid:48) such that h decreases at
a linear rate along v. Because σ is a critical point h(x) = h(σ) + O(|x − σ|2) on VL, hence h cannot be
minimized on B(cid:48) at σ. It follows that the choice B(σ) is unique, ﬁnishing the proof.

Given x ∈ B for a bounded component B ∈ B, the slide and replace operation represents the ﬁber Cx in
terms of linking tori and lower ﬁbers. The slide consists of moving x near to the critical point σ := xB on
the boundary of B at which h is minimized. The replacement consists of replacing Cx by τ σ plus a sum of
ﬁbers Cy over points y in components B(cid:48) with h(xB(cid:48)) < h(xB). We illustrate this in an example.
Example 4.2 (slide and replace). The left side of Figure 5 illustrates the slide and replace operation for our
running Example 3.6 when ˆr1 > 2/3. Starting with a basepoint x near the origin in the ﬁrst quadrant,
we slide x near the critical point σ1 in the ﬂat V1. Ideally we would like to replace Cx by τ σ1
but these
chains are not equal. Instead, the linking torus equals Cx − Cy, where y is in the component B(cid:48) lying just
to the right of σ1, and we replace Cx by τ σ + Cy. Repeating the slide and replace operation on Cy yields
Cy = τ σ2 + Cz, where σ2 is the critical point on the next line segment to the right and z is in the unbounded
.
component above σ2. Because Cz
= 0 all ﬁbers have been replaced by tori, so the algorithm is complete and
returns the identity

.
= τ σ1 + τ σ2 .

Cx

The right side of Figure 5 depicts the result of running the same algorithm ˆr1 ∈ (1/3, 2/3). This time x

slides near σ1,2 = (1, 1) and replacing Cx by τ σ1,2

generates three additional imaginary ﬁbers,

with b, c, and d as in Figure 4 above. The points b and d slide to the respective critical points σ1 and σ2,
while the point c slides to inﬁnity. Ultimately, we obtain the same relation

Cx = τ σ + Cb − Cc + Cd

.
= τ σ1 + τ σ2 + τ σ1,2

Cx

observed above.

(cid:47)

Formalizing the slide and replace algorithm leads to the following two results. By the previous proposition

we may index the cycles {CB : B ∈ B} by crit, denoting

Proposition 4.3. The spans of {Cσ : σ ∈ crit} and {τ σ : σ ∈ crit} as Z-modules in Hd(M, −∞) are equal.

Cσ := CB(σ) .

18

Figure 5: Left: When r = (5, 1) we start with the point x near the origin, bring x to the critical point σ1,
.
then add and subtract imaginary ﬁbers to ultimately obtain Cx as a sum of linking tori. Note that Cx(cid:48)
= 0
for x(cid:48) in any component of MR whose closure contains the origin but not x. Right: When r = (1, 1) we
apply the slide and replace algorithm to represent Cx as a sum of the linking tori seen in Figure 4. Note that
the signs in all bounded components not containing Cx cancel in both cases.

Proof. Given σ ∈ crit, we use the deﬁnition of τ σ to write

Cσ = τ σ − sgn(σ)

(cid:88)

sgnσ(B(cid:48))CB(cid:48) .

B(cid:48)∈Adj (σ)\{B(σ)}

(10)

For each B(cid:48) in the sum, the inﬁmum value of h on B(cid:48) is achieved somewhere other than σ, hence B(cid:48) = B(σ(cid:48))
for some σ(cid:48) with h(σ(cid:48)) < h(σ). Therefore, (10) writes Cσ as τ σ plus a linear combination of classes Cσ(cid:48) with
h(σ(cid:48)) < h(σ). Iterating, we express Cσ as an integer sum of classes τ σ (because the iteration ends at null
classes CB(cid:48) where the component B(cid:48) is unbounded). The converse holds since τ σ is by deﬁnition an integer
combination of classes CB for B ∈ Adj (σ).
Proposition 4.4. The collection {τ σ : σ ∈ crit} forms a module basis of Hd(M, −∞) with coeﬃcients
in Z. Furthermore, the change of basis matrix from {Cσ : σ ∈ crit} is upper-triangular, for any total order ≺
that extends the partial order h(σ) < h(σ(cid:48)). This means

for linking constants νσ,σ(cid:48), where νσ,σ(cid:48) = 0 unless σ(cid:48) (cid:22) σ.

Cσ =

(cid:88)

σ(cid:48)∈crit

νσ,σ(cid:48) τ σ(cid:48)

Proof. This relies on the fact that {CB : B ∈ B} form a basis for Hd(M, −∞) with coeﬃcients in Z.
This is essentially Lemma 5.1 and Theorem 5.2 of [30], most of it having been proved in [29] and in [31,
Chapters 3 and 5]. The result then follows from Proposition 4.3, with upper triangularity following from the
fact that σ(cid:48) (cid:22) σ whenever B(σ(cid:48)) ∈ Adj (σ).

4.2 Proof of Theorem 3.13

Proposition 4.4 implies that the (class of the) domain of integration T in the Cauchy integral (3) can be
written as a ﬁnite integer linear combination of linking tori in Hd(M, −∞), while Theorem 3.13 states that
this linear combination is simply a sum of the linking tori corresponding to contributing points. We begin

19

our proof of Theorem 3.13 by characterizing contributing points via a minimizing property of the height
function. Informally, σ ∈ contrib if and only if σ = xB when all hyperplanes other than those containing σ
are dropped from A and B is the component whose closure contains both the origin and σ.

Proposition 4.5. The point σ in the ﬂat Vk1,...,ks is a contributing singularity if and only if σ is the unique
minimizer of hˆr on the convex connected set

Γ = (cid:8)z : (cid:96)kj (z) ≥ 0 for j = 1, . . . , s(cid:9) ∩ {z : σjzj > 0 for j = 1, . . . , d}

consisting of the polyhedron in the orthant containing σ deﬁned by the (cid:96)j(z) and the coordinate axes.

Proof. In any ﬁxed orthant, the strictly convex function h(z) has a unique minimizer on the convex set Γ.
Because σ is critical, and we are in a generic direction, we can write

(−∇h)(σ) =

s
(cid:88)

j=1

ajb(kj )

for some aj ∈ R∗. If aj > 0 for all j then

(∇h)(σ) · (w − σ) =

(cid:16)

1 − w · b(kj )(cid:17)

≥ 0

aj

s
(cid:88)

j=1

for all w ∈ Γ, so h(z) decreases as z moves from w towards σ, and σ minimizes h(z). Conversely, if, say,
a1 < 0 and we pick w such that (cid:96)kj (w) = 0 for j = 2, . . . , s and (cid:96)k1(w) > 0, then (∇h)(σ) · (w − σ) =
a1(1 − b(k1) · w) < 0 and for (cid:15) > 0 suﬃciently small we have v = σ + (cid:15)(w − σ) ∈ Γ with h(v) < h(σ). Thus,
σ is contributing if and only if it is the unique minimizer of hˆr on Γ.

Example 4.6. Continuing Example 3.6, let B be the bounded component of MR whose closure contains
the origin. The cones N (σ1) and N (σ2) are rays which contain −(∇h)(σ1), meaning they are always
contributing points. The critical point σ1,2 = (1, 1) is more interesting. By deﬁnition σ ∈ contrib if and
only if ˆr1 ∈ [1/3, 2/3] and ˆr is generic (which removes the endpoints). For precisely these values of ˆr1, the
point σ1,2 is the minimizer of hˆr on B. When ˆr1 < 1/3 the minimizer of hˆr on B is σ2 on the upper edge
of B, while for ˆr > 2/3 the minimizer is σ1 on the right edge of B.
(cid:47)

Because we want to compute linking constants around critical points far from the origin, we next examine
how they can change when crossing over V. If B is an unbounded component of MR then we write h(σ(B)) :=
−∞ and νσ(B),σ∗ := 0 for any σ∗ ∈ crit.
Lemma 4.7. Fix σ∗ ∈ crit and let B, B(cid:48) be two components of MR in the same orthant as σ∗. Suppose there
B and B(cid:48) are separated by a unique hyperplane Vj not containing σ∗ (so that there is a unique index j such
that (cid:96)j is positive on B and negative on B(cid:48), or vice versa, and that (cid:96)j(σ∗) (cid:54)= 0). Then νσ(B),σ∗ = νσ(B(cid:48)),σ∗ .

Proof. Assume, without loss of generality, that B and B(cid:48) lie in the positive orthant. If both components are
unbounded then νσ(B),σ∗ = νσ(B(cid:48)),σ∗ = 0, and we are done. Otherwise, one of σ(B) and σ(B(cid:48)) is ﬁnite and
must lie on Vj: if not then by strict convexity of h the line segment between them intersects Vj at a point
of lower height than σ(B) and σ(B(cid:48)), contradicting Proposition 4.1.

We may therefore assume that (cid:96)j(σ(B)) = 0, and write

CB − CB(cid:48) = τ σ(B) +

(cid:88)

sgnσ(B(cid:48)(cid:48))CB(cid:48)(cid:48) .

B(cid:48)(cid:48)∈Adj (σ(B))\{B,B(cid:48)}

(11)

20

Figure 6: Deforming the domain of integration from circle to the diﬀerence of two imaginary ﬁbers: stretching
the grey circle in the imaginary direction, on any bounded region the chain converges locally to the red
diﬀerence of ﬁbers.

Grouping the elements of Adj (σ(B)) into pairs of components (β, β(cid:48)) separated only by Vj, we note that Cβ
and Cβ(cid:48) appear with opposite signs on the right-hand side of (11), and that both σ(β) and σ(β(cid:48)) have height
less than σ(B). The result then follows by induction on the maximum heights of σ(B) and σ(B(cid:48)): if σ(B)
.
and σ(B(cid:48)) have height −∞ then CB
= 0, otherwise we have decomposed them as a sum of pairs (β, β(cid:48))
with smaller maximum height whose contributions to (11) cancel.

.
= CB

The last preliminary step is to we express the torus T from the original Cauchy integral in the ﬁber basis.

Let Adj (0) denote the components of MR adjacent to the origin and deﬁne

τ 0 :=

(cid:88)

sgn(O)CB ,

B∈Adj (0)

where sgn(O) is 1 for the positive orthant and alternates across coordinate planes. This was depicted by the
gray ﬁbers in Figure 4.

Proposition 4.8. If T is the chain of integration in (3) then T

.
= τ 0.

Proof. The chain T is parametrized by a map η from the standard torus (R/(2πZ))d deﬁned by

η(θ) := (ε cos θ1 + iδ sin θ1, . . . , ε cos θd + iδ sin θd)
with δ = ε arbitrarily small. Increasing δ to inﬁnity, we note that the chain remains in M and that the
intersection with M≥hmin
converges to the alternating sum of imaginary ﬁbers τ 0. The one-dimensional
story is illustrated in Figure 6.

The following result now immediately implies Theorem 3.13.

Theorem 4.9.

τ 0 =

(cid:88)

τ σ.

σ∈contrib

Proof. Let σ∗ be a critical point in the positive orthant O and B be the unique component of MR in O whose
closure contains the origin. The hyperplanes through σ∗ divide O into regions on which ν·,σ∗
is constant by
Lemma 4.7, taking the common value 1 on the region containing B(σ∗) and vanishing on the other regions
(as their critical points minimizing h have smaller height than σ∗). Proposition 4.5 implies that the origin is
in the closure of the region containing B(σ∗) if and only if σ∗ is contributing, so νσ(B),σ∗ = 1 if σ∗ ∈ contrib
and zero otherwise. A similar argument proves the result for the other orthants of Rd.

21

4.3

Integrals over linking tori

Throughout this section, the assumption that F (z) = G(z)/ (cid:81) (cid:96)j(z)pj is simple and r is generic remain in
force. If G is a polynomial, Proposition 3.7 and Theorem 3.13 imply that when F is a rational function,

[znr]F (z) =

1
(2πi)d

(cid:88)

(cid:90)

σ∈contrib

τ σ

F (z)
zr+1 dz .

(12)

More generally, when G is analytic, there is an extra term on the right decaying faster than any exponential
e−c|r|. In any case, we see that the problem is reduced to evaluating Cauchy integrals over linking tori, which
has been solved, for instance, in [33] and [34, Section 10.3].

In order to provide some intuition, before quoting the general result we look at a special case. Suppose
that σ forms a zero-dimensional stratum, that is, a single point where d of the m hyperplanes intersect.
The linking torus is then homeomorphic to an actual torus (cf. the end of Section 3.1, there is no tube). In
coordinates given by the linear functions deﬁning σ, the linking torus is the product of circles winding once
counterclockwise about the origin in each coordinate. Taking d iterated residues (or, equivalently, a d-fold
residue) one arrives at Proposition 4.11 below.

Deﬁnition 4.10 (logarithmic gradients). The logarithmic gradient of any diﬀerentiable function f is

(cid:18)

∇logf (z) :=

z1

∂f
∂z1

, · · · , zd

(cid:19)

.

∂f
∂zd

(13)

If σ is a critical point on the stratum deﬁned by the intersection of s ≤ d hyperplanes Vk1 , . . . , (cid:96)ks
then the
log-gradient matrix Γ = Γ(σ) is the d × d matrix whose ﬁrst k rows are {∇log(cid:96)kj (σ) : 1 ≤ j ≤ s} and
whose last d − k rows are any d − k standard basis vectors that complete these logarithmic gradients to a
positively oriented basis for Rd.

Proposition 4.11 ([34, Theorem 10.3.3]). Suppose that σ has codimension d and let Γ be the log-gradient
matrix as in Deﬁnition 4.10. If G is a polynomial then

1
(2πi)d

(cid:90)

τ σ

z−r−1F (z) dz =

σ−r
(p − 1)!

G(σ)
| det Γ|

(rΓ−1)p−1 .

When G is analytic, rather than a polynomial, then there is a remainder term decaying faster than an
(cid:3)
exponential function in |r|. When all powers are 1, the right-hand side simpliﬁes to σ−rG(σ)/| det Γ|.

Example 4.12 (d-fold residue). Continuing Example 4.6, suppose ˆr1 ∈ (1/3, 2/3) so that σ1,2 = (1, 1) ∈
contrib. Then Γ(σ1,2) = −

and p = 1, so

(cid:19)

(cid:18)2/3 1/3
2/3

1/3

1
(2πi)d

(cid:90)

τ σ

z−r−1F (z) dz =

1n
| det Γ|

= 3 .

(cid:47)

In general, any linking torus can be expressed as the product of an s-torus with a (d − s)-dimensional
imaginary ﬁber. Under our current assumptions, we can thus always compute s residues and be left with a
(d − s)-dimensional integral in stationary phase. The following result shows that h is well-behaved around
its critical points, so that we will be able to compute the stationary phase integral.

Proposition 4.13 (h is Morse). Let V be the complexiﬁcation of any real hyperplane arrangement and let
σ ∈ V∗ be a critical point of h|S for any stratum S of any dimension k. Then the Hessian matrix of h|S at
σ in any local k-dimensional complex coordinates is nonsingular.

22

Proof. Because σ is a critical point the diﬀerential dh vanishes on S at σ, so h(σ + z) is locally a quadratic
form in z. If x is any real vector then every coordinate of x + iy has increasing modulus as any coordinate
of the real vector y moves away from the origin. Thus, if SR denotes the real part of the stratum S then
hr(z) = − (cid:80)
j rj log |zj| has a local maximum at z = σ on the space σ + iSR with real dimension k and a
local minimum at z = σ on the space σ + SR with real dimension k. In other words, h(σ + z) is Morse at
the origin of S ⊕ i S with middle index.

Proposition 4.13 implies quadratic nondegeneracy of the phase function for the stationary phase integral,

allowing it to be evaluated as a standard saddle point integral.

Proposition 4.14 ([34, Theorem 10.3.4]). Let S = {k1, . . . , ks} and suppose σ lies on the ﬂat VS. Let Γ be
the log-gradient matrix in Deﬁnition 4.10 and M be the d × d matrix whose ﬁrst k rows are the coeﬃcient
vectors {b(kj ) : 1 ≤ j ≤ k} and whose last d − k rows are any d − k standard basis vectors that complete these
gradients to a positively oriented basis for Rd. Deﬁne the (d − k) × (d − k) matrix H to be the Hessian of
φ(y) = r · log (cid:0)σ − iM −1(cid:0) 0

(cid:1)(cid:1)

y

evaluated at y = (y1, . . . , yd−k) = 0, where the logarithm is taken coordinate-wise. Then there is an explicitly
computable asymptotic series in |r| = |r1| + · · · + |rd| beginning

1
(2πi)d

(cid:90)

τ σ

(cid:34)

z−r−1F (z) dz =

(cid:81)

j /∈S (cid:96)j(σ)pj (cid:81)

σ−rG(σ)
1≤j≤s(pkj − 1)!

√

(cid:35)
(2π|r|)−(d−k)/2(rΓ−1)p−1

det H | det Γ|

(cid:18)

×

1 + O

(cid:19)(cid:19)

.

(cid:18) 1
|r|

All asymptotic terms in this series are uniform as σ varies over a compact subset of S.

(cid:3)

Remark 4.15. Raichev and Wilson [36] give explicit formulas for the coeﬃcients in the asymptotic expan-
sion in Proposition 4.14, building on expansions of Hörmander [18, Theorem 7.7.5]; see also Melczer [24,
Proposition 5.3].

We summarize the results of this Section as follows.

Theorem 4.16. Suppose F (z) is simple and r is a generic direction, and let contrib denote the set of
contributing singularities for F (z). Then as r → ∞ with ˆr staying in a compact subset of Rd
>0 consisting of
only generic directions there exist asymptotic series Φσ(r) such that

[zr]F (z) =

(cid:88)

Φσ(r).

σ∈contrib(ˆr)

(14)

If σ lies on the ﬂat VS with S = {k1, . . . , ks} then, for any positive integer K, there exist eﬀective constants
C σ

j such that

Φσ(r) = σ−r |r|pk1 +···+pks −(s+d)/2

j |r|−j + O (cid:0)|r|−K−1(cid:1)
C σ

 .





K
(cid:88)



j=0

If G(σ) (cid:54)= 0 then the leading asymptotic term of Φσ is given by Proposition 4.14. The error term varies
uniformly as ˆr varies without crossing nongeneric directions and σ varies over a compact subset of any
stratum.
Remark 4.17. When σ has dimension zero and G is a polynomial then Φσ = σ−nrPσ(n), where Pσ(n)
is a polynomial in n of degree pk1 + · · · + pkd − d which can be determined exactly. The asymptotic
expansion in deceasing powers of |r| has no further terms and the remainder is exponentially decreasing in
|r|. This phenomenon, that asymptotic behaviour can be determined in this case up to an exponentially
small remainder, was previously noted by Pemantle [35].

23

Figure 7: Real singularities and contributing points of the rational function in Example 4.18. No singularities
outside the ﬁrst quadrant are contributing.

4.4

Implementation and Additional Examples

A Maple implementation of Theorem 4.16 via Algorithm 1 is available at

https://github.com/ACSVMath/ACSVHyperplane

and allows the user to easily derive asymptotics for a generic direction in the non-simple case. We illustrate
a few additional examples here, pointing out the computer algebra issues which arise.
Example 4.18. Consider asymptotics in the main diagonal direction r = (n, n) for the rational function

F (x, y) =

1
(1 − 2x − y)(1 − x − 2y)(1 − 4x − 3y/2)(1 − 2x/3 − 2y/3)

,

whose real singularities and contributing points are illustrated in Figure 7. The algorithm detects 5 con-
tributing points: note that one of the common intersections of two factors is contributing while the other
intersections (one in the ﬁrst quadrant and further intersections in the other quadrants) are not contributing.
The algorithm then computes asymptotic contributions with leading terms

64 · 8n
√
nπ
11

,

9n
3

,

32 · 8n
√
nπ
3

,

giving dominant asymptotics

[xnyn]F (x, y) =

10368 · 24n
√

,

625

nπ

−128 · (16/9)n
√

,

625

nπ

10368 · 24n
√

625

nπ

(cid:18)

1 + O

(cid:19)(cid:19)

.

(cid:18) 1
n

(cid:47)
Example 4.19. Our previous examples have been restricted to dimension 2, and admitted contributing points
in the ﬁrst quadrant only, in order to guide intuition and allow for visualization. In order to illustrate our
results in a more general setting we consider the rational function

F (x, y, z, w) =

1
(1 + 2x + y + z + w)(1 − x − 3y − z − w)(1 − x + y − 4z + w)(1 − x − y + z − 5w)

in the direction r = (n, 2n, n, 2n). Here there are 20 contributing singularities in multiple orthants, many
ﬂats have contributing singularities in multiple quadrants, and several contributing points have irrational

24

coordinates. We use the symbolic-numeric methods of Melczer and Salvy [25] to store the coordinates of
the contributing points: for each contributing point σ the algorithm outputs an algebraic number α deﬁned
by a square-free integer polynomial P (u) and isolating interval, together with integer polynomials Qj(u) for
each coordinate, such that the jth coordinate σj = Qj(α)/P (cid:48)(α).

For example, the ﬂat deﬁned by

0 = 1 + 2x + y + z + w = 1 − x − 3y − z − w = 1 − x + y − 4z + w = 1 − x − y + z − 5w

contains three critical points, two of which are contributing points with coordinates

(cid:26)(cid:18) −3w − 1

2

,

3 − 3w
4

,

11w − 3
4

(cid:19)

: 99w3 − 61w2 − 9w + 3 = 0, w ≈ .1791 . . . or .6843 . . .

(cid:27)

containing algebraic numbers of degree three (the ﬁnal algebraic conjugate is critical but not contributing).
The algorithm encodes these numbers as

(x, y, z, w) =

(cid:18) Qx(u)
P (cid:48)(u)

,

Qy(u)
P (cid:48)(u)

,

Qz(u)
P (cid:48)(u)

,

Qw(u)
P (cid:48)(u)

(cid:19)

evaluated at the roots of P (u) = 2970u3 − 282927u2 + 8961876u − 94409378 of value approximately 29.731
and 34.86, where

Qx(u) = −7200u2 + 459750u − 7326354
Qz(u) = −1650u2 + 100215u − 1504811

Qy(u) = 5310u2 − 335979u + 5298699
Qw(u) = 1830u2 − 117882u + 1896944.

The roots of u are given to suﬃcient precision to separate them among those of P . The algorithm also com-
putes the constants giving −(∇hr)(z) as a linear combination of the coeﬃcient vectors b(j), and determines
u with enough accuracy to decide whether all these constants are positive (in which case the critical point
is contributing) or whether any are zero (in which case r is a non- generic direction).

There is some randomness in selecting the polynomial P (u); see Melczer and Salvy [25] for the advantages
of this representation and how to compute it, and the Maple worksheet accompanying this paper for more
details on this example. Computing the asymptotic contributions of each contributing point here gives
dominant asymptotics of the form

[xnynznwn]F (x, y) =

−11072781

(cid:32)

C
π

√

249 − 54475983
3125

(cid:33)n

(cid:18)

1 + O

n−1

(cid:19)(cid:19)

,

(cid:18) 1
n

where C = −0.109 . . . is an explicit degree 4 algebraic number.

(cid:47)

4.5 Vanishing of Leading Coeﬃcients

To ﬁnd dominant asymptotics of [znˆr]F (z) using Theorem 4.16, one starts with a contributing singularity
σ of largest height and tries to ﬁnd the ﬁrst constant C σ
which is non-zero, repeating the process until all
j
maximum height contributing singularities have been examined. If the right-hand side of (14) is non-zero,
such a non-zero constant C σ
exists and will eventually be found. When there is a unique contributing point
j
σ of maximal height with G(σ) (cid:54)= 0 then this gives dominant asymptotic behaviour. If, however, there is
more than one such contributing point then it is possible that their sum will sometimes be of smaller order:
for instance, if F (z) = 1/(1 − z2) our algorithm will correctly return [zn]F (z) = 1 + (−1)n. For generic
directions r the leading term in our asymptotic statement will be non-zero.

A more serious diﬃculty occurs when all C σ
j

vanish at all contributing points σ of largest height. This
implies an exponentially smaller estimate Φρ holds, where ρ is a critical point of height less than σ. We give
additional details on this in Theorem 4.27 below, after some examples illustrating the possible outcomes.

25

Example 4.20. Consider the rational functions

A(x, y) =

1 − x − y
1 − x − y

, B(x, y) =

1
1 − x − y

, C(x, y) =

x − 2y2
1 − x − y

,

and D(x, y) =

x − y
1 − x − y

.

These functions share the same denominator, and all appear to admit the single contributing singularity
σ = (1/2, 1/2). Of course, A only appears to admit this point because it is not simpliﬁed in lowest terms
(simpliﬁed it is the constant 1) but σ is a contributing point of B, C, and D. Applying Theorem 4.16 to the
main diagonal of B gives

[xnyn]B(x, y) = 4n

(cid:18)

√

1
πn1/2

(cid:16)

+ O

n−3/2(cid:17)(cid:19)

.

Because the numerator of C(x, y) vanishes at σ we determine dominant asymptotic behaviour of its main
diagonal by computing higher order constants, ultimately obtaining

[xnyn]C(x, y) = 4n

(cid:18)

1
πn3/2

√
4

(cid:16)

n−5/2(cid:17)(cid:19)

.

+ O

Finally, direct inspection shows that the main diagonal of D is identically zero, but applying Theorem 4.16
in an automatic manner only allows us to show for any K > 0 that

[xnyn]D(x, y) = O

(cid:18) 4n
nK

(cid:19)

.

Note that for any a > 0 we have

[xanyn]D(x, y) =

(cid:19)n (cid:32)

(cid:18) (a + 1)a+1
aa

a − 1
(cid:112)2πa(a + 1)n

(cid:16)

n−3/2(cid:17)

+ O

(cid:33)

,

so that the exponential growth of [xanyn]C(x, y) approaches 4n as a → 1.
(cid:47)
Remark 4.21. Such unexpected exponential drops are related to the connection problem from enumerative
combinatorics: given a sequence satisfying a linear recurrence relation with polynomial coeﬃcients—including
any diagonal sequence [znr]F (z) with F rational—one can compute a ﬁnite asymptotic basis of functions such
that dominant asymptotics of the sequence under consideration is a C-linear combination of basis elements.
The real coeﬃcients in such a linear combination of basis elements can be determined rigorously to any
desired numerical accuracy [38, 27], however it is still unknown whether it is decidable to determine which
constants are exactly zero (see also Section VII.9 of Flajolet and Sedgewick [13]).

When σ forms a zero-dimensional stratum, things are better. The degree of the polynomial produced by
Proposition 4.11 is bounded above by the sum of (pj − 1) over those j such that (cid:96)j(σ) = 0. It follows that
testing Φσ = 0 can be done rigorously by computing a suﬃcient number of eﬀective coeﬃcients. When the
contribution of all maximal height contributing singularities is known to vanish, one can repeat this eﬀective
process on the contributing singularities of next highest height, and so on. We now give an example where
the highest contributing critical point σ is of dimension zero and it is indeed necessary to go to the next
lower critical point.
Example 4.22. Let

F (x, y) =

(cid:0)1 − 2x+y
3
and consider asymptotics in the direction (r, s) = n(α, 1 − α) for α = ˆr1 ∈ (2/3, 3/4). This rational function
has the same denominator the one in Example 3.6, so all critical points, contributing singularities, etc. are
the same. In particular, the point σ1,2 = (1, 1) is a contributing singularity of maximal height. This time
the contribution at Φσ1,2
is identically zero: this is easy to discover because our degree bound implies the
leading asymptotic term is a polynomial of degree zero, and one need only evaluate the ﬁrst coeﬃcient.

(cid:1)

3

x − y
(cid:1) (cid:0)1 − x+2y

26

Alternatively, one may verify that the numerator x − y is in a speciﬁc ideal described below. Dominant
asymptotics of ar,s are thus determined by Φσ1
, where σ1 and σ2 are the one-dimensional critical
and Φσ2
points

σ1 =

, 3(1 − α)

and

σ2 =

3α,

(cid:18) 3α
2

(cid:19)

(cid:18)

3(1 − α)
2

(cid:19)

.

Exponentiating the heights of σ1 and σ2 gives the values

h1 =

1
3(1 − α)

(cid:18) 2(1 − α)
α

(cid:19)α

h2 =

2
3(1 − α)

(cid:18) 1 − α
2α

(cid:19)α

,

and basic calculus shows






h1 < h2
h1 = h2
h1 > h2

: α ∈ (1/3, 1/2)
: α = 1/2
: α ∈ (1/2, 2/3)

.

Thus, Theorem 4.16 implies

ar,s =

(cid:18) 1
3α

(cid:19)r (cid:18)

(cid:19)s

2
3(1 − α)

(r + s)−1/2

for α ∈ (1/3, 1/2), while

ar,s =

(cid:18) 2
3α

(cid:19)r (cid:18)

(cid:19)s

1
3(1 − α)

(r + s)−1/2

(cid:32)

(cid:32)

√

2

−3
2(cid:112)(1 − α)απ

+ O (cid:0)(r + s)−1(cid:1)

√

2
3
2(cid:112)(1 − α)απ

+ O (cid:0)(r + s)−1(cid:1)

(cid:33)

(cid:33)

for α ∈ (1/2, 1/3). When α = 1/2 dominant asymptotic behaviour is given by the sum of these contributions,
which cancel, reﬂecting the fact that the main diagonal of F (x, y) is zero by symmetry.
(cid:47)

Exponential growth rates and the annihilating ideal

As we have seen, asymptotic growth of a coeﬃcient sequence can be lower than that predicted by the highest
height contributing points for some ﬁxed direction. For this reason, it is useful to introduce two diﬀerent
directional exponential rates.

Deﬁnition 4.23. The (limsup) exponential rate of a sequence as in the direction r is the quantity

1
n
while the (limsup) neighbourhood exponential rate is

β(r) := lim sup
n→∞

log |anˆr|,

β(r) := lim sup

s→∞
s/|s|→ˆr

1
|s|

log |as|.

The (neighbourhood) exponential growth rate of a generating function is the (neighbourhood) exponential
growth rate of its coeﬃcient sequence.

Using the limsup helps smooth behaviour because many combinatorial sequences have periodicity, either
exact with period k (e.g., terms vanish for certain values of n mod k) or via a phase term such as a factor
of cos(nθπ) for some, possibly irrational, θ. The reason to look at neighbourhood growth rates is explained
by Example 4.20: for all the functions but the trivial case of A(x, y) = 1 we saw that

while the behavior precisely on the diagonal has a polynomial drop (for C) or is identically zero (for D).

β(1, 1) = h1/2,1/2(σ) = log 4,

27

Lemma 4.24. The neighbourhood exponential rate does not increase when multiplying F (z) by any Laurent
polynomial κ(z).

Proof. Multiplication by κ translates into the convolution of the series F with the Laurent polynomial κ.
The claim follows as κ has ﬁnite support.

Remark 4.25. The (non-neighbourhood) exponential rate of a sequence can change both increase and decrease
when multiplying its generating function by a polynomial. For instance,

F (x, y) =

F (x, y) =

F (x, y) =

1
1 − x − y

x − y
1 − x − y

x(x − y)
1 − x − y

=⇒ β(1, 1) = log 2

=⇒ β(1, 1) = 0

=⇒ β(1, 1) = log 2.

On a heuristic level, what is going on is that algebraic and analytic techniques can detect the neigh-
bourhood rate better than they can detect delicate behaviors such as cancellation among sums of powers of
algebraic numbers. Algebraic cancellation3 can be detected using the following deﬁnition.

Deﬁnition 4.26 (annihilating ideal). The annihilating ideal of a ﬂat Vk1,...,ks

is the polynomial ideal

J (L) := (cid:104)(cid:96)kj (z)pkj : j = 1, . . . , s(cid:105)

(15)

and the annihilating ideal of a point σ on the stratum Sk1,...,ks

is J (σ) := J (Vk1,...,ks).

The annihilating ideal contains precisely the functions G such that the singular set of

does
. Indeed, if G(z) ∈ J (σ) then G(z) can be rewritten as a polynomial linear combination
not contain Vk1,...,ks
of the (cid:96)kj (z)pkj , meaning that F can be decomposed as a sum of meromorphic functions whose poles do
not contain L. For polynomials, the condition G ∈ J (σ) can be veriﬁed automatically by, for instance, a
Gröbner basis computation.

G(z)
j=1 (cid:96)j (z)pj

(cid:81)m

Theorem 4.27. Consider a simple arrangement in a generic direction r, let σ be a point in a stratum S of
codimension s deﬁned by the vanishing of the linear functions (cid:96)k1, . . . , (cid:96)ks, and let J (σ) be the annihilating
ideal.

(i) If G ∈ J (σ) then the asymptotic series Φσ(r) deﬁned in Theorem 4.16 has exponential growth strictly
less than hr(σ). Hence, if all other critical points σ(cid:48) with hˆr(σ(cid:48)) ≥ hˆr(σ) are ruled out by Algorithm 1
then

β(ˆr) < hˆr(σ) .

(ii) If G /∈ J (σ) then Φσ(r) has neighbourhood exponential growth at least hr(σ). In other words, if all

critical points σ(cid:48) with hˆr(σ(cid:48)) > hˆr(σ) are ruled out by Algorithm 1 then

3Topological cancellation, which can also cause a drop in the limsup neighbourhood exponential rate, is harder to study.

See [2] for one example of this.

β(ˆr) = hˆr(σ) .

28

Proof. First we prove (i). If G = (cid:80)s
where the fj are locally analytic functions on a neighbourhood
of σ then we can write F as a sum of meromorphic functions whose pole sets no longer contain the stratum
S. In generic directions this implies that Φσ(r) can be written as a sum of integrals over imaginary ﬁbers
with basepoints arbitrarily close to critical points of lower height than hr(σ), giving the stated result.

j=1 fj(cid:96)pj

j

To prove (ii) we make an analytic change of coordinates z = (u, v) by setting vj = (cid:96)kj (z) for j = 1, . . . , s
and letting u be d − s remaining coordinates parametrizing the ﬂat L containing S near s. We can rewrite
G in these coordinates as

G =

(cid:88)

cm(u)vm +

s
(cid:88)

vpj
j ˜cj(u, v),

(16)

m∈Ns:mj <pj

j=1

where each cm(u) is an analytic function on L and each ˜cj(u) is an analytic function in a vicinity of σ in Cd.

Reasoning as in part (i), the contribution of each term in the second sum of (16) has an exponential rate
strictly less than hˆr(σ), while the ﬁrst sum of (16) identically vanishes if and only if G lies in the ideal J (σ).

Assume ﬁrst that p = 1, so σ is a simple pole and the ﬁrst sum in (16) contains only the term c0(u). If
c0(0) (cid:54)= 0 then the leading term of Φσ(r) given by Proposition 4.14 is nonzero, and we have found the correct
exponential rate hˆr(σ). Similarly, if c0(u) (cid:54)= 0 for some point u in any suﬃciently small neighbourhood of
the origin then, because the non-degenerate critical point σ(r) on the stratum S varies smoothly with r, the
neighbourhood exponential rate is hˆr(σ). The only other case occurs when c0 vanishes in a neighbourhood
of zero, but then c0 is identically zero by analyticity, meaning G ∈ J (σ).

Now let p be general and recall Lemma 4.24, which states that multiplying F by any Laurent polynomial
vm does not increase its neighbourhood exponential growth. If c0 is not identically zero then the argument
from the simple pole case implies that the neighbourhood exponential rate is hˆr(σ), and we are done. If
c0 is identically zero then multiplying F by vp−1−ek , where ek has a 1 in coordinate k and 0 elsewhere,
gives a sum of rational functions which, in (u, v) coordinates, is cek (u)
plus a sum of terms that each miss
v1···vs
at least one variable vj from their denominator, and thus have exponentially smaller asymptotic growth.
Applying the argument from the simple pole case to each cek (u)
shows that if cm is not identically zero for
v1···vs
some vector m with |m| = 1 then the neighbourhood exponential rate is hˆr(σ). If all terms cm with |m| = 1
are identically zero, then the argument can be repeated on the terms cm with |m| = 2, and so on until the
result is established.

5 Non-Simple Arrangements in Generic Directions

Any rational function whose singular set forms a non-simple hyperplane arrangement can be decomposed
into a ﬁnite sum of rational functions, each of which has a singular set that deﬁnes a simple hyperplane
arrangements. To make this explicit we use a known, canonical partial fraction expansion in terms of the
no-broken-circuit basis for the matroid {b(1), . . . , b(k)} for each ﬂat with some codimension (cid:96) and k ≥ (cid:96)
hyperplanes. We begin with an example.
Example 5.1. Consider F (x, y) = 1/((cid:96)1(cid:96)2(cid:96)3) as shown in Figure 8, where

(cid:96)1(x, y) = 1 − x/3 − 2y/3

(cid:96)2(x, y) = 1 − 2x/3 − y/3

(cid:96)3(x, y) = 1 − 3x/5 − 2y/5 .

In the main diagonal direction r = (1, 1), F admits contributing points (3/2, 3/4), (3/4, 3/2), and
(5/6, 5/4) on the ﬂats V1, V2, and V3, respectively, and contributing point (1, 1) which is the single point
in all the ﬂats V1,2, V1,3, V2,3, and V1,2,3. As the three lines (cid:96)1, (cid:96)2, and (cid:96)3 in two dimensions have common

29

Figure 8: Real singularities and contributing points of the rational function in Example 5.1. All three factors
intersect at the point (1, 1), meaning F is not simple.

intersection point (1, 1), they are linearly dependent. Basic linear algebra allows one to derive

Dividing this equation by (cid:96)3(x, y) gives

(1/5)(cid:96)1(x, y) + (4/5)(cid:96)2(x, y) = (cid:96)3(x, y) .

(1/5)

(cid:96)1(x, y)
(cid:96)3(x, y)

+ (4/5)

(cid:96)2(x, y)
(cid:96)3(x, y)

= 1,

so that

F (x, y) =

1
(cid:96)1(x, y)(cid:96)2(x, y)(cid:96)3(x, y)

=

1/5
(cid:96)2(x, y)(cid:96)3(x, y)2
(cid:123)(cid:122)
(cid:125)
(cid:124)
F1

+

4/5
(cid:96)1(x, y)(cid:96)3(x, y)2
(cid:123)(cid:122)
(cid:125)
(cid:124)
F2

.

Both F1(x, y) and F2(x, y) are simple, so we can apply Theorem 4.16 to obtain dominant asymptotics. For
instance, in the direction r = (1, 1) the function F2 admits the point (1, 1) as its contributing singularity
determining dominant asymptotics, while (1, 1) is not a contributing singularity of F1. The contributing
singularity of F1 which determines dominant asymptotics is (5/6, 5/4), meaning the diagonal coeﬃcients of
F1 decay exponentially. Thus, Theorem 4.16 gives

[xnyn]F (x, y) = (1/5)[xnyn]F1(x, y) + (4/5)[xnyn]F2(x, y)

(cid:18)

=

15n
4

1 + O

(cid:19)(cid:19)

.

(cid:18) 1
n

(cid:47)

To generalize this approach, we introduce some deﬁnitions. The support of a rational function is the

set of divisors appearing in the denominator when in lowest terms. In other words,

(cid:18)

sup

G(z)
(cid:96)1(z)q1 · · · (cid:96)m(z)qm

(cid:19)

:= {(cid:96)j(z) : qj > 0}

when no (cid:96)j divides G.

As in the theory of matroids, we call any minimal linearly dependent set {(cid:96)i1, . . . , (cid:96)is } a circuit. A
broken circuit is the independent collection obtained from any circuit by removing the element (cid:96)j with
largest index j. A collection is said to be χ-independent if it does not contain a broken circuit; note that
any χ-independent set is also linearly independent.

30

In Example 5.1 the set {(cid:96)1, (cid:96)2, (cid:96)3} is the only circuit, so {(cid:96)1, (cid:96)2} is the only broken circuit. Note that the
supports of the two rational functions which we analyze, (cid:96)1(cid:96)2
, correspond to χ-independent sets
3
{(cid:96)1, (cid:96)3} and {(cid:96)2, (cid:96)3}. This is no coincidence: Proposition 5.2 below shows that one can always decompose
a rational function into a sum of rational functions whose supports are χ-independent, and the following
shows in general one can make no further simpliﬁcations.

and (cid:96)2(cid:96)2
3

Proposition 5.2. Let (cid:96)1, . . . , (cid:96)m be any m linear functions of d variables.

(i) The set of rational functions

(cid:26)

1
(cid:96)i1(z) · · · (cid:96)is(z)

: {(cid:96)i1, . . . , (cid:96)is } is χ-independent

(cid:27)

is linearly independent over C.

(ii) The span over C of the rational functions

(cid:40)

1
(cid:96)i1(z)p1 · · · (cid:96)is(z)ps

: {(cid:96)i1 , . . . , (cid:96)is} is χ-independent and

(cid:41)

pi = M

s
(cid:88)

i=1

contains the inverses of all products of the (cid:96)j over multisets of cardinality M .

(iii) Algorithm 2 terminates in a ﬁnite number of steps and outputs a sum of rational functions whose

supports contain no broken circuits.

Proof. The ﬁrst conclusion follows from standard results on hyperplane arrangements; see Orlik and Terao [31,
Theorems 3.43, 3.126, 5.89] or Pemantle and Wilson [34, Prop. 10.2.10].

To prove the second, given any linear dependence

0 = a1(cid:96)i1(z) + · · · + as(cid:96)is (z)

with each ai (cid:54)= 0, one can divide by any ajlij (z) and then by some product of all (cid:96)k(z) to obtain

1
(cid:96)q =

1
(cid:96)1(z)q1 · · · (cid:96)m(z)qm

=

(cid:88)

k(cid:54)=j

(−ak/aj)
(cid:96)q+e(ij )−e(ik )

(17)

for any q ∈ Nm, where e(κ) is the elementary basis vector with a one in the κth coordinate and all other
coordinates zero.

Given any rational function F (z) = G(z)/(cid:96)p whose support contains a broken circuit {i1, . . . , is} with
indices in increasing order, one can apply the base exchange equation (17) with any ij > is such that
{i1, . . . , is, ij} is linearly dependent; such an ij exists by the deﬁnition of a broken circuit. At each step,
on the right hand side of Equation (17) has smaller lexicographical order than q.
every vector q + eij − eik
Therefore, repeating the process formalized in Algorithm 2, one must eventually arrive at an expression for F
as a sum of rational functions whose supports contain no broken circuits. The second while loop terminates
because any time a summand ˜F is further decomposed into several summands, the supports of these new
rational functions are subsets of the support of ˜F , and the new functions have denominators of smaller total
degree than the denominator of ˜F . This proves part (iii), and thereby, part (ii).

Example 5.3. If

(cid:96)1 = 1 − 2x − 2y + 2z,

(cid:96)2 = 1 − 2x,

(cid:96)3 = 1 − 2y,

(cid:96)4 = 1 − 2z,

(cid:96)5 = 1 − x − y

31

then the circuits are the sets

and the broken circuits are the sets

{(cid:96)1, (cid:96)2, (cid:96)3, (cid:96)4},

{(cid:96)1, (cid:96)4, (cid:96)5},

{(cid:96)2, (cid:96)3, (cid:96)5},

The collection of χ-independent sets is

{(cid:96)1, (cid:96)2, (cid:96)3},

{(cid:96)1, (cid:96)4},

{(cid:96)2, (cid:96)3} .

∅

{(cid:96)1}

{(cid:96)2}

{(cid:96)3}

{(cid:96)4}

{(cid:96)5}

{(cid:96)1, (cid:96)2} {(cid:96)1, (cid:96)3} {(cid:96)1, (cid:96)5}

{(cid:96)2, (cid:96)4}

{(cid:96)2, (cid:96)5}

{(cid:96)3, (cid:96)4}

{(cid:96)3, (cid:96)5}

{(cid:96)4, (cid:96)5}

{(cid:96)1, (cid:96)2, (cid:96)5} {(cid:96)1, (cid:96)3, (cid:96)5}

{(cid:96)2, (cid:96)4, (cid:96)5}

{(cid:96)3, (cid:96)4, (cid:96)5} .

Consider the rational function

F (x, y, z) =

1
(cid:96)1(x, y)l2(x, y)l3(x, y)l4(x, y)l5(x, y)2 .

Running Algorithm 2 gives the decomposition

F (x, y, z) =

1
4(cid:96)2(x, y)(cid:96)4(x, y)(cid:96)5(x, y)4 +
1
4(cid:96)1(x, y)(cid:96)2(x, y)(cid:96)5(x, y)4 +

1
4(cid:96)3(x, y)(cid:96)4(x, y)(cid:96)5(x, y)4
1
4(cid:96)1(x, y)(cid:96)3(x, y)(cid:96)5(x, y)4 .

+

Each of these summands is now simple, and we may use our Maple implementation of the results in Section 4
to ﬁnd asymptotics in direction r = (1, 2, 3), say. The summands have dominant coeﬃcient asymptotics

(cid:32)

√

(cid:33)

42

81

224

54nn5/2,

(2/3) 64nn3,

−(−27648)n
5πn

,

−(−27648)n
4πn

,

respectively, so that

[xny2nz3n]F (x, y, z) =

−9(−27648)n
20πn

(cid:18)

1 + O

(cid:19)(cid:19)

.

(cid:18) 1
n

(cid:47)

j=1 (cid:96)mj

Part (i) of Theorem 4.27 continues to hold for non-simple arrangements. In particular, there is an ideal
J such that G ∈ J implies G/ (cid:81)m
decomposes into a sum of rational functions whose denominators
have poles on at most k − 1 hyperplanes, k being the co-dimension of the ﬂat containing a given critical
point. Hence for G ∈ J , G/ (cid:81)m
will have neighbourhood exponential rate β(ˆr) < hˆr(σ), provided no
other critical point produces a contribution with exponential rate hˆr(σ). The converse, however, fails for
non-simple arrangements, as shown by the following example.
Example 5.4. Let (cid:96)j = y − 1 − λj(x − 1) for 1 ≤ j ≤ 4 be four real lines through σ = (1, 1), shown in Figure 9,
whose normals have positive slopes νj := −1/λj that decrease in j.

j=1 (cid:96)mj

j

j

The normal cone at σ contains the lines with slopes from ν4 to ν1. Let G(x, y) := (cid:96)1(x, y)(cid:96)2(x, y) +

(cid:96)3(x, y)(cid:96)4(x, y), so

G(x, y)
j=1 (cid:96)j(x, y)

(cid:81)4

=

1
(cid:96)1(x, y)(cid:96)2(x, y)

+

1
(cid:96)3(x, y)(cid:96)4(x, y)

.

As we know from the simple case, this has an exponential rate of zero in directions with slopes in the two
intervals [ν1, ν2] and [ν3, ν4], where σ is the contributing singularity determining asymptotics, and a negative
exponential rate elsewhere. In particular, the exponential rate is negative along directions ˆr with slopes in

32

Figure 9: A non-simple arrangement where the exponential rate drops within a hole N (cid:48) of the normal cone N
at σ = (1, 1).

(ν2, ν3), which are generic and have β(ˆr) < 0 = hˆr(σ). On the other hand, the numerator (cid:96)1(cid:96)3 + (cid:96)2(cid:96)4
leads to two non-canceling contributions rather than to none. Thus, any algebraic test for the numerator to
create a drop in the neighbourhood exponential rate must take into account speciﬁc normal cones. While
this may seem trivial in low dimensions, computation of the chamber decomposition of the normal cone at
σ is in general a high complexity computation, and the description of the set of numerators for which the
neighbourhood exponential rate drops is correspondingly diﬃcult to compute.
(cid:47)

6 Simple Arrangements in Non-Generic Directions

We now discuss the analysis in non-generic directions. First, we see how asymptotics behave in an exact
non-generic direction. Then, we study transitions in asymptotic behaviour around non-generic directions.

6.1 Exact non-generic directions

Fix a direction ˆr and suppose F admits a unique contributing singularity σ of highest height, contained in
the stratum S1,...,t. Suppose σ is a non-generic direction such that

(−∇h)(σ) = a1b(1) + · · · + asb(s) + 0 · b(s+1) + · · · + 0 · b(t)

(18)

for some s < t, where each aj (cid:54)= 0 (and thus aj > 0 by the deﬁnition of contributing point). We work in the
simple case, so b(1), . . . , b(t) are linearly independent, and up to permuting coordinates we may assume that
the matrix

M =

























b(1)
...
b(t)
e(t+1)
...
e(d)

has full rank, where e(j) denotes the jth elementary basis vector.

33

Because σ is minimal and has highest height, asymptotic growth of [zr]F (z) is determined, up to an

exponentially negligible error term, by the integral

I =

1
(2πi)d

(cid:90)

σ−(cid:15)m+iRd

˜G(z)
(cid:96)1(z)p1 · · · (cid:96)t(z)pt

dz
zr ,

where m = M −1 (cid:0)e(1) + · · · + e(t)(cid:1) and

˜G(z) =

G(z)
(z1 · · · zd) (cid:81)

j>t (cid:96)j(z)pj

.

Making the substitution w = M (σ − z) gives

I =

1
| det M |(2πi)d

(cid:90)

(cid:15)(1t,0)+iRd

˜G(σ − M −1w)

1 · · · wpt
wp1

t (σ − M −1w)r dw,

(19)

where 1t denotes the t-dimensional all ones vector. Since the aj in (18) are positive, replacing the domain of
integration in (19) by any of the 2s − 1 imaginary ﬁbers with basepoints (±1s, 1t−s, 0) not equal to (1t, 0)
results in an integral of exponentially smaller growth4. Taking a signed sum of these integrals thus introduces
an exponentially negligible error and results in a (d − s)-dimensional integral obtained by taking univariate
residues in the variables w1, . . . , ws at the origin.

We can be most explicit when p = 1, when the residues of w1, . . . , ws at the origin are obtained by re-
moving the factor (w1 · · · ws) from the denominator and setting these variables equal to zero in the remaining
expression. If p = 1 and we make the change of variables yj = iws+j for j = 1, . . . , d − s, then dominant
asymptotics of [zr]F (z) are given by the integral

I (cid:48) :=

(−1)t−s
| det M |(2π)d−s it−s

(cid:90)

Rd−s+i(cid:15)(1t−s,0)

˜G (cid:0)σ + iM −1(cid:0) 0
y1 · · · yt−s

y

(cid:1)(cid:1)

e−r·log

(cid:16)

σ+iM −1(cid:16) 0
y

(cid:17)(cid:17)

dy,

(20)

where y = (y1, . . . , yt−s). For general p, repeated diﬀerentiation shows [34, Theorem 10.2.6] that the residue
has the form

˜G(σ − M −1w)

(cid:12)
(cid:12)
(cid:12)
t (σ − M −1w)r P (r, w)
(cid:12)
(cid:12)wj =0,1≤j≤s

,

wps+1
s+1 · · · wpt

where P is a multivariate polynomial in r of degree p1 + · · · + ps − s having leading term

R(w) =

s
(cid:89)

k=1

1
(pk − 1)!





d
(cid:88)

j=1

rjM −1
jk
(σ − M −1w)j



pk−1



.

Thus,

I =

=

1

(cid:90)

˜G(σ − M −1w)R(w)

| det M |(2πi)d−s (cid:81)s

k=1(pk − 1)!

(cid:15)(1t−s,0)+iRd−s

wps+1
s+1 · · · wpt

t (σ − M −1w)r

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)wj =0,1≤j≤s

(cid:18)

dw

1 + O

(cid:19)(cid:19)

(cid:18) 1
|r|

ips+1+···+pt
| det M |(2π)d−s (cid:81)s

k=1(pk − 1)!

(cid:90)

Rd−s+i(cid:15)(1t−s,0)

˜G (cid:0)σ + iM −1(cid:0) 0
yps+1
s+1 · · · ypt

y

t

(cid:0)σ + iM −1(cid:0) 0

y

(cid:1)(cid:1) R(0, −iy)

(cid:1)(cid:1)r dy

(cid:18)

1 + O

(cid:19)(cid:19)

(cid:18) 1
|r|

, (21)

where y = (y1, . . . , yt−s) and |r| = r1 + · · · + rd.

4If ˆr were a generic direction, we would be able to add all 2t ﬁbers and use univariate residues will get rid of all wj in the

integrand denominator.

34

Example 6.1. Consider again the function

F (x, y) =

(cid:0)1 − 2x+y

3

1
(cid:1) (cid:0)1 − x+2y

3

(cid:1) .

The sequence

[x2nyn]F (x, y) =

1
(2πi)2

(cid:90)

(cid:0)1 − 2x+y

3

T

1
(cid:1) (cid:0)1 − x+2y

3

(cid:1)

dxdy
x2n+1yn+1

(22)

is in the non-generic direction r = (2, 1), meaning its asymptotic behaviour can be quantitatively diﬀerent
than what happens when 1/3 < ˆr1 < 2/3 (limit to a constant with exponential error) and 2/3 < ˆr1 < 1 (limit
to zero exponentially with polynomial error). The highest contributing singularity is now σ = σ1,2 = (1, 1)
on the stratum S1,2, which now also coincides with the critical point σ1 on the ﬂat V1.

Since there are no bounded components of MR in any quadrant except the positive quadrant, the Cauchy

integral in (22) equals

[x2nyn]F (x, y) =

=

1
(2πi)2

1
(2πi)2

(cid:90)

((cid:15),(cid:15))+iR2

(cid:90)

(cid:0)1 − 2x+y

3

(1−(cid:15),1−(cid:15))+iR2

(cid:0)1 − 2x+y

3

dxdy
x2n+1yn+1

(cid:1)

1
(cid:1) (cid:0)1 − x+2y
1
(cid:1) (cid:0)1 − x+2y

3

3

dxdy
x2n+1yn+1 .

(cid:1)

Making the change of variables described above shows

[x2nyn]F (x, y) =

3
(2πi)2

(cid:90)

((cid:15),(cid:15))+iR2

1
w1w2

dw1dw2
(1 − 2w1 + w2)2n+1(1 + w1 − 2w2)n+1 .

If

then

˜ω =

1
w1w2

dw1dw2
(1 − 2w1 + w2)2n+1(1 + w1 − 2w2)n+1 ,

[x2nyn]F (x, y) =

3
(2πi)2

(cid:34)(cid:90)

(cid:90)

˜ω −

(cid:35)

˜ω

+ O(τ n)

((cid:15),(cid:15))+iR2

(−(cid:15),(cid:15))+iR2

for some τ ∈ (0, 1). Taking the residue in w1 at the origin then yields
(cid:90)

1

[x2nyn]F (x, y) =

(1 + w2)2n+1(1 − 2w2)n+1 dw2 + O(τ n)

1
w2

3
2πi

=

−3
2πi

(cid:15)+iR

(cid:90)

R+i(cid:15)

1
y(1 + iy)(1 − 2iy)

e−n[2 log(1+iy)+log(1−2iy)]dy + O(τ n).

(cid:47)

The idea behind an asymptotic analysis is to replace the analytic functions in the integrand under
consideration with the leading terms of their power series expansions at the origin. Doing this rigorously
requires extending the asymptotic bounds of [34, Chapter 5] to integrals which are singular at the origin due
to a division by monomial terms. When (−∇hr)(σ) lies on a k-dimensional facet of N (σ), asymptotics of
the dominant term in the residue integral are obtained by analyzing an integral of the form

(cid:90)

Rk+i(cid:15)

yc · e−ytAydy,

where A is a k × k positive-deﬁnite matrix and c ∈ Zk. This can be viewed as a Gaussian negative-moment
integral; although positive moments (c ∈ Nk) of the Gaussian distribution can be determined through the

35

Wick-Isserlis Theorem [21, Theorem 3.2.5], such negative moments do not seem to have received previously
attention in the literature.

We postpone the general discussion of this theory to future work and focus here on the s = d − 1
codimension 1 case, where it is easy to be explicit. In this setting, asymptotics boil down to an analysis of
the integral

which is characterized by the following result.

Proposition 6.2. Let r be a positive integer and a ≥ 0. Then

(cid:90)

R+i(cid:15)

e−at2
tr dt,

(cid:90)

R+i(cid:15)

e−at2
tr dt =

(−i)ra(r−1)/2π
Γ (cid:0) r+1

(cid:1)

2

.

Proof. Suppose that r is odd and a = 1. Then as the integrand under consideration is odd, Cauchy’s Integral
Theorem implies

(cid:90)

R+i(cid:15)

e−t2
tr dt = −

(cid:90)

−R+i(cid:15)

e−t2
tr dt = −

(cid:90)

C

e−t2
tr dt,

where C is the positively oriented unit half-circle above the x-axis. As C is a compact domain of integration,
Fubini’s Theorem implies that we can expand the integrand as a power series, integrate each term using an
explicit parametrization, and sum to obtain

(cid:90)

C

e−at2
tr dt =

(πi)(−1)(r−1)/2
((r − 1)/2)!

=

(−1)r+1ira(r−1)/2π
Γ (cid:0) r+1

(cid:1)

2

.

The case when r is odd and a is arbitrary is reduced to this case by a linear change of variables.

Now suppose that r is even, and let Jr(a) := (cid:82)

respect to a implies

e−at2
tr dt. Diﬀerentiating under the integral sign with

R+i(cid:15)

for r ≥ 2, while

when r ≥ 2 and

(∂Jr/∂a)(a) =

(cid:90)

R+i(cid:15)

−

e−at2
tr−2 dt = −Jr−2(a)

Jr(0) =

(cid:90)

R+i(cid:15)

1
tr dt = 0

J0(a) =

(cid:90)

R+i(cid:15)

e−at2

dt = (cid:112)π/a.

Solving this recurrence implies

Jr(a) =

(−1)r/2a(r−1)/2√
(r/2 − 1/2)(r/2 − 3/2) · · · (1/2)

π

=

as the diﬀerence equation satisﬁed by the gamma function shows

(−1)rira(r−1)/2π
Γ (cid:0) r+1

(cid:1)

2

,

(cid:18)

Γ

n +

(cid:19)

1
2

=

(2n − 1)(2n − 3) · · · (3)(1)
2n

Γ

(cid:19)

(cid:18) 1
2

=

(2n − 1)(2n − 3) · · · (3)(1)
2n

√

π

for any non-negative integer n.

36

This allows for the following asymptotic determination.

Proposition 6.3. Suppose F (z) is simple and r is a non-generic direction with a unique contributing
singularity of maximal height where G(σ) (cid:54)= 0. If (−∇hr)(σ) lies on the codimension 1 face of N (σ) with

(−∇hr)(σ) = a1 · b(1) + · · · + ad−1 · b(d−1) + 0 · b(d)

for σ in the stratum deﬁned by (cid:96)1 = · · · = (cid:96)d = 0, then as r → ∞,
(cid:18) 1
n

[zr]F (z) = σ−r ·

C + O

(cid:18)

(cid:19)(cid:19)

,

where

d−1
(cid:89)

(cid:0)(cid:0) r1
σ1

· · ·

C =

j=1

(cid:1) · M −1(cid:1)pj −1

j

rd
σd
(pj − 1)!

·

G(σ)
j>d (cid:96)j(σ)pj

(cid:81)

·

(qT q/2)(pd−1)/2
2(σ1 · · · σd) | det M | Γ (cid:0) pd+1

2

(cid:1) ,

M is the matrix with rows b(1), . . . , b(d), and q is the rightmost column of the matrix

√









Q =

r1/σ1
0

√

0
r2/σ2

0
0

0
0

0
0
. . .
0









0
0

√

0
rd/σd

M −1.

If r = nˆr as n → ∞ then the order of growth of [zr]F (z) is σ−rnp1+···+pd−1+pd/2−d+1/2. In the simple
pole case, when p = 1, the leading constant here is half what it would be if r was generic (i.e., if (−∇hr)(σ)
was in the interior of N (σ)).

Proof. In this one-dimensional case, the (now univariate) integral in (21) equals

(cid:90)

I (cid:48) =

R+i(cid:15)

Note that

˜G (cid:0)σ + iM −1(cid:0) 0
(cid:0)σ + iM −1(cid:0) 0
ypd
d

y

y

d−1
(cid:89)

(cid:1)(cid:1)

(cid:1)(cid:1)r





d
(cid:88)

k=1

j=1

rjM −1
jk
(σ + M −1(cid:0) 0

y



pk−1



(cid:1))j

dy.

(cid:90)

I (cid:48) =

R+i(cid:15)

A(y)
ypd

e−ψ(y)dy,

where A(y) and ψ(y) are analytic functions at the origin with

A(y) = ˜G(σ)

d−1
(cid:89)

j=1

(cid:0)(cid:0) r1
σ1

· · ·

rd
σd

(cid:1) · M −1(cid:1)pj −1

j

+ O(y)

(cid:124)

(cid:123)(cid:122)
C1
(cid:1)) = log(σ) + (qT q/2)
ψ(y) = r · log(σ + M −1(cid:0) 0
(cid:125)

(cid:124)

(cid:125)

y

(cid:123)(cid:122)
C2

y2 + O(y3).

The desired result is given by an application of the following lemma.

Lemma 6.4. For some (cid:15) > 0 and k ∈ N let

where

(cid:90)

I =

R+i(cid:15)

y−kA(y)e−nψ(y),

37

• A, ψ are analytic in R + (−2(cid:15), 2(cid:15))i ⊂ C;

• A(y) = a0 + O(y) and ψ(y) = b2y2 + O(y3) at 0;

• ψ(cid:48)(y) = 0 implies y = 0;

• (cid:60)(ψ) ≥ 0 with equality only when y = 0, and |(cid:60)(ψ)| → ∞ as |y| → ∞.

Then

I ∼ a0

(cid:90)

R+i(cid:15)

y−ke−nb0y2

dy =

a0(−i)k(nb0)(k−1)/2
Γ( k+1
2 )

.

Proof. For n > 0 let C1 = (−n−2/5, n−2/5) and C2 = R \ C1, so that

(cid:90)

I =

C1+i(cid:15)

y−kA(y)e−nψ(y)dy +

(cid:90)

C2+i(cid:15)

y−kA(y)e−nψ(y)dy.

The hypotheses on the real part of ψ imply that the integrand under consideration decays exponentially as
n.
y grows, meaning the value of I is independent of (cid:15) > 0. For the rest of this proof we take (cid:15) = (cid:15)(n) = 1/

√

Step 1 (Prune Tails). Our ﬁrst goal is to show that the integral over C2 + i(cid:15) is negligible. To do this we
bound the integral over (n−2/5, ∞)+ i(cid:15), with the integral over (−∞, −n−2/5)+ i(cid:15) bounded with an analogous
argument. Since ψ(cid:48)(y) = 0 has no solution other than y = 0, repeatedly integrating by parts shows that for
any ﬁxed a > 0

(cid:90)

y−kA(y)e−nψ(y)dy

decays to zero faster than any negative integer power of n (see, for instance, the argument in Stein [37,
Section VIII.1.1]). Because of the power series expansions of A and ψ at the origin, there exists σ > 0 and
K1, K2 > 0 such that for all |t| ≤ σ and n suﬃciently large,

(a,∞)+i(cid:15)

|A(t + i(cid:15))| ≤ K1

and (cid:60)(ψ(t + i(cid:15))) ≥ K2(cid:60)((t + i(cid:15))2) = K2(t2 − (cid:15)2).

When n is suﬃciently large then n−2/5 < σ, and we see that

(cid:12)
(cid:90)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(n−2/5,∞)+i(cid:15)

y−kA(y)e−nψ(y)dy −

(cid:90)

y−kA(y)e−nψ(y)dy

(n−2/5,σ)+i(cid:15)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

→ 0

faster than any negative integer power of n. Furthermore, with (cid:15) = 1/

√

n we have

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

(n−2/5,σ)+i(cid:15)

y−kA(y)e−nψ(y)dy

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90) σ

≤ K1

n−2/5

|t + i(cid:15)|−k e−nK2(t2−(cid:15)2)dt ≤ K1eK2

(cid:90) σ

n−2/5

t−ke−nK2t2

dt,

and making the change of variables w = nK2t2 implies

(cid:90) σ

n−2/5

t−ke−nK2t2

dt = O

(cid:18)

(cid:18)

(cid:90) ∞

n(k−1)/2

w−(k+1)/2e−wdw

(cid:19)

K2n1/5

n(k−1)/2−(k+1)/10

(cid:90) ∞

(cid:19)

e−wdw

= O

(cid:16)

= O

n(2k−3)/5e−K2n1/5 (cid:17)

.

K2n1/5

38

Putting everything together, and repeating the argument for the elements of C2 which are less than zero, we
have shown that

(cid:90)

I ∼

y−kA(y)e−nψ(y)dy,

up to an error that decays faster than any negative integer power of n.

C1+i(cid:15)

Step 2 (Approximate). We now show that A and ψ can be replaced by their leading power series terms

while introducing an error which will not aﬀect asymptotics. Note that

y−kA(y)e−nψ(y) = a0y−ke−nb0y2 (cid:0)1 + O(y + ny3)(cid:1) ,

and |y| ≤ 2n−2/5 when y ∈ C1 + i(cid:15). Thus,

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

C1+i(cid:15)

y−kA(y)e−nψ(y)dy − a0

(cid:90)

C1+i(cid:15)

y−ke−nb0y2

dy

(cid:18)

(cid:18)

(cid:18)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

= O

= O

= O

(cid:90)

n−1/5

C1+i(cid:15)

(cid:12)
(cid:12)

(cid:12)y−ke−nb0y2(cid:12)

(cid:12)
(cid:12) dy

(cid:19)

n−1/5

(cid:90)

C1

1
(t2 + (cid:15)2)k/2

e−n(t2−(cid:15)2)dt

(cid:19)

nk/2−1/5

(cid:90)

R

1
(nt2 + 1)k/2

e−nt2

(cid:19)

dt

,

where we have made the substitution y = t + i(cid:15) and used (cid:15) = 1/

√

n. Substituting w = nt2 then implies

(cid:18)

O

nk/2−1/5

(cid:90)

R

1
(nt2 + 1)k/2

e−nt2

(cid:19)

(cid:18)

dt

= O

n(k−1)/2−1/5

(cid:90) ∞

0

√

1
w(w + 1)k/2

(cid:19)

e−wdw

(cid:16)

n(k−1)/2−1/5(cid:17)

,

= O

since

is ﬁnite for all k > 0.

(cid:90) ∞

0

√

1
w(w + 1)k/2

e−wdw ≤

(cid:90) ∞

0

1
√
w

e−wdw =

√

π

Step 3 (Add Tails Back). Following the reasoning of Step 1, the integral

(cid:90)

a0

C2+i(cid:15)

y−ke−nb0y2

dy

is asymptotically negligible, meaning

I = a0

(cid:90)

R+i(cid:15)

y−ke−nb0y2

dy + O

(cid:16)

n(k−1)/2−1/5(cid:17)

.

Proposition 6.2 gives the value of this integral, showing it grows as a constant times n(k−1)/2.

Remark 6.5. Our proof of Lemma 6.4 mirrors the standard presentation of the saddle-point method for
integrals of the form (cid:82)
R A(y)e−nψ(y)dy, where A and ψ are analytic (or, more generally, smooth). Our
arguments are slightly more involved because the negative powers of y introduced in our situation necessitates
working oﬀ the real line.
Example 6.6. Returning to Example 6.1, we see that

−3
2πi

(cid:90)

R+i(cid:15)

1
y(1 + iy)(1 − 2iy)

e−n[2 log(1+iy)+log(1−2iy)]dy =

∼

39

−3
2πi

−3
2πi

(cid:90)

R+i(cid:15)
(cid:32)(cid:90)

e−n[3y2+O(y3)]
y
e−3ny2
y

dy

(cid:33)

,

R+i(cid:15)

(1 + O(y)) dy + O(τ n)

so Proposition 6.2 implies

[x2nyn]F (x, y) ∼

3
2

.

(cid:47)

Explicit expressions for non-generic directions where (−∇hr)(σ) lies on higher codimensional faces of
N (σ) follow from a similar approximation procedure, however deriving the necessary bounds is slightly
harder due to the presence of additional variables. A rigorous investigation of these cases is in progress.

6.2 Bridging the Exponential Gaps

Now we consider asymptotic transitions around non-generic directions. Suppose we again have a contributing
point σ for the non-generic direction ˆr under the assumptions of Section 6.1 and p = 1, so we have only
simple poles.

To study such transitions, we write r = nˆr +

√

√

nθt−svt−s where

nθ1v1 + · · · +
(cid:16)

vj = σ (cid:12) b(j) =

σ1b(j)

1 , . . . , σdb(j)

d

(cid:17)

and work from (20). Then

r · log (cid:0)σ − iM −1( 0

r )(cid:1) = nφ(y) +

√

nθ1ψ1(y) + · · · +

√

nθt−sψt−s(y)

where

(cid:1)(cid:1)
φ(y) = ˆr · log (cid:0)σ + iM −1(cid:0) 0
(cid:1)(cid:1) .
ψj(y) = vj · log (cid:0)σ + iM −1(cid:0) 0

y

y

Since the derivative of the jth coordinate of log (cid:0)σ + iM −1(cid:0) 0

y

(cid:1)(cid:1) with respect to yk is σ−1

j

iM −1

j,k+s

,

(∇φ)(0) = (−i)

= (−i)

j=1

d
(cid:88)

rj
σj
(cid:20)(cid:18) r1
σ1

M −1

j,k+s

, . . . ,

(cid:21)

· M −1

(cid:19)

rd
σd

(cid:104)(cid:16)

a1b(1) + · · · + asb(s)(cid:17)

= i

= 0

[s+1,...,t]

· M −1(cid:105)

[s+1,...,t]

as the ﬁrst t rows of M are b(1), . . . , b(t), where the notation P[a,...,b] refers to the a through bth columns of
a matrix P . Similarly,
b(s+j) · M −1(cid:105)

= (−i)e(s+j).

(∇ψj)(0) = (−i)

(cid:104)

[s+1,...,t]

In the same codimension 1 case from the last section, the modiﬁed saddle-point method described in the

proof of Proposition 6.3 shows that when θ = O(nc) for some c < 1/2 then

Iθ ∼

σ−ri ˜G(σ)
| det M |(2π)

(cid:90)

R+i(cid:15)

(cid:124)

1
y

e−n(qT q/2)y2−i

√

nθy dy

,

(cid:123)(cid:122)
J(θ)

(cid:125)

where M and q are the same as above. This implies the following result, where we recall the Gaussian error
function Ψ(z) = 2
π

(cid:82) z
0 e−u2/2 du.

40

Proposition 6.7. Suppose

F (z) =

G(z)
(cid:96)1(z) · · · (cid:96)d(z)

is simple and r is a non-generic direction with a unique contributing singularity σ of maximal height, which
lies on the stratum (cid:96)1 = · · · = (cid:96)d = 0. Suppose also that G(σ) (cid:54)= 0 and (−∇hr)(σ) lies on a codimension 1
face of N (σ), in such a way that

(−∇hr)(σ) = λ1 · b(1) + · · · + λd−1 · b(d−1) + 0 · b(d)

for some λj > 0. If v =

(cid:16)

σ1b(d)

1 , . . . , σnb(d)

n

(cid:17)

and θ = O(nc) for some c < 1/2, then

(cid:104)

znr+θ

√

nv(cid:105)

F (z) ∼ σ−nr−θ

√

nv

G(σ)
2σ1 · · · σd| det M |

(cid:32)

(cid:32)

Ψ

θ
(cid:112)2qT q

(cid:33)

(cid:33)

+ 1

,

where M is the matrix whose rows are the b(j) and q is the right-most column of

√









Q =

r1/σ1
0

√

0
r2/σ2

0
0

0
0

0
0
. . .
0









0
0

√

0
rd/σd

M −1.

Proof. The integral J(θ) is actually easier to analyze than the integrals from the previous section. In fact,
diﬀerentiating under the integral sign with respect to θ simpliﬁes to remove the factor of y in the denominator,
giving

√

J (cid:48)(θ) = i

(cid:90)

n

e−n(qT q/2)y2−i

√

nθy dy = i

√

R+i(cid:15)

(cid:90)

n

R

e−n(qT q/2)y2−i

√

nθy dy = i

(cid:114) 2π
qT q

e− θ2

2qT q .

Integrating with respect to θ then yields

J(θ) = −πiΨ

(cid:33)

(cid:32)

θ
(cid:112)2qT q

+ J(0),

(cid:90)

J(0) =

R+i(cid:15)

e−n(qT q/2)y2
y

dy = −πi

where

by Proposition 6.2.

The general codimension case reduces to an analysis of integrals of the form

(cid:90)

J(θ) =

Rb+i(cid:15)1

1
y1 · · · ya

e−n(yT Hy)+i

√

n(θ1y1+···+θaya)dy,

where H is a positive deﬁnite matrix. A suitable change of variables splits this integral into a product of
integrals, allowing one to reduce to the case a = b where every variable appears in the denominator. This
results in a so-called hydrodynamic scaling limit, which will be rigorously covered in future work.

41

References

[1] M. F. Atiyah, R. Bott, and L. G ˙arding. Lacunas for hyperbolic diﬀerential operators with constant

coeﬃcients. I. Acta Math., 124:109–189, 1970.

[2] Y. Baryshnikov, S. Melczer, and R. Pemantle. Asymptotics of multivariate sequences in the presence of

a lacuna. Submitted, arxiv.org/abs/1905.04187, 2021.

[3] Y. Baryshnikov, S. Melczer, and R. Pemantle. Stationary points at inﬁnity for analytic combinatorics.

Foundations of Computational Mathematics, 2021.

[4] Y. Baryshnikov, S. Melczer, and R. Pemantle. Stationary points at inﬁnity for analytic combinatorics.

Foundations Comp. Math., 2021.

[5] Y. Baryshnikov and R. Pemantle. Asymptotics of multivariate sequences, part iii: quadratic points.

Adv. Math., 228:3127–3206, 2011.

[6] E. A. Bender and L. B. Richmond. Central and local limit theorems applied to asymptotic enumeration.

ii. multivariate generating functions. J. Combin. Theory Ser. A, 34:255–265, 1983.

[7] Edward A. Bender and L. Bruce Richmond. Multivariate asymptotics for products of large powers with
applications to Lagrange inversion. Electron. J. Combin., 6:Research Paper 8, 21 pp. (electronic), 1999.

[8] Andrea Bertozzi and James McKenna. Multidimensional residues, generating functions, and their ap-

plication to queueing networks. SIAM Rev., 35(2):239–268, 1993.

[9] T. Brylawski. The broken-circuit complex. Trans. AMS, 234(2):417–433, 1977.

[10] Gilles Christol. Diagonales de fractions rationnelles et equations diﬀérentielles.

In Study group on
ultrametric analysis, 10th year: 1982/83, No. 2, pages Exp. No. 18, 10. Inst. Henri Poincaré, Paris,
1984.

[11] J. de Loera and B. Sturmfels. Algebraic unimodular counting. Math. Program., 96:183–203, 2003.

[12] T. DeVries, J. van der Hoeven, and R. Pemantle. Automatic asymptotics for coeﬃcients of smooth,

bivariate rational functions. Online J. Anal. Comb., 6:24 pages, 2011.

[13] P. Flajolet and R. Sedgewick. Analytic Combinatorics. Cambridge University Press, 2009.

[14] Zhicheng Gao and L. Bruce Richmond. Central and local limit theorems applied to asymptotic enumera-
tion. IV. Multivariate generating functions. J. Comput. Appl. Math., 41(1-2):177–186, 1992. Asymptotic
methods in analysis and combinatorics.

[15] A. Gilbert and H. Karloﬀ. On the fractal behavior of tcp. In Proceedings of the 35th Annual ACM

Symposium on Theory of Computing, pages 297–306, New York, 2003. ACM Press.

[16] Mark Goresky and Robert MacPherson. Stratiﬁed Morse theory, volume 14 of Ergebnisse der Mathematik
und ihrer Grenzgebiete (3) [Results in Mathematics and Related Areas (3)]. Springer-Verlag, Berlin,
1988.

[17] Peter Henrici. Applied and computational complex analysis. Vol. 2. Wiley Interscience [John Wi-
ley & Sons], New York-London-Sydney, 1977. Special functions—integral transforms—asymptotics—
continued fractions.

[18] Lars Hörmander. The analysis of linear partial diﬀerential operators. I, volume 256 of Grundlehren der
Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag,
Berlin, second edition, 1990. Distribution theory and Fourier analysis.

42

[19] Hsien-Kuei Hwang. Large deviations of combinatorial distributions. II. Local limit theorems. Ann.

Appl. Probab., 8(1):163–181, 1998.

[20] Pierre Lairez. Computing periods of rational integrals. Math. Comp., 85(300):1719–1752, 2016.

[21] Sergei K. Lando and Alexander K. Zvonkin. Graphs on surfaces and their applications, volume 141 of
Encyclopaedia of Mathematical Sciences. Springer-Verlag, Berlin, 2004. With an appendix by Don B.
Zagier, Low-Dimensional Topology, II.

[22] L. Lipshitz. The diagonal of a D-ﬁnite power series is D-ﬁnite. J. Algebra, 113(2):373–378, 1988.

[23] M. Lladser. Uniform formulae for coeﬃcients of meromorphic functions in two variables. SIAM J. Dis.

Math., 20(4):811–828, 2006.

[24] Stephen Melczer. An Invitation to Analytic Combinatorics in One and Several Variables. Springer, New

York, 2021.

[25] Stephen Melczer and Bruno Salvy. Eﬀective coeﬃcient asymptotics of multivariate rational functions
via semi-numerical algorithms for polynomial systems. J. Symbolic Comput., 103:234–279, 2021.

[26] Marc Mezzarobba. NumGfun: a package for numerical and analytic computation with D-ﬁnite functions.

pages 139–146, 2010.

[27] Marc Mezzarobba. Rigorous multiple-precision evaluation of D-ﬁnite functions in SageMath. Technical
Report 1607.01967, arXiv, 2016. Extended abstract of a talk at the 5th International Congress on
Mathematical Software.

[28] A. M. Odlyzko. Asymptotic enumeration methods.

In Handbook of combinatorics, Vol. 1, 2, pages

1063–1229. Elsevier, Amsterdam, 1995.

[29] P. Orlik and L. Solomon. Combinatorics and topology of complements of hyperplanes. Invent. Math.,

56:167–189, 1980.

[30] P. Orlik and H. Terao. Commutative algebras for arrangements. Nagoya Math J., 134:65–73, 1994.

[31] Peter Orlik and Hiroaki Terao. Arrangements of hyperplanes, volume 300 of Grundlehren der Mathe-
matischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin,
1992.

[32] R. Pemantle and M. C. Wilson. Asymptotics of multivariate sequences: I. Smooth points of the singular

variety. J. Comb. Theory, Ser. A, 97(1):129–161, 2002.

[33] R. Pemantle and M. C. Wilson. Asymptotics of multivariate sequences. II. Multiple points of the singular

variety. Combin. Probab. Comput., 13(4-5):735–761, 2004.

[34] R. Pemantle and M. C. Wilson. Analytic Combinatorics in Several Variables. Cambridge University

Press, 2013.

[35] Robin Pemantle. Generating functions with high-order poles are nearly polynomial. In Mathematics
and computer science (Versailles, 2000), Trends Math., pages 305–321. Birkhäuser, Basel, 2000.

[36] A. Raichev and M.C. Wilson. Asymptotics of coeﬃcients of multivariate generating functions: improve-

ments for multiple points. Online Journal of Analytic Combinatorics, 6(0), 2011.

[37] Elias M. Stein. Harmonic analysis: real-variable methods, orthogonality, and oscillatory integrals, vol-

ume 43 of Princeton Mathematical Series. Princeton University Press, Princeton, NJ, 1993.

[38] Joris van der Hoeven. Fast evaluation of holonomic functions near and in regular singularities. J.

Symbolic Comput., 31(6):717–743, 2001.

43

[39] A. Varchenko and I.M. Gelfand. Combinatorics and topology of conﬁguration of aﬃne hyperplanes in

real space. Funk. Analiz i ego Prilozh., 21:11–22, 1987.

44

