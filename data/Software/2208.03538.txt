Draft version August 9, 2022
Typeset using LATEX twocolumn style in AASTeX631

Generative Models of Multi-channel Data from a Single Example - Application to Dust Emission

Bruno R´egaldo-Saint Blancard ,1 Erwan Allys,2 Constant Auclair,2 Franc¸ois Boulanger

,2

Michael Eickenberg,1 Franc¸ois Levrier

,2 L´eo Vacher

,3 and Sixin Zhang4

1Center for Computational Mathematics, Flatiron Institute, 162 5th Avenue, New York, NY 10010, USA
2Laboratoire de Physique de l’ENS, ENS, Universit´e PSL, CNRS, Sorbonne Universit´e, Universit´e Paris Cit´e, 75005 Paris, France
3IRAP, Universit´e de Toulouse, CNRS, CNES, UPS, Toulouse, France
4Universit´e de Toulouse, INP, IRIT, Toulouse, France

ABSTRACT

The quest for primordial B-modes in the cosmic microwave background has emphasized the need
for reﬁned models of the Galactic dust foreground. Here, we aim at building a realistic statistical
model of the multi-frequency dust emission from a single example. We introduce a generic methodol-
ogy relying on microcanonical gradient descent models conditioned by an extended family of wavelet
phase harmonic (WPH) statistics. To tackle the multi-channel aspect of the data, we deﬁne cross-
WPH statistics, quantifying non-Gaussian correlations between maps. Our data-driven methodology
could apply to various contexts, and we have updated the software PyWPH, on which this work relies,
accordingly. Applying this to dust emission maps built from a magnetohydrodynamics simulation,
we construct and assess two generative models of: 1) a (I, E, B) multi-observable input, 2) a
ν
}
multi-frequency input. The samples exhibit consistent features compared to the original maps. A sta-
tistical analysis of 1) shows that the power spectra, distributions of pixels, and Minkowski functionals
are captured to a good extent. We analyze 2) by ﬁtting the spectral energy distribution (SED) of
both the synthetic and original maps with a modiﬁed blackbody (MBB) law. The maps are equally
well ﬁtted, and a comparison of the MBB parameters shows that our model succeeds in capturing the
spatial variations of the SED from the data. Besides the perspectives of this work for dust emission
modeling, the introduction of cross-WPH statistics opens a new avenue to characterize non-Gaussian
interactions across diﬀerent maps, which we believe will be fruitful for astrophysics.

Iν
{

Keywords: Astrostatistics(1882) — Interstellar dust(836) — Cosmic microwave background radia-

tion(322)

1. INTRODUCTION

Since the Planck mission (Planck Collaboration I
2020), the observation of the cosmic microwave back-
ground (CMB) has become closely entwined with the
physics of the interstellar medium (ISM). On the one
hand, the thermal emission of our own Galaxy severely
contaminates the CMB signal, acting as a foreground to
the primordial signal. On the other hand, CMB experi-
ments provide unique data for interstellar astrophysics.
Component separation methods (see e.g. Planck Collab-
oration IV 2020), which aim at recovering the accurate

CMB maps, have to deal with the non-Gaussian1 struc-
ture of the dust emission and the spatial variations of
the spectral energy distribution (SED). In the quest for
primordial B-modes (Kamionkowski & Kovetz 2016) in
the CMB polarization signal, which is one of the main
targets of the new generation of CMB experiments such
as ACTPol (Naess et al. 2014), SPIDER (Fraisse et al.
2013), LiteBIRD (Ishino et al. 2016), the Simons Obser-
vatory (Simons Observatory Collaboration 2019), and
CMB-S4 (Abazajian et al. 2019), high-precision models
of the multi-frequency polarized dust foreground have

Corresponding author: Bruno R´egaldo-Saint Blancard
bregaldosaintblancard@ﬂatironinstitute.org

1 We call “non-Gaussian”, any statistical feature that is not char-
acterized by the power spectrum (or cross spectrum, when con-
sidering a pair of ﬁelds).

2
2
0
2

g
u
A
6

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
8
3
5
3
0
.
8
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
2

R´egaldo-Saint Blancard et al.

become crucial (BICEP2/Keck Array and Planck Col-
laborations 2015).

In this paper, we address the problem of building a
statistical model of multi-frequency dust emission maps
by introducing a generic methodology that does not rely
on any prior phenomenological model (i.e. a purely data-
driven approach). We aim at taking into account the
highly non-Gaussian properties of the data, and model-
ing the correlations between the frequency channels and
between the polarization and total intensity observables.
Because, from an observational point of view, we only
have a single sky, we also choose to build our model
from a single multi-channel input. In other words, if we
call this input x, the goal is to approximate the distri-
bution of the underlying random ﬁeld X based on the
single realization x. Approximating a high-dimensional
distribution is always a daunting task, and with this
additional constraint this becomes even harder if not in-
tractable. To partially alleviate this diﬃculty, we will
thus assume (spatial) statistical homogeneity for X. Fi-
nally, we want our model to be generative, in the sense
that drawing new samples of the model should be doable
in a reasonable amount of time. This might be a crucial
constraint for component separation methods requiring
an important amount of simulated maps of dust emis-
sion, such as methods adopting a simulation-based in-
ference approach as in Jeﬀrey et al. (2021).

Various models of the polarized emission of dust have
been developed in the literature (for an extensive dis-
cussion, see R´egaldo-Saint Blancard 2021, Chapter II),
some of them being packed in CMB sky simulator soft-
wares (e.g. Delabrouille et al. 2013; Thorne et al. 2017).
Among these models, we make a distinction between
deterministic approaches, designed to retrieve the true
emission of the sky (e.g. Planck Collaboration XI 2014;
Planck Collaboration X 2016; Planck Collaboration Int.
XLVIII 2016; Planck Collaboration IV 2020), and sta-
tistical approaches, focusing on its statistical proper-
ties (e.g. Vansyngel et al. 2017; Herv´ıas-Caimapo & Huf-
fenberger 2022). We also distinguish phenomenological
approaches, making use of phenomenological priors (e.g.
modiﬁed blackbody (MBB) SED), from data-driven ap-
proaches. Our approach stands in the class of statis-
tical and data-driven models.
In this category, Aylor
et al. (2021), and then Thorne et al. (2021), employed a
generative adversarial network (GAN) and a variational
autoencoder (VAE), respectively, to model the total in-
tensity of mono-frequency dust emission maps. Krach-
malnicoﬀ & Puglisi (2021) made use of a GAN to gener-
ate sub-degree angular scales in mono-frequency dust
polarization maps. These approaches, which involve
techniques from the emerging ﬁeld of deep generative

modeling, rely on convolutional neural networks (CNNs)
that need to be trained. Such training steps require at
least hundreds if not thousands of observations, which
obviously bind the models to their respective training
sets. On the other hand, Allys et al. (2019) and then
Regaldo-Saint Blancard et al. (2020) introduced gener-
ative models of dust emission maps in total intensity
and polarization, respectively, that do not necessitate
any training and can be built from a single input map.
These models are approximate maximum entropy mod-
els, called microcanonical gradient descent models, that
are conditioned by wavelet scattering transform (WST)
moments (Mallat 2012; Bruna & Mallat 2013, 2019).
Jeﬀrey et al. (2021) made use of a similar kind of model
for dust polarization data but using wavelet phase har-
monic (WPH) moments (Mallat et al. 2019; Zhang &
Mallat 2021; Allys et al. 2020). Note that although the
WST and WPH statistics share many similarities with
the representations learned by CNNs (Mallat 2016; Mal-
lat et al. 2019), they avoid some of their drawbacks,
namely the lack of interpretability and the necessity of
training. However, until now, none of these existing gen-
erative models have tackled the multi-channel aspect of
dust emission data (besides the joint modeling of the lin-
ear polarization variables, see e.g. Regaldo-Saint Blan-
card et al. (2020)). We propose to bridge this gap by
incorporating a modeling of correlations between maps
at diﬀerent frequency channels as well as correlations
between total intensity and polarization maps.

Observations of dust polarized emission at a given
frequency channel ν take the form of a triplet of two-
dimensional Stokes parameter maps (Iν, Qν, Uν), with
Iν the total intensity of the emission and (Qν, Uν) de-
scribing the linear polarization signal. For CMB science,
the polarization maps (Qν, Uν) are usually transformed
into (Eν, Bν) maps (Zaldarriaga 2001). In order to make
the present work more readily usable in this cosmologi-
cal context, we adopt the same polarization variables in
the following.

(Iν, Eν, Bν)
}
{

In the continuity of the above series of works, we intro-
duce microcanonical gradient descent models of multi-
ν conditioned
channel dust emission maps
by a new family of WPH statistics.
In particular, we
introduce cross-WPH statistics, allowing us to combine
multiple maps and characterize their non-Gaussian cor-
relations. This paper focuses on the methodology and
the validation of such models. We build two models
demonstrating the capabilities of our approach: the ﬁrst
one is a mono-frequency model based on a triplet of
simulated dust maps (Iν0 , Eν0 , Bν0 ), the second one is
a multi-frequency model of a set of total-intensity sim-
ν. Finally, let us emphasize that, al-
ulated maps

Iν

{

}

Generative Models of Multi-channel Dust Emission Maps

3

though the focus here is on dust emission maps, our
approach does not involve any prior model that is spe-
ciﬁc to dust data. As a consequence, our methodology
could be applied in a very similar way to other astro-
physical contexts, and more generally to other scientiﬁc
contexts. All the necessary material to do so is publicly
available within the Python package PyWPH2 (Regaldo-
Saint Blancard et al. 2021).

This paper is organized as follows. In Sect. 2, we in-
troduce the simulated multi-channel data that will be
the target of our models. Then, in Sect. 3, we explain
the underlying formalism of our approach. We introduce
microcanonical gradient descent models and the family
In Sect. 4 we
of WPH statistics that we will employ.
present and validate our models. Finally, Sect. 5 sum-
marizes our conclusions. This paper also includes three
appendices. Appendix A presents maximum entropy mi-
crocanonical models, which underlie the deﬁnition of mi-
crocanonical gradient descent models. Appendix B gives
additional details on our family of WPH statistics. Ap-
pendix C properly deﬁnes the Gaussian model that we
will use as a baseline in Sect. 4.1.

The data and codes

to reproduce the models
are provided on https://github.com/bregaldo/dust
genmodels.

2. PRESENTATION OF THE DATA

In this section, we build a set of simulated multi-
ν of dust emission by pro-

frequency maps
(Iν, Eν, Bν)
}
{
ceeding as follows:

1. In Sect. 2.1, we extract a statistically homoge-
neous 3D gas density ﬁeld and magnetic ﬁeld from
a magnetohydrodynamics (MHD) simulation de-
signed to reproduce typical conditions of the dif-
fuse ISM.

2. In Sect. 2.2, we build Stokes maps Iν, Qν, and
Uν based on the previous simulation and a phe-
nomenological model of the SED of dust grains.

3. In Sect. 2.3, we transform the

ν maps
(Qν, Uν)
}
{
ν maps and show the resulting data
(Eν, Bν)
into
}
{
in Fig. 1.

2.1. MHD simulation

In order to consider a realistic gas density ﬁeld n and
magnetic ﬁeld B, we make use of a MHD simulation de-
signed to reproduce typical conditions of the diﬀuse ISM.
This simulation is the same as the one used in Regaldo-
Saint Blancard et al. (2020). We brieﬂy summarize its

2 https://github.com/bregaldo/pywph/

main characteristics in the following, and refer to this
paper for additional details.

The simulation was run in the context of Bellomi
et al. (2020) to study the biphasic nature of the dif-
fuse ISM. It employs the adaptive mesh reﬁnement code
RAMSES (Teyssier 2002; Fromang et al. 2006) to solve the
equations of ideal MHD. The volume of the simulation is
(50 pc)3, and it is ultimately discretized on a 5123 mesh
with periodic boundary conditions. Heating and cooling
processes of the gas are taken into account, whereas self-
gravity is neglected. An isotropic Habing radiation ﬁeld
with G0 = 1 is applied at the boundaries of the box.
An isotropic turbulent forcing is also applied, leading
to a statistical steady state after a few turnover times.
In this stationary regime, we have a velocity dispersion
1, the magnetic ﬁeld has a mean com-
σv
ponent ¯B = B0ez with B0 ∼
3.8 µG, and a dispersion
3.1 µG. Finally, the mean and dispersion of the
σB
3,
gas density ﬁeld n are ¯n = 1.5 cm−
respectively.

2.6 km.s−

3 and σn

4.7 cm−

∼

∼

∼

We extract a snapshot in this stationary regime, which
thus provides the gas density ﬁeld n and magnetic ﬁeld
B we were looking for.

2.2. Stokes emission maps

For a given frequency ν and line of sight, and in the
optically thin limit, the Stokes parameters Iν, Qν, and
Uν can be expressed as follows (see e.g. Planck Collab-
oration Int. XX 2015, and references therein):

(cid:90)

(cid:90)

(cid:90)

Iν =

Qν =

Uν =

(cid:20)
1

Sν

(cid:18)

cos2 γ

(cid:19)(cid:21)

2
3

−

p0

−

dτν,

p0Sν cos (2φ) cos2 γdτν,

p0Sν sin (2φ) cos2 γdτν,

(1)

(2)

(3)

where Sν is the source function of the dust emission, τν
is the dust optical depth, p0 is an intrinsic polarization
fraction parameter, γ is the angle that the local mag-
netic ﬁeld makes with the plane of the sky, and φ is the
angle that the projection of the local magnetic ﬁeld on
the plane of the sky makes with some arbitrary reference
axis in this plane. Note that the particular choice of this
reference axis does not impact the (Eν, Bν) maps that
will be derived in Sect. 2.3. The inﬁnitesimal dust opti-
cal depth reads dτν = σνndl where σν is the dust cross
section per H at frequency ν, n is the hydrogen density,
and dl is the inﬁnitesimal element of length along the
line of sight. All these quantities are a priori functions
of the position on the line of sight.

We make the following simplifying assumptions. We
assume that the polarization fraction parameter p0,

4

R´egaldo-Saint Blancard et al.

which is related to cross-section parameters of the
grains and their degree of alignment with the magnetic
ﬁeld (for more details, see Planck Collaboration Int. XX
2015), is uniform (for a discussion, see Reissl et al. 2020).
Similarly to Planck Collaboration Int. XX (2015), we
choose a typical value of p0 = 0.2. We choose the source
function of the grains Sν to be that of a blackbody radia-
tion Bν(T ), thus depending on the dust temperature T .
We assume that the frequency dependence of the dust
cross section follows a power law σν = σ0(ν/ν0)β, where
σ0 is the dust cross section at the reference frequency
ν0 and β is the spectral index. This assumption is quite
usual in the literature (see e.g. Planck Collaboration XI
2014, and references therein). We assume a uniform σ0,
whose precise value only aﬀects the global normaliza-
tion of the maps, and has no impact on the rest of this
paper. Finally, we arbitrarily choose the z-axis of the
simulation as the line of sight. Note that this axis corre-
sponds to the direction of the mean magnetic ﬁeld of the
simulation, so that we expect statistical isotropy in the
resulting 2D maps (Regaldo-Saint Blancard et al. 2020).
The ﬁelds T and β are deﬁned with respect to the
local values of the density ﬁeld n using the following
simple phenomenological model. The voxels of T and β
are both exactly Gaussian distributed in a way that is
consistent with the two following observational facts: 1)
temperature is usually lower (higher) in higher (lower)
density regions, 2) MBB ﬁts of observational maps of
the dust emission show that the ﬁtted T and β param-
eters tend to be anti-correlated (Planck Collaboration
XI 2014). Means and standard deviations of T and β
are chosen to be [15 K, 1 K] and [1.5, 0.2], respectively.
(n(r)) the rank of a particular value
Formally, calling
n(r) of the simulated density ﬁeld, we thus deﬁne T (r)
and β(r) as follows:

R

1
β(r) = F −
(1.5,0.22)
N

(cid:18)

1
T (r) = F −
(15K,(1K)2)
N

(cid:19)

,

(n(r))
R
1 + N 3
(cid:18)

(n(r))
R
1 + N 3

1

−

(4)

(5)

(cid:19)

,

1
(m,σ2) is the inverse cumulative distribution
where F −
N
function of a Gaussian distribution of mean m and stan-
dard deviation σ, and N = 512 is the resolution of the
simulation. Note that although this 3D phenomenologi-
cal model of the emission of dust grains takes inspiration
from MBB analyses of dust emission maps, there is a pri-
ori no reason for the SED of the projected maps Iν, Qν,
and Uν to be amenable to a MBB (see e.g. Chluba et al.
2017; McBride et al. 2022).

In a cosmological context, linear polarization is not of-
ten studied straight from the Q and U observables, but
rather in terms of E and B-modes (Zaldarriaga 2001).
E and B-modes are linear transforms of Q and U deﬁned
as follows in Fourier space and in the ﬂat-sky approxi-
mation (see e.g. Kamionkowski & Kovetz 2016):
(cid:33) (cid:32) ˆQ(k)
ˆU (k)

sin 2αk
sin 2αk cos 2αk

(cid:32) ˆE(k)
ˆB(k)

1
√2

cos 2αk

(6)

(cid:33)

(cid:33)

(cid:32)

=

,

−

where αk is the angle that k makes with the x-axis of
the maps. The motivation for this transformation is
twofold. First, for CMB science, these variables disen-
tangle scalar primordial ﬂuctuations from vectorial and
tensorial ones (Kamionkowski et al. 1997). Indeed, vec-
torial and tensorial ﬂuctuations in the primordial plasma
before the decoupling would give rise to a non-zero B-
mode signal in the CMB, while scalar ﬂuctuations can-
not source any B-mode signal. Second, contrary to the
complex Q + iU variable which is a spin-2 variable, E
and B variables are scalar and pseudo-scalar3 variables,
respectively, which means in particular that these vari-
ables are invariant under any rotation of the initial basis
chosen for the measurement of the polarization signal.
This explains why the choice of the axis with respect
to which the φ angle introduced in Eqs. (2) and (3) is
deﬁned has no impact on these variables.

Following the procedure explained in this section, we
thus compute (Iν, Eν, Bν) maps for ﬁve diﬀerent fre-
quency channels: ν = 300, 500, 800, 1500, 3000 GHz.
This choice of channels is inspired by the analysis of
Planck Collaboration XI (2014) on Planck and IRAS
data over the 353-3000 GHz range. For this range of
frequencies, the eﬀects of β and T are expected to be
disentangled. As an example, we display in Fig. 1 the
resulting maps Iν, Eν and Bν (from left to right, respec-
tively) for the three following channels: 300, 800, and
3000 GHz. The ﬁlamentary structure of these maps un-
derlines the non-Gaussianity of the data. Moreover, at a
given frequency, coherent structures visible on the total
intensity map Iν have obvious counterparts in the polar-
ization maps Eν and Bν. Statistical correlations from
one observable to another are thus expected. Across the
frequency axis, maps of the same observable seem to be
almost structurally identical. Except for the important
variation of the standard deviation of the maps, and
the variation of the means for total intensity maps, the
impact of frequency on the general aspect of the maps
appears to be very subtle. To better see these subtle

2.3. (E, B) transform and resulting maps

3 Contrary to scalar quantities, the sign of pseudo-scalar quantities

is changed under a parity inversion.

Generative Models of Multi-channel Dust Emission Maps

5

Figure 1. log10(Iν ), Eν , and Bν (from left to right) simulated maps of dust emission at three diﬀerent frequency channels:
300, 800, and 3000 GHz (from top to bottom).

variations, we show in Fig. 5 (top row, center and right)
examples of total intensity ratio maps between consec-
utive frequency channels.

3. FORMALISM

This section introduces the formalism underlying the
deﬁnition of our generative models, namely microcanon-
ical gradient descent models conditioned by WPH statis-
tics. Samples of microcanonical gradient descent mod-
els are drawn by iteratively deforming an initial Gaus-
sian sample into a signal with some prescribed statis-
tics. Here, we choose these prescribed statistics to be
WPH statistics, as these have been proven eﬃcient in
characterizing coherent structures in a variety of non-
Gaussian random ﬁelds (Mallat et al. 2019; Allys et al.
2020; Zhang & Mallat 2021; Regaldo-Saint Blancard
et al. 2021; Jeﬀrey et al. 2021; Brochard et al. 2022).

In Sect. 3.1, we brieﬂy deﬁne microcanonical gradient
descent models. Then, in Sect. 3.2, we introduce the
families of moments on which the models of this paper
rely. This concise introduction is complemented by Ap-
pendix B, which contains all the technical details needed
to reproduce this work.

3.1. Microcanonical gradient descent models

Microcanonical gradient descent models were intro-
duced in Bruna & Mallat (2019) as approximations of
maximum entropy microcanonical models.4 With x the
realization of the random ﬁeld X that we want to ap-
proximate, and φ(x) the vector of statistics that is sup-
posed to characterize the statistical properties of X,

4 We refer the reader to Appendix A for formal deﬁnitions of max-

imum entropy microcanonical models.

−20−1001020y[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020x[pc]−1.4−1.2−1.0−0.8−0.6log10(I300)−0.10−0.050.000.050.10E300−0.10−0.050.000.050.10B300−0.4−0.20.00.20.40.6log10(I800)−1.5−1.0−0.50.00.51.01.5E800−1.5−1.0−0.50.00.51.01.5B800−0.8−0.6−0.4−0.2log10(I3000)−0.3−0.2−0.10.00.10.2E3000−0.2−0.10.00.10.20.3B30006

R´egaldo-Saint Blancard et al.

these models are deﬁned by transporting an initial Gaus-
sian distribution through gradient descent over:

(y) =

L

φ(y)
(cid:107)

−

2 ,
φ(x)
(cid:107)

(7)

−

κk

(cid:107)·(cid:107)

∇L

(y) with

the gradient of

is the Euclidean norm. The gradient de-
where
scent algorithm deﬁnes at each iteration k a mapping
fk(y) = y
and
κk the gradient step at iteration k. For a given number
of iterations n, and with y0 a sample drawn from our
initial Gaussian distribution, the resulting sample yn of
our model reads yn = fn
f1(y0). In practice,
fn
1 ◦ · · · ◦
−
the number of iterations is empirically adapted to reach
an approximate convergence.

∇L

L

◦

3.2. Wavelet Phase Harmonic statistics

Originally introduced in Mallat et al. (2019), the WPH
statistics have been proven successful in characterizing
complex coherent structures arising from a variety of
two-dimensional non-Gaussian physical ﬁelds. In Zhang
& Mallat (2021), they have been applied to turbulent
vorticity ﬁelds, in Allys et al. (2020) to density ﬁelds
of the large-scale structure of the Universe, in Regaldo-
Saint Blancard et al. (2021) and Jeﬀrey et al. (2021)
to Planck observations and simulated maps of dust po-
In all of these ﬁelds, structures stem
larization data.
from highly nonlinear physics. One of the main assets
of the WPH statistics is to characterize the resulting
non-Gaussianity through an eﬃcient quantiﬁcation of
interactions between scales.

The WPH statistics rely on a set of bandpass and low-
pass ﬁlters allowing to locally decompose the spectral
content of the input maps onto a tiling of Fourier space.
These ﬁlters are respectively wavelets and Gaussian ﬁl-
ters. In this section, we introduce auto-WPH moments,
deﬁned as covariances of nonlinear transformations of
the wavelet transform of a given random ﬁeld X. The
nonlinear transformation is a pointwise operation called
phase harmonic, which is deﬁned below. Then, we ex-
tend the deﬁnition of such moments to the case of a pair
of random ﬁelds (X, Y ), introducing cross-WPH mo-
ments designed to quantify interactions between scales
across X and Y . Finally, we introduce a new family of
auto/cross-scaling moments, deﬁned in a similar fashion
as the auto/cross-WPH moments but involving Gaus-
sian ﬁlters instead of wavelets. These are designed to
better constrain the large-scale behavior of the input
ﬁelds as well as their (joint) one-point distribution. The
WPH statistics of a map x, or a pair of maps (x, y), refer
to the estimates of the auto/cross-WPH moments and
auto/cross-scaling moments.

3.2.1. Wavelet transform

A wavelet is a spatially localized waveform with a zero
mean which acts as a bandpass ﬁlter. From an initial
wavelet ψ, called the mother wavelet, we build a bank of
wavelets
j,θ by dilation and rotation of ψ, where
j is an index of dilation and θ is an angle of rotation.
Formally, we have:

ψj,θ
{

}

ψj,θ(r) = 2−

2jψ(2−

jR−
1
θ r).

(8)

kπ/L, 0

respectively,
1

The number of dilations and rotations considered are
so that 0
J and L,
1 and
j
. Consequently, our bank of
θ
L
}
wavelets is made of J
In the following,
L wavelets.
we make use of bump-steerable wavelets. These are
complex-valued wavelets deﬁned in Appendix B.1.

−
×

∈ {

≤

≤

−

≤

≤

J

k

∗

{

∗

ψj,θ

j,θ, where
}

The wavelet transform of X is ﬁnally deﬁned as the set
of bandpass-ﬁltered maps
denotes
X
the convolution operation. These convolutions corre-
spond to local bandpass ﬁlterings of X at spatial fre-
juθ,
quencies centered on modes of the form kj,θ = k02−
with uθ = cos (θ) ex + sin (θ) ey and k0 the central fre-
quency of the mother wavelet ψ.
In this study, we work with 512

512 maps, and choose
J = 8 and L = 4. We show in Fig. 8 one wavelet from
our bank.

×

3.2.2. WPH moments

Auto-WPH moments —The auto-WPH moments of X
are covariances of the phase harmonics of the wavelet
transform of X, i.e. these are deﬁned as:

,

∗

∗

(cid:16)

| ·

(cid:55)→

[X

z
|

ψλ(r)]p , [X

Cλ,p,λ(cid:48),p(cid:48)(τ ) = Cov

ψλ(cid:48)(r + τ )]p(cid:48)(cid:17)
(9)
with λ and λ(cid:48) referring to two oriented scales (j, θ) and
(j(cid:48), θ(cid:48)), and the bracket denoting the pointwise phase
[z]p =
eip arg(z).5,6 When
harmonic operator z
applied to a complex z, the phase harmonic operator
preserves the modulus of z but multiplies its phase by
a factor p. Note that, for p = 0, this operation simply
consists in taking the modulus of z, and for p = 1 it is
the identity. This operator plays a key role to capture
eﬃciently interactions between diﬀerent scales in X. For
λ = λ(cid:48) and p = p(cid:48) = 1, the corresponding moments
are averages of the power spectrum over the bandpass
of ψλ, so that this class of moments does include the
power spectrum information. We refer to Appendix B.2
for additional details on these moments.

5 We recall that Cov (X, Y ) = E ((X
6 These moments do not depend on the r variable because of the

E (X)) (Y

E (Y ))∗).

−

−

homogeneity of X.

Generative Models of Multi-channel Dust Emission Maps

7

Cross-WPH moments —The previous moments can be
extended to the characterization of interactions between
the scales of two diﬀerent ﬁelds X and Y . We deﬁne such
cross-WPH moments as follows:

.

∗

∗

(cid:16)

[X

ψλ(r)]p , [Y

C ×λ,p,λ(cid:48),p(cid:48)(τ ) = Cov

ψλ(cid:48)(r + τ )]p(cid:48)(cid:17)
(10)
Just like before, for λ = λ(cid:48) and p = p(cid:48) = 1, the cor-
responding moments are averages of the cross spectrum
over the bandpass of ψλ, so that the cross spectrum
information is also captured by this class of moments.
Note that, in the ﬁeld of texture synthesis, a similar
class of cross moments has been used to characterize
color channels interactions in RGB images (Vacher &
Briand 2021; Brochard et al. 2022).

Discretization of τ —The previous moments all depend
on the relative shift τ between X
ψλ(cid:48) (or
Y
ψλ(cid:48)). Inspired by Brochard et al. (2022), we discretize
this variable as follows:



ψλ and X

∗

∗

∗

for n

2nuα

1,

≥

(11)

τn,α =



0

for n = 0,

αk = kπ

n

−

≤

≤

∆n

1 and α

with 0
1
∈ {
}
where ∆n and A are two integers playing similar roles
to J and L but for n and α variables instead of j and
θ, respectively.
In this study, we choose ∆n = 5 and
A = 4.7

A , 0

2A

−

≤

≤

k

Choice of a subset of moments —Estimating the
auto/cross-WPH moments for every possible value of
λ, λ(cid:48), p, p(cid:48), and τ is not an option for several reasons.
Besides the fact, that this would be computationally ex-
pensive, some moments may vanish or be redundant by
construction. Moreover, the number of moments should
be kept suﬃciently low compared to the dimension of
the data to allow for statistical diversity in the resulting
generative model. Indeed, when based on a single real-
ization x, if the number of statistical constraints is too
high, samples of such models will tend to reproduce the
speciﬁc features of x instead of being representative of
the variability of X (for a discussion, see Brochard et al.
2022).

Therefore, we need to choose a reduced subset of mo-
ments that will characterize the relevant statistical prop-
erties of our data. This is a crucial and diﬃcult modeling
step. Although this subset should be dependent on the

nature of the data, here our choice is mostly inspired by
the literature on this subject (Allys et al. 2020; Regaldo-
Saint Blancard et al. 2021; Brochard et al. 2022), in-
tending for it to be relevant for a reasonable variety of
non-Gaussian random ﬁelds. We refer to Appendix B.3
for a detailed presentation of this subset.

For our choice of J, L, ∆n, and A values, the re-
sulting number of auto-WPH coeﬃcients is 6940, which
amounts to 2.6 % of the number of pixels of a 512
512
image. However, most of these coeﬃcients are complex-
valued numbers, so that the eﬀective dimension of the
description is
5 %.
On the other hand, for a pair of maps, we consider 1264
cross-WPH coeﬃcients, with, here again, most of them
being complex-valued numbers.

104, leading to a ratio of

1.3

∼

×

∼

×

3.2.3. Scaling moments

To better constrain the large scales as well as the
(joint) one-point distribution of the input ﬁelds, we in-
troduce a new class of auto/cross-scaling moments rely-
ing on a family of isotropic Gaussian ﬁlters
j. These
}
ﬁlters are built by dilating an initial Gaussian function
ϕ (deﬁned in Appendix B.1) similarly to what is done in
Sect. 3.2.1 for wavelets. Assuming zero-mean X and Y ,
our auto/cross-scaling moments are deﬁned as follows:

ϕj
{

,

Lj,p,p(cid:48) = Cov

L×j,p,p(cid:48) = Cov

(cid:16)

(cid:16)

[X

[X

∗

∗

ϕj(r)]p , [X

ϕj(r)]p , [Y

ϕj(r)]p(cid:48)(cid:17)
ϕj(r)]p(cid:48)(cid:17)

,

.

∗

∗

(12)

(13)

In this work, we choose j

∈ {−

1, 0, 1, 2
}

and consider

(0, 0), (1, 1), (0, 1)
the following set of values for (p, p(cid:48)):
}
{
for auto moments, and
for
cross moments.8 These moments complement our de-
scription with a very small number of coeﬃcients: 12
and 16 in the auto and cross cases, respectively.

(0, 0), (1, 1), (0, 1), (1, 0)

}

{

3.2.4. Estimation and computation

We estimate the previous moments from a given map
x or couple of maps (x, y) as explained in Appendix B.5.
Note that the resulting statistical coeﬃcients include
a normalization designed to facilitate the gradient de-
scent involved during the sampling of our model (see
Sect. 3.1). We denote by φauto(x) and φcross(x, y) the
corresponding vector of auto and cross-WPH statis-
tics, respectively. Computations all employ the GPU-
accelerated Python package PyWPH (Regaldo-Saint Blan-
card et al. 2021).

7 Since we deal with ﬁelds with periodic boundary conditions, in
order to avoid redundancy in the coeﬃcients, ∆n should verify
∆n < log2(N/2) + 1, where N is the number of pixels along the
smallest axis of our images. Our choice meets this criterion.

8 Note that this choice of (p, p(cid:48)) values for the cross moments makes
the resulting set of moments invariant under the exchange of X
and Y .

8

R´egaldo-Saint Blancard et al.

4. MODELS AND THEIR VALIDATION

This section presents the core results of this paper:
the construction and validation of two distinct genera-
tive models built from the simulated data introduced in
Sect. 2. These are:

1. A mono-frequency model based on the joint obser-
vation of (I300, E300, B300), introduced in Sect. 4.1.

2. A multi-frequency model based on the joint obser-
vation of (I300, I500, I800, I1500, I3000), introduced
in Sect. 4.2.

For each of these models, we perform a visual and quan-
titative assessment of their realism.

The data and codes to reproduce the models are pro-
vided on https://github.com/bregaldo/dust genmodels.

4.1. Mono-frequency model
4.1.1. Description of the model

We build a generative model based on the joint obser-
vation of (I300, E300, B300) as follows (referred to as “the
WPH model” in the following). We deﬁne a microcanon-
ical model of x = (log(I300), E300, B300) conditioned by
the following descriptive statistics:

φ(x) = φauto(log(I300))

φauto(E300)

φauto(B300)

⊕

⊕

φcross(log(I300), E300)

⊕

⊕

φcross(log(I300), B300)),
(14)

⊕

where
denotes vector concatenation. We choose to
model the logarithm of the total intensity map I300
for two main reasons: 1) the logarithm tends to Gaus-
sianize the data (analytical statistical models of dust
total intensity maps are usually deﬁned as log-normal
ﬁelds, see e.g. Levrier et al. (2018)), and thus to sim-
plify the modeling, 2) pixels of I maps take positive
values, so that working with the logarithm avoids to
impose positive values on the synthetic I maps dur-
ing the sampling procedure. Also note that φcross is
designed to be pseudo-symmetric (see Appendix B.4),
so that φcross(log(I300), E300) and φcross(E300, log(I300))
are equally informative in characterizing the couplings
between log(I300) and E300 (and obviously this remains
true for (log(I300), B300)). Our choice to ignore the
couplings between E300 and B300 is motivated by ob-
servational measurements indicating a null EB cross-
spectrum (Planck Collaboration XI 2020). However,
note that these measurements do not say anything on
higher-order cross statistics, so that this modeling choice
remains partly arbitrary.

The eﬀective dimension of φ(x) is

104, which
amounts to less than 6 % of the total number of pixels

4.4

×

∼

of x. Samples are drawn by minimizing the objective
function deﬁned in Eq. (7), starting from a triplet of
realizations of three independent Gaussian random ﬁelds
having the same power spectrum as the empirical power
spectrum of log(I300), E300, and B300, respectively.9 To
perform this optimization we use the L-BFGS algorithm
that is implemented in SciPy (Byrd et al. 1995; Zhu
et al. 1997; Virtanen et al. 2020).10 This necessitates
the computation of the gradients of the objective with
respect to the pixels of the optimized maps at every
iteration. We compute such gradients using automatic
diﬀerentiation as implemented in PyTorch (Paszke et al.
2019). The sampling takes
6 min for 200 iterations
on a NVIDIA A100-SXM4 GPU with 40GB of memory.
In the following, we also make use of a Gaussian equiv-
alent of this previous model as a baseline (referred to as
“the Gaussian model”).
It is a microcanonical model
conditioned by the auto and cross-WPH statistics that
only estimate the power and cross spectrum information,
respectively. As before, we ignore the couplings between
E300 and B300. We refer to Appendix C for additional
details on this model and to Fig. 10 for visual examples
of its samples. The samples are drawn as above.

∼

4.1.2. Visual assessment

We show in Fig. 2 the original simulated maps
(log(I300), E300, B300) (ﬁrst row, from left to right) next
to three diﬀerent samples (also referred to as “synthe-
ses”) of the WPH model (second to fourth rows).

The synthetic log(I300) maps statistically reproduce
the main features of the original map. Given the im-
portant variability of structures across samples, and the
diﬃculty to distinguish original from synthetic maps at
ﬁrst glance, this model seems to provide a relevant ap-
proximation of the underlying probability distribution
of the original data. We emphasize that to achieve simi-
lar results, deep generative models usually require thou-
sands of observations, whereas, here, our model is only
based on a single example. In Aylor et al. (2021) and
Thorne et al. (2021), slightly more than one thousand
total intensity maps were used to train a GAN and a
VAE, respectively. While the visual quality of the GAN
syntheses is roughly equivalent to ours, this is not the

9 Note that the power spectrum of the maps is constrained during
the optimization, thus we could have also started from indepen-
dent realizations of Gaussian white noises without impacting the
results of this paper. Here, this choice is only motivated by the
numerical eﬃciency of the optimization.

10 The L-BFGS algorithm is a quasi-Newton method, which is not,
properly speaking, a gradient descent method. However, this
algorithm has been shown experimentally to be more suitable for
solving this optimization problem compared to standard gradient
descent algorithms.

Generative Models of Multi-channel Dust Emission Maps

9

Figure 2. Joint (log10(I300), E300, B300) syntheses (from second to last rows) sampled from the generative model described in
Sect. 4.1 and which only relies on the statistics of the joint map shown in top row (same joint map as the top row of Fig. 1).
Dashed circles show examples of spatial correlations across the observables I, E, and B.

−20−1001020y[pc]log10(I300)E300B300−20−1001020y[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020x[pc]10

R´egaldo-Saint Blancard et al.

case for that of the VAE model which notably fails to
reproduce small-scale patterns of the maps.

For the polarization maps E300 and B300, there is also
qualitative visual agreement between the synthetic and
original maps, although close scrutiny reveals subtle ar-
tifacts compared to the I case. The diversity of struc-
tures across samples is still satisfactory in this case.

Finally, spatial correlations between the total inten-
sity maps and the polarization maps are also well re-
produced. Circles in black dashed lines show examples
of such correlations for both the original and synthetic
data. Taking into account these correlations is a signif-
icant improvement over both previous microcanonical
models (Allys et al. 2019; Regaldo-Saint Blancard et al.
2020; Jeﬀrey et al. 2021) and deep generative models
of dust emission maps (Aylor et al. 2021; Thorne et al.
2021; Krachmalnicoﬀ & Puglisi 2021).

4.1.3. Quantitative assessment

We choose to quantitatively assess the realism of the
WPH model by means of a statistical comparison. We
build ten independent samples of both the WPH and the
Gaussian model, following the same procedure as before.
In Fig. 3, we compare the empirical power spectra, dis-
tribution of pixels values, and the Minkowski functionals
derived from the samples of the WPH model, those of
the Gaussian model, and the original maps, for each of
the observables I, E, and B taken separately. For the
WPH Gaussian models, we show mean statistics across
the ten independent samples, and when displayed, the
error bars correspond to the standard deviations across
these samples. In Fig. 4, we compare the joint distri-
butions of pixel values between all pairs of observables
in the original, WPH, and Gaussian cases. Contrary to
Fig. 3, in the WPH and Gaussian cases, we show statis-
tics estimated from a single sample of the model. The
results are discussed below.

Power spectrum. —We ﬁrst recall that our models di-
rectly include power spectrum constraints (see Ap-
pendix B.2 for additional details), so that the power
spectra of the synthetic maps are expected to match
those of the original maps very well. We show the power
spectrum analysis in the top row of Fig. 3. While the
power spectra of the E and B maps are indeed very
well reproduced, the agreement is slightly worse for the
I maps at small scales. The discrepancies take the
form of a very subtle excess of power in the synthetic
maps. As explained previously, we constrain the WPH
statistics of log(I) instead of I, so that this kind of dis-
crepancies is not surprising. We have checked that the
power spectrum of log(I) is very well reproduced, as ex-
pected. These discrepancies thus show that the WPH

model does not perfectly capture the power spectrum
of the exponential of the constrained data. Similarly,
we observe comparable discrepancies between the power
spectrum of the Gaussian data and that of the original
data. Here again, the Gaussian model applies to log I
and not I, meaning that I is modeled by a log-Gaussian
model. Such discrepancies thus underlie the limit of log-
Gaussian models for dust intensity maps.

Distribution of pixels. —We show the distributions of
pixel values in the second row of Fig. 3. The bulks of
these distributions agree between the syntheses and the
original maps to a very good extent (three orders of
of magnitude on the y-axis). Discrepancies appear in
the tails of the distributions. These are subtle for the
polarization observables E and B, but more signiﬁcant
for the I maps. Note that Aylor et al. (2021) pointed
out similar diﬃculties in capturing the tails of these dis-
tributions with their GAN model. The quality of the
constraints on these statistics within the WPH model
highly depends on our choice of scaling moments.
It
is likely that we could improve these results by taking
into account more j values in the deﬁnition of our sub-
set of scaling moments (see Sect. 3.2.3). Compared to
the Gaussian model, the WPH model does much better,
showing its ability to capture non-Gaussian properties
of the data.

Minkowski functionals. —Minkowski functionals are of-
ten used to characterize the morphological aspects of
In cosmology, these have been
smooth random ﬁelds.
used in various contexts, as the investigation of poten-
tial non-Gausianity and anisotropy in the CMB (see e.g.
Planck Collaboration Int. XXIII (2015); Planck Collab-
oration VII (2020)), the characterization of the large-
scale structure (e.g. Codis et al. (2013)) or that of weak
lensing data (e.g. Parroni et al. (2020)).
In the ISM
community, these are however much less popular statis-
tics, although it has already been applied in the context
of dust modeling (Aylor et al. 2021; Krachmalnicoﬀ &
Puglisi 2021; Burkhart 2021). In two dimensions, there
are three Minkowski functionals
M2,
which are deﬁned as follows. For given a map x and
α
,
α
}
which simply corresponds to the region where the ﬁeld
is greater than a given threshold. The Minkowski func-

M0,
R, we deﬁne the excursion set Γα =

M1, and
x(r)
r
{

≥

∈

|

Generative Models of Multi-channel Dust Emission Maps

11

Figure 3. Quantitative validation of the mono-frequency model described in Sect. 4.1. We compare the empirical power spectra
(ﬁrst row), distributions of pixel values (second row), and Minkowski functionals (third to ﬁfth rows) computed separately for
the I, E, and B maps (from left to right) of the original, WPH and Gaussian data. For the WPH and Gaussian models, we
show mean statistics across ten independent samples, and the errors are the standard deviations across these samples. Vertical
dashed lines on the power spectrum plots mark the central frequencies of the wavelets used for this analysis.

10−210−1100k10−510−310−1101103PSIOriginalWPHGaussian10−210−1100k10−410−2100E10−210−1100k10−410−2100B0.00.20.40.60.81.010−410−2100PDF−0.20.00.20.410−410−310−210−1100101−0.4−0.20.00.210−410−21000.00.20.40.60.81.010−610−410−2100M0−0.20.00.20.410−510−310−1−0.4−0.20.00.210−510−310−10.00.20.40.60.81.00.00000.00250.00500.00750.01000.0125M1−0.20.00.20.40.0000.0050.0100.0150.020−0.4−0.20.00.20.0000.0050.0100.0150.0200.00.20.40.60.81.0I−0.0004−0.00020.00000.00020.0004M2−0.20.00.20.4E−0.00050.00000.00050.0010−0.4−0.20.00.2B−0.00050.00000.00050.001012

R´egaldo-Saint Blancard et al.

Original

WPH

Gaussian

(log10(I), E)

0.092

0.095 ± 0.006

0.033 ± 0.002

(log10(I), B)

0.122

0.101 ± 0.006

0.020 ± 0.003

(E, B)

0.059

0.054 ± 0.008

0.014 ± 0.002

Table 1. Mutual information (in shannon units) associated
with the joint distributions of pixel values of (log10(I), E),
(log10(I), B), and (E, B), estimated for the original, WPH,
In the WPH and Gaussian cases, the
and Gaussian data.
values correspond to the means and standard deviations of
the mutual information across ten independent samples.

duced by the WPH model. In comparison, the Gaussian
model performs poorly. Comparable results on polar-
ization data were obtained in Krachmalnicoﬀ & Puglisi
(2021) using a GAN (although in a slightly diﬀerent con-
text). Being able to reproduce such results with a model
based on a single observation and without training is one
of the successes of our approach. On the other hand, for
I, although the WPH model seems to do slightly better
than the Gaussian model for
M1, this is less clear for
M2. This underlies the higher diﬃculty of the WPH
model to perfectly capture the complexity of I maps.
Note that we would get similar results for log(I) on
M1
and
M2 since applying a pointwise monotonous function
to our maps would not impact the level sets involved in
the derivation of these statistics.

Joint distribution of pixels. —Figure 4 shows the joint dis-
tributions of pixel values of (log(I), E), (log(I), B), and
(E, B) (from top to bottom row) for our data. These
statistics are, here again, mostly constrained by the scal-
ing moments we have introduced in the WPH model.
The agreement of these distributions between the WPH
model and the original data is satisfactory, and signif-
icantly better than the Gaussian case. Note that no
cross constraint between E and B was imposed, so that
it is not surprising to ﬁnd a slightly worse agreement
of the contours. In order to make sure that this agree-
ment is not a mere consequence of the agreement of the
marginal distributions of pixel values, we have estimated
the mutual information associated with each of these dis-
tributions.11 The results of this analysis are shown in
Table 1. These show a signiﬁcant dependence between
all pairs of observables on the original data, as well as a

11 The mutual information of two random variables X and Y quan-
tiﬁes the mutual dependence between X and Y , and is deﬁned
as the Kullback-Leibler divergence of the joint distribution pX,Y
from the product of the marginal distributions pX pY .

Figure 4. Quantitative validation of the mono-frequency
model described in Sect. 4.1. We compare the joint distribu-
tions of the pixel values of (log(I), E), (log(I), B), and (E, B)
(from top to bottom) in the original, WPH, and Gaussian
maps (from left to right). We add for each of these plots,
contours at 0.5σ, 1σ, and 2σ. For the WPH and Gaussian
models, statistics are estimated from a single sample.

tionals associated with x are:
(cid:90)

M0(α) =

M1(α) =

M2(α) =

Γα
(cid:90)

1
A
1
2πA
1
2π2A

da,

dl,

∂Γα
(cid:90)

∂Γα

κdl,

(15)

(16)

(17)

where A is the total area of the ﬁeld, ∂Γα is the bound-
ary of Γα, da and dl are the surface and line elements
associated with Γα and ∂Γα, respectively, and κ is the
curvature of ∂Γα. The functionals
M0,
M2
are called the area, perimeter, and genus (i.e. number
of “holes”) characteristics, respectively.

M1 and

We show in the third,

fourth, and ﬁfth rows of
Fig. 3, the Minkowski functionals statistics for our data.
We compute these statistics using the Python package
QuantImPy (Boelens & Tchelepi 2021). The area
M0
just gives another perspective of the previous distribu-
tions of pixels as it directly relates to the cumulative dis-
tribution of pixels values. Contrary to this, the perime-
ter
M2 provide new in-
sights on our models. We see that for the polarization
observables E and B, these statistics are very well repro-

M1 and genus characteristics

−1.2−1.0−0.8log10(I)−0.050.000.05EOriginal−1.2−1.0−0.8log10(I)WPH−1.2−1.0−0.8log10(I)Gaussian−1.2−1.0−0.8log10(I)−0.050.000.05B−1.2−1.0−0.8log10(I)−1.2−1.0−0.8log10(I)−0.050.000.05E−0.050.000.05B−0.050.000.05E−0.050.000.05EGenerative Models of Multi-channel Dust Emission Maps

13

signiﬁcantly better capture of these dependencies in the
WPH model compared to the Gaussian model.

4.2. Multi-frequency model
4.2.1. Description of the model

We now deﬁne a generative model of the multi-
frequency simulated maps (I300, I500, I800, I1500, I3000)
as follows. For the same reasons as before, we prefer
to work with the logarithm of these intensity maps.
Since the maps from one frequency channel to an-
other look very similar (modulo a global scaling or
shift of the mean), we choose to impose statistical con-
straints on the diﬀerences of the logarithms of these
maps (which are also the logarithms of the ratios of
these maps) between consecutive frequency channels.
One of the maps also needs to be constrained in ab-
solute to serve as a reference. Consequently, with
ν1, . . . , ν5 = 300, . . . , 3000 GHz, we deﬁne a microcanon-
ical model of x = (log(Iν1))
4 con-
ditioned by:

(log(Iνi+1/Iνi))1

⊕

≤

≤

i

φ(x) = (φauto(xi))1

≤

i
≤

5 ⊕

(φcross(xi, xj))1

i<j

≤

≤

5. (18)

Contrary to the mono-frequency case, we consider
cross constraints between all the possible pairs of maps.
Although this signiﬁcantly increases the dimensionality
of the statistical description as well as the computational
cost of the sampling procedure, this gives the best visual
and quantitative results in what follows. The eﬀective
104, which amounts to
dimension of φ(x) is
8.9
×
7 % of the total number of pixels of x. The sam-
∼
pling procedure takes
17 min for 200 iterations on a
NVIDIA A100-SXM4 GPU with 40GB of memory. We
make use of a single sample of this model in the follow-
ing.

∼

∼

4.2.2. Visual assessment

We show in Fig. 5 a selection of maps derived from the
resulting multi-frequency synthesis (bottom row) below
the corresponding original maps (top row). We show
the log(I300) maps, and the ratio maps log(I800/I300)
and log(I3000/I1500) (from left to right). Visually, the
synthetic maps are very satisfactory, with a realistic ﬁl-
amentary structure. Moreover, spatial correlations from
one map to another are consistent with those visible on
the original maps. This shows that our statistical de-
scription seems to properly capture interactions between
frequency channels.

4.2.3. Quantitative assessment

We quantitatively assess the realism of such multi-
frequency models by focusing on how well both the orig-
inal and synthetic multi-frequency maps can be ﬁtted by

a MBB model, and comparing their respective parame-
ters. MBB models are ubiquitous in the interstellar dust
literature, and constitute the standard means to model
and parameterize the frequency dependence of emission
maps (see e.g. Planck Collaboration XI (2014)). These
are directly related to the model of the emission and ab-
sorption properties of dust grains that was employed in
Sect. 2 to build our original simulated maps. Indeed, a
MBB model ˜Iν(r) is deﬁned as:

˜Iν(r) = τ (r)νβ(r)Bν(T (r)),

(19)

where, added to the spectral index map β(r) and tem-
perature map T (r), we also introduce the optical depth
map τ (r).

For each pixel of both the original and synthetic multi-
frequency data, we ﬁt the parameters of this model to
the data by performing a non-linear least squares mini-
mization. To do that, we employ the SciPy implemen-
tation of the Levenberg-Marquardt algorithm (Virtanen
et al. 2020). We perform the minimization on logarith-
mic values, and initialize the parameters with T0 = 20 K,
β0 = 1.5, and τ0 = I300(r)/(300β0 Bν(T0)). We show in
r values. The χ2
Fig. 6, the resulting distribution of χ2
r
4, showing that
values are nowhere larger than
10−
the ﬁt performs very well on both the simulated and syn-
thetic data.12 This result is not particularly surprising
for the original data (albeit non-trivial), given the fact
that we had employed a MBB-like law of dust grains
emission at the voxel level. However, no prior informa-
tion on this MBB law was given in our model, which
shows that our statistical description has been somehow
able to capture this SED. Moreover, the agreement of
the χ2
r distributions is a stronger result as it shows that
the MBB is as well suited to model the SED of the syn-
thetic maps as it is for the original maps, which is the
ideal behavior of such a model.

∼

×

3

We show in Fig. 7 (a) the resulting parameters maps τ ,
T , and β for both the original (top row) and synthetic
data (bottom row), as well as their distributions (b).
Let us ﬁrst remark that the anti-correlation between β
and T as well as the positive correlation between n and
T that were instilled at the voxel level when building
the simulated data in Sect. 2.3 clearly reﬂects in the
parameter maps of this (projected) simulated data. In-
deed, T clearly tends to be higher (lower) for low (high)
values of τ , and similarly, T and β appear to be anti-
correlated. The synthetic parameters maps exhibit the
same properties. Moreover, the consistency of the struc-
tures between the synthetic and original parameter maps

12 Since we perform the ﬁt on logarithmic values, χ2

r roughly corre-

spond to the mean square relative error.

14

R´egaldo-Saint Blancard et al.

Figure 5. log10(I300), log10(I800/I500), and log10(I3000/I1500) synthetic maps (bottom row, from left to right) sampled from
the generative model described in Sect. 4.2 and which is based on the maps shown in top row.

models to play a central role for high-precision dust fore-
ground modeling in the context of primordial B-modes
detection. In this context, we believe that learning such
models directly from the data, as shown here, consti-
tutes a valuable complementary approach to the accu-
rate modeling of this frequency dependence.

5. CONCLUSION

We have introduced a generic methodology using
WPH statistics to build generative models of multi-
channel non-Gaussian data. Our approach is purely
data-driven, and the models can be derived from a single
example of simulated or observational data. Models are
microcanonical gradient descent models conditioned by
the set of WPH statistics of the target data. We have re-
viewed the main ideas of the underlying formalism and
introduced an extended family of WPH statistics en-
hancing previous works.

In order to characterize the couplings between two
diﬀerent channels, we have introduced the cross-WPH
moments. These are key to this paper. They corre-
spond to direct extensions of the (auto-)WPH moments
previously introduced in the literature. They include
the cross spectrum information, but also quantify non-
Gaussian interactions across channels. We also have in-
troduced a new family of moments, called auto/cross-
scaling moments, that is designed to probe the largest
scales and better constrain the single map or joint one-

Figure 6. Distributions of χ2
r values associated with the pix-
elwise MBB ﬁts on the original and synthetic multi-frequency
I maps.

show that our model is able to capture the spatial varia-
tions of this frequency dependence in a very satisfactory
way. Comparisons of the distributions of these parame-
ters maps strengthens us in this conclusion.

Note that, in real observational conditions, departures
from the MBB model are expected in the dust signal.
Formalisms to deal with them have been studied in the
literature for both total intensity (see e.g. Chluba et al.
2017; Hensley & Bull 2018; Mangilli et al. 2021) and
polarization data (Ichiki et al. 2019; Vacher et al. 2022;
McBride et al. 2022), and we expect such more reﬁned

−20−1001020y[pc]−20−1001020x[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020x[pc]−1.4−1.2−1.0−0.8−0.6log10(I300)0.4350.4400.4450.4500.4550.4600.4650.470log10(I800/I500)−0.95−0.90−0.85−0.80−0.75−0.70log10(I3000/I1500)−1.4−1.2−1.0−0.8−0.6log10(I300)0.4350.4400.4450.4500.4550.4600.4650.4700.475log10(I800/I500)−0.95−0.90−0.85−0.80−0.75−0.70log10(I3000/I1500)10−610−510−410−3χ2r101102103104105PDFOriginalWPHGenerative Models of Multi-channel Dust Emission Maps

15

(a)

(b)

Figure 7. (a) MBB parameters maps log10(τ ), T , and β (from left to right) resulting from the pixelwise ﬁts of a MBB model to
both the original (top row) and synthetic (bottom row) multi-frequency I maps. (b) Resulting distributions of these parameters.

point distribution. The Python package PyWPH13, previ-
ously released in Regaldo-Saint Blancard et al. (2021),
has been updated to easily build such multi-channel gen-
erative models from two-dimensional data.

Here, we have applied this methodology to multi-
channel simulated maps of the interstellar dust emission.
The simulated maps were built from a MHD simulation
assuming a simple phenomenological model of the multi-
frequency emission of dust grains. We have constructed
and studied two separate generative models:

13 https://github.com/bregaldo/pywph/

1. A model of a mono-frequency (I, E, B) input tak-
ing into account I-E and I-B correlations. Sam-
ples of this model were shown to exhibit statisti-
cally consistent features with those of the original
maps, including correlated structures across I, E,
and B. A quantitative assessment demonstrated
that the empirical power spectra, distributions of
pixel values, and Minkowski functionals of the I,
E, and B synthetic maps match the correspond-
ing statistics of the original maps to a good ex-
tent. However, slight discrepancies of these statis-
tics were found for the I maps. Finally, an analysis
of the joint distributions of pixel values has shown

−20−1001020y[pc]−20−1001020x[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020x[pc]14.214.414.614.815.015.2log10τ12.513.013.514.014.515.0T[K]1.41.51.61.71.81.9β14.214.414.614.815.015.2log10τ12.513.013.514.014.515.0T[K]1.41.51.61.71.81.9β14.014.515.015.516.0log10τ0.00.51.01.52.0PDFOriginalWPH111213141516T0.00.20.40.60.81.41.61.82.02.2β0123416

R´egaldo-Saint Blancard et al.

that our model captures the dependencies between
the observables to a good extent.

2. A model of a multi-frequency (Iν)ν input, for ﬁve
frequency channels, and taking into account the
strong correlations of the maps across the fre-
quency axis. Samples of the model exhibit con-
sistent features and correlations with those of the
original maps. We have quantitatively assessed
this model by ﬁtting the SED of our data with
a MBB law. This law ﬁts very well and consis-
tently both the synthetic maps and the original
maps. The comparison of the parameters maps
has shown a very good agreement, underlining the
success of our approach in capturing the spatial
variations of the SED from the data.

The perspectives of this work are numerous.
First, we underline that the statistical validation of
our models could be improved.
Indeed, a more rigor-
ous approach would be to compare the statistics of the
samples of our model to those of a large number of in-
dependent samples of the random ﬁeld X we wish to
approximate. We have chosen here to build our model
from a single observation x, implicitly assuming that the
statistics of x are representative of those of X (which re-
lates to an “ergodic” assumption, see Bruna & Mallat
(2019)), and consequently, the validation of our models
were performed relatively to the statistics of x only. We
could go beyond this assumption by studying the vari-
of
ability of the statistics of a collection of samples
X in our analysis, and validating our model with respect
to this variability. However, let us mention that in our
case the data relies on a costly MHD simulation, which
prevents the construction of an arbitrarily large number
of samples (for a discussion, see Regaldo-Saint Blancard
et al. 2020).

xi
{

}

We will address the modeling of multi-frequency po-
In the case of
larization maps in a follow-up paper.
multi-frequency I maps, we have constructed a micro-
canonical model based on the ratio maps between con-
secutive channels. Proceeding similarly for E and B
is not an option since these variables can exhibit null
values. Moreover, the nature of the linear polarization
observable is vectorial, which might require the intro-
duction of a complex variable E + iB, or Q + iU as
in Regaldo-Saint Blancard et al. (2020, 2021).14 These
modeling choices should take inspiration from the lit-

14 Note that this is not an obstacle to our methodology, and that
the computation of WPH statistics on complex-valued maps is
supported by PyWPH.

erature on analytical models of the dust polarization
SED (Ichiki et al. 2019; Vacher et al. 2022; McBride
et al. 2022).

From a more general perspective, the cross-WPH
statistics open a new way to analyze and combine multi-
channel data, allowing us to eﬃciently describe and
model non-Gaussian correlations across diﬀerent maps.
Moreover, given a WPH model of the interactions be-
tween two channels A and B, and combined with the for-
malism of microcanonical models, these statistics should
allow for statistically relevant predictions of B maps
based on the observation of A maps. Such “conditioned”
models will be explored in further works.

In the context of dust modeling for CMB analysis,
such generative models are expected to improve forward
models of the CMB sky. In Jeﬀrey et al. (2021), a WPH
model of dust polarization maps played a crucial role for
CMB foreground marginalization in a likelihood-free in-
ference framework. In this work, the inference was per-
formed on mono-frequency maps, the present paper now
paves the way to an extension to the multi-frequency
case.

Finally, this work is expected to improve statistical
denoising methods of dust polarization maps, such as in-
troduced in Regaldo-Saint Blancard et al. (2021). Tak-
ing into account the multi-channel aspect of the data
should provide more accurate estimations of the statis-
tics of the noise-free emission since observations at diﬀer-
ent frequency bands are usually aﬀected by independent
noise processes. Note that very recently, and in paral-
lel to this work, a signiﬁcant step has been taken in this
direction by Delouis et al. (2022) employing WST statis-
tics. In this paper, the authors extended the WST to
the sphere and introduced cross-WST statistics to char-
acterize correlations across observables in order to sta-
tistically denoise Planck all-sky maps of the dust emis-
sion.

ACKNOWLEDGMENTS

We thank Michael O’Brien and Blakesley Burkhart for
their help in investigating a bispectrum validation of the
models of this paper.

Software: NumPy (Harris et al. 2020), PyTorch
(Paszke et al. 2019), PyWPH (Regaldo-Saint Blancard
et al. 2021), QuantImPy (Boelens & Tchelepi 2021),
SciPy (Virtanen et al. 2020)

Generative Models of Multi-channel Dust Emission Maps

17

REFERENCES

Abazajian, K., Addison, G., Adshead, P., et al. 2019.

Ishino, H., Akiba, Y., Arnold, K., et al. 2016, in Space

https://arxiv.org/abs/1907.04473

Allys, E., Levrier, F., Zhang, S., et al. 2019, A&A, 629,

A115, doi: 10.1051/0004-6361/201834975

Allys, E., Marchand, T., Cardoso, J.-F., et al. 2020,

Telescopes and Instrumentation 2016: Optical, Infrared,
and Millimeter Wave, ed. H. A. MacEwen, G. G. Fazio,
et al., Vol. 9904, International Society for Optics and
Photonics (SPIE), 354 – 361, doi: 10.1117/12.2231995

PhRvD, 102, 103506, doi: 10.1103/PhysRevD.102.103506

Jeﬀrey, N., Boulanger, F., Wandelt, B. D., et al. 2021,

Aylor, K., Haq, M., Knox, L., et al. 2021, MNRAS, 500,

MNRAS: Letters, 510, L1, doi: 10.1093/mnrasl/slab120

3889, doi: 10.1093/mnras/staa3344

Bellomi, E., Godard, B., Hennebelle, P., et al. 2020, A&A,

643, A36, doi: 10.1051/0004-6361/202038593

BICEP2/Keck Array and Planck Collaborations. 2015,

PhRvL, 114, 101301,
doi: 10.1103/PhysRevLett.114.101301

Boelens, A. M., & Tchelepi, H. A. 2021, SoftwareX, 16,

100823, doi: https://doi.org/10.1016/j.softx.2021.100823
Brochard, A., Zhang, S., & Mallat, S. 2022, in International

Conference on Learning Representations.
https://openreview.net/forum?id=ziRLU3Y2PN
Bruna, J., & Mallat, S. 2013, IEEE Transactions on

Pattern Analysis and Machine Intelligence, 35, 1872,
doi: 10.1109/TPAMI.2012.230

—. 2019, Mathematical Statistics and Learning, 1, 257,

doi: 10.4171/msl/7

Burkhart, B. 2021, PASP, 133, 102001,

doi: 10.1088/1538-3873/ac25cf

Byrd, R., Lu, P., Nocedal, J., & Zhu, C. 1995, SIAM

Journal on Scientiﬁc Computing, 16, 1190,
doi: 10.1137/0916069

Chluba, J., Hill, J. C., & Abitbol, M. H. 2017, MNRAS,

472, 1195, doi: 10.1093/mnras/stx1982

Codis, S., Pichon, C., Pogosyan, D., et al. 2013, MNRAS,

435, 531, doi: 10.1093/mnras/stt1316

Delabrouille, J., Betoule, M., Melin, J. B., et al. 2013,
A&A, 553, A96, doi: 10.1051/0004-6361/201220019
Delouis, J. M., Allys, E., Gauvrit, E., & Boulanger, F.

2022, doi: 10.48550/ARXIV.2207.12527

Fraisse, A. A., Ade, P. A. R., Amiri, M., et al. 2013, JCAP,

2013, 047, doi: 10.1088/1475-7516/2013/04/047

Fromang, S., Hennebelle, P., & Teyssier, R. 2006, A&A,

457, 371, doi: 10.1051/0004-6361:20065371

Harris, C. R., Millman, K. J., van der Walt, S. J., et al.

2020, Nature, 585, 357, doi: 10.1038/s41586-020-2649-2

Hensley, B. S., & Bull, P. 2018, ApJ, 853, 127,

doi: 10.3847/1538-4357/aaa489

Kamionkowski, M., Kosowsky, A., & Stebbins, A. 1997,
PhRvL, 78, 2058, doi: 10.1103/PhysRevLett.78.2058
Kamionkowski, M., & Kovetz, E. D. 2016, ARA&A, 54,

227, doi: 10.1146/annurev-astro-081915-023433
Krachmalnicoﬀ, N., & Puglisi, G. 2021, ApJ, 911, 42,

doi: 10.3847/1538-4357/abe71c

Levin, D., & Peres, Y. 2017, Markov Chains and Mixing
Times, 2nd edn. (American Mathematical Society)

Levrier, F., Neveu, J., Falgarone, E., et al. 2018, A&A, 614,

A124, doi: 10.1051/0004-6361/201732128

Mallat, S. 2012, Communications on Pure and Applied

Mathematics, 65, 1331, doi: 10.1002/cpa.21413

Mallat, S. 2016, Philosophical Transactions of the Royal

Society of London Series A, 374, 20150203,
doi: 10.1098/rsta.2015.0203

Mallat, S., Zhang, S., & Rochette, G. 2019, Information

and Inference: A Journal of the IMA, 9, 721,
doi: 10.1093/imaiai/iaz019

Mangilli, A., Aumont, J., Rotti, A., et al. 2021, A&A, 647,

A52, doi: 10.1051/0004-6361/201937367
McBride, L., Bull, P., & Hensley, B. S. 2022,

doi: 10.48550/ARXIV.2207.14213

Naess, S., Hasselﬁeld, M., McMahon, J., et al. 2014, JCAP,

2014, 007, doi: 10.1088/1475-7516/2014/10/007

Parroni, C., Cardone, V. F., Maoli, R., & Scaramella, R.

2020, A&A, 633, A71, doi: 10.1051/0004-6361/201935988
Paszke, A., Gross, S., Massa, F., et al. 2019, in Advances in
Neural Information Processing Systems, ed. H. Wallach,
H. Larochelle, et al., Vol. 32 (Curran Associates, Inc.).
https://proceedings.neurips.cc/paper/2019/ﬁle/
bdbca288fee7f92f2bfa9f7012727740-Paper.pdf
Planck Collaboration XI. 2014, A&A, 571, A11,

doi: 10.1051/0004-6361/201323195

Planck Collaboration X. 2016, A&A, 594, A10,

doi: 10.1051/0004-6361/201525967

Planck Collaboration I. 2020, A&A, 641, A1,

Herv´ıas-Caimapo, C., & Huﬀenberger, K. M. 2022, ApJ,

doi: 10.1051/0004-6361/201833880

928, 65, doi: 10.3847/1538-4357/ac54b2

Ichiki, K., Kanai, H., Katayama, N., & Komatsu, E. 2019,
Progress of Theoretical and Experimental Physics, 2019,
doi: 10.1093/ptep/ptz009

Planck Collaboration IV. 2020, A&A, 641, A4,

doi: 10.1051/0004-6361/201833881

Planck Collaboration VII. 2020, A&A, 641, A7,

doi: 10.1051/0004-6361/201935201

18

R´egaldo-Saint Blancard et al.

Planck Collaboration XI. 2020, A&A, 641, A11,

Teyssier, R. 2002, A&A, 385, 337,

doi: 10.1051/0004-6361/201832618

doi: 10.1051/0004-6361:20011817

Planck Collaboration Int. XX. 2015, A&A, 576, A105,

doi: 10.1051/0004-6361/201424086

Planck Collaboration Int. XXIII. 2015, A&A, 580, A13,

doi: 10.1051/0004-6361/201424434

Thorne, B., Dunkley, J., Alonso, D., & Næss, S. 2017,
MNRAS, 469, 2821, doi: 10.1093/mnras/stx949

Thorne, B., Knox, L., & Prabhu, K. 2021, MNRAS, 504,

2603, doi: 10.1093/mnras/stab1011

Vacher, J., & Briand, T. 2021, Image Processing On Line,

Planck Collaboration Int. XLVIII. 2016, A&A, 596, A109,

11, 170

doi: 10.1051/0004-6361/201629022

Vacher, L., Chluba, J., Aumont, J., Rotti, A., & Montier,

R´egaldo-Saint Blancard, B. 2021, Ph.d. thesis, Ecole

L. 2022, doi: 10.48550/ARXIV.2205.01049

Normale Sup´erieure ; Observatoire de Paris.

https://tel.archives-ouvertes.fr/tel-03600846

Regaldo-Saint Blancard, B., Allys, E., Boulanger, F., et al.

2021, A&A, 649, L18, doi: 10.1051/0004-6361/202140503

Regaldo-Saint Blancard, B., Levrier, F., Allys, E., et al.

2020, A&A, 642, A217,

doi: 10.1051/0004-6361/202038044

Reissl, S., Guillet, V., Brauer, R., et al. 2020, A&A, 640,

A118, doi: 10.1051/0004-6361/201937177

Simons Observatory Collaboration. 2019, JCAP, 2019, 056,

doi: 10.1088/1475-7516/2019/02/056

Vansyngel, F., Boulanger, F., Ghosh, T., et al. 2017, A&A,

603, A62, doi: 10.1051/0004-6361/201629992

Virtanen, P., Gommers, R., Oliphant, T. E., et al. 2020,

Nature Methods, 17, 261, doi: 10.1038/s41592-019-0686-2

Zaldarriaga, M. 2001, PhRvD, 64, 103001,

doi: 10.1103/PhysRevD.64.103001

Zhang, S., & Mallat, S. 2021, Applied and Computational

Harmonic Analysis, 53, 199,
doi: https://doi.org/10.1016/j.acha.2021.01.003

Zhu, C., Byrd, R. H., Lu, P., & Nocedal, J. 1997, ACM
Transactions on Mathematical Software, 23, 550–560,
doi: 10.1145/279232.279236

Generative Models of Multi-channel Dust Emission Maps

19

APPENDIX

A. MAXIMUM ENTROPY MICROCANONICAL MODELS

In this Appendix, we deﬁne maximum entropy microcanonical models, which underlie the microcanonical gradient
descent models introduced in Sect. 3.1. This presentation is based on Bruna & Mallat (2019), and we refer to this
paper for additional details.

Microcanonical models are guided by the principle of maximum entropy, which states that the probability distribution
that best represents our knowledge of some system is that with the largest entropy (in the sense of information theory).
Let us consider a random ﬁeld X and x one of its realizations. We want to approximate the distribution of X based
on this single realization x. In practice, we make some statistical measurements on x that deﬁne a vector of statistics
φ(x). We believe φ(x) to be suﬃciently “exhaustive” to describe the statistical properties of X.15 Typically, the
realization x lives in Rm, while φ(x) lives in Rn with n < m. We introduce microcanonical sets as ensembles of vectors
of Rm whose statistics are “suﬃciently close” to those of x. Formally, for a given (cid:15) > 0, we deﬁne the microcanonical
set Ω(cid:15) as:

Ω(cid:15) =

y

{

∈

Rm/

φ(y)
(cid:107)

φ(x)

(cid:107) ≤

(cid:15)

,
}

−

(A1)

where

is the Euclidean norm on the statistical space Rn.

(cid:107)·(cid:107)

In this context, a maximum entropy microcanonical model deﬁned on Ω(cid:15) is a probability distribution µ(cid:15) supported
in Ω(cid:15) with maximal entropy. The entropy of a probability distribution µ here refers to its diﬀerential entropy, called
H(µ) and deﬁned as:

(cid:90)

where fµ is the probability density function (PDF) associated with µ. Assuming that the function φ allows Ω(cid:15) to be
compact, this maximum entropy distribution µ(cid:15) is simply the uniform distribution on Ω(cid:15) and is deﬁned by its uniform
density:

H(µ) =

−

fµ(y) log fµ(y)dy,

(A2)

fµ(cid:15)(y) =

1Ω(cid:15) (y)
(cid:82)
dy

Ω(cid:15)

.

(A3)

The relevance of this kind of models directly depends on our choice of statistical measurements, represented by the
function φ, as well as on the value of (cid:15) which is a proxy of the volume of the microcanonical set Ω(cid:15).
Ideally, we
want to choose φ and (cid:15) so that typical samples of X are contained in Ω(cid:15), and conversely, typical samples of µ(cid:15) are
representative of those of X.

Even if we manage to deﬁne relevant φ and (cid:15) so that the corresponding maximum entropy microcanonical model
correctly approximates the distribution of X on paper, we still need to ﬁnd an eﬃcient way to draw samples from µ(cid:15).
Usual strategies make use of Markov chain Monte Carlo algorithms, however these algorithms reach computational
limits when the dimension of the samples m increases.16 For the applications of this paper, these are not an option.
Microcanonical gradient descent models as deﬁned in Sect. 3.1 allow to circumvent this sampling problem, although
these are no longer of maximum entropy in general.

B. ADDITIONAL DETAILS ON THE WPH STATISTICS

B.1. Filters

Bump-steerable mother wavelet —The mother bump-steerable wavelet is deﬁned in Fourier space as follows:

(cid:18)

ˆψ(k) = exp

(k

−
k2
0 −

−
(k

−

k0)2

(cid:19)

k0)2

·

1[0,2k0](k)

×

cosL

1(arg(k))

−

1[0,π/2](
|

arg(k)
),
|

·

(B4)

k
(cid:107)

with k =
wavenumber of the mother wavelet. In this paper, we work with 512
example wavelet from the resulting bank in both physical and Fourier space.

, 1A(x) the indicator function that returns 1 if x
(cid:107)

×

∈

A and 0 otherwise, and k0 = 0.85π the central
512 maps and L = 4. We show in Fig. 8 one

15 For the statistics of a realization x to be representative of the
statistics of X, we need to make an additional assumption of
ergodicity (see Bruna & Mallat (2019)).

16 In general, Markov chain mixing time depends on the exponential

of m (Levin & Peres 2017).

20

R´egaldo-Saint Blancard et al.

Figure 8. Bump-steerable wavelet ψ2,π/4 shown in physical space (real part on the left and imaginary part in the middle) and
Fourier space (right).

Gaussian ﬁlter —The Gaussian ﬁlters used in this paper are dilated versions of a Gaussian function ϕ, which is deﬁned
in Fourier space by the following:

,

(B5)

−
0.55k0 (following Zhang & Mallat (2021)).

ˆϕ(k) = exp

with σ = 0.496

2−

×

(cid:18)

(cid:19)

2
k
||
||
2σ2

B.2. Properties of the WPH moments

The auto-WPH moments are able to capture interactions between diﬀerent scales of X thanks to the phase harmonic
operator. Indeed, the covariance between X
ψλ(cid:48) vanishes when the wavelets ψλ and ψλ(cid:48) have nonintersecting
bandpasses, and it is otherwise a function of the power spectrum of X and of the bandpasses of the wavelets (Zhang
& Mallat 2021; Allys et al. 2020). This is a consequence of the following relation:

ψλ and X

∗

∗

(cid:90)

Cλ,1,λ,1(τ ) =

SX (k) ˆψλ(k) ˆψ∗λ(k)e−

ik

τ dk,

·

(B6)

with SX the power spectrum of X (for a proof, see Zhang & Mallat 2021). With proper p and p(cid:48) values, the phase
comparable in the sense that they share common spatial
harmonic operator can make [X
frequencies, allowing an extraction of high-order information through their covariance. Conveniently, this operator is
[z]p
a Lipschitz continuous operator with for all z, z(cid:48)
(Mallat et al. 2019). This
|
prevents uncontrolled ampliﬁcations, and leads to estimators with reduced variance compared to equivalent moments
where the phase harmonic operator would be replaced by a standard exponentiation (Zhang & Mallat 2021).

ψλ]p and [X

ψλ(cid:48)]p(cid:48)

, 1)
|

max(

[z(cid:48)]p

C2,

p
|

| ≤

z
|

z(cid:48)

−

−

∈

∗

∗

|

To illustrate the importance of the phase harmonic operator to measure phase alignment between scales, we show
in Fig. 9 how the amplitude and phase maps of x
ψλ(cid:48) compare for two diﬀerent oriented scales λ and
ψλ and x
λ(cid:48), with x the I300 map built in Sect. 2.3. We choose λ = (3, 0) and λ(cid:48) = (4, 0), so that ψλ and ψλ(cid:48) probe similar
orientations but diﬀerent scales, with ψλ(cid:48) probing scales that are twice larger than those probed by ψλ. The amplitude
maps show local variations of the signal x ﬁltered at diﬀerent scales, with naturally coarser variations in
than
. The phase maps present almost periodic oscillations tending to be vertically aligned. However these maps
in
are incoherent in the sense that the average frequency of oscillation of the phase map arg(x
ψλ) is approximately
ψλ(cid:48)) into a phase map (bottom
twice that of arg(x
∗
right map) that is much more coherent with arg(x
ψλ). Consequently, the sample covariance of these maps does not
∗
vanish and quantiﬁes the phase alignment between x

ψλ(cid:48)). The phase harmonic operator with k = 2 transforms arg(x

ψλ and x

ψλ(cid:48).

x
|

ψλ(cid:48)

ψλ

x

∗

∗

∗

∗

∗

∗

|

|

|

∗

∗

B.3. Subset of auto-WPH moments

Allys et al. (2020) identiﬁed a relevant set of auto-WPH moments to build models of simulated data of the large-
scale structure of the Universe. In the present work, we deﬁne WPH statistics that are directly inspired by this work,
although they are made slightly more optimal by taking out coeﬃcients that were redundant. We will consider in the
following ﬁve categories of moments deﬁned as follows:

• the S(1,1) moments, of the form Cλ,1,λ,1(τ ) = Cov (X

ψλ(r), X

ψλ(r + τ )), at every τn,α. They measure

weighted averages of the power spectrum over the bandpass of ψλ (see Eq. (B6)).

∗

∗

−20−1001020−20−1001020Re(ψ2,π/4)−20−1001020−20−1001020Im(ψ2,π/4)−2000200−200−1000100200ˆψ2,π/4−0.010−0.0050.0000.0050.010−0.010−0.0050.0000.0050.0100.00.10.20.30.40.50.6Generative Models of Multi-channel Dust Emission Maps

21

Figure 9. Comparison between the amplitude and phase maps of x ∗ ψj,θ where x is the map shown on the left and two diﬀerent
wavelets ψ3,0 and ψ4,0. The action of the phase harmonic operator is shown on the phase map of x ∗ ψ4,0. Figure inspired
by Allys et al. (2020).

• the S(0,0) moments, of the form Cλ,0,λ,0(τ ) = Cov (

∗
information related to the sparsity of the data in the bandpass of ψλ.

∗

|

ψλ(r)
,
|

X
|

X

), at every τn,α. They capture
ψλ(r + τ )
|

• the S(0,1) moments, of the form Cλ,0,λ,1(τ ) = Cov (

X

ψλ(r + τ )), at τ = 0 only. They capture

ψλ(r)
|

∗

, X

∗

|

information related to the couplings between the scales included in the same bandpass.

• the C (0,1) moments, of the form Cλ,0,λ(cid:48),1(τ ) = Cov (

X
|
at every τn,α when θ = θ(cid:48) and at τ = 0 only when θ
between local levels of oscillation for the scales in the bandpasses associated with ψλ and ψλ(cid:48).

1,
∗
= θ(cid:48). They capture information related to the correlation

ψλ(cid:48)(r + τ )), considering 0

ψλ(r)
|

j < j(cid:48)

, X

≤

≤

−

J

∗

• the C phase moments, of the form Cλ,1,λ(cid:48),p(cid:48)(τ ) = Cov

sidering 0
alignment of oscillations between the scales in the bandpasses associated with ψλ and ψλ(cid:48).

j < j(cid:48)

≤

≤

−

J

j > 1, con-
1 and θ = θ(cid:48), at every τn,α. They capture information related to the statistical phase

ψλ(r), [X

with p(cid:48) = 2j(cid:48)

X

∗

∗

−

ψλ(cid:48)(r + τ )]p(cid:48)(cid:17)

(cid:16)

Symmetries in the subset of moments —We identify in the following symmetries with respect to the angular variables
that will allow us to deﬁne optimal ranges for the angular variables, avoiding redundancy in the statistical content of
the WPH statistics. We denote, e.g., by S(1,1)(j, θ, n, α) the moment Cλ,1,λ,1(τn,α) with λ = (j, θ), and use similar
notations for the other categories of moments.

For a real-valued statistically homogeneous random ﬁeld X, and for a choice of wavelets satisfying the symmetry
R for all k, which is the case of bump-steerable wavelets), we identify the following

ψj,θ+π = ψj,θ (valid when ˆψ(k)
list of symmetries:

∈

S(1,1)(j, θ + π, n, α) = S(1,1)(j, θ, n, α),
S(1,1)(j, θ, n, α + π) = S(1,1)(j, θ, n, α),
S(0,0)(j, θ + π, n, α) = S(0,0)(j, θ, n, α),
S(0,0)(j, θ, n, α + π) = S(0,0)(j, θ, n, α),
S(0,1)(j, θ + π) = S(0,1)(j, θ),
C (0,1)(j1, θ1 + π, j2, θ2, n, α) = C (0,1)(j1, θ1, j2, θ2, n, α),
C (0,1)(j1, θ1, j2, θ2 + π, n, α) = C (0,1)(j1, θ1, j2, θ2, n, α),
C phase(j1, θ + π, j2, θ + π, n, α) = C phase(j1, θ, j2, θ, n, α).

(B7)

(B8)

(B9)

(B10)

(B11)

(B12)

(B13)

(B14)

AmplitudePhase(cid:54)
22

R´egaldo-Saint Blancard et al.

S(1,1) S(0,0) S(0,1) S(1,0) C (0,1) C (1,0) C phase C phase,inv L Total Ratio (%)

auto

544

544

cross

32

32

32

32

N/A

4032

N/A

1776

N/A

32

448

448

112

112

12

16

6940

∼ 2.6

1264

∼ 0.24

Table 2. Number of statistical coeﬃcients per class of moments for the parameters used in this work. The last column gives
the ratio of the total number of coeﬃcients to the number of pixels in one (or two, for the cross case) 512 × 512 image(s).

these
ψj,θ+π]p = [X

Proofs of
[X
plex conjugation with the phase harmonic and convolution operations.

relations
ψj,θ]p for any p

essentially stem from the

that Cov (X, Y ) = Cov (Y, X) and that
R. The latter relation is a consequence of the commutativity of the com-

facts

∈

∗

∗

Coeﬃcients that are either equal or related by a complex conjugation operation are said to be redundant. The
[0, π). Moreover,
previous relations show that, in order to avoid redundancy, it is suﬃcient to consider wavelets with θ
to avoid further redundancy, for the S(1,1) and S(0,0) moments, it is suﬃcient to consider τn,α vectors with α
[0, π)
only. We show in Table 2 the resulting number of auto coeﬃcients per class of moments for the parameters used in
this work.

∈

∈

Just like before, we focus on a speciﬁc subset of cross-WPH moments. We make sure that this subset is non-
redundant and pseudo-symmetric under the exchange of X and Y (modulo complex conjugation). These moments are
the following:

B.4. Subset of cross-WPH moments

• the S(1,1)

moments, of the form C ×λ,1,λ,1(τ ) = Cov [X

∗
averages of the cross spectrum over the bandpass of ψλ.

×

ψλ(r), Y

ψλ(r + τ )]. Note that they measure weighted

∗

• the S(0,0)

×

• the S(0,1)

×

• the S(1,0)

×

• the C (0,1)

×

• the C (1,0)

×

moments, of the form C ×λ,0,λ,0(τ ) = Cov [

X
|

ψλ(r)
|

,

|

Y

∗

ψλ(r + τ )
|

].

∗

moments, of the form C ×λ,0,λ,1(τ ) = Cov [

X
|

ψλ(r)
|

∗

, Y

∗

ψλ(r + τ )].

moments, of the form C ×λ,1,λ,0(τ ) = Cov [X

ψλ(r),

Y
|

∗

∗

ψλ(r + τ )

].
|

moments, of the form C ×λ,0,λ(cid:48),1(τ ) = Cov [

X
|

ψλ(r)
|

∗

, Y

∗

ψλ(cid:48)(r + τ )], considering 0

moments, of the form C ×λ,0,λ(cid:48),1(τ ) = Cov [X

ψλ(r),

Y
|

∗

∗

ψλ(cid:48)(r + τ )

], considering 0
|
ψλ(cid:48)(r + τ )]p(cid:48)(cid:105)

with p(cid:48) = 2j(cid:48)

(cid:104)
X

∗

ψλ(r), [Y

∗

• the C phase
×
ering 0

moments, of the form C ×λ,1,λ(cid:48),p(cid:48)(τ ) = Cov
j < j(cid:48)

1 and θ = θ(cid:48).

J

≤

−

• the C inv,phase
×
ering 0

j(cid:48) < j

≤

≤

J

≤

−

1 and θ = θ(cid:48).

moments, of the form C ×λ,p,λ(cid:48),1(τ ) = Cov [[X

ψλ(r)]p , Y

∗

∗

ψλ(cid:48)(r + τ )] with p = 2j

j(cid:48)

−

> 1, consid-

j < j(cid:48)

j(cid:48) < j

J

J

1.

1.

−

−

≤

≤

≤

≤

j > 1, consid-

−

Moreover, for this work, inspired by Brochard et al. (2022), we only consider cross-WPH moments with τ = 0. We
show in Table 2 the resulting number of cross coeﬃcients per class of moments for the parameters used in this work.

B.5. Normalized estimates

In practice, our statistical coeﬃcients are all normalized similarly to Zhang & Mallat (2021) and Allys et al. (2020).
This normalization has been shown to speed up the minimization involved during the sampling process of microcanon-
ical gradient descent models (Zhang & Mallat 2021).

The normalization of the auto-WPH and scaling coeﬃcients depends on the target map x0 involved in this mini-
mization. Denoting by ˜Cλ,p,λ(cid:48),p(cid:48)(τ ) and ˜Lj,p,p(cid:48) the normalized estimates of Cλ,p,λ(cid:48),p(cid:48)(τ ) and Lj,p,p(cid:48), respectively, we

23

(B15)

(B16)

Generative Models of Multi-channel Dust Emission Maps

choose:

˜Cλ,p,λ(cid:48),p(cid:48)(τ ) =

˜Lj,p,p(cid:48) =

,

(cid:10)x(λ,p) (r) x(λ(cid:48),p(cid:48)) (r + τ ) (cid:11)
(cid:113)(cid:10)
2(cid:11)(cid:10)
2(cid:11)
x(λ(cid:48),p(cid:48))
x(λ,p)
0
0
|
|
|
x(j,p)x(j,p(cid:48))
(cid:104)
x(j,p)
0
(cid:104)|

(cid:105)
x(j,p(cid:48))
0

(cid:113)

(cid:105)

2

,

|

2
|
ψξ]p

(cid:105)(cid:104)|
where the brackets stand for a spatial mean on r, and x(ξ,p) = [x
x(ξ,p) depends on x0.

|

∗

(cid:10)[x0 ∗

−

ψξ)]p(cid:11). Note that this deﬁnition of

For cross coeﬃcients, we deﬁne similarly:

˜C ×λ,p,λ(cid:48),p(cid:48)(τ ) =

˜L×j,p,p(cid:48) =

(cid:10)x(λ,p) (r) y(λ(cid:48),p(cid:48)) (r + τ ) (cid:11)
(cid:113)(cid:10)
2(cid:11)
2(cid:11)(cid:10)
y(λ(cid:48),p(cid:48))
x(λ,p)
0
0
|
|
|
x(j,p)y(j,p(cid:48))
(cid:104)
x(j,p)
0
(cid:104)|

(cid:105)
y(j,p(cid:48))
0

2
|

(cid:105)(cid:104)|

(cid:113)

(cid:105)

2

|

|

.

,

(B17)

(B18)

The Gaussian model of the data x = (log(I300), E300, B300), which is used as a baseline in Sect. 4.1, is deﬁned as

follows. It is a microcanonical model conditioned by:

C. GAUSSIAN MODEL

φG(x) = φG

auto(log(I300))

φG

auto(E300)

φG

auto(B300)

φG

cross(log(I300), E300)

φG

cross(log(I300), B300)),

⊕
⊕
) only include normalized estimates of the S(1,1) and S(1,1)
where φG
moments as introduced in
Sect. B.3 and B.4, respectively. Such microcanonical models are rigorously Gaussian (Bruna & Mallat 2019). We show
in Fig. 10 three diﬀerent samples of this model (from second to last row) next to the original data x (ﬁrst row).

) and φG

cross(
·

auto(
·

⊕

⊕

×

,

·

(C19)

24

R´egaldo-Saint Blancard et al.

Figure 10. Same as Fig. 2 but for the Gaussian model.

−20−1001020y[pc]log10(I300)E300B300−20−1001020y[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020y[pc]−20−1001020x[pc]−20−1001020x[pc]