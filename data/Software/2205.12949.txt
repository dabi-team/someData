Draft version May 26, 2022
Typeset using LATEX default style in AASTeX63

High-Precision Redshifts for Type Ia Supernovae with the Nancy Grace Roman Space Telescope
P127 Prism
Bhavin A. Joshi,1, ∗ Louis-Gregory Strolger,1, 2 Russell E. Ryan, Jr.,2 Alexei V. Filippenko,3
Rebekah Hounsell,4, 5 Patrick L. Kelly,6 Richard Kessler,7 Phillip Macias,8 Benjamin Rose,9 and
Daniel Scolnic9

1Department of Physics and Astronomy, Johns Hopkins University, Baltimore, MD 21218, USA
2Space Telescope Science Institute, 3700 San Martin Drive, Baltimore, MD 21218, USA
3Department of Astronomy, University of California, Berkeley, CA 94720-3411, USA
4University of Maryland, Baltimore County, Baltimore, MD 21250, USA
5NASA Goddard Space Flight Center, Greenbelt, MD 20771, USA
6School of Physics and Astronomy, University of Minnesota, Minneapolis, MN 55455, USA
7Kavli Institute for Cosmological Physics, University of Chicago, Chicago, IL 60637, USA
8Department of Astronomy and Astrophysics, University of California, Santa Cruz, CA 95064, USA
9Department of Physics, Duke University, 120 Science Drive, Durham, NC, 27708, USA

(Received 2022; Accepted)

ABSTRACT
We present results from simulating slitless spectroscopic observations with the Nancy Grace Roman
Space Telescope’s (Roman) Wide-Field Instrument (WFI) P127 prism spanning 0.75 µm to 1.8 µm.
We quantify the eﬃciency of recovered Type Ia supernovae (SNe Ia) redshifts, as a function of P127
prism exposure time, to guide planning for future observing programs with the Roman prism. Gener-
ating the two-dimensional dispersed images and extracting one-dimensional spectra is done with the
slitless spectroscopy package pyLINEAR along with custom-written software. From the analysis of 1698
simulated SN Ia P127 prism spectra, we show the eﬃciency of recovering SN redshifts to z (cid:46) 3.0,
highlighting the exceptional sensitivity of the Roman P127 prism. Redshift recovery is assessed by
0.01. We ﬁnd that 3 hr exposures are suﬃcient
setting a requirement of σz = (
ztrue|
z
|
for meeting this requirement, for (cid:38) 50% of the sample of mock SNe Ia at z
5 days of
rest-frame maximum light in the optical. We also show that a 1 hr integration of Roman can achieve
0.06 AB mag (or z (cid:46) 1). Implications for
the same precision in completeness to a depth of 24.4
cosmological studies with Roman P127 prism spectra of SNe Ia are also discussed.

2 and within

)/(1 + z)

±

≤

≈

±

−

1. INTRODUCTION

The Nancy Grace Roman Space Telescope (Roman) will, through its core community High Latitude Time Domain
Survey (HLTDS), observe on the order of 104 Type Ia supernovae (SNe Ia; e.g., Hounsell et al. 2018; Akeson et al.
2019). Most of these SNe will be within redshifts 0.5 < z < 2, and are required to be observed with suﬃcient depth
per epoch to enable accurate measurements of dark energy properties that signiﬁcantly improve the dark energy ﬁgure
of merit (FoM; Spergel et al. 2015; Hounsell et al. 2018). To accomplish these goals, the two Supernova Science
Investigation Teams (SITs) have provided a jointly recommended reference survey in Rose et al. (2021).

2
2
0
2

y
a
M
5
2

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
9
4
9
2
1
.
5
0
2
2
:
v
i
X
r
a

An important assumption in Rose et al. (2021) is that the redshifts for all SNe Ia (or host galaxies) are well measured,
i.e., on the order of a tenth of a percent, and it is assumed that Roman spectroscopic elements will be used as a part
of the Roman HTLDS strategy to obtain those redshifts. The Roman Wide-Field Instrument (WFI), with a ﬁeld-
of-view of 0.281 deg2, is expected to have two slitless-spectroscopy spectral elements: a low-resolution prism (P127;
435–865; 1.0 (cid:46) λ [µm] (cid:46) 1.93).1
R

70–170; 0.75 (cid:46) λ [µm] (cid:46) 1.8) and a slightly higher-resolution grism (G150; R

≈

≈

bjoshi5@jhu.edu

∗ Corresponding Author

1 https://roman.gsfc.nasa.gov/science/WFI technical.html provides more complete details on the current Roman WFI design.

 
 
 
 
 
 
2

Joshi et al.

Compared to the grism, the Roman prism, while lower resolution, is
for a 1 hr exposure making it better suited for analysis of fainter SNe with broad absorption features (Table 1).

3 mag more sensitive than the Roman grism

∼

As part of the SIT eﬀort, the primary objective of this work is to evaluate the utility of the prism spectra, particularly
the inﬂuence of the exposure time on the signal-to-noise ratio (S/N) and redshift accuracy. These results are needed
to optimize the spectroscopic component of the HLTDS and future observations with the Roman prism. Current
estimates for the HLTDS design involve some (as yet undecided) combination of prism-to-imaging time, along with
coaddition of spectra taken from multiple visits, as well as time series analysis (Saunders et al. 2018). Based on
estimates of current Roman WFI/P127 capabilities, we provide here a base platform from which future considerations
of prism exposures for the HLTDS can continue, while also giving a broader context for other programs that involve
the Roman prism. We analyze the redshift recovery for a single long-exposure visit (which can still include multiple
position angles) where all data for a given SN Ia are taken such that spectral or luminosity variations can be neglected
(over the timescale of the visit).

With simulated broadband ﬁlter images of a single Roman HLTDS pointing (hereafter referred to as direct images) in
the WFI/F106 ﬁlter as input (Wang et al. 2022), our approach involves simulating two-dimensional (2D) spectroscopic
images (dispersed images) through the Roman prism, and analyzing the extracted one-dimensional (1D) spectra, as
will be done for real Roman data. This paper focuses primarily on the recovery of SN Ia redshifts, although our
ﬁtting pipeline also attempts to constrain SN Ia phase (relative to peak) and dust extinction along the line of sight.
The simulation products and the associated codes will be publicly available at the IPAC-hosted simulations page2 and
GitHub3, respectively. Future papers will focus on recovery of (a) other SN Ia properties (e.g., Si II velocities) while also
including coadded shorter exposures from multiple visits at diﬀerent phases such that the SN brightness and spectral
evolution are measured, (b) deblending of SN Ia and host galaxy spectra, and (c) (host-)galaxy stellar-population
parameters from their prism spectra.

This work is structured as follows: § 2 goes into details of the simulation and analysis methods, § 2.1 discusses the
models used for SNe Ia, galaxies, and stars; § 2.2 describes how host galaxy light and SN light are blended for SNe that
overlap with their host galaxy in our simulation; § 2.3 and § 3.1 provide an overview of the pyLINEAR package used
to simulate the 2D dispersed images and extract the 1D spectra; and § 3.2 describes the ﬁtting process applied to the
extracted 1D spectra. Finally, § 4 discusses the results obtained from our ﬁtting pipeline, particularly with regards to
the eﬃciency of recovering redshifts. The cosmological model assumed in this paper is ﬂat with ΩM = 1
ΩΛ = 0.3
and H0 = 70 km s−

1, and all magnitudes are in the AB system (Oke & Gunn 1983).

1 Mpc−

−

2. SIMULATION AND ANALYSIS METHODS

Redshifts and distance moduli are the two independently-measured quantities for SNe Ia that allow astronomers to
constrain cosmological models. Our goal here is to analyze the accuracy of redshifts recovered from simulated 1D P127
spectra of SNe Ia, while keeping the simulation as realistic as possible. A schematic of the simulation pipeline, as well
as the inputs and products, is shown in Figure 1.

Our process consists of the following steps which includes an end-to-end simulation (steps i and ii) and analysis of

the simulation products (steps iii and iv):

(i) insert SNe as point sources into simulated direct images and assign SNe and (host-)galaxies spectra (§ 2.1 and

§ 2.2),

(ii) generate dispersed images at required roll angles and exposure times for the Roman WFI/P127 prism, (§ 2.3)

(iii) extract 1D slitless spectra of all detected sources (§ 3.1), and

(iv) recovery of SNe Ia and galaxy stellar population parameters through a Markov Chain Monte Carlo (MCMC;

§ 3.2) ﬁtting of the “observed” slitless spectroscopy.

The simulation is based on one pointing, of all 18 WFI detectors, generated at three roll angles with total exposure
times of 1200, 3600, and 10,800 s. The roll angles we use are 0◦, 70◦, and 140◦, measured east of north. The exposure
times are built up by adding repeated observations assuming that the longest individual exposure is limited to 900

2 https://roman.ipac.caltech.edu/sims/Simulations csv.html
3 https://github.com/bajoshi/roman-slitless

Roman Prism Simulations of SNe Ia

3

Figure 1. Schematic representation of the steps in our simulation pipeline. A short description of the details in each step is
also given. Each box also provides, if applicable, a section/table number where it is described in detail in the text.

Figure 2. Estimate of the sensitivity of Roman P127 prism, along with the HST Wide Field Camera 3 IR grisms G102 and
G141, in the +1 order.

seconds. Given that detector-speciﬁc details are not yet known for Roman, our code runs the simulation on a single
detector and repeats the simulation 18 times with a diﬀerent scene on the sky each time (where “scene” is deﬁned
by the shapes, sizes, locations, and brightness for all objects within the ﬁeld-of-view). We also limit the number of
100 (i.e., < 5% of total sources which are typically
randomly-inserted SNe into each detector to a range of 90

≤
2000), so as to not artiﬁcially introduce excessive spectral overlap. In total, our simulation contains 1698 SNe Ia.

N

≤

∼

Simulateddirect images and truth catalogsInsert SNe Assign galaxy, SNe, and stellar spectraSimulate 2D dispersed images at required roll anglesAdd noise componentsExtract 1D spectraFit 1D spectra for redshift, phase, and AvAnalyze redshift recoveryFrom Wang et al. (2022). Assigns a magnitude distribution for the SNe and locations close to host galaxies. Scales stellar reference image for correct counts.Prepare for pyLINEAR –LST (list) files SED: Spectrum for each segmentation ID. WCS: Central coordinates and roll angles. OBS: Direct images and bandpasses.Outputs:•2D simulated FLT images (noiseless and noised dependent on exposure times).•1D spectra.Galaxy spectra from BC03.SNe spectra from SALT2.Stellar spectra from Pickles library. Ensures host and SN get identical redshift.Source 1D template spectrum is scaled to be consistent with source magnitude. Determines pixel dispersion tables (PDTs) and disperses each pixel for each source separately. Generates noiseless 2D dispersed FLT images.Includes: zodiacal and thermal backgrounds, dark current, and read noise. Pipeline capable of including additional detector non-linearities, distortion, and IR specific effects. All included noise components can be different for each SCA.Bayesian inference pipeline to sample 3D SN spectra parameter space. To analyze completeness of recovering accurate redshifts as a function of SN magnitude.§3Table 1§2.4§2.3§2.3§2§2.1 and §2.2External inputsSimulationAnalysis80001000012000140001600018000Wavelength[˚A]1015101610171018Sensitivity[(e−/s)/(ergs−1cm−2˚A−1)]HSTWFC3/G102,+1orderHSTWFC3/G141,+1orderRomanprism4

Joshi et al.

Table 1. Comparison of HST and Roman slitless elements

Optics/Detector characteristic

HST WFC3/IR grisms

Roman WFI

Dark current [e−/pix/s]
Read noise [e− rms]
Zodiacal background [e−/pix/s] a
Thermal background [e−/pix/s]
1 hr limiting magb
Resolution [∆λ/λ]
Wavelength coverage [nm]

G102

0.05
12
∼
0.48
0.02

G141

0.05
12
∼
1.04
0.02

P127

G150

0.0015

0.0015

8
∼
1.047
0.064

8
∼
1.047
0.064

22.6
210

∼

22.9
130

∼

23.5
70–170
750–1800

20.5
435–865
1000–1930

1075–1700

800–1150
aThe zodiacal light estimates for the HST grisms vary primarily with Sun angle and time
of year (Pirzkal & Ryan 2020). We therefore use median values for the distribution
of zodiacal light levels for the HST grisms. Assumes a 1.1
factor for zodiacal light
for Roman (private communication, Jeﬀrey Kruk) which is expected to depend on
Galactic latitude.
b For the HST grisms, limiting magnitude is deﬁned as 5σ per continuum pixel in the
J and H bands for G102 and G141, respectively (Kuntschner et al. 2010). For the
Roman prism and grism, limiting magnitude is deﬁned as 10σ per 2 pixel resolution
element in the continuum, at 1.2 µm, for a point source.

×

Note—A comparison of relevant properties of the HST WFC3 IR grisms and
the Roman prism and grism, some of which factor into the increased sensitivity
of the Roman prism. See https://roman.gsfc.nasa.gov/science/WFI technical.html
and https://wﬁrst.ipac.caltech.edu/sims/Param db.html, for details on WFI detector
performance. See https://www.stsci.edu/hst/instrumentation/wfc3/documentation/
grism-resources for details on the HST WFC3 grisms. Since the grisms have multiple
orders, relevant quantities are quoted here for the +1 order.

Simulating the photoelectron count rate for a given source observed through the Roman prism requires use of the
sensitivity curve (Figure 2) along with (i) the counts for each pixel associated with the source in the direct image, (ii)
a description of the spectral trace for the Roman prism, (iii) a spectrum associated with each source pixel, and (iv) the
noise characteristics of the instrumentation (see noise budget components in Table 1). The spectral trace is deﬁned
as the location of the centroid of the spectrum along the spatial direction (see e.g., K¨ummel et al. 2009; Pirzkal et al.
2016). Table 1 shows a comparison of properties between the Hubble Space Telescope (HST) Wide Field Camera 3
(WFC3) infrared (IR) grisms and the Roman prism and grism. Table 1 also shows the noise terms included in our
simulation. However, it does not include IR detector-speciﬁc eﬀects, such as ﬂux-dependent sensitivity and interpixel
capacitance, which we expect to have a smaller eﬀect on the prism spectra compared to the terms already included.
This table also shows that the primary reason for preferring the Roman prism over the grism for observing SNe Ia
is the
3 mag deeper sensitivity of the prism, which is particularly helpful for estimating redshifts to fainter SNe Ia
given the broad absorption features typical of SN Ia spectra. Another signiﬁcant reason for the increased sensitivity
of the Roman prism is the lack of dispersion orders. Since the grisms disperse light into multiple orders and the prism
disperses light into a single order, the grisms lose a signiﬁcant fraction of the available light; typically only the +1
order spectrum from a grism is analyzed given that gratings are blazed to maximize throughput to the +1 order.

∼

Figure 2 shows a comparison between the sensitivities of the Roman prism and HST WFC3 IR grisms G102 and
G141. According to current best estimates of sensitivity, the Roman prism is a factor of (cid:38) 20 more sensitive than
HST/WFC3 IR grisms at all wavelengths covered by the HST grisms. The prism’s performance is expected to result
in 10σ per pixel in a 1 hr exposure of a point source with mF 106 = 23.5 mag AB4 (although we recover
6σ per pixel
from analyzing our simulations).

∼

4 https://roman.gsfc.nasa.gov/instruments and capabilities.html

Roman Prism Simulations of SNe Ia

5

2.1. Stellar Population and SALT2 Models

Prior to dispersing the simulated direct images we assign each source in the direct images a model spectrum. Brieﬂy,
the simulated direct images contain stars and galaxies and while they also contain SNe Ia, the rates employed result
in too few SNe for our analysis (for more details we refer the reader to Wang et al. 2022 and references therein).

≤

≤

mF 106 [AB mag]

Therefore, we begin by overlaying additional SNe into the direct images as point sources. Typical SNe Ia simulations
begin by selecting a random redshift from a rate model, and then computing SN Ia model magnitudes at each phase.
To simulate an appropriate magnitude range, we simulate with a diﬀerent approach in which random magnitudes are
chosen in the range 22.4
28.7, and the corresponding redshift is determined for each magnitude
(corresponding to SNe Ia approximately within 0.5 (cid:46) z (cid:46) 3.0). We overlay the SNe into the direct images with a
synthetic apparent magnitude chosen ﬁrst instead of choosing a redshift ﬁrst and then letting the apparent magnitude
be decided by the cosmology, SN Ia phase, and line of sight dust attenuation. This approach is motivated by the need
to acquire a large enough sample of fainter SNe, because we expect the accuracy of inferred redshifts to deteriorate
for fainter SNe, while still completing the simulations within a realistic time-frame, owing to the computationally
expensive nature of the simulations. Choosing the apparent magnitude ﬁrst allows us to have a well-known magnitude
distribution for the overlaid SNe Ia. For the SN Ia model template, we employ an extension of the SALT2 SN Ia model
that extends into the near-IR (Guy et al. 2007; Pierel et al. 2018). This model provides rest-frame SN Ia spectra from
1700 ˚A to 2.5 µm, and with phases
19 days to +50 days relative to optical peak.
The probability distribution function (PDF) for the magnitude distribution follows a power law (P (x, a) = axa
−
with a = 1.2), ensuring a distribution of SN magnitudes that allows for a slightly larger number of fainter SNe for
analysis. To obtain a statistically signiﬁcant sample of SNe Ia for analysis we insert a relatively large number of SNe
95 SNe per detector). While this rate model is not consistent with
into each detector (as previously mentioned
the number density of SNe that will be observed in a single visit, our decision is again driven by the need to obtain
a large number of SN prism spectra for analysis. Each SN is assigned a spectrum with a randomly chosen phase
5 days from peak. Next, we apply dust extinction AV following the Calzetti et al. (2000) law, chosen from
within
λx
3.0 mag, with an exponentially declining PDF weighted in favor of lower AV values (P (x, λ) = λ e−
0.0
with λ = 2), in order to simulate realistic dust extinction from local environments of SNe, following Jha et al. (1999)
and Holwerda et al. (2015). Finally, we apply cosmological redshift to the inserted SN spectrum by redshifting the
wavelength grid and scaling the spectrum ﬂux so that the synthetic magnitude matches the already assigned SN
magnitude.

±
AV

∼

≤

≤

−

1

t/τ )) for the star-formation history, along with a stellar mass of 9.0

For (host-) galaxies we use the Bruzual & Charlot (2003) GALAXEV library of stellar-population models.
Each galaxy is assigned a composite stellar population with a delayed-τ star-formation-rate (SFR) model (SFR
t exp(
12.0, a redshift
∝
of 0 < z
3.0 (if it is an SN host galaxy, then the SN and host are assigned the same redshift), and ﬁnally a dust
extinction with AV randomly chosen from 0.0
5.0 mag. For Galactic stellar point sources in the images we
assign spectra from the Pickles stellar library, that provide stellar spectra from 1150 ˚A to 25,000 ˚A (Pickles 1998). The
Pickles library provides 131 ﬂux-calibrated stellar templates for stellar types within the range O5–M2, with the stellar
type being chosen randomly in our simulations.

log(Ms [M

−
≤

AV

≤

≤

≤

≤

])

(cid:12)

2.2. Blending of host galaxy and Supernova Light

A signiﬁcant advantage of slitless spectroscopy is the ability to obtain a spectrum for all objects within the ﬁeld-
of-view (FoV). This also introduces signiﬁcant data-reduction challenges, particularly with disentangling spectra from
objects that are very close to each other and/or lie along the dispersion direction such that their spectra overlap. In
traditional slitless spectroscopy parlance, the term contamination usually refers to the unwanted overlap of one or more
spectra on the spectrum of the object of interest. Generally this eﬀect can be mitigated by taking data at multiple roll
angles so that there is at least one roll angle within which the spectrum of interest contains little to no contamination.
In the speciﬁc case of slitless spectroscopic observations of an SN Ia and its host galaxy, an additional concern is
the blending of light from the host galaxy and the SN — that is, within pixels that overlap between the SN and
its host galaxy, the total ﬂux (and therefore the spectrum from that pixel) is a combination of host and SN. This
introduces a minimum ﬂoor of contamination (referred to as blending below to distinguish from the traditional notion
of contamination) that will be present in all observations of the SN Ia regardless of the roll angle. This situation is
analogous to that of taking slitless spectra of a galaxy containing one or more star-forming knots — in this case, the
underlying galaxy spectrum is blended with the emission-line spectrum of the star-forming region.

6

Joshi et al.

Figure 3. Examples of SNe Ia prism spectra that are blended with host galaxy spectra. The input high-resolution template
spectra are in blue for the SN and red for the host galaxy. Extracted SN spectra are in black with gray errors. Host galaxy and
SN redshifts, as well as F106 magnitudes, are shown in the legend. From top to bottom the extent of blending increases. Panel
(a) shows an example of mild blending — SN Ia features are easily identiﬁable and host galaxy features are largely absent in the
extracted SN spectrum. Panels (b) and (c) show moderate blending — both SN Ia and host galaxy features can be identiﬁed in
the SN spectrum. Panel (d) shows extreme blending between SN and host galaxy — SN Ia features are largely absent and host
galaxy features dominate in the SN spectrum. This “classiﬁcation” of the extent of blending (as mild, moderate, or extreme) is
qualitative — we do not attempt here to quantify the extent of the blending.

80001000012000140001600018000∏[˚A]10°1910°18f∏[ergs°1cm°2˚A°1]1-hourprismspectrum;z=0.508pyLINEARx1dspecSNSNtemplateSNF106mag:23.04Host-galaxytemplateHost-galaxyF106mag:23.2780001000012000140001600018000∏[˚A]10°1910°18f∏[ergs°1cm°2˚A°1]1-hourprismspectrum;z=1.026pyLINEARx1dspecSNSNtemplateSNF106mag:24.29Host-galaxytemplateHost-galaxyF106mag:23.7480001000012000140001600018000∏[˚A]10°1910°1810°17f∏[ergs°1cm°2˚A°1]1-hourprismspectrum;z=0.731pyLINEARx1dspecSNSNtemplateSNF106mag:23.74Host-galaxytemplateHost-galaxyF106mag:20.4780001000012000140001600018000∏[˚A]10°19f∏[ergs°1cm°2˚A°1]1-hourprismspectrum;z=1.505pyLINEARx1dspecSNSNtemplateSNF106mag:24.96Host-galaxytemplateHost-galaxyF106mag:23.71(a)(b)(c)(d)Roman Prism Simulations of SNe Ia

7

In order to represent this eﬀect within our simulations, for each SN source that has an overlap between the host

galaxy and SN we carry out the following steps.
(1) For each overlapping pixel (x, y), the eﬀective spectrum from the pixel is given by

= aH f H

λ + aSN f SN
λ ,

O

(1)

where aH and aSN denote linear combination coeﬃcients, and f H
are the spectra of the host galaxy and SN,
respectively. The coeﬃcients aH and aSN are fractions of the total counts within a pixel that belong to the host galaxy
and SN, respectively. We also make the simplifying assumption (for all sources) that the input spectrum remains
constant over the spatial extent of the source.
(2) The ﬁnal spectrum of the SN containing overlap with the host is given by a weighted sum of the spectra from
overlapping pixels (i.e., blended SN and host spectra) and non-overlapping pixels (i.e., pure SN Ia spectra):

λ and f SN

λ

= Σiai

i + Σjbj

j ,

N

O

S

(2)

S

is the ﬁnal blended spectrum of the SN and (

where
denote (non-)overlapping pixels. The indices, i and j, sum
O
over SN pixels that overlap and do not overlap with the host galaxy, respectively. The weights ai and bi are computed
to ensure that the relative ﬂux contribution from each pixel toward the “eﬀective” source count, which includes both
host galaxy and SN counts, is reﬂected in the ﬁnal spectrum. This ﬁnal blended spectrum becomes the eﬀective 1D
spectral template for the SN, i.e., each pixel associated with the SN, in the segmentation map, is assigned the spectrum
. The eﬀective 1D spectral template is then passed to pyLINEAR for simulating 2D dispersed images as described in

N

)

S
§ 2.3.

Figure 3 shows examples of blended SN Ia and host galaxy spectra. Extracted spectra (the extraction process is
described in § 3.1) are eﬀectively the weighted sum (as described above) of the SN and host input templates. The
extent of blending depends on the number of pixels that overlap between the SN and host galaxy, the exposure time,
and their brightness relative to each other. Without any attempt to deblend the host galaxy spectrum from the SN
spectrum, our automated ﬁtting pipeline (described in § 3.2) fails to recover the SN redshift in each of the cases shown
here.

2.3. Simulation of 2D dispersed images

Here we provide a brief overview of the process to simulate 2D dispersed images carried out by pyLINEAR. For a

detailed explanation of the pyLINEAR algorithm, the reader is referred to Ryan et al. (2018a,b).

The driving motivations for the algorithm behind pyLINEAR are to employ dispersed data from multiple roll angles
to optimally handle spectral contamination due to overlapping spectra, and also to extract spectra with the optimal
spectral resolution without sacriﬁcing the S/N. pyLINEAR simulates 2D dispersed images by dispersing 1D high-
resolution model spectral templates for each pixel associated with each source in the direct image.
It requires a
description of the scene on the sky and a description of the spectral trace and sensitivity of the dispersing element
being considered.

We modify pyLINEAR defaults to allow the simulation of prism exposures in which the dispersion is strongly dependent
on wavelength. Brieﬂy, traditional slitless spectroscopy routines (e.g., aXe, K¨ummel et al. 2009; pyLINEAR) describe the
spectral trace with a polynomial that is parameterized by the path length along the trace. For describing the spectral
trace of the Roman prism, we build on the foundation of the generalized 2D polynomials introduced by Pirzkal & Ryan
(2017). These polynomials are a function of the x and y coordinates on the dispersed image and another parameter
t (which spans 0
1 and can generally, although not always, be identiﬁed with wavelength coverage). One of
the quantities required to be computed in simulating 2D spectra is the wavelength λ = fλ(x, y, t). For most grisms,
this is a ﬁrst-order equation in t. To allow for a variable dispersion with wavelength relation, however, we had to
change this to a second-order equation in t. This change is nontrivial because the polynomial relation must also be
inverted to solve for the coeﬃcients of t that give the known dispersion vs. wavelength relation. For readers interested
in simulating Roman prism spectra, the conﬁguration ﬁle for aXe and pyLINEAR is available from the corresponding
author. Figure 4 shows an example of simulated 2D dispersed images through the Roman prism and the extracted SN
spectrum from a SN and its host galaxy.

≤

≤

t

3. ANALYSIS OF SIMULATION PRODUCTS

8

Joshi et al.

Figure 4. Dispersed prism image cutouts and extracted spectra for an example pair of SN and its host galaxy. The set of
450 pixels) and corresponding dispersed images
panels in (a) show a portion of the direct image (for a single detector,
at our three position angles. The dispersed images also highlight the regions used by pyLINEAR to extract the SN and host
galaxy spectra. Panel (b) shows the extracted SN spectrum along with the input templates for the SN and host galaxy. The
exposure time for the 2D dispersed images and the 1D extracted spectra shown is 1200 seconds. For this particular example
the pixels between the SN and host galaxy do not overlap within the segmentation map.

600

×

≈

3.1. Extraction of 1D spectra

The extraction of 1D spectra, which involves solving for the ﬂux at each wavelength for each source, is an over-
constrained problem that has more data values than unknown parameters — that is, the set containing observed
information (direct and dispersed images) is far larger than the set of information to be solved for (ﬂuxed spectra for
all objects). pyLINEAR attempts to solve for the set of spectra that simultaneously satisfy all the available dispersed
data (i.e., all roll angles and dithers). pyLINEAR deﬁnes the system of linear equations that connect the observed
data and the unknown ﬂuxes and recasts to a known linear-algebra problem with sparse matrices, Ax = B. Roughly,
elements in the matrices A and B represent the observed counts and the weighting coeﬃcients that transform them
into the ﬂuxed spectra, and x represents the unknown vector of ﬂuxed spectra for all objects. This amounts to ﬁnding
a minimum in the equation,

χ2 = Σ
||

Ax

B

2.
||

−

(3)

However, if the matrix B has noise (which real data does), then the solution to equation 3 is numerically unstable.
Therefore, the actual equation to be solved is modiﬁed to the following regularized least squares equation,

where,
employs the LSQR (Paige & Saunders 1982) algorithm for solving the above equation with large sparse matrices.

is the regularization parameter (see Ryan et al. 2018a for more details on the regularization). pyLINEAR

L

χ2

true = Σ
||

Ax

B

2 +
||

Σ

x

||

2,
||

L

−

(4)

80001000012000140001600018000∏[˚A]10°2010°1910°1810°1710°16f∏[ergs°1cm°2˚A°1]1-hourprismspectrum;z=0.899pyLINEARx1dspecSNSNtemplateSNF106mag:24.09Host-galaxytemplateHost-galaxyF106mag:21.13(a)(b)SNHostHostHostSNSNSNRoman Prism Simulations of SNe Ia

9

Figure 5. The recovery of redshift from our ﬁtting pipeline. Left column shows the recovery results for all the SNe Ia in
our simulation, whereas the right column is restricted to only those SNe whose spectra contain no blended light from the host
galaxy. The error bars have been suppressed for clarity. The top panels show the inferred redshift vs. the true redshift and the
ztrue)/(1 + ztrue). The colors of the points denote the diﬀerent exposure
bottom panels show the residuals deﬁned by (zinferred
times as shown in the legend.

−

In contrast to aXe (K¨ummel et al. 2009), which provides a separate spectrum per object for each roll angle, while
leaving the combining of spectra at diﬀerent roll angles to the user, pyLINEAR provides a single extracted 1D spectrum
per object given its algorithmic philosophy of solving for the optimal ﬂux vector that satisﬁes all the available data.
Eﬀectively, the combining of the spectra at diﬀerent roll angles is done internally within pyLINEAR. This approach
naturally handles the problem of overlapping spectra without leaving the contamination subtraction as a separate
analysis task. Additionally, pyLINEAR has the advantage of achieving better spectral resolution without sacriﬁcing the
S/N in the extracted spectrum.

3.2. Parameter Recovery through Bayesian Inference

Extracted 1D spectra are ﬁt for redshift, phase, and dust extinction. The ﬁtting is done with the Python package
emcee (Foreman-Mackey et al. 2013, 2019), which samples the 3-dimensional (3D) posterior space for SNe models.
Our automated ﬁtting pipeline uses 500 walkers and 1000 steps. The walkers use the default “stretch-move” within
emcee for sampling the posterior. We start the walkers at the optimal position indicated by the approximate global
minimum. The minima for the walkers’ starting location is found by doing a brute force χ2 evaluation for each model
on a coarse grid of redshift (∆z = 0.01 within [0.01, 3.0]), phase (∆Phase = 1 within [
19, 50]), and dust extinction
(∆AV = 0.5 mag within [0.0, 3.0] mag). We employ ﬂat priors on SN phase and dust extinction (AV ) with the following
ranges:
5.0. For the SN redshift we employ a broad Gaussian
≤
prior with a mean of 1.2 and a standard deviation of 0.7. The broad Gaussian redshift prior allows down-weighting
of very low-z and high-z SNe (while not rejecting them outright). Finally, we require S/N>3 for the extracted 1D
spectrum prior to ﬁtting. This S/N is computed for the entire prism spectrum using the DER-SNR algorithm of Stoehr
et al. (2008).

SN Phase [Day rel. to peak]

50 and 0.0

AV

19

−

≤

≤

−

≤

Figure 5 shows the recovery of SN Ia redshifts for all SNe in the simulation (left column) and for the subset without
host galaxy light (right column). The recovery plots for phases and dust attenuation are shown in the appendix
(Figure 8). As expected, longer exposure times provide the most accurate inferred quantities. Most of the failed
estimates of redshift are caused by host galaxy light blending with SN light. As shown in Figure 5, the inferred

0.00.51.01.52.02.53.0zAllSNetexp=20mtexp=1htexp=3h0.00.51.01.52.02.53.0ztrue°1.0°0.50.00.51.01.5(z°ztrue)/(1+ztrue)0.00.51.01.52.02.53.0zNoblendedhost-galaxylighttexp=20mtexp=1htexp=3h0.00.51.01.52.02.53.0ztrue°0.0020°0.0015°0.0010°0.00050.00000.00050.00100.00150.0020(z°ztrue)/(1+ztrue)10

Joshi et al.

Figure 6. Fitted parameter residuals vs. S/N of observed spectrum for redshift (top), phase (middle), and AV (bottom).
Shaded exponential curves enclose
1σ of the residuals. For clarity, only a small subset of the SNe unaﬀected by blending are
shown. The S/N is computed for the entire prism spectrum using the DER-SNR algorithm of Stoehr et al. (2008). The colors
are the same as those used in Figure 5.

±

redshifts are systematically underestimated for SNe whose spectra contain light from the host galaxy, given that these
failures are absent in the plot that ignores SNe which contain blended host galaxy light. The failures generally come
from three modes. First, the continuum slope of the host galaxy spectrum, when blended with the typically fainter
SN spectrum, causes a mismatch between SNe Ia absorption features. This mismatch is driven by the continuum
slope of the host galaxy at the red end which dominates the χ2 in the SED ﬁtting. The necessity for the ﬁtting
pipeline to match the host galaxy continuum slope (instead of the SN continuum slope) pushes the pipeline estimate
to underestimated redshifts (and also younger phases, Figure 8). Second, strong host galaxy absorption features (e.g.,
4000 ˚A/Balmer breaks) are misidentiﬁed by the ﬁtting pipeline with SN absorption features. This is shown by the clear
linear feature below the 1:1 line. Lastly, the cluster of failures at the bottom of the ﬁgure are cases where host galaxy
light dominates the extracted 1D spectrum. However, it is worth recalling that the redshift estimates in Figure 5 come
from ﬁtting only the SNe spectra, and that a host galaxy spectrum can always be observed after the SN light has faded
allowing for a clean subtraction (and also allowing for a redshift estimate directly from the host galaxy spectrum in
some cases).

In this work, we do not attempt to deblend host galaxy and SN light. Our ﬁtting pipeline proceeds on the assumption
that there is no host galaxy light blended into the SN Ia spectrum, and it ﬁts the SN Ia spectrum without any attempt
to subtract the host galaxy spectrum. We leave this deblending to a future work which will likely involve marginalizing
over nuisance parameters that describe the host galaxy spectrum.

4. REDSHIFT EFFICIENCY DEPENDENCE ON EXPOSURE TIME

In this work, we assess the utility of Roman prism spectra primarily with regard to estimating redshifts. The
metric most commonly employed in the literature is to consider statistics of the redshift residuals deﬁned by σz =
(zinferred −
Figure 6 shows the dependence of the residuals of the recovered parameters on the S/N of the simulated spectrum
for diﬀerent exposure times. For clarity, this plot only shows those SNe from our simulation which do not contain any
blending with host galaxy light. For redshift residuals (top row) from low to high S/N, three somewhat distinct S/N

ztrue)/(1 + ztrue).

510152025−0.0020.0000.002z−ztrue1+ztrue510152025−101∆Phase510152025S/N−0.10.00.1∆Av20m1h3hRoman Prism Simulations of SNe Ia

11

regimes can be observed — S/N < 5, 5
15, and S/N > 15 — which correspond to increasing accuracy of
recovered parameters. Interestingly, while the redshift residuals and the dust-extinction residuals do not exhibit any
appreciable bias in their measurements relative to S/N, the recovered phase shows a clear bias toward younger phases.
We do not yet know the reason for this systematic phase bias.

S/N

≤

≤

≤

σz
|

0.01, measured through the absolute value of the redshift residuals

Figure 7 displays the eﬃciency of recovering redshifts as a function of SN Ia magnitude for our entire simulated
sample of 1698 SNe Ia sources. Within each magnitude bin the ﬁgure shows the fraction of spectra that achieve a
redshift accuracy of
. These redshifts are
|
recovered solely from P127 spectroscopy of the SN Ia without any reliance on emission or absorption features in the host
galaxy spectrum. While there is an implicit assumption here that the SN Ia classiﬁcation eﬃciency from P127 spectra
is 100% at all redshifts, this is a simplifying assumption we make given that any GO program on Roman will likely
have classiﬁed a given transient as an SN Ia from photometric observations, prior to requesting prism spectroscopic
observations. From preliminary work (done for HLTDS observations) we know that SN Ia classiﬁcation eﬃciency is
(cid:38) 90% for SNe Ia within 0.3 (cid:46) z (cid:46) 1.75,
65% within 1.75 (cid:46) z (cid:46) 2.0, and
20% for z > 2 (Steven Rodney, private
communication, using simulated P127 spectra of SNe Ia which are ﬁt with SNID, Blondin & Tonry 2007). Therefore,
while our completeness numbers here should be considered as upper limits, the ability to classify a P127 spectrum as
belonging to an SN Ia only really impacts observations of SNe Ia at z > 2 or SNe encountering extreme dust extinction.
25.5,
and has much higher eﬃciency at brighter SN magnitudes and lower redshifts. Our shorter exposure times of 20 min
and 1 hr achieve > 50% completeness for SNe Ia brighter than 24 and 24.4 mag AB, respectively. Particularly for
z < 0.5 SNe Ia, this implies that the Roman P127 is quick and eﬃcient at yielding high-S/N spectra and accurate
redshifts. Note the gradual ﬂattening of the curves as the exposure time is increased owing to increased numbers of
fainter SN spectra being ﬁt successfully, while of course the spectra of the brightest SNe are always ﬁt successfully. For
the longest exposure time considered, the gradual transition from high to low completeness also means that the 50%
completeness cutoﬀ (denoted by mc in the ﬁgure legend) is not sharp and the completeness drops to < 25% beyond
27.5 mag AB.

The longest exposure time of 3 hr in our simulated observations achieves 50% eﬃciency for sources as faint as

∼

∼

∼

z

≤

≤

We expect a 3 hr exposure time to reliably achieve 50% redshift completeness for all SN Ia redshifts in the range
1
2. These SNe Ia are expected to contribute most within cosmological analyses toward improving the dark
energy FoM (Albrecht et al. 2006). Cosmological analyses usually assume that redshift errors have negligible eﬀect
on the uncertainty budget in their analysis (e.g., Betoule et al. 2014; Scolnic et al. 2018). We show in this work that
this assumption should remain valid with cosmological analyses done using SN Ia redshifts inferred from Roman prism
spectra. We ﬁnd that the median redshift accuracy, median(
), is on the order of a few tenths of a percent for any
σz
|
exposure time that provides S/N > 5 (Figure 6). How the uncertainty in redshift propagates to the dark energy FoM
is part of a separate investigation (Macias et al., in prep.).

|

SNe Ia for which a host galaxy cannot be identiﬁed (e.g., Gupta et al. 2016), “hostless” SNe, are susceptible to
being dropped from cosmological analyses which employ only host galaxy observations to estimate redshifts (e.g.,
Dark Energy Survey, Abbott et al. 2019; Pan-STARRS, Jones et al. 2018). Within the framework presented in this
paper, i.e., SNe Ia without host galaxy blended light, we can recover accurate redshifts for Roman prism observations
of hostless SNe (right column of Figure 5); therefore, allowing SNe Ia to be included in cosmological analyses which
would otherwise be ignored.

While the primary goal of this work is not to optimize the ratio of P127 to imaging time for the HLTDS, we show a
promising outlook for redshift inference from P127 spectra especially for SNe Ia at z > 1. Rose et al. (2021) presented
several survey strategies with the ratio of prism to imaging time being one of the key unknown variables; the primary
reference survey has 25% prism time amounting to 7.5 hr per visit split between a wide and a deep tier (900 s and 3600 s
per object from the wide and deep tiers, respectively). Our 20 min and 1 hr exposure times are similar to the exposure
time of a single HLTDS pointing, and achieve > 50% completeness for SNe Ia brighter than 24 and 24.4 mag AB,
respectively. However, if spectra from multiple visits are coadded, then the completeness will improve further. Figure 5
shows that the main problem hindering higher levels of redshift completeness is the blending of host galaxy and SN
light causing confusion for ﬁtting routines. In general for any rolling survey, disentangling the SN spectrum from the
host galaxy spectrum will be somewhat easier given that the host galaxies will be repeatedly observed, allowing a
subtraction of an uncontaminated host spectrum from a host+SN spectrum, as long as data are taken with a wide
enough baseline such that SN light has faded.

12

Joshi et al.

Figure 7. Eﬃciency of recovering redshifts as a function of SN magnitude in F106 for the entire simulated prism spectroscopic
sample of 1698 SNe Ia. The left ordinate denotes what we refer to as the redshift completeness — this is the fraction of objects
within a given magnitude bin that achieve a redshift accuracy of σz =
0.01. The top abscissa provides a guide
to the reader as to the approximate redshift for the SN F106 magnitude; the SN redshift shown is derived under the assumption
of peak phase and no intervening dust. The background histogram in gray shows the magnitude distribution of the simulated
SNe Ia with the number of objects indicated on the right-hand ordinate. The points joined by dashed lines show the measured
redshift completeness from our simulation (compiled from redshifts measured for individual SNe), with colors corresponding to
diﬀerent exposure times as shown in the legend. The solid lines are sigmoid function ﬁts to the measured redshift completeness
points. The 50% redshift completeness magnitude for a given exposure time is denoted by mc in the legend.

∆z/(1 + z)
|

| ≤

Finally, we mention three caveats for the work presented here. Firstly, while the simulated spectra in the 2D dispersed
images have the appropriate variable dispersion vs. wavelength for the Roman prism, the extracted 1D spectra do not
yet have a variable dispersion. The 1D spectra have a constant wavelength sampling of 55 ˚A per pixel, corresponding
to the approximately average dispersion for the Roman prism – allowing for the variable dispersion in the 1D spectra
requires signiﬁcant restructuring of the pyLINEAR code base and is a work in progress. We note that Figure 5 shows
that the constant wavelength sampling for the 1D spectra does not hinder our ability to infer accurate redshifts, due
to the broad absorption features in SN Ia spectra. Additionally, because our goal is to evaluate redshift accuracies for
SNe Ia from Roman P127 spectra, we do not include other classes of transients in our simulation (e.g., core-collapse
SNe), and lastly, we do not yet incorporate complex dust geometries in our simulation.

We have reported results from the analysis of 1698 simulated Roman P127 spectra of SN Ia with exposure times of
1200, 3600, and 10,800 s. The Roman P127 prism is exceptionally eﬃcient at delivering high-S/N spectra, and therefore
is particularly useful for inferring accurate redshifts based on absorption features in the continuum. We recover limiting
magnitudes, i.e., >50% completeness, of 24.0, 24.4, and 25.3, for our three exposure times (although see preceding

5. SUMMARY

21222324252627282930SNmF1060.00.20.40.60.81.0Frac.zcompletenesstexp=3hmc=25.32±0.13texp=1hmc=24.41±0.06texp=20mmc=24.00±0.05010203040506070#objects0.160.220.300.390.500.640.851.181.531.791.992.172.332.482.632.793.463.24Approx.Redshift(assumedSNatpeak,nodust)Roman Prism Simulations of SNe Ia

13

discussion about the steepness of completeness curves) under the requirement of σz = (
0.01. The
z
|
procedure to employ pyLINEAR for simulating and extracting spectra, particularly for the case of the Roman P127
prism, is presented. The entire set of extracted 1D spectra, and simulated and recovered SN properties in tabular
form, are available upon request.

ztrue|

)/(1 + z)

−

≤

ACKNOWLEDGMENTS

B.A.J. is grateful for helpful discussions with members of the Roman Science Investigation Team (SIT) for supernova
cosmology, in particular with Steven Rodney, Ryan Foley, and Kevin Wang. A.V.F. received ﬁnancial support from
the Christopher R. Redlich Fund and many individual donors. R.H. acknowledges work supported by NASA under
award number 80GSFC21M0002.

The following software packages were used in the analysis presented in this work: numpy (Harris et al. 2020),
matplotlib (Hunter 2007), scipy (Virtanen et al. 2020), astropy (The Astropy Collaboration et al. 2018), emcee
(Foreman-Mackey et al. 2013, 2019), corner (Foreman-Mackey 2016), pyLINEAR (Ryan et al. 2018a), SExtractor
(Bertin & Arnouts 1996). This research has made use of NASA’s Astrophysics Data System.

REFERENCES

Abbott, T. M. C., Allam, S., Andersen, P., et al. 2019,

Holwerda, B. W., Keel, W. C., Kenworthy, M. A., & Mack,

ApJL, 872, L30, doi: 10.3847/2041-8213/ab04fa

K. J. 2015, MNRAS, 451, 2390,

Akeson, R., Armus, L., Bachelet, E., et al. 2019, arXiv

doi: 10.1093/mnras/stv1125

e-prints, arXiv:1902.05569.

https://arxiv.org/abs/1902.05569

Hounsell, R., Scolnic, D., Foley, R. J., et al. 2018, ApJ, 867,

23, doi: 10.3847/1538-4357/aac08b

Albrecht, A., Bernstein, G., Cahn, R., et al. 2006, arXiv

Hunter, J. D. 2007, Computing in Science & Engineering, 9,

e-prints, astro. https://arxiv.org/abs/astro-ph/0609591

90, doi: 10.1109/MCSE.2007.55

Bertin, E., & Arnouts, S. 1996, A&AS, 117, 393,

Jha, S., Garnavich, P. M., Kirshner, R. P., et al. 1999,

doi: 10.1051/aas:1996164

ApJS, 125, 73, doi: 10.1086/313275

Betoule, M., Kessler, R., Guy, J., et al. 2014, A&A, 568,

Jones, D. O., Scolnic, D. M., Riess, A. G., et al. 2018, ApJ,

A22, doi: 10.1051/0004-6361/201423413

857, 51, doi: 10.3847/1538-4357/aab6b1

Blondin, S., & Tonry, J. L. 2007, ApJ, 666, 1024,

K¨ummel, M., Walsh, J. R., Pirzkal, N., Kuntschner, H., &

doi: 10.1086/520494

Pasquali, A. 2009, PASP, 121, 59, doi: 10.1086/596715

Bruzual, G., & Charlot, S. 2003, MNRAS, 344, 1000,

Kuntschner, H., Bushouse, H., K¨ummel, M., Walsh, J. R.,

doi: 10.1046/j.1365-8711.2003.06897.x

& MacKenty, J. 2010, in Society of Photo-Optical

Calzetti, D., Armus, L., Bohlin, R. C., et al. 2000, ApJ,

Instrumentation Engineers (SPIE) Conference Series,

533, 682, doi: 10.1086/308692

Foreman-Mackey, D. 2016, JOSS, 24,

doi: 10.21105/joss.00024

Vol. 7731, Space Telescopes and Instrumentation 2010:

Optical, Infrared, and Millimeter Wave, ed.

J. Oschmann, Jacobus M., M. C. Clampin, & H. A.

Foreman-Mackey, D., Hogg, D. W., Lang, D., & Goodman,

MacEwen, 77313A, doi: 10.1117/12.856421

J. 2013, PASP, 125, 306, doi: 10.1086/670067

Oke, J. B., & Gunn, J. E. 1983, ApJ, 266, 713,

Foreman-Mackey, D., Farr, W., Sinha, M., et al. 2019, The

doi: 10.1086/160817

Journal of Open Source Software, 4, 1864,

Paige, C. C., & Saunders, M. A. 1982, ACM Trans. Math.

doi: 10.21105/joss.01864

Software, 8, 43

Gupta, R. R., Kuhlmann, S., Kovacs, E., et al. 2016, AJ,

Pickles, A. J. 1998, PASP, 110, 863, doi: 10.1086/316197

152, 154, doi: 10.3847/0004-6256/152/6/154

Pierel, J. D. R., Rodney, S., Avelino, A., et al. 2018, PASP,

Guy, J., Astier, P., Baumont, S., et al. 2007, A&A, 466, 11,

130, 114504, doi: 10.1088/1538-3873/aadb7a

doi: 10.1051/0004-6361:20066930

Pirzkal, N., & Ryan, R. 2017, A more generalized

Harris, C. R., Millman, K. J., van der Walt, S. J., et al.

coordinate transformation approach for grisms, Space

2020, Nature, 585, 357, doi: 10.1038/s41586-020-2649-2

Telescope WFC Instrument Science Report

14

Joshi et al.

—. 2020, The Dispersed infrared background in WFC3
G102 and G141 observations, Space Telescope WFC
Instrument Science Report

Pirzkal, N., Ryan, R., & Brammer, G. 2016, Trace and

Wavelength Calibrations of the WFC3 G102 and G141
IR Grisms, Instrument Science Report WFC3 2016-15, 25
pages

Rose, B. M., Baltay, C., Hounsell, R., et al. 2021, arXiv

e-prints, arXiv:2111.03081.
https://arxiv.org/abs/2111.03081

Ryan, R. E., J., Casertano, S., & Pirzkal, N. 2018a, PASP,

130, 034501, doi: 10.1088/1538-3873/aaa53e

Ryan, R. E., Casertano, S., & Pirzkal, N. 2018b, Linear

Reconstruction of Grism Spectroscopy I. Simulation and
Extraction Examples, Space Telescope WFC Instrument
Science Report

Saunders, C., Aldering, G., Antilogus, P., et al. 2018, ApJ,

869, 167, doi: 10.3847/1538-4357/aaec7e

Scolnic, D. M., Jones, D. O., Rest, A., et al. 2018, ApJ,

859, 101, doi: 10.3847/1538-4357/aab9bb

Spergel, D., Gehrels, N., Baltay, C., et al. 2015, arXiv

e-prints, arXiv:1503.03757.
https://arxiv.org/abs/1503.03757

Stoehr, F., White, R., Smith, M., et al. 2008, in

Astronomical Society of the Paciﬁc Conference Series,
Vol. 394, Astronomical Data Analysis Software and
Systems XVII, ed. R. W. Argyle, P. S. Bunclark, & J. R.
Lewis, 505

The Astropy Collaboration, Price-Whelan, A. M., Sip˝ocz,

B. M., et al. 2018, AJ, 156, 123,
doi: 10.3847/1538-3881/aabc4f

Virtanen, P., Gommers, R., Oliphant, T. E., et al. 2020,

Nature Methods, 17, 261, doi: 10.1038/s41592-019-0686-2

Wang, K. X., Scolnic, D., Troxel, M. A., et al. 2022, arXiv

e-prints, arXiv:2204.13553.
https://arxiv.org/abs/2204.13553

Roman Prism Simulations of SNe Ia

15

Figure 8. The recovery from our ﬁtting pipeline for phase (top row) and dust extinction (bottom row). Similar to Figure 5
the left column shows the recovery results for all the SNe Ia in our simulation, whereas the right column is restricted to only
those SNe whose spectra contain no blended light from the host galaxy. The panels show the inferred value vs. the true value
on the top and the diﬀerence between the inferred and true values on the bottom.

APPENDIX

A. EXAMPLES OF PARAMETER RECOVERY

Figure 8 shows the recovery of phase and dust attenuation by our ﬁtting pipeline. We also show two representative
examples of parameter recovery by our ﬁtting pipeline. Example 1 in Figure 9 shows the results of a successful ﬁt,
whereas example 2 in Figure 10 shows a common failure mode due to misidentiﬁcation of absorption features within

°10.0°7.5°5.0°2.50.02.55.07.510.0Phasetexp=20mtexp=1htexp=3h°10.0°7.5°5.0°2.50.02.55.07.510.0Phasetrue°20°1001020304050¢Phase°10.0°7.5°5.0°2.50.02.55.07.510.0Phasetexp=20mtexp=1htexp=3h°10.0°7.5°5.0°2.50.02.55.07.510.0Phasetrue°2.0°1.5°1.0°0.50.00.51.01.52.0¢Phase0.00.51.01.52.02.53.0Avtexp=20mtexp=1htexp=3h0.00.51.01.52.02.53.0Av;true°2°1012345¢Av0.00.51.01.52.02.53.0Avtexp=20mtexp=1htexp=3h0.00.51.01.52.02.53.0Av;true°0.20°0.15°0.10°0.050.000.050.100.150.20¢Av16

Joshi et al.

Figure 9. An example of a successful ﬁt to a simulated SN Ia at z
2.2 that does not include any blended host galaxy light.
Panel (a): Corner plot for the sampled parameter space, where the red lines indicate truth values. The values and uncertainties
on top of the panels indicate the estimates from the MCMC sampling. Panel (b): extracted spectrum in black with gray errors
and 200 randomly drawn models, in magenta, from the posterior distribution within
1σ of the inferred estimates. The input
template for the SN is shown in blue. Panel (c): trace plot for the MCMC walkers, where red lines again indicate truth values.
From top to bottom the sub-panels are redshift, phase, and AV . The exposure time is 1 hr for the extracted 1D spectrum.

±

≈

SNe Ia spectra that are caused by the red end continuum slope of the host galaxy (§ 3.2). Similar to the examples of
blending shown in Figure 3 the ﬁtting fails for the extracted spectrum in Figure 10 due to the χ2 being dominated
by the addition of the host galaxy continuum slope, even though it is clear that the extracted spectrum has the SN
absorption features at the correct wavelengths as seen in the input template.

z=2.198+0.002°0.002°10°50510DayDay=2.65+0.61°0.851.51.82.12.4z0123AV[mag]°10°50510Day0123AV[mag]AV[mag]=0.52+0.11°0.0980001000012000140001600018000∏[˚A]10°2110°2010°19f∏[ergs°1cm°2˚A°1]—bestﬁtmodelspyLINEARx1dspecSNSNinputtemplate1.52.02.5z°10010Day02004006008001000Stepnumber024AV[mag](a)(b)(c)Roman Prism Simulations of SNe Ia

17

Figure 10. Same as Figure 9 but for an unsuccessful ﬁt due to blended host galaxy light. The extracted 1D spectrum for
the host galaxy is also shown (red line) as a reference for the spectrum that is blended with the SN input template. The true
values are ztrue = 0.5288, phasetrue = 3 days, and Atrue
V = 0.02 mag. The inferred values are z = 0.038, phase = 3.91 days, and
AV = 3.57 mag (also indicated on the corner plot).

z=0.038+0.001°0.005°404812DayDay=3.91+0.43°1.91°0.150.000.150.300.45z3.54.04.55.0AV[mag]°404812Day3.54.04.55.0AV[mag]AV[mag]=3.57+0.06°0.0280001000012000140001600018000∏[˚A]10°1910°18f∏[ergs°1cm°2˚A°1]—bestﬁtmodelspyLINEARx1dspecSNpyLINEARx1dspechost-galaxySNinputtemplate0.000.250.50z°10010Day02004006008001000Stepnumber0246AV[mag](a)(b)(c)