2
2
0
2

r
a

M
8
1

]
S
D
.
h
t
a
m

[

1
v
1
6
0
0
1
.
3
0
2
2
:
v
i
X
r
a

Port-Hamiltonian Fluid-Structure Interaction
Modeling and Structure-Preserving Model
Order Reduction of a Classical Guitar

Johannes Rettberg∗

Dominik Wittwar †

Patrick Buchﬁnk†

Alexander Brauchler∗

Pascal Ziegler∗

Jörg Fehr∗

Bernard Haasdonk†

March 11, 2022

Abstract A ﬂuid-structure interaction model in a port-Hamiltonian representation is derived
for a classical guitar. We combine the laws of continuum mechanics for solids and ﬂuids within
a uniﬁed port-Hamiltonian (pH) modeling approach by adapting the discretized equations on
second-order level in order to obtain a damped multi-physics model. The high-dimensionality
of the resulting system is reduced by model order reduction. The article focuses on pH-systems
in diﬀerent state transformations, a variety of basis generation techniques as well as structure-
preserving model order reduction approaches that are independent from the projection basis.
As main contribution a thorough comparison of these method combinations is conducted. In
contrast to typical frequency-based simulations in acoustics, transient time simulations of the
system are presented. The approach is embedded into a straightforward workﬂow of sophisticated
commercial software modeling and ﬂexible in-house software for multi-physics coupling and model
order reduction.

Keywords — structure-preserving model order reduction, port-Hamiltonian systems, ﬂuid-

structure interaction, classical guitar

1 Introduction

The modeling and simulation of complex technical systems is indispensable for developing and
operating new products. Diﬀerent physical domains are suitably combined to create entirely new
functionalities and obtain a more realistic model and a better understanding of the overall system.
Considering multiple physical phenomena poses additional challenges in the system description as
these systems need to be reasonably coupled. Their interaction must be taken into account for
meaningful simulation results and a deeper understanding of the underlying system behavior. The
port-Hamiltonian (pH) representation is based on the idea of interconnecting Hamiltonian systems
and including dissipation in the formulation, for this reason the energy is used as the lingua franca
at the coupling ports [38]. This approach is attracting increasing attention due to its ability to
describe complex multi-physics systems in the context of automated modeling and provides the basis

∗Institute of Engineering and Computational Mechanics, University of Stuttgart, Pfaﬀenwaldring 9, 70569 Stuttgart,
Germany. (johannes.rettberg,alexander.brauchler,pascal.ziegler,joerg.fehr@itm.uni-stuttgart.de)
†Institute of Applied Analysis and Numerical Simulation, University of Stuttgart, Pfaﬀenwaldring 57, 70569

Stuttgart, Germany. (dominik.wittwar,patrick.buchfink,haasdonk@mathematik.uni-stuttgart.de)

1

 
 
 
 
 
 
Guitar Strings

Enclosed Air

Bridge

Sound Hole

Top Plate/
Soundboard

Back Plate

Figure 1: classical guitar

for a uniﬁed description of modeling, analysis, control, optimization, and model order reduction.
Furthermore, under mild assumptions pH-systems implicitly ensure important system properties
such as passivity, stability and energy conservation [13, 31].

Fluid-structure interaction (FSI) characterizes the interaction of a moving or deformable me-
chanical structure with an internal or surrounding ﬂuid [11]. The consideration of FSI plays a crucial
role in diﬀerent applications, e.g. the bending of aircraft wings, the blood ﬂow in large veins or the
lubricant ﬂow in ball-bearings [32]. In the current study we want to analyze an acoustic system in
which FSI is also of great importance for its proper technical function.

A classical guitar is a popular instrument consisting of various components whose most im-
portant ones are brieﬂy described in order to understand the physical context of the mathematical
problem, see Fig. 1. The musician plucks the guitar strings which thereupon start to vibrate. Those
vibrations are transferred through the bridge into the soundboard which is the top plate of the guitar
body. The guitar body coupled with the enclosed air acts as a resonator for the strings’ vibration.
The guitar’s composition and material properties inﬂuence the volume and timbre of the air escaping
through the sound hole. The classical guitar represents an impressive example of a multi-physics sys-
tem where the guitar body is strongly coupled with the enclosed air and the coupling eﬀects cannot
be neglected for a realistic representation of the behavior. The modeling of a guitar without strings
can be found e.g. in [8, 14] and the modeling of strings in [7, 15]. Port-Hamiltonian representations
of acoustic models are presented for instance in [34] for the vocal apparatus and for a Rhodes piano
in [19]. The modeling procedure of this work follows closely the approach presented in [8].

2

In the current study this FSI problem is derived from the partial diﬀerential equation of linear
elasticity for the mechanical structure [35] and the wave equation for the ﬂuid [6]. The system is
spatially discretized with the ﬁnite element (FE) method in order to obtain a coupled second-order
ordinary diﬀerential equation (ODE) system [42]. Structural damping obtained from measurements
is included into the model [8]. From this basis, a port-Hamiltonian representation is attained by ﬁrst
transforming the system into a ﬁrst-order system and then applying an adapted state transformation.
The coupling eﬀects of the multi-domain system are illustrated in a transient time simulation which
gives further insight to classical frequency-based analyses in acoustics.

The spatial discretization via FE methods typically leads to high-dimensional systems that
are ill-suited for multi-query simulations, e.g. for usage in optimization loops. Hence, model order
reduction (MOR) methods are essential to approximate the system in a subspace of a much lower
dimension for a faster and more eﬃcient simulation [3]. One major novelty is the presentation of
a comprehensive sensitivity analysis for a variety of combinations of projection methods and basis
generation methods, i.e. the calculation of projection matrices, for reducing the FSI problem. The
projection methods focus on basis-independent structure-preserving1 reduction [40, 16] to preserve
the important system properties in comparison to non-structure-preserving variants. The basis
generation comprises approaches that are based on the system matrices, such as modal truncation
[26] or moment-matching via Krylov subspaces [21], and data-based techniques based on time-
response snapshots, e.g. Proper Orthogonal Decomposition (POD) [39] and Proper Symplectic
Decomposition (PSD) [29, 10]. For more information on recent developments in structure-preserving
MOR procedures for both Hamiltonian and port-Hamiltonian systems, we refer to [5, 24, 2, 23] and
the references therein.

The paper is organized as follows. In Section 2, the dynamic equations for a ﬂuid-structure
interaction problem are derived and adapted on second-order level. Additionally, practical aspects
from the enhanced modeling process as an ensemble between the commercial software Abaqus and
in-house code in Matlab are described. In Section 3, the necessary background on port-Hamiltonian
systems is given and the FSI model of the guitar in a port-Hamiltonian input-output state rep-
resentation is derived. Based on this, further pH formulations are deduced and the transient time
simulation of the full system is performed. Various non-common projection methods, both structure-
preserving and non-structure-preserving, are presented in Section 4. In Section 5, we recall classical
and introduce modern basis generation methods with adapted snapshot matrices and non-orthogonal
bases. The comprehensive sensitivity analysis is given in Section 6. Finally, we conclude the paper.
An overview of the entire workﬂow is given in Fig. 2. In the remainder this workﬂow diagram will
be referenced by a circled number which highlights the workﬂow area the current section is referring
to, e.g. 1 .

2 Modeling of a classical guitar

When producing a tone with a guitar, many diﬀerent guitar components interact with each other,
with the interaction of the guitar body and enclosed air being of particular importance. An enhanced
three mass model focuses on this interaction and serves as a comprehensive system on which the
investigated methodologies are presented. The present chapter ﬁrst describes the mathematical
background of this ﬂuid-structure interaction and then also addresses the practical aspects of its
implementation using Abaqus and Matlab.

1Note that the term structure has an ambiguity in this paper. On the one hand, it describes the mechanical structure
of the wooden guitar plates as part of the ﬂuid-structure interaction. On the other hand, it likewise describes the
mathematical structure of the pH-system, which should be preserved through the model reduction process. To
avoid misunderstandings, the expression mechanical structure is used in the context of the FSI.

3

Modeling

PDE
1
ρS ¨z = ∇ · σ(z) + b0
∂2p
1
∂t2 − ∇2p = 0
c2
0

FEM in Abaqus

geometry

meshing
boundaries
interfaces
inputs

2

Fluid-Structure Interaction
P S

P F

P S

4

∂p
∂nF SI

= −ρF

(cid:17)T

(cid:16) ∂2z
∂t2
pzT nF SI dA

nF SI

2nd order system
ˆM ¨ˆx + ˆD ˙ˆx + ˆK ˆx = ˆf

3

pH system
E ˙x = (J − D)Qx + Bu,
y = BT Qx.

5

R (cid:98)= (cid:82)

ΓF SI

Model Order Reduction

MatMorembs

V

Modal

Krylov

RBMatlab

8

9

POD

PSD

Projection

10
structure-preserving
J = −J T ,
D = DT ≥ 0,
ET Q = QT E
non-preserving

IMR

Validation

IMR
1
2

1
2
1

Snapshots

7

FOM

ROM

11

Comparison

6

t

12

13

Figure 2: workﬂow diagram

2.1 Derivation of the dynamic equations for the ﬂuid-structure interaction

The vibration of the mechanical structure can be described as an elastic motion of the wooden
plates of the guitar that can be mathematically explained by the methods of continuum mechanics,
cf. 1 . The motion of a body is described by the motion of all material points P S for this body,
where the current position of each point can be classiﬁed by its position R0 in the initial conﬁguration
and the displacement z(R0, t). Assuming small strains leads to the elastodynamic problem for the

4

time interval It = [0, tend]

force equilibrium: ρS ¨z = ∇ · σ(z) + b0,

strain-displacement relation:

(cid:0)∇z + (∇z)T (cid:1) ,

constitutive equation (Hooke’s law):

boundary condition:

z = zb,
coupling term: σn = t,
1
2
σ = CEMεs,
z = z0,
˙z = ˙z0,

εs =

initial condition:

in It × P S
in It × Γz
in It × ΓF SI

in P S

in P S
in P S
in P S

(1a)

(1b)

(1c)

(1d)

(1e)

(1f)

(1g)

known as the strong formulation. The fundamental laws and material-dependence are considered
in the force equilibrium (1a) and the constitutive equation (1e). The density of the material ρS,
the second temporal derivative of the displacements ¨z, the divergence of the stress tensor σ and
the volume forces b0 form the force equilibrium (1a), where ∇ describes the nabla operator. The
constitutive equation (1e) involves the engineering strain εs and elastic modulus CEM. We restrict
ourselves to the case of orthotropic, linear elastic material behavior which can be parametrized with
of nine parameters: three Young’s moduli, three Poisson ratios and three shear moduli to consider
the behavior in each spatial direction [43]. Γz describe the parts of the body surface where Dirichlet
boundary conditions for the displacement zb apply. Likewise ΓF SI describes the contact surface of
the mechanical structure and the encased air on which the stresses are given by the surface traction
t = pnF SI whose magnitude scales proportionally with the pressure p of the air at the contact
surface. Here nF SI denotes the normal vector of unit length pointing into the direction of the
encased air. The initial conditions at time t = 0 are given for the displacements z0 and velocities ˙z0
[35, 36, 42].

For a numerical simulation the continuum is spatially discretized with the ﬁnite element method
(FEM) resulting in the symmetric mass matrix MS ∈ RNS ×NS and the symmetric stiﬀness matrix
KS ∈ RNS ×NS . To model dissipation eﬀects, i.e. the damping parameters, we employ the so-called
Rayleigh damping

DS = αMS + βKS

(2)

with the coeﬃcients α and β. Measurements of the damping ratio were conducted on a real guitar
at diﬀerent frequencies ωD, see [8], and the overdetermined equation system is solved by using a
least square ﬁt for the coeﬃcients that results in α = 15.958 1

s and β = 2.821 · 10−6 s.

This complements the dynamic equation of the mechanical structure resulting in the second-

order space discretized system, c.f. 3

MS ¨z + DS ˙z + KSz = fS + fp

(3)

with the damping matrix DS ∈ RNS ×NS and the excitation forces fS, fp ∈ RNS for the mechanical
structure, whereas the latter is the speciﬁc force stemming from the coupling term (1c).

The geometry and division of the guitar into the diﬀerent domains can be seen in Fig. 3. The
model consists of three diﬀerent parts: the top plate or soundboard with a sound hole, the back
plate and the air inside the guitar body in the shape and of the size of a classical guitar. Modeling
the guitar behavior with these parts (in lumped parameter form) is known as a three mass model
[14]. The approach of [8] is used as a reference to create an enhanced three mass model, which will
be discussed further in Section 2.2.

5

top plate (solid)
enclosed air (ﬂuid)
back plate (solid)

Figure 3: sectional view of the FEM multi-physics model of a classical guitar

The ﬂuid behavior, c.f. 1 , can be described with

acoustic wave equation:

boundary conditions:

1
c2
0

∂2p
∂t2 − ∇2p = 0,
p = pb,

∂p
∂n

= 0,

in It × P F

in It × Γb

in It × Γn

coupling term:

∂p
∂nF SI

= −ρF

(cid:19)T

(cid:18) ∂2z
∂t2

nF SI ,

in It × ΓF SI

(4a)

(4b)

(4c)

(4d)

(cid:17)T

(cid:16) ∂2z
∂t2

where the acoustic wave equation is derived from the Euler equations for ideal, compressible ﬂuids
with Dirichlet boundary conditions pb on Γp, zero Neumann boundary conditions, which model
natural boundary conditions at the parts where the ﬂuid is not encased by the structure, i.e. Γn and
non-zero Neumann boundary conditions at the interface, which describe the coupling relationship
between the ﬂuid and the mechanical structure. The force applied to the mechanical structure along
the normal direction, i.e.
is equal in magnitude but of opposite direction compared to the

∂p
∂nF SI

force applied by the mechanical structure along the normal direction, i.e. −ρF
nF SI . The
acoustic wave equation (4a) contains the speed of sound c0 and the pressure p on the domain P F
[6, 27].

The wave equation is spatially discretized by using the Galerkin method with linear shape

functions. This leads, c.f. 3 , to the dynamic equations of the ﬂuid in matrix form [25]

MF ¨p + KF p = fF + fz

(5)

with the symmetric mass matrix MF ∈ RNF ×NF , the symmetric stiﬀness matrix KF ∈ RNF ×NF ,
the excitation vector for the ﬂuid fF ∈ RNF and the excitation vector fz ∈ RNF stemming from the
interaction with the mechanical structure, i.e. the coupling term (4d).

FSI is an area that describes the multi-physics coupling between the domains of ﬂuid dynamics
and structural mechanics. The coupling is considered a strong FSI if the motion of the solid inﬂuences
the ﬂuid and vice versa [27]. The classical guitar as the studied system allows the investigation of
these strong couplings. In our case this coupling is expressed via the coupling terms (1c) and (4d).

6

The eﬀects of the mechanical structure on the ﬂuid and vice versa, c.f. 4 , result in the external

forces fp and fz, respectively. The former relates to the quantity

(cid:90)

fp

(cid:98)=

ΓF SI

tT ztest dA =

(cid:90)

ΓF SI

pzT

testnF SI dA

whereas the latter corresponds to the quantity

fz

(cid:98)=

(cid:90)

−ρF

(cid:19)T

(cid:18) ∂2z
∂t2

ΓF SI

nF SI ptest dA.

Hence, both fp and fz can be represented as a matrix vector product

fp = Rp

and

fz = −ρF RT ¨z,

where R describes the coupling matrix [25] representing the term

(cid:90)

R (cid:98)=

ΓF SI

ptestzT

testnF SI dA.

(6)

(7)

(8)

(9)

However, in the present case of non-matching meshes, the nodal values of the acoustic and structural
domains, which are part of the interface, are related to each other with linear interpolation.

Consequently, the separate equations for the mechanical structure (3) and the ﬂuid (5) can be

combined into the following coupled system:

(cid:20) MS
0
ρF RT MF
(cid:123)(cid:122)
ˆM ∈R ˆN × ˆN

(cid:124)

(cid:21)

(cid:125)

(cid:20) ¨z
(cid:21)
¨p
(cid:124)(cid:123)(cid:122)(cid:125)
¨ˆx∈R ˆN

+

(cid:21)

(cid:20)DS 0
0
0

(cid:125)
(cid:123)(cid:122)
(cid:124)
ˆD∈R ˆN × ˆN

(cid:21)

(cid:20) ˙z
˙p
(cid:124)(cid:123)(cid:122)(cid:125)
˙ˆx∈R ˆN

+

(cid:20)KS −R
0 KF
(cid:123)(cid:122)
ˆK∈R ˆN × ˆN

(cid:124)

(cid:21)

(cid:125)

(cid:21)

(cid:20)z
p
(cid:124)(cid:123)(cid:122)(cid:125)
ˆx∈R ˆN

=

.

(cid:21)

(cid:20)fS(t)
fF (t)
(cid:124) (cid:123)(cid:122) (cid:125)
ˆf ∈R ˆN

(10)

Note that the mass and stiﬀness matrices, ˆM and ˆK, are unsymmetric which leads to nu-
merical issues when solving large sparse linear systems and to problems for the derivation of a
port-Hamiltonian formulation of the system. Therefore, an adapted formulation of the system is
derived in the following.

Instead of using the z-p-formulation (10) a state transformation

p = ˙q

(11)

is applied, where instead of the pressure p, the time derivative of the variable q is used which is
in close relationship to the velocity potential. This approach is frequently used in the literature to
symmetrize the system matrices [37, 17].

A minor adaptation is used to make the pH matrices accomplish the mandatory skew-symmetry
property after the transformation from a ﬁrst-order to a second-order system: Inserting (11) into
(10), taking the integral of the second line of (10) and dividing by ρF (instead of −ρF which is
typically considered in literature) leads to the formulation

(cid:20)MS
0

1
ρF

0
MF

(cid:21)
(cid:21) (cid:20) ¨z
¨q

(cid:20) DS R
−RT
0

(cid:21) (cid:20) ˙z
˙q

(cid:21)

(cid:20)KS
0

+

+

0
KF

(cid:21)

(cid:21) (cid:20)z
q

=

(cid:21)

(cid:20)fS(t)
gF (t)

1
ρF

with

gF (t) =

1
ρF

(cid:90) t

0

fF (τ ) dτ.

7

(12)

(13)

2.2 Practical modeling aspects

The FE discretization is realized with the commercial software Abaqus, see [1], which allows us to
design the complex geometry of the guitar, deﬁne material parameters and boundary conditions,
and automatically mesh the geometry with sophisticated meshing tools, see 2 .

The main goal of the current study is not a very accurate prediction of the guitar’s behavior in
accordance with experimental data but to rather investigate the performance of various formulations
on an illustrative example for FSI. For this reason, the guitar is not modeled in full detail but still
includes the most important aspects.

The top and back plate are modeled with shell elements S4R5, see Fig. 4. A summary of the ﬁnite
element mesh properties used for the guitar model is presented in Tab. 1. We use S4R5 element as it
is accompanied by the advantage that the system size is reduced since there are less DOFs compared
to the more common six DOFs S4 element. Furthermore, for the mechanical structure a six degree
of freedom (DOF) formulation in Abaqus would lead to a singular matrix MS which would cause
additional numerical issues and would lead to a diﬀerential-algebraic pH-system. The air model is
enhanced by adding length correction to the ﬂuid domain to account for eﬀects of the surrounding
air [18], see Fig. 5.

Table 1: ﬁnite element mesh properties

top plate

ﬂuid

back plate

element type
nodes per element
DOFs per node
DOF types

shell S4R5
4
5
3 trans, 2 rot

acoustic AC3D8
8
1
1 pressure

shell S4R5
4
5
3 trans, 2 rot

number of elements
number of nodes
number of DOFs

343
387
1554

2434
3226
3170

149
171
900

boundary structure Γz
excitation force fS

Figure 4: meshed top plate

As stated in the mathematical derivation of the mechanical structure and the ﬂuid, some bound-
ary conditions need to be considered that are in accordance with the physical behavior of the guitar.
Therefore, the mechanical structure is constrained at the edges with homogeneous Dirichlet bound-
ary conditions for the displacement variables. The rotational DOFs are not aﬀected by this condition.
This kind of boundary condition is considered as simply supported. The ﬂuid is mainly characterized
by the coupling with the solid and the reﬂection from the sidewalls, due to homogeneous Neumann

8

boundary conditions on Γn. However, the boundary condition at the top of the sound hole needs to
be deﬁned diﬀerent since there is a free surface. This can be achieved by simply using the assumption
of zero pressure [43]. The boundary conditions are marked in red and purple in Figs. 4 and 5.

Dirichlet boundary ﬂuid Γp
length correction
Neumann boundary Γn
FSI interface ΓF SI
pressure output

Figure 5: meshed ﬂuid

The outcome of the modeling process in Abaqus are the mass and stiﬀness matrices for the me-
chanical structure (3) and the ﬂuid (5). The further steps of modeling and simulation are performed
in Matlab. This change in the software tool is motivated by various advantages: (a) The modeling in
Matlab gives a better insight into the model especially due to the independent coupling procedure.
In addition, (b) the obtained ﬂexibility enables the system to be modiﬁed in the ﬁrst place and
thus to be reformulated into a pH-system. Furthermore, (c) this choice also gives us the freedom to
decide on the integrator and the associated simulation properties.

In a real scenario, the guitarist plucks the string which introduces vibrations that are transferred
through the bridge into the soundboard. Since the string and bridge are not modeled, the inﬂuence
of these components is integrated as a force input at the position where the bridge would normally
be located. A standard tuning of a guitar will create sounds in the range of approximately 82 Hz
on the lowest pitch and 320 Hz at the highest pitch for the unfretted strings. The frequency range
is chosen this way, since the objective is to demonstrate the methods on unfretted strings and the
harmonics are neglected. For this reason, there will be a sine wave excitation force with

u = ˆu sin(ωt)

(14)

with ω = 2πf in the frequency range f = [82, 320] Hz and with an amplitude of ˆu = 1 N that acts
on one node of the top plate. As outputs, diﬀerent important nodes of the mesh are considered.
Those nodes include the aforementioned excitation node where the force acts on, compare Fig. 4, as
well as the volume-weighted integral of the pressure over the ﬂuid nodes close to the sound hole of
the guitar, compare Fig. 5, and a central mechanical structure node of the back plate.

3 Port-Hamiltonian formulation

Port-Hamiltonian (pH) systems were initially developed to describe a uniﬁed approach for systems
from diﬀerent physical domains that allow network modeling, see references in [9, 31]. The pH
formulation describes an energy-based network modeling approach with the energy as common
quantity of various physical systems that interact through ports [38].

9

The pH structure can imply the underlying physical principles such as conservation laws [4].

The input-output state form of a pH-system with neglected feed-through terms appears as

˙x(t) = (J − D)∇H(x(t)) + Bu(t)
y(t) = BT ∇H(x(t))

(15)

where the function H(x(t)) describes the Hamiltonian as an energy function of the system. The
Hamiltonian depends on the state vector x(t) ∈ RN with the system order N = 2 ˆN . The matrix
J ∈ RN ×N reﬂects the interconnection of the internal energy storage elements while the dissipation
matrix D ∈ RN ×N describes the energy losses in the system. The matrix B ∈ RN ×m is the
port or input matrix that speciﬁes the manner in which energy enters or leaves the system. The
Hamiltonian and the port matrix motivate the term pH-system. The pH-system matrices need to
satisfy the requirement that J = −J T is skew-symmetric and D = DT ≥ 0 is symmetric positive
semideﬁnite. Furthermore, the variables u(t), y(t) ∈ Rm describe the time-dependent input and
output vectors, respectively [38].

Besides the modeling aspects, the pH formulations come with additional advantages as they
implicitly incorporate important system properties. The pH-system (15) is a generalization of a
classical Hamiltonian system as the conservation of energy is generalized to a dissipation inequality

H(x(t1)) − H(x(t0)) ≤

(cid:90) t1

t0

y(t)T u(t) dt with t1 > t0

(16)

which in combination with the assumption that the Hamiltonian is quadratic and strictly positive
H(x) > 0 for all x leads to the properties that the pH-system is both passive and stable [13]. Note,
that the input and output entries of (15) belong to the same variables deﬁned by the port matrix B.
One can choose arbitrary quantities of interest (QoI) as outputs with appropriately chosen matrices
but these output quantities may not satisfy the dissipation inequality (16) and only serve the purpose
of data observation.

Depending on the speciﬁc application and the coordinate system for which the problem is

formulated, a generalized linear port-Hamiltonian system in the so-called descriptor form [4],

E ˙x = (J − D)Qx + Bu,

y = BT Qx.

(17)

with constant matrices E ∈ RN ×N and Q ∈ RN ×N that satisfy the condition ET Q = QT E in
addition to the previously mentioned J , D and B may also be considered.

In this case, the Hamiltonian of the system can be described as a quadratic energy function

H(x) =

xT ET Qx

1
2

(18)

For our setting, such a descriptor system is obtained by transforming the second-order system
˙qT (cid:3)T , which leads

(12) into ﬁrst-order a pH-system (17) via the new state vector x = (cid:2)zT qT

˙zT

10

to the pH-system matrices

E =

J =







INS
0
0
0







0
0
−INS
0

Bu = (cid:2)0 0 f T
S

gT
F

0
0
0
INF
0 MS
0

0
0
0







0
0
0

0 MF /ρF
0
INF
R
0

INS
0
0







−INF −RT
(cid:3)T

Q =

D =







KS
0
0 KF
0
0
0
0

0
0
INS
0








0
0
0
INF

(19)







0
0

0
0 0
0
0 0
0 0 DS 0
0
0 0

0





x = (cid:2)zT qT

˙zT

˙qT (cid:3)T

with E describing the kinetic energy components and Q containing potential energy terms, c.f. 5 .
The matrices INF/S represent the identity matrix of size NF/S. The pH matrices satisfy the manda-
tory properties

J = −J T ,
D = DT ≥ 0,

ET Q = QT E.

(pH1)

(pH2)

(pH3)

The pH-system (19) will further be considered as the velocity formulation.

3.1 Numerical simulation of full-order results

We discretize the system with respect to time, using the implicit midpoint rule (IMR), cf. 6 , which
is the Gauss-Legendre collocation method with 1 stage and of order 2 for ODEs. The IMR is a
symplectic integrator and hence, preserves the symplectic structure and the quadratic Hamiltonian
through the time integration [28].

We use a step size of ∆t = 10−4 s and simulate for T = 0.1 s to include several oscillation
periods for the whole frequency range. All calculations were carried out with Matlab. An advantage
of a ﬁxed time step is the better comparability of the trajectories. Since the numerical error of an
integrator depends on the step size, we avoid mixing the integration and model reduction error.

The simulation of a full-order model (FOM) of the guitar is important for diﬀerent reasons.
On the one hand, these results will give us an insight about the approximate guitar behavior and
the physical plausibility of the modeling. On the other hand, the FOM results form the basis for
the calculation of the approximation error in the energy norm. Additionally, the FOM results are
required for the snapshot generation, cf. 7 , for the data-based basis generation techniques.

We consider a parameter dependent excitation u = u(µ) of the top plate that is modeled by a
sinusoidal input where µ ∈ [82, 320] Hz denotes the excitation frequency f . The time simulation of
the FOM for an excitation frequency of f = 100 Hz is illustrated in Fig. 6. It can be seen that as a
result of the excitation, the top plate at the excitation node starts to vibrate at the same frequency
since the guitar describes a linear time-invariant (LTI) system. The vibrations are transferred into
the ﬂuid whose pressure values start oscillating which corresponds to a sound of the guitar. The
back plate vibrates at a lower magnitude than the top plate which is justiﬁable by the transmission
of energy through the ﬂuid. It shall be emphasized that the back plate is only connected to the
excited top plate via the ﬂuid and hence, the strong coupling eﬀects of the ﬂuid can be demonstrated
impressively.

11

]
a
P

[

e
r
u
s
s
e
r
p

,
]

m
5
-
e
1
[

t
n
e
m
e
c
a
l
p
s
i
d

15

10

5

0

−5

−10

−15

0

top plate
acoustic sound hole
back plate

2 · 10−2

4 · 10−2

6 · 10−2

8 · 10−2

0.1

time [s]

Figure 6: time simulation for one selected node per component at excitation frequency f = 100 Hz

3.2 Reformulations of the pH-system

We derived our pH-FSI-system via a transformation of the second-order system and using the dis-
placements, the integrated pressure and their derivatives as pH variables. In classical Hamiltonian
systems the variables are deﬁned in terms of the canonical position and momentum coordinates to
account for additional symmetries [13]. For this reason, a system in momentum formulation shall
also be considered in the analysis. All of the following reformulations of the pH-system still satisfy
the mandatory pH properties (pH1) to (pH3). The coordinate transformation

yields such a pH-system in momentum formulation

xm = Ex

˙xm = (J − D)QE−1xm + Bu,

y = BT QE−1xm,

(21)

(22)

where xm contains the momentum instead of the velocities.

Since the PSD methods presented in Section 6 are based on a system formulation with canonical

J , i.e.

the canonical variants of the velocity formulation

J =

(cid:20) 0
−I ˆN

(cid:21)

,

I ˆN
0

and momentum formulation

xc = P −1x

xmc = P −1Ex

12

(23)

(24)

will be considered in the sensitivity analysis, which yield the canonical system in velocity formulation

P T EP ˙xc = P T (J − D)P P −1QP xc + P T Bu,

y = BT QP xc

and in momentum formulation

P T P ˙xmc = P T (J − D)P P −1QE−1P xmc + P T Bu,

y = BT QE−1P xmc.

The transformation matrices P , P −1 depend on the coupling matrix R and are given by

(25)

(26)

P =







INS
0
0
0

0

0
INF −RT /2
0
0

INS
0







R/2
0
0
INF

,

P −1 =







INS
0
0
0

0

0
INF RT /2
INS
0
0
0







−R/2
0
0
INF

.

(27)

The calculation of the FOM is computationally too expensive, especially if it comes to multi-
query simulations. Therefore, MOR techniques are required and will be discussed in the following.

4 Model order reduction - Projection methods

The size of a dynamical system model can be reduced by approximating its behavior in a subspace
of a lower dimension. This model reduction comes at the cost of approximation errors. Projection-
based reduction methods can be performed in various ways with diﬀerent outcomes with respect to
the preservation of diﬀerent structural2 pH properties, cf. 10 .

All reduction methods used in our study are based on a projection-based reduction. The solution
for x(t) is approximated in a subspace V of dimension n (cid:28) N which is described by a basis matrix
V ∈ RN ×n with colsp(V ) = V and leads to the approximation

with the reduced state vector xr ∈ Rn.

Inserting (28) into the pH-system (17) and using the Petrov-Galerkin condition for W ∈ RN ×n

[3] yields the reduced system

x(t) ≈ V xr(t)

(28)

W T EV ˙xr = W T (J − D)QV xr + W T Bu

y = BT QV xr.

(29)

of size n (cid:28) N , where the matrix W determines the orthogonal projection direction.

A special case of the Petrov-Galerkin approach is the Galerkin projection with W = V and

takes the form

V T EV ˙xr = V T (J − D)QV xr + V T Bu

y = BT QV xr.

(30)

This projection does in general not preserve any of the underlying pH structure properties (pH1)-
(pH3) of the system in our formulation.

2Here, the term structure refers to the mathematical pH structure

13

The quasi-Galerkin projection is derived by inserting the term V V T under the assumption

that (J − D)V V T Q ≈ (J − D)Q to the standard Galerkin projection which yields

V T EV
(cid:124) (cid:123)(cid:122) (cid:125)
Er

˙xr = V T (J − D)V V T QV
(cid:124) (cid:123)(cid:122) (cid:125)
Qr

xr + V T Bu

y = BT QV xr.

(31)

This projection preserves (pH1) and (pH2) but it does not guarantee (pH3) and hence, the Hamil-
tonian of the reduced system ¯H(xr) (cid:54)= H(V xr) changes in the reduction.

Adapting the pH structure-preserving approach [40] with W = QV to the case of a de-

scriptor system leads to a reduced system

V T QT EV ˙xr = V T QT (J − D)QV xr + V T QT Bu

y = BT QV xr

with the reduced matrices

Er = V T QT EV ,
Dr = V T QT DQV , Qr = In.

Jr = V T QT J QV ,

(32)

(33)

This preserves the pH properties (pH1)-(pH3) and does not change the Hamiltonian in the reduced
system [40].

The author in [16] presents a general framework for the numerical approximation of evolution
problems which is also suitable for pH-systems and preserves the underlying Hamiltonian structure.
We will call this approach energy-stable. Applying this approach to a pH-system leads to a reduced
system

V T ET (J − D)−1EV ˙xr = V T ET QV xr + V T ET (J − D)−1Bu,

In our case the inverse term can be easily calculated with

y = BT QV xr.

(J − D)−1 = T T P T (J − D)P T with T =

(cid:20) 0
I ˆN

(cid:21)

I ˆN
0

(34)

(35)

which allows for a computational eﬃcient implementation.

In order to assess the quality of the diﬀerent projection methods, a direct comparison with the
best approximation in the considered subspace colsp(V ) should be examined. Here, we use the
best approximation with respect to the energy norm (cid:107)·(cid:107)2
H induced by the energy inner product (cid:104)·, ·(cid:105)H

(cid:107)x(cid:107)2

H := xT Hx = xT ET Qx = (cid:104)x, x(cid:105)H,

(36)

where H = ET Q denotes the so-called energy matrix which is positive deﬁnite, since both ET
and Q are positive deﬁnite and their product is symmetric due to the third pH-property (pH3).
The best approximation of x in the subspace colsp(V ) is then given by the projection ΠV ,H of x
onto colsp(V ) with respect to the energy inner product. In terms of the energy matrix this can be
expressed via

and we have

ΠV ,Hx = V (cid:0)V T HV (cid:1)−1

V T Hx

(cid:107)x − ΠV ,Hx(cid:107)H = min

(cid:107)x − ˆx(cid:107)H

ˆx∈colsp(V )

(37)

(38)

14

5 Model order reduction - Basis Generation

For all projection-based reduction methods presented in Section 4, a basis matrix V is required.
In the following, diﬀerent basis generation approaches are presented with the goal to keep the
approximation error as small as possible. The bases are generated by using the extensive software
packages MatMorembs3 [20] and RBmatlab4, cf. 8 and 9 .

For the basis generation method based upon modal truncation, the homogeneous solution for

(17) with u(t) = 0 is solved with the ansatz function

x(t) = eλitφi with λi ∈ C, φi ∈ CN

which leads to the generalized eigenvalue problem

Aφi = λiEφi

(39)

(40)

with A := (J − D)Q for the pH-system. The eigenvectors φi are also called coupled eigenmodes
and describe the deformation of the mechanical structure and pressure distribution in the ﬂuid at
the dedicated eigenfrequencies. Modal truncation uses only the most important eigenvectors as the
projection basis [3]. In the context of the guitar, the most important eigenvectors coincide with the
eigenvectors that belong to the lowest eigenfrequencies since those are the crucial eigenfrequencies
for the sound emission. Hence, the modal projection basis arises as

Vmod = (cid:2)φ1

. . . φn

(cid:3)

(41)

with n (cid:28) N . In the current study, the eigenmodes belonging to the lowest eigenfrequencies are
coupled eigenmodes that allow for dynamics in the mechanical structure and ﬂuid simultaneously.
In general, Vmod is not real-valued. In this case, the matrix V T
mod has to be replaced with V H
mod
for the projection methods outlined in Section 4, where the subscript H represents the conjugate
transpose of a complex-valued matrix.

The goal of Krylov-based reduction is the approximation of the Laplace transformed transfer

function of the pH-system

H(s) = BT Q(sE − (J − D)Q)−1B
(42)
with the complex variable s ∈ C which is typically evaluated on the imaginary axis s = iω with the
circular frequency ω = 2πf where f denotes the excitation frequency.

The transfer function around an expansion point s0 can be described with a Taylor series whose
coeﬃcients are called moments in this context. The ﬁrst Jb moments of the full and reduced system
can be matched by using the block Krylov subspace of a pH-system

colsp(VKry) = KJb((A − s0E)−1E, (A − s0E)−1B).

(43)

The approach can be generalized to calculate for multiple expansion points [26].

The direct calculation leads to numerical issues since additional vectors can become linearly
dependent. That is why the block Arnoldi algorithm is used for the calculation of Krylov subspaces.
This Arnoldi algorithm consists of a LU decomposition, Gram-Schmidt orthogonalization and the
iterative calculation of Krylov directions [26]. Sometimes the approach is also called tangential
interpolation [12].

The Proper Orthogonal Decomposition (POD) approach uses a diﬀerent idea for the
projection basis generation which is based on snapshots instead of system matrices and can therefore

3https://www.itm.uni-stuttgart.de/software/morembs/software_morembs_matmorembs/
4https://www.morepas.org/software/rbmatlab/

15

even be used for nonlinear systems [39, 30]. The POD starts with a set of vectors ˆxi ∈ RN with
i = 1, . . . , m assembled column-wise into a matrix
ˆX := (cid:2) ˆx1

(44)

ˆxm

(cid:3) .

. . .

The goal is to approximate the information contained in the snapshot matrix ˆX by a set of vectors
ˆui ∈ RN with i = 1, . . . , n, which can be expressed in terms of an optimization problem

min
ˆu1,..., ˆun

k
(cid:88)

i=1

(cid:13)
(cid:13)
(cid:13)
ˆxi −
(cid:13)
(cid:13)
(cid:13)

n
(cid:88)

j=1

( ˆxT

i ˆuj) ˆuj

(cid:13)
2
(cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:13)

subject to

ˆuT

i ˆuj = δij

(45)

where δij describes the Kronecker delta and hence, the vectors ˆui form an orthonormal basis [39].

The optimization problem can be solved by solving the eigenvalue problem

ˆX ˆX T ˆui = λi ˆui
with the scaled correlation matrix ˆX ˆX T ∈ RN ×N which is computationally ineﬃcient to calculate
if m < N due to its size. Therefore, the method of snapshots solves the eigenvalue problem

(46)

ˆX T ˆX ˆvi = λi ˆvi

(47)

of size m × m with the eigenvectors ˆvi which saves computational time for m (cid:28) N [39, 22]. The
problem (46) then is solved by

ˆui =

1
√
λi

ˆX ˆvi.

(48)

(49)

By only taking the ﬁrst n POD-modes, the basis matrix can be formed as

VPOD( ˆX) := (cid:2) ˆu1

. . .

(cid:3) .

ˆun

In the present system, the snapshot matrix ˆX consists of state variables of the pH-system
x(t, µ) with µ ∈ [82, 320] Hz. The discrete trajectories that form the snapshot matrix are calculated
from the full system with time instances of ∆t = 10−4 s for a time span of T = 0.1 s. Using the
˙qT (cid:3)T for calculating, the POD basis will further be called as
full state vector x = (cid:2)zT qT
VPOD,State.

˙zT

Another basis will be generated by only using the displacements in the snapshot matrix
(cid:3) and assembling the

(cid:3) of the adapted state vector ˆxT

Disp,i = (cid:2)zT

i

qT
i

ˆXDisp = (cid:2) ˆxDisp,1
full projection matrix afterwards as

ˆxDisp,m

. . .

VPOD,Disp( ˆXDisp) =

(cid:20)VPOD( ˆXDisp)
0

(cid:21)
0
VPOD( ˆXDisp)

.

(50)

Note that the above is a special case of the so-called tangent lift as presented in [29], where only
information in the state is considered. Hence, using the basis for the velocity component might be
ill-suited.

A further approach will be the division of the state vector into the four individual parts and
calculating the POD-basis for each individual trajectory and assembling the basis as the block-
diagonal matrix

VPOD,Individual =


VPOD( ˆXz)

0


0

0

0
VPOD( ˆXq)
0
0

0
0
VPOD( ˆX ˙z)
0








.

0
0
0
VPOD( ˆX ˙q)

(51)

16

with the snapshot matrices ˆXz, ˆXq, ˆX ˙z and ˆX ˙q corresponding to the respective components of the
state x.

Symplectic MOR is structure-preserving MOR for Hamiltonian systems. One approach to derive
a symplectic reduced-order basis is the data-driven Proper Symplectic Decomposition (PSD)
which is closely related to the POD [29].

Assuming a suitable basis, a symplectic form ω2ˆn : R2ˆn × R2ˆn → R takes the canonical form

ω2ˆn(v1, v2) = vT
1

J2ˆnv2 ∀v1, v2 ∈ V with J2ˆn :=

(cid:21)

(cid:20) 0ˆn
Iˆn
−Iˆn 0ˆn

(52)

where J2ˆn is the Poisson matrix with the identity matrix Iˆn ∈ Rˆn×ˆn and the matrix of all zeros
0ˆn ∈ Rˆn×ˆn [33]. We call V ∈ R2 ˆN ×2ˆn a symplectic matrix if

If a Petrov-Galerkin projection is used with W T = V + where

V T J

2 ˆN V = J2ˆn.

V + = JT

2ˆnV T J

2 ˆN ∈ R2ˆn×2 ˆN

(53)

(54)

denotes the so-called symplectic inverse5, then the Hamiltonian structure and therefore its Hamilto-
nian is preserved for purely Hamiltonian systems, i.e. in the case of D = 0 in equation (15)[29, 10].

In analogy to the POD, the minimization problem appears as

(cid:107)(I2 ˆN − V V +) ˆX(cid:107)2

F

minimize
V ∈R2 ˆN ×2ˆn
subject to V T J

2 ˆN V = J2ˆn,

(55)

where the constraint guarantees that the reduced-order basis (ROB) is symplectic [29]. In contrast
to POD, there is no explicit solution procedure for the PSD optimization problem (55). The PSD
Complex SVD approach is the solution of the PSD in the subset of symplectic, orthonormal ROBs
[10]. It uses an adapted complex snapshot matrix

Cs = (cid:2) ˜xs

1 + i ˙˜xs

1

. . .

m + i ˙˜xs
˜xs
m

(cid:3) ∈ C ˆN ×m ˜xs

j =

(cid:21)

(cid:20)zj
qj

1 ≤ j ≤ m

(56)

with the imaginary unit i. The minimization problem requires an auxiliary complex matrix UCs ∈
C ˆN ×ˆn and takes the form

minimize
UCs ∈C2 ˆN ×2ˆn
subject to

and generates the real basis matrix

(cid:107)Cs − UCs(UCs)H Cs(cid:107)2
F

(UCs)H UCs = Iˆn

VCSVD :=

(cid:104)
(cid:101)E J

2 ˆN (cid:101)E

(cid:105)

,

(cid:101)E :=

(cid:21)

(cid:20)Re(UCs)
Im(UCs)

.

(57)

(58)

The specialty of the PSD Complex SVD is the choice of the auxiliary complex matrix Cs and the
computation of (cid:101)E from UCs. The solution of (57) is the POD for complex matrices based on the
left-singular vectors of Cs that can be computed with a complex version of the SVD [29].

5Please note, that this symplectic inverse should not be confused with the Moore-Penrose inverse, which sometimes

is denoted with the same symbol.

17

Most existing basis generation techniques, e.g. Complex SVD, generate a symplectic, orthonor-
mal ROB. In [10] a new symplectic, non-orthogonal basis generation technique based on the so-called
SVD-like decomposition is introduced.

There exists a SVD-like decomposition of the snapshot matrix ˆX ∈ R2 ˆN ×m

p

q

p

m−2p−q

ˆX = SsDsQs, Ds =












Σs 0
0
I
0
0
0
0
0
0 Σs
0
0
0
0
0
0
0












p

q
ˆN −p−q

p

q
ˆN −p−q

0
0
0
0
0
0

, Σs = diag(σ1, . . . , σp) ∈ Rp×p

(59)

with a symplectic matrix Ss ∈ R2 ˆN ×2 ˆN , a sparse and potentially non-diagonal matrix Ds ∈ R2 ˆN ×m,
an orthogonal matrix Qs ∈ Rm×m and the symplectic singular values σi. The rank of the snapshot
matrix is rank( ˆX) = 2p + q.

The Frobenius norm of the snapshot matrix can be rewritten as

(cid:107) ˆX(cid:107)2

F = Tr( ˆX ˆX T ) =

p+q
(cid:88)

(wi)2, wi =

i=1

(cid:40)

σi

(cid:113)

(cid:107)si(cid:107)2

2 + (cid:107)s ˆN +i(cid:107)2
2

(cid:107)si(cid:107)2,

1 ≤ i ≤ p

p + 1 ≤ i ≤ p + q

(60)

where si is the i-th column of Ss and wi is called the weighted symplectic singular value [10].

The goal is to choose the k indices i ∈ ISVD = {i1, . . . , ik} ⊂ {1, . . . , p + q} which have large

contributions wi to the Frobenius norm with

ISVD = argmax

(cid:32)

(cid:88)

(wi)2

(cid:33)

I⊂{1,...,p+q}
|I|=k

i∈I

(61)

which yields a ROB VSVD ∈ R2 ˆN ×2k with k pairs of columns si ∈ R2 ˆN from Ss leading to reduced
model order of 2k = n and the basis matrix

(cid:104)
si1

(cid:105)

VSVD =

. . . sik s ˆN +i1
The SVD-like decomposition is constructed by computing an eigendecomposition of ˆX T J ˆX, for
which the imaginary and real part of eigenvectors corresponding to complex conjugate eigenvalues
result in a pair of symplectic vectors. Alternatively, the approach introduced in [41] can be used.
However, we chose the former method, as the later one can be quite computationally demanding.

. . . s ˆN +ik

(62)

.

6 Results

The previous sections featured several alternatives for model order reduction of a classical guitar
FSI problem in a pH formulation. The diﬀerent components that were considered are the 4 system
formulations in Sec. 3.2, the 4 projection methods from Sec. 4 and the 7 basis generation methods
in Sec. 5, cf. Fig. 2. These categories are extended by choosing the reduced system size n, studying
11 sizes between n = 12 and n = 400 and the number of trajectories in the snapshot matrix for the
data-based methods, where 6 alternatives were investigated, see Tab. 2. All representatives of each
category can be combined with all others, resulting in a number of about 4 · 4 · 7 · 11 · 6 ≈ 7000
possible combinations. All of these combinations have been computed. We will give a focused view
onto the most important outcomes in the following sensitivity analysis.

18

6.1 Sensitivity analysis of different reduced-order models

In order to compare the diﬀerent methods for reducing the FOM to a reduced-order model (ROM),

cf. 11 , an error measure is needed. The energy norm of the Hamiltonian

(cid:107)x(t)(cid:107)2

H = x(t)T ET Qx(t)

(63)

is used to describe the energy value of a trajectory at time step t. The error ε(t) = (cid:107)x(t)−V xr(t)(cid:107)H
between the full and reduced model is measured in the energy norm. In order to obtain a scalar and
relative measure, the norm is integrated over the simulation time interval It = [0, tend] and related
to the full model which yields

(cid:82) tend
0

εr =

(cid:107)x(t) − V xr(t)(cid:107)H dt
(cid:82) tend
(cid:107)x(t)(cid:107)H dt
0

(64)

for the relative error measure. It is important to use the relative error which allows for a comparison
between diﬀerent system inputs. Five randomly chosen frequencies in the standard tuning range
(14) and zero initial conditions were used as system parameters for all experiments that were carried
out. The mean value of their relative error calculations is displayed in the subsequent results.

The relative error values for the four system formulations over all basis generation techniques
and for the pH and energy-stable projections are illustrated in Fig. 7.
It can be seen that the
displacement variant of POD is not a suitable option in the momentum formulation. This is due to
the fact that the state derivatives are not considered in the snapshot matrix and hence, the inertia
information gets lost. The canonical alternative for the velocity formulation (25) generally leads to
much higher errors and also in the momentum formulation the transformation (26) is not increasing
the performance. Furthermore, in the transformation process, the block structure of the pH matrices
E and Q (19) gets lost. The momentum formulation for both, canonical and non-canonical, leads
to the best overall results especially for POD-State and SVD-like. For these reasons, we will focus
on the non-canonical momentum formulation in the remainder.

The three best-performing methods from the previous experiment, i.e. POD-State, SVD-like
and POD-Individual, are compared more closely in Fig. 8. The plot shows the development of the
error of the three methods over the basis size and examines on the one hand the pH and energy-
stable projections, and on the other hand their behavior in relation to the best approximation with
respect to the energy norm, i.e. the FOM solution is projected onto the subspace spanned by the
corresponding basis matrix respecting the inner product pertaining to the energy norm (38). One
can see that the results of pH and energy-stable behave in a similar way for POD-State and SVD-
like but for POD-Individual, the energy-stable projection leads to much better error values. The
deviation concerning the best approximation does not exceed one order of magnitude for all basis
generation methods. The SVD-like method remains the closest to its potential best values for smaller
reduced sizes with increasing distance for higher basis size. This is due to numerical reasons as the
involved computation of the symplectic SVD-like decomposition is quite sensitive with respect to
the condition of the snapshot matrix. A comparison of the basis generation methods uncovers that
the SVD-like technique lies in the range of the best approximation error of the other methods and
shows an improvement of approximately one order of magnitude for several reduction dimensions
compared to the competitors. The overall behavior of all basis generation techniques (even the one
not shown in the plot) shows that the errors decay rapidly up to a size of n = 120 and stagnate
starting from a size of approximately n = 200.

The heat map in Fig. 9 shows the relative error for all combinations of basis generation tech-
niques and projection methods that were conducted, cf. 13 . The errors are shown for a basis size
of n = 120. If the relative error exceeds a value of εr > 1 then the ﬁeld entry is left blank.

19

pH

Energy–Stable

100

r
o
r
r
E
e
v
i
t
a
l
e
R

10−1

10−2

101

100

10−1

10−2

10−3

l
a
d
o
M

v
o
l
y
r
K

e
t
a
t
S
-
D
O
P

-

p
s
i
D
D
O
P

v
i
d
n
I
-

D
O
P

D
V
S
-
C

e
k
i
l
-

D
V
S

10−3

l
a
d
o
M

v
o
l
y
r
K

e
t
a
t
S
-
D
O
P

-

p
s
i
D
D
O
P

v
i
d
n
I
-

D
O
P

D
V
S
-
C

e
k
i
l
-

D
V
S

Vel

Mom

Vel_Canon

Mom_Canon

Figure 7: relative error of diﬀerent basis generation methods and system formulations for n = 120

POD-State POD-Indiv SVD-like

pH
Energy-Stable
Bestapprox

100

10−1

10−2

10−3

r
o
r
r
E
e
v
i
t
a
l
e
R

10−4

0

50

100

150

200
Basis Size n

250

300

350

400

Figure 8: relative error for three selected basis generation and projection methods in comparison with the

best approximation

20

Quasi

εr > 1

εr > 1

εr > 1

εr > 1

Energy-
Stable

pH

εr > 1

Galerkin

εr > 1

εr > 1

εr > 1

εr > 1

l
a
d
o
M

v
o
l
y
r
K

e
t
a
t
S
-
D
O
P

-

p
s
i
D
D
O
P

v
i
d
n
I
-

D
O
P

D
V
S
-
C

e
k
i
l
-

D
V
S

1

3.2 · 10−1

1 · 10−1

3.2 · 10−2

1 · 10−2

3.2 · 10−3

Figure 9: relative errors for diﬀerent basis and projection combinations for n = 120

One can see that the Galerkin and Quasi-Galerkin projection perform the worst. These pro-
jections do not preserve the pH properties, especially the stability conditions, leading to instability
and poor approximations. These projection methods are hence not suitable for the reduction of
pH-systems.
In general, the pH and energy-stable projection methods lead to the smallest error
because of their adaption to the speciﬁc underlying pH structure of the system, which shows the im-
portance of adapting the projection methods to the particular structure of the problem. The modal
reduction, which is still used in various commercial MOR-packages, leads to high errors compared
to the other combinations. The dynamics of the model cannot be described suﬃciently accurate by
only allowing to move in modal coordinates that belong to the lowest eigenfrequencies. The basis
generated with the C-SVD and Krylov algorithms lead to moderate approximation errors which, in
the case of the C-SVD, also cannot be improved by the transformation into the canonical structure
of the matrix J . The Krylov algorithm focuses on approximating the input-output behavior at
certain frequencies, leading to higher error at diﬀerent frequencies. The overall performance of the
remaining data-based methods worked the best for the FSI dynamics of the guitar except for the
POD-Displacement variant. The reason for the failure of the POD-Displacement has already been
explained above. For the POD-State variant, the information contained in the snapshot matrix and
extracted from this matrix via POD is suﬃcient for reproducing the coupled dynamics of the system.
On the other hand, it can also be advantageous to consider the coordinates separately in the basis.
The POD-Individual method outperforms the full-state alternative especially for the energy-stable
projection. This stems from the fact that the POD-Individual approach accounts for diﬀerent scal-
ings in the respective components. The SVD-like basis generation technique shows the best overall
performance with error values as low as εr = 3.2 · 10−3. The explanation for this lies in the structure
of the basis. The SVD-like approach is the only method that builds a non-orthogonal basis and can
therefore adapt more ﬂexibly to the system’s dynamics. Special attention should be paid here to the
fact that the SVD-like method was developed for purely Hamiltonian systems, whereas this study
shows that it is also suitable for port-Hamiltonian systems.

21

Table 2: Relative error of various basis generation methods over the number of trajectories from the snapshot
generation for the momentum formulation and n = 120. One trajectory refers to an excitation with
one speciﬁc frequency.

Number of Trajectories

Basis Generation

5

10

25

50

75

100

Modal
Krylov
POD-State
POD-Disp
POD-Indiv
Complex SVD
SVD-like

0.0527 no data-based method, εr for the sake of completeness
0.0293 no data-based method, εr for the sake of completeness
0.0044
0.0051
1
1
0.0093
0.0118
0.0207
0.0304
0.0017
0.0028

0.0047
1
0.011
0.0210
0.0021

0.0045
1
0.0114
0.0218
0.0018

0.0045
1
0.0104
0.0230
0.0022

0.0043
1
0.0101
0.0220
0.0017

It is worth mentioning that the information content in the snapshot matrices depends on the
number of underlying trajectories which are randomly distributed in the parameter space. In the
following study, trajectory numbers between ﬁve and 100 are investigated. The results of the associ-
ated relative errors are shown in Tab. 2 and are extended by the methods based on system matrices
for comparison. It can be seen that the inﬂuence of a high number of trajectories is not as signiﬁcant
as for instance the size of the reduced system, see Fig. 8. All methods extract enough information for
basis constructions even for small snapshot sizes. A snapshot matrix made of ten trajectories already
shows a good trade-oﬀ between approximation error and matrix size, which drastically decreases the
computational eﬀort in the oﬄine phase due to few evaluations of the full system.

The main goal of MOR is the gain of a speed-up compared to the simulation of the full-order
model to make this model suitable for multi-query tasks or real-time scenarios. The speed-up values
are determined for the pH projection method and averaged over all basis generation methods since
the qualitative behaviour for the other methods was similar. The results are listed in Tab. 3. The
greatest speed-up of 540 is obtained with a basis size of n = 12. This choice is not recommendable
since the error values are very high for this size. The speed-up values decrease down to 45 for a basis
size of n = 400. Depending on the requirements for the ROM, one needs to decide which is the best
trade-oﬀ between approximation quality and gained speed-up. Since the error decays fast up to a
size of n = 120 and still leads to speed-ups of more than 200, this reduction size was focused on in
the previous discussion.

Table 3: Averaged speed-up values for diﬀerent basis sizes for the pH projection

Basis Size
Speed-Up

12
540

40
455

80
340

160
180

320
68

400
45

In Fig. 10 and Fig. 11, the displacement in the excitation node and the averaged pressure in the
sound hole, cf. Fig. 5, are depicted. We can see in both cases, that all basis construction methods
except for POD-Displacement capture the behaviour quite well. For the POD-Displacement, how-
ever, almost no energy seems to be introduced into the system resulting in no visible excitation in
the entire FSI model.

22

·10−4

]

m

[

t
n
e
m
e
c
a
l
p
s
i
D

1.5

1

0.5

0

−0.5

−1

0

Full
POD-Disp

Modal
POD-Indiv

Krylov
PSD

POD-State
SVD-like

2 · 10−2

4 · 10−2

6 · 10−2

8 · 10−2

0.1

time [s]

Figure 10: time simulation of the excitation node displacement for the full and reduced-order models for

n = 120 in the momentum formulation and pH projection

]
a
P

[

e
r
u
s
s
e
r
P

10

5

0

−5

−10

0

Full
POD-Disp

Modal
POD-Indiv

Krylov
PSD

POD-State
SVD-like

2 · 10−2

4 · 10−2

6 · 10−2

8 · 10−2

0.1

time [s]

Figure 11: time simulation of the pressure integral over the sound hole for the full and reduced-order models

for n = 120 in the momentum formulation and pH projection

23

7 Conclusion and Outlook

In this paper, we presented a port-Hamiltonian formulation of a ﬂuid-structure interaction for the
case of a classical guitar. Many diﬀerent model order reduction approaches combined with multiple
diﬀerent reduced basis construction methods as well as various FOM formulations were compared
in order to study the eﬀect of structure-preserving model reduction on the quality and behaviour of
the reduced model. In particular, we were able to conclude that both structure-preserving model
order reduction methods, i.e. the pH-preserving and the energy-stable methods clearly outperform
their non-structure-preserving competitors. Furthermore, we can conclude that the reduced bases
constructed via a symplectic SVD-like decomposition result in higher quality approximations for
lower basis sizes.

Future emphasis will be placed on constructing suitable a-posteriori error estimators and ex-
tending the above model to allow for further parameter dependency in form of material parameters
of the guitar body.

Acknowledgements — Supported by Deutsche Forschungsgemeinschaft (DFG, German Re-
search Foundation) Project Nos. 314733389, 455440338, and under Germany’s Excellence Strategy -
EXC 2075 – 390740016. We acknowledge the support by the Stuttgart Center for Simulation Science
(SimTech).

References

[1] Abaqus. Abaqus Theory Manual. Abaqus, Inc, 2016.

[2] R. Altmann, V. Mehrmann, and B. Unger. Port-Hamiltonian formulations of poroelastic net-
work models. Mathematical and Computer Modelling of Dynamical Systems, 27(1):429–452,
2021.

[3] A. Antoulas. Approximation of Large-Scale Dynamical Systems. SIAM, Philadelphia, 2005.

[4] C. Beattie, V. Mehrmann, H. Xu, and H. Zwart. Linear port-Hamiltonian descriptor systems.

Mathematics of control, signals and systems, 30(4), Dec. 2018.

[5] C. A. Beattie, S. Gugercin, and V. Mehrmann. Structure-preserving interpolatory model re-

duction for port-Hamiltonian diﬀerential-algebraic systems, 2021.

[6] D. Blackstock. Fundamentals of physical acoustics. Wiley, New York, 2000.

[7] A. Brauchler, P. Ziegler, and P. Eberhard. Examination of polarization coupling in a plucked
musical instrument string via experiments and simulations. Acta Acustica, 4(3), 2020. paper
no. 9 (12 pages).

[8] A. Brauchler, P. Ziegler, and P. Eberhard. An entirely reverse-engineered ﬁnite element model
of a classical guitar in comparison with experimental data. The Journal of the Acoustical Society
of America, 149(6):4450–4462, 2021.

[9] T. Breiten, R. Morandin, and P. Schulze. Error bounds for port-Hamiltonian model and con-

troller reduction based on system balancing, 2020.

[10] P. Buchﬁnk, A. Bhatt, and B. Haasdonk.

Symplectic model order reduction with non-

orthonormal bases. Mathematical and Computational Applications, 24(2), 2019.

24

[11] H.-J. Bungartz and M. Schäfer. Fluid-structure interaction: modelling, simulation, optimisation,

volume 53. Springer Science & Business Media, 2006.

[12] A. Castagnotto. Optimal model reduction by tangential interpolation: H2 and Hinf perspectives.

Dissertation, Technical University Munich, Munich, 2018.

[13] S. Chaturantabut, C. Beattie, and S. Gugercin. Structure-preserving model reduction for non-
linear port-Hamiltonian systems. SIAM Journal on Scientiﬁc Computing, 38(5):B837–B865,
2016.

[14] O. Christensen. Quantitative models for low frequency guitar function. Journal of Guitar

Acoustics, 6:10–25, 1982.

[15] M. Ducceschi and S. Bilbao. Linear stiﬀ string vibrations in musical acoustics: Assessment and
comparison of models. The Journal of the Acoustical Society of America, 140(4):2445–2454,
2016.

[16] H. Egger, O. Habrich, and V. Shashkov. On the energy stable approximation of Hamiltonian

and gradient systems. Computational Methods in Applied Mathematics, 21(2):335–349, 2021.

[17] G. Everstine. A symmetric potential formulation for ﬂuid-structure interaction. Journal of

Sound and Vibration, 79(1):157–160, 1981.

[18] A. Ezcurra, M. Elejabarrieta, and C. Santamaría. Fluid–structure coupling in the guitar box:
numerical and experimental comparative study. Applied Acoustics, 66(4):411–425, 2005.

[19] A. Falaize and T. Hélie. Passive simulation of the nonlinear port-Hamiltonian modeling of a

Rhodes piano. Journal of Sound and Vibration, 390:289–309, 2017.

[20] J. Fehr, D. Grunert, P. Holzwarth, B. Fröhlich, N. Walker, and P. Eberhard. Morembs—a model
order reduction package for elastic multibody systems and beyond. In W. Keiper, A. Milde, and
S. Volkwein, editors, Reduced-Order Modeling (ROM) for Simulation and Optimization: Power-
ful Algorithms as Key Enablers for Scientiﬁc Computing, pages 141–166. Springer International
Publishing, Cham, 2018.

[21] R. Freund. Model reduction methods based on Krylov subspaces. Acta Numerica, 12:267–319,

2003.

[22] B. Haasdonk. Reduced basis methods for parametrized PDEs – a tutorial introduction for
stationary and instationary problems. In P. Benner, A. Cohen, M. Ohlberger, and K. Willcox,
editors, Model Reduction and Approximation: Theory and Algorithms, pages 65–136. SIAM,
Philadelphia, 2017.

[23] J. Hesthaven and C. Pagliantini. Structure-preserving reduced basis methods for Poisson sys-

tems. Mathematics of Computation, 90(330):1701–1740, July 2021.

[24] J. Hesthaven, C. Pagliantini, and N. Ripamonti. Structure-preserving model order reduction of

Hamiltonian systems. In preprint, Sept. 2021.

[25] C. Howard and B. Cazzolato. Acoustic Analyses Using Matlab® and Ansys®. Taylor & Francis

Group, 2017.

25

[26] M. Lehner. Modellreduktion in elastischen Mehrkörpersystemen (in German). Dissertation,
Schriften aus dem Institut für Technische und Numerische Mechanik der Universität Stuttgart,
Vol. 10. Shaker Verlag, Aachen, 2007.

[27] R. Lerch, G. Sessler, and D. Wolf. Technische Akustik - Grundlagen und Anwendungen. Springer

Berlin Heidelberg, Wiesbaden, 2009.

[28] V. Mehrmann and R. Morandin. Structure-preserving Discretization for Port-Hamiltonian De-

scriptor Systems. arXiv e-prints, page arXiv:1903.10451, Mar 2019.

[29] L. Peng and K. Mohseni. Symplectic model reduction of Hamiltonian systems. SIAM Journal

on Scientiﬁc Computing, 38(1):A1–A27, 2016.

[30] R. Pinnau. Model Order Reduction: Theory, Research Aspects and Applications, volume 13,
chapter Model Reduction via Proper Orthogonal Decomposition, pages 95–109. Springer Berlin
Heidelberg, Berlin, Heidelberg, 1 edition, 2008.

[31] R. Rashad, F. Califano, A. Schaft, and S. Stramigioli. Twenty years of distributed port-
Hamiltonian systems: a literature review. IMA Journal of Mathematical Control and Infor-
mation, 37, 07 2020.

[32] T. Richter. Fluid-structure interactions: models, analysis and ﬁnite elements, volume 118.

Springer, 2017.

[33] A. C. d. Silva. Lectures on Symplectic Geometry. Springer, Berlin, Heidelberg, 2008.

[34] F. Silva, T. Hélie, and W. Victor. Port-Hamiltonian Representation of Dynamical Systems.
Application to Self-Sustained Oscillations in the Vocal Apparatus. In P. du LMA, editor, 7th
Int. Conf. on Nonlinear Vibrations, Localization and Energy Transfer, volume 160, pages ISBN
978–2–909669–26–7, Marseille, France, June 2019.

[35] M. Tchonkova and S. Sture. Classical and recent formulations for linear elasticity. Archives of

Computational Methods in Engineering, 8:41–74, 01 2001.

[36] A. Tkachuk and M. Bischoﬀ. Variational methods for selective mass scaling. Computational

Mechanics, 52(3):563–570, 2013.

[37] A. van de Walle, F. Naets, E. Deckers, and W. Desmet. Stability-preserving model order
reduction for time-domain simulation of vibro-acoustic FE models. International Journal for
Numerical Methods in Engineering, 109(6):889–912, 2017.

[38] A. van der Schaft and D. Jeltsema. Port-Hamiltonian systems theory: An introductory overview.

Found. Trends Syst. Control, 1(2–3):173–378, June 2014.

[39] S. Volkwein. Proper orthogonal decomposition: Theory and reduced-order modelling. http:
//www.math.uni-konstanz.de/numerik/personen/volkwein/teaching/POD-Book.pdf, Aug
2013.

[40] T. Wolf, B. Lohmann, R. Eid, and P. Kotyczka. Passivity and structure preserving order
reduction of linear port-Hamiltonian systems using Krylov subspaces. European Journal of
Control, 16(4):401–406, Jul 2010.

[41] H. Xu. A numerical method for computing an SVD-like decomposition. SIAM J. Matrix

Analysis Applications, 26:1058–1082, 01 2005.

26

[42] O. C. Zienkiewicz, R. L. Taylor, and D. D. Fox. The Finite Element Method for Solid and

Structural Mechanics. Butterworth-Heinemann, Oxford, 7th edition, 2013.

[43] O. C. Zienkiewicz, R. L. Taylor, and J. Z. Zhu. The Finite Element Method – Its Basis &

Fundamentals. Butterworth-Heinemann, Oxford, 2005.

27

