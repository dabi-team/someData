2
2
0
2

t
c
O
0
2

]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[

3
v
2
9
5
1
1
.
7
0
2
2
:
v
i
X
r
a

Thermal half-lives of azobenzene derivatives: virtual
screening based on intersystem crossing using a machine
learning potential

Simon Axelrod,‚Ä†,‚Ä° Eugene Shakhnovich,‚Ä† and Rafael G¬¥omez-Bombarelli‚àó,‚Ä°

‚Ä†Department of Chemistry and Chemical Biology, Harvard University, Cambridge, MA, 02138
‚Ä°Department of Materials Science and Engineering, Massachusetts Institute of Technology, Cambridge,
MA, 02139

E-mail: rafagb@mit.edu

Abstract

Molecular photoswitches are the foundation of light-
activated drugs. A key photoswitch is azobenzene,
which exhibits trans-cis isomerism in response to light.
The thermal half-life of the cis isomer is of crucial im-
portance, since it controls the duration of the light-
induced biological eÔ¨Äect. Here we introduce a com-
putational tool for predicting the thermal half-lives
of azobenzene derivatives. Our automated approach
uses a fast and accurate machine learning potential
trained on quantum chemistry data. Building on well-
established earlier evidence, we argue that thermal iso-
merization proceeds through rotation mediated by in-
tersystem crossing, and incorporate this mechanism into
our automated workÔ¨Çow. We use our approach to pre-
dict the thermal half-lives of 19,000 azobenzene deriva-
tives. We explore trends and tradeoÔ¨Äs between barriers
and absorption wavelengths, and open-source our data
and software to accelerate research in photopharmacol-
ogy.

Introduction

Photoswitches are compounds whose properties can be
modiÔ¨Åed by light. They have applications in many de-
veloping technologies, such as organic electronics 1, en-
ergy storage 2, and targeted medicine 3. The latter in-
cludes photopharmacology, the Ô¨Åeld of light-activated
drugs. Such drugs are built around photoswitchable
scaÔ¨Äolds, which allows their medicinal activity to be
controlled with light. The most common scaÔ¨Äold is
azobenzene, which undergoes cis ‚Üî trans isomeriza-
tion in response to light. An inactive drug built around
azobenzene can be activated with light at certain times
or in certain regions of the body. This can minimize
oÔ¨Ä-target activity, thereby minimizing side eÔ¨Äects 3.

The development of photoactive drugs is a complex,
multi-objective optimization problem. A formidable
number of properties must be optimized for all drugs.

Photoactive compounds must also absorb light at the
right wavelength, typically in the near infrared region;
isomerize with high eÔ¨Éciency in the excited state; dis-
play diÔ¨Äerential bioactivity between the two isomers;
and thermally revert to the stable isomer in a speciÔ¨Åc
time frame 4. For many applications this time frame
should be as long as possible, and so the isomerization
barrier should be as high as possible 4. Yet substituents
that shift absorption from the UV to the visible or near-
IR regions often lower the thermal barrier 4. This high-
lights the challenge of the optimization problem.

The design of photoactive drugs can be accelerated
with computational modeling. Property predictors can
be applied to large virtual libraries, and the results can
be used to narrow the search space of promising com-
pounds 5. Quantum chemistry can predict many prop-
erties with good accuracy, but the calculations are quite
slow. In our previous work, we showed how a machine
learning (ML) potential trained on quantum chemistry
data can be used to rapidly predict the quantum yield
of azobenzene derivatives 6. In this work we develop an
ML-based computational workÔ¨Çow to predict the ther-
mal half-lives of azobenzene derivatives.

Our contributions are as follows. First, we improve
the theory of thermal azobenzene isomerization. In par-
ticular, we provide evidence that thermal isomerization
proceeds through intersystem crossing, not through a
typical singlet transition state (TS). This builds on the
theory that was proposed nearly twenty years ago 7, but
which has largely been overlooked (with some excep-
tions 8,9). We also demonstrate the critical importance
of multireference eÔ¨Äects in barrier calculations.

Second, we provide a fast and user-friendly compu-
tational tool for predicting the barriers and absorp-
tion wavelengths of azobenzene derivatives. Our pro-
gram can be run with a single command. The only
user input required is the SMILES strings of the rele-
vant compounds. These can be generated programati-
cally, or with visual interface programs such as Chem-
Draw. Further, the program is quite fast, replicating

1

 
 
 
 
 
 
Figure 1: Possible mechanisms of thermal isomerization. The inversion TS has Œ± or Œ±(cid:48) ‚âà 180‚ó¶, while the rotational
TS has œâ ‚âà 90‚ó¶.
Inversion-assisted rotation combines inversion and rotation. Concerted inversion combines Œ±
inversion and Œ±(cid:48) inversion.

the results of spin-Ô¨Çip, time-dependent density func-
tional theory (SF-TDDFT) 10 in milliseconds through
use of a transferable ML potential. This program adds
to the growing collection of computational models for
predicting photoswitch properties 6,11‚Äì13. Our software
and pre-trained models are freely available at https:
//github.com/learningmatter-mit/azo_barriers.

Third, we use our tool to perform virtual screen-
ing of nearly 19,000 hypothetical azobenzene deriva-
tives. We identify species with high isomerization barri-
ers and redshifted absorption spectra. The data is freely
available at https://doi.org/10.18126/unc8-336t
through the Materials Data Facility 14,15. Researchers
can use the species with favorable properties as scaÔ¨Äolds
for new photoactive drugs. Further, we explain these re-
sults in terms of substitution patterns and substituent
properties. These insights will accelerate the design of
meta-stable, red-shifted azobenzene derivatives in the
future.

Theory and methods

Isomerization mechanisms

Four mechanisms have been proposed for azobenzene
isomerization 16: rotation, inversion, inversion-assisted
rotation, and concerted inversion (Fig. 1). Rotation is
characterized by œâ ‚âà 90‚ó¶ and Œ± ‚âà Œ±(cid:48) ‚âà 120‚ó¶. Both in-
version mechanisms have Œ± ‚âà 180‚ó¶ and Œ±(cid:48) ‚âà 120‚ó¶; pure
inversion has œâ ‚âà 180‚ó¶, while inversion-assisted rotation
has œâ ‚âà 90‚ó¶. (Some works refer to inversion-assisted ro-
tation simply as rotation 11, but we avoid that terminol-
ogy here.) Concerted inversion has Œ± ‚âà Œ±(cid:48) ‚âà 180‚ó¶, but
can be excluded from possible thermal mechanisms; see
Supporting Information (SI) Sec. S11.1. Here we group
together inversion and inversion-assisted rotation, and
refer to both as inversion (SI Sec. S11.2). For asym-
metrically substituted azobenzenes, Œ± = 180‚ó¶ is distinct
from Œ±(cid:48) = 180‚ó¶, and œâ = 90‚ó¶ is distinct from œâ = ‚àí90‚ó¶.
This gives two inversion TSs and two rotational TSs.

Standard models

lifetimes
Several works have predicted the thermal
of azobenzene derivatives with computational meth-
ods 11,12,17‚Äì20. However, there are two main issues with
previous calculations. First, all levels of theory overes-
timate the experimental enthalpy and entropy of acti-
vation. The experimental activation entropy is ‚àí50.2
J mol‚àí1K‚àí1 21, while Hartree-Fock, MP2, CC2, and
DFT with 12 diÔ¨Äerent functionals predict values be-
tween +7 and +30 J mol‚àí1K‚àí1 19. At room temper-
ature, the experimental entropic contribution to ‚àÜG‚Ä† is
then ‚àíT ‚àÜS‚Ä† = +3.6 kcal/mol, while the computational
contribution is between ‚àí0.5 and ‚àí2 kcal/mol. Most of
the error persists even after corrections to the harmonic
approximation 19.

Each method also overestimates ‚àÜH ‚Ä†. The experi-
mental activation enthalpy is 21.1 kcal/mol 21; B3LYP-
D3/6-311++G* predicts 25.2 kcal/mol, and CC2/aug-
cc-pVTZ predicts 32.8 kcal/mol 19. CASPT2(10,8)/6-
31G* gives ‚àÜE‚Ä† = 31.0 kcal/mol 22, which is nearly
identical to CC2/aug-cc-pVTZ 19.

The errors in ‚àÜH ‚Ä† and ‚àíT ‚àÜS‚Ä† partially cancel for
‚àÜG‚Ä†. Indeed, recent work has extensively benchmarked
diÔ¨Äerent levels of theory for predicting ‚àÜG‚Ä† of various
azoarenes, and found errors near 1 kcal/mol for B3LYP-
D3 with some basis sets 11. However, given the signiÔ¨Å-
cant error cancellation for ‚àÜG‚Ä†, and the underestima-
tion of ‚àÜH ‚Ä† relative to correlated wavefunction meth-
ods, these results should be interpreted with caution.

The second issue concerns the rotational mechanism.
Ref. 17 investigated several azobenzene derivatives using
B3LYP/6-31G*. The authors found that inversion was
generally preferred over rotation, but that rotation was
preferred for some push-pull azobenzenes in polar solu-
tion. However, Ref. 19 could not optimize the rotational
TS with B3LYP. We have also reproduced this Ô¨Ånding
for various derivatives. It is troubling that rotation can
be energetically favored, yet the rotational TS cannot
be reached through DFT optimization.

2

NNinversionrotationinversion-assisted rotationconcerted inversionNNùõºùõº‚Ä≤ùúîNNNNcistransNNNNis the likely cause of the failed rotational TS optimiza-
tions with standard DFT. Multi-reference methods, by
contrast, produce smooth maxima. We note that the in-
version TS is also close to a conical intersection 7, which
further reinforces the need for a multi-reference treat-
ment of azobenzene TSs.

SF-TDDFT accounts for multi-reference eÔ¨Äects while
oÔ¨Äering a reasonable balance between cost and accuracy.
Empirically it has sub-cubic scaling 6, which makes it
far more aÔ¨Äordable than highly accurate spin-Ô¨Çip cou-
pled cluster methods that scale as N 7 28. Further, as
shown in SI Sec. S12, SF-TDDFT has similar errors to
CASPT2 for rotational barriers in azobenzene. The lat-
ter scales as N 5 for a Ô¨Åxed active space, requires manual
active space selection, and does not have analytic gra-
dients in most quantum chemistry packages, which are
essential for training ML potentials. While SF-TDDFT
is not spin-complete, we have found that S0 spin con-
tamination is rather low. As discussed in SI Sec. S8.1,
the average square spin in the S0 state is only 0.16, and
we excluded all data with square spin exceeding 1.0.
Lastly, the errors in SF-TDDFT are largely systematic,
as demonstrated by the strong correlation between pre-
dicted and experimental activation free energies in Fig.
4. This is discussed further in the Results section below.

Computational workÔ¨Çow

Standard quantum chemistry approaches are rather
slow. To address this and the above issues, we de-
velop an ISC workÔ¨Çow based on ML potentials 29 that
are trained on multi-reference SF-TDDFT data.

We generate initial TSs through a relaxed scan, and
reÔ¨Åne the structures with a conformer search 30‚Äì32 and
eigenvector following (EVF, Fig. 3(b)). We then use the
intrinsic reaction coordinate (IRC) 33 to locate singlet-
triplet crossings on either side of each rotational TS.
The geometries are subsequently reÔ¨Åned with a mini-
mum energy crossing point (MECP) optimization (SI
Sec. S3.5). We also apply Eyring TS theory to the TSs
and compare the results to the ISC approach.

Four relaxed scans are performed for each of the four
mechanisms (two inversion and two rotation). Con-
formers are generated for each TS guess using a con-
formational search with Ô¨Åxed CNNC atoms. The Ô¨Åve
lowest-energy conformers for each mechanism are then
optimized with eigenvector following, yielding 20 TSs.
The TS with the lowest free energy for each rotational
mechanism is used to Ô¨Ånd the singlet-triplet crossings.
ISC does not occur for the inversion mechanism 7.

Once the workÔ¨Çow is completed, the ISC-based reac-

tion rate is calculated as

kX = kISC exp (cid:0)‚àí‚àÜGX/kBT (cid:1) ,

(1)

where G is given in SI Eqs. (S11)-(S15). ‚àÜGX depends
on the energies, conformer ensembles, and vibrational
frequencies of both the reactant and the crossing geom-
etry. We compute kISC using the approach in Ref. 34,

Figure 2: Schematic of triplet-mediated thermal isomer-
ization. Intersystem crossing from singlet (S0) to triplet
(T1) occurs near œâ = 70‚ó¶. The energy is lower at the
crossing point than at the S0 TS (‚àÜEX < ‚àÜE‚Ä†). Re-
crossing from T1 to S0 then occurs near œâ = 105‚ó¶, and
isomerization is completed on the S0 surface.

Intersystem crossing

To address the overestimation of ‚àÜS‚Ä† and ‚àÜH ‚Ä† com-
mon to all levels of theory, we advocate intersystem
crossing (ISC) as the mechanism of thermal isomer-
ization (Fig. 2). This was proposed in Ref. 7 nearly
20 years ago. As discussed below, ‚àÜG‚Ä† is replaced
with ‚àÜGX, the free energy diÔ¨Äerence at the singlet-
triplet crossing geometry X. The rate prefactor kBT /h
is replaced with the ISC rate kISC. Since the cross-
ing geometry has a lower energy than the TS, this
approach corrects the overestimation of ‚àÜH ‚Ä†. Fur-
ther, the measured ‚àÜS‚Ä† is not a true activation en-
tropy, but in fact related to both log[kISC/(kBT /h)]
and ‚àÜSX (SI Eq. (S28)). The negative value of ‚àÜS‚Ä†
partly reÔ¨Çects the fact that kISC < kBT /h. Computing
kISC with CASPT2(14,12)/6-31G* yields good agree-
ment with the eÔ¨Äective experimental activation entropy,
‚àÜSeÔ¨Ä , for unsubstituted azobenzene 7.

We note, however, that isomerization can still pro-
ceed through S0 for certain derivatives and environ-
ments, and that the S0 rate should be compared to
the triplet-mediated rate for any new system. Indeed,
Ref. 23 found good agreement between the S0 CASPT2
rate and the experimental rate for phototrexate in
DHFR, though no comparison was made to the experi-
mental activation entropy. For this reason we compute
the rate with both Eyring TS theory and ISC for all
molecules in this work.

Multireference eÔ¨Äects

To properly optimize the rotational TS, we show that it
is critical to include multi-reference eÔ¨Äects. This is not
surprising, since there is a conical intersection when œâ
is close to 90‚ó¶ 24.
In this work we use SF-TDDFT 10,
since it accounts for some double excitations and gen-
erally provides an accurate description of conical inter-
sections 25. We use the common BHHLYP functional 26
and 6-31G* basis 27. As shown in SI Sec. S12, single-
reference methods produce rotational TS cusps. This

3

Œîùê∏!Œîùê∏‚Ä†ùëá"ùëÜ#0‚àò180‚àò90‚àòùê∏ùúîFigure 3: Approach to active learning and TS generation used in this work. (a) Active learning loop for training the
NN. (b) WorkÔ¨Çow for generating equilibrium and TS geometries. ‚Äúconfgen‚Äù stands for conformer generation, which
is described in SI Sec. S3.2. ‚ÄúS-T MECP‚Äù denotes the search for the minimum-energy singlet-triplet crossings on
each side of the TS.

as described in SI Sec. S4. The expression depends on
the spin-orbit coupling, temperature, and forces on the
singlet and triplet surfaces at the crossing. The spin-
orbit coupling is taken as constant, HSO ‚âà 20 cm‚àí1, as
described in SI Sec. S4. The coupling is about 20 times
larger than the typical value for planar aromatic com-
pounds, because of the n ‚àí œÄ‚àó character of the triplet
state 7. This corresponds to a 400-fold enhancement in
the ISC rate.

We also compute the reaction rate from Eyring TS

theory, given by

kTST =

kBT
h

exp (cid:0)‚àí‚àÜG‚Ä†/kBT (cid:1) .

(2)

For ease of comparison we convert ISC-based reaction
rates into the form of Eq. (2), where ‚àÜG‚Ä† is replaced
by the eÔ¨Äective activation free energy,

‚àÜGeÔ¨Ä = ‚àíkBT log

(cid:19)

(cid:18) hkX
kBT
1
2

= ‚àÜH X ‚àí T ‚àÜSeÔ¨Ä ‚àí

kBT.

(3)

‚àÜSeÔ¨Ä depends on both kISC and ‚àÜSX, and is given in
SI Eq. (S28).

ML models

We train separate models to predict the S0 energy,
T1 energy, and S0/S1 gap. Our models use the
PaiNN architecture 35, which predicts molecular prop-

4

erties through equivariant message-passing. This ap-
proach generates a feature vector for each atom that
incorporates information from its surrounding environ-
ment. The initial feature vector is generated from the
atomic number alone, and is then updated through a
set of ‚Äúmessages‚Äù. These messages incorporate the dis-
tance, orientation, and features of atoms within a cut-
oÔ¨Ä distance. The messages are then used to update
the atomic feature vectors. This is performed several
times, which leads to information being combined from
increasingly distant atoms. Lastly, the atomic features
are mapped to per-atom energies using a neural net-
work, which are summed to yield the molecular energy.
The forces are computed through automatic diÔ¨Äerenti-
ation of the energy.

We pre-train the models on 680,736 gas-phase SF/6-
31G* calculations from non-adiabiatc molecular dynam-
ics (NAMD), which were previously generated in Ref. 6.
We then reÔ¨Åne the models using approximately 40,000
SF/6-31G* calculations with a C-PCM model of wa-
ter 36‚Äì38. Pre-training on existing gas-phase data means
that fewer new solvent calculations are required to reach
a target accuracy 39.

The geometries for SF-TDDFT/C-PCM calculations
are generated through active learning 6,39,40 based on
our TS workÔ¨Çow (Fig. 3).
In each round of active
learning, we train three S0 models on previous SF-
TDDFT/C-PCM data (the gas-phase model is used in
the Ô¨Årst round). The diÔ¨Äerence in model predictions
is used to identify geometries that are poorly described
by the model. These high-uncertainty conÔ¨Ågurations,

$!%!&!"+updatemessage++$!%!&!"+updatemessage++ba!ùêªùúì=ùê∏ùúì‚Éóùëì=‚àí‚àá!ùê∏neural network committeequantum chemistrydatabaseNAMDpre-training ‚Ä¶TS generationTS generation√ó4mechanismsYNNXYXYNNXYXenergy, uncertainty-based selection?TS guesstranscisoptimized TSTSensembleEVFNN confgenNN confgenNN confgenRDKitconfgencisSMILESRDKitconfgentransSMILEStrans ensemblerelaxed scancis ensembleIRCS-TMECP Table 1: Model performance for 334 species outside the training set. Units are kcal/mol for energies and kcal/mol/ÀöA
for forces. Forces are denoted by (cid:126)F .

Geometry type

Model type

Optimized TSd

TS metadynamicsg

One model
Ensemblee
Ensemble, lowest 95% uncertaintyf
One model
Ensemble
Ensemble, lowest 95% uncertainty

Singlet ‚àÜE
errora
0.81
0.73
0.66
1.09
0.99
0.86

Triplet ‚àÜE
errorb
0.23
0.19
0.16
0.34
0.31
0.27

Singlet (cid:126)F
error
0.44
0.34
0.31
0.69
0.54
0.49

Triplet ‚àÜ (cid:126)F
errorc
0.48
0.44
0.42
0.55
0.50
0.48

a Singlet ‚àÜE = E ‚àí Ecis, where Ecis is the energy of the lowest energy cis conformer.
b Triplet ‚àÜE = ES ‚àí ET, where ES is the singlet energy and ET is the triplet energy.
c Triplet ‚àÜ (cid:126)F = (cid:126)FS ‚àí (cid:126)FT.
d Four TSs per species, one for each mechanism.
e Three models.
f Uncertainty computed as the standard deviation of the three model predictions.
g Geometries randomly sampled from NN metadynamics for TS conformer generation. Five geometries were sampled for each species.

together with some geometries that are sampled ran-
domly or by energy, receive new quantum chemistry
calculations (see SI Sec. S1).

Results

Model performance

The model accuracy is shown in Table 1. Mean abso-
lute errors (MAEs) are given for the singlet and triplet
models, for both optimized TSs and oÔ¨Ä-equilibrium ge-
ometries sampled during TS conformer generation (see
SI Sec. S3.2). All geometries come from species outside
the training set.

The model performance is excellent. The error in the
barrier energy, ‚àÜE = ETS ‚àí Ecis, is 0.81 kcal/mol for
one model and 0.73 kcal/mol for an ensemble of three
models. The ensemble error falls to 0.66 kcal/mol after
excluding the top 5% most uncertain geometries. These
errors are far below 1.0 kcal/mol, which is the typical
deÔ¨Ånition of chemical accuracy. The model error is sig-
niÔ¨Åcantly smaller than the SF-TDDFT error (SI Sec.
S12).

The force predictions are similarly accurate, with
MAEs below 0.45 and 0.7 kcal/mol/ÀöA for optimized
and distorted TSs, respectively. The performance of
the triplet model is even better, with errors that are
four times lower than that of the singlet model. Lastly,
the S0/S1 gap model has an MAE of 0.68 and 2.35
kcal/mol for optimized cis and trans geometries, re-
spectively. These are errors of 3.8 and 13.1 nm for a
typical absorption wavelength of 400 nm.

Comparison to experiment

The predicted and experimental activation free energies
are compared in Fig. 4. The experimental data come
from Refs. 17,18,20,41‚Äì47, and can be found in the Ô¨Åle con-
taining the virtual screening results. 26 measurements

were accessed in total, and 17 of these were used in Fig.
4. We only used the measurements performed in solvent
with dielectric constant Œµ ‚â• 30. Our model was trained
on implicit solvent calculations using Œµ = 78.4 for wa-
ter. However, we found that the quantum chemistry
energies were quite similar when using Œµ = 30, and so
included these measurements in the benchmark as well.
The results of TS and ISC theory are shown in panels
(a) and (b), respectively. The rotation mechanism was
favored in TS theory for all compounds shown, and so
panel (a) equivalently shows ‚àÜG‚Ä† from rotation. Panel
(c) shows the results of TS theory when considering only
the two inversion mechanisms.

The correlation with experiment is quite good for
both TS and ISC theory. Both have Spearman rank
coeÔ¨Écients œÅ near 0.6, and both have R2 near 0.7 after
linear regression. The MAEs after regression are 0.79
and 0.85 kcal/mol for TS and ISC theory, respectively.
When including all 26 measurements performed in any
solvent, we Ô¨Ånd that œÅ actually increases to 0.67 for
both methods. R2 falls to 0.58 and 0.63 for TS and ISC
theory, respectively. The respective MAEs climb to 0.92
and 0.97 kcal/mol.

The species are properly separated into low-,
medium-, and high-barrier groups in Fig. 4. For exam-
ple, species 1 and 2 are predicted to have low barriers,
the Ô¨Çuorinated derivatives 4-6 to have high barriers,
and azobenzene to lie in the middle. The models even
have some success comparing Ô¨Çuorinated derivatives to
each other, with œÅ = 0.33 and 0.42 among these species
for ‚àÜG‚Ä† and ‚àÜGeÔ¨Ä , respectively. However, the two
approaches give R2 = 0.02 and 0.04, respectively. This
means that the numerical error is close to that of a
random predictor, even though the rankings are better
than random.

Both approaches overestimate the barriers, on aver-
age by 4.94 and 3.76 kcal/mol for TS theory and ISC,
respectively. However, the overestimation is largely sys-
tematic, as demonstrated by the high R2 value after

5

Figure 4: Experimental vs. predicted activation free energies. Dotted orange lines are linear regression results from
predicted to experimental values. œÅ denotes the Spearman rank correlation. R2 is computed between the regression
results and the experimental data. Error bars are the standard deviation of the energy predictions from three models.
(a) Prediction accuracy using TS theory. (b) Prediction accuracy using intersystem crossing. (c) As in (a), but with
only the inversion mechanism. (d) Selected compounds highlighted in panels (a)-(c).

linear regression. Further, it is a consequence of SF-
TDDFT, not the models. Indeed, as shown in SI Sec.
S12, ‚àÜH is well-reproduced by the accurate and expen-
sive method SF-EOM-CCSD(dT) 28. SF-TDDFT over-
estimates ‚àÜH with respect to both experiment and SF-
EOM-CCSD(dT). Transfer learning to this higher level
of theory could therefore be of interest in the future.

‚àÜGeÔ¨Ä is lower than ‚àÜG‚Ä† on average, but otherwise
their trends are quite similar. One reason is that rota-
tion is the predicted mechanism for all species. Since
each singlet-triplet crossing is on either side of a rota-
tional TS, its energy is correlated with that of the TS.
Indeed, the correlation between the two methods is near
unity, with œÅ = 0.97 and R2 = 0.98. This reÔ¨Çects the
fact that E‚Ä†
rot ‚àí EX and kISC are nearly constant among
diÔ¨Äerent species. However, we explain below that no-
ticeable diÔ¨Äerences arise when screening large virtual
libraries.

The approaches‚Äô strong performance should be con-
trasted with TS theory using only inversion. These re-
sults are shown in panel (c). The performance is far
worse than using rotation or ISC, with R2 reduced by
over 50%, and œÅ reduced by over 35%. The MAEs after
regression are 1.24 kcal/mol for polar solvents and 1.43
kcal/mol for all data. Note that most works with DFT
have only produced inversion TSs. This is likely because
of failed rotation optimizations, which we attribute to
the single-reference nature of DFT and the associated
TS cusps (SI Sec. S12). Similar diÔ¨Éculties were found
in Ref. 9. Our results highlight the importance of rota-
tion and multi-reference eÔ¨Äects.

Note that all species in Fig. 4 were in the train-

ing set. Hence the comparison to experiment does not
measure the model‚Äôs ability to generalize to new com-
pounds. Rather, it mainly measures the reliability of the
workÔ¨Çow and the underlying quantum chemistry. The
models‚Äô ability to generalize to new species was shown
in Table 1.

Virtual screening

With reliable models and predictive workÔ¨Çows, we next
screened a virtual library of azobenzene derivatives for
key properties in photopharmacology. We ran the work-
Ô¨Çow of Fig. 3(b) for 25,000 compounds in all. The
compounds were generated using the common litera-
ture substitution patterns in Fig. 7(d), folllowing the
approach of Refs. 6,48. The substituents are a combi-
nation of literature groups and basic chemical moieties,
and can be found with the screening results online. Af-
ter applying various Ô¨Ålters, such as the right number
of imaginary frequencies, converged TSs for all mecha-
nisms, and the proper IRC endpoints, we were left with
19,000 species in total (see SI Sec. S9).

Distributions

Figure 5(a) shows the distribution of ‚àÜGeÔ¨Ä from this
screen. The mean and median are 29.6 and 29.7
kcal/mol, respectively, while unsubstituted azobenzene
has a value of 28.9 kcal/mol. The average derivative
is thus more kinetically stable than azobenzene. The
standard deviation of is 2.6 kcal/mol, which is a factor
of 80 in the isomerization rate. 39% of species (7,400)

6

dOONNNNNNONHNNHNONNOOHNOFNNFONHOOFFFFNNFFFFOOFNNFFFbca123456Figure 5: Distribution of various quantities among the 19,000 screened derivatives. (a) EÔ¨Äective activation free
energy. (b) EÔ¨Äective activation entropy. (c) Model uncertainty in the singlet-triplet gap at MECPs. (d)-(e) As in
(a)-(b), but using TS theory. (f) Model uncertainty in the activation energies.

have a lifetime that is over 10√ó that of azobenzene;
19% (3,600) have a lifetime that is less than 1/10th. We
conclude that the lifetime is highly tunable using the
substitutions in this work.

Panel (b) shows the eÔ¨Äective activation entropy. The
mean is ‚àí24.5 J / mol K and the median is ‚àí26.9 J
/ mol K. The calculated and experimental values for
azobenzene are ‚àí29.0 J / mol K and ‚àí50.2 J / mol
K 21, respectively. The associated error in the entropic
free energy is 1.5 kcal/mol. Using the TS approach gives
‚àÜS‚Ä† = 4.7 J / mol K, which has a much higher entropic
free energy error of 3.9 kcal/mol. Few other derivatives
have experimental activation entropies, and of those
that do, most have values near that of azobenzene.
However, of the few with values far from azobenzene,
none were predicted accurately by the model 20,47,49.
These cases should be investigated in more detail in the
future.

Panels (d) and (e) are analogous to (a) and (b), but
with TS theory instead of the ISC approach. Each dis-
tribution resembles its partner from ISC theory. How-
ever, ‚àÜG‚Ä† is more asymmetric than ‚àÜGeÔ¨Ä , with a much
steeper drop-oÔ¨Ä for higher barriers. The reason is as
follows. Within TS theory using SF-TDDFT in wa-
ter, rotation is more often the preferred mechanism (SI
Sec. S6). However, inversion can become preferred for
species with high enough rotation barriers. This mech-
anism is not available in ISC theory, since T1 is always
higher than S0 during inversion. Hence inversion lowers
the high barriers in TS theory, but cannot do the same
in ISC theory.

In principle one should calculate both ‚àÜG‚Ä† and
‚àÜGeÔ¨Ä , and use the lower value for the reaction rate. If
‚àÜG‚Ä†
inv were low enough, it would replace ‚àÜGeÔ¨Ä in the
high barrier regime, and so the steep drop-oÔ¨Ä of panel
(d) would be observed. However, as discussed in SI Sec.

S6, SF-TDDFT is not accurate enough to compare ab-
solute ‚àÜG‚Ä† and ‚àÜGeÔ¨Ä directly. Hence a more accurate
treatment of this problem would be of interest in the
future.

Panels (c) and (f) show the model uncertainty in the
MECP singlet-triplet gap and the activation energy, re-
spectively. Both are quite low, indicating high model
conÔ¨Ådence for the derivatives studied here. The mean
uncertainties are 0.21 kcal/mol and 0.41 kcal/mol for
the singlet-triplet gap and activation energy, respec-
tively. This is consistent with the error trends in Table
1. The uncertainty should be interpreted with caution,
however, as neural network ensembles tend to be over-
conÔ¨Ådent 50. Large uncertainty necessarily means high
error, as demonstrated by the error reduction in Ta-
ble 1 when excluding the most uncertain geometries;
however, low uncertainty does not guarantee low error.
A more detailed examination of uncertainty, including
calibration to the observed error and use of diÔ¨Äerent
architectures in the ensemble, is left to future work.

Targeting desired properties

Absorption wavelength and thermal stability are two
key properties in the design of photoactive drugs. The
preferred absorption range is generally 650 to 900 nm,
since human tissue is transparent only in this narrow
region of the near-IR 4. For photoactive drugs one typ-
ically wants the isomerization barrier to be as high as
possible, so that the unstable isomer is active for as long
as possible. For ion channel blockers, by contrast, the
target lifetime is usually milliseconds 51. For reference,
the half-life of azobenzene is 4 hours in acetonitrile at
60‚ó¶ C 18. Here we use the screening results to identify
redshifted derivatives with high or low barriers.

Figure 6 shows combinations of Œªcis, Œªtrans, and
‚àÜGeÔ¨Ä , where Œªi is the absorption wavelength of iso-

7

defabcFigure 6: Absorption wavelengths and thermal barriers. (a) Trans vs. cis and absorption wavelengths. (b), (c)
‚àÜGeÔ¨Ä vs. cis and trans absorption wavelengths, respectively. (d), (e) The two compounds of interest. For each
panel the graph is shown on the left, followed by the cis geometry, the singlet-triplet crossing closer to cis, the TS,
and the trans geometry. Model and quantum chemistry (QC) predictions are shown below. The compounds are
circled in panels (a)-(c).

mer i. We found that trans is the more stable isomer
for 99.6% of all species. The stable isomer is usually
the one activated by light, and so Œªtrans is usually the
quantity of interest. Panels (a) and (c) show that red-
shifting to the near-IR is quite diÔ¨Écult. Out of 19,000
compounds, only Ô¨Åve have Œªtrans > 600 nm. Of these,
only one has a barrier greater than that of azobenzene.
There are 1,641 species with Œªtrans > 500 nm (8.7%),
including 475 with a barrier greater than azobenzene
(2.5%). However, the majority of predictions over 500
nm are signiÔ¨Åcant overestimates. As discussed below,
most are actually closer to 470 nm.

Two redshifted species are shown in panels (d) and
(e). Compound 7 has a high barrier and compound
8 has a low barrier (top and bottom, respectively).
We conÔ¨Årmed these predictions using single-point SF-
TDDFT calculations. The quantum chemical activation
free energies are shown below the model predictions,
and the two agree quite well. We used the model re-
sults for the quasi-harmonic and conformational contri-
butions to the enthalpy and entropy, since a numerical
Hessian with SF-TDDFT would be prohibitively expen-
sive.

While the barriers agree quite well with SF-TDDFT,
the trans absorption wavelengths are overestimated.
For example, the predicted and true wavelengths are 567
nm and 467 nm for compound 7, and 574 and 533 nm for
compound 8. Moreover, this latter result is somewhat
suspect, since the Ô¨Årst excited state with SF-TDDFT
has square spin (cid:104)S2(cid:105) = 1.2, indicating high spin contam-
ination. Indeed, a restricted TDDFT calculation with
the œâB97X-D3 functional 52 and the def2-SVP basis 53
yielded Œªtrans = 470 nm. These results are common:
after performing calculations for the 40 species with the
highest trans absorption wavelengths, we found that all
had either true values around 470 nm, or had signiÔ¨Åcant
spin contamination leading to untrustworthy results.

We note that while the S1 spin contamination was
severe for some species with ultra-high absorption wave-
lengths, it was otherwise low in general. Indeed, the av-
erage square spin of the S1 state was 0.37 in the training
set. This is higher than the mean value of 0.16 for the S0
state, but still reasonable. The maximum (cid:104)S2(cid:105) allowed
in the training set was 1.5 for the S1 state. To avoid any
S1 spin contamination, one could always Ô¨Åne-tune the
model with a small dataset of excitation energies from

8

abcdH2NSNOOHNNNOHONH2SùúÜ!"#=414 nmùúÜ!"#=417 nmùúÜ$%&‚Äô#=567 nmùúÜ$%&‚Äô#=467 nmŒîùê∫())=32.1 kcal/molŒîùê∫())=31.8 kcal/molŒîùê∫‚Ä†=33.1 kcal/molŒîùê∫‚Ä†=32.6 kcal/molModel:QC:eùúÜ!"#=407 nmùúÜ!"#=404 nmùúÜ$%&‚Äô#=574 nmùúÜ$%&‚Äô#=533 nmŒîùê∫())=26.9 kcal/molŒîùê∫())=26.6 kcal/molŒîùê∫‚Ä†=26.9 kcal/molŒîùê∫‚Ä†=26.7 kcal/molModel:QC:877, 878OSNNNNSOFFFClClFFF78Figure 7: Chemical properties by substitution pattern. 3-œÉ outliers were removed for ease of visualization. (a)
EÔ¨Äective activation free energy. (b) Trans absorption wavelength. (c) Cis absorption wavelength. (d) Substitution
patterns.

spin-complete TDDFT and œâB97X-D3. Multi-reference
eÔ¨Äects would likely be small for equilibrium structures,
and only a few new calculations would be needed for
Ô¨Åne-tuning 6,39.

These results lead to several conclusions. First, red-
shifting is quite diÔ¨Écult. This is shown by the fact that
most model predictions above 500 nm are actually er-
ror outliers. The associated wavelengths are still much
higher than the base compound, but quite far from the
predicted values. Second, we Ô¨Ånd that spin contamina-
tion is severe for many of the high-Œª predictions. Third,
on a positive note, the model is able to identify red-
shifted species with either high or low barriers, even
though the redshift is overestimated. This is encourag-
ing for virtual screening in photopharmacology.

The quantum chemistry absorption wavelengths also
come with several sources of uncertainty. They include
errors in SF-TDDFT, implicit treatment of the solvent,
and use of static structures instead of thermally sam-
pled geometries 6. Moreover, since the experimental ab-
sorption width is usually quite large, compounds can
often absorb at wavelengths 100-200 nm higher than
their peak 54.

Graph-property relationships

Here we analyze the relationship between substitution
and chemical properties. Observing and explaining gen-
eral trends will enable more focused candidate screening

in the future. Previous papers have also explored these
relationships computationally 12,17,18,20,55; we build on
their conclusions and extend them to other substitution
patterns and groups.

Figure 7 shows barrier heights and absorption wave-
lengths by substitution pattern. Panel (a) shows that
motifs A, F, and G have bimodal ‚àÜGeÔ¨Ä distributions,
with high barriers around the second mode. This is ex-
plored more below. Patterns B, C, and E have below-
average barriers and elongated distributions, while pat-
tern H has a tight distribution and the lowest mean
barrier.

Panels (b) and (c) show Œªtrans and Œªcis, respectively.
Intriguingly, we see that the distributions of classes E
and H are very elongated for Œªtrans. The same is true to
a lesser extent for B and C. While patterns like A, D,
and F are tightly concentrated between 400 and 425 nm,
class E samples from 400 to 525 nm with almost equal
probability. The Œªcis distributions are much tighter.

To better understand these results, we next ana-
lyze the relationship between substituent properties and
molecule properties for pattern A. Figure 8(a) shows
that Œªtrans is maximized when R1 is a non-ring donor. In
particular, panel (b) shows that this occurs when both
R1 and R2 are strong donors. Each box in this panel
shows the root-mean-square of Œªtrans for the given (R1,
R2) pair, computed as min{Œªtrans} + mean{(Œªtrans ‚àí
min{Œªtrans})2}0.5. This gives a mean that is weighted

9

R1R1NNR2R1R1NNR1R2R1R1R2R1NNR1R2R1R1R2NNR1R2R1R2NNR2R1R1R2R1NNR1R2R1NNR2R1NNR2ABCEFGHabcdDFigure 8: Relationships among substituent properties, free energies, and absorption wavelengths for pattern A. The
pattern is shown in Fig. 7 (d). (a) Œªtrans for donor/acceptor and ring/non-ring R1 substituents. (b) Œªtrans as a
function of R1 and R2 donor scores. (c) ‚àÜGeÔ¨Ä as a function of R1 donor score. (d) ‚àÜGeÔ¨Ä as a function of both R1
and R2 donor scores. (e) As in (d), but for ‚àÜG‚Ä†. (f) ‚àÜGeÔ¨Ä vs. ‚àÜGrxn.

towards higher values, reÔ¨Çecting our interest in maxi-
mizing Œªtrans better than a simple mean. The results
are somewhat unexpected: a simple picture of donors
raising the HOMO and acceptors lowering the LUMO
would predict a redshift for strong donors or acceptors.
Yet the actual eÔ¨Äect is only noticeable for donors.

Panel (c) shows that strong R1 acceptors lead to very
high barriers, with narrow distributions centered around
33 kcal/mol. This is consistent with Ref. 18, which
reported long thermal lifetimes for ortho-Ô¨Çuoro sub-
stituted azobenzenes. Donor-substituted azobenzenes
have noticeably lower barriers. However, the associ-
ated barriers are tightly concentrated near 30 kcal/mol,
which is the same value as for unsubstituted azoben-
zene. This is encouraging, since it means that substitu-
tion with two donors can redshift the absorption wave-
length without decreasing the barrier.

Panel (d) reinforces that ‚àÜGeÔ¨Ä has the opposite
trend of Œªtrans (in this plot we use the mean for each
box). Again, however, we see that even the lowest bar-
riers in the upper right corner are similar to that of
azobenzene. Intriguingly, panel (e) shows the opposite
trend for ‚àÜG‚Ä†. This may be related to the absence of an
inversion mechanism for the ISC approach. This result
reinforces the need for high-accuracy quantum chem-
istry to accurately compare ‚àÜG‚Ä† and ‚àÜGeÔ¨Ä .

Panel (f) shows the relationship between the activa-
tion free energy and the reaction free energy ‚àÜGrxn,
where ‚àÜGrxn = Gcis ‚àí Gtrans. The Bell-Evans-Polanyi
principle 56,57 states that the reaction enthalpy and ac-
tivation enthalpy are linearly related for reactions in

the same family. This relationship was also tested for
azobenzene derivatives in Ref. 17. We see a moderate
negative correlation between the two quantities, with
Spearman œÅ equal to ‚àí0.27. Hence ‚àÜGeÔ¨Ä can be in-
creased by making the cis isomer more stable. How-
ever, the modest correlation means that this is not the
full story, and that the TS and MECP energies must be
explicitly considered.

Discussion

The main source of error in our approach is the un-
derlying quantum chemistry calculations. As discussed
in SI Sec. S12, expensive wavefunction methods give
lower barriers than SF-TDDFT, but still give diÔ¨Äerent
answers from each other. On balance the most accu-
rate method seems to be SF-EOM-CCSD(dT), but its
prohibitive N 7 scaling 28 makes it a poor candidate for
transfer learning. Future work should focus on accurate
quantum chemical approaches that do not need manual
setup, such as selection of active spaces, and that are
aÔ¨Äordable enough for transfer learning.

Another limitation is that we have not consid-
ered azobenzene protonation and azo-hydrazone tau-
tomerism. These eÔ¨Äects can be facilitated by sub-
stituents such as NH2 and OH, and by solvation in a
protic solvent, weakening the N=N double bond and
lowering the isomerization barrier 58‚Äì60. Protonation
from the solvent is not accounted for in a PCM de-
scription. Incorporating automated protonation tools 61

10

pattern Aabcdefinto our workÔ¨Çow would be of interest in the future.
Similarly, the protein environment for a given target
in photopharmacology can also aÔ¨Äect the isomerization
rate 23,62. Incorporating these eÔ¨Äects for a speciÔ¨Åc tar-
get, as in Ref. 23, is of interest for future work.

From the perspective of property optimization, the
biggest remaining challenge is redshifting. While it is
straightforward to reach Œª = 470 nm for trans isomers,
it appears very diÔ¨Écult to reach Œª = 550-600 nm. Aver-
aging the gap over thermally sampled geometries may
increase the wavelength and improve prediction accu-
racy 6.
Including bulky groups in all four ortho po-
sitions may also increase the wavelength 6, but at the
potential cost of synthetic accessibility. A more tar-
geted approach to wavelength optimization could be of
interest in the future. For example, methods such as
Monte Carlo tree search 63 could likely improve over vir-
tual screening of combinatorial libraries.

Conclusions

We have presented a fast and automated method for
predicting the isomerization barriers of azobenzene
derivatives. The approach can compute the activa-
tion free energy through TS theory or ISC theory. We
have demonstrated the accuracy of the underlying ML
model with respect to SF-TDDFT, reproduced trends
in the experimental isomerization rate, and argued for
rotation-based ISC as the reaction mechanism. Our
software is fast, accurate, and easily accessible to the
community, making it a valuable tool for computational
design of photoactive molecules. Future work will focus
on more accurate quantum chemistry methods and more
targeted molecular generation.

Supporting Information

Extended methods, details of molecule generation, de-
tails of optimization, non-adiabatic transition state the-
ory, activation free energies by mechanism, thermal iso-
merization rates, details of training, Ô¨Åltering protocol
in screening, collection of experimental data, note on
mechanisms, and quantum chemistry benchmark.

Acknowledgements

We thank Dr. Johannes Dietschreit for bringing triplet-
mediated isomerization to our attention. Harvard Can-
non cluster, MIT Engaging cluster, and MIT Lin-
coln Lab Supercloud cluster at MGHPCC are grate-
fully acknowledged for computational resources and
support.
Financial support from DARPA (Award
HR00111920025) is acknowledged.

11

Supporting Information

Thermal half-lives of azobenzene derivatives: virtual screening based
on intersystem crossing modeled with a machine learning potential

S1 Extended methods

All models used the PaiNN architecture 35 and were implemented in PyTorch 64. As in our previous work, we used
Ô¨Åve convolutions instead of the three used originally, as this substantially improved model performance 6. We also
allowed the k values in the radial basis functions to be updated during training. Remaining hyperparameters can
be found in Ref. 6, and an in-depth explanation of their meaning can be found in Ref. 35. Further hyperparameter
optimization is likely possible 65.

After training the model on data without empirical dispersion, we added D3BJ dispersion 66,67 to the total energy

prediction:

E = Emodel + ED3
F = ‚àí‚àáEmodel ‚àí ‚àáED3

(S1)
(S2)

The forces were computed with automatic diÔ¨Äerentation 68. Dispersion parameters were taken from the PhysNet
repository 69,70. No cutoÔ¨Ä was used. D3 dispersion is a function only of the atom types and positions, and could
therefore be added analytically without approximation. The model performance in the main text used SF-D3BJ
TDDFT as the ground truth.

The geometries for SF-TDDFT/C-PCM calculations were generated through active learning (Fig. 3(a)). In each
round of active learning, the TS workÔ¨Çow in Fig. 3(b) was performed for 1,000 (SMILES, mechanism) pairs using
one of the trained models. The pairs were randomly sampled from a set of 73,000 reactions with four mechanisms
each. We selected 3,000 generated geometries for DFT calculations, added the new data to the training set, and
repeated. 50% of the geometries were selected by uncertainty, 30% by energy, and 20% randomly. For uncertainty-
based selection, we chose the geometries with the highest variance in forces predicted by the three models. For
energy selection, we sampled a geometry i with probability pi ‚àù eEi/kBT . The energy was computed relative to
other geometries of the same species in the same simulation. The energy selection sampled near-TS geometries from
relaxed scans, and high-energy MTD structures from conformer generation.

Active learning was repeated 15 times, yielding 43,938 calculations in total. The Ô¨Ånal model was trained on 42,938

geometries, with 500 used for validation and 500 for testing.

S2 Molecule generation

Molecules were generated using the patterns in Fig. 7(d). These are common substitution patterns in the literature;
see, for example, the synthesized species in Refs. 17,18,20,41‚Äì47. Some of the functional groups were common azobenzene
substituents aggregated in Ref. 6, with new groups added from Refs. 71‚Äì73. Others were basic chemical moieties, such
as benzene, ethane, R ‚àí CF3, and so on.

We aimed to avoid steric clashes in tetra-ortho substitution, since this can make experimental synthesis more
diÔ¨Écult. For this reason we separated substituents by size. Those with four total atoms or fewer were labeled small,
and all others were labeled large. For all tetra-ortho substitutions, we only allowed one side of the N=N bond to be
substituted with large groups. The other side could only be substituted with small groups. Substitution with small
groups at all positions was also allowed.

S3 Optimizations

S3.1 Relaxed scans

To perform the relaxed scans, we Ô¨Årst identiÔ¨Åed the CNNC atoms using a substructure search of azobenzene in
RDKit 74. We then adjusted their angles and/or dihedral angle by a constant amount in each step of the scan. The
angles and dihedrals were adjusted using the atomic simulation environment (ASE) 75. For the inversion mechanism
we set the Ô¨Ånal CNN or NNC angle to 179.5‚ó¶. We used 179.5‚ó¶ instead of 180‚ó¶ because the Cartesian derivative of
the latter is undeÔ¨Åned, and hence the constraining forces described below would also be undeÔ¨Åned. For rotation we
set the Ô¨Ånal dihedral angle to ¬±90‚ó¶. We also set the Ô¨Ånal CNN and NNC angles to 122‚ó¶. Without this constraint, we
found that some of the scans collapsed to inversion TSs instead of rotation TSs. 122‚ó¶ is the angle of the rotational
TS when optimizing azobenzene with SF-TDDFT 24.

S1

Table S2: Parameters used in our NN conformer generation workÔ¨Çow. From top to bottom, the sections contain
MTD parameters, optimization parameters, and cregen parameters. N is the number of atoms in the system. The
cregen parameters are the defaults used in CENSO, a program that reÔ¨Ånes CREST ensembles with DFT 81.

Parameter
tnew
Œ∫
k(cid:48)
Œ±
‚àÜt
mH
thermostat
Q
œÑ
T
‚àÜ0
f loose
max
f tight
max
f ultra
max
Eloose
win
Etight
win
Eultra
win
‚àÜEthr
‚àÜRthr
‚àÜBthr

Meaning
time between adding reference structures to Vbias
turn-on parameter for adding new MTD Gaussians 80
k = N k(cid:48) is the biasing strength in Eq. (S5) 30
Gaussian width in Eq. (S5)
time step
hydrogen mass used in dynamics
method for enforcing average temperature during dynamics
Nos¬¥e-Hoover eÔ¨Äective mass
Nos¬¥e-Hoover relaxation time
simulation temperature
see Fig. S9(a)
maximum force component in loose opt
maximum force component in tight opt
maximum force component in ultra-tight opt
energy window for retaining conformers after loose opt
energy window for retaining conformers after tight opt
energy window for retaining conformers after ultra-tight opt
two geometries cannot be duplicates or rotamers if their energies diÔ¨Äer by more than ‚àÜEthr
two geometries cannot be duplicates if their RMSD is more than ‚àÜRthr
two geometries cannot be rotamers if their rotational constants diÔ¨Äer by more than ‚àÜBthr

Value
1 ps
0.03
1.5 mEh
0.5 Bohr‚àí2
2 fs
4 amu
Nos¬¥e-Hoover
(3N ‚àí 6) ¬∑ œÑ 2kBT
100 fs
298.15 K
0.2 kcal/mol
0.2 eV/ÀöA
0.05 eV/ÀöA
0.005 eV/ÀöA
15.0 kcal/mol
8.0 kcal/mol
2.5 kcal/mol
0.15 kcal/mol
0.175 ÀöA
0.03 (3%)

20 steps were used in each scan. After the angles and/or dihedrals were adjusted, the geometry was optimized
with forces given by F + Frestrain. The restraining forces are the negative gradients of the following restraining
energies:

EŒ±,n = kŒ±(Œ± ‚àí Œ±n)2
Eœâ,n = ‚àíkœâ cos (œâ ‚àí œân).

(S3)

(S4)

Here Œ± denotes an angle, œâ denotes a dihedral, n denotes the nth step of the optimization, and Œ±n, œân are target
values at the nth step. EŒ± was used for the inversion mechanism, while both EŒ± and Eœâ were used for the rotation
mechanism.

kŒ± and kœâ were each set to 1 Ha. The optimization was performed with the BFGS algorithm 76‚Äì79 in ASE. A
rather loose convergence threshold of fmax = 0.05 eV/ÀöA was used. This was because of the conformer generation
performed after the scans. As described in Sec. S3.2, each stage of conformer generation was restarted if a new
conformer had a lower energy than the seed conformer. We used a tolerance of fmax = 0.05 eV/ÀöA to minimize the
optimization time spent on high-energy conformers. Tight convergence criteria were only used once no lower energy
conformers were found. If the seed conformer were optimized with tighter thresholds than the generated ones, it
could have a lower energy simply due to its stricter thresholds. Hence it needed to be optimized with the same
thresholds.

Angles and dihedrals were set with ASE at each step. ASE adjusts only these internal coordinates, without
rotating the rest of the molecule as a solid body. RDKit uses a solid body rotation, and in principle should then
require fewer optimization steps at each stage of the scan. However, we found that this led to unstable scans, and
so we used ASE instead.

For all optimizations and dynamic simulations we updated the neighbor list every ten steps. To account for
neighbors coming into the cutoÔ¨Ä radius between updates, we computed the neighbors using a cutoÔ¨Ä of rcut + rskin,
where rcut = 5.0 ÀöA is the model cutoÔ¨Ä radius and rskin = 2.0 ÀöA is the cutoÔ¨Ä skin. Distances between atoms and
neighbors were computed at each step, and only those within rcut of each other were used in the model.

S3.2 Conformer generation

Conformer searches were performed for all reactants, products, and transition states. We implemented a method
based on CREST 30 using our NN. CREST combines metadynamics, high-temperature molecular dynamics, and

S2

Figure S9: Outline of the conformer generation workÔ¨Çow used in this work. (a) Overview of the approach. (b)
Details of the trimming procedure.

genetic structure crossing 82 to sample conformational space. The sampled geometries are then optimized with a
multi-level Ô¨Åltering scheme. In this approach, optimizations are performed with progressively tighter thresholds, and
structures are discarded if their energy is above a maximum value that is lowered in each step. By default CREST
uses the fast semi-empirical method GFN2-xTB 83 to compute energies and forces.

The key component for phase space exploration is metadynamics (MTD). The collective variables used for MTD
are the root-mean-square displacements (RMSDs) from previously visited structures. This drives the molecule away
from previously visited conÔ¨Ågurations and towards new regions of phase space. The associated biasing potential is
given by

Vbias =

n
(cid:88)

i

ki exp(‚àíŒ±i‚àÜ2

i ).

(S5)

Here the sum is over n previously visited structures, where a new structure is added every 1 ps. ‚àÜi is the RMSD
of the current structure with respect to the ith previous structure, ki is a pushing strength parameter, and Œ±i is a
width parameter. The forces at each step are the sum of the actual forces and the negative gradient of Vbias. 14
MTD runs are performed in CREST, using diÔ¨Äerent combinations of Œ±i and ki.

Initially we used CREST to perform conformer searches. However, given the speed of relaxed scans and eigenvector
following with our NN, we found that CREST was by far the most time-consuming step in the workÔ¨Çow. For example,
with access to 24 Xeon-P8 CPU nodes and 1,152 cores in total, we ran 82 CREST jobs at a time with 14 cores per
job. The average job took 4.2 hours, which meant a throughput of 470 geometries per day. Given four TS guesses
per species, plus the reactant and product geometries, this meant that only 78 species could be screened per day.
Screening 25,000 species, as done in this work, would have taken 11 months.

CREST has built-in options for conformer searches that are faster but less extensive. These involve fewer MTD
runs and tighter energy windows for each level of optimization. However, given less extensive sampling and tighter
energy windows, it makes sense to use our NN instead xTB. For example, CREST has a default energy window
of 6.0 kcal/mol for the Ô¨Ånal ensemble, even though conformers of energy greater than approximately 2.5 kcal/mol

S3

loose optMTD simulationùê∏!"##$%<ùê∏!"#&‚Äô(‚àíŒî)or num. iterations <2max. 5 iterationsultra-tight opttight optremove high-ùê∏structuresremove duplicates and rotamersaddyesnotrimpairwise RMSD, ùê∏, and ùêµenergy thresholdtrimtrimget MTD lengthinput structuretrimmed CElowest-ùê∏structureCEfinal CEtrimabconformer ensemble (CE)are not populated at room temperature. This is to compensate for errors in xTB, so that low-lying conformers
mistakenly assigned a high energy by xTB are not discarded. These conformers can be subsequently re-ranked or
re-optimized with a higher level of theory. Therefore, it is more reasonable to use a tight energy window for the NN,
which is speciÔ¨Åcally trained to reproduce SF-TDDFT for azobenzene derivatives. Similarly, the sampling should be
more extensive for xTB than for the NN. This is because errors in xTB mean that conformational space must be
thoroughly sampled up to an energy of 6.0 kcal/mol. The NN, by contrast, only needs to thoroughly sample the
space up to an energy of 2.5 kcal/mol. Alternatively, one could retain the extensive sampling but use the ultra-fast
GFN force-Ô¨Åeld 84. However, we found that the force-Ô¨Åeld produced poor results for TSs.

We therefore implemented our own conformer search with the NN, and used tighter energy windows and fewer
dynamics simulations. The workÔ¨Çow is shown schematically in Fig. S9. The approach closely follows that of
CREST, but uses only one MTD run per stage, and does not use MD or genetic structure crossing. As in CREST,
we determined the MTD time using a Ô¨Çexibility measure derived from the chemical graph (the current formula in
CREST diÔ¨Äers from that of the original publication; we used the up-to-date version in the source code 85, commit
6bb6355). To partially compensate for the decreased total simulation time, we used a minimum MTD time of 15 ps,
instead of the 5 ps used in CREST. The parameters used in our workÔ¨Çow are given in Table S2.

Several points require further discussion. First, we used the CREST cregen tool to remove both duplicates and
rotamers in the ensemble. Duplicates are pairs of geometries with ‚àÜE < ‚àÜEthr, RMSD < Rthr, and B < Bthr,
where ‚àÜ is the diÔ¨Äerence between the two quantities, E is the energy, B is the rotational constant, and thr denotes a
threshold. Rotamers are structures with ‚àÜE < ‚àÜEthr, RMSD > Rthr, and B < Bthr. We removed rotamers because
the diÔ¨Äerence in rotamer count per conformer should be small, and because accounting for all rotamers is quite
diÔ¨Écult. This is especially true when MD and genetic structure crossing are not included, since they are included
in CREST primarily to Ô¨Ånd rotamers 30.

Second, we used the L-BFGS algorithm 86 in ASE to perform optimizations. The convergence criterion is
maxi,Œ± |fi,Œ±| < fmax, where fi,Œ± is a force component, i ‚àà {1, N } is the atom index, Œ± ‚àà {x, y, z} is the Carte-
max = 0.005 eV/ÀöA. For TS geometries we
sian index, and fmax is a threshold. For equilibrium geometries we used f ultra
max = 0.01 eV/ÀöA, since the average change in energy between the two thresholds is only 0.1 kcal/mol, while
used f ultra
the number of extra steps can be signiÔ¨Åcant. We used fmax = 0.005 eV/ÀöA for eigenvector following performed on the
Ô¨Åve lowest-energy conformers. Note also that the algorithm is implemented in Cartesian coordinates. This makes
it less eÔ¨Écient than the internal optimizer in xTB, which uses internal coordinates. Use of an internal coordinate
optimizer may be of interest in the future.

Third, unlike in CREST 80, we did not constrain bond lengths with SHAKE 87. Typically SHAKE is used to allow
longer time steps and therefore accelerate the dynamics. Indeed, CREST uses a default time step of 5 fs, while the
maximum value for unconstrained dynamics is typically 0.5 fs. However, the SHAKE implementation in ASE is
rather slow, and therefore became a bottleneck instead of reducing run times. One can also increase the time step
by artiÔ¨Åcially increasing the mass of hydrogen, since, as the lightest element, its motion is usually the fastest in the
system. We followed the default in CREST and set the hydrogen mass to 4 amu. This allowed us to use a time step
of 2 fs. Interestingly, we found that CREST automatically reduced the time step from 5 fs to 2 fs for TS conformer
searches, since trial MTD runs with larger time steps all failed. This happened even though SHAKE is used in
CREST. The same thing did not happen for conformer searches of equilibrium geometries. Hence our time step was
the same as the CREST time step for TSs, even though we did not use SHAKE. Yet an eÔ¨Écient implementation
of SHAKE is still of interest, since Ô¨Åxing the bond lengths during MTD might decrease the number of subsequent
optimization steps needed.

Fourth, we Ô¨Åxed the CNNC atoms in each molecule when performing TS conformer searches. We experimented
with Hookean constraints on the CNN angles and CNNC dihedrals, but this led to unstable dynamics. This was
likely because the Cartesian gradient of an angle is undeÔ¨Åned when the angle is 180‚ó¶. We excluded the Ô¨Åxed atoms
from the RMSD computation in MTD. For equilibrium geometries we excluded the CNNC atoms from the RMSD,
but did not Ô¨Åx the atoms. Excluding these atoms ensured that cis did not isomerize to trans.

To evaluate our approach, we performed conformer searches with CREST and with our method on 100 relaxed
scan TS geometries. We then optimized each CREST geometry with the NN, removed duplicates, and retained the
geometries with energies under 2.5 kcal/mol. The top 5 conformers from each method were then optimized with
eigenvector following. We checked that the mechanism of each TS matched the target mechanism of the relaxed scan
(e.g. rotational TS for a rotation relaxed scan). We removed one species that had relaxed to an inversion TS with
CREST after being seeded with a rotational TS. The distribution of TS energy diÔ¨Äerences is shown in Fig. S10(a).
The mean value of ENN, MTD
is 0.28 kcal/mol. The mean increases to 0.48 kcal/mol after removing
outliers with absolute energy diÔ¨Äerences over 6 kcal/mol. The agreement between the two methods is quite good,
despite using only one MTD simulation in the NN approach instead of 14. Further, the error in the ‚àÜE‚Ä† is expected
to be smaller than the error in ETS. This is because the conformer search can only overestimate the lowest energy,
not underestimate it, and so some error cancellation can be expected.

‚àí ECREST
TS

TS

We also compared the completeness of the ensembles in each of the two methods. To do so we computed the

S4

Figure S10: Energy diÔ¨Äerences between TSs generated with NN conformer searches and with CREST.

conformational free energy, deÔ¨Åned in SI Sec. S3.6. Figure S10(b) shows the diÔ¨Äerence in conformational free energy
between the two methods. Interestingly, we see that the NN generates a more complete ensemble on average. The
mean value of GNN, MTD
is ‚àí0.36 kcal/mol. This trend persists even when the lowest-energy conformers
are quite close in energy between the two methods. For example, restricting ourselves to species in which the
|ENN, MTD
| ‚â§ 0.5 kcal/mol, we Ô¨Ånd that the diÔ¨Äerence in Gconf is ‚àí0.60 kcal/mol. We conclude that the
NN ensembles are quite complete, and that the associated Gconf is reliable.

‚àí GCREST
conf

‚àí ECREST
TS

conf

TS

The NN approach is faster than CREST, mainly because fewer MTD runs are performed. NN energy and force
calculations also tend to be faster than xTB for large molecules. A precise comparison is diÔ¨Écult, because xTB
is run on CPUs and NNs are run on GPUs. This means that one cannot simply compare wall-clock times using
equivalent hardware. Indeed, to compare the number of species that can be screened per day, one must also consider
the number of GPUs available to the user vs. the number of CPUs. Nevertheless, some rough comparisons can still
be made. For example, running 189 ps of MTD for a molecule with 102 atoms took 24 hours and 48 minutes with
xTB on one Xeon-P8 core. If the xTB calculations were parallelized over all 48 cores on the node, then the run
would take 31 minutes given perfect parallelization. Hence 1.9 MTD runs could be performed per node per hour. By
contrast, the corresponding NN MTD run took 4 hours with one NVIDIA A100 GPU, using a batch of 50 species.
This corresponds to 12.5 MTD runs per GPU per hour, or 25 per node per hour, assuming 2 GPUs per node. In
this case, NN MTD is eÔ¨Äectively 25/1.9 ‚âà 13 times faster than xTB MTD.

Lastly, since the conformer search is the rate-limiting step in our workÔ¨Çow, any additional speed-ups would
increase our throughput. While MTD enables exploration of conformational space, it is fundamentally limited by
the fact that all steps must be taken in series. Uncorrelated geometries can only be generated after taking several
hundred steps. Stochastic conformer generators are attractive because they can rapidly produce many uncorrelated
structures. Examples include the ETKDG method in RDKit 88 and the commercial software Omega 89,90. To adapt
these generators for TSs, one would have to generate conformers of equilibrium geometries, and perform a relaxed scan
from the equilibrium structures to the TS. Even if TS geometries would be generated directly, the structures would
still have to be optimized. In either case, optimization would incur signiÔ¨Åcant cost. Indeed, structure optimizations
take the most time of any step in CREST and NN conformer generation. Therefore, avoiding MTD would not reduce
the computation time to that of a stochastic conformer generator. Another approach is to train a generative model
to produce TS geometries 91. ML for equilibrium conformer generation has rapidly progressed in recent years 92‚Äì100,
and many of the methods could also be applied to TS generation. These avenues would certainly be of interest in
future work.

S3.3 Eigenvector following

EVF was implemented with Baker‚Äôs rational function optimization method 101.
In the Ô¨Årst step, the numerical
Hessian was computed with Ô¨Ånite diÔ¨Äerences, using the ASE vibrations package. We used a step size of 0.005 ÀöA, and
checked that the results were indistinguishable from the analytical Hessian computed with PyTorch. We used Ô¨Ånite
diÔ¨Äerences rather than automatic diÔ¨Äerentiation to minimize the consumed GPU memory. In subsequent steps the
Hessian was updated using Powell‚Äôs method 102. We used a convergence threshold of fmax = 0.005 eV/ÀöA.

S5

abTable S3: Parameters used in IRC searches. SD stands for steepest descent.

Parameter
init displ de
scale displ sd
adapt scale disp
sd parabolic fit
interpolate only
do sd corr
scale displ sd corr
sd corr parabolic fit
tol max g
tol rms g

Meaning
Target energy change for the Ô¨Årst step
Factor for scaling the Ô¨Årst SD step
Modify scale displ sd when the step size becomes smaller or larger
Do a parabolic Ô¨Åt for Ô¨Ånding the optimal SD step length
Only allow interpolation for parabolic Ô¨Åt, not extrapolation
Apply a correction to the Ô¨Årst SD step
Factor for scaling the correction to the SD step
Do a parabolic Ô¨Åt for Ô¨Ånding the optimal SD step length
Maximum gradient for convergence
RMS gradient for convergence

Value
0.25 kcal/mol
0.15
True
True
True
True
0.33
True
2 √ó 10‚àí3 Ha/Bohr
5 √ó 10‚àí4 Ha/Bohr

S3.4

Intrinsic reaction coordinate

We implemented an IRC algorithm based on the approach in Orca 103. This approach is itself based on the method
of Morokuma and coworkers 33. Details can be found in the Orca 5.0.2 manual. The parameters that we used are
given in Table S3. Note that the force tolerances are rather large, since only a loose optimization is needed to see if
the IRC has the product and reactant on either end.

S3.5 Singlet-triplet crossing searches

Singlet-triplet crossings were located with a two-step procedure. In the Ô¨Årst step, we performed IRC to locate the
crossings one either side of the TS. In the second step, we optimized each of the two crossings by minimizing the
energy while keeping the singlet-triplet gap close to zero. This yielded MECPs on each side of the TS.

In the Ô¨Årst step we performed the normal IRC algorithm on the S0 state. We also kept track of the T1 energy,
and stopped the optimization once ET1 ‚àí ES0 changed sign. We then used the Ô¨Ånal geometry as the starting point
for the MECP optimization.

The MECPs were optimized with the approach of Ref 104. In a regular optimization, the objective function is
the energy E, and so its negative gradient is F. In an MECP optimization, the objective function is the energy
subject to the constraint that the singlet-triplet gap is zero. We therefore used the following eÔ¨Äective forces in the
optimization:

F(cid:48) = P ¬ØF +

1
Œ±

‚àÜE ‚àÜF.

(S6)

The Ô¨Årst term is the mean of the singlet and triplet forces, ¬ØF, with the gradient of the energy gap ‚àÜE projected
out by P. Its eÔ¨Äect is to minimize the average singlet and triplet energies without increasing their gap. The second
term contains the force diÔ¨Äerence ‚àÜF. Since it is scaled by the energy diÔ¨Äerence ‚àÜE, its eÔ¨Äect is to minimize the
singlet-triplet gap. Œ± is a constant with units of energy. The terms are given by

‚àÜE = ET1 ‚àí ES0
‚àÜF = FT1 ‚àí FS0

¬ØF =

1
2

(FT1 + FS0)
‚àÜFT ¬ØF
‚àÜFT ‚àÜF

P ¬ØF = ¬ØF ‚àí

‚àÜF,

(S7)

(S8)

(S9)

(S10)

where a superscript T denotes transposition.

We implemented this approach in ASE, using a calculator that produced the forces of Eq. (S6). We then performed
the optimization using the BFGS algorithm in ASE. The maximum force tolerance for convergence was set to 0.005
eV/ÀöA. The constant Œ± was set to 12.55 kcal/mol following a related MECP algorithm for conical intersections 105.
We found that the optimized MECPs were insensitive to the choice of Œ±. For example, nearly identical MECP
energies were obtained when using Œ± = 1.0 kcal/mol.

S6

S3.6 Free energy calculations

The free energy was computed for reactants, products, and TSs, using

G = H ‚àí T S,

where G is the Gibbs free energy, H is the enthalpy, and S is the entropy. The enthalpy was computed as

where the last term is the average conformer energy,

H = Eel + EZPE + Evib(T ) + 4 kBT + Econf ,

Econf =

(cid:88)

i

piEi,

(S11)

(S12)

(S13)

and the sum is over all conformers. pi is the Boltzmann probability for conformer i, given by pi ‚àù exp(‚àíEi/kBT ).
Eel is the electronic energy, EZPE is the zero-point energy, and Evib(T ) is the thermal vibrational energy. Standard
expressions for EZPE and Evib(T ) can be found in Ref. 17. Apart from Econf , all terms in Eq. (S12) were computed
using the ASE thermochemistry package.

The entropy was computed as

where SmRRHO is the modiÔ¨Åed rigid rotor-harmonic oscillator entropy (see below), and Sconf is the conformational
entropy:

S = SmRRHO + Sconf ,

(S14)

Sconf = ‚àíkB

(cid:88)

i

pi ln pi.

(S15)

The sum is over all conformers of all four mechanisms when using TS theory, but only over rotational conformers
when using the ISC approach. Note that if two mechanisms are the same by symmetry, then the conformational
entropy is increased by kT log 2, while ‚àÜG is lowered by this amount. This is the same factor that would arise from
using the symmetry number œÉ = 2 in the calculations 19.

The modiÔ¨Åed rigid rotor harmonic oscillator approximation 106 interpolates between a free rotor at low frequencies
and a harmonic oscillator at high frequencies. This is more physically sound than a standard harmonic approximation,
and avoids the divergent entropy of low-frequency harmonic modes. The rotor cutoÔ¨Ä frequency was set to 50 cm‚àí1,
following the default in xTB 83. All other parameters were unchanged from Ref. 106.

Harmonic modes and frequencies were computed in the normal way 107 by diagonalizing the mass-weighted Hessian
after projecting out rotation and translation. For reactants and products we checked that there were no imaginary
frequencies. For TSs we checked that there was only one imaginary frequency, with magnitude ‚â• 200 cm‚àí1. Species
with reactants or products not satisfying these conditions were removed. Species were kept if they had at least one
TS geometry from each mechanism satisfying these conditions.

For GX, H X, and SX we used thermostatistical quantities from the rotational TSs. In principle the vibrational
terms should be computed with the average Hessian of the singlet and triplet states at the crossing 104. However, we
found that this approach led to a sensitive dependence on Œ± in Eq. (S6), and so we used the rotational TS results
instead.

S4 Non-adiabatic transition state theory

The reaction rate from non-adiabatic transition state theory (NA-TST) is given by 104

kNA‚àíTST =

ZX
hZR

(cid:90) ‚àû

0

dŒµ P (Œµ) exp(‚àíŒ≤Œµ).

(S16)

Here Œ≤ = 1/(kBT ), ZX and ZR are the rovibrational partition functions at the crossing point and reactant geometry,
respectively, and P (Œµ) is the probability of transitioning between the two electronic states at energy Œµ. P (Œµ) can be
computed within the Wentzel-Kramers-Brillouin (WKB) approximation 108,109. The result is 34

kNA‚àíTST = kISC exp(‚àíŒ≤‚àÜGX ),

(S17)

S7

where the intersystem crossing rate is

kISC =

œÄ3/2Œ±
2h(cid:112)Œª/(kBT )

(cid:20)

1 +

1
2

(cid:18)

exp

1
12 Œ±2 (kBT Œª)3

(cid:19)(cid:21)

,

and

(cid:18) ¬µ

(cid:19)1/2

Fg|‚àÜF|

Œ± =

Œª =

Fg =

4H 3/2
SO
¬Øh
|‚àÜF|
2FgHSO
(cid:12)
N
3
(cid:88)
(cid:88)
(cid:12)
(cid:12)
(cid:12)

j=1

n=1

(FS0)jn (FT1)jn

(cid:12)
1/2
(cid:12)
(cid:12)
(cid:12)

.

(S18)

(S19)

(S20)

(S21)

Here HSO is the spin-orbit coupling, ¬µ is the reduced mass of the reaction coordinate, Fg is the geometric mean of
the singlet and triplet forces at the crossing, N is the number of atoms, and ‚àÜF is the force diÔ¨Äerence (Eq. (S8)).
In NA-TST, the reaction coordinate is the direction of ‚àÜF. The reduced mass is then given by

Ô£´

Ô£≠

¬µ =

1
|‚àÜF|2

N
(cid:88)

3
(cid:88)

j=1

n=1

Ô£∂

‚àí1

‚àÜF2

jnm‚àí1
n

Ô£∏

,

(S22)

where mn is the mass of the nth atom. Notice that Eq. (S18) scales quadratically with HSO, as expected from
Fermi‚Äôs golden rule 110. In re-expressing the equation from Ref. 34 we have used the relation Grv = ‚àíkBT logZrv for
the rovibrational free energy, and written GX = EX + GX
rv. We have also corrected two typos (Eq. (7) in Ref. 34
should not contain kBT , and Fg involves a square root rather than a square).

In this work we have approximated HSO as constant among all azobenzene derivatives. We tested this approx-
imation by computing HSO at the rotational TS of several derivatives. We included a derivative with chlorine,
since, as a relatively heavy third row element, it could increase the coupling. Couplings are available in Q-Chem for
TDFFT, but not for SF-TDDFT or CASPT2. They are also not available for CASPT2 in Orca. We therefore used
TDDFT with both the B3LYP and BHHLYP functionals, and found that HSO ‚âà 40 cm‚àí1, with a relative range
of 25% between the smallest and biggest values. The coupling is within a factor of two of the (14, 12) CASPT2
result 7, and the small variation indicates that HSO ‚âà const. is a good approximation. It also suggests that the
couplings from CASPT2 would be close to constant. In our calculations we therefore set HSO = 20 cm‚àí1, following
the (presumably) more accurate CASPT2 result.

It is informative to estimate the impact of this constant coupling approximation. To do so, we note that the ISC
rate scales quadratically with the spin-orbit coupling. Thus a relative change of 25% leads to a 56% change in the
rate. Converting this to an eÔ¨Äective activation entropy, and using tISC = 4.2 ps as discussed below, gives a change
of 0.26 kcal/mol to ‚àÜGeÔ¨Ä . Thus the maximum error from this approximation is only 0.26 kcal/mol, and is thus
negligible compared to other sources of error.

The ISC rate must be multiplied by two for the singlet ‚Üí triplet transition, and by three for the triplet ‚Üí singlet
transition 7. Using Eq. (S18) together with HSO = 20 cm‚àí1, we found that tISC = 5.7 ps for S ‚Üí T and 4.2 ps for
T ‚Üí S. These are within a factor of two of the results quoted in Ref. 7 using Fermi‚Äôs golden rule, thus validating both
their approach and ours. Note that we use the same spin-orbit coupling constant as Ref. 7, and so the diÔ¨Äerences
come solely from the diÔ¨Äerent rate formulas. The beneÔ¨Åt of Eq. (S18) is that it does not contain the Franck-Condon
factors used in Fermi‚Äôs golden rule expressions 7,111. Such terms are computationally expensive, and cannot be easily
computed for anharmonic modes such as the reaction coordinate. We found that tISC was essentially constant among
derivatives: the minimum time was 4.8 ps, and the maximum time was 5.8 ps.

S5 Connection between non-adiabatic and Eyring transition state the-

ory

The intersystem crossing rate in NA-TST can be connected to the experimental ‚àÜS‚Ä†. Experimentally one starts by
assuming an Arrhenius transition rate,

kA = Ae‚àíEa/(kBT ).

(S23)

S8

Here Ea is the activation energy and A is the Arrhenius prefactor. The two parameters are obtained experimentally
from a plot of log k vs. 1/T 19. DiÔ¨Äerentiating log k with respect to 1/T in Eqs. (2) and (S23), equating the two
results, and invoking Eq. (2) yields 19

‚àÜS‚Ä† = kB

(cid:18)

(cid:18)

log

A

h
kBT

(cid:19)

(cid:19)

‚àí 1

,

(S24)

where the slight temperature dependence of S and H has been neglected. If the process is actually mediated by ISC,
then we can apply the same logic to Eq. (S17), which yields

Ea = ‚àÜH X +

kBT
2

‚àí

3Œ∑kB
T 2

eŒ∑/T 3
2 + eŒ∑/T 3

BŒª3 .
Inserting Eqs. (S25) and (S23) into (S17) then gives

12Œ±2k3

Œ∑ =

1

ANA‚àíTST = kISC exp

(cid:18) ‚àÜSX
kB

+

(cid:19)

1
2

(cid:32)

exp

‚àí3Œ∑ eŒ∑/T 3
(2 + eŒ∑/T 3)T 3

(cid:33)

.

(S25)

(S26)

(S27)

Typically Œ∑/T 3 (cid:28) 1, and so the last exponential in Eq. (S27) is of order one. Neglecting this term and inserting the
result into Eq. (S24) gives the eÔ¨Äective activation entropy,

‚àÜSeÔ¨Ä = kB

(cid:18)

log

hkISC
kBT

‚àí

(cid:19)

1
2

+ ‚àÜSX.

(S28)

This is the entropy that would be inferred from experiment, given a triplet-mediated process with intersystem
crossing rate kISC, and an entropy diÔ¨Äerence ‚àÜSX between the intersection geometry and the reactant geometry.

S6 Activation free energies by mechanism

SI Fig. S11 compares the activation free energies of the diÔ¨Äerent mechanisms. The plots are for the 19,000 compounds
screened in the main text. Panel (a) compares triplet-mediated isomerization with standard S0 isomerization. ‚àÜGeÔ¨Ä
is lower than ‚àÜG‚Ä† in 65% of cases. This indicates that, at the SF-TDDFT level of theory, isomerization proceeds
through T1 for roughly 2/3 of the molecules. However, this result should be interpreted with caution. As shown
in Table S4, SF-TDDFT overestimates the energy at both the MECP and the TS relative to the highly accurate
SF-EOM-CCSD(dT). The overestimate is 5.4 kcal/mol at the MECP and 3.9 kcal/mol at the TS. This means that
‚àÜGeÔ¨Ä ‚àí ‚àÜG‚Ä† is overestimated by 1.5 kcal/mol. We therefore expect that, for the 19,000 compounds screened, ‚àÜGeÔ¨Ä
should be lower than ‚àÜG‚Ä† in more than 65% of cases. Indeed, if we assume that these overestimates are constant
among species, and thus subtract 1.5 kcal/mol from all ‚àÜGeÔ¨Ä , we Ô¨Ånd that the triplet mechanism is preferred in
88% of cases. This result should also be interpreted with caution, however, since it neglects errors in ‚àÜSeÔ¨Ä and ‚àÜS‚Ä†,
and assumes that the energy error is constant among all species.

Panel (b) compares the rotation and inversion mechanisms in TST. ‚àÜG‚Ä†

inv in 55% of all cases.
Interestingly, this means that there is no strong preference for either mechanism at the SF-TDDFT level of theory.
This should be contrasted with the species in Fig. 4, for which rotation was preferred in every case.

rot is lower than ‚àÜG‚Ä†

S7 Thermal isomerization rates

SI Fig. S12 compares predicted and experimental thermal lifetimes, rather than ‚àÜG values. It contains the same
information as Fig. 4 in the main text, but with ‚àÜG converted to a rate using Eq. (2), with T = 298.15 K. The
lifetime is the reciprocal of the rate. Notice that we Ô¨Årst converted experimental rates to ‚àÜG, given the temperature
of the experiment, and then back to a rate using T = 298.15 K. This ensures that the lifetimes are all compared at
the same temperature. The line of best Ô¨Åt was computed for ‚àÜG, and then converted to a lifetime.

We see that the experimental lifetimes span Ô¨Åve orders of magnitude. Species 1 has the shortest lifetime at 10
minutes, while species 6 has the longest lifetime at 2.5 years. The systematic overestimation of the energies at the
MECP and the TS leads to an overestimate of the lifetimes. The predicted lifetimes are respectively 4, 5, and 7
orders of magnitude too high for TST, ISC, and TST with only inversion. However, since the errors are systematic,
the model still has a high Spearman rank correlation with experiment. Converting from ‚àÜG to lifetime does not

S9

Figure S11: Reaction barriers for diÔ¨Äerent mechanisms. (a) ‚àÜGeÔ¨Ä from ISC vs. ‚àÜG‚Ä† from TST on the S0 surface.
(b) ‚àÜG‚Ä† from TST for rotation vs. inversion.

aÔ¨Äect the ranking, and so the Spearman rank coeÔ¨Écients are the same as in Fig. 4. R2 is negative because of the
exponential dependence of lifetime errors on ‚àÜG errors.

S8 Training

S8.1 Singlet models

Three diÔ¨Äerent models were pre-trained on 680,736 gas-phase SF-TDDFT/6-31G* calculations from Ref. 6. 95% of
the data was used for training, 4% was used for validation, and 1% for testing. Each model was initialized with
a diÔ¨Äerent random seed and trained on diÔ¨Äerent train/validation/test splits. Each model was then Ô¨Åne-tuned with
SF-TDDFT/6-31G* using a C-PCM model of water 36‚Äì38. The Ô¨Ånal models were trained on 42,938 geometries, with
500 used for validation and 500 for testing. DiÔ¨Äerent splits were used to Ô¨Åne-tune each of the Ô¨Ånal models.

The singlet ground-state corresponds to an excitation from a triplet reference state in SF-TDDFT. We identiÔ¨Åed
two singlets as the two states with the lowest (cid:104)S2(cid:105) of the three-lowest energy excitations 6. The lower energy singlet
was then taken as the ground singlet. Geometries with (cid:104)S2(cid:105) > 1 in the ground singlet state were discarded. The
spin contamination in the training set was fairly low, with mean(cid:104)S2(cid:105) = 0.16.

Approximately 6% of species in the training set had non-zero charge (+1, +2, or +4). The model does not use
charge in the input; however, all charge states in this work can be inferred from the number of bonds for each atom.
For example, if nitrogen has a single bond to four diÔ¨Äerent atoms, then it must have a partial charge of +1 to have
a full octet. Since bonds can be inferred from atom type and distances 66, the model can learn the eÔ¨Äect of diÔ¨Äerent
charge states from positions and atomic numbers alone.

Training was performed over energies and forces/force couplings in units of kcal/mol and kcal/mol/ÀöA, respec-
tively. Per-species reference energies were subtracted from each energy. These were obtained by summing atomic
reference energies, computed using multi-variable linear regression from (atom type, count) to relaxed geometry
energy computed with SF-TDDFT in vacuum. The set of vacuum reference energies was used for both vacuum and
solvent training.

ConÔ¨Ågurations with 10-œÉ energy outliers were removed prior to training. Those with forces ‚â•450 kcal/mol/ÀöA
from the mean or energies ‚â•900 kcal/mol from the mean were also removed. Geometries were not removed on the
basis of X-œÉ force deviations, since many geometries were close to TSs and hence had near-zero forces.

Models were trained with the Adam algorithm, using a batch size of 60 for the gas-phase models and 20 for the

Ô¨Åne-tuned models. We used an MAE loss for the forces and energies:

L =

1
M

M
(cid:88)

i=1

œÅE |Ei ‚àí ÀÜEi| +

1
3 (cid:80)M
i=1 Ni

M
(cid:88)

Ni(cid:88)

3
(cid:88)

i=1

j=1

n=1

œÅF |Fj,n ‚àí ÀÜFj,n|.

(S29)

Here œÅE = 0.2 is the energy weight, œÅF = 1.0 is the force weight, M is the number of geometries in a batch, Ni is
the number of atoms in geometry i, ÀÜX is a predicted quantity and X is its true value. We used an MAE loss instead
of a mean-squared-error loss, since this led to signiÔ¨Åcantly better model performance.

The learning rate was initialized to 10‚àí4 and reduced by a factor of two if the validation loss had not improved in
X epochs. X was set to 10 for the gas-phase models and 50 for the Ô¨Åne-tuned models. Training was stopped when

S10

abFigure S12: Experimental vs. predicted thermal lifetimes. Dotted orange lines are linear regression results from
predicted to experimental ‚àÜG, converted to a lifetime. œÅ denotes the Spearman rank correlation. R2 is computed
between the regression results and the experimental data. (a) Prediction accuracy using TS theory. (b) Prediction
accuracy using intersystem crossing. (c) As in (a), but with only the inversion mechanism. (d) Selected compounds
highlighted in panels (a)-(c).

the learning rate fell below 10‚àí5. The Ô¨Ånal model was selected as the one with the lowest validation loss. Training
was performed on a single 32 GB Nvidia Volta V100 GPU, and took approximately 2 days for each of the models.

S8.2 Triplet models

Triplet models were trained on the S0/T1 gap. They were pre-trained using energies from Ref. 6. Gradients were
not used since they had not been computed. For Ô¨Åne-tuning we computed gradients of both the singlet and triplet
state for all geometries, and thus used both the gap and its gradient for training. The same loss tradeoÔ¨Ä was used
as for the singlet model. The learning rate was set 5 √ó 10‚àí5 for pre-training and 10‚àí4 for Ô¨Åne-tuning; the former
was chosen because of instabilities in pre-training. To identify the triplet state, we Ô¨Årst identiÔ¨Åed the two singlet
states from the three lowest-energy excitations using the method above. The triplet state was then the remaining
one. Data points with (cid:104)S2(cid:105) < 2.0 or (cid:104)S2(cid:105) > 2.4 were discarded.

SF-TDDFT uses an MS = 1 triplet reference state. The excited MS = 0 triplet and the reference MS = 1 triplet
should have the same energy. We have found this to be true for spin-Ô¨Çip coupled-cluster methods, but not for
SF-TDDFT. This non-zero energy diÔ¨Äerence was also observed in Ref. 112. The authors explained that the diÔ¨Äerence
is due to orbital relaxation, since the orbitals are relaxed for the reference state but not for the TDDFT states.

It is not immediately clear which triplet energy should be used for ISC. We tested results using the reference
triplet, the excited triplet, and an average of the two. We compared EX to that of spin-Ô¨Çip coupled cluster for
azobenzene (SI Sec. S12), and found that the best agreement was for the triplet average. The excited triplet
overestimated EX by 5 kcal/mol, and the reference triplet underestimated it by nearly the same amount. However,
we found that the correlation with experiment was slightly better when we used the SF-TDDFT triplet. Further,
this is more consistent with the principle of treating singlet and triplet states on ‚Äúequal footing‚Äù. We therefore
trained our models on the excited-state triplet energies. The same network architecture and training parameters
were used as for the singlet models.

S8.3 Singlet excitation model

The singlet excitation model was trained directly on the S0/S1 gap.
It was Ô¨Årst pre-trained using energies and
gradients from Ref. 6. It was then Ô¨Åne-tuned using energies only, since we did not compute S1 gradients on the new
geometries.

S11

dOONNNNNNONHNNHNONNOOHNOFNNFONHOOFFFFNNFFFFOOFNNFFFbca123456S9 Filtering the screening results

We only kept the species that satisÔ¨Åed the following conditions:

1. Endpoints are done. Both cis and trans must have conformer ensembles and a minimum-energy geometry

with no imaginary frequencies.

2. Endpoints maintain cis/trans isomerism. The optimized cis and trans isomers must actually be cis

and trans, respectively. This is checked with RDKit.

3. TS conformer generation is Ô¨Ånished for each mechanism. A TS conformer ensemble must be generated

for each of the four mechanisms.

4. At least one TS is converged for each mechanism. To be converged, the TS must have only one

imaginary frequency, and its magnitude must exceed 200 cm‚àí1.

5. Graph is unchanged. All of the TS and endpoint geometries must have the same molecular graph as the
input SMILES. This is checked using D3 coordination numbers. Atom pairs with coordination numbers ‚â• 0.95
are assigned a bond. The resulting bond list is checked against that of the original SMILES string.

6. Vibrational frequencies are reliable. A frequency calculation is deemed reliable if |‚àÜG‚Ä† ‚àí ‚àÜE‚Ä†| ‚â§ 10

kcal/mol.

7. For the two singlet-triplet MECPs, one is closer to cis and the other to trans. This is checked

using the root-mean-square displacement of the CNNC atoms after alignment.

8. Each rotational TS connects to cis and trans through the IRC. This is true if condition 7 is satisÔ¨Åed.

25,000 species were screened in total, and 18,877 remained after applying these Ô¨Ålters.

S10 Experimental data

Most papers reported either the thermal half-life œÑ1/2, or the thermal lifetime œÑ . These are related through œÑ =
(e/2) œÑ1/2. In some cases the authors did not provide œÑ or œÑ1/2, but did plot the absorption spectrum at diÔ¨Äerent
time intervals. In these cases we inferred the thermal lifetime from the absorption plots.

In all cases we computed the activation free energy from Eyring TST using œÑ :

‚àÜG‚Ä† = kBT log

kBT œÑ
h

.

(S30)

Note that diÔ¨Äerent works used diÔ¨Äerent temperatures, and so T depends on the source.

S11 Note on mechanisms

S11.1 Concerted inversion

In our own calculations we have found that concerted inversion has two imaginary frequencies, and therefore is not
a true TS. This is because it is a combination of two diÔ¨Äerent inversions, each of which has one imaginary frequency.
It is therefore higher in energy than a single inversion, not a true TS, and can be excluded from possible thermal
mechanisms.

S11.2 Inversion-assisted rotation

A relaxed scan from Œ± ‚âà 120‚ó¶ to Œ± ‚âà 180‚ó¶ will either end in a pure inversion TS or an inversion-assisted rotation
TS, depending on the substituents. One can also be converted into the other through a conformational search with
Ô¨Åxed CNNC atoms. Therefore, we grouped inversion and inversion-assisted rotation together.

S12

Table S4: Summary of the methods and results from our benchmark. DFT uses the B3LYP functional with D3BJ dis-
persion, while SF-TDDFT uses the BHHLYP functional, both with and without D3BJ dispersion. Energy diÔ¨Äerences
are given in kcal/mol.

Method

Basis

Restricted?

DFT
DLPNO-UCCSD(T)
SF-TDDFT
SF-TDDFT (D3BJ)
CASPT2 (14, 12)
SF-EOM-CCSD(dT)

cc-pVDZ
F12-cc-pV(D, T)Z extrap.
6-31G*
6-31G*
cc-pVDZ
6-31G*

Yes
No
No
No
Yes
Yes

Treatment of
Static Correlation
Poor
Poor
Moderate
Moderate
Strong
Moderate

Treatment of
Dynamic Correlation
Strong
Very strong
Strong
Strong
Moderate
Very strong

‚àÜE‚Ä† ‚àÜEX

35.6
42.1
31.5
32.6
25.4
28.7

n/a
n/a
27.8
28.9
18.7
23.5

Figure S13: Torsional energy proÔ¨Åle of azobenzene computed with diÔ¨Äerent methods.

S12 Quantum chemistry benchmark

Here we compare the torsional energy proÔ¨Åles of unsubstituted azobenzene predicted by diÔ¨Äerent electronic structure
methods. We analyze results from DFT, DLPNO-UCCSD(T) (domain based local pair-natural orbitals 113‚Äì122 for
unrestricted coupled cluster with single, double, and perturbative triple excitations), SF-TDDFT, CASPT2 (complete
active space with second-order perturbation theory), and SF-EOM-CCSD(dT) (spin-Ô¨Çip equation-of-motion coupled-
cluster with single, double, and perturbative triple excitations 28). The methods are summarized in Table S4. For
DFT we use the B3LYP functional 123 with D3 66 Becke-Johnson (BJ) dispersion 67. For SF-TDDFT we use the
BHHLYP functional both with and without D3BJ dispersion.

For B3LYP-D3BJ we use the double-zeta correlation-consistent (cc) basis set cc-pVDZ 124. This model chemistry
predicts activation free energies of azoarene isomerization that are in good agreement with experiment 11. For
DLPNO-UCCSD(T) we extrapolate to the complete basis-set limit using explicit correlation (F12) 125 with double-
and triple-zeta basis sets (cc-pV(D, T)Z). Such high-accuracy basis sets can be used because of the computational
eÔ¨Éciency of DLPNO. For BHHLYP SF-TDDFT we use the 6-31G* basis 126, since this is a medium-cost, medium-
accuracy basis set that can be used to generate large amounts of data for ML. Similar quality basis-sets are used

S13

cdabfor CASPT2 and SF-EOM-CCSD(dT) due to computational constraints. B3LYP-D3BJ, CASPT2, and DLPNO-
CCSD(T) calculations are performed with Orca 5.2 103. For DFT and CCSD(T) calculations in Orca we use the
resolution of identity 127‚Äì133 and chain-of-spheres 134 approximations (RIJCOSX). The TightPNO setting is used for
DLPNO calculations. All other calculations are performed with Q-Chem 5.3.

We performed a relaxed scan from œâ = 0 to œâ = 180‚ó¶ in 1‚ó¶ steps using our trained NN potential. We constrained
the dihedral angle at each step using a force constant of 1 Ha. We then performed single-point gas-phase calculations
with the methods given above. Calculations were performed on all geometries, except for SF-EOM-CCSD(dT), which
was performed on only nine geometries due to high computational cost. Those points are shown as stars, and are
connected by a smooth line using a quadratic interpolation. Triplet calculations with DLPNO-CCSD(T) failed to
converge and are hence not reported.

Results are shown in Fig. S13. The plots contain several salient features. First, the single-reference methods
DFT and UCCSD(T) predict a cusp near œâ = 90‚ó¶, while the multi-reference methods produce a smooth maximum
of lower energy. This can be seen in Fig. S13(c), where DFT (red) closely tracks UCCSD(T) (green) until œâ = 90‚ó¶.
Both methods have a cusp at œâ = 90‚ó¶, but the energy from DFT is lower. Similar results have been found for
ethylene torsion 10.

As shown in Table S4, DFT gives an activation energy of 35.6 kcal/mol, while UCCSD(T) gives 42.1 kcal/mol. The
cusp in the DFT energy explains why previous work could not optimize the rotational TS with DFT 19. Optimization
methods such as EVF 101 use a quadratic expansion of the PES to locate critical points. This expansion fails in the
vicinity of a cusp, since the Hessian is undeÔ¨Åned at this point.

Previous calculations with DFT found that inversion is the preferred mechanism in gas phase 17. However, given
that the DFT activation energy is 10 kcal/mol higher than CASPT2, such conclusions are not to be trusted. Indeed,
the inversion activation energy was found to be 31 kcal/mol with CASPT2 (10, 8) 22, which is 6 kcal/mol higher
than the CASPT2 rotation barrier here. Thus according to CASPT2, isomerization would proceed by rotation even
if it were not mediated by ISC.

It is also interesting that the maximum value of the CCSD(T) T1-diagnostic 135 is 0.013, which occurs at œâ = 90‚ó¶.
The minimum value is 0.01. A value above 0.02 indicates that the problem has multi-reference character, and that
CCSD(T) should not be trusted. The diagnostic stays well below 0.02 despite the clear multi-reference nature of the
problem. We also note that the unrestricted CCSD(T) results collapsed to the restricted results, with the square
spin (cid:104)S2(cid:105) = 0 for all geometries.

A second important result is that all multi-reference methods predict smooth TS maxima with singlet-triplet
crossings on either side. Examples are CASPT2 and SF-EOM-CCSD(dT) in Fig. S13(a), and SF-EOM-CCSD(dT)
and SF-TDDFT in Fig. S13(b). However, the ‚àÜE‚Ä† and ‚àÜEX predicted by the diÔ¨Äerent methods are in quantitative
disagreement. The activation energies predicted by CASPT2, SF-EOM-CCSD(dT), and SF-TDDFT (D3BJ) are
25.4, 28.7, and 32.6 kcal/mol, respectively. The singlet-triplet crossing energies are 18.7, 23.5, and 28.9 kcal/mol
respectively. Given the disagreement between CASPT2 and SF-EOM, it is not immediately clear which method
should be taken as the ‚Äúground truth‚Äù.

On balance, however, it seems that SF-EOM-CCSD(dT) is likely more accurate. One reason is that its predictions
are in quantitative agreement with MR-CISD+Q (multi-reference conÔ¨Åguration interaction with singles and doubles,
plus a Davidson correction) for a standard rotational conical intersection benchmark 136.
Its treatment of static
correlation should therefore be suÔ¨Écient for azobenzene, while its treatment of dynamic correlation is better than that
of CASPT2. Moreover, its predicted activation enthalpy is in better agreement with experiment. The experimental
activation enthalpy is 21.1 kcal/mol 21, which corresponds to ‚àÜH X in the ISC picture. Our NN calculations indicate
that ‚àÜH X ‚âà ‚àÜEX ‚àí 2.5 kcal/mol for azobenzene. Therefore, ‚àÜH X ‚âà 21.0 kcal/mol with SF-EOM-CCSD(dT),
while ‚àÜH X ‚âà 16.2 kcal/mol with CASPT2. The former agrees better with experiment than the latter.

A third important result is that SF-TDDFT‚Äôs predictions are in qualitative agreement with other multi-reference
methods, but not quantitative agreement. As in the other methods, SF-TDDFT predicts a smooth maximium with
singlet-triplet crossings on either side of the TS. However, its predicted barrier is 3.9 kcal/mol higher than that of
SF-EOM, and 7.2 kcal/mol higher than that of CASPT2. Its singlet-triplet crossing energy is 5.4 kcal/mol higher
than SF-EOM, and 10.2 kcal/mol higher than CASPT2. These errors make it diÔ¨Écult to compare the ISC reaction
rate with the Eyring reaction rate using SF-TDDFT. Hence in the main text we simply assume that all azobenzene
derivatives isomerize through ISC.

Lastly, the plots show the importance of adding dispersion corrections to DFT. Fig. S13(b) and S13(d) show
the results of SF-TDDFT with and without dispersion, respectively. When dispersion is included, all single- and
multi-reference methods are in good agreement away from œâ = 90‚ó¶. When dispersion is not included, SF-TDDFT
overestimates the cis energy, because the attractive force between the two benzene rings is underestimated. Similar
conclusions have been made in previous work 11,19. There is still some residual error in the cis energy, even with
dispersion, which does not occur with B3LYP-D3BJ (panel (c)). This is likely because the D3 parameters for
BHHLYP were chosen for ground-state DFT, not SF-TDDFT.

S14

References

(1) Orgiu, E.; Samor`ƒ±, P. 25th anniversary article: organic electronics marries photochromism: generation of

multifunctional interfaces, materials, and devices. Advanced Materials 2014, 26, 1827‚Äì1845.

(2) Kolpak, A. M.; Grossman, J. C. Azobenzene-functionalized carbon nanotubes as high-energy density solar

thermal fuels. Nano letters 2011, 11, 3156‚Äì3162.

(3) Broichhagen, J.; Frank, J. A.; Trauner, D. A roadmap to success in photopharmacology. Accounts of chemical

research 2015, 48, 1947‚Äì1960.

(4) Lerch, M. M.; Hansen, M. J.; van Dam, G. M.; Szymanski, W.; Feringa, B. L. Emerging targets in photophar-

macology. Angewandte Chemie International Edition 2016, 55, 10978‚Äì10999.

(5) Pyzer-Knapp, E. O.; Suh, C.; G¬¥omez-Bombarelli, R.; Aguilera-Iparraguirre, J.; Aspuru-Guzik, A. What
is high-throughput virtual screening? A perspective from organic materials discovery. Annual Review of
Materials Research 2015, 45, 195‚Äì216.

(6) Axelrod, S.; Shakhnovich, E.; G¬¥omez-Bombarelli, R. Excited state non-adiabatic dynamics of large photo-
switchable molecules using a chemically transferable machine learning potential. Nature Communications
2022, 13, 3440.

(7) Cembran, A.; Bernardi, F.; Garavelli, M.; Gagliardi, L.; Orlandi, G. On the mechanism of the cis-trans
isomerization in the lowest electronic states of azobenzene: S0, S1, and T1. Journal of the American Chemical
Society 2004, 126, 3234‚Äì3243.

(8) Heindl, A. H.; Wegner, H. A. Rational design of azothiophenes‚Äîsubstitution eÔ¨Äects on the switching proper-

ties. Chemistry‚ÄìA European Journal 2020, 26, 13730‚Äì13737.

(9) Kuntze, K.; Viljakka, J.; Titov, E.; Ahmed, Z.; Kalenius, E.; Saalfrank, P.; Priimagi, A. Towards low-energy-
light-driven bistable photoswitches: ortho-Ô¨Çuoroaminoazobenzenes. Photochemical & Photobiological Sciences
2022, 21, 159‚Äì173.

(10) Shao, Y.; Head-Gordon, M.; Krylov, A. I. The spin‚ÄìÔ¨Çip approach within time-dependent density functional
theory: Theory and applications to diradicals. The Journal of chemical physics 2003, 118, 4807‚Äì4818.

(11) Adrion, D. M.; Kaliakin, D. S.; Neal, P.; Lopez, S. A. Benchmarking of density functionals for Z-azoarene
half-lives via automated transition state search. The Journal of Physical Chemistry A 2021, 125, 6474‚Äì6485.

(12) Mukadum, F.; Nguyen, Q.; Adrion, D. M.; Appleby, G.; Chen, R.; Dang, H.; Chang, R.; Garnett, R.;
Lopez, S. A. EÔ¨Écient discovery of visible light-activated azoarene photoswitches with long half-lives using
active search. Journal of Chemical Information and Modeling 2021, 61, 5524‚Äì5534.

(13) GriÔ¨Éths, R.-R.; GreenÔ¨Åeld, J. L.; Thawani, A. R.; Jamasb, A. R.; Moss, H. B.; Bourached, A.; Jones, P.; Mc-
Corkindale, W.; Aldrick, A. A.; Fuchter, M. J.; Lee, A. A. Data-Driven Discovery of Molecular Photoswitches
with Multioutput Gaussian Processes. arXiv preprint arXiv:2008.03226 2022,

(14) Blaiszik, B.; Chard, K.; Pruyne, J.; Ananthakrishnan, R.; Tuecke, S.; Foster, I. The materials data facility:

data services to advance materials science research. Jom 2016, 68, 2045‚Äì2052.

(15) Blaiszik, B.; Ward, L.; Schwarting, M.; GaÔ¨Ä, J.; Chard, R.; Pike, D.; Chard, K.; Foster, I. A data ecosystem

to support machine learning in materials science. MRS Communications 2019, 9, 1125‚Äì1133.

(16) Bandara, H. D.; Burdette, S. C. Photoisomerization in diÔ¨Äerent classes of azobenzene. Chemical Society

Reviews 2012, 41, 1809‚Äì1825.

(17) Dokic, J.; Gothe, M.; Wirth, J.; Peters, M. V.; Schwarz, J.; Hecht, S.; Saalfrank, P. Quantum chemical
investigation of thermal cis-to-trans isomerization of azobenzene derivatives: substituent eÔ¨Äects, solvent eÔ¨Äects,
and comparison to experimental data. The Journal of Physical Chemistry A 2009, 113, 6763‚Äì6773.

(18) Knie, C.; Utecht, M.; Zhao, F.; Kulla, H.; Kovalenko, S.; Brouwer, A. M.; Saalfrank, P.; Hecht, S.; Bl¬¥eger, D.
ortho-Fluoroazobenzenes: Visible light switches with very long-lived Z isomers. Chemistry‚ÄìA European Jour-
nal 2014, 20, 16492‚Äì16501.

S15

(19) Rietze, C.; Titov, E.; Lindner, S.; Saalfrank, P. Thermal isomerization of azobenzenes: on the performance of

Eyring transition state theory. Journal of Physics: Condensed Matter 2017, 29, 314002.

(20) Schweighauser, L.; Strauss, M. A.; Bellotto, S.; Wegner, H. A. Attraction or repulsion? London dispersion
forces control azobenzene switches. Angewandte Chemie International Edition 2015, 54, 13436‚Äì13439.

(21) Asano, T.; Okada, T.; Shinkai, S.; Shigematsu, K.; Kusano, Y.; Manabe, O. Temperature and pressure
dependences of thermal cis-to-trans isomerization of azobenzenes which evidence an inversion mechanism.
Journal of the American Chemical Society 1981, 103, 5161‚Äì5165.

(22) Casellas, J.; Bearpark, M. J.; Reguero, M. Excited-state decay in the photoisomerisation of azobenzene: a

new balance between mechanisms. ChemPhysChem 2016, 17, 3068‚Äì3079.

(23) Liang, R.; Bakhtiiari, A. Multiscale simulation unravels the light-regulated reversible inhibition of dihydrofo-

late reductase by phototrexate. The Journal of Chemical Physics 2022, 156, 245102.

(24) Yue, L.; Liu, Y.; Zhu, C. Performance of TDDFT with and without spin-Ô¨Çip in trajectory surface hopping
dynamics: cis(cid:42)(cid:41)trans azobenzene photoisomerization. Physical Chemistry Chemical Physics 2018, 20, 24123‚Äì
24139.

(25) Lee, S.; Shostak, S.; Filatov, M.; Choi, C. H. Conical intersections in organic molecules: benchmarking mixed-
reference spin‚ÄìÔ¨Çip time-dependent DFT (MRSF-TD-DFT) vs spin‚ÄìÔ¨Çip TD-DFT. The Journal of Physical
Chemistry A 2019, 123, 6455‚Äì6462.

(26) Becke, A. D. A new mixing of Hartree‚ÄìFock and local density-functional theories. The Journal of chemical

physics 1993, 98, 1372‚Äì1377.

(27) Francl, M. M.; Pietro, W. J.; Hehre, W. J.; Binkley, J. S.; Gordon, M. S.; DeFrees, D. J.; Pople, J. A.
Self-consistent molecular orbital methods. XXIII. A polarization-type basis set for second-row elements. The
Journal of Chemical Physics 1982, 77, 3654‚Äì3665.

(28) Manohar, P. U.; Krylov, A. I. A noniterative perturbative triples correction for the spin-Ô¨Çipping and spin-
conserving equation-of-motion coupled-cluster methods with single and double substitutions. The Journal of
chemical physics 2008, 129, 194105.

(29) Axelrod, S.; Schwalbe-Koda, D.; Mohapatra, S.; Damewood, J.; Greenman, K. P.; G¬¥omez-Bombarelli, R.
Learning matter: Materials design with machine learning and atomistic simulations. Accounts of Materials
Research 2022, 3, 343‚Äì357.

(30) Pracht, P.; Bohle, F.; Grimme, S. Automated exploration of the low-energy chemical space with fast quantum

chemical methods. Physical Chemistry Chemical Physics 2020, 22, 7169‚Äì7192.

(31) Axelrod, S.; Gomez-Bombarelli, R. GEOM, energy-annotated molecular conformations for property prediction

and molecular generation. ScientiÔ¨Åc Data 2022, 9, 1‚Äì14.

(32) Axelrod, S.; Gomez-Bombarelli, R. Molecular machine learning with conformer ensembles. arXiv preprint

arXiv:2012.08452 2020,

(33) Ishida, K.; Morokuma, K.; Komornicki, A. The intrinsic reaction coordinate. An ab initio calculation for HNC

‚Üí HCN and H‚àí + CH4 ‚Üí CH4

+H‚àí. The Journal of Chemical Physics 1977, 66, 2153‚Äì2156.

(34) Liu, S.; Srinivasan, S.; Tao, J.; Grady, M. C.; Soroush, M.; Rappe, A. M. Modeling spin-forbidden monomer
self-initiation reactions in spontaneous free-radical polymerization of acrylates and methacrylates. The Journal
of Physical Chemistry A 2014, 118, 9310‚Äì9318.

(35) Sch¬®utt, K.; Unke, O.; Gastegger, M. Equivariant message passing for the prediction of tensorial properties

and molecular spectra. International Conference on Machine Learning. 2021; pp 9377‚Äì9388.

(36) Truong, T. N.; Stefanovich, E. V. A new method for incorporating solvent eÔ¨Äect into the classical, ab initio
molecular orbital and density functional theory frameworks for arbitrary shape cavity. Chemical Physics
Letters 1995, 240, 253‚Äì260.

S16

(37) Barone, V.; Cossi, M. Quantum calculation of molecular energies and energy gradients in solution by a

conductor solvent model. The Journal of Physical Chemistry A 1998, 102, 1995‚Äì2001.

(38) Cossi, M.; Rega, N.; Scalmani, G.; Barone, V. Energies, structures, and electronic properties of molecules in

solution with the C-PCM solvation model. Journal of computational chemistry 2003, 24, 669‚Äì681.

(39) Ang, S. J.; Wang, W.; Schwalbe-Koda, D.; Axelrod, S.; G¬¥omez-Bombarelli, R. Active learning accelerates ab

initio molecular dynamics on reactive energy surfaces. Chem 2021, 7, 738.

(40) Wang, W.; Yang, T.; Harris, W. H.; G¬¥omez-Bombarelli, R. Active learning and neural network potentials
accelerate molecular screening of ether-based solvate ionic liquids. Chemical Communications 2020, 56, 8920.

(41) Malkin, S.; Fischer, E. Temperature dependence of photoisomerization. Part II. Quantum yields of cis-trans

isomerizations in azo-compounds. The Journal of Physical Chemistry 1962, 66, 2482‚Äì2486.

(42) Nagamani, S. A.; Norikane, Y.; Tamaoki, N. Photoinduced hinge-like molecular motion: studies on xanthene-

based cyclic azobenzene dimers. The Journal of organic chemistry 2005, 70, 9304‚Äì9313.

(43) Sierocki, P.; Maas, H.; Dragut, P.; Richardt, G.; V¬®ogtle, F.; De Cola, L.; Brouwer, F.; Zink, J. I. Photoisomer-
ization of azobenzene derivatives in nanostructured silica. The Journal of Physical Chemistry B 2006, 110,
24390‚Äì24398.

(44) Bandara, H. D.; Friss, T. R.; Enriquez, M. M.; Isley, W.; Incarvito, C.; Frank, H. A.; Gascon, J.; Burdette, S. C.
Proof for the concerted inversion mechanism in the trans‚Üícis isomerization of azobenzene using hydrogen
bonding to induce isomer locking. The Journal of organic chemistry 2010, 75, 4817‚Äì4827.

(45) Bandara, H. D.; Cawley, S.; Gasc¬¥on, J. A.; Burdette, S. C. Short-circuiting azobenzene photoisomerization with
electron-donating substituents and reactivating the photochemistry with chemical modiÔ¨Åcation. Chemistry ‚Äì
A European Journal 2011, 2011, 2916‚Äì2919.

(46) Beharry, A. A.; Sadovski, O.; Woolley, G. A. Azobenzene photoswitching without ultraviolet light. Journal of

the American Chemical Society 2011, 133, 19684‚Äì19687.

(47) Moreno, J.; Gerecke, M.; Grubert, L.; Kovalenko, S. A.; Hecht, S. Sensitized two-NIR-photon Z‚ÜíE isomeriza-
tion of a visible-light-addressable bistable azobenzene derivative. Angewandte Chemie International Edition
2016, 55, 1544‚Äì1547.

(48) G¬¥omez-Bombarelli, R.; Aguilera-Iparraguirre, J.; Hirzel, T. D.; Duvenaud, D.; Maclaurin, D.; Blood-
Forsythe, M. A.; Chae, H. S.; Einzinger, M.; Ha, D.-G.; Wu, T., et al. Design of eÔ¨Écient molecular organic
light-emitting diodes by a high-throughput virtual screening and experimental approach. Nature materials
2016, 15, 1120‚Äì1127.

(49) Wazzan, N. A.; Richardson, P. R.; Jones, A. C. Cis-trans isomerisation of azobenzenes studied by laser-coupled
NMR spectroscopy and DFT calculations. Photochemical & Photobiological Sciences 2010, 9, 968‚Äì974.

(50) Kahle, L.; Zipoli, F. Quality of uncertainty estimates from neural network potential ensembles. Physical Review

E 2022, 105, 015311.

(51) Mourot, A.; Kienzler, M. A.; Banghart, M. R.; Fehrentz, T.; Huber, F. M.; Stein, M.; Kramer, R. H.;
Trauner, D. Tuning photochromic ion channel blockers. ACS chemical neuroscience 2011, 2, 536‚Äì543.

(52) Chai, J.-D.; Head-Gordon, M. Long-range corrected hybrid density functionals with damped atom‚Äìatom

dispersion corrections. Physical Chemistry Chemical Physics 2008, 10, 6615‚Äì6620.

(53) Weigend, F.; Ahlrichs, R. Balanced basis sets of split valence, triple zeta valence and quadruple zeta valence
quality for H to Rn: Design and assessment of accuracy. Physical Chemistry Chemical Physics 2005, 7,
3297‚Äì3305.

(54) Dong, M.; Babalhavaeji, A.; Collins, C. V.; Jarrah, K.; Sadovski, O.; Dai, Q.; Woolley, G. A. Near-infrared
photoswitching of azobenzenes under physiological conditions. Journal of the American Chemical Society
2017, 139, 13483‚Äì13486.

S17

(55) Liu, X.-M.; Jin, X.-Y.; Zhang, Z.-X.; Wang, J.; Bai, F.-Q. Theoretical study on the reaction mechanism of
the thermal cis‚Äìtrans isomerization of Ô¨Çuorine-substituted azobenzene derivatives. RSC advances 2018, 8,
11580‚Äì11588.

(56) Bell, R. P. The theory of reactions involving proton transfers. Proceedings of the Royal Society of London.

Series A-Mathematical and Physical Sciences 1936, 154, 414‚Äì429.

(57) Evans, M.; Polanyi, M. On the introduction of thermodynamic variables into reaction kinetics. Transactions

of the Faraday Society 1937, 33, 448‚Äì452.

(58) Kojima, M.; Nebashi, S.; Ogawa, K.; Kurita, N. EÔ¨Äect of solvent on cis-to-trans isomerization of 4-
hydroxyazobenzene aggregated through intermolecular hydrogen bonds. Journal of physical organic chemistry
2005, 18, 994‚Äì1000.

(59) Matazo, D. R.; Ando, R. A.; Borin, A. C.; Santos, P. S. Azo- Hydrazone Tautomerism in Protonated Aminoa-
zobenzenes: Resonance Raman Spectroscopy and Quantum-Chemical Calculations. The Journal of Physical
Chemistry A 2008, 112, 4437‚Äì4443.

(60) RickhoÔ¨Ä, J.; Arndt, N. B.; B¬®ockmann, M.; Doltsinis, N. L.; Ravoo, B. J.; Kortekaas, L. Reversible, Red-Shifted

Photoisomerization in Protonated Azobenzenes. The Journal of organic chemistry 2022, 87, 10605‚Äì10612.

(61) Pracht, P.; Bauer, C. A.; Grimme, S. Automated and eÔ¨Écient quantum chemical determination and energetic

ranking of molecular protonation sites. Journal of Computational Chemistry 2017, 38, 2618‚Äì2631.

(62) Gaspari, R.; Prota, A. E.; Bargsten, K.; Cavalli, A.; Steinmetz, M. O. Structural basis of cis-and trans-

combretastatin binding to tubulin. Chem 2017, 2, 102‚Äì113.

(63) Dieb, T. M.; Ju, S.; Shiomi, J.; Tsuda, K. Monte Carlo tree search for materials design and discovery. MRS

Communications 2019, 9, 532‚Äì536.

(64) Paszke, A. et al. Advances in Neural Information Processing Systems 32 ; 2019; pp 8024‚Äì8035.

(65) Frey, N.; Soklaski, R.; Axelrod, S.; Samsi, S.; Gomez-Bombarelli, R.; Coley, C.; Gadepally, V. Neural Scaling

of Deep Chemical Models. 2022,

(66) Grimme, S.; Antony, J.; Ehrlich, S.; Krieg, H. A consistent and accurate ab initio parametrization of density
functional dispersion correction (DFT-D) for the 94 elements H-Pu. The Journal of chemical physics 2010,
132, 154104.

(67) Grimme, S.; Ehrlich, S.; Goerigk, L. EÔ¨Äect of the damping function in dispersion corrected density functional

theory. Journal of computational chemistry 2011, 32, 1456‚Äì1465.

(68) Paszke, A.; Gross, S.; Chintala, S.; Chanan, G.; Yang, E.; DeVito, Z.; Lin, Z.; Desmaison, A.; Antiga, L.;

Lerer, A. Automatic diÔ¨Äerentiation in pytorch. 2017,

(69) Unke, O. T.; Meuwly, M. PhysNet: A neural network for predicting energies, forces, dipole moments, and

partial charges. Journal of chemical theory and computation 2019, 15, 3678‚Äì3693.

(70) PhysNet. https://github.com/MMunibas/PhysNet.

(71) Gutzeit, V. A.; Acosta-Ruiz, A.; Munguba, H.; H¬®afner, S.; Landra-Willm, A.; Mathes, B.; Mony, J.; Yarot-
ski, D.; B¬®orjesson, K.; Liston, C., et al. A Ô¨Åne-tuned azobenzene for enhanced photopharmacology in vivo.
Cell Chemical Biology 2021, 28, 1648‚Äì1663.

(72) Lv, S.; Li, X.; Yang, L.; Ren, H.; Jiang, J. Computational design of photoswitchable anion receptors: Red-
shifted and bistable di-ortho-Ô¨Çuoro di-ortho-chloro azobenzene derivatives. Chemical Physics 2021, 548,
111246.

(73) Konrad, D. B.; Savasci, G.; Allmendinger, L.; Trauner, D.; Ochsenfeld, C.; Ali, A. M. Computational design
and synthesis of a deeply red-shifted and bistable azobenzene. Journal of the American Chemical Society
2020, 142, 6538‚Äì6547.

S18

(74) RDKit: Open-source cheminformatics. http://www.rdkit.org.

(75) Larsen, A. H. et al. The atomic simulation environment‚Äîa Python library for working with atoms. Journal

of Physics: Condensed Matter 2017, 29, 273002.

(76) Broyden, C. G. The convergence of a class of double-rank minimization algorithms 1. general considerations.

IMA Journal of Applied Mathematics 1970, 6, 76‚Äì90.

(77) Fletcher, R. A new approach to variable metric algorithms. The computer journal 1970, 13, 317‚Äì322.

(78) Goldfarb, D. A family of variable-metric methods derived by variational means. Mathematics of computation

1970, 24, 23‚Äì26.

(79) Shanno, D. F. Conditioning of quasi-Newton methods for function minimization. Mathematics of computation

1970, 24, 647‚Äì656.

(80) Grimme, S. Exploration of chemical compound, conformer, and reaction space with meta-dynamics simulations
based on tight-binding quantum chemical calculations. Journal of chemical theory and computation 2019, 15,
2847‚Äì2862.

(81) Grimme, S.; Bohle, F.; Hansen, A.; Pracht, P.; Spicher, S.; Stahn, M. EÔ¨Écient quantum chemical calculation
of structure ensembles and free energies for nonrigid molecules. The Journal of Physical Chemistry A 2021,
125, 4039‚Äì4054.

(82) Grimme, S.; Bannwarth, C.; Dohm, S.; Hansen, A.; Pisarek, J.; Pracht, P.; Seibert, J.; Neese, F. Fully
automated quantum-chemistry-based computation of spin‚Äìspin-coupled nuclear magnetic resonance spectra.
Angewandte Chemie International Edition 2017, 56, 14763‚Äì14769.

(83) Bannwarth, C.; Ehlert, S.; Grimme, S. GFN2-xTB‚ÄìAn accurate and broadly parametrized self-consistent
tight-binding quantum chemical method with multipole electrostatics and density-dependent dispersion con-
tributions. Journal of chemical theory and computation 2019, 15, 1652‚Äì1671.

(84) Spicher, S.; Grimme, S. Robust atomistic modeling of materials, organometallic, and biochemical systems.

Angewandte Chemie International Edition 2020, 59, 15665‚Äì15673.

(85) Conformer-Rotamer Ensemble Sampling Tool. https://github.com/grimme-lab/crest.

(86) Liu, D. C.; Nocedal, J. On the limited memory BFGS method for large scale optimization. Mathematical

programming 1989, 45, 503‚Äì528.

(87) Ryckaert, J.-P.; Ciccotti, G.; Berendsen, H. J. Numerical integration of the cartesian equations of motion
of a system with constraints: molecular dynamics of n-alkanes. Journal of computational physics 1977, 23,
327‚Äì341.

(88) Riniker, S.; Landrum, G. A. Better informed distance geometry: using what we know to improve conformation

generation. Journal of chemical information and modeling 2015, 55, 2562‚Äì2574.

(89) Hawkins, P. C.; Skillman, A. G.; Warren, G. L.; Ellingson, B. A.; Stahl, M. T. Conformer generation with
OMEGA: algorithm and validation using high quality structures from the Protein Databank and Cambridge
Structural Database. Journal of chemical information and modeling 2010, 50, 572‚Äì584.

(90) Hawkins, P. C.; Nicholls, A. Conformer generation with OMEGA: learning from the data set and the analysis

of failures. Journal of chemical information and modeling 2012, 52, 2919‚Äì2936.

(91) Pattanaik, L.; Ingraham, J. B.; Grambow, C. A.; Green, W. H. Generating transition states of isomerization

reactions with deep learning. Physical Chemistry Chemical Physics 2020, 22, 23618‚Äì23626.

(92) Xu, M.; Luo, S.; Bengio, Y.; Peng, J.; Tang, J. Learning neural generative dynamics for molecular conformation

generation. International Conference on Learning Representations. 2020.

(93) Shi, C.; Luo, S.; Xu, M.; Tang, J. Learning gradient Ô¨Åelds for molecular conformation generation. International

Conference on Machine Learning. 2021; pp 9558‚Äì9568.

S19

(94) Ganea, O.; Pattanaik, L.; Coley, C.; Barzilay, R.; Jensen, K.; Green, W.; Jaakkola, T. Geomol: Torsional geo-
metric generation of molecular 3D conformer ensembles. Advances in Neural Information Processing Systems
2021, 34 .

(95) Xu, M.; Wang, W.; Luo, S.; Shi, C.; Bengio, Y.; Gomez-Bombarelli, R.; Tang, J. An end-to-end framework for
molecular conformation generation via bilevel programming. International Conference on Machine Learning.
2021; pp 11537‚Äì11547.

(96) Roney, J. P.; Maragakis, P.; Skopp, P.; Shaw, D. E. Generating realistic 3D molecules with an equivariant

conditional likelihood model. 2021,

(97) Luo, S.; Shi, C.; Xu, M.; Tang, J. Predicting molecular conformation via dynamic graph score matching.

Advances in Neural Information Processing Systems 2021, 34 .

(98) Jing, B.; Corso, G.; Barzilay, R.; Jaakkola, T. S. Torsional diÔ¨Äusion for molecular conformer generation.

ICLR2022 Machine Learning for Drug Discovery. 2022.

(99) Xu, M.; Yu, L.; Song, Y.; Shi, C.; Ermon, S.; Tang, J. GeoDiÔ¨Ä: A Geometric diÔ¨Äusion model for molecular

conformation generation. International Conference on Learning Representations. 2021.

(100) Hoogeboom, E.; Satorras, V. G.; Vignac, C.; Welling, M. Equivariant diÔ¨Äusion for molecule generation in 3D.

arXiv preprint arXiv:2203.17003 2022,

(101) Baker, J. An algorithm for the location of transition states. Journal of Computational Chemistry 1986, 7,

385‚Äì395.

(102) Powell, M. J. Recent advances in unconstrained optimization. Mathematical Programming 1971, 1, 26‚Äì57.

(103) Neese, F.; Wennmohs, F.; Becker, U.; Riplinger, C. The ORCA quantum chemistry program package. The

Journal of Chemical Physics 2020, 152, 224108.

(104) Lykhin, A. O.; Kaliakin, D. S.; dePolo, G. E.; Kuzubov, A. A.; Varganov, S. A. Nonadiabatic transition state
theory: Application to intersystem crossings in the active sites of metal-sulfur proteins. International Journal
of Quantum Chemistry 2016, 116, 750‚Äì761.

(105) Levine, B. G.; Coe, J. D.; Mart¬¥ƒ±nez, T. J. Optimizing conical intersections without derivative coupling vectors:
application to multistate multireference second-order perturbation theory (MS-CASPT2). The Journal of
Physical Chemistry B 2008, 112, 405‚Äì413.

(106) Grimme, S. Supramolecular binding thermodynamics by dispersion-corrected density functional theory.

Chemistry‚ÄìA European Journal 2012, 18, 9955‚Äì9964.

(107) Ochterski, J. W. Vibrational analysis in Gaussian. 1999; https://gaussian.com/vib/.

(108) Nikitin, E. E.; Kearsley, M. J. Theory of Elementary Atomic and Molecular Processes in Gases; Clarendon

Press: Oxford, 1974.

(109) Delos, J. B. On the reactions of N2 with O. The Journal of Chemical Physics 1973, 59, 2365‚Äì2369.

(110) Fermi, E. Notes on quantum mechanics; University of Chicago Press, 1995.

(111) Valiev, R.; Cherepanov, V.; Baryshnikov, G. V.; Sundholm, D. First-principles method for calculating the rate
constants of internal-conversion and intersystem-crossing transitions. Physical Chemistry Chemical Physics
2018, 20, 6121‚Äì6133.

(112) Huix-Rotllant, M.; Natarajan, B.; Ipatov, A.; Wawire, C. M.; Deutsch, T.; Casida, M. E. Assessment of
noncollinear spin-Ô¨Çip Tamm‚ÄìDancoÔ¨Ä approximation time-dependent density-functional theory for the photo-
chemical ring-opening of oxirane. Physical Chemistry Chemical Physics 2010, 12, 12811‚Äì12825.

(113) Neese, F.; Hansen, A.; Liakos, D. G. EÔ¨Écient and accurate approximations to the local coupled cluster singles
doubles method using a truncated pair natural orbital basis. The Journal of chemical physics 2009, 131,
064103.

S20

(114) Neese, F.; Hansen, A.; Wennmohs, F.; Grimme, S. Accurate theoretical chemistry with coupled pair models.

Accounts of chemical research 2009, 42, 641‚Äì648.

(115) Neese, F.; Wennmohs, F.; Hansen, A. EÔ¨Écient and accurate local approximations to coupled-electron pair
approaches: An attempt to revive the pair natural orbital method. The Journal of chemical physics 2009,
130, 114108.

(116) Liakos, D. G.; Hansen, A.; Neese, F. Weak molecular interactions studied with parallel implementations of
the local pair natural orbital coupled pair and coupled cluster methods. Journal of Chemical Theory and
Computation 2011, 7, 76‚Äì87.

(117) Hansen, A.; Liakos, D. G.; Neese, F. EÔ¨Écient and accurate local single reference correlation methods for high-

spin open-shell molecules using pair natural orbitals. The Journal of chemical physics 2011, 135, 214102.

(118) Riplinger, C.; Neese, F. An eÔ¨Écient and near linear scaling pair natural orbital based local coupled cluster

method. The Journal of chemical physics 2013, 138, 034106.

(119) Riplinger, C.; Sandhoefer, B.; Hansen, A.; Neese, F. Natural triple excitations in local coupled cluster calcu-

lations with pair natural orbitals. The Journal of chemical physics 2013, 139, 134101.

(120) Riplinger, C.; Pinski, P.; Becker, U.; Valeev, E. F.; Neese, F. Sparse maps‚ÄìA systematic infrastructure for
reduced-scaling electronic structure methods. II. Linear scaling domain based pair natural orbital coupled
cluster theory. The Journal of chemical physics 2016, 144, 024109.

(121) Datta, D.; Kossmann, S.; Neese, F. Analytic energy derivatives for the calculation of the Ô¨Årst-order molecular
properties using the domain-based local pair-natural orbital coupled-cluster theory. The Journal of Chemical
Physics 2016, 145, 114101.

(122) Saitow, M.; Becker, U.; Riplinger, C.; Valeev, E. F.; Neese, F. A new near-linear scaling, eÔ¨Écient and accurate,
open-shell domain-based local pair natural orbital coupled cluster singles and doubles theory. The Journal of
chemical physics 2017, 146, 164105.

(123) Becke, A. D. Density-functional thermochemistry. III. The role of exact exchange. The Journal of chemical

physics 1993, 98, 5648.

(124) Dunning Jr, T. H. Gaussian basis sets for use in correlated molecular calculations. I. The atoms boron through

neon and hydrogen. The Journal of chemical physics 1989, 90, 1007‚Äì1023.

(125) PavoÀásevi¬¥c, F.; Peng, C.; Pinski, P.; Riplinger, C.; Neese, F.; Valeev, E. F. SparseMaps‚ÄìA systematic infrastruc-
ture for reduced scaling electronic structure methods. V. Linear scaling explicitly correlated coupled-cluster
method with pair natural orbitals. The Journal of chemical physics 2017, 146, 174108.

(126) Hehre, W. J.; Radom, L.; Schleyer, P. v. R.; Pople, J. Ab initio Molecular Orbital Theory. 1986.

(127) Whitten, J. L. Coulombic potential energy integrals and approximations. The Journal of Chemical Physics

1973, 58, 4496‚Äì4501.

(128) Baerends, E.; Ellis, D.; Ros, P. Self-consistent molecular Hartree-Fock-Slater calculations I. The computational

procedure. Chemical Physics 1973, 2, 41‚Äì51.

(129) Dunlap, B. I.; Connolly, J.; Sabin, J. On some approximations in applications of XŒ± theory. The Journal of

Chemical Physics 1979, 71, 3396‚Äì3402.

(130) Van Alsenoy, C. Ab initio calculations on large molecules: The multiplicative integral approximation. Journal

of computational chemistry 1988, 9, 620‚Äì626.

(131) Kendall, R. A.; Fr¬®uchtl, H. A. The impact of the resolution of the identity approximate integral method on

modern ab initio algorithm development. Theoretical Chemistry Accounts 1997, 97, 158‚Äì163.

(132) Eichkorn, K.; Treutler, O.; ¬®Ohm, H.; H¬®aser, M.; Ahlrichs, R. Auxiliary basis sets to approximate Coulomb

potentials. Chemical physics letters 1995, 240, 283‚Äì290.

S21

(133) Eichkorn, K.; Weigend, F.; Treutler, O.; Ahlrichs, R. Auxiliary basis sets for main row atoms and transition
metals and their use to approximate Coulomb potentials. Theoretical Chemistry Accounts 1997, 97, 119‚Äì124.

(134) Neese, F.; Wennmohs, F.; Hansen, A.; Becker, U. EÔ¨Écient, approximate and parallel Hartree-Fock and hybrid
DFT calculations. A ‚Äòchain-of-spheres‚Äô algorithm for the Hartree‚ÄìFock exchange. Chemical Physics 2009, 356,
98‚Äì109.

(135) Lee, T. J.; Taylor, P. R. A diagnostic for determining the quality of single-reference electron correlation

methods. International Journal of Quantum Chemistry 1989, 36, 199‚Äì207.

(136) Gozem, S.; Krylov, A. I.; Olivucci, M. Conical intersection and potential energy surface features of a model
retinal chromophore: Comparison of EOM-CC and multireference methods. Journal of chemical theory and
computation 2013, 9, 284‚Äì292.

S22

