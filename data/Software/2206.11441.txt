2
2
0
2

n
u
J

3
2

]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[

1
v
1
4
4
1
1
.
6
0
2
2
:
v
i
X
r
a

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

1

Contextual Isotope Ranking Criteria for Peak
Identiﬁcation in Gamma Spectroscopy Using a
Large Database

Alexis Aguilar-Arevalo, Xavier Bertou, Carles Canet, Miguel A. Cruz-P´erez, Alexander Deisting, Adriana Dias,
Juan Carlos D’Olivo, J. Francisco Favela-P´erez, Estela A. Garc´es, Adiv Gonz´alez Mu˜noz, Jaime Octavio
Guerra-Pulido, Javier Mancera-Alejandrez, Daniel Jos´e Mar´ın-L´ambarri, Mauricio Mart´ınez-Montero, Jocelyn
Monroe, Sean Paling, Simon Peeters, Paul R. Scovell, Cenk T¨urko˘glu, Eric V´azquez-J´auregui, Joseph Walding

Abstract—Isotope identiﬁcation is a recurrent problem in γ
spectroscopy with high purity germanium detectors. In this work,
new strategies are introduced to facilitate this type of analysis.
Five criteria are used to identify the parent isotopes making a
query on a large database of γ-lines from a multitude of isotopes
producing an output list whose entries are sorted so that the
γ-lines with the highest chance of being present in a sample are
placed at the top. A metric to evaluate the performance of the
different criteria is introduced and used to compare them. Two of
the criteria are found to be superior than the others: one based
on fuzzy logic, and another that makes use of the γ relative
emission probabilities. A program called histoGe implements
these criteria using a SQLite database containing the γ-lines of
isotopes which was parsed from WWW Table of Radioactive
Isotopes. histoGe is Free Software and is provided along with
the database so they can be used to analyze spectra obtained
with generic γ-ray detectors.

Index Terms—Gamma-ray spectroscopy, Heuristic algorithms,

Isotope identiﬁcation, Ranking

I. INTRODUCTION

This work is supported by the STFC Global Challenges Research Fund
(Foundation Awards, Grant ST/R002908/1 and Translation Awards, Grant
EP/T015586/1), DGAPA UNAM grants PAPIIT-IT100420 and PAPIIT-
IN108020, CONACyT grants CB-240666 and A1-S-8960. M. A. Cruz-P´erez
acknowledges the support of “Programa de Posgrado en Ciencias de la Tierra
at Universidad Nacional Aut´onoma de M´exico.”

A. Aguilar-Arevalo, J. C. D’Olivo, J. F. Favela-P´erez, J. O. Guerra-
Pulido, and M. Mart´ınez Montero are with Instituto de Ciencias Nu-
cleares, Universidad Nacional Aut´onoma de M´exico, Coyoac´an, CDMX,
M´exico, C.P. 04510 (e-mails: francisco.favela@correo.nucleares.unam.mx,
jaime.guerra@correo.nucleares.unam.mx,
mauricio.martinez@nucleares.unam.mx).

X. Bertou and J. F. Favela-P´erez are with Centro At´omico Bariloche,

CNEA/CONICET/IB, Bariloche, Argentina.

A. Deisting, A. Dias, J. Monroe, and J. Walding are with Royal Holloway,

University of London, Egham Hill, United Kingdom.

E. A. Garc´es, A. Gonz´alez Mu˜noz, D. J. Mar´ın-L´ambarri, and E. V´azquez-
J´auregui are with Instituto de F´ısica, Universidad Nacional Aut´onoma de
M´exico, A. P. 20-364, M´exico D. F. 01000, Mexico.

C. Canet and M. A. Cruz-P´erez are with Centro de Ciencias de la
Atm´osfera. Universidad Nacional Aut´onoma de M´exico, Ciudad Universitaria,
Coyoac´an, 04510, Ciudad de M´exico, Mexico.

J. Mancera-Alejandrez is with Facultad de Ingenier´ıa, Universidad Nacional

Aut´onoma de M´exico, M´exico.

G AMMA ray spectroscopy commonly uses High Purity

Germanium Detectors (HPGe) to acquire the energy
spectra of samples with a varied isotopic composition. An-
alyzing and identifying the isotopes present in the sample is
a challenging problem given the multitude of gamma lines
from which to choose. Thus, computational tools are needed
to analyze a spectrum and extract useful information [1], [2].
Many programs have been written to make these calculations
in the past [3]–[10]. However, just a few provide the capability
to identify isotopes from a given spectrum. Some previous
attempts have been made to perform that identiﬁcation us-
ing a relational database, for example: Hyperlab [4] has a
functionality to make a “graphical iteration process” followed
by a procedure to solve iteratively an “identiﬁcation matrix”,
however, no documentation about
the method nor reports
on its identiﬁcation accuracy are provided for this software.
GammaLab [5] uses a database called “NUCDATA” which
includes information “for quick calculations for 408 radioiso-
topes” [11], however, it is limited in extension in comparison
to other well-known databases [12]–[14] and it does not
present a study about its accuracy and its real capability of
identifying isotopes in a sample. ASPRO-NUC [15] has a
wide set of spectral analysis tools: peak search, deconvolution,
background line and simulation, spectrum smoothing, among
others. It also has algorithms to identify peaks using a database
of 45,000 γ-lines corresponding to 2200 radionuclides. How-
ever, the authors recognized that identiﬁcation in this way
“is hardly possible” and they opted to develop an “actual
isotope library”. Sandia National Laboratories provide two
programs for assisting with analyzing spectral information
from nuclear radiation. InterSpec [16] provides multipeak
ﬁtting isotope identiﬁcation capabilities as well as activity
calculation considering shielding from a variety of materials.
The other one is called Peak Map [17] which is written in C#,
it considers a set of parameters such as distance from the mean
and half-life penalization (among others) to assign a score to
the γ-lines and sorts with respect to that before displaying the
candidate γ-lines.

S. Paling and P. R. Scovell are with Boulby Underground Laboratory,

C. Canet

University of Sussex, Brighton, United Kingdom.

Boulby Mine, Saltburn-by-the-Sea, United Kingdom.

S. Peeters and C. T¨urko˘glu are with Department of Physics and Astronomy,

There are many areas in which γ-spectroscopy is applied,
e.g., high energy physics research, environmental sciences,
and food contamination. An important application lies in the
is also with Instituto de Geof´ısica, Universidad Nacional
control of radioactive materials crossing borders around the
Aut´onoma de M´exico, Ciudad Universitaria, Coyoac´an 04510, Ciudad de
world, where there is a need to have instruments and methods
M´exico, M´exico.
©2022 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including
reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or
reuse of any copyrighted component of this work in other works. URL: https://ieeexplore.ieee.org/document/9733910 DOI: 10.1109/TNS.2022.3159175

 
 
 
 
 
 
IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

2

to identify radioactive nuclei
that are potentially harmful
even in small amounts. While automated analysis for this
problem is desirable, a study from 2007 concluded that a
“secondary analysis of spectra by a trained spectroscopist is
frequently necessary” to identify isotopes through their γ-lines
[18]. Since then, new techniques have been explored to make
automated isotope identiﬁcation more reliable independently
of the ﬁeld of application, to mention a few: swarm optimiza-
tion [19], Fischer linear discriminant analysis [20], Bayesian
statistics approach [21], [22], neural networks (NN) [23]–[29],
hybrid fuzzy-genetic algorithms [30]. Some of these methods
have been used to perform automated peak identiﬁcation [31].
There are also developments, using the GEANT4 toolkit,
for providing training data to machine learning models [32].
Herein, new methods have been proposed, implemented, and
tested using the histoGe code [33], a Free Software (GNU
Public License [34]) with many features that are described in
its User’s Manual [35].

This work deals with the γ-line identiﬁcation problem in a
manner similar to what a search engine does when presenting
the results of a query. It assigns a numerical value called “rank
value” (RV) to each candidate γ-line that may explain the
presence of the peak in a spectrum.

This work has been developed as an effort

Five criteria to identify peaks are presented, some of them
are based on simple counting while others use more complex
calculations, e.g., Mamdani’s fuzzy inference system (FIS).
Known γ spectra were identiﬁed using the proposed criteria
and their performance was evaluated using an ad hoc metric.
to support
the research and educational activities that will be carried
the Laboratorio Subterr´aneo de Mineral del Chico
out at
(LABChico), which will be located inside a decommissioned
silver mine at the Comarca Minera, Hidalgo, M´exico, inside
the UNESCO Global Geopark [36]. LABChico will host HPGe
to conduct studies of low radioactivity in water, soils, and
products intended for human consumption, aiming to develop
techniques to signal the presence of lead in drinking water.
At the same time, it will serve as a training hub for students
and researchers interested in radiation detectors, techniques
for particle and astroparticle physics experiments, geology
and mine engineering, among other areas. The histoGe
computational software was developed as an effort to facilitate
γ-ray spectroscopy and to identify isotopes from recorded
spectra inside the laboratory. Technical details about its im-
plementation and capabilities, how to use it, and its database
of histoGe are described in the user’s manual [35].

in section II,

This paper is organized as follows:

the
methodology used to identify isotopes and a brief explanation
of the operation of the program and some key concepts are
presented; in section III, ﬁve criteria to ﬁnd the most suitable
γ-lines that can be responsible for the peaks observed in
the spectra are described;
the experimental
setup is described; in section V four cases are studied: one
is an example of how the general method works, the second
one analyzed the spectra obtained with point-like radioactive
sources through the Nuclear Sciences Institute HPGe (ICN-
HPGe) detector, the third example is the analysis of spectra
of some samples of rocks and water and the fourth example

in section IV,

presents the identiﬁcation of isotopes using a spectrum taken
from the literature. The last section shows the conclusions of
this work.

II. METHODOLOGICAL APPROACH
The histoGe software is written in Python 3 [37] and can
run practically in any of the mainstream operating systems
available nowadays. The basic process of line sorting used
in histoGe is depicted in Figure 1. Energy query ranges
are determined by either processing an experimental spectrum
to ﬁnd peaks, or by hand. histoGe uses a Savitzki-Golay
ﬁlter [38] to smooth out spectra, detect the peaks and generate
these query ranges. The width of the query ranges contains
information about the resolution of the detector.

An info ﬁle [35] contains the energy query ranges associ-
ated with each peak. Once the ﬁle has been read, a query to the
database is performed for each peak. As a result, a set of lists,
one list per interval, are obtained from those queries. The lists
contain information of all γ-lines that can be located inside
the speciﬁed energy ranges. Once the RVs are calculated, each
γ-line list is sorted and printed on the screen or stored in
a text ﬁle (ﬁgure 1). The ranking operation calculates and
assigns to each γ-line the RV used for sorting in descending
order depending on the criterion (section III describes them
in detail). This RV, or score, can be constructed so as to take
into consideration global aspects of the spectrum, such as, for
example, the possibility that a given isotope or decay chain
may be responsible for several peaks, bringing context into
the analysis. Once a RV has been assigned to all the γ-line
candidates under the peaks of interest, they are sorted with
respect to the other candidates within the same peak (locally),
positioning the best candidates at the top of the list. Positions
span from 0 to the number of the γ-lines found in the query
minus one. A position close to 0 indicates a high preference for
the γ-line to explain features present in the spectrum. Although
all criteria need an info ﬁle, not all criteria require the
spectrum. This general procedure is schematically represented
in ﬁgure 2.

The ranking methods can be classiﬁed in three broad
categories according the way the RV is calculated. Those
where the RV is calculated for each γ-line individually without
considering the other γ-lines of the same isotope found for
the other peaks (III-A), those in which the RV is calculated
for each isotope using all the γ-lines found in all peaks (III-B,
III-C, and III-D) and those in which the RV takes into account
all isotopes in the decay chains (III-E). Depending on the
category to which a criterion belongs to, the RV is assigned
to a γ-line, or to all γ-lines of an isotope, or to all γ-lines of
all isotopes in a chain, correspondingly.

The whole operation is based on a local database (LDB)
[39] (11 MB of disk space) that was constructed in part from
the one accessible in [12]. Additional data was computed
and added to have enough information to be used with the
ranking criteria such as decay chains and normalized emission
probabilities [35]. The total number of entries in the LDB
is 92453, which is 226 times larger in comparison to [11]
and more than twice the used in [15]. The database entry (γ-
line) with the highest energy belongs to 20Na with 11258.9

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

3

TABLE I: CRITERIA NAME, CODE, RANKING CATEGORY
AND THE SECTION WHERE EACH IS DESCRIBED.

Name
γ-line coincidence
probability
Improved Peak
Explanation Power
Relative Emission
Probability (REP)
Fuzzy logic
Decay chain using REP

Code

Ranking category

Section

B

E

F

H
J

γ-line

isotope

isotope

isotope
chain

III-A

III-B

III-C

III-D
III-E

A. γ-line coincidence probability

The distance d (in keV) from the peak mean to each of the
γ-lines is used to calculate the probability (PG) that the peak
can be explained by a γ-line. This is done using the cumulative
distribution function (CDF) for the Gaussian distribution:

PG(d, µ = 0, σ) = 2CDF(−|d|, 0, σ)

(1)

where µ is the mean of the CDF and σ is the peak’s standard
deviation obtained from a Gaussian ﬁt. The RV is assigned
directly to each γ-line and it is given by equation (1). The
γ-lines are then sorted according to their RVs.

B. Improved Peak Explanation Power

A single parent isotope could have multiple γ-lines appear-
ing as peaks in a spectrum. Every time a γ-line of a particular
isotope is matched with a peak, the chance that the isotope
is present in the sample is increased, making it more suitable
to explain the spectrum as a whole. The RV is calculated as
the ratio of the number of γ-lines from a given isotope that
fall within the peaks of the spectrum, to the number of γ-lines
from that isotope expected in the whole range of the spectrum
(from the ﬁrst to the last peak). The RV is in the semi-closed
interval (0,1] and sorting is done in descending order.

C. Relative Emission Probability (REP)

The REP was calculated and included in the LDB for each
γ-line. This had to be done since many of the entries had
non-numeric or missing EP values. When not available, EP
were set to the minimum EP for the isotope [35]. Using the
REP allows to associate a set of γ-lines with their respective
parent isotopes knowing that, for a given isotope, the REP of
its γ-lines should add up to 1 [35].

The RV is calculated as the sum of the REP of those γ-lines
found in the queries for a particular isotope. This method also
gives rank values in the (0,1] and they are sorted in descending
order.

D. Ranking With a Fuzzy Inference System

Fuzzy logic [40] was used to compose a more powerful
RV from the combination of three inputs. It is a method
to formalize “approximate” reasoning and it
to
treat uncertainty and vagueness. Unlike classical logic, where
propositions can only be true or false; propositions in fuzzy

is a tool

Fig. 1: Graphical description of the basic process. In general,
the RV is criterion dependent which normally involves other
peaks. Note that the γ-line closest to the peak mean is not at
the top positions because sorting depends of the RV.

keV. Figure 3 shows the energy distribution of γ-lines in
the LDB. There is an apparent under representation in the
vicinity of 511 keV (≈ 50%). This might indicate a systematic
over-subtraction of positron annihilation backgrounds in the
reported measurements.

Using a large database introduces a problem to peak iden-
tiﬁcation because peaks in a spectrum could be explained by
many γ-lines, even if the peak has a narrow width. The ranking
criteria presented in Section III aim to overcome this issue.

III. RANKING CRITERIA
Ten criteria were originally designed to identify γ-lines from
potential isotopes that could be present in a sample using the
peaks found in its γ spectrum. They were labeled arbitrarily
from A to J, however, only the most signiﬁcant are reported
here using their original names and codes. Information about
all the methods is reported in the histoGe’s User Manual
[35]. The criteria can be applied individually or in combina-
tions in arbitrary order.

These criteria differ from other previously reported methods
in how they utilize the information such as the emission
probability (EP), the relative emission probability (REP), the
ratio between the number of peaks identiﬁed in the spectrum
and the number of peaks found in the database for certain
isotopes, among others. Each criterion has merit by itself,
but they can be combined to obtain better results. Before
the analysis begins, the spectra must be properly calibrated
to obtain reliable results.

The criteria described in this work, their code and their

ranking category are listed in table I.

When two gamma lines in the same peak get the same RV,
other criteria are used as tiebreakers to decide in favor of one
of them, e.g., for criterion F, criterion E is used and if the tie
persists, then, criterion D is used. For criterion H, RM SEmod
and criterion F were used. Next, a description of each criterion
is given.

energy query rangecandidate   -linesSorted list-lineposition012910n-1RVIEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

4

Fig. 2: Flowchart of the processing done for a given info ﬁle. Some ranking operations may need extra information not present
in the info ﬁle such as the gamma spectrum.

and B is the estimated background under the peak, together
with the REP. Then, RM SEM od is deﬁned as:

RM SEM od =

(cid:118)
(cid:117)
(cid:117)
(cid:116)

PT
Pr

1
N

N
(cid:88)

i=1

(cid:20)(cid:18) Ai
AT

(cid:19)

−

(cid:18) Igi
IgT

(cid:19)(cid:21)2

,

(2)

where N is the total number of peaks, Ai is the net area of
the i-th peak, AT is the sum of all the net areas, Igi is the
REP of the i-th peak and IgT is the sum of the REP for all
lines identiﬁed for the respective isotope. The factor PT
that
Pr
modiﬁes the RM SE in equation (2), was included to penalize
those isotopes that explain fewer peaks of the spectrum in
comparison to the expected number of peaks.

Each input has three fuzzy sets and the output has ﬁve fuzzy
sets. Fuzzy sets were deﬁned using the well-known sigmoid
and Gaussian functions whose mathematical expressions are,
respectively, given by:

fs(x, ko, xo) =

1
1 + e−ko(x−xo)

,

(3)

where ko and xo are the parameters of the sigmoid function,
and

fg(x, σ, µ) = e

−(x−µ)2
2σ2

,

(4)

where σ and µ are the parameters of the Gaussian function.
Figure 4 shows the name, curve, the mathematical function
of the fuzzy sets used in the FIS. The parameters of the
fuzzy sets were established considering the designer’s own
knowledge about what the linguistic variables Very Low (VL),
Low (L), Medium (M), High (H) or Very High (VH) could
mean considering that
the output hypersurface must be a
monotonically increasing one.

The rules used for the inference are of the form:

IF x1 is RM SEk

m and x2 is PeakRatiok
THEN yk is Afﬁnityk
q ,

n and x3 is Igk
Rp

where k is an index that refers to k-th rule as is shown in table
II and m, n, p and q are the indices of their respective fuzzy
sets which can be VL, L, M, H or VH depending on whether
they are input or output fuzzy sets, as shown in ﬁgure 4. The
rules used for the inference process are shown in table II.
Since there are three fuzzy sets for each input, there are twenty

Fig. 3: Energy distribution of the entries in the LDB in 1 keV
bins, note the presence of the over-depleted zone (close to 511
keV) shown more clearly at the insert.

logic can have a degree of truth between 0 and 1 [41]. A fuzzy
inference system (FIS) performs a deductive inference through
IF-THEN rules with fuzzy sets [42]. A well known and straight
forward way to implement a FIS is through the Mamdani’s
inference [43]. The steps to perform this type of inference
are: fuzziﬁcation of the inputs; inference, which is divided in:
calculation of the antecedents, implication and aggregation of
rules; and ﬁnally, defuzzyﬁcation via the centroid method [41]
which was used to convert a fuzzy output to a crisp number,
this value is used as a RV.

Three inputs (antecedents) and one output (consequent)
were used in the FIS designed to identify and rank the isotopes.
The inputs of the FIS are: a “modiﬁed Root Mean Square
Error” (RM SEM od), the peak ratio deﬁned as Pr
where Pr
PT
is the number of peaks explained by the isotope and PT is
the total number γ-lines within the spectrum’s range, and the
REP (IgR ); the output is a value between 0 and 1 and, in
this context, it will be called “Afﬁnity”. It reﬂects the degree
to which a set of γ-lines can be considered to belong to a
particular isotope.

The RM SEM od is deﬁned using some statistical methods
to analyze γ-ray spectra presented by Gilmore [1] such as the
net area of a peak A = G − B, where G is the peak’s integral

 1 10 100 0 2000 4000 6000 8000 10000 12000CountsEnergy/keVDB Energy Distribution 10 20 30 40 50 60 70 440 460 480 500 520 540e-+e+ at 511keVIEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

5

Fuzzy sets of the FIS

E. Chain using Relative Emission Probability

1
0.8
0.6
0.4
0.2
0

1
0.8
0.6
0.4
0.2
0

1
0.8
0.6
0.4
0.2
0

1

0.8

0.6

0.4

0.2

0

L:fs (−100, 0.1)

M:fg (0.08, 0.2)

H:fs(100, 0.3)

0.8

1

0

0.2

0.4
0.6
RMSEmod

L:fs(−50, 0.55)

M:fg (0.125, 0.7)

H:fs (50, 0.85)

0

0.2

0.6
0.4
Peak Ratio

0.8

1

L:fs (−50, 0.35)

M:fg (0.125, 0.5)

H:fs(50, 0.65)

0

0.2

0.4

0.6

0.8

1

REP

VL:fs (−100, 0.2)

L:fg (0.085, 0.3)

M:fs(0.085, 0.5)

H:fg (0.085, 0.7)

VH:fs(100, 0.8)

0

0.2

0.4

0.6

0.8

1

Afﬁnity

Fig. 4: Parameters of the fuzzy sets used in the FIS. Sig-
moid and Gaussian functions parameters are fs(x, ko, xo) and
fg(x, σ, µ), respectively. The names of the fuzzy sets are: VL
is “Very Low”, L is “Low”, M is “Medium”, H is “High” and
VH is “Very High”.

seven rules with their consequents chosen from ﬁve fuzzy sets.
During the design of the FIS, it was decided that ﬁve output
fuzzy sets were enough to categorize the combinations of the
inputs.

In some spectra, the presence of some peaks can be due to
γ-lines from several isotopes that are connected to each other
via a decay chain. This motivates the design of a criterion that
rank chains instead of isotopes alone.

For this criterion, the RV is calculated as follows: REP
of the γ-lines found in the query ranges belonging to all
the isotopes in a given chain are summed and averaged. As
described in section II, the RV is assigned to all the γ-lines
of all isotopes that belong to the chain. Sorting is done in
descending order.

IV. EXPERIMENTAL SETUP

The results in sections V-A and V-B below were obtained
with spectra from a set of radioactive sealed calibration sources
(Table III) and they were acquired with an EG&G-ORTEC
Hyper Pure Germanium detector in the Detectors Laboratory
at the Institute of Nuclear Science of the National Autonomous
University of Mexico (UNAM), hereafter referred to as ICN-
HPGe detector, whose characterization has been reported
elsewhere [44]. The data acquisition system (DAQ) was a
PX5-HPGe multi-channel analyzer (MCA) and a digital pulse
processor (DPP) software analyzer provided by Amptek [45].

V. RESULTS

A. Example with a 60Co sealed point-like source

As a ﬁrst example, criterion F (III-C) was applied over the
spectrum obtained in the ICN-UNAM from the 60Co point-
like source reported in table III. For this test, an info ﬁle
with two query ranges, associated with each of the two more
prominent gamma lines of this isotope was used. Table IV
shows the isotopes in the top 10 positions output and their
corresponding gamma lines. The two energy ranges are shown
in red in ﬁgure 5 as well as the 10 best candidates γ-lines are
shown in the inserts.

Notice that, since this criterion assigns a RV per isotope,
γ-lines from the same isotope found in the two query ranges
have the same RV. For the ﬁrst query range (Co60 1: from
1160.84 keV to 1182.18 keV), the isotope 60Co is found at the
top position by itself, but for the other one (Co60 2: 1323.41
keV to 1340.54 keV) it is tied with 53Co, since all expected
gamma lines are found in the query ranges for both isotopes.
A tie breaking based on criterion E is effected, which places
60Co at the top (†).

B. Comparison of criteria using known γ-sources

Once the fuzzy sets are deﬁned and the rules given, the
Mamdani inference can be implemented to calculate the afﬁni-
ties of isotopes. All γ-lines that share the same parent get
the same RV. They are later sorted in descending order using
as a tiebreaker criterion the RM SEM od. This criterion was
chosen for its simplicity and because it is already an input of
the fuzzy rank method, however, other criteria such as IgR
could be used to untie isotopes with the same RV. Efﬁciency
corrected spectra were used, but no important improvements
were observed in the results got with this method.

To compare the performance of the criteria discussed in sec-
tion III, histoGe was employed to identify the γ-lines from
point-like sealed sources of table III through their γ spectra.
Table V summarizes the results, showing the positions after
sorting the RV of their corresponding γ-lines, query ranges
and γ-line properties. The positions given by InterSpec
[16] are shown for comparison.

Figure 6 compares the performance of the various criteria
using an ad hoc metric which is calculated as follows: a score
(S) is assigned to each γ-line (table V), in the following way:

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

6

TABLE II: FIS RULES USED IN H I S T OGE’S FUZZY RANK. MVL, ML, MM, MH AND MVH REFER TO THE AFFINITY
OUTPUT FUZZY SETS: VERY LOW, LOW, MEDIUM, HIGH AND VERY HIGH, RESPECTIVELY.

REPLow
REPMedium
REPHigh

PeakRatioLow
ML
MM
MVH

RM SELow
PeakRatioMedium
MM
MH
MVH

PeakRatioHigh
MM
MH
MVH

PeakRatioLow
MVL
MM
MH

RM SEMedium
PeakRatioMedium
ML
MM
MH

PeakRatioHigh
ML
MH
MVH

PeakRatioLow
MVL
ML
MH

RM SEHigh
PeakRatioMedium
MVL
MM
MH

PeakRatioHigh
MVL
MH
MH

Fig. 5: 60Co spectrum obtained from the point-like source described in table III. Peak ranges for energy queries are drawn in
red. Plot was made using histoGe [33]. The zoomed-in inserts show the peaks along with ﬁrst 10 γ-lines (tagged by their
position) in accordance to table IV.

Scriterion(pγ−line) =

(cid:40)

10 − pγ−line
0

pγ−line < 10
pγ−line ≥ 10

,

(5)

where pγ−line is the list position of the γ-line (starting from
0) for a given criterion. For example, in the 109Cd radioactive
source (table V), the γ-line located at 88.04 keV was sorted

TABLE III: ENERGY AND HALF-LIFE OF THE POINT-LIKE
SEALED SOURCES USED TO COMPARE RANKING CRITERIA.
ALL SOURCES HAD AN INITIAL ACTIVITY OF 1 µCi
(EXCEPT 137Cs WITH 0.1 µCi , AS OF JANUARY 2019 AND
A 20% UNCERTAINTY, AND 241Am WITH 121nCi AS OF
AUGUST 1982).

Source

241Am

133Ba

109Cd
57Co
60Co
137Cs
54Mn
22Na
65Zn

γ-lines [keV]
13.81, 27.03, 33.19, 43.42, 59.54, 69.76
98.97, 102.98, 120.36, 125.33
53.1, 79.6, 81.0, 160.6, 223.3, 276.3
302.8, 356.0, 383.8
88.07
122.0, 136.0
1173.2, 1332.5
662.0
835.0
1275.0
1115.0

half-life [yr]

432.5

10.5

1.27
0.745
5.27
30.1
0.855
2.6
0.668

by criterion F at position 2 (third place) an it receives a score
of 10 − 2 = 8.

Then, the following operation is done for obtaining the

normalized score (NS) for a speciﬁc criterion:

NScriterion =

(cid:80)

γ−line Scriterion(pγ−line)
MS

(6)

where the maximum possible score is given by MS = 10 ×
Totalγ−lines = 10 × 27 = 270. The NS range is between 0
and 1, being 0 and 1 the worst and the best possible results,
respectively.

Under these expressions, criterion B performed poorly (the
expected γ-line positions are mostly above 9), it was taken as
the baseline criteria during comparison with other methods.
This means that coincidence probability is not relevant because
it depends on a good calibration and its uncertainty. The fact
that the density of γ-lines is so high affects the performance,
because many other γ-lines could be as near as or nearer
than that of interest. Criterion E was capable to identify 133Ba
and 60Co but showed a poor performance for 241Am because
it has 171 γ-lines in [39] and 132 γ-lines in the range of
its spectrum but only 22 γ-lines were observed. Criterion F
improves the results obtained with the criterion E. In the worst
case, it equals the performance of criterion E, but the fact that
it uses the REP makes it able to focus on those γ-lines that

y/2,3,5,6IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

7

TABLE IV: THE ENERGY, GAMMA INTENSITY, PARENT
ISOTOPE AND RANK VALUE FOR THE TOP 10 ISOTOPES
FOUND IN EACH OF THE 2 QUERY RANGES (Co60 1,
Co60 2), OBTAINED FROM RUNNING CRITERION F ON THE
60Co SEALED SOURCE SPECTRUM. SEE TEXT FOR DETAILS.

Ig (%)

Rank Value

1.000
0.889
0.806
0.806
0.731
0.722
0.579
0.491
0.442
0.400

99.97
1.70
98.00
98.00
19.00
84.00
0.34
100.00
0.26
64.00

Co601: from 1160.84 to 1182.18 PBR = 8.2
Parent
60Co
120Sb
62mCo
62mCo
120In
62Co
62Cu
128mSn
60Cu
34Si
Co602: from 1323.41 to 1340.54 PBR = 24.4
Parent
60Co
53Co
125In
60Cu
210At
53mCo
53mFe
142Cs
142Cs
150Pm

99.99
5.60
71.00
88.00
0.47
86.00
87.00
0.52
0.52
17.50

1.000
1.000
0.693
0.442
0.347
0.305
0.304
0.221
0.221
0.192

Rank Value

Ig (%)

Position

0
1
2
3
4
5
6
7
8
9

Position
0†
1
2
3
4
5
6
7
8
9

Eg [keV]

1173.237 (4)
1171.3 (2)
1172.9 (1)
1172.9 (1)
1171.3 (2)
1172.9 (1)
1172.9 (1)
1168.8 (5)
1173.237 (4)
1178.5 ()

Eg [keV]

1332.501 (5)
1328.2 (3)
1335.04 (10)
1332.501 (5)
1324.1 (2)
1328.2 (3)
1328.2 (3)
1333.4 (3)
1333.4 (3)
1324.51 (6)

identiﬁcation of peaks with low PBR are not affected.

1

0.8

0.96

0.89

0.79

0.6

S
N

0.56

0.26

0.4

0.2

0

0.71

0.32

B

E

F
H
Ranking criteria

H+

J

IS

Fig. 6: Comparison of the performance of the criteria in
identifying the γ-lines present in the point-like sources of
Table III and an extended 210Pb source through the normalized
score (NS) deﬁned by (6). The score of InterSpec software [16]
is shown in the last bar (IS).

have the highest EP giving little importance to those γ-lines
that could be undetectable with a certain detector. Criterion H
gave the best results, in particular, when those isotopes with a
relatively small REP are ﬁltered to discard them from sorting
and ranking (H+). Fuzzy ranking is able to get approximately
0.95 or 0.87 of the maximum score with and without ﬁltering
(H and H+), respectively. The overall performance of H+
makes it the best one with a score of 0.955. This result suggests
that combining the criteria to make identiﬁcation algorithms
can give better results than using individual criteria alone. For
criterion J, fair results were obtained. A simple inspection
of the results reveals that this criterion correctly identiﬁes
the γ-lines 7 of the 10 radioactive sources in Table I. In
particular, the γ-lines for 241Am all get ranked at positions
higher than 34 and the line of 54Mn was placed at position
251. In general, 241Am was hard to be identiﬁed by histoGe
and this penalizes some criteria more than others.

Nonetheless, no signiﬁcant improvements were observed
when efﬁciency corrected spectra were used as input. There-
fore, identiﬁcation could be achieved without knowing the
detector’s efﬁciency [44]. Besides, a test was implemented to
ﬁnd the dependence of the ranking results against the peak-
to-background ratio (PBR) deﬁned as the ratio of the area
enclosed by a peak to the area of the background beneath it,
in an interval ±3σ around the peak, and calculated using an
exponential plus second order polynomial ﬁt. Fake peaks with
variable amplitude were introduced in known spectra and it
was found that, once the PDA detect the peak, the position of
that γ-line is unaffected for methods E, F and J, and negligible
changes in position were observed for B, H and H+. Thus,

C. Performance over generic γ spectra

To explore the capability of the program to identify iso-
topes in spectra that may contain an arbitrary combination of
isotopes, various test were performed using previously studied
samples [46], [47]: one had traces of 210Pb (sample A) and
the other contained 177Lu and 131I (sample B) and a rock
sample taken from the inside of LabChico’s site (sample C).
It was known that sample A was spiked with lead and it
was acquired with the high purity germanium detector of the
Institute of Physics of the UNAM (IF-BEGe detector) [44]
with a exposure time of 24 h, spectrum of sample B was
acquired inside the Boulby Underground Germanium Suite
(BUGS) facility [48] at Boulby Underground Laboratory [49]
and a previous analysis of sample B identiﬁed 177Lu and 131I
[46] and sample C is a rock taken during geotechnical studies
[47] and assayed with the ICN-UNAM HPGe [44].

Table VI shows the results of applying criteria F and H to
samples A, B and C. Criteria F and H were chosen for this test
because they showed the best performance in the test with the
point-like sealed sources. For the sample A, in addition to the
210Pb γ-line at 46.5 keV (positions 1 for rank F and 0 for rank
H), two X-rays associated with 210Pb were observed, however,
their assigned positions (higher than 20) are irrelevant because
the database does not contain reliable information about X-
rays. This motivates the addition of X-ray information to the
LDB. For sample B, ranks H and H+ identiﬁed 131I, 177Lu
and 40K at positions 0 for all the γ-lines which is the best
possible result. The 40K seen in sample B can be safely
attributed to the water given the ultra low background of the
BUGS detector [50]. About sample C, 40K was successfully

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

8

TABLE V: POSITION FOR EVERY γ-LINE EXPECTED FROM THE SPECTRA OF THE RADIOACTIVE SOURCES OF TABLE III
USING THE CRITERIA DESCRIBED IN SECTION III. THE ISOTOPES AND THEIR γ-LINES PROPERTIES, ENERGY QUERY
RANGE, THE NUMBER OF ISOTOPES FOUND IN THE QUERY RANGE, THE POSITIONS OF EACH γ-LINE ARE SHOWN FOR
EACH CRITERION AND, BESIDES, THE IS’S INDIVIDUAL PERFORMANCE. THE TOP γ-LINE POSITION IS ZERO. 210Pb
SPECTRA WAS OBTAINED FROM SAMPLE A FROM TABLE VI. FOR 241Am RANGES COULD INCLUDE MORE THAN ONE
γ-LINE REPORTED IN THE DATABASE, IN THIS CASE ALL ARE RANKED TOGETHER.

γ-line Properties

Query Range

Eg [keV]
26.344
33.196
43.423
51.010
59.541
69.760
75.800
79.100
98.970
102.98
120.36
125.30
53.161
79.613
80.997
160.613
223.234
276.398
302.853
356.017
383.851

88.04(5)
122.0614
136.474
1173.237
1332.501

661.657

834.848

1274.53

46.539

1115.546

Ig (%)
2.4
0.13
0.07
0.00
35.9
0.00
0.00
0.00
0.02
0.02
0.00
0.00
2.2
2.62
34.06
0.65
0.45
7.16
18.33
62.05
8.94

3.61
85.6
10.68
99.97
99.99

85.1

99.98

99.94

4.25

50.6

Emin
24.187
31.122
42.355
48.031
56.673
68.316
75.411
78.649
96.695
100.502
116.561
123.656
51.353
78.327
78.327
156
220
273.776
299.866
352.929
380.345

Emax
28.355
35.550
44.483
51.869
63.802
71.735
78.530
82.377
100.024
105.081
121.999
127.075
56.238
84.538
84.538
166
227
279.103
306.077
360.140
387.556

85.439
120.080
135.534
1170.839
1329.410

660.302

831.232

91.561
124.737
138.000
1176.184
1336.537

663.393

838.346

1270.843

1277.957

45.704

47.067

1101.568

1133.256

PBR
10.5
1.7
0.2
0.2
19.5
0.03
0.1
0.1
0.5
0.5
2.9
0.6
8.3
5.1
-
0.06
0.06
7.5
7.5
197.6
29.5

9.7
11.4
17.2
8.2
24.4

13.0

19.1

22.2

0.9

3.3

Size
200
198
143
194
414
206
177
211
251
345
372
239
258
344
344
681
220
273
347
382
453

378
315
135
222
89

142

343

253

68

1151

B
0
0
1
158
0
28
153
163
17
2
198
1
84
206
206
61
52
41
10
11
7

5
70
52
28
2

2

61

14

31

12

γ-line Position
H+
H
F
1
1
7
0
1
3
0
5
5
0
1
2
1
3
9
0
0
3
2
4
5
0
2
5
0
5
1
0
2
3
1
1
4
0
0
5
0
0
0
0
0
1
0
0
1
1
1
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0
0

2
3
2
0
0

1

0

0

1

1

4
0
0
0
0

1

0

0

0

4

4
0
0
0
0

1

0

0

0

1

E
75
61
50
45
114
50
53
56
81
104
124
74
0
1
1
0
0
0
0
0
0

2
2
2
0
0

1

0

0

1

5

J
34
41
29
33
82
42
39
35
44
51
24
38
5
8
8
9
17
10
10
4
14

1
0
0
0
0

0

251

0

1

4

IS
4
1
9
9
1
1
9
13
4
5
4
2
n/a
3
6
0
0
2
11
0
1

1
1
2
0
0

0

0

0

1

0

241Am

133Ba

109Cd

57Co

60Co

137Cs
54Mn
22Na
210Pb
65Zn

identiﬁed by ranks F, H and H+. The photopeak observed at
2614 keV was attributed to 208Tl because it belongs to 232Th
decay chain and was found at positions 3 for ranks F, H and
H+. Two photopeaks were attributed to 214Bi because they
belong to 238U decay chain, however, no further peaks that
could have increased the conﬁdence were identiﬁed due to the
high background at energies below the potassium peak in the
spectrum. 214Bi has 214 entries at the database but only two
were considered resulting in a low REP which affected the
behavior of H rank.

D. Ranking without raw data

It is often the case that the spectrum data is only available
in image format and ranks E, F and J have the advantage of
performing ranking without the raw data of the spectrum. To
show this capability, a calibrated spectrum in which isotopes
were identiﬁed and marked with tags ( ﬁgure 2 of [51]) was
analyzed using ranks F and J. The peak maxima and Full
Width at Half Maximum reported (FWHM) were used to
construct an info ﬁle [35] with 17 query ranges. The query
ranges were deﬁned as two times the FWHM except for 234Th
in which only one FWHM was used. The positions and RV

for each γ-line are shown in Table VII. For rank F, all the
γ-lines known to be present were placed within the ﬁrst ten
positions to explain the peak where they are found. 12 out
of 17 were placed among the top three and 3 were positioned
fourth. Criterion J placed the lines within the ﬁrst ten positions
except for 234mPa and 40K which could not be associated with
a speciﬁc decay chain in the LDB.

E. Comparison between histoGe and InterSpec

Table VIII shows a performance comparison between
histoGe and InterSpec from Sandia Labs [16], whose
output is also an ordered list. Two spectra were analyzed:
sample B of Table VI and the background spectrum of the
Lumpsey detector, at Boulby, (B-BKG) [50]. For sample B,
rank H of histoGe outperforms InterSpec while rank
F is slightly better, in particular, to identify 177Lu and the
80.185 keV photopeak of 131I. For B-BKG, InterSpec was
capable of ranking correctly more γ-lines at ﬁrst position in
comparison to the best result of histoGe, however, there is
one peak in which it fails completely (208Tl at 510.77 eV)
because it is confused with e − e+ annihilation line. So, if ∆
is deﬁned as the position difference between InterSpect

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

9

TABLE VI: POSITIONS AND RANKS, ACCORDING TO CRITERIA F, H AND H+, OF PARENT ISOTOPES KNOWN TO BE
PRESENT IN THE TWO WATER SAMPLES (A AND B), AND AT THE INTENDED SITE FOR LABCHICO (C). THE QUERY
RANGES AND γ-RAY PROPERTIES ARE ALSO SHOWN. *214BI
HAS 214 γ-LINE AND DUE TO ONLY 2 LINES WERE IDENTIFIED, REP IS SMALL WHICH AFFECTS THE BEHAVIOR OF H RANK.

sample

A

B

C

isotope
210Pb
177Lu
177Lu
131I
131I
131I
131I
40K
40K
214Bi*
214Bi*
208Tl

γ-ray properties

Query Range

Eg [keV]

Ig (%)

Emin

Emax

PBR

Size

46.53
112.94
208.36
80.18
284.30
364.48
636.98
1460.83
1460.83
1693.3
1764.49
2614.5

4.25
6.4
11.0
2.62
6.14
81.7
7.17
11.0
11.0
0.01
15.4
99.0

45.70
111.11
206.8
79.3
282.5
362.51
634.64
1457.0
1450.07
1690.0
1762.45
2600

47.06
115.14
209.8
82.0
285.5
366.1
639.0
1463.53
1467.09
1694.0
1766.96
2620

0.950
1.010
2.489
0.169
2.289
11.321
3.550
541.346
0.436
0.106
0.383
0.957

69
279
191
158
176
189
237
158
423
88
92
150

Position
H

H+

0
0
0
0
0
0
0
0
0
19
19
3

0
0
0
0
0
0
0
0
0
0
1
3

F

1
1
3
4
0
0
0
0
0
1
3
3

F

1
0.965
0.965
0.969
0.969
0.969
0.969
1.000
1.000
0.117
0.117
0.432

RV
H

0.873
0.904
0.904
0.912
0.912
0.912
0.912
0.873
0.873
0.120
0.120
0.417

H+

0.873
0.999
0.999
0.999
0.999
0.999
0.999
0.873
0.873
0.468
0.468
0.674

TABLE VII: RV AND POSITIONS CALCULATED FOR 4 CRITERIA FROM THE PUBLISHED PARENT ISOTOPES ON FIGURE 2
OF [51]. NOTE FROM THE SIZE COLUMN THAT THE NUMBER OF CANDIDATES IS IN THE HUNDREDS.

isotope
210Pb
234Th
226Ra
212Pb
214Pb
208Tl
214Bi
137Cs
228Ac
228Ac
234mPa
214Bi
60Co
60Co
40K
214Bi
208Tl

γ-line properties

Eg [keV]
46.53
63.29
187.1
238.63
351.93
583.2
609.31
661.65
911.20
968.97
1001.03
1120.2
1173.23
1332.5
1460.83
1764.49
2614.5

Ig (%)
4.25
4.8
-
43.3
37.6
84.5
-
85.1
25.8
15.8
0.84
15.1
99.0
99.0
11.0
15.4
99.0

Query Range [keV]
Emin
45.42
62.34
184.2
236.64
349.9
581.20
607.30
659.7
909.21
967.27
999.02
1118.3
1171.2
1330.5
1458.8
1762.5
2612.5

Emax
49.98
64.20
188.20
241.97
353.9
585.27
611.35
663.7
913.26
971.03
1003.08
1122.35
1175.2
1334.5
1462.5
1766.5
2616.5

Position
J
F
4
3
1
9
4
2
5
1
4
5
8
1
0
2
5
1
9
2
7
0
166
0
3
1
0
0
0
0
75
0
1
0
1
2

RV

J
0.288
0.288
0.288
0.218
0.288
0.218
0.288
0.255
0.181
0.181
0
0.288
0.499
0.499
0
0.288
0.218

F
1
0.188
0.333
0.912
0.536
0.801
0.581
1
0.383
0.383
0.512
0.581
1
1
1
0.581
0.801

Size
227
127
278
306
265
219
225
198
182
155
188
151
176
360
268
85
39

and the histoGe’s best result, it can be seen that (cid:80) ∆ > 0,
which means that histoGe had a better overall performance
when both, sample B and B-BKGD are considered.

The paradigm by which histoGe identiﬁes the isotopes
in comparison to InterSpec’s.
is completely different
histoGe performs better when more photopeaks of an
isotope are observed in the spectrum, however, sometimes
InterSpec works better when individual peaks are con-
sidered in such a way that even identiﬁcation of 2 unrelated
peaks could make InterSpec fail the isotopes’ identiﬁcation
unlike histoGe which is able to manage contextually many
isotopes per run.

F. Computational cost

The computational cost of criteria F and H is due to
querying the LDB, calculating the RV, and sorting all the
γ-lines. A Monte Carlo analysis was performed to estimate
the time used for these process. The procedure followed
to implement this test is described next: .info ﬁles were
randomly constructed with a variable number of γ-lines per
ﬁle, and then, ranked. The center of the energy range was

chosen randomly between 200 keV and 2500 keV per each γ-
line and its width was calculated using a distributed normally
random numbers with µ = 0 and σ = 5. The minimum
energy range is 1 keV to avoid small intervals that could
contain few γ-lines. This procedure was repeated 100 times.
The computer used to execute this analysis has a AMD Ryzen
7 processor 4800H, 16 GB of RAM and a SSD. A program was
made to measure the execution time of each call to histoGe
using those .info ﬁles generated randomly. For H criterion,
an arbitrary spectrum was chosen considering that its energy
range is larger than the query ranges. Figure 7 shows that
the execution time follows a non-linear relationship in which
increasing the number of peaks by 10 does not even get the
execution time doubled. These results show that histoGe
has reasonable (≥ 20s) execution times for real spectra in
which the number of γ-lines do not exceed a hundred peaks.
As expected, H is slower than F, but for a low number of
peaks, there is not a considerable difference between them.

On the other hand, note that processing a spectrum form
peak identiﬁcation using the PDA through the histoGe’s
peak ﬁnder tool to γ-line identiﬁcation using some criteria
could take a few minutes, however, due to the peak ﬁnding

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

10

TABLE VIII: COMPARISON OF THE RESULTS OBTAINED BETWEEN H I S T OGE VS. IN T E RSP E C (IS). ∆ MEANS THE
DIFFERENCE OF POSITION OF IN T E RSP E C MINUS POSITION OF H I S T OGE. A POSITIVE ∆ FAVORS H I S T OGE. DUE TO
214Bi HAS MORE THAN 2 HUNDREDS OF PEAKS THE INFORMATION TO IDENTIFY IT CLEARLY IS INCOMPLETE MAKING
HARDER THE IDENTIFICATION FOR H I S T OGE. †RANGE HAD TO BE MADE WIDER SO IS COULD MAKE IDENTIFICATION.
††222Rn, e − e+ AND 214Pb WERE IDENTIFIED AT POSITIONS 0, 1 AND 2, RESPECTIVELY AND BOTH ISOTOPES WERE
FOUND IN THE BACKGROUND.

spectrum

Sample B

B-BKG

Known isotope

Range

isotope
177Lu
177Lu
131I
131I
131I
131I
40K
214Bi
214Bi
214Bi
214Bi
214Bi
40K
228Ac
228Ac
228Ac
212Pb
212Pb
212Pb
208Tl
208Tl
208Tl
208Tl
214Pb
214Pb
214Pb

Eg [keV]

Emin

Emax

112.94
208.36
80.18
284.30
364.48
636.98
1460.83
609.31
768.35
1120.28
1764.49
2204.21
1460.83
911.20
968.97
1588.19
47.91
238.63
300.087
510.77
583.19
860.56
2614.53
241.99
295.22
351.93

111.1131
206.8
79.3
282.5
362.51
634.64
1457.0
607.7
767.80
1119.10
1763.35
2203.50
1459.5
909.7
967.57
1587.5
45.1
237.00
298.9
509.82
581.8
859.2
2613.65
240.3
293.76
350.52

115.1425
209.8
82.0
285.5
366.1
639.0
1463.53
611.3
769.82
1122.55
1767.20
2207.16
1462.8
913.16
971.23
1589.77
47.92
239.95
301.3
512.16
584.89
862.5
2617.31
243.2
296.3
353.3

F

1
3
4
0
0
0
0
2
1
1
1
0
0
1
0
0
3
0
0
2
1
0
1
1
0
2

Position
H+
H

IS ∆

0
0
0
0
0
0
0
1
0
1
1
0
0
1
0
0
0
0
0
3††
2
0
2
0
1
3

0
0
0
0
0
0
0
2
0
1
1
0
0
2
0
0
0
0
0
0
1
0
0
0
0
0

1
2
6
0
0
0
0
0
0
0
0
0
0
0
0
0
0†
0
0
26
0
0
0
4
0
0

1
2
6
0
0
0
0
-1
0
-1
-1
0
0
-1
0
0
0
0
0
26
-1
0
0
4
0
0

algorithms are not fully accurate more time could be required
to adjust the query ranges in the info ﬁle by a trained
spectroscopist.

F criterion
H criterion

s
/
e
m

i
t

n
o
i
t
u
c
e
x
e

e
g
a
r
e
v
A

60

40

20

0

100

102
101
Number of γ-lines

103

Fig. 7: Average and error bars (2σ) of the execution time of
criteria F (blue) and H (red) vs. the number γ-lines per info
ﬁle.

VI. CONCLUSIONS
histoGe is a tool for the identiﬁcation of peaks in a γ
spectrum using the information in a large database containing

92,453 gamma lines and 2,200 radioactive nuclides. The pro-
gram implements different criteria to rank and sort candidate
isotopes to explain the presence of peaks in a spectrum with
a philosophy inspired by that of a search engine.

Five different criteria (III) were presented and their perfor-
mances were compared according to their ability to identify
the γ-lines from a suite of sealed calibrated radioactive gamma
sources via an ad hoc deﬁned metric. Two of the methods
stood out in performance under this test: one based on the use
of Relative Emission Probabilities (F), and one using fuzzy
logic (H) which combine information used in other criteria.
An enhanced version of the latter (H+) where γ-lines with
relatively small REPs are discarded achieved ∼ 95% efﬁciency
to identify the isotopes in a set of sealed radioactive sources.
Under the same assumptions, InterSpec was also tested
giving an efﬁciency of 70%, demonstrating that under this
conditions histoGe performed better. 241Am was a hard
isotope to identify, as only a small fraction of its γ-lines
are typically visible in spectra. The score increases quite
noticeably when 241Am is not considered.

histoGe was used to identify the γ-lines in three arbitrary
samples: water with lead (sample A), London tap water (sam-
ple B) and the rock of LabChico’s site (sample C). For sample
A, a γ-line of 210Pb was identiﬁed with accuracy but X-rays
were not because the database has not complete information
about X-rays. For sample B, criterion H got the best score
when 177Lu, 131I and 40K were identiﬁed. For sample C, 214Bi
was hardly identiﬁed by rank H due to it having 290 γ-lines
but rank F performed better and H+ identiﬁed it with accuracy.

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

11

An advantage of histoGe is that it is capable of making
isotope identiﬁcation using only the ranges of the photopeaks
without the raw data of the spectrum. Criteria E, F, and J are
capable of doing this. Then, a published spectrum was ranked
with criterion F, it was capable to identify all of them within
the 10 ﬁrst positions, in fact most of them were among the
ﬁrst three places. Chain rank (III-E) identiﬁed all γ-lines in
the top ten places except 40K and 234mPa because there is
not a decay chain associated with them. This result motivates
further research about how to improve this rank.

histoGe’s results of identiﬁcation of two samples were
compared to those obtained with InterSpec of SandiaL-
abs. In general, the best result of histoGe outperformed
InterSpec. Besides, from the results presented in section
V-E and ﬁgure 6, it can be seen that histoGe is capable
to make identiﬁcation when multiple related or unrelated γ-
lines are given at the same time, on the contrary, InterSpec
cannot identify accurately unrelated peaks but is highly accu-
rate in individual identiﬁcation. These ﬁndings may change
if both are tested under different conditions. Using the ideas
presented in this work, a histoGe and InterSpec could
be combined to get an even more accurate one.

From the Monte Carlo study, it was found that the compu-
tational cost for real spectra is affordable. The overall results
have shown that histoGe is a tool capable to make reliable
identiﬁcation of isotopes through γ-spectroscopy with results
comparable or even better than other similar software, which
makes it able to be applied in teaching research and industrial
applications. However, in its current state, we recommend
that a trained spectroscopist analyze the results obtained with
histoGe or InterSpec to get a better interpretation.

ACKNOWLEDGMENT
The authors would like to thank Prof. Peter Ekstr¨om (Lund
University) and Prof. Dirk Rudolph (Lund University) for
giving permission to use their database. We acknowledge the
help of the Radiological Safety Unit of ICN-UNAM.

REFERENCES

[1] G. Gilmore, Practical gamma-ray spectroscopy.

John Wiley & Sons,

2011.

[2] D. K. Fagan, S. M. Robinson, and R. C. Runkle, “Statistical methods
applied to gamma-ray spectroscopy algorithms in nuclear security mis-
sions,” Applied Radiation and Isotopes, vol. 70, no. 10, pp. 2428–2439,
2012.

[3] C. Kalfas, M. Axiotis, and C. Tsabaris, “SPECTRW: a software package
for nuclear and atomic spectroscopy,” Nuclear Instruments and Methods
in Physics Research Section A: Accelerators, Spectrometers, Detectors
and Associated Equipment, vol. 830, pp. 265–274, 2016.

[4] A. Simonits, J. ¨Ost¨or, S. K´alvin, and B. Fazekas, “HyperLab: A new
concept in gamma-ray spectrum analysis,” Journal of Radioanalytical
and Nuclear Chemistry, vol. 257, no. 3, pp. 589–595, 2003.

[5] M. Wasim, “GammaLab: a suite of programs for k 0-NAA and gamma-
ray spectrum analysis,” Journal of radioanalytical and nuclear chem-
istry, vol. 285, no. 2, pp. 337–342, 2010.

[6] D. Arnold, M. Blaauw, S. Fazinic, and V. P. Kolotov, “The 2002 IAEA
intercomparison of software for low-level γ-ray spectrometry,” Nuclear
Instruments and Methods in Physics Research Section A: Accelerators,
Spectrometers, Detectors and Associated Equipment, vol. 536, no. 1-2,
pp. 196–210, 2005.

[7] S. P. Nielsen and S. E. P´alsson, “An intercomparison of software for
processing Ge γ-ray spectra,” Nuclear Instruments and Methods in
Physics Research Section A: Accelerators, Spectrometers, Detectors and
Associated Equipment, vol. 416, no. 2-3, pp. 415–424, 1998.

[8] M. Blaauw, V. O. Fernandez, P. Van Espen, G. Bernasconi, R. C. Noy,
H. M. Dung, and N. Molla, “The 1995 IAEA intercomparison of γ-
ray spectrum analysis software,” Nuclear Instruments and Methods in
Physics Research Section A: Accelerators, Spectrometers, Detectors and
Associated Equipment, vol. 387, no. 3, pp. 416–432, 1997.

[9] G. S. Zahn, F. A. Genezini, and M. Moralles, “Evaluation of
peak-ﬁtting software for gamma spectrum analysis,” arXiv preprint
arXiv:1511.04362, 2015.

[10] M. M. Guilherme S. Zahn, Frederico A. Genezini, “Evaluation of peak-
ﬁtting software for gamma spectrum analysis,” arXiv:1511.04362v1,
2015.

[11] M. Wasim and J. Zaidi, “NUCDATA: a useful database for NAA
lab,” Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment, vol.
481, no. 1-3, pp. 760–764, 2002.

[12] R. F. S.Y.F. Chu, L.P. Ekstr¨om, “WWW Table of Radioactive Isotopes,”
http://nucleardata.nuclear.lu.se/toi/, 2019, database version 1999-02-28.
[13] I. A. E. A. (IAEA), “Live chart of nuclides,” https://nds.iaea.org/relnsd/

vcharthtml/VChartHTML.html, 2020, accessed: 2020-06-03.

[14] “National Nuclear Data Center,” https://www.nndc.bnl.gov/, 2020, ac-

cessed: 2020-04-30.

[15] V. Kolotov and V. Atrashkevich, “Software ASPRO-NUC: gamma-ray
spectrometry, routine NAA, isotope identiﬁcation and data manage-
ment,” Journal of Radioanalytical and Nuclear Chemistry, vol. 193,
no. 2, pp. 195–206, 1995.

[16] Sandialabs, “Interspec version 11.2.3,” https://github.com/sandialabs/

InterSpec, 2020.

[17] ——, “Peak-map,” https://github.com/sandialabs/Peak-Map, 2020.
[18] C. J. Sullivan, S. Garner, M. Lombardi, K. Butterﬁeld, and M. Smith-
Nelson, “Evaluation of key detector parameters for isotope identiﬁca-
tion,” in 2007 IEEE Nuclear Science Symposium Conference Record,
vol. 2.

IEEE, 2007, pp. 1181–1184.

[19] H. Shahabinejad and N. Vosoughi, “Analysis of complex gamma-ray
spectra using particle swarm optimization,” Nuclear Instruments and
Methods in Physics Research Section A: Accelerators, Spectrometers,
Detectors and Associated Equipment, vol. 911, pp. 123–130, 2018.
[20] D. Boardman and A. Flynn, “A gamma-ray identiﬁcation algorithm
based on Fisher linear discriminant analysis,” IEEE Transactions on
Nuclear Science, vol. 60, no. 1, pp. 270–277, 2012.

[21] C. J. Sullivan and J. Stinnett, “Validation of a Bayesian-based isotope
identiﬁcation algorithm,” Nuclear Instruments and Methods in Physics
Research Section A: Accelerators, Spectrometers, Detectors and Asso-
ciated Equipment, vol. 784, pp. 298–305, 2015.

[22] J. Kim, K. T. Lim, J. Kim, Y. Kim, H. Kim, and G. Cho, “Quantiﬁcation
and uncertainty analysis of low-resolution gamma-ray spectrometry
using bayesian inference,” Nuclear Instruments and Methods in Physics
Research Section A: Accelerators, Spectrometers, Detectors and Asso-
ciated Equipment, vol. 953, p. 163144, 2020.

[23] M. Kamuda and C. J. Sullivan, “An automated isotope identiﬁcation and
quantiﬁcation algorithm for isotope mixtures in low-resolution gamma-
ray spectra,” Radiation Physics and Chemistry, vol. 155, pp. 281–286,
2019.

[24] P.-L. Lagari, “An RBF neural network approach in radionuclide identi-
ﬁcation of unknown sources utilizing γ-ray spectra,” Ph.D. dissertation,
Purdue University, 2017.

[25] M. Kamuda, J. Stinnett, and C. Sullivan, “Automated isotope identiﬁca-
tion algorithm using artiﬁcial neural networks,” IEEE Transactions on
Nuclear Science, vol. 64, no. 7, pp. 1858–1864, 2017.

[26] J. Kim, K. Park, and G. Cho, “Multi-radioisotope identiﬁcation algo-
rithm using an artiﬁcial neural network for plastic gamma spectra,”
Applied Radiation and Isotopes, vol. 147, pp. 83–90, 2019.

[27] A. Varley, A. Tyler, L. Smith, and P. Dale, “Development of a neural
network approach to characterise 226Ra contamination at legacy sites
using gamma-ray spectra taken from boreholes,” Journal of environmen-
tal radioactivity, vol. 140, pp. 130–140, 2015.

[28] M. Kamuda, J. Zhao, and K. Huff, “A comparison of machine learning
methods for automated gamma-ray spectroscopy,” Nuclear Instruments
and Methods in Physics Research Section A: Accelerators, Spectrome-
ters, Detectors and Associated Equipment, vol. 954, p. 161385, 2020.

[29] L. F. Bl´azquez, F. Aller, S. Vrublevskaya, J. Fombellida, and E. Valtuille,
“Classiﬁcation of radionuclides on polyvinyl toluene radiation portal
monitors by a neural network based system §,” IFAC-PapersOnLine,
vol. 48, no. 21, pp. 852–857, 2015.

[30] M. Alamaniotis and T. Jevremovic, “Hybrid fuzzy-genetic approach
integrating peak identiﬁcation and spectrum ﬁtting for complex gamma-
ray spectra analysis,” IEEE Transactions on Nuclear Science, vol. 62,
no. 3, pp. 1262–1277, 2015.

IEEE TRANSACTIONS ON NUCLEAR SCIENCE, VOL. XX, NO. XX, XXXX 2022

12

in tin,” Nuclear Instruments and Methods in Physics Research Section
A: Accelerators, Spectrometers, Detectors and Associated Equipment,
vol. 797, pp. 130–137, 2015.

[31] J. B. Stinnett, “Automated isotope identiﬁcation algorithms for low-
resolution gamma spectrometers,” Ph.D. dissertation, University of Illi-
nois at Urbana-Champaign, 2016.

[32] A. Turner, C. Wheldon, M. Gilbert, L. Packer, J. Burns, T. K.
Wheldon, and M. Freer, “Generalised gamma spectrometry simulator
for problems in nuclide identiﬁcation,” Journal of Physics: Conference
Series, vol. 1643, p. 012211, dec 2020.
[Online]. Available:
https://doi.org/10.1088/1742-6596/1643/1/012211

[33] “histoGe v2.1,” https://doi.org/10.5281/zenodo.6339690, 2022, accessed:

2022-03-08.

[34] “GNU general public license,” http://www.gnu.org/licenses/gpl.html,

Free Software Foundation.

[35] “histoGe User’s Manual,” https://doi.org/10.5281/zenodo.6339653,

2022, accessed: 2022-03-08.

[36] “Comarca Minera Hidalgo UNESCO global geopark,” 2020, https:

//www.geoparquehidalgo.com.

[37] G. Van Rossum and F. L. Drake, Python 3 Reference Manual. Scotts

Valley, CA: CreateSpace, 2009.

[38] A. Savitzky and M. J. E. Golay, “Smoothing and differentiation of data
by simpliﬁed least squares procedures.” Anal. Chem., vol. 36, no. 8, pp.
1627–1639, 1964.

[39] “Database used with histoGe,” https://zenodo.org/record/4437341,

2021, accessed: 2021-01-13.

[40] L. A. Zadeh, “Fuzzy logic,” Computer, vol. 21, no. 4, pp. 83–93, 1988.
[41] T. J. Ross, Fuzzy logic with engineering applications.
John Wiley &

Sons, 2005.

[42] L. A. Zadeh, “Fuzzy sets,” Information and control, vol. 8, no. 3, pp.

338–353, 1965.

[43] E. H. Mamdani, “Advances in the linguistic synthesis of fuzzy con-
trollers,” International Journal of Man-Machine Studies, vol. 8, no. 6,
pp. 669–678, 1976.

[44] A. Aguilar-Arevalo, S. Alvarado-Mijangos, X. Bertou, C. Canet,
M. Cruz-P´erez, A. Deisting, A. Dias, J. D'Olivo, F. Favela-P´erez,
E. Garc´es, A. G. Mu˜noz, J. Guerra-Pulido, J. Mancera-Alejandrez,
D. Mar´ın-L´ambarri, M. M. Montero, J. Monroe, C.
I. Ortega-
Hern´andez, S. Paling, S. Peeters, D. R. E. Rodr´ıguez, P. Scovell,
C. T¨urko˘glu, E. V´azquez-J´auregui, and J. Walding, “Characterization of
germanium detectors for the ﬁrst underground laboratory in Mexico,”
Journal of Instrumentation, vol. 15, no. 11, pp. P11 014–P11 014,
nov 2020. [Online]. Available: https://doi.org/10.1088%2F1748-0221%
2F15%2F11%2Fp11014

[45] “Amptek materials analysis division,” 2020, https://www.amptek.com.
[46] A. Aguilar-Arevalo, X. Bertou, C. Canet Miquel, M. A. Cruz-P´erez,
A. Deisting, A. Dias, J. C. D’Olivo, F. Favela-P´erez, E. A. Garc´es,
A. Gonz´alez Mu˜noz, J. O. Guerra-Pulido, J. Mancera-Alejandrez,
D. Mar´ın-L´ambarri, M. Martinez Montero, J. R. Monroe, C. I. Ortega-
Hern´andez, S. Paling, S. Peeters, D. Ru´ız Esparza Rodr´ıguez, P. R.
Scovell, C. T¨urko˘glu, E. V´azquez-J´auregui, and J. Walding, “Volume
reduction of water samples to increase sensitivity for radioassay of lead
contamination,” April 2022, accepted for publication in Water Applied
Science.

[47] A. Aguilar-Arevalo, X. Bertou, C. Canet, M. A. Cruz, A. Deist-
J. C. D’Olivo, F. Favela-P´erez, E. A. Garc´es,
ing, A. Dias,
A. Gonz´alez Mu˜noz, J. O. Guerra-Pulido, D. Mar´ın-L´ambarri, A. M.
Mart´ınez Mendoza, M. Mart´ınez Montero, J. Monroe, S. Paling,
S. Peeters, P. R. Scovell, C. T¨urko˘glu, I. G. Vallejo Castillo, E. V´azquez-
J´auregui, and J. Walding, “Gamma-ray ﬂux measurement and geotechni-
cal studies at the selected site for the labchico underground laboratory,”
The European Physical Journal Plus, vol. 137, no. 2, pp. 1–11, 2022.
[48] P. Scovell, E. Meehan, H. Ara´ujo, J. Dobson, C. Ghag, H. Kraus,
V. Kudryavtsev, X.-R. Liu, P. Majewski, S. Paling, R. Preece,
R. Saakyan, A. Tom´as, C. Toth, and L. Yeoman, “Low-background
gamma
the Boulby Underground Laboratory,”
Astroparticle Physics, vol. 97, pp. 160 – 173, 2018. [Online]. Available:
http://www.sciencedirect.com/science/article/pii/S0927650517302517

spectroscopy at

[49] D. Malczewski,

J. Kisiel, and J. Dorda, “Gamma background
in the Boulby Underground Laboratory,” Journal
measurements
of Radioanalytical and Nuclear Chemistry, vol. 298, no. 3, pp.
1483–1489, Dec 2013.
[Online]. Available: https://doi.org/10.1007/
s10967-013-2540-9

[50] P. Scovell, E. Meehan, H. Ara´ujo, J. Dobson, C. Ghag, H. Kraus,
V. Kudryavtsev, P. Majewski, S. Paling, R. Preece et al., “Low-
background gamma spectroscopy at the boulby underground laboratory,”
Astroparticle Physics, vol. 97, pp. 160–173, 2018.

[51] S. Das, S. Ghorui, P. Raina, A. Singh, P. Rath, F. Cappella, R. Cerulli,
M. Laubenstein, P. Belli, and R. Bernabei, “Preliminary study of feasi-
bility of an experiment looking for excited state double beta transitions

