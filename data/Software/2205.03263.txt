2
2
0
2

y
a
M
6

]
P
S
.
s
s
e
e
[

1
v
3
6
2
3
0
.
5
0
2
2
:
v
i
X
r
a

2022 21st ACM/IEEE International Conference on Information Processing in Sensor Networks (IPSN)

SPARCS: A Sparse Recovery Approach for Integrated
Communication and Human Sensing in mmWave Systems

Jacopo Pegoraro
pegoraroja@dei.unipd.it
University of Padova
Padova, Italy

Michele Rossi
michele.rossi@unipd.it
University of Padova
Padova, Italy

Jesus O. Lacruz
jesusomar.lacruz@imdea.org
IMDEA Networks Institute
Madrid, Spain

Joerg Widmer
joerg.widmer@imdea.org
IMDEA Networks Institute
Madrid, Spain

ABSTRACT
A well established method to detect and classify human movements
using Millimeter-Wave (mmWave) devices is the time-frequency
analysis of the small-scale Doppler effect (termed micro-Doppler)
of the different body parts, which requires a regularly spaced and
dense sampling of the Channel Impulse Response (CIR). This is cur-
rently done in the literature either using special-purpose radar sen-
sors, or interrupting communications to transmit dedicated sensing
waveforms, entailing high overhead and channel utilization. In this
work we present SPARCS, an integrated human sensing and commu-
nication solution for mmWave systems. SPARCS is the first method
that reconstructs high quality signatures of human movement from
irregular and sparse CIR samples, such as the ones obtained during
communication traffic patterns. To accomplish this, we formulate
the micro-Doppler extraction as a sparse recovery problem, which
is critical to enable a smooth integration between communication
and sensing. Moreover, if needed, our system can seamlessly inject
short CIR estimation fields into the channel whenever communica-
tion traffic is absent or insufficient for the micro-Doppler extraction.
SPARCS effectively leverages the intrinsic sparsity of the mmWave
channel, thus drastically reducing the sensing overhead with re-
spect to available approaches. We implemented SPARCS on an
IEEE 802.11ay Software Defined Radio (SDR) platform working in
the 60 GHz band, collecting standard-compliant CIR traces match-
ing the traffic patterns of real WiFi access points. Our results show
that the micro-Doppler signatures obtained by SPARCS enable a
typical downstream application such as human activity recognition
with more than 7 times lower overhead with respect to existing
methods, while achieving better recognition performance.

1 INTRODUCTION
There is a growing interest in human tracking [38], Human Ac-
tivity Recognition (HAR) [29] and person identification [40] using
Millimeter-Wave (mmWave) devices, where the high carrier fre-
quency and large available bandwidth allow for accurate Doppler
estimation and precise localization and tracking. To fully exploit
these properties, a large body of work has focused on dedicated
mmWave radars, that adopt specifically designed frequency modu-
lated transmissions to extract the micro-Doppler (ğœ‡D) effect caused
by human motion (a so-called ğœ‡D signature) [27, 35].

978-1-6654-9624-7/22/$31.00 Â©2022
IEEE DOI 10.1109/IPSN54338.2022.0001

At the same time, given the increasing number of mmWave net-
work technologies such as 3GPP 5G-NR [34] and IEEE 802.11ad/ay
[36, 37], Integrated Sensing And Communication (ISAC) solutions
are highly appealing. They effectively repurpose communication
devices by endowing them with additional environment sensing
capabilities, thus avoiding the cost of installing dedicated radar hard-
ware. This recent trend has led to the identification of sensing as a
key feature of next generation 6G mobile networks [18] and the cre-
ation of the IEEE 802.11bf standardization group [26], aimed at en-
abling sensing features in Wireless Local Area Networks (WLANs).
However, ISAC system designs are still very limited, focusing on
joint communication and sensing waveform design [19], which
would require significant modifications to existing communication
protocols and a reduction in the achievable communication data
rates. Other approaches [17, 18, 23, 39] need to alternate commu-
nication and sensing phases according to a time-division scheme,
where regularly spaced, radar-like transmissions are performed
during dedicated sensing periods. This is needed to perceive the
fine-grained ğœ‡D effect of human motion, for which dense and reg-
ular sampling of the Channel Impulse Response (CIR) is required,
causing significant overhead and channel occupation.

In this paper, we address the problem of enabling ISAC in realistic
mmWave communication systems, by reusing existing communica-
tion traffic for sensing as much as possible and thus introducing only
a minimal amount of additional overhead. To this end, we propose
SPARCS, the first mmWave ISAC system that reconstructs human
ğœ‡D signatures from irregular and sparse CIR samples obtained from
realistic traffic patterns. The main insight of SPARCS is to leverage
the intrinsic sparsity of the reflections in the mmWave channel to
pose the ğœ‡D reconstruction as a sparse recovery problem. Indeed,
mmWave CIR estimation can naturally separate signal propagation
paths with < 10 cm resolution, leading to a sparse multi-path en-
vironment and consequently a sparse CIR in the Doppler domain.
This allows obtaining highly accurate ğœ‡D signatures from only a
small, randomly distributed fraction of the CIR samples that are
currently needed by existing ISAC methods. To do so, SPARCS first
performs CIR resampling to construct a regular grid of CIR samples
with missing vales due to the irregularity of the sampling process
in time. Next, a sparse reconstruction method is used to obtain the
ğœ‡D spectrum, decoupling different propagation paths to leverage
their sparsity property. Lastly, whenever communication traffic is
absent or insufficient for the ğœ‡D extraction, SPARCS supports a

 
 
 
 
 
 
IPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

dynamic injection of very short CIR estimation fields into the (idle)
channel. Given its sparse recovery capabilities, only a small number
of additional CIR sensing units are needed to retrieve the ğœ‡D, thus
entailing a negligible overhead to the communication rate.

SPARCS is compatible with any mmWave system that supports
transmit beamforming for directional communication and CIR esti-
mation. This is the case, for example, for IEEE 802.11ay WLANs at
60 GHz, which provide in-packet CIR estimation for beam track-
ing purposes, and for 3GPP 5G-NR, where base stations can send
frequent downlink CSI-Reference Signal (CSI-RS) to estimate the
channel using different Beam Patterns (BPs).

To evaluate SPARCSâ€™ performance, we implement it on a 60 GHz
IEEE 802.11ay Software Defined Radio (SDR) experimentation plat-
form. We then test it on sparse and irregular CIR samples derived
from standard-compliant traces, both for synthetic traffic and traf-
fic patterns obtained from datasets of operational real-world WiFi
Access Points (APs) deployments [25]. To assess the quality of the
reconstructed ğœ‡D signatures, we use them as input for a typical
downstream task such as HAR, which classifies human movement
detected by the captured ğœ‡D into different possible activities. The
main contributions of our work are summarized next.

(1) We propose SPARCS, an ISAC method for mmWave systems
that can reconstruct high-quality ğœ‡D signatures of human
movement from irregular and sparse CIR estimation samples.
SPARCS reuses training fields appended to communication
packets as sensing units, and injects additional sensing units
if necessary, adapting to the underlying communication traf-
fic and minimizing the sensing overhead.

(2) We provide an original formulation of the ğœ‡D extraction
in communication systems as a sparse recovery problem,
leveraging the intrinsic high distance resolution and sparsity
properties of the mmWave channel. As a side effect, this also
improves the quality of the resulting spectrograms, making
them more robust to noise and interference.

(3) We design and validate an algorithm to perform the injec-
tion of additional sensing units when communication traffic
is insufficient. The process is dynamic, requires no knowl-
edge about future packet transmissions, and incurs minimal
overall overhead.

(4) We evaluate SPARCS by implementing it on an IEEE 802.11ay-
compliant 60 GHz SDR platform and testing it on CIR mea-
surements collected with realistic WiFi traffic patterns. For
the common HAR task, the ğœ‡D signatures reconstructed by
SPARCS achieve better F1 scores than existing methods,
while reducing sensing overhead by a factor of 7.

The paper is organized as follows. In Section 2 we discuss the nec-
essary preliminaries for mmWave human ğœ‡D sensing using CIR.
SPARCS is introduced and explained in detail in Section 3, de-
scribing the sparse recovery problem formulation and the involved
processing steps. In Section 4 we discuss the implementation of
SPARCS on an SDR platform, and Section 5 provides an evalua-
tion of the system on real measurement traces. We summarize the
related work in Section 6 and give concluding remarks in Section 7.

2 PRIMER ON MMWAVE SENSING
In this section we give a brief description of the CIR model for
mmWave communication systems that we use for sensing. We then
describe a baseline approach that allows tracking the movement of
people in the environment and extract their ğœ‡D signatures using
regularly sampled CIR information. This forms the basis of our
SPARCS design, which entirely eliminates the requirement of fixed
Inter-Frame Spacing (IFS) and enables ultra low-overhead ISAC.

2.1 Sensing in mmWave systems
Capturing the movement features of humans in the environment
requires an analysis of the reflections of the transmitted signal from
their bodies, which is usually carried out applying signal process-
ing techniques to the CIR. Due to the high path loss occurring at
mmWave frequencies, directional communication is employed by
means of transmitter and receiver beamforming, typically using
phased antenna arrays. The transmitter and the receiver use suitable
BP configurations of their antenna arrays to maximize the signal
strength [11, 36, 37]. To successfully sense with a mmWave system,
at least one of the BPs has to illuminate the subjects of interest, as
only in this case the reflected signal carries detectable information
about the movement signature. To this end, we consider a setup
where an AP transmits packets and is able to collect the reflections
of its own signal, after being reflected by objects (including humans).
This reflection is collected by the receive array of the AP itself using
a quasi-omnidirectional BP. This requires full-duplex capabilities,
as is common in ISAC scenarios [14], which in the simplest form
can be achieved with a Multiple Input Multiple Output (MIMO)
system in a mixed configuration with one RF chain as transmitter
and another as receiver. The CIR estimation fields used for sensing,
which we denote by sensing units, can either be piggybacked by
appending them as a trailer to the Physical Layer (PHY) communi-
cation packets or transmitted independently (injected). mmWave
standards implement beam training mechanisms that help to estab-
lish a communication link by testing different BP combinations and
then selecting the best one. Such functionality is supported by all
mmWave standards. For example, 5G-NR [11], use Synchronization
Signal Block (SSB) and CSI-RS for beam management, while WLAN
systems adopting the IEEE 802.11ad/ay standards [36, 37] use chan-
nel estimation and training fields (CEF and TRN, respectively) to
obtain accurate CIR information. Our framework to extract sensing
information from CIR measurements can be applied regardless of
the specifics of the standards.

2.2 mmWave CIR model
Due to the large transmission bandwidth of mmWave systems,
channel measurements contain fine-grained information about the
environment [18, 23, 39]. Depending on the communication sys-
tem we consider, sensing could be performed using the 5G-NR
Orthogonal Frequency Division Multiplexing (OFDM) Channel
State Information (CSI), which contains the channel gains for each
OFDM subcarrier, or the IEEE 802.11ad/ay Single Carrier (SC) CIR.
Both communication schemes are suitable for human sensing: (i)
in 5G-NR, the base stations can send frequent downlink CSI-RS to
estimate the channel using different BPs, while (ii) in IEEE 802.11ay
in-packet beam tracking is enabled, so that specific fields called

SPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

training fields (TRN), each using a different BP, can be appended to
communication packets. In the following, we focus on SC CIR, and
show how to extract the ğœ‡D effect of human movement. However,
previous works have demonstrated that similar processing can be
performed with OFDM CSI [18, 20], and SPARCS is general enough
to be applied in both cases.

We consider a multipath propagation environment with a time-
varying number of reflectors, ğ‘ƒ (ğ‘¡). These cause physical signal
propagation paths that can be separated in the CIR according to a
finite ranging resolution, i.e., the capability of the system to resolve
the distance of the reflectors causing different signal paths. This is
given by Î”ğ‘‘ = ğ‘/2ğµ, where ğµ is the transmitted signal bandwidth
and ğ‘ the speed of light. Thus, the CIR contains the complex channel
gains for a discrete grid of possible signal paths (or distance bins),
with indices â„“ = 0, . . . , ğ¿ âˆ’ 1. Each path is associated with a specific
distance from the AP, according to the relation ğ‘‘â„“ = ğ‘ğœâ„“ /2, with ğœâ„“
being the delay associated with path â„“. Moreover, the CIR depends
on the specific BP used during the transmission, denoted by ğ‘ =
0, . . . , ğ‘BP âˆ’ 1. For carrier frequency ğ‘“ğ‘œ , the CIR along â„“, using BP
ğ‘ at time ğ‘¡ is

â„â„“,ğ‘ (ğ‘¡) =

ğ‘ƒâ„“ (ğ‘¡ )
âˆ‘ï¸

ğ‘=1

ğ‘ğ‘
â„“,ğ‘ (ğ‘¡) exp

(cid:26)

âˆ’ğ‘—2ğœ‹

2ğ‘“ğ‘œ
ğ‘

âˆ« ğ‘¡

(cid:20)
ğ‘‘â„“ +

0

(cid:21) (cid:27)

ğ‘£ğ‘
â„“ (ğ‘¥)ğ‘‘ğ‘¥

.

(1)

In Eq. (1), ğ‘ƒâ„“ (ğ‘¡) is the number of physical reflectors whose contri-
butions overlap in the â„“-th CIR path, as their distances are within
ğ‘‘â„“ Â±Î”ğ‘‘/2, while ğ‘£ğ‘
â„“ is the radial velocity1 of reflector ğ‘. The quantity
ğ‘ğ‘
â„“,ğ‘ (ğ‘¡) is the complex gain due to the joint effect of the transmitter
BP, the object reflectivity and the signal attenuation.

2.3 micro-Doppler extraction
The extraction of the ğœ‡D spectrum from multiple, concurrently
moving subjects requires tracking the position of each person in the
physical space, in order to separate their individual contributions to
the CIR. Then, a spectral analysis over different CIR samples yields
the desired ğœ‡D signature [13, 23].

2.3.1 People tracking. People tracking is performed by extracting
measurements of each personâ€™s distance and angular position with
respect to the AP across time, as detailed, e.g., in [23]. This process
consists of (i) removing the background contribution to the CIR
by subtracting the average CIR across a suitable time interval, (ii)
selecting the locally strongest reflection paths in the CIR (peaks)
and obtaining the corresponding distance ğ‘‘â„“ , (iii) computing the
Angle of Arrival (AoA), ğœƒ , of the reflection from the correlation
between the different BPs gains and the strengths of the CIRs across
the whole angular Field-of-View (FOV) [15]. The approach in (iii)
requires the BP shapes to be estimated in advance, and is based on
the intuition that different BPs illuminate different possible reflec-
tors in the environment, depending on their position. Therefore,
we can expect to receive the reflected signal from a certain subject
only when a BP is pointing in his/her direction. The resulting set
of distances and angles represent candidate positions of humans in
the environment. A multi-target tracking method such as a Joint
Probabilistic Data Association Filter (JPDAF) [2] allows smoothing
the trajectories of the subjects by rejecting noise and clutter.

1By convention, ğ‘£ğ‘

â„“ has a positive sign when the reflector moves away from the AP.

The tracking phase provides an estimate of the position of each
subject, at every time instant ğ‘¡, which we denote by [ ^ğ‘‘ (ğ‘¡), ^ğœƒ (ğ‘¡)]
using symbol^to differentiate between our estimates and the true
position. Due to step (ğ‘–ğ‘–) above, which selects the local peaks in the
received power, typically only the reflections from the torso can
be tracked when a person moves in the environment. In contrast,
the head and the limbs cause much weaker reflections [35], whose
contributions can only be detected in the ğœ‡D spectrum. Neverthe-
less, tracking the spatial location of the torso is crucial for the ğœ‡D
extraction as it allows separating the contributions of the multiple
subjects in the environment. Once ^ğ‘‘ (ğ‘¡) and ^ğœƒ (ğ‘¡) are determined,
they are used to select the path â„“âˆ— and the BP ğ‘âˆ— that correspond
to the distance and angular position of the subject, respectively.
Then, the CIR waveform that contains the ğœ‡D effect of the personâ€™s
movement is â„â„“ âˆ—,ğ‘âˆ— (ğ‘¡). Besides enabling the separation of multi-
ple subjects, this operation makes mmWave sensing systems much
more robust to changes in the environment than sub-6 GHz systems
[21]. While the latter are heavily affected by second-order reflec-
tions on walls and objects, mmWave sensing mostly relies on the
line-of-sight path between the person and the transmitter/receiver,
with little contribution from the external environment.

2.3.2 micro-Doppler spectrum. Human movement causes a small-
scale Doppler effect on the reflected signal due to the different body
parts, which possess different velocities and follow different trajec-
tories [4]. This is referred to as ğœ‡D effect and causes a measurable
frequency modulation on the reflection. High frequency signals
such as mmWave communications are particularly affected by the
ğœ‡D modulation due to their small wavelengths. Various techniques
from time-frequency analysis can be applied to analyze the ğœ‡D,
obtaining spectrograms showing the time evolution of the signal
energy contained in the different frequency bands of interest. The
most popular and computationally efficient of such methods is the
Short Time Fourier Transform (STFT) of â„â„“,ğ‘ (ğ‘¡) [3], which consists
in applying a windowed Fourier Transform (FT) on partially overlap-
ping portions of the CIR. As shown in [13, 20, 23], STFT processing
needs to be applied to a window of ğ‘Š subsequent estimates of the
CIR with a fixed CIR sampling interval of ğ‘‡ğ‘ seconds, provided that
the time spanned by the window is short enough to consider the
movement velocity of the reflectors constant for its whole duration.
Note that this operation allows detecting and separating the veloc-
ities of the ğ‘ƒâ„“ (ğ‘¡) reflectors, whose contributions overlap in path
â„“ when considering a single estimate of the CIR. The choice of ğ‘‡ğ‘
impacts the frequency resolution of the STFT, Î”ğ‘“ ğ‘‘ = 1/(ğ‘Šğ‘‡ğ‘ ), and
its maximum measurable frequency, ğ‘“ ğ‘‘
max = 1/(2ğ‘‡ğ‘ ). Using the
relationship between the Doppler frequency and the corresponding
velocity, one can obtain the velocity resolution and the maximum
observable velocity as Î”ğ‘£ = ğ‘/(2ğ‘“ğ‘œğ‘Šğ‘‡ğ‘ ) and ğ‘£max = ğ‘/(4ğ‘“ğ‘œğ‘‡ğ‘ ). To
fully capture the range of velocities of interest for human movement,
the typical approach is to select ğ‘‡ğ‘ such that ğ‘£max is sufficiently
high that is covers the velocities that can occur in the human ac-
tivities of interest, which may vary depending on the application
[23, 29, 35].

Previous work assumes that the constraint of a fixed ğ‘‡ğ‘ is met,
which does not hold in realistic communication scenarios, where
packet transmissions are scheduled according to the needs of the

IPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

3.1 CIR resampling
Our system samples the CIR at time instants ğ‘¡ğ‘– , which coincide with
the reception of the reflections from the ğ‘–-th transmitted packet. To
reconstruct the ğœ‡D spectrum from CIR samples which are randomly
distributed in the time domain, we first resample the CIR to obtain
regularly spaced samples with a fixed granularity ğ‘‡ğ‘ , where possible.
To do so, we resort to the slotted resampling technique, which
allows approximating a sequence of randomly spaced samples into
a regular grid with missing values [1]. We consider ğ‘ğ‘  consecutive
samples obtained at the time instants ğ‘¡0, ğ‘¡1, . . . , ğ‘¡ğ‘ğ‘ 
and denote by
0,ğ‘‡ğ‘, 2ğ‘‡ğ‘, . . . , (ğ¾ âˆ’ 1)ğ‘‡ğ‘ the regular grid with step size ğ‘‡ğ‘ . Slotted
resampling constructs a new CIR sample sequence â„â„“,ğ‘ (ğ‘˜ğ‘‡ğ‘ ) where
the CIR values are obtained from the original sequence â„â„“,ğ‘ (ğ‘¡ğ‘– ) as
follows. Time bins (or intervals) of length ğ‘‡ğ‘ are centered on each
time instant of the regular grid, i.e., bin ğ‘˜ is ğ›½ğ‘˜ = [ğ‘˜ğ‘‡ğ‘ âˆ’ğ‘‡ğ‘ /2, ğ‘˜ğ‘‡ğ‘ +
ğ‘‡ğ‘ /2), with center ğ‘˜ğ‘‡ğ‘ . Then, the value of the CIR corresponding
to the ğ‘˜-th grid value is either (i) selected among the values of the
original sequence whose sampling times fall inside bin ğ‘˜, taking
the one whose sampling time is the closest to the bin center, or (ii)
considered as a missing value if no samples of the original sequence
fall inside bin ğ‘˜. Specifically,

â„â„“,ğ‘ (ğ‘˜ğ‘‡ğ‘ ) =

(cid:26)

0
â„â„“,ğ‘ (ğ‘¡ğ‘˜ )

if {ğ‘¡ğ‘– |ğ‘¡ğ‘– âˆˆ ğ›½ğ‘˜ } = âˆ…,
otherwise,

where the 0 values represent missing samples and

ğ‘¡ğ‘˜ = arg min

ğœ âˆˆ {ğ‘¡ğ‘– |ğ‘¡ğ‘– âˆˆğ›½ğ‘˜ }

|ğ‘˜ğ‘‡ğ‘ âˆ’ ğœ |.

(2)

(3)

The resulting, regularly spaced sequence of CIR samples is used
to reconstruct the ğœ‡D spectrum of the subject. However, due to the
missing samples which are set to 0, a plain application of the STFT
(as described in Section 2.3) would lead to a corrupted spectrum.
In the next section we detail our solution to this problem, which is
based on sparse recovery techniques.

3.2 Sparse ğœ‡D recovery problem formulation
Several methods exist to tackle the problem of computing the power
spectrum of non-uniformly sampled signals [1]. Our approach be-
longs to the category of sparsity-based approaches, in which the
sparsity of the signal in the frequency domain is leveraged to dras-
tically reduce the number of measurements needed for an accurate
reconstruction of the spectrum. We select windows of length ğ‘Š
samples (window size) every ğ›¿ samples from the sequence â„â„“,ğ‘ (ğ‘˜ğ‘‡ğ‘ ),
choosing ğ›¿ = ğ‘Š /2. Due to the slotted resampling process, each
window may contain missing samples. We denote by Uğ‘š the set
of indices of the available samples contained in the ğ‘š-th window.
Then, we define vector hâ„“,ğ‘ (ğ‘š) âˆˆ C |Uğ‘š |, containing the available
CIR samples in the ğ‘š-th window, and vector Ëœhâ„“,ğ‘ (ğ‘š) âˆˆ Cğ‘Š , rep-
resenting the complete ğ‘š-th CIR window, which is only partially
known due to the missing samples. We also denote by Finv the
inverse Fourier matrix, whose element in position (ğ‘”, ğ‘™) is given
ğ‘Š ) exp ( ğ‘—2ğœ‹ğ‘”ğ‘™/ğ‘Š ) , ğ‘”, ğ‘™ = 0, . . . ,ğ‘Š âˆ’ 1 while
by (Finv)ğ‘”ğ‘™ = (1/
Uğ‘š = (cid:2)uğ‘‡
(cid:3) , âˆ€ğ‘– âˆˆ Uğ‘š is the matrix that selects the rows of Finv
ğ‘–
whose indices are in Uğ‘š. uğ‘– is the vector of all zeros but the ğ‘–-th
component, which equals 1.

âˆš

The following relation holds between the incomplete CIR win-
dow, hâ„“,ğ‘ (ğ‘š), and the FT of the full CIR window, Hâ„“,ğ‘ (ğ‘š) âˆˆ Cğ‘Š ,

Figure 1: Comparison between the traditional CIR-based human
sensing and SPARCS.

communication protocols rather than sensing accuracy. Traffic pat-
terns are typically bursty and irregular and thus cannot be used by
existing methods for human sensing. Instead, dedicated time slots
need to be reserved for the transmission of sensing units, which is
incompatible with the random access CSMA/CA MAC commonly
used in IEEE 802.11. Conversely, SPARCS is the first approach that
does not require any specific pattern in the transmission of the
sensing units, enabling true ISAC by exploiting communication
packets for sensing whenever possible, and introducing minimal
additional overhead when necessary.

3 SPARCS METHODOLOGY
We now present the SPARCS algorithm to recover the ğœ‡D spectrum
from irregular and sparse CIR sampling patterns. The processing
steps of SPARCS compared to traditional CIR-based sensing meth-
ods are shown in Fig. 1.

(1) CIR resampling: after CIR estimation and people tracking,
for which we adopt the standard JPDAF technique [2], we apply
a resampling strategy to approximate the irregularly spaced CIR
values with a regular sequence whose sampling interval is chosen
according to the desired ğœ‡D resolution (Section 3.1). Due to irregu-
larity of the original sampling process, the approximated regular
sequence may contain missing values that need to be filled in the
subsequent processing steps.

(2) Sparse ğœ‡D recovery: we formulate the recovery of the ğœ‡D
spectrum from the incomplete CIR measurements as a sparse re-
covery problem. For this, we leverage two key aspects. On the
one hand, the intrinsic sparsity of the mmWave channel leads to
a small number of signal reflections from the human body that
carry information about different body parts. On the other hand,
the high distance resolution of mmWave systems makes the reflec-
tions from the different body parts separable. The combined effect
of these two properties is that the resulting CIR is highly sparse
in the Doppler frequency domain, as detailed in Section 3.2 We
then solve the sparse recovery problem using the Iterative Hard
Thresholding (IHT) algorithm for each CIR path (Section 3.3), and
aggregate the results to obtain the final ğœ‡D spectrum (Section 3.4).
(3) Sensing unit injection: when communication traffic is ab-
sent or too scarce to obtain an accurate reconstruction, our system
can inject short sensing units into the (idle) channel to overcome
the problem, as described in Section 3.5. Thanks to the sparse recon-
struction of point (2), the amount of units that need to be injected
is minimal and can be tuned to trade off between overhead and
sensing accuracy.

SPARCSTraditionalCIR-basedsensing CIR estimationPeople TrackingCIR estimationPeople TrackingCIR ResamplingSparse RecoverySparse communicationtraffic+ injectionRadar-like uniformtransmissionsSensing unitsinjectionSTFTmicro-Dopplermicro-DopplerSPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

Algorithm 1 Single path sparse recovery.
Input: hâ„“,ğ‘âˆ— (ğ‘š), ğœ‚, ğ‘›max, Î©, ğœ‰.
Output: Hâ„“,ğ‘âˆ— (ğ‘š).
1: Collect the set of available samples indices Uğ‘š .
(cid:3) , âˆ€ğ‘– âˆˆ Uğ‘š and Finv
2: Build matrices Uğ‘š = (cid:2)uğ‘‡
ğ‘–
3: Compute Î¨ğ‘š = Uğ‘š Finv.
4: Set ^H(0) = 0, ğ‘› = 0, ğ›¾ (0) to any value > ğœ‰.
5: while ğ‘› < ğ‘›max or ğ›¾ (ğ‘›) > ğœ‰ do
6:
7:
8:
9: end while
10: return ^H(ğ‘›)

^H(ğ‘›+1) â† Eq. (8)
ğ›¾ (ğ‘›+1) â† | | ^H(ğ‘›+1) âˆ’ ^H(ğ‘›) | |2
ğ‘› â† ğ‘› + 1

ğ‘ƒâ„“1 (ğ‘š) â‰ª ğ‘Š and ğ‘ƒâ„“2 (ğ‘š) â‰ª ğ‘Š complex exponentials each, and
(ii) if â„“1 = â„“2, but ğ‘1 â‰  ğ‘2, the attenuation coefficient of ğ‘1 will
mostly remove the reflection from subject 2 in Ëœhâ„“1,ğ‘1
and vice
versa, making the contributions from the subjects separable. The
contributions from different subjects overlap only if they occupy
the same CIR path and share the same BP, which is very unlikely
to occur in real cases due to the high distance (âˆ¼ 8 cm) and angular
(as low as 2â—¦) resolutions of the mmWave CIR [23]. Therefore, the
sparsity assumption in SPARCS still holds even if multiple subjects
are present in the environment. Due to this, we can assume that
ğ‘ƒâ„“ (ğ‘š) â‰ª ğ‘Š holds, and that sparse recovery techniques can be used
to recover Hâ„“,ğ‘ (ğ‘š), as detailed in the next section.

3.3 Single-path sparse recovery

Given the model from Eq. (4), the reconstruction of the CIR FT
along each path can be posed as a sparse recovery problem. Specifi-
cally, we seek a vector Hâ„“,ğ‘ (ğ‘š) which is a solution to Eq. (4) while
being as sparse as possible, coherent with the above discussion.
Considering the BP ğ‘âˆ— pointing in the direction of the target, the
desired FT of Ëœhâ„“,ğ‘âˆ— (ğ‘š) is the solution of the optimization problem
(6)

s.t. ||hâ„“,ğ‘âˆ— (ğ‘š) âˆ’ Î¨ğ‘šH||2 â‰¤ ğœ€,

Hâ„“,ğ‘âˆ— (ğ‘š) = arg min

||H||0

H

where || Â· ||0 denotes the â„“0-norm of a vector, i.e., the number of its
non-zero components. The constant ğœ€ > 0 can be estimated from
the noise in the CIR, using a training dataset.

An approximate local solution to Eq. (6) can be found using fast

greedy algorithms [7]. We adopt the IHT, which solves

Hâ„“,ğ‘âˆ— (ğ‘š) = arg min

H

||hâ„“,ğ‘âˆ— (ğ‘š) âˆ’ Î¨ğ‘šH||2
2

s.t. ||H||0 â‰¤ Î©,

(7)

where Î© is a pre-defined sparsity level parameter. The algorithm
involves an iterative gradient descent step on the quadratic term in
Eq. (7), followed by a thresholding operation:

^H(ğ‘›+1) â† TÎ©

(cid:104) ^H(ğ‘›) + ğœ‚Î¨

ğ‘‡
ğ‘š

(cid:16)

hâ„“,ğ‘âˆ— (ğ‘š) âˆ’ Î¨ğ‘š ^H(ğ‘›) (cid:17)(cid:105)

,

(8)

where ğ‘› is the iteration index and TÎ© is the hard-thresholding op-
erator, which sets to 0 all the components of the argument vector
except the Î© largest ones in terms of the Euclidean norm. ğœ‚ is a
learning rate parameter which can be tuned to improve the con-
vergence properties. The iterative process is stopped whenever
|| ^H(ğ‘›+1) âˆ’ ^H(ğ‘›) ||2 < ğœ‰ or when a maximum number of iterations,
ğ‘›max, is reached. In SPARCS, Î© is a key parameter, which is strictly
related to the number of reflectors ğ‘ƒâ„“ (ğ‘š): as IHT reconstructs a
vector which has at most Î© non-zero elements, Î© is an upper bound

Figure 2: Visual representation of the ğœ‡D spectrum computed us-
ing SPARCS on 2 different CIR paths, one containing the reflection
from a personâ€™s torso, the other capturing the ğœ‡D signature of the
leg. The total ğœ‡D is obtained summing together these contributions.

which we aim to recover in order to compute the ğœ‡D spectrum,

(4)

hâ„“,ğ‘ (ğ‘š) = Uğ‘š Ëœhâ„“,ğ‘ (ğ‘š) = Uğ‘šFinvHâ„“,ğ‘ (ğ‘š) = Î¨ğ‘šHâ„“,ğ‘ (ğ‘š),
where in the last step we use matrix Î¨ğ‘š = Uğ‘šFinv as a shorthand
notation. Given Eq. (4), our aim is to recover Hâ„“,ğ‘ (ğ‘š) from the
incomplete measurement vector hâ„“,ğ‘ (ğ‘š), which is a typical sparse
recovery or compressed sensing problem [7]. In this framework,
it has been proven that recovering the FT of the desired signal is
possible if the latter is sparse in the frequency domain, i.e., the FT
only contains a low fraction of non-zero elements. To verify that
this sparsity assumption holds in our case, we rewrite Eq. (1) after
the resampling and windowing operations, so that the ğ‘–-th sample
of the complete ğ‘š-th window is given by

(cid:104)Ëœhâ„“,ğ‘ (ğ‘š)

(cid:105)

=

ğ‘–

ğ‘ƒâ„“ (ğ‘š)
âˆ‘ï¸

ğ‘=1

ğ‘ğ‘
â„“,ğ‘ (ğ‘š) exp

(cid:26)

âˆ’ğ‘—4ğœ‹

ğ‘“ğ‘œ
ğ‘

(cid:104)
ğ‘‘ğ‘
â„“ + (ğ‘šğ›¿ + ğ‘–)ğ‘‡ğ‘ğ‘£ğ‘

â„“,ğ‘š

(cid:105) (cid:27)

,

(5)
where ğ‘£ğ‘
â„“,ğ‘š is the radial velocity of the ğ‘-th reflector in path â„“
during window ğ‘š, and ğ‘‘ğ‘
â„“ its distance from the AP. Here, we use
the assumption from Section 2.3 that the velocity of each reflector
can be considered constant during a window. In addition, we also
consider that the reflective coefficients and the number of reflectors
are constant. This is reasonable for the considered setup, where the
reflectors are parts of the human body, which typically move slowly
compared to the duration of a window ğ‘Šğ‘‡ğ‘ (see also Section 4).

From Eq. (5), one can see that as long as ğ‘ƒâ„“ (ğ‘š) â‰ª ğ‘Š , the FT
of Ëœhâ„“,ğ‘ (ğ‘š) is indeed sparse, as it is composed of ğ‘ƒâ„“ (ğ‘š) spectral
lines located at frequencies 2ğ‘“ğ‘œğ‘£ğ‘
â„“,ğ‘š/ğ‘. Given the excellent distance
resolution due to the high bandwidth of mmWave systems and the
intrinsic sparsity and directionality of the channel, the different
parts of the subjectâ€™s body tend to contribute to the ğœ‡D spectrum in
different CIR paths as shown in Fig. 2. Therefore, ğ‘ƒâ„“ (ğ‘š) is generally
close, if not equal, to 1. Sometimes the number of reflectors in a
single path can be larger than 1, due to different body parts being
closer than the distance resolution of the system, but this number
is still much lower than ğ‘Š . This even holds for multiple subjects.
Assume that two subjects with labels 1 and 2 are present in the
monitored physical space, and denote by (â„“1, ğ‘1) and (â„“2, ğ‘2) their
CIR path-BP pairs. According to Eq. (5), the sparsity assumption
must hold for each pair independently, and this is verified as long
as the subjects occupy different spatial positions. Specifically, (i)
if â„“1 â‰  â„“2 the CIRs along BPs ğ‘1 and ğ‘2 are the combination of

APPathPathPath-LegPath-TorsoTotal micro-Dopplerâ€¦ Transmission Reflectionpathsâ€¦ 2 m/s0m/s0m/s2 m/s0m/s2 m/s0.7 s0.7 s0.7 sMultipathaccumulationdâ„“=dâ„“âˆ—dâ„“â€²bâˆ—â„“â€²â„“(cid:205)â„“|Hâ„“â€²,bâˆ—|2|Hâ„“,bâˆ—|21IPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

for ğ‘ƒâ„“ (ğ‘š), and it can be thought of as the maximum number of
reflectors per path that we allow reconstructing. Î© can be tuned
in order to obtain better ğœ‡D reconstruction (see Section 5.5). The
sparse recovery algorithm is summarized in Alg. 1. According to the
compressive sensing theory [9], the reconstruction performance
of IHT (and in general of any recovery algorithm) degrades as the
number of available measurements, |Uğ‘š |, decreases. Theoretical
results show that the minimum number of measurements needed
to reconstruct Hâ„“,ğ‘âˆ— (ğ‘š) is O (Î© log(ğ‘Š /Î©)) [9], although the ex-
act number has to be estimated empirically as it also depends on
the level of noise present in the signal. In Section 5, we show that
SPARCS can achieve excellent ğœ‡D reconstruction with as few as
ğ‘Š /8 measurements per window, thanks to the high sparsity of the
mmWave CIR.

3.4 Multi-path aggregation
The moving body of a person causes several reflections that affect
more than one CIR path, as discussed in Section 3.2. Using the
procedure described in the previous sections, SPARCS is able to
retrieve the contribution of each path Hâ„“,ğ‘âˆ— (ğ‘š) to the ğœ‡D. Since the
different body parts contribute to the ğœ‡D in different paths, to fully
capture human movement we need to combine the information
from the different paths. Denote by ğ‘„ the number of distance bins
we aggregate to obtain the ğœ‡D spectrum. For convenience we as-
sume ğ‘„ to be an odd integer, as this makes the following processing
steps symmetric with respect to a central CIR path (corresponding
to the torso), but the same steps can be applied for ğ‘„ being even.
We aggregate the spectra obtained from the path caused by the
torso, â„“âˆ—, with the âŒŠğ‘„/2âŒ‹ distance bins preceding â„“âˆ— and the âŒŠğ‘„/2âŒ‹
subsequent distance bins, as they may contain the contributions of
the other body parts. The expression of the total ğœ‡D spectrum is

D(ğ‘š) =

â„“ âˆ—+ âŒŠğ‘„/2âŒ‹
âˆ‘ï¸

â„“=â„“ âˆ—âˆ’ âŒŠğ‘„/2âŒ‹

(cid:12)Hâ„“,ğ‘âˆ— (ğ‘š)(cid:12)
(cid:12)
2 ,
(cid:12)

(9)

maxğ‘– Dğ‘– (ğ‘š)âˆ’minğ‘– Dğ‘– (ğ‘š)

where the squared magnitude is applied element-wise. In addition,
we apply normalization of the spectra in the range [0, 1] by com-
puting D(ğ‘š) â† D(ğ‘š)âˆ’minğ‘– Dğ‘– (ğ‘š)
. Note that Eq. (9) entails
solving ğ‘„ optimization problems of the form in Eq. (7), however,
the ğ‘„ problems can be parallelized as they are completely indepen-
dent. Decomposing the full ğœ‡D spectrum reconstruction problem
into ğ‘„ subproblems effectively allows applying sparse recovery
techniques, which in turn leads to a significant reduction of the
number of measurements that are needed.

The value of ğ‘„ is selected according to physical considerations
and validated in practice, as described in Section 5. The ğœ‡D vectors
from Eq. (9) can be collected in sequences, one every ğ›¿ slots, forming
ğœ‡D spectrograms of arbitrary length, depending on the specific
application that is being performed, e.g., activity recognition, fall
detection, gait segmentation, etc. In the following, we refer to the
number of ğœ‡D vectors considered in such spectrograms as Î›.

3.5 Sensing unit injection
SPARCS can exploit the sensing units in sparsely distributed com-
munication packets to recover the ğœ‡D spectrum of human move-
ment. However, during communication between the AP and one

Algorithm 2 Injection of sensing units in window ğ‘š.
Input: ğ‘€ğ‘  .
1: # P1 - observation phase
2: ğ‘ğ‘ (ğ‘š) â† no. of sensing units received in the first half of the window (either

from reflected communications packets or injected).

if no reflected comm. packet received then

if ğ‘ âˆˆ Sğ‘š then

Transmit the sensing unit.
Sğ‘š â† Sğ‘š \ {ğ‘ }.

3: # P2 - scheduling phase
4: ğ‘ğ‘¤ (ğ‘š) â† max(ğ‘€ğ‘  âˆ’ ğ‘ğ‘ (ğ‘š), 0).
5: Schedule Sğ‘š = (cid:8)ğ‘ 1, . . . , ğ‘ ğ‘ğ‘¤ (ğ‘š)
(cid:9).
6: # P3 - transmission phase
7: for ğ‘ = ğ‘šğ‘Š /2, . . . , (ğ‘š + 1)ğ‘Š /2 âˆ’ 1 do
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:
18:
19:
20:
21:
22: end for

end if

end if

end if

else

else

if reflected comm. packet received then

Use the sensing unit from the comm. packet
Sğ‘š â† Sğ‘š \ {minğ‘ âˆˆSğ‘š ğ‘  }.

Use the sensing unit from the comm. packet
Sğ‘š â† Sğ‘š \ {ğ‘ }.

or more terminals it may happen that the AP remains silent for
longer than the duration of a processing window, ğ‘Šğ‘‡ğ‘ , or that the
received packets are fewer than the minimum number of measure-
ments required for an accurate ğœ‡D reconstruction. In these cases,
the sparse recovery algorithm can not recover Hâ„“,ğ‘ (ğ‘š) as the avail-
able sensing units are insufficient. To tackle this problem, we allow
our system to inject sensing units into the channel whenever the
number of communication packets is not sufficient for Alg. 1 to
work. Different from existing ISAC frameworks, our sparse recov-
ery approach allows us to introduce a minimal amount of overhead,
as the ğœ‡D spectrum can be recovered from a number of CIR samples
which is much lower than the full length of the window ğ‘Š . Note
that for the injection of a sensing unit it is sufficient to transmit the
necessary CIR estimation fields, without any preamble and header
as used in conventional packets, since the unit is only received at
the AP itself and contains a known waveform.

3.5.1 Basis of the injection algorithm. In the following, we present
the proposed injection procedure assuming that both communica-
tion packets and sensing units are transmitted at times that lie on
a uniform grid with spacing ğ‘‡ğ‘ . This simplification is valid due to
the fact that the slotted resampling process described in Section 3.1
is used. Therefore, we can describe the injection process in terms
of windows of size ğ‘Š , where each value in the window occupies a
slot which is a multiple of ğ‘‡ğ‘ . Due to slotted resampling, the slots
can be empty if no packet was transmitted sufficiently close to it.
Our approach consists in setting a minimum number of sensing
units per window, termed ğ‘€ğ‘  , that allows a sufficiently accurate
reconstruction of the ğœ‡D signatures. We then transmit additional
units whenever the number of reflections of communication packets
in the window is not sufficient to meet this minimum requirement.
The proposed method only requires the knowledge of whether a
reflected communication packet is received in the current slot, i.e.,
no information about the future traffic pattern is needed.

3.5.2 Algorithm description. The algorithm, summarized in Alg. 2,
operates in three phases, namely observation (P1), scheduling (P2)

SPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

packet, then we remove the next sensing unit from the scheduled
ones, i.e., we set Sğ‘š â† Sğ‘š \ {minğ‘  âˆˆSğ‘š

Note that, despite operating on a half-window basis, due to the
overlap of adjacent windows, our algorithm only poses a constraint
on the minimum number of packets sent per full window. This
means that half a window can be empty as long as enough sensing
units are received in the other half.

ğ‘ }.

Figure 3: Example injection procedure with ğ‘€ğ‘  = 8,ğ‘Š = 16. 4 sens-
ing units are scheduled after P1 and P2. Then, as three reflected
communication packets are received, we reuse them and the first
three scheduled sensing units are not transmitted. The fourth sens-
ing unit is instead injected in the last slot.

and transmission (P3). Recall that the ğœ‡D extraction described in
Section 3.2 follows a window-based approach, with subsequent
windows overlapping by half of their length, as shown in Fig. 3.
Consider a time instant between the end of window ğ‘š âˆ’ 1 and the
start of window ğ‘š + 1. This coincides with the half of window ğ‘š,
which is between slots ğ‘šğ‘Š /2 âˆ’ 1 and ğ‘šğ‘Š /2. In this time instant
we can observe how many reflected communication packets were
received in the first half of window ğ‘š, which spans the indices
from (ğ‘š âˆ’ 1)ğ‘Š /2 to ğ‘šğ‘Š /2 âˆ’ 1 (P1, line 2 in Alg. 2). We denote
this number as ğ‘ğ‘ (ğ‘š). The injection algorithm is executed on a
half-window basis at the time when window ğ‘š âˆ’ 1 has ended
and window ğ‘š + 1 has not yet started, as this allows reasoning
on the sole current window ğ‘š. Based on ğ‘ğ‘ (ğ‘š), we can compute
how many sensing units we would need in the remaining half of
window ğ‘š in order to meet the requirement of at least ğ‘€ğ‘  units,
which we denote by ğ‘ğ‘¤ (ğ‘š) = max(ğ‘€ğ‘  âˆ’ ğ‘ğ‘ (ğ‘š), 0). However, the
sensing process has no knowledge of when future communication
packets will be received, so the best we can do is schedule the
transmission of ğ‘ğ‘¤ (ğ‘š) sensing units in the next half-window. The
slots in which these packets are scheduled can be selected according
to a deterministic rule or a probability distribution. We call Sğ‘š =
(cid:8)ğ‘ 1, . . . , ğ‘ ğ‘ğ‘¤ (ğ‘š)
(cid:9) the set of indices of the slots in which we schedule
the additional sensing units for the next half-window (P2, lines 4-5
in Alg. 2). While P1 and P2 are performed in a single time slot,
before the second half of window ğ‘š starts, P3 (lines 7-23 of Alg. 2)
is a dynamic process that spans the whole second half of window ğ‘š.
The indices of the slots considered in this part of the algorithm are
ğ‘ = ğ‘šğ‘Š /2, . . . , (ğ‘š + 1)ğ‘Š /2 âˆ’ 1. Note that some communication
packets, of which we have no knowledge, may be received in this
second half-window. The procedure iterates over the slots and in
each of them checks if a sensing unit was scheduled for that slot,
i.e., if ğ‘ âˆˆ Sğ‘š. There are four possible cases:
(1) ğ‘ âˆˆ Sğ‘š and no communication packet was received in this slot.
In this case we transmit the sensing unit, then remove ğ‘ from Sğ‘š.
(2) ğ‘ âˆˆ Sğ‘š and a communication packet (or more) was received in
this slot. In this case we reuse the sensing unit in the communication
packet and remove ğ‘ from Sğ‘š.
(3) ğ‘ âˆ‰ Sğ‘š and no communication packet was received in this slot.
In this case we just move to the next slot without taking action.
(4) ğ‘ âˆ‰ Sğ‘š and a communication packet (or more) was received in
this slot. In this case we reuse the sensing unit in the communication

Scheduling the sensing units. While the scheduling of the
3.5.3
sensing units in P2 can be done with any arbitrary policy that
guarantees that exactly ğ‘ğ‘¤ (ğ‘š) packets are scheduled in the next
half window, we want to maximize the number of sensing units
that can be piggybacked on communication packets, rather than
using a dedicated transmission. From P3 in Alg. 2, one can see that
scheduling the sensing units towards the end of the half-window
leaves more time for possible communication packets to become
available and thus be reused instead of injecting a new sensing unit.
Consequently, in SPARCS we schedule the sensing units for the
second half of window ğ‘š as a burst of packets spaced by ğ‘‡ğ‘ , which
occupy the last ğ‘ğ‘¤ (ğ‘š) slots of the window.

4 IMPLEMENTATION
In this section we describe the implementation of SPARCS on
a mmWave SDR platform. We base our implementation on the
IEEE 802.11ay WiFi protocol, as it operates in the unlicensed 60 GHz
band and supports CIR estimation for different BPs.
Testbed. We use the open-source mm-FLEX experimentation plat-
form from [15] for a baseline design. It has an FPGA-based baseband
processor which can generate, capture and process (custom or stan-
dard compliant) frames with up to 1.76 GHz of bandwidth. The
baseband processor is connected to mmWave RF front-ends with
phased antenna arrays and supports various front-ends to operate
in different frequency bands, e.g., at 28 GHz or 60 GHz [30]. In
the remainder of this paper we use a 60 GHz RF front-end which
simplifies experimentation as this is an unlicensed band, but we
note that simply by changing the RF front-end, SPARCS can operate
in a different band, e.g., for 5G-NR compatibility.

To implement SPARCS, we augment the functionalities of the
testbed to enable full-duplex operation, not only in the baseband
processor but also in the RF front-end. A block diagram of the
system is shown in Fig. 4. In the baseband processor, the operation
of the system is controlled by a state machine (SM) which triggers an
AXI-DMA that reads the I/Q samples from the DDR-TX memory and
feeds them to the DACs. The SM also triggers another AXI-DMA in
the receiver datapath that saves the receives samples in the DDR-
RX memory, i.e., both datapaths are synchronized and no packet
detection is required. To support the variable IFS extracted from real
(or artificially generated) traces, we include a block RAM memory
(BRAM) in the FPGA logic that stores the IFS that will be used in the
experiments. The SM reads these values sequentially, introducing a
delay in the system according to the value read from memory. The
variable IFS functionality can be disabled at runtime to configure a
fixed IFS. We remark that since we simultaneously use the up/down
conversion stages from the same mmWave development kit, the
Tx/Rx sub-systems are fed by the same local oscillator and thus
the Carrier Frequency Offset (CFO) is very low (< 100 Hz), which
enables the extraction of the ğœ‡D values required by SPARCS.

X = removed sensing unitS= scheduled sensing unitS = communication packetSWindowWindowâ€¦SSHalf of windowpacketsSXXXmm+1Na(m)TcNw(m)m1IPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

AoA estimation procedure described in Section 2.3.1, as proposed
in [23], to which we refer for further details. We experimented with
different values of ğ‘€ğ‘ , Î© and ğ‘„, as reported in Tab. 1 and described
in Section 5.3 and Section 5.5, while for the IHT algorithm we se-
lected the parameters that led to the most accurate convergence
results on our experiments, i.e., ğœ‚ = 1, ğœ‰ = 10âˆ’4 and ğ‘›max = 200.

5 EXPERIMENTAL RESULTS
We now present the experimental results obtained with our SPARCS
testbed implementation. The experiments were performed in a
laboratory of 6 Ã— 7 meters with a complex multi-path environment
due to additional reflections caused by furniture, computers, screens,
and a wide whiteboard.

5.1 Results on synthetic traces
As a first qualitative result we show the ğœ‡D spectrograms obtained
by SPARCS on randomly sampled CIRs of a walking subject (see
Fig. 5). For this, we use synthetic traces, generated by measuring
the CIR using a uniform sampling interval equal to ğ‘‡ğ‘ , and then
setting to 0 a variable number of uniformly distributed values per
window to simulate missing samples. This is a simplified case, as (i)
the available (not removed) packets lie on a regular grid with spac-
ing ğ‘‡ğ‘ , therefore no approximation error is introduced by slotted
resampling, and (ii) samples are removed on a per window basis,
so a minimum number of packets in each window is guaranteed.
Still, this evaluation is useful to highlight the impact of increas-
ing the sparsity level of the measurements for SPARCS compared
to standard STFT [24]. In the results presented in this section, no
packet injection is performed, as we aim to assess the impact of the
number of measurements per window on the reconstructed ğœ‡D. In
Fig. 5b we show the baseline walking spectrogram obtained using
the standard STFT using the full window of 64 samples, as done
in [23]. The spectrogram shows a typical walking ğœ‡D modulation,
with the contribution of the static clutter (the strong component at
0 velocity), of the torso (the strong oscillating component around
Â±1.5 m/s and the limbs (the faint contributions around the torso
component). Moreover, a certain amount of noise and interference
is present, as shown by the non-zero background level and the
horizontal lines at around Â±2 m/s and Â±3.7 m/s. In Fig. 5c, the same
method is applied to windows with only 16 out of 64 the samples
retained, while the rest is set to 0. The impact is very strong as it
completely corrupts the useful structure in the ğœ‡D signature. From
Fig. 5d to Fig. 5f we show the results obtained by SPARCS, on the
same sequence, with 64, 16 and 4 samples out of 64, respectively.
At the top of each figure, we report the Root Mean-Squared Er-
ror (RMSE) of the ğœ‡D with respect to a ground truth spectrogram,
shown in Fig. 5a. This ground truth was obtained from the STFT out-
put with full measurement windows (Fig. 5b), by manually isolating
the useful ğœ‡D spectrum containing the gait information and setting
to 0 any background noise and interference lines. We observe two
interesting aspects. On the one hand, the SPARCS algorithm can
successfully recover the ğœ‡D spectrum even when a large fraction
of the samples is missing, and the quality of the result decreases
gracefully with the sparsity of the available measurements. Unlike
standard STFT, SPARCS almost completely eliminates the noise and
interference in the estimated ğœ‡D spectrogram. Such improvement is

Figure 4: SPARCS implementation block diagram.

Table 1: Summary of the SPARCS implementation parameters. The
suggested values based on experimental results are shown in bold.

System parameters

Grid step
Window length
Window shift
Sparsity parameter
No. aggregated paths
Min. no. measurements
IHT learning rate
IHT convergence threshold
IHT maximum iteration number

ğ‘‡ğ‘
ğ‘Š
ğ›¿
Î©
ğ‘„
ğ‘€ğ‘ 
ğœ‚
ğœ‰
ğ‘›max

0.27 ms
64
32
{1, 2, 3, 4, 5, 6, 7}
{1, 3, 5, 7, 9, 11, 13, 15}
{4, 8, 16, 24, 32, 64}
1
10âˆ’4
200

IEEE 802.11ay CIR estimation details. In IEEE 802.11ay, in-
packet beam tracking [10] is introduced, where the CIR is estimated
using different BPs within a single packet. This is implemented by
appending a given number of training (TRN) fields to the packet. A
TRN field is composed of 6 TRN units formed by complementary
Golay sequences of 128 BPSK modulated samples, for a total of
768 samples [37]. In our implementation, we use ğ‘›TRN TRN fields
as the SPARCS sensing unit, where each TRN field employs a differ-
ent BP, and ğ‘›TRN is the number of subjects being tracked by the
system, as a single TRN field per subject suffices. Considering the
typical number of people that are to be simultaneously tracked in
human sensing systems, reasonable ğ‘›TRN values range from 1 to
10. The CIR estimates obtained from the TRN fields are then used
as the input to SPARCS sparse recovery algorithm.
System parameters. In Tab. 1 we summarize the system parame-
ters used in the implementation. We set ğ‘‡ğ‘ = 0.27 ms and ğ‘Š = 64,
which lead to (i) a velocity resolution of Î”ğ‘£ = ğ‘/(2ğ‘“ğ‘œğ‘Šğ‘‡ğ‘ ) â‰ˆ
0.14 m/s and (ii) aliasing-free velocity measurements up to ğ‘£max =
Â±ğ‘/(4ğ‘“ğ‘œğ‘‡ğ‘ ) â‰ˆ Â±4.48 m/s. These values are not critical to the func-
tioning of our system, and can be modified according to specific
implementation requirements. However, for reliable ğœ‡D extraction
without aliasing, it is advisable to adjust ğ‘‡ğ‘ to a value that allows
capturing the range of velocities typically covered by human move-
ment, e.g., approximately Â±2âˆ’3 m/s for a walking person, and up to
Â±5 m/s for running or other fast movements [35]. Note that suitable
values of ğ‘‡ğ‘ can also be obtained in 5G-NR systems, where a base
station can transmit downlink CSI-RS frames with a periodicity
between 0.3125 ms and 80 ms. For a 5G-NR carrier frequency of
28 GHz, using ğ‘‡ğ‘ = 0.3125 ms leads to ğ‘£max â‰ˆ Â±8.57 m/s, which
is enough to capture fast human movement.

For people tracking, we use periodically transmitted in-packet
beam training frames with 12 TRN units and antenna beams cover-
ing a FOV range from âˆ’45â—¦ to 45â—¦. Then, we utilize the distance and

DDRTxDDRRxBRAMSMAXIDMAAXIDMADACADCuPBaseband Processormm-wavefront-endTxRxTo hostPCSPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

Ground

truth

(a)
STFT.

Full

(b)
(STFT).

window

(c) 1/4 sparse (STFT). (d)

Full
(SPARCS).

window

1/4
(e)
SPARCS).

sparse

(

(f) 1/16 sparse (SPARCS).

Figure 5: Walking ğœ‡D spectrograms and RMSE for different levels of sparsity, obtained by uniformly removing samples for each window.

pdx/vwave communication patterns we use the injection algorithm
(Alg. 2) to send additional sensing units when needed.

Even though the pdx/vwave dataset is based on a legacy sub-6
GHz WiFi protocol, we argue that it is still reasonable to use it to ob-
tain realistic packet transmission patterns. While in the pdx/vwave
dataset the maximum physical layer PDU size is PPDUpdx =
1.5 kB (without packet aggregation), in IEEE 802.11ay three main
transmission modes are defined, namely High Throughput (HT),
Directional Multi Gigabit (DMG) and Very High Throughput (VHT),
with maximum physical layer PDU sizes, PPDUay, of 65 kB, 262 kB
and 4692 kB, respectively [36, 37]. With the increase in the packet
sizes, the data rates of mmWave systems have increased accord-
ingly, and in IEEE 802.11ay they will range from 0.3 Gbps to several
Gbps. As a numerical example, the traffic patterns in pdx/vwave
with a typical bitrate of 4 Mbps would correspond to a bitrate of
0.7 Gbps in DMG IEEE 802.11ay when using an aggregated packet
size of 262 kB instead of 1.5 kB. Note that traces with a larger
number of packets and smaller PDU sizes (as will likely be the case
in real deployments) will simply increase the sensing accuracy and
further reduce the overhead.

5.3 Human activity recognition results
To evaluate the quality of the ğœ‡D spectrograms extracted by SPARCS,
we use them as the input to a HAR method. Specifically, we follow
a standard approach, training a deep neural network on a dataset
of Î› Ã— ğ‘Š dimensional ğœ‡D spectrograms, with Î› = 200 (equivalent
to â‰ˆ 1.76 s), in order to classify the movement performed by the
person during that time. In order to provide a comparison with
other IEEE 802.11ay HAR methods based on regular CIR sampling,
such as RAPID [23], we consider the 4 following activities: walking,
running, sitting and waving hands. For HAR, we use a standard
Convolutional Neural Network (CNN) architecture, composed of
4 inception modules [33] performing 1 Ã— 1, 3 Ã— 3 and 5 Ã— 5 con-
volutions. The number of filters used is 8, 16, 32 and 64 for the 4
modules, respectively. The convolutional blocks are followed by a
fully-connected layer with 64 neurons, to which we apply Dropout
[31], and a final Softmax layer with 4 outputs [12]. We use the
exponential-linear unit activation function after each layer [6].

5.3.1 Training data. We collected a training dataset involving 6
different subjects performing the 4 activities, for a total duration of
about 12 minutes each. This leads to over 400 partially overlapping,
1.76 s long, ğœ‡D sequences per activity, which we then augmented

Figure 6: Example traffic patterns from the pdx/vwave dataset.

Table 2: Details of the 3 sequences of the pdx/vwave dataset.

Trace

Environment

psu cs
library
ug

University CS dept.
Public library
Coffee shop

No. frames Duration
1 : 00 h
4 : 00 h
2 : 34 h

260326
1300671
895721

made possible by the sparsity constraint in Eq. (7), which allows for
a lower RMSE than STFT operating on full measurement windows.
This is the main reason why SPARCS not only reduces the overhead
needed for human sensing, but also improves its accuracy.

5.2 Realistic traces: the pdx/vwave dataset
Next, we evaluate the performance of SPARCS on realistic WiFi
AP traces. This poses an experimental challenge, because commer-
cial devices implementing the IEEE 802.11ay standard are not yet
available, and no public datasets containing real traffic traces for
the PHY layer of mmWave WiFi (IEEE 802.11ay/ad) exist, to the
best of our knowledge. For this reason, we used the pdx/vwave
dataset, containing real traffic traces captured in different real en-
vironments from WiFi APs employing a legacy (sub-6 GHz) WiFi
protocol [25]. Specifically, we use 3, over 1 hour long, traces from
this dataset, called psu cs, library and ug, respectively. We select
traces collected in different environments to represent different
kinds of traffic patterns (see Tab. 2).

The pdx/vwave dataset includes information about the trans-
mission instants and packet sizes of all packets outgoing from the
considered AP. Exploiting this information, we perform our mea-
surements transmitting packets according to these time patterns
(see Section 5.3), using the BRAM in the FPGA to store the de-
sired transmission instants (see Section 4). On top of the existing

0.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]Groundtruth0.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]RMSE=1.820.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]RMSE=4.210.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]RMSE=1.460.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]RMSE=1.780.01.73.55.26.9Time[s]-4.1-3.0-2.0-1.01.02.03.04.1v[m/s]RMSE=2.370.00.20.40.60.81.0020Time[s]012TransmittedkBpsucs020Time[s]012library020Time[s]012ugIPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

Figure 7: Per-class F1 scores obtained by SPARCS (for different val-
ues of ğ‘€ğ‘  ) and RAPID on our test dataset [23].

as described shortly. Note that the training data only includes uni-
formly sampled CIR traces with sampling period ğ‘‡ğ‘ = 0.27 ms. The
CNN training is done for 80 epochs, using a learning rate of 10âˆ’4,
the Adam optimizer and the cross-entropy loss function [12]. In
order to enhance the robustness of the CNN, we apply an ad-hoc
data augmentation strategy: we randomly remove some of the CIR
samples in each window of the training dataset, and then apply
SPARCSâ€™ IHT algorithm to reconstruct the spectrograms (see Sec-
tion 5.1). We repeat the process using a sparsity level of 1/8, 1/4
and 1/2, enlarging the training dataset to 4 times its original size,
for a total of approximately 1600 ğœ‡D spectrograms per activity. A
randomly selected subset of the training data (around 10 %) was
used as a validation set to tune the CNN hyperparameters.

5.3.2 Test data. We test the CNN on the ğœ‡D spectrograms obtained
from CIR samples collected using the pdx/vwave packet traces
described in Section 5.2. We collect four, randomly selected, 20 s
long traces (one per activity) for each of the 3 sequences types
(psu cs, library and ug). We repeat the experiments for different
values of the minimum number of sensing units per window, ğ‘€ğ‘  =
4, 8, 16, 32, 64, for a total of 60 test sequences. The test data involves
a single subject, which was not included in the training set.

5.3.3 HAR F1 score. We evaluate the performance of the CNN with
the per-class F1 score metric [5], which effectively summarizes the
precision and recall and preserves the class-specific results. Fig. 7
shows the total average per-class F1 score over the 60 sequences, for
different values of the minimum number of sensing units per win-
dow, ğ‘€ğ‘  . As a baseline for comparison, we also report the F1 score
obtained by the RAPID algorithm from [23], which extracts the ğœ‡D
signatures by regularly sampling the CIR. Our results show that
SPARCS can reach over 0.9 F1 scores on all activities with ğ‘€ğ‘  = 8
already, which corresponds to only 1/8 of the full measurements
window. Notably, with ğ‘€ğ‘  = 4, the low number of measurements
per window affects significantly only the â€™Sittingâ€™ and â€™Waving
handsâ€™ activities, which involve fine-grained movements and are
therefore more difficult to classify. Finally, we compare the results
from SPARCS and RAPID [23]. For a fair comparison, we imple-
mented RAPIDâ€™s STFT to extract the ğœ‡D and trained the CNN on
the resulting spectrograms without enlarging the dataset using dif-
ferent levels of sparsity described in the previous section. Instead,
we directly use the training procedure of [23], since we found that
the sparsity-based data augmentation slightly reduced RAPIDâ€™s
performance. It can be seen that SPARCSâ€™ sparse recovery problem
formulation (Section 3.2) and enforcing a sparsity constraint on
the individual paths is beneficial to HAR performance. The gap is

Figure 8: Overhead of SPARCS for different values of ğ‘€ğ‘  in the three
traces of the pdx/vwave dataset (left). Overhead vs. average HAR F1
score for different values of ğ‘€ğ‘  (right).

particularly significant for â€™Sittingâ€™ and â€™Waving handsâ€™ as they in-
volve lower energy traces in the spectrograms; these are more easily
corrupted by noise and interference, that SPARCS is mostly able to
reject (see, again, the comparison between Fig. 5b and Fig. 5d).

5.4 Overhead analysis
Increasing ğ‘€ğ‘  to improve the HAR performance also increases the
overhead of SPARCS. A first general measure of this can be obtained
comparing the maximum size of a PPDU in IEEE 802.11ay to the size
of a sensing unit. Recalling the three different modes introduced in
Section 5.2 and the size of an IEEE 802.11ay TRN field (768 bits),
we obtain that a sensing unit, with ğ‘›TRN = 1, is 0.1%, 0.03% and
0.002% of a PPDU in HT, DMG and VHT, respectively. Moreover,
the channel occupation time for a sensing unit with ğ‘›TRN = 1
is 436 ns [37], which is a negligible fraction (0.16%) of a slot of
duration ğ‘‡ğ‘ .

Next, to evaluate the overhead of SPARCS on a realistic commu-
nication scenario, we use the traces of the pdx/vwave dataset. In
this way, we can also assess the impact of injecting sensing units,
as they are not useful to the communication process. Denote by
ğ‘ğ‘– the number of bits in the ğ‘–-th communication packet transmit-
ted in the trace. As the number of bits transmitted in each trace
refers to a legacy, lower bitrate, WiFi protocol, we rescaled the
packet sizes according to the maximum PHY layer packet size in
IEEE 802.11ay. We rescaled the size of packet ğ‘– in each trace as
Ëœğ‘ğ‘– = (PPDUay/PPDUpdx) Ã—ğ‘ğ‘– , with PPDUay = 262 kB. We call
ğ‘›ğ‘ the number of transmitted communication packets in a trace, by
TRNlen the length, in bits, of a piggybacked or injected TRN field,
ğ‘›inj the number of injected sensing units and ğ‘›TRN the number of
TRN fields used in every sensing operation (we consider it fixed,
whereas in reality it is determined by the number of subjects in the
environment). We define the overhead as a function of ğ‘›inj as

OH(ğ‘›inj) =

ğ‘›TRN

(cid:0)ğ‘›ğ¶ + ğ‘›inj
(cid:205)ğ‘›ğ‘
ğ‘–=1 Ëœğ‘ğ‘–

(cid:1) TRNlen

.

(10)

In Fig. 8, left, we show the overhead obtained on each of the three
pdx/vwave traces, using ğ‘›TRN = 1. The overhead for different
values of ğ‘›TRN can be obtained by using it as a multiplicative
factor on the values in Fig. 8. We see that the overhead scales almost
linearly as ğ‘€ğ‘  is increased from 4 to 64. For values of ğ‘€ğ‘  < 32,
the entailed overhead is less than 4%, falling below 1% for ğ‘€ğ‘  = 8
As a reference, we report the overhead for ğ‘€ğ‘  = 64, which is the

48163264RAPIDMin.sensingunitsperwindowMs0.750.800.850.900.951.00F1ScoreWalkingRunningSittingWavingHands0816243240485664Min.sensingunitsperwindowMs02468Overhead[%]psucslibraryug0.00.51.01.52.02.53.0Overhead[%]0.880.900.920.940.960.98F1ScoreRAPIDMs=4Ms=8Ms=16Ms=32Ms=64SPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

value obtained by injecting sensing units continuously into the
channel, piggybacking them eventually on communication packets
if possible. Note that existing approaches requiring uniform CIR
sampling, like RAPID [23], would require an even higher overhead,
as not only do they need 64 samples per window, but these samples
have to be regularly spaced as no resampling procedure is carried
out. This means they would have to take precedence over potential
data packets so that they are sent exactly at the right sampling time.
From Fig. 8, right, one can see that SPARCS can achieve an F1
score of over 0.9 for every activity for a minimum of ğ‘€ğ‘  = 8 sensing
units per window, resulting in a sensing overhead of less than 1%.
With this configuration, SPARCS achieves a better F1 score than
existing approaches, while reducing overhead by a factor of 7 and
being compatible with random access MAC protocols.

5.5 Sensitivity to the choice of the parameters
In Fig. 9, we show the effect of varying parameters ğ‘„, representing
the number of paths aggregated around the personâ€™s position (see
Eq. (9)), and Î©, which is the maximum number of resolvable Doppler
components, equal to the sparsity parameter in the IHT algorithm.
We computed the HAR per-class F1 score using a random subset of
the 60 test sequences. The values adopted in our experiments are
reported in Tab. 1.

Impact of changing ğ‘„. Our results show that SPARCS is ro-
5.5.1
bust to almost any value of ğ‘„ when considering walking and run-
ning, whereas sitting and waving hands are negatively affected by
reducing ğ‘„ below 7. This is due to the fact that while walking and
running are, in most cases, distinguishable even from the sole con-
tribution of the torso, this is not true for sitting and waving hands
that require including the reflection paths coming from the limbs.
Computational complexity considerations are also in order for high
values of ğ‘„, as it leads to solving ğ‘„ times Eq. (7) at each ğœ‡D extrac-
tion process. As the problems are independent, they can be solved
in parallel, and thus a reasonable approach is to tune ğ‘„ according
to a trade-off between ğœ‡D reconstruction accuracy and hardware
resource availability for parallelization. In the following, we use
ğ‘„ = 9. Considering that we use ğµ = 1.76 GHz transmission band-
width (1 IEEE 802.11ay channel), the range resolution of SPARCS
is ğ‘/2ğµ = 8.5 cm. This means that summing the contribution of
âŒŠğ‘„/2âŒ‹ distance bins before and after the one corresponding to the
torso, we include in the spectrum a region of Â±34 cm around the
personâ€™s position, which is a reasonable value considering typical
body sizes and that the subjects are moving.

Impact of changing Î©. Fixing ğ‘„ = 9, in Fig. 9 (right), we
5.5.2
show that the best values for Î© are 2 and 3 for all the activities.
This is because using Î© = 1 often leads to only reconstructing the 0
Doppler component in the spectrogram, losing the information on
the personâ€™s movement. On the other hand, choosing Î© too high
makes the IHT reconstruction imprecise, as with a low number of
measurements per window enforcing more sparsity is beneficial to
restrict the number of possible solutions to Eq. (7).

6 RELATED WORK
Dedicated mmWave radars. The high sensitivity of mmWaves
to micro-Doppler shifts, together with Deep Learning (DL) methods

Figure 9: Per-class F1 scores aggregating a different number of paths
ğ‘„ (left) and changing Î©, the IHT sparsity parameter (right).

for spectrogram analysis and classification, have been widely ex-
ploited to enable applications such as activity recognition [16, 29],
person identification [21, 24] and bio-mechanical gait analysis [27].
The typical approach in these works is to transmit sequences of
large bandwidth signals (of 2 to 4 GHz), with a rate dictated by the
desired sensing resolution [22]. Thus, mmWave radar sensors have
two main drawbacks:
(i) they are specifically tailored to sensing and cannot perform
communication. Moreover, their deployment cost is relatively high
as one single sensor can reliably cover a range of at most 8 âˆ’ 10 m
due to the radial distortion and occlusion problems [8]. For this
reason, ad-hoc radar sensor networks would need to be deployed in
practical scenarios. Our method, in contrast, fully exploits existing
mmWave communication systems with no modifications to the CIR
estimation process or packet structures.
(ii) The fixed chirp transmission interval, which is related to the ğœ‡D
resolution, requires regular transmissions with continuous channel
occupation. Some works have explored the possibility of randomly
subsampling the chirp transmission intervals using compressive
sensing [7] to either save computational resources [32] or reduce
the effect of unwanted interference [28]. However, these works are
based on a radar framework, where the transmission instants can
be freely chosen and optimized. SPARCS, instead, reuses the given
underlying communication traffic as much as possible and only
injects small additional sensing units when necessary.
60 GHz WiFi sensing. Research interest towards sensing with
WiFi devices working in the mmWave band has mostly focused on
the 60 GHz IEEE 802.11ad/ay standards [23, 38, 39]. These works
target various applications, such as person tracking and gesture
recognition, exploiting CIR estimation to detect humans in the
environment. However, they require dedicated and regular sens-
ing signal transmissions in order to function properly, entailing a
significant overhead and channel utilization for sensing.

Our work significantly improves over the above mentioned stud-
ies in that it enables the reuse of randomly distributed communi-
cation packets via sparse recovery, whenever possible. This is of
key importance to integrate sensing capabilities in communication
devices while maintaining low overhead and complexity.
Integrated sensing and communication. A number of technical
works address ISAC systems in next generation 5G/6G cellular
networks [17, 18] and WLANs [23, 26]. Many of those target the
joint communication and sensing waveform design [19] and are
mostly oriented to automotive applications to measure distance
and velocity of nearby vehicles. In contrast, few works focus on

13579111315NumberofaccumulatedpathsQ0.50.60.70.80.91.0AverageF1scoreWalkingRunningSittingWavinghands1234567Sparsityparameterâ„¦0.00.10.20.30.40.50.60.70.80.91.0AverageF1scoreWalkingRunningSittingWavinghandsIPSN, May 04â€“06, 2022, Milan, Italy

Jacopo Pegoraro, Jesus O. Lacruz, Michele Rossi, and Joerg Widmer

human sensing [17], which is the aim of the present work. All
of the above approaches alternate communication and sensing
phases according to a time-division scheme, causing significant
overhead and channel occupation. SPARCS instead, provides a full
ISAC scheme, as it passively exploits communication traffic while
dynamically injecting sensing units to cover silent periods. As a
result, our method significantly reduces sensing overhead while at
the same time improving the sensing accuracy.

7 CONCLUDING REMARKS
In this paper, we have designed and implemented SPARCS, the first
mmWave ISAC system that can sense human ğœ‡D signatures from
irregular and sparse CIR estimates. These are obtained in a stan-
dard compliant way by both reusing optional CIR estimation fields
appended to communication packets and sporadically injecting
sensing packets whenever communication traffic is absent. Differ-
ently from the existing ISAC methods, SPARCS is based on a sparse
recovery approach to the ğœ‡D reconstruction, which is theoretically
grounded in the instrinsic sparse multi-path environment of the
mmWave channel. This enables an accurate ğœ‡D extraction from a
significantly lower number of randomly distributed CIR samples,
thus drastically reducing the sensing overhead. After a CIR resam-
pling step along the time domain, SPARCS performs an iterative
sparse reconstruction in the frequency domain, decoupling differ-
ent propagation paths at first, to leverage their sparsity property,
and then combining them to obtain the final ğœ‡D spectrum.

While SPARCS is compatible with different mmWave systems
(e.g., 3GPP 5G-NR, and IEEE 60 GHz WLANs), for our implementa-
tion we used an IEEE 802.11ay SDR platform working in the 60 GHz
band. We tested our system on a large set of standard-compliant
CIR traces matching the traffic patterns of real WiFi access points,
performing a typical downstream application such as HAR. Our
results show that SPARCS entails over 7 times lower overhead
compared to prior methods, while achieving better performance.

Future research directions include refining SPARCS by lever-
aging an exchange of information between the sensing and com-
munication processes, e.g., utilizing sensing to optimize the beam
selection, and exploiting communications for collaborative sensing.

ACKNOWLEDGMENTS
This research work was sponsored in part by the European Unionâ€™s
Horizon 2020 research and innovation programme under grants
No. 871249, on â€œLOCalization and analytics on-demand embedded
in the 5G ecosystem for Ubiquitous vertical applicationSâ€ (LOCUS)
and No. 861222, on â€œMIllimeter-wave NeTworking and Sensing
for beyond 5Gâ€ (MINTS), by the Spanish Ministry of Science and
Innovation (MICIU) grant RTI2018-094313-B-I00 (PinPoint5G+), by
the Region of Madrid through TAPIR-CM (S2018/TCS-4496) and by
the Italian Ministry of Education, University and Research (MIUR)
through the initiative â€œDepartments of Excellenceâ€ (Law 232/2016).

REFERENCES
[1] Prabhu Babu and Petre Stoica. 2010. Spectral analysis of nonuniformly sampled

dataâ€“a review. Digital Signal Processing 20, 2 (Mar 2010), 359â€“378.

[2] Yaakov Bar-Shalom, Fred Daum, and Jim Huang. 2009. The probabilistic data

association filter. IEEE Control Systems Magazine 29, 6 (2009), 82â€“100.

[3] Boualem Boashash. 2015. Time-frequency signal analysis and processing: a com-

prehensive reference. Academic press.

[4] Victor C Chen, Fayin Li, S-S Ho, and Harry Wechsler. 2006. Micro-Doppler
effect in radar: phenomenon, model, and simulation study. IEEE Transactions on
Aerospace and electronic systems 42, 1 (2006), 2â€“21.

[5] Nancy Chinchor. 1992. MUC-4 Evaluation Metrics. In Proceedings of the 4th
Conference on Message Understanding (McLean, Virginia) (MUC4 â€™92). Association
for Computational Linguistics, USA, 22â€“29.

[6] Djork ArnÃ© Clevert, Thomas Unterthiner, and Sepp Hochreiter. 2016. Fast and ac-
curate deep network learning by exponential linear units (ELUs). In International
Conference on Learning Representations (ICLR). San Juan, Puerto Rico.

[7] Yonina C Eldar and Gitta Kutyniok. 2012. Compressed sensing: theory and appli-

cations. Cambridge University Press.

[8] Lipeng Feng, Shibo Du, Zhen Meng, Anfu Zhou, and Huadong Ma. 2020. Eval-
uating mmWave Sensing Ability of Recognizing Multi-people Under Practical
Scenarios. In International Conference on Green, Pervasive, and Cloud Computing.
Springer, 61â€“74.

[9] Simon Foucart and Holger Rauhut. 2013. A Mathematical Introduction to Com-

pressive Sensing. Springer.

[10] Y. Ghasempour, C. R. C. M. da Silva, C. Cordeiro, and E. W. Knightly. 2017. IEEE
802.11ay: Next-Generation 60 GHz Communication for 100 Gb/s Wi-Fi. IEEE
Communications Magazine 55, 12 (2017), 186â€“192.

[11] Marco Giordani, Michele Polese, Arnab Roy, Douglas Castor, and Michele Zorzi.
2018. A tutorial on beam management for 3GPP NR at mmWave frequencies.
IEEE Communications Surveys & Tutorials 21, 1 (2018), 173â€“196.

[12] Ian Goodfellow, Yoshua Bengio, and Aaron Courville. 2016. Deep learning. MIT

press.

[13] Belal Korany, Hong Cai, and Yasamin Mostofi. 2020. Multiple People Identification
Through Walls Using Off-the-Shelf WiFi. IEEE Internet of Things Journal 8, 8
(2020), 6963â€“6974.

[14] Preeti Kumari, Junil Choi, Nuria GonzÃ¡lez-Prelcic, and Robert W Heath. 2017.
IEEE 802.11 ad-based radar: An approach to joint vehicular communication-radar
system. IEEE Transactions on Vehicular Technology 67, 4 (2017), 3012â€“3027.
[15] Jesus O. Lacruz, Dolores Garcia, Pablo JimÃ©nez Mateo, Joan Palacios, and Joerg
Widmer. 2020. mm-FLEX: An Open Platform for Millimeter-Wave Mobile Full-
Bandwidth Experimentation. In Proceedings of the 18th International Conference
on Mobile Systems, Applications, and Services (Toronto, Ontario, Canada) (MobiSys
â€™20). Association for Computing Machinery, New York, NY, USA, 1â€“13. https:
//doi.org/10.1145/3386901.3389034

[16] Guoji Lai, Xin Lou, and Wenbin Ye. 2021. Radar-Based Human Activity Recogni-
tion With 1-D Dense Attention Network. IEEE Geoscience and Remote Sensing
Letters (2021).

[17] Guoliang Li, Shuai Wang, Jie Li, Rui Wang, Fan Liu, Meihong Zhang, Xiaohui
Peng, and Tony Xiao Han. 2021. Rethinking the Tradeoff in Integrated Sensing
and Communication: Recognition Accuracy versus Communication Rate. arXiv
preprint arXiv:2107.09621 (2021).

[18] Fan Liu, Yuanhao Cui, Christos Masouros, Jie Xu, Tony Xiao Han, Yonina C Eldar,
and Stefano Buzzi. 2021. Integrated sensing and communications: Towards dual-
functional wireless networks for 6G and beyond. arXiv preprint arXiv:2108.07165
(2021).

[19] Fan Liu, Longfei Zhou, Christos Masouros, Ang Li, Wu Luo, and Athina Petropulu.
2018. Toward dual-functional radar-communication systems: Optimal waveform
design. IEEE Transactions on Signal Processing 66, 16 (2018), 4264â€“4279.
[20] Francesca Meneghello, Domenico Garlisi, NicolÃ² Dal Fabbro, Ilenia Tinnirello, and
Michele Rossi. 2021. Environment and Person Independent Activity Recognition
with a Commodity IEEE 802.11 ac Access Point. arXiv preprint arXiv:2103.09924
(2021).

[21] Zhen Meng, Song Fu, Jie Yan, Hongyuan Liang, Anfu Zhou, Shilin Zhu, Huadong
Ma, Jianhua Liu, and Ning Yang. 2020. Gait Recognition for Co-Existing Mul-
tiple People Using Millimeter Wave Sensing. In AAAI Conference on Artificial
Intelligence. New York, New York, USA.

[22] Sujeet Milind Patole, Murat Torlak, Dan Wang, and Murtaza Ali. 2017. Automotive
radars: A review of signal processing techniques. IEEE Signal Processing Magazine
34, 2 (Mar 2017), 22â€“35.

[23] Jacopo Pegoraro, Jesus Omar Lacruz, Enver Bashirov, Michele Rossi, and Joerg
Widmer. 2021. RAPID: Retrofitting IEEE 802.11 ay Access Points for Indoor
Human Detection and Sensing. arXiv preprint arXiv:2109.04819 (2021).

[24] Jacopo Pegoraro, Francesca Meneghello, and Michele Rossi. 2021. Multiper-
son Continuous Tracking and Identification From mm-Wave Micro-Doppler
Signatures.
IEEE Transactions on Geoscience and Remote Sensing 59, 4 (2021),
2994â€“3009.

[25] Caleb Phillips and Suresh Singh. 2009. CRAWDAD dataset pdx/vwave (v. 2009-

07-04). Available at https://crawdad.org/pdx/vwave/20090704/wlan_nano_fcs.

[26] Francesco Restuccia. 2021. IEEE 802.11bf: Toward Ubiquitous Wi-Fi Sensing.

arXiv:2103.14918

[27] Ann-Kathrin Seifert, Moeness G Amin, and Abdelhak M Zoubir. 2019. Toward
unobtrusive in-home gait analysis based on radar micro-Doppler signatures. IEEE
Transactions on Biomedical Engineering 66, 9 (2019), 2629â€“2640.

[28] Ervin SejdiÄ‡, Irena OroviÄ‡, and Srdjan StankoviÄ‡. 2018. Compressive sensing meets
timeâ€“frequency: An overview of recent advances in timeâ€“frequency processing

SPARCS: A Sparse Recovery Approach for Integrated Communication and Human Sensing in mmWave Systems

IPSN, May 04â€“06, 2022, Milan, Italy

of sparse signals. Digital signal processing 77 (2018), 22â€“35.

[29] Akash Deep Singh, Sandeep Singh Sandha, Luis Garcia, and Mani Srivastava.
2019. Radhar: Human activity recognition from point clouds generated through
a millimeter-wave radar. In Proceedings of the 3rd ACM Workshop on Millimeter-
wave Networks and Sensing Systems. 51â€“56.

[30] Sivers Semiconductors. 2021.

Evaluation Kits.

https://www.sivers-

semiconductors.com/sivers-wireless/evaluation-kits//.

[31] Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan
Salakhutdinov. 2014. Dropout: a simple way to prevent neural networks from
overfitting. Journal of machine learning research 15, 1 (Jun 2014), 1929â€“1958.
[32] Srdjan StankoviÄ‡, Irena OroviÄ‡, Tamara PejakoviÄ‡, and MiloÅ¡ OroviÄ‡. 2014. Com-
pressive sensing reconstruction of signals with sinusoidal phase modulation:
application to radar micro-Doppler. In 2014 22nd Telecommunications Forum
Telfor (TELFOR). IEEE, 565â€“568.

[33] Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott Reed, Dragomir
Anguelov, Dumitru Erhan, Vincent Vanhoucke, and Andrew Rabinovich. 2015.
Going deeper with convolutions. In Proceedings of the IEEE conference on computer
vision and pattern recognition. Boston, Massachussets, USA.

[34] 3GPP TS38.300. 2018. NR and NG-RAN Overall Description; Stage 2 (Release 15).

V15.2.0 (2018-06) (2018).

[35] Baptist Vandersmissen, Nicolas Knudde, Azarakhsh Jalalvand, Ivo Couckuyt,
Andre Bourdoux, Wesley De Neve, and Tom Dhaene. 2018. Indoor person identi-
fication using a low-power FMCW radar. IEEE Transactions on Geoscience and
Remote Sensing 56, 7 (2018), 3941â€“3952.

[36] IEEE 802.11 working group. 2012. Wireless LAN Medium Access Control (MAC)
and Physical Layer (PHY) Specifications Amendment 3: Enhancements for Very
High Throughput in the 60 GHz Band. IEEE Standard 802.11ad (2012).

[37] IEEE 802.11 working group. 2019.

IEEE Draft Standard for Information
Technology-Telecommunications and Information Exchange Between Systems
Local and Metropolitan Area Networks-Specific Requirements Part 11: Wireless
LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications-
Amendment: Enhanced Throughput for Operation in License-Exempt Bands
Above 45 GHz. IEEE P802.11ay/D3.0 (2019).

[38] Chenshu Wu, Feng Zhang, Beibei Wang, and KJ Ray Liu. 2020. mmTrack: Pas-
sive multi-person localization using commodity millimeter wave radio. In IEEE
INFOCOM 2020-IEEE Conference on Computer Communications. IEEE, 2400â€“2409.
[39] Feng Zhang, Chenshu Wu, Beibei Wang, and KJ Ray Liu. 2020. mmEye: Super-
Resolution Millimeter Wave Imaging. IEEE Internet of Things Journal (2020).
[40] Peijun Zhao, Chris Xiaoxuan Lu, Jianan Wang, Changhao Chen, Wei Wang, Niki
Trigoni, and Andrew Markham. 2019. mID: Tracking and Identifying People with
Millimeter Wave Radar. In 15th International Conference on Distributed Computing
in Sensor Systems (DCOSS). Santorini Island, Greece.

