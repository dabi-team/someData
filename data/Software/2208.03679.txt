2
2
0
2

g
u
A
3
1

]
E
M

.
t
a
t
s
[

2
v
9
7
6
3
0
.
8
0
2
2
:
v
i
X
r
a

Transformation models for ROC analysis

Ainesh Sewak
Universität Zürich

Torsten Hothorn
Universität Zürich

Abstract

Receiver operating characteristic (ROC) analysis is one of the most popular approaches
for evaluating and comparing the accuracy of medical diagnostic tests. Although various
methodologies have been developed for estimating ROC curves and its associated sum-
mary indices, there is no consensus on a single framework that can provide consistent
statistical inference whilst handling the complexities associated with medical data. Such
complexities might include covariates that inﬂuence the diagnostic potential of a test, or-
dinal test data, censored data due to instrument detection limits or correlated biomarkers.
We propose a regression model for the transformed test results which exploits the invari-
ance of ROC curves to monotonic transformations and naturally accommodates these
features. Our use of maximum likelihood inference guarantees asymptotic eﬃciency of
the resulting estimators and associated conﬁdence intervals. Simulation studies show that
the estimates based on transformation models are unbiased and yield coverage at nomi-
nal levels. The methodology is applied to a cross-sectional study of metabolic syndrome
where we investigate the covariate-speciﬁc performance of weight-to-height ratio as a non-
invasive diagnostic test. Software implementations for all the methods described in the
article are provided in the tram R package.

Keywords: transformation model, ROC curve, AUC, diagnostic test, distribution regression,
ordinal outcome, censoring, Youden Index, OVL, correlated biomarkers, limit of detection.

1. Introduction

Estimating receiver operating characteristic (ROC) curves for evaluating the performance of
medical diagnostic tests has been a main focus of statistical literature over the last decades
(Green and Swets 1966; Egan 1975; Pepe 2003; Zou et al. 2011; Inácio et al. 2021b). Diag-
nostic tests screen for the presence or absence of a disease. Characterizing their accuracy is
essential to ensure appropriate prevention, treatment and monitoring of diseases. ROC curves
are a valuable tool in determining the diagnostic potential of a test and continue to be ex-
tensively applied in biomedical studies as new tests or biomarkers are developed in radiology,
oncology, genetics, and other related ﬁelds. Increasingly more applications can be expected
due to advancements in technology and analyzing resulting data requires a computationally
straightforward approach to provide accurate and consistent statistical inference.

Previous research has focused on extending statistical methodology for ROC curve estimation
to address issues such as adjustment for covariates (Pepe 1997, 1998, 2000; Faraggi 2003),
incorporating censoring due to instrument detection limits (Perkins et al. 2007; Ruopp et al.
2008; Bantis et al. 2017), comparing correlated diagnostic tests (Hanley and McNeil 1983;
DeLong et al. 1988; Zou and Hall 2002; Molodianovitch et al. 2006; Bantis and Feng 2016) and

 
 
 
 
 
 
2

Transformation models for ROC analysis

robustness to model misspeciﬁcation (Bianco et al. 2020; Inácio et al. 2021a). In addition, a
wide variety of parametric and nonparametric methods have been proposed within frequentist
and Bayesian paradigms (Hsieh and Turnbull 1996; Alonzo and Pepe 2002; Erkanli et al. 2006;
Branscum et al. 2008; Yao et al. 2010; González-Manteiga et al. 2011; Rodríguez-Álvarez et al.
2011; Cai and Pepe 2002; Cai and Moskowitz 2004; Inácio et al. 2013; Ghosal et al. 2022).
However, there is no consensus on an analytic approach that can handle all these issues
simultaneously.

An attractive feature of the ROC curve, which has scantly been used for its estimation, is
that it remains invariant to monotonic transformations of the test results. Although trans-
formations have been used to bring continuous test results into a form that approximately
satisﬁes the assumptions of a suitable parametric model (Faraggi 2003; Schisterman et al.
2004), estimation of a transformation function has been limited to the Box-Cox power trans-
formation family (Box and Cox 1964; Zou et al. 1998; Zou and Hall 2000). For rank-based
methods, the transformation function can be left unspeciﬁed but in all cases a restriction to
normality has been previously imposed on the model for the ROC curve (Zou et al. 1997).
In this article we present a new unifying methodological framework for estimating ROC curves
and its associated summary indices by modeling the relationship between the transformed test
results and potential covariates. We employ transformation models to jointly estimate the
transformation function and regression parameters (Hothorn et al. 2014, 2018). This ap-
proach speciﬁes a parametric model for the ROC curve but remains distribution-free because
we do not impose any strong assumptions on the transformation function. Using the esti-
mated parameters, we show how to evaluate covariate eﬀects on discriminatory performance
of diagnostic tests. We focus on data obtained from case-control or cross-sectional studies
of subjects with continuous or ordinal test results. Unlike nonparametric methods which are
ﬂexible but diﬃcult to interpret and implement, transformation models excel on both fronts.
Their output can be easily interpreted by clinicians, which is of important consideration in
biomedical applications. R implementations of all methods discussed in this article are avail-
able, along with a set of supporting examples. The goals of this article are to introduce a
general methodology for performing ROC analysis which is model-based but distribution-free;
to apply maximum likelihood inference procedures to examine covariate eﬀects with poten-
tially censored observations; and to demonstrate methods for testing diﬀerences between
correlated ROC curves of several tests at speciﬁc covariate levels within the same conceptual
and computational framework.

1.1. Notation

Let the random variable Y denote the continuous result of a diagnostic test and let D denote
the disease status, with D = 1 if a subject is diseased and 0 if nondiseased. We denote
quantities conditional on the disease status using subscripts. For example, Y1 and Y0 are the
test results in the diseased and nondiseased populations with cumulative distribution functions
(CDF) given by F1 and F0 and densities f1 and f0, respectively. Suppose that the subject is
diagnosed as diseased when their test result exceeds a threshold value, c. By convention, we
assume that larger values of the test result are more indicative of the disease. The probability
of truly identifying a diseased and nondiseased subject are deﬁned as sensitivity, P(Y1 >
c) = 1 − F1(c), and speciﬁcity, P(Y0 ≤ c) = F0(c), respectively. The set of pairs (1 −
speciﬁcity, sensitivity) for all c ∈ R produce the ROC curve. By setting p = 1 − F0(c), an

Ainesh Sewak, Torsten Hothorn

3

equivalent representation of the ROC curve is

ROC(p) = 1 − F1

(cid:16)

F −1
0

(1 − p)(cid:17)

.

1.2. Summary indices

Summary indices of the ROC curve quantify the degree of separation between the distributions
Y1 and Y0. The most widely used index is the area under the ROC curve (AUC) deﬁned by

AUC = P(Y1 > Y0) =

Z 1

0

ROC(p)dp.

The AUC represents the probability that the test results of a randomly selected diseased
subject exceeds the one of a nondiseased subject and is directly related to the Mann-Whitney-
Wilcoxon U-statistic (MWW) (Bamber 1975; Hanley and McNeil 1982). Alternative indices
include the Youden index (Youden 1950), J, which combines sensitivity and speciﬁcity over
all possible thresholds to provide the maximum potential eﬀectiveness of a diagnostic test,
given by

J = max
c∈R

[F0(c) − F1(c)].

The Youden index is equivalent to the Smirnov (or the two-sample Kolmogorov-Smirnov) test
statistic (Gail and Green 1976; Komaba et al. 2022) and can be represented as half the L1
distance between two densities or as the complement of the overlapping coeﬃcient (OVL)
(Weitzman 1970; Feller 1991; Schmid and Schmidt 2006; Martínez-Camblor 2022):

J =

Z

1
2

|f0(y) − f1(y)|dy = 1 −

Z

min[f1(y), f0(y)]dy = 1 − OVL.

Additionally, the threshold corresponding to J, where sensitivity and speciﬁcity are maxi-
mized, denoted as c∗, is often used in clinical practice as the optimal classiﬁcation threshold
to screen subjects.

1.3. Covariates

The result of a diagnostic test can be aﬀected by both the disease status, as well as by
covariates associated with the subjects. Consequently, the test result distributions and their
separation may diﬀer by levels of the covariates. In order to appropriately understand the
accuracy of the test in subpopulations, we can use covariate-speciﬁc or conditional ROC curves
(Tosteson and Begg 1988; Pepe 1997). Throughout we use boldface letters to denote vectors
and lightface for scalars. Let X denote a vector of covariates that are hypothesized to have an
impact on the accuracy of the test. The conditional CDF in the diseased population is given
by F1(y | x) = P(Y1 ≤ y | X = x) and analogously given for the nondiseased population.
The covariate-speciﬁc ROC can be written as

ROC(p | x) = 1 − F1

(cid:16)

F −1
0

(cid:17)
(1 − p | x) | x

(1)

with its counterpart conditional summary indices, AUC(x) and J(x), deﬁned accordingly.

4

Transformation models for ROC analysis

The covariate-speciﬁc ROC curve can be generated by modeling the conditional distribution
of the test results. This is known as the induced or indirect methodology for modeling ROC
curves (Pepe 1997, 1998, 2003; Faraggi 2003; Rodríguez-Álvarez et al. 2011). Alternatively,
direct methodology is based on a regression model for the ROC curve itself (Pepe 2000; Alonzo
and Pepe 2002; Cai and Moskowitz 2004).

1.4. Overview

The article proceeds as follows. In Section 2, we propose a transformation modeling framework
for parameterizing ROC curves from which we derive closed-form expressions for associated
AUC and Youden summary indices. We then show how our approach addresses the main
components of ROC analysis: summarizing the discriminatory capabilities of a diagnostic
test for two-sample classiﬁcation, adjusting for covariates, and comparing the eﬃcacy of two
(or more) correlated diagnostic tests. We discuss maximum likelihood estimation procedures
for our model and corresponding inference. Speciﬁcally, we develop score conﬁdence bands
for the ROC curve and score conﬁdence intervals for its summary indices, which remain
invariant to reparametrizations and hence can be determined from the estimated parameters
of the transformation model. In Section 4 we apply our approach to a cross-sectional study
for detection of metabolic syndrome. Speciﬁcally, using the weight-to-height ratio as a non-
invasive diagnostic test for metabolic syndrome, we investigate the age and gender-speciﬁc
performance of the test. We conclude the article with a discussion.

2. Methods

2.1. Transformation model

The ROC curve is a composition of distribution functions and thus is invariant to strictly
monotonically increasing transformations of Y . We propose a model for the conditional dis-
tribution of the transformed test result given the disease status and covariates. This transfor-
mation is obtained from the data and leads to a distribution-free framework to parameterize
the covariate-speciﬁc ROC curve and its summary indices.
Suppose there exists a strictly monotonically increasing function h such that the relationship
between the transformed test result and the covariates follows a shift-scale model

h(Y ) = µd(x) + σd(x)Z,

where D = d speciﬁes the disease indicator (D = 0 for nondiseased and D = 1 for diseased),
X = x a ﬁxed set of covariates, µd(x) the shift term, σd(x) the scale term and Z ∈ R is a
latent random variable with an a priori known absolutely continuous log-concave CDF, FZ.
Given that D and X are ﬁxed, the conditional CDF for Y is

P(Y ≤ y | D = d, X = x) = Fd(y | x) = FZ

(cid:18) h(y) − µd(x)
σd(x)

(cid:19)

.

(2)

Equation 2 represents a general class of models called transformation models (Bickel and
Doksum 1981; Bickel 1986; Bickel et al. 1993; Hothorn et al. 2018). The transformation
function h uniquely characterizes the distribution of Y , similar to the density or distribution

Ainesh Sewak, Torsten Hothorn

5

function. Plugging in this conditional CDF of Y into Equation 1, h cancels out and the
covariate-speciﬁc ROC curve is given by

ROC(p | x) = 1 − FZ

(cid:16)

ζ(x)F −1

Z

(1 − p) − δ(x)(cid:17)

,

(3)

where

δ(x) = µ1(x) − µ0(x)
ζ(x) = σ0(x)
σ1(x) .

σ1(x)

,

Thus, the ROC curve is completely determined by the shift and scale terms of the model.

The binormal (Dorfman and Alf Jr 1969) and bilogistic (Ogilvie and Creelman 1968) ROC
curves can be obtained by setting FZ to the standard normal distribution function probit−1 =
Φ, or the standard logistic distribution function logit−1(x) = expit(x) = (1 + exp(−x))−1,
in Equation 3, respectively. Similarly, the proportional hazard (Gönen and Heller 2010) and
reverse proportional hazard alternatives (Khan 2022) for the ROC curve also fall within the
purview of our transformation model with FZ speciﬁed as cloglog−1(x) = 1 − exp(− exp(x))
(minimum extreme value distribution function) and loglog−1(x) = exp(− exp(−x)) (maxi-
mum extreme value distribution function), respectively.
However, to the best of our knowledge, the only literature where the transformation function h
is included in the model formulation of the ROC curve is Zou (1997), who jointly models the
shift term and the parameters of a Box-Cox power transformation function. A key point of
this paper is that we explicitly estimate h jointly with µ(x) from the observed data and are
not restricted to normality imposed by power transformation families. Thus, the methods
we propose allow for proper propagation of uncertainty from the estimated transformation
function ˆh into the estimates of the shift and scale terms of the model.
The ROC curve in Equation 3 follows a parametric model depending on FZ, but is distribution-
free as in Pepe (2000); Alonzo and Pepe (2002), because no assumptions are made about the
transformation h and consequently for the distribution of the test results. The approach
to model the test results as a function of the disease status and covariates was originally
proposed in the latent variable ordinal regression setting by Tosteson and Begg (1988) and
extended by Pepe (1997, 2000, 2003) to modeling covariate eﬀects directly on the ROC curve.

Tosteson and Begg (1988) pointed out that to ensure concavity of the induced ROC curve, the
scale term must be omitted, i.e., σd(x) = 1 for d = {0, 1}. The ROC curve is termed proper if
it is concave or, equivalently, if the derivative of the ROC curve is a monotonically decreasing
function (Egan 1975; Pan and Metz 1997; Dorfman et al. 1997). A concave ROC curve is
desirable as it yields the maximal sensitivity for a given value of speciﬁcity (McIntosh and
Pepe 2002). In this sense, as the decision criterion for classifying subjects is optimal when
the ROC curve is concave, we focus the remaining work on the model involving only the
shift term. Hence, the eﬀect of covariates on the ROC curve is contained in the diﬀerence
between the shift terms for diseased and nondiseased subjects, δ(x) = µ1(x) − µ0(x). For
a relaxation of this assumption, see Siegfried et al. (2022) who estimate the scale functions
through regression models.

Two-sample case

To ﬁx ideas, we ﬁrst consider the case of two samples without covariates. Let the shift term

6

Transformation models for ROC analysis

FZ

Index

AUC

J

c∗

Sens(c∗)

Spec(c∗)

probit−1

logit−1

cloglog−1

loglog−1

(cid:17)

Φ (cid:16) δ√
2

( exp(δ)(exp(δ)−1−δ)

(exp(δ)−1)2

1/2

δ 6= 0
δ = 0

expit(δ)

1 − 2Φ (cid:16) −|δ|

2

(cid:17)

1 − 2 expit (cid:16) −|δ|

2

(cid:17)

exp (cid:16) −|δ|
e|δ|−1

(cid:17)

− exp (cid:16) |δ|

(cid:17)

h−1 (cid:16) δ

2

(cid:17)

h−1 (cid:16)log (cid:16) δ

1−e−δ

(cid:17)(cid:17)

e−|δ|−1
h−1 (cid:16)log (cid:16) eδ−1

δ

(cid:17)(cid:17)

(cid:17)

Φ (cid:16) δ
2

expit (cid:16) δ
2

(cid:17)

exp (cid:16) −δ
eδ−1

(cid:17)

1 − exp (cid:16) δ

e−δ−1

(cid:17)

1 − exp (cid:16) δ

e−δ−1

(cid:17)

exp (cid:16) −δ
eδ−1

(cid:17)

Table 1: Closed-form expressions for the area under the receiver operating characteristic
curve (AUC), Youden Index (J), optimal classiﬁcation threshold (c∗), sensitivity (Sens) and
speciﬁcity (Spec) at c∗ in terms of the shift parameter δ in the linear transformation model
given by Fd(y) = FZ(h(y) − δd).

take the form µd(x) = δd. The CDF of the test results in the nondiseased population is
given by F0(y) = FZ(h(y)) and in the diseased population by F1(y) = FZ(h(y) − δ). Using
Equation 3, the induced ROC curve can be expressed as

ROC(p) = 1 − FZ

(cid:16)
F −1
Z

(1 − p) − δ

(cid:17)

.

(4)

The model assumption implies that a monotone function h exists to transform both Y1 and Y0
into the same distribution, Z ∼ FZ separated by a shift parameter, δ. The induced ROC
curve from this model doesn’t assume a particular distribution of the test result, rather, it
quantiﬁes the diﬀerence between the test result distributions on the scale of a user-deﬁned
FZ. In this sense, the diﬀerence between the test result distributions is described by δ. Each
choice of FZ leads to a diﬀerent interpretation of δ. For example, when FZ is selected to be
the standard normal distribution function, δ is the diﬀerence in means of the transformed
test results comparing the diseased and nondiseased groups, E[h(Y1) − h(Y0)]. Similarly,
when FZ is the standard logistic distribution function, exp(δ) is the ratio of odds of having a
positive test result comparing diseased and nondiseased groups. Closed-form expressions can
be derived for summary indices of the ROC curve by solving the appropriate integrals. The
expressions of AUC, J, the optimal threshold c∗, sensitivity and speciﬁcity at c∗ are given for
some well known choices of FZ in Table 1.

Conditional ROC curve

The accuracy of a diagnostic test may be inﬂuenced by a set of covariates X. To evaluate
this eﬀect on the ROC curve and its summary indices, we assume a linear transformation
model with a shift term that takes the form

µd(x) = δd + x>ξ + dx>γ,

(5)

Ainesh Sewak, Torsten Hothorn

7

where ξ, γ ∈ RP are the coeﬃcient vectors for the covariates and interaction term, respec-
tively. Under this model, the resulting covariate-speciﬁc ROC curve is

ROC(p | x) = 1 − FZ

(cid:16)

F −1
Z

(1 − p) − (δ + x>γ)(cid:17)

,

where the covariate eﬀect on the ROC curve is given by the diﬀerence in shift terms between
diseased and nondiseased subjects, δ(x) = δ + x>γ. Similarly, the covariate-speciﬁc AUC is
given by

AUC(x) = P(Y0 < Y1 | X = x) = a (δ(x)) = a

(cid:16)

δ + x>γ

(cid:17)

,

(6)

where a : R 7→ [0, 1] is the AUC function from the ﬁrst row of Table 1 for diﬀerent choices
of FZ. The expressions for J, c∗, sensitivity and speciﬁcity can analogously be adjusted
Interpretation of the
to account for covariates, with δ replaced by δ + x>γ in Table 1.
interaction coeﬃcient is similar to Pepe (1998). For example, in the case of a continuous
covariate X = x ∈ R, for each possible speciﬁcity value 1 − p ∈ (0, 1), a unit increase in x
results in a γ-unit increase in the ROC curve (or an increase in the sensitivity) on the scale
of FZ. If γ is positive, an increase in x corresponds to an increase in the ROC curve, indicating
that a test is better able to discriminate the two populations for larger values of x and, vice
versa. Note that the ROC curve varies with the covariate contingent upon the presence of an
interaction between d and x (Pepe 2003). For γ = 0, the covariate aﬀects the distribution of
the test results from the diseased and nondiseased population, but not the ROC curve. That
is, for all levels of x, the diﬀerence between the transformed distributions h(Y1) and h(Y0)
is given by δ, thus the ROC curve is unchanged. Analogous interpretations hold when we
are interested in modeling a set of covariates X, which could possibly include categorical
covariates.

Standard regression techniques have also been proposed as an alternative to assess the eﬀect
of covariates on summary indices rather than deriving the induced ROC curve. For exam-
ple, Dodd and Pepe (2003) model the partial AUC as a regression function of covariates. Our
model equivalently results in a regression model for the AUC when the shift term is given
from Equation 5 and a particularly chosen scale FZ. Speciﬁcally, note that Equation 6 is the
model proposed by Dodd and Pepe (2003), where δ + x>γ is in the form of a usual linear
predictor and a is a monotonically increasing inverse link function which deﬁnes the scale for
the regression coeﬃcients. This relationship provides another interpretation of the interaction
term. For example, when FZ = cloglog−1 or FZ = loglog−1, exp(γ) is a ratio of AUC odds
comparing a subject with covariate value x + 1 to x. The AUC odds conditional on x are
deﬁned as P(Y1 > Y0 | X = x)/P(Y1 ≤ Y0 | X = x). As will be shown in Section 2.2, an ad-
vantage of our approach is that we estimate the regression parameters of the transformation
model using maximum likelihood estimation and do not rely on less eﬃcient binary regression
techniques. Thus, we retain parameter interpretation while allowing for eﬃcient estimation
of a variety of covariate-speciﬁc summary indices of the ROC curve.

We show that our method is additionally related to the probabilistic index model (PIM) of
Thas et al. (2012); De Neve et al. (2019), who propose to model the AUC as a function
of X ∗ − X. Here, the superscript (*) indicates an alternate conﬁguration of the modeled
covariates. We discuss the PIM of the form

P(Y < Y ∗ | D, D∗, X, X ∗) = a

(cid:16)˜δ(D∗ − D) + (X ∗ − X)> ˜ξ + (D∗X ∗ − DX)>˜γ

(cid:17)

8

Transformation models for ROC analysis

where a is the function as deﬁned previously and the tilde (˜) is used to distinguish the
parameters of the PIM from those of the transformation model. Contrasting a diseased and
nondiseased subject with the same covariate value, we let D∗ = 1, D = 0, X ∗ = X and
a = logit−1, then the probabilistic index is given by expit(˜δ + X >˜γ). Thus, this is equivalent
to the AUC resulting from a linear transformation model with FZ = cloglog−1 and a shift term
as in Equation 5. Similarly, when FZ = probit−1, we have the following relationship between
the parameters of the linear transformation model and the PIM, ˜δ = δ/
2 .
As was the case for ROC curves modeled by transformation models, the interaction between
D and X allows the AUC to vary with covariates. The main eﬀect ˜ξ, however, does not eﬀect
the AUC for conﬁgurations where the interest is to compare the distributions of Y1 and Y0
among subjects with a speciﬁc value of covariates.

2 and ˜γ = γ/

√

√

We can also consider more general and potentially nonlinear formulations of the shift and scale
terms in our framework. For the special case of FZ = probit−1, the AUC from a shift-scale
transformation model (Siegfried et al. 2022) is given by




P(Y0 < Y1 | X 0 = x0, X 1 = x1) = Φ



µ1(x1) − µ0(x0)
σ0(x0)2 + σ1(x1)2

q



where X 0 and X 1 are the corresponding (potentially diﬀerent) sets of covariates in the
nondiseased and diseased populations, respectively. When the scale term depends only on
a single set of covariates, σ0(x0) = σ1(x1) = σ(x), despite varying sets of covariates in the
shift terms, all the expressions hold from Table 1 with δ replaced by µ1(x1)−µ0(x0)
. However,
such closed-form expressions cannot be derived for other choices of FZ when the scale term
depends on the disease indicator or on diﬀerent sets of covariates. In such cases, AUCs and
other summary indices can be derived using numeric techniques on the induced ROC curve.

σ(x)

Comparing correlated ROC curves

If two (or more) diagnostic tests are measured on the same set of subjects (paired design),
the test results are likely to be correlated leading to paired or correlated ROC curves (Swets
and Pickett 1982). To compare the accuracy of these tests, an approach that is frequently
used in practice is to consider a summary index of the ROC curve and evaluate a hypothesis
for the equivalence of the indices. For example, DeLong et al. (1988) developed an asymp-
totically normal nonparametric statistic to compare correlated AUCs based on the theory of
U-statistics; see also Hanley and McNeil (1983); Wieand et al. (1989); Thompson and Zucchini
(1989); McClish (1989); Jiang et al. (1996); Bandos et al. (2005, 2006) who provide similar
methods. The problem with using the AUC as a summary index is that diagnostic tests with
diﬀerent ROC curves could potentially have the same value for the AUC. To overcome this
limitation, we construct a distribution-free test for diﬀerences in the marginal ROC curve
parameters using multivariate transformation models that inherently account for the corre-
lations between outcomes in their dependency structure. The null hypothesis represents the
equality of entire ROC curves instead of comparing correlated summary indices. Additionally,
our test allows for covariate adjusted comparisons to be made.
Let the continuous random vector Y = (Y1, Y2, . . . , YJ ) denote the results of J diagnostic
tests, possibly dependent on a set of covariates X. This notation should not be confused
with subscripts denoting quantities conditional on D = 1. To account for the correlation
between the test results, we consider a multivariate transformation model with the strictly

Ainesh Sewak, Torsten Hothorn

9

monotonically increasing conditional transformation function g : RJ 7→ RJ . This function
maps the unknown conditional distribution of Y depending on the disease indicator and
covariates, to a random vector with a known distribution Z = g(Y | d, x). Speciﬁcally, the
vector Z = (Z1, . . . , ZJ ) follows a zero mean multivariate normal distribution Z ∼ NJ (0, Σ)
with covariance matrix Σ ∈ RJ×J . Consequently, the marginal distribution of a multivariate
normal vector is itself normally distributed with Zj ∼ N (0, ς 2
), where the diagonal elements
j
of Σ give the variances ς 2
for j = 1, . . . , J. Thus, the conditional joint CDF of Y is given by
j

P(Y ≤ y | D = d, X = x) = P(g(Y | d, x) ≤ g(y | d, x))

= P(Z ≤ g(y | d, x))
= Φ0,Σ (g1(y1 | d, x), . . . , gJ (yJ | d, x))

where Φ0,Σ is the joint CDF of a multivariate normal distribution with a zero mean vector
and covariance matrix Σ. Letting

gj(yj | d, x) = Φ−1
0,ς 2
j

(FZ(hj(yj) − µd(x)))

where Φ0,ς 2 is the CDF of a normal distribution with variance ς 2, the CDF of Y coincides to
the Gaussian copula and the marginal distribution of Yj is given by

P(Yj ≤ yj | D = d, X = x) = Φ0,Σ (∞, . . . , ∞, gj(yj | d, x), ∞, . . . , ∞)

= Φ

0,ς 2
j

(gj(yj | d, x))

= FZ (hj(yj) − µd,j(x)) .

By using the multivariate model speciﬁed we allow Y to have a nonlinear dependence structure
through the marginal transformation functions hj. Analogous to our univariate transforma-
tion model, this multivariate model implies that the jth marginal transformed test results
follow

hj(Yj) = µd,j(x) + Z

where the function µd,j is the shift term for the jth test result model and Z ∼ FZ, as described
previously. The marginal ROC curve is then given by

ROCj(p | x) = 1 − FZ

(cid:16)

F −1
Z

(1 − p) − δj(x)(cid:17)

where δj(x) = µ1,j(x) − µ0,j(x) and values of marginal summary indices can be computed
from the closed-form expressions given in Table 1 using the marginal ROC curve parameters.
Speciﬁcally, δ can be replaced by the covariate eﬀect on the summary indices given by δj(x).
From this result, we see that the null hypothesis of equal ROC curves at a given set of covariate
values x for the jth and kth test is equivalent to testing if δj(x) − δk(x) = 0. Moreover, this
hypothesis test is distribution-free as we make no assumptions about hj.
Klein et al. (2022) establish conditions which decompose general transformation functions
into the marginal ones described above. Speciﬁcally, the covariance matrix takes the form
Σ = Λ−1Λ−> where Λ is a lower triangular (J × J) matrix whose coeﬃcients characterize the
dependence structure given by the Gaussian copula. The matrix Λ could also vary between
diseased and nondiseased subjects and potentially depend on a set of covariates x. This

10

Transformation models for ROC analysis

allows the dependence structure of Y to change as a function of x. For the special case of two
diagnostic tests, the correlation between Y1 and Y2 for a given set of covariates x is given by
. For more details and examples of multivariate transformation models, see Klein
√

−λd(x)
λd(x)2+1

et al. (2022); Barbanti et al. (2022).

2.2. Univariate estimation

In this section we propose estimation methods for a transformation model with univariate
test results. We provide an explicit parameterization of the transformation function and the
shift term. We then maximize the likelihood contributions for a potentially exact continuous,
right-, left- or interval-censored datum to jointly estimate the model parameters. This enables
us to fully determine the ROC curve and its summary indices as well as handle test results
which are ordinal or impacted by instrument detection limits.

Parameterization

We parameterize the transformation function as

h(y | ϑ) = b(y)>ϑ =

M
X

m=0

ϑmbm(y)

for

y ∈ R,

(7)

where b(y) = (b0(y), . . . , bM (y))> is vector of M + 1 basis functions with coeﬃcients ϑ ∈
RM +1. Polynomials in Bernstein form oﬀer a choice of basis that provides a ﬂexible way of
estimating the underlying function. The Bernstein basis polynomial of order M is deﬁned on
the interval [l, u] as

bm(y) =

M
m

!

˜ym(1 − ˜y)M −m, m = 0, . . . , M,

(8)

where ˜y = y−l
u−y ∈ [0, 1]. The restriction ϑm ≤ ϑm+1 for m = 0, . . . , M − 1, guarantees the
monotonicity of h. Observe that the transformation function is linear in the parameters that
deﬁne it and, any nonlinearity of the test results is modeled by the basis functions. If the
order M is chosen to be suﬃciently large, Bernstein polynomials can uniformly approximate
any real-valued continuous function on an interval (Farouki 2012).

Likelihood

Denote the complete parameter vector as θ = (β>, ϑ>)>, where β = (δ, ξ>, γ>)> ∈ R2P +1
are the vector of regression coeﬃcients parameterizing the function µd from Section 2.1 and
ϑ ∈ RM +1 are the basis coeﬃcients. We follow the maximum likelihood approach proposed
by Hothorn et al. (2018) to jointly estimate β and ϑ. The advantages of embedding the
model in the likelihood framework are as follows. (i) All forms of random censoring (right,
left, interval) as well as truncation can directly be incorporated into likelihood contributions
deﬁned in terms of the distribution function (Lindsey et al. 1996). (ii) If the given model is
correctly speciﬁed, under regularity conditions, the maximum likelihood estimator (MLE) will
be asymptotically the most eﬃcient estimator (minimum variance and unbiased). (iii) The
MLE is asymptotically normally distributed and has a sample variance that can be computed
from the inverse of the Fisher information matrix. This can be used to generate conﬁdence

 
Ainesh Sewak, Torsten Hothorn

11

intervals for the estimated parameters. (iv) The MLE is equivariant which implies invariance
of the score test (or the Lagrange multiplier test) to reparameterizations (Rao 1948; Aitchison
and Silvey 1958; Silvey 1959; Dagenais and Dufour 1991). Speciﬁcally, as will be shown in
Section 2.4.1, by inverting the score test, our method produces conﬁdence bands for the ROC
curve and appropriate score intervals for its summary indices.
The likelihood contribution of a single observation O = (Y, D, X) where Y ∈ (y, y] = {y ∈
R : y < y ≤ y} is given by

L(θ | O) =






fZ(h(y | ϑ) − µd(x | β))h0(y | ϑ) y ∈ R
1 − FZ(h(y | ϑ) − µd(x | β))
FZ(h(y | ϑ) − µd(x | β))
FZ(h(y | ϑ) − µd(x | β))−
FZ(h(y | ϑ) − µd(x | β))

y ∈ (y, y]

y ∈ (y, ∞)
y ∈ (−∞, y)

‘exact continuous’

‘right censored’

‘left censored’

‘interval censored’,

where fZ is the density function of Z and h0(y | ϑ) is the ﬁrst derivative of the transformation
function with respect to y. Given a sample of N independent and identically distributed
observations Oi for i = 1, . . . , N , the log-likelihood is given by ‘(θ) = PN
log(Li(θ)), where
i=1
Li is the likelihood contribution of observation i. The (unconditional) maximum likelihood
estimate of θ is the solution to the optimization problem

ˆθ = ( ˆβ, ˆϑ) = arg max

‘(β, ϑ),

β,ϑ

subject to the monotonicity constraint ϑm ≤ ϑm+1 for m = 0, . . . , M − 1. The resulting
ROC curve only depends on β which is decoupled from the parameters needed to model
the transformation function ϑ. The score function is deﬁned as the ﬁrst derivative of the
log-likelihood function with respect to each of the parameters and is given by

S(θ) =

!

=

  ∂‘(θ)
∂β
∂‘(θ)
∂ϑ

!

.

Sβ(θ)
Sϑ(θ)

We perform constrained optimization using the likelihood and score contributions to deter-
mine the maximum likelihood estimates for β and ϑ. For computational details, see Hothorn
(2020). The asymptotic variance of the MLE can further be estimated by the expected Fisher
information matrix which is the variance-covariance matrix of the score function and is deﬁned
as

I(θ) = −E





∂2‘(θ)
∂β∂β>
∂2‘(θ)
∂ϑ∂β>


 =

∂2‘(θ)
∂β∂ϑ>
∂2‘(θ)
∂ϑ∂ϑ>

Iβ,β(θ)
Iβ,ϑ(θ)
Iβ,ϑ(θ)> Iϑ,ϑ(θ)

!

.

The matrix is partitioned such that the submatrix Iβ,β(θ) corresponds to the parameter
related to the disease indicator and covariates. The variation in ϑ and its relationship to β
is not of direct relevance here but is nonetheless estimated.

Limit of detection

Instrument precision can aﬀect the evaluation of diagnostic biomarkers. For example, when
biomarker levels are at or below the limit of detection (LOD) yLOD, the observed value lies in

 
 
12

Transformation models for ROC analysis

an interval (−∞, yLOD) and the resulting measurement is left censored. Often a replacement
value is substituted for such measurements. Alternatively, only biomarker values above the
LOD are used for the ROC analysis. It has been shown that these approaches lead to biased
estimation (Lynn 2001; Singh and Nocerino 2002). Various adjustments to ROC curves and
its summary indices have been proposed to handle such censored measurements (Mumford
et al. 2006; Perkins et al. 2007, 2009; Ruopp et al. 2008; Bantis et al. 2017; Xiong et al.
2022). However, these methods typically do not account for covariates. Our framework
naturally accounts for such observations in the likelihood function for left censored test results.
Similarly, the right censored likelihood accounts for measurements which are aﬀected by
an upper limit of detection. Thus, our method provides a smooth covariate-speciﬁc ROC
curve for all values of speciﬁcity with estimates and inference appropriately incorporating the
observed information.

Ordinal test results

Many diagnostic tests of interest to clinical researchers are measured on ordinal scales. These
are rank-ordered categorical variables for which quantitative diﬀerences between levels are
unknown. Examples include the Memory Impairment Screen (MIS) for the measurement
of cognition to distinguish Alzheimer’s disease and other dementias (Buschke et al. 1999)
or the risk assessment of disease from radiological images such as with the Breast Imaging
Reporting and Data System (BI-RADS) (American College of Radiology (ACR) 2013). A
simple reparameterization of the transformation function facilitates an extension of ROC
curves to such ordinal test results.
Let the random variable Y ∈ {y1, . . . , yK} denote the results of an ordered categorical diagnos-
tic test with K categories, where yk < yk+1 for k = 1, ..., K − 1 . Deﬁne the covariate-speciﬁc
ROC curve as a discrete function of the subject categories

{(1 − F0(y | x), 1 − F1(y | x)) , y ∈ {y1, . . . , yK}} .
This set of points plots the covariate-speciﬁc 1−speciﬁcity and sensitivity coordinates for each
of the K categories. Suppose that the following transformation model deﬁnes the distribution
of the ordinal test results in the diseased and nondiseased populations

Fd(yk | x) = FZ (h(yk) − µd(x)) ,
where the transformation function assigns one parameter to each of the categories of the
test result except the last one, h(yk) = ϑk ∈ R for k = 1, . . . , K − 1. Note that since
P(Y ≤ yK | X = x) = 1, only K − 1 parameters need to be speciﬁed. The monotonicity
constraint ϑk < ϑk+1 is also necessary so that Fd(yk | x) < Fd(yk+1 | x) for k = 1, . . . , K − 1.
Observe that this is a special case of the general shift-scale model in Equation 2. Under
a linear shift term as given in Equation 5 and FZ = logit−1, this model is known as the
proportional odds logistic regression (POLR).
Setting pk = 1 − F0(yk | x), the ROC curve under the ordinal transformation model is given
by

ROC(pk) = 1 − FZ

(cid:16)

F −1
Z

(1 − pk) − δ(x)(cid:17)

,

k = 1, . . . , K.

The parameters of the model can be estimated by using the maximum likelihood scheme
described previously with the interval censored likelihood contribution

FZ(ϑk − µd(x | β)) − FZ(ϑk−1 − µd(x | β)),

Ainesh Sewak, Torsten Hothorn

13

where the observed subject has a test result of yk and covariate value x. After estimating the
parameters, it is possible to plot a continuous ROC curve as a function of all p ∈ [0, 1]. This
curve’s shape depends on the choice of FZ and represents the underlying parametric form of
the model. However, it does not represent the ROC curve for a continuous test. Speciﬁcally,
the function is only deﬁned at the K discrete speciﬁcity values. Summary measures can be
calculated using the expressions detailed in Table 1. Note that these would be based on a
smooth interpolation given by the model rather a discrete one and lead to the interpretation
of an ordinal test with a latent continuous scale.

2.3. Multivariate estimation

(yj | ϑj) = b0
j

The estimation of a multivariate test result follows a similar approach to the univariate case.
The marginal transformation functions are parameterized in terms of monotonically increasing
basis polynomials of Bernstein form hj(yj | ϑj) = bj(yj)>ϑj, where bj : R 7→ RM +1 is a
vector of M + 1 basis functions with individual components bj,m deﬁned as in Equation 8
for j = 1, . . . , J and m = 0, . . . , M . The constraint ϑj,m ≤ ϑj,m+1 for m = 0, . . . , M − 1,
guarantees the monotonicity of hj and the smooth parameterization the existence of the
derivative h0
j
With a slight abuse of notation compared to the univariate case, we also denote the vector of
)> ∈ RJ(2P +1) and the vector of basis coeﬃcients
regression coeﬃcients as β = (β>
as ϑ = (ϑ>
)> ∈ RJ(M +1), with each component parameterizing a separate marginal
conditional distribution function. The covariance matrix Σ captures the correlation structure
between the transformed diagnostic tests and the vector ς ∈ RJ(J+1)/2 contains all the ele-
ments of Σ. We denote the complete set of unknown model parameters for a transformation
model with a multivariate test result as θ = (β>, ϑ>, ς >)>. The likelihood contribution of
a single observation O = (Y , D, X), with Y = y = (y1, . . . , yJ )> being an exact continuous
vector of test results, is given by

1 , . . . , β>
J

1 , . . . , ϑ>
J

(yj)>ϑj.

L(θ | O) = φ0,Σ (g(y | d, x, β, ϑ))

J
Y

j=1

g0
j

(yj | d, x, β, ϑ) ,

where φ0,Σ is the joint density function of a multivariate normal distribution with a zero
mean vector and covariance matrix Σ. With a choice of each component gj from Equation 7,
its derivative is given by

g0
j

(yj | d, x, β, ϑ) =

(cid:18)

fZ (hj(yj | ϑ) − µd(x | β)) h0
j

(yj | β)

φ0,ς 2

j

Φ−1
0,ς 2
j

{FZ (hj(yj | ϑ) − µd(x | β))}

(cid:19) .

In the special case where FZ = probit−1, this derivative simpliﬁes to ςjh0
j
We derive the maximum likelihood estimate of θ from a sample of N independent and identi-
cally distributed observations using constrained maximization algorithms following the strat-
egy detailed in Section 2.2.2. For more details see Klein et al. (2022).

(yj).

2.4. Conﬁdence intervals

In the following section, we present three methods to calculate conﬁdence bands for the ROC
curve and conﬁdence intervals for its summary indices. These quantities are functions of the

14

Transformation models for ROC analysis

parameters in the model G(β) : R2P +1 → R and to maintain nominal coverage for a con-
ﬁdence interval for G(β), appropriate methods are needed. The methods discussed include
inversion of the score test, delta method and simulation from the asymptotic distribution of
the estimate. The methods are ordered by their degree of theoretical justiﬁcation. We start
with score intervals which are invariant to parameter transformations but become computa-
tionally expensive when dealing with a large set of parameters. We then discuss estimating the
variance using the multivariate delta method and conclude with a simple simulation method
which is versatile without being computationally demanding.

Score intervals

In the two-sample univariate case where δ deﬁnes the ROC curve, as in Equation 4, we can
construct score intervals for δ. Unlike the Wald and other commonly used intervals, score
intervals are especially desirable as they are invariant to transformations of the parameters.
That is, a score CI for G(δ) (e.g., the AUC a(δ)), provides the same level of coverage as
would a score CI for δ. In turn, under a correctly speciﬁed model, a score CI for δ allows
the construction of accurately covered uniform conﬁdence bands for the ROC curve as well
as intervals for its summary indices such as the AUC and the Youden index.
We ﬁrst generate score conﬁdence intervals for δ by inverting the score test. In this case, the
null hypothesis is given by H0 : δ = δ0 where δ0 is a speciﬁc value of the parameter of interest.
Under H0, the restricted (conditional) maximum likelihood estimator for ϑ can be obtained
by

ˆϑ(δ0) = arg max

ϑ

‘(δ0, ϑ),

or as a solution of the M + 1 score equations Sϑ(δ0, ϑ) = 0. Note that this estimate is a
function of δ0. Letting ˜θ = (δ0, ˆϑ(δ0)), the quadratic (Rao) score statistic simpliﬁes to

R(δ0) = S( ˜θ)>I −1( ˜θ)S( ˜θ)

= (Sδ( ˜θ)>, 0>)I −1( ˜θ)(Sδ( ˜θ)>, 0>)>
= Sδ( ˜θ)>Aδ,δ( ˜θ)Sδ( ˜θ),

where Aδ,δ( ˜θ) denotes the submatrix corresponding to δ of the inverse Fisher information
matrix and is given by the Schur complement Iδ,δ(θ)−Iδ,ϑ(θ)I −1
(θ)Iδ,ϑ(θ)>. Under H0, R(δ0)
ϑ,ϑ
converges asymptotically to a chi-square distribution with 1 degree of freedom, R(δ0) D−→ χ2
.
1
This result is explained by Rao (2005). Thus, inverting the score statistic by enumerating
values of δ0 allows for the construction of (1 − α) score conﬁdence intervals for δ deﬁned as

{δ0 ∈ R | R(δ0) < χ2
1

(1 − α)},

(1 − α) is the (1 − α) quantile value of the χ2
1

where χ2
distribution. Equivalently, we can use
P
the square root of the score statistic to construct a (1 − α) score interval using quantiles of
the standard normal distribution, {δ0 ∈ R | Φ−1(α/2) < pR(δ0) ≤ Φ−1(1 − α/2)}. Finally,
we apply the function G to both the lower and upper limits of the interval to construct score
conﬁdence bands for the ROC curve or score conﬁdence intervals for its summary indices
The score statistic is given by R(δ0) = Sδ( ˜θ)2Aδ,δ( ˜θ). Testing if there is a signiﬁcant diﬀerence
between the nondiseased and diseased populations coincides to the hypothesis test, H0 :

Ainesh Sewak, Torsten Hothorn

15

δ = 0. This is computationally eﬃcient because only the distribution of R(0) needs to be
computed. However, computing score CIs requires updating the restricted MLEs ˆϑ(δ0) for
an enumeration of δ0 values. This becomes computationally intractable when enumerating a
higher dimensional grid of parameters.

Delta method

Since the MLE satisﬁes

√

n( ˆβ − β) D−→ NP +1 (0, Aβ,β(θ)) ,

then by the multivariate delta method, G( ˆβ) also follows a normal distribution with

V(G( ˆβ)) =

1

n

∇G(β)>Aβ,β(θ)∇G(β),

where ∇G(β) is the gradient of G evaluated at β and the inverse Fisher information matrix
Aβ,β(θ) is given by the Schur complement Iβ,β(θ) − Iβ,ϑ(θ)I −1
(θ)Iβ,ϑ(θ)>. For example,
ϑ,ϑ
when the shift term takes the linear form as in Equation 5 and G deﬁnes the AUC function
for FZ = probit−1, the entries of ∇G(β) are given by

=

C,

1
√
2

∂G(β)
∂ξi

= 0 and ∂G(β)
∂γi

∂G(β)
∂δ
(cid:17), φ is the density of the standard normal distribution and i indexes
where C = φ
the P covariates. In general, the gradient can be estimated by calculating such derivatives
and evaluating the resulting function at the MLE. Similarly, the variance-covariance matrix
of the estimated parameters Aβ,β(θ) can be computed by inverting the numerically evaluated
Hessian matrix. Thus, a (1 − α) level conﬁdence interval for G(β) is given by

(cid:16) δ+x>γ√
2

= xi√
2

C,

G(β) ± Φ−1(α/2)

q ˆV(G( ˆβ)).

Simulated intervals

When the function G has complex derivatives, as would be the case for nonlinear shift
terms µd(x) or when calculating optimal thresholds c∗ where G includes the inverse of the
transformation function, constructing conﬁdence intervals using the delta method becomes
infeasible. For these cases, we apply a simple simulation-based algorithm which utilizes the
asymptotic normality of the MLE to calculate conﬁdence intervals for the ROC curve and its
summary indices, which are functions of the parameters of interest. The steps of the algorithm
to construct (1 − α) level conﬁdence intervals for G( ˆβ) can be summarized as follows:

1. Generate B independent samples from the asymptotic multivariate normal distribution

of the parameter estimates NP +1

(cid:16) ˆβ, 1

n

ˆAβ,β( ˆΘ)(cid:17) and denote as ˆβ

∗
∗
1, . . . , ˆβ
B

.

∗
2. For each sample b = 1, . . . , B, calculate the function of interest G( ˆβ
b
3. Construct the conﬁdence interval (cid:16)

).

QG( ˆβ

∗

)

(α/2), QG( ˆβ

∗

)

(1 − α/2)(cid:17), where QG( ˆβ

∗

is the

)

∗
empirical quantile function of the sample G( ˆβ
1

∗
), . . . , G( ˆβ
B

).

16

Transformation models for ROC analysis

A similar algorithm is presented in Mandel (2013), who discuss its asymptotic validity and
present several examples that show its empirical coverage adheres to nominal levels with
results similar to the delta method.

3. Empirical evaluation

We conducted a simulation study to evaluate the performance of our estimators in the two-
sample setting. We considered a data generating process such that nondiseased test results
followed a standard normal distribution F0(y) = Φ(y) and the diseased results a distribu-
tion with the CDF F1(y) = FZ(F −1
(Φ(y)) − δ). To obtain diﬀerent shapes of the ROC
Z
curve, we chose three choices of FZ ∈ {probit−1, logit−1, cloglog−1} and varied δ such that
the AUC ∈ {0.5, 0.65, 0.8, 0.95} or that J ∈ {0, 0.25, 0.5, 0.8}, leading to a variety of con-
ﬁgurations. Under this simulation paramaterization, the ROC curves followed the form of
Equation 4 and summary indices could be calculated as a function of the estimated δ from
Table 1. The conventional binormal model corresponded to FZ = probit−1 = Φ, which in-
duced proper binormal ROC curves. This was the only conﬁguration where the test results
for both groups were normally distributed. We included this conﬁguration to ascertain the
loss of power associated with our estimators when the standard binormal assumption held.
For other choices of FZ with AUC > 0.5, the resulting distributions of the diseased test re-
sults were non-normal, with variances and higher moments diﬀering between the two groups.
Speciﬁcally, the conﬁguration of FZ = logit−1 led to light tailed distributions for the diseased
test results, whilst FZ = cloglog−1 led to skewed, heavy-tailed distributions. The correspond-
ing density functions for the data generating model with selected AUC values are given in
Figure 1.

For 10 000 replications of each conﬁguration, we generated balanced data sets with sample
sizes N0 = N1 ∈ {25, 50, 100}. The transformation models discussed in Section 2 were ﬁtted
to the simulated data sets assuming a parameterization of the transformation function given
by a Bernstein basis polynomial of order M = 6. The true data-generating model had a
nonlinear transformation function h = F −1
Z ◦ Φ. Our model estimation procedure aimed to
approximate this function alongside the shift parameter δ. The functions implementing these
models are available from the tram package (Hothorn 2020), and included BoxCox, Colr
and Coxph models which corresponded to FZ selected as probit−1, logit−1 and cloglog−1,
respectively.

Table 2 displays the bias and root-mean-square error (RMSE) for the AUC estimates using
diﬀerent methods under the various conﬁgurations. We found that all three methods had
minimal bias and equivalent RMSEs for an AUC = 0.5, where the test results were unable
to distinguish between the two groups. The BoxCox and Colr models yielded approximately
unbiased AUC estimates in all cases, even when they were misspeciﬁed for the true data
generating process. However, estimates based on the proportional hazards model, Coxph, were
biased for data generating processes other than FZ = cloglog−1. We also computed nominal
90% score conﬁdence intervals for the AUC using the approach described in Section 2.4.1.
The observed coverage probabilities are summarized in Table 3. When FZ was correctly
speciﬁed, all methods had close to nominal coverage under all sample size conﬁgurations. In
addition, the score conﬁdence intervals from the Colr model were accurate even when it was
misspeciﬁed for the true data generating process. This was unlike the BoxCox and Coxph
models, whose coverage deteriorated for higher AUC values when they were misspeciﬁed.

Ainesh Sewak, Torsten Hothorn

17

Figure 1: Density functions for the model used to generate the data for the simulations.
The nondiseased test results followed a standard normal distribution corresponding to an
AUC = 0.5. The diseased test results varied with three choices of FZ: probit−1, logit−1 and
cloglog−1 each of which had an AUC of 0.5, 0.65, 0.8 and 0.95.

We compared our approaches to a set of alternative methods for computing conﬁdence inter-
vals for the AUC and Youden index. The software details of all the methods used alongside
their respective features and references are summarized in Supplementary Material Table S1.
We detail the empirical coverage and average width of the conﬁdence intervals for the AUC
in Figures S1 and S2, respectively. Estimates based on transformation models (R packages
tram, orm, pim) yielded coverage close to the nominal level and signiﬁcantly outperformed
the other methods when the model was correctly speciﬁed for the true data generating pro-
cess. All other methods generally performed close to nominal levels for low to medium AUC
values (0.5-0.8), but broke down for higher AUC values. Methods which used FZ = cloglog−1
gave conﬁdence intervals which were shorter in length (overconﬁdent) and otherwise there
were no notable diﬀerences between the methods.

Analogously, Figures S3 and S4 detail the coverage and length of the conﬁdence intervals
for the Youden index. The methods which were based on the overlap coeﬃcient failed to
cover the conﬁguration where J = 0 because their lower limits were never below 0. Our
methods estimated conﬁdence intervals for δ ∈ R which naturally accounted for this scenario.
Speciﬁcally, the lower limit of the CI for J is given by G(max{0, δl}) and the upper limit by
G(max{|δl|, |δu|}), where G is the Youden index function deﬁned in Table 1 and (δl, δu) is the
conﬁdence interval for δ. Remarkably, the transformation model with FZ = logit−1 provided
coverage at nominal levels for all simulation conﬁgurations with a relatively small conﬁdence
interval width. The approach of Franco-Pereira et al. (2021) (FP) was also accurate under
model misspeciﬁcation but was more involved. Namely, it consisted of estimating Box Cox
transformation parameters under a binormal framework with bootstrap variance, all carried

yDensity0.00.20.40.6−50510FZ=probit-10.00.20.40.6−50510FZ=logit-10.00.20.40.6−5051015FZ=cloglog-1AUC=0.5AUC=0.65AUC=0.8AUC=0.9518

Transformation models for ROC analysis

out on the logit scale and then back-transformed. In a setting with covariates, censoring or
with J = 0 this methodology would be limited.
Figures S5 and S6 show the coverage and area of the conﬁdence bands for the ROC curve. All
the approaches based on transformation models covered the conﬁguration with AUC = 0.5
accurately. However, the other approaches did not yield coverage close to nominal levels
in this conﬁguration with the exception of Martínez-Camblor et al. (2018), whose conﬁdence
bands had a signiﬁcantly larger area. For all other conﬁgurations, only transformation models
which were correctly speciﬁed for the true data-generating model provided accurate results.

4. Application

The prevalence of obesity has increased consistently for most countries in the recent decade
and this trend is a serious global health concern (Abarca-Gómez et al. 2017). Obesity con-
tributes directly to increased risk of cardiovascular disease (CVD) and its risk factors, in-
cluding type 2 diabetes, hypertension and dyslipidemia (Zalesin et al. 2008; Grundy 2004).
Metabolic syndrome (MetS) refers to the joint presence of several cardiovascular risk factors
and is characterized by insulin resistance (Eckel et al. 2010). The National Cholesterol Edu-
cation Program Adult Treatment Panel III (NCEP-ATP III) criteria is the most widely used
deﬁnition for MetS, but it requires laboratory analysis of a blood sample. This has led to the
search for non-invasive techniques which allow reliable and early detection of MetS.

Waist-to-height ratio (WHtR) is a well-known anthropometric index used to predict visceral
obesity. Visceral obesity is an independent risk factor for development of MetS by means of
the increased production of free fatty acids whose presence obstructs insulin activity (Bosello
and Zamboni 2000). This suggests that higher values of WHtR, reﬂecting obesity and CVD
risk factors, are more indicative of incident MetS. Several studies have found that WHtR is
highly predictive of MetS (Shao et al. 2010; Romero-Saldaña et al. 2016; Suliga et al. 2019).
However, as waist circumference changes with age and gender (Stevens et al. 2010), it is also
important to study whether or not the performance of WHtR at diagnosing MetS is impacted
by these variables. Evaluation of WHtR as a predictor of MetS after adjusting for covariates
is necessary so that more tailored interventions can be initiated to improve outcomes.

We illustrate the use of our methods to data from a cross sectional study designed to validate
the use of WHtR and systolic blood pressure (SBP) as markers for early detection of MetS
in a working population from the Balearic Islands (Spain). Detailed descriptions of the study
methodology and population characteristics are reported in Romero-Saldaña et al. (2018).
Brieﬂy, data on 60 799 workers were collected during their work health periodic assessments
between 2012 and 2016. Presence of MetS was determined by the NCEP-ATP III criteria and
the sample consisted of 5 487 workers with MetS.

4.1. Two-sample analysis

We ﬁrst examined the unconditional performance of WHtR as a marker to diagnose MetS,
denoted Y and D, respectively. We ﬁt a linear transformation model which leads to the
ROC curve of the form in Equation 4, where δ is the shift parameter, for various choices of
the inverse link function FZ. Associated inference of the AUC and J are calculated using
the closed-form expressions from Table 1. The resulting estimates are presented in Table 4.
The AUCs are consistently bounded away from 0.5 indicating a good capacity of WHtR

Ainesh Sewak, Torsten Hothorn

19

FZ

probit−1

logit−1

cloglog−1

Bias RMSE

Bias RMSE

Bias RMSE

0.001
0.000
0.000
0.001
0.000
0.000
0.001
0.000
0.000
0.003
0.001
0.000
0.001
0.000
0.000
-0.021
-0.025
-0.027
0.004
0.002
0.001
0.000
-0.002
-0.002
-0.038
-0.043
-0.047
0.001
0.001
0.001
-0.006
-0.007
-0.007
-0.038
-0.041
-0.044

0.083
0.057
0.041
0.084
0.058
0.041
0.077
0.052
0.036
0.078
0.055
0.038
0.078
0.055
0.038
0.077
0.057
0.044
0.061
0.043
0.030
0.061
0.043
0.030
0.075
0.063
0.057
0.027
0.019
0.014
0.028
0.021
0.015
0.054
0.050
0.049

0.000
0.000
0.000
0.000
-0.001
0.000
0.000
0.000
0.000
-0.002
-0.004
-0.006
0.002
0.001
0.000
-0.028
-0.032
-0.034
-0.002
-0.004
-0.006
0.002
0.001
0.000
-0.049
-0.056
-0.060
0.003
0.002
0.002
0.000
0.000
0.000
-0.042
-0.049
-0.054

0.082
0.057
0.040
0.083
0.058
0.041
0.076
0.052
0.036
0.078
0.055
0.040
0.078
0.055
0.039
0.080
0.061
0.050
0.066
0.046
0.033
0.063
0.044
0.031
0.086
0.075
0.070
0.030
0.022
0.016
0.028
0.020
0.014
0.065
0.062
0.061

0.000
0.001
0.000
0.001
0.001
0.000
0.000
0.001
0.000
0.004
0.002
0.002
0.002
0.000
0.001
0.006
0.003
0.002
0.003
0.001
0.000
0.002
0.000
0.000
0.007
0.003
0.001
0.003
0.003
0.003
0.001
0.001
0.001
0.003
0.002
0.002

0.082
0.057
0.040
0.083
0.058
0.041
0.077
0.052
0.036
0.078
0.054
0.038
0.079
0.055
0.038
0.071
0.049
0.034
0.063
0.044
0.031
0.062
0.044
0.031
0.054
0.038
0.027
0.031
0.022
0.016
0.028
0.019
0.014
0.023
0.016
0.011

AUC Method N0 = N1
0.5

BoxCox

Colr

Coxph

0.65

BoxCox

Colr

Coxph

0.8

BoxCox

Colr

Coxph

0.95

BoxCox

Colr

Coxph

25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100

Table 2: Bias and RMSE simulation results for estimation of the AUC. Data were generated
using F0(y) = Φ(y) for nondiseased results and F1(y) = FZ(F −1
(Φ(y)) − δ) for the diseased
Z
results. We varied FZ ∈ {probit−1, logit−1 and cloglog−1}, AUC and sample size. The
proposed linear transformation models BoxCox, Colr and Coxph were used from the tram
package to estimate δ and the transformation function h = F −1

Z ◦ Φ.

20

Transformation models for ROC analysis

AUC Method N0 = N1
0.5

BoxCox

Colr

Coxph

0.65

BoxCox

Colr

Coxph

0.8

BoxCox

Colr

Coxph

0.95

BoxCox

Colr

Coxph

25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100
25
50
100

probit−1

FZ
logit−1

cloglog−1

0.888
0.895
0.896
0.890
0.898
0.895
0.874
0.887
0.895
0.883
0.891
0.899
0.887
0.894
0.903
0.851
0.825
0.774
0.892
0.893
0.898
0.902
0.905
0.908
0.762
0.650
0.462
0.885
0.895
0.894
0.907
0.901
0.877
0.557
0.355
0.119

0.890
0.894
0.900
0.890
0.894
0.901
0.875
0.887
0.897
0.882
0.891
0.888
0.891
0.897
0.895
0.831
0.794
0.713
0.868
0.876
0.874
0.893
0.898
0.899
0.685
0.538
0.304
0.831
0.840
0.839
0.888
0.897
0.896
0.532
0.312
0.100

0.890
0.894
0.894
0.893
0.895
0.896
0.873
0.886
0.886
0.890
0.891
0.897
0.894
0.892
0.895
0.878
0.890
0.897
0.883
0.885
0.893
0.895
0.898
0.906
0.892
0.892
0.896
0.810
0.832
0.830
0.867
0.887
0.889
0.855
0.878
0.871

Table 3: Observed coverage probabilities of nominal 90% score conﬁdence intervals for the
AUC. Score intervals were calculated for δ from the proposed linear transformation models
BoxCox, Colr and Coxph. The score intervals for the AUC were then calculated by transform-
ing the intervals for δ using the closed-form expressions given in Table 1.

Ainesh Sewak, Torsten Hothorn

21

FZ
Φ
expit
cloglog−1
loglog−1

δ

AUC

J

1.492 (1.462, 1.521)
2.785 (2.730, 2.841)
1.186 (1.157, 1.215)
1.425 (1.397, 1.453)

0.854 (0.849, 0.859)
0.871 (0.866, 0.875)
0.766 (0.761, 0.771)
0.806 (0.802, 0.810)

0.544 (0.535, 0.553)
0.602 (0.593, 0.611)
0.412 (0.403, 0.421)
0.484 (0.475, 0.492)

Table 4: Estimates and 95% score conﬁdence intervals of the shift paramater, AUC and J in
the two-sample linear transformation model for WHtR as a marker of MetS.

Figure 2: Estimates from the linear transformation model with a single shift parameter,
h(Y ) = δd + Z where Z is chosen to be a standard logistic distribution. (A) Density functions
of WHtR for the workers who were diagnosed with MetS (dotted line) and those who were
not (solid line). (B) ROC curve for WHtR as a marker of MetS with 95% uniform score
conﬁdence bands are represented by gray shaded areas.

to discriminate between workers with and without MetS. This can also be seen from the
estimated ROC curve plotted in Figure 2 which lies well above the diagonal line as well as the
modeled densities which have a small degree of overlap. The conﬁdence intervals and uniform
conﬁdence bands are quite small due to the large sample size.

4.2. Conditional ROC analysis

Next, we investigated if the discriminatory ability of WHtR in separating workers with and
without MetS varies with covariates. We considered a transformation model that included
the main eﬀects of covariates plus interaction terms with the disease indicator, which leads

0.30.50.70.90246810Waist−to−height ratio (WHtR) cm/cmDensityNo MetSMetS(A)0.00.20.40.60.81.00.00.20.40.60.81.01 − SpecificitySensitivity(B)22

Transformation models for ROC analysis

Figure 3: Estimated covariate-speciﬁc ROC curves for WHtR as a marker of MetS for female
(solid line) and male workers (dashed line). Vertical panels represent a speciﬁc age (30, 40,
50) and horizontal panels smoking status.

to the ROC curve given by

ROC(p | x) = 1 − FZ(F −1
Z

(1 − p) − (δ + γ>x))

where the covariates x included age, gender and tobacco consumption and the inverse link
function FZ = logit−1. Figure 3 displays the covariate-speciﬁc ROC curves ﬁtted to these
data. The performance of WHtR appeared to be better for females compared to males and
decreased with age. The eﬀect of smoking, although signiﬁcant in the model, does not seem
to substantially alter the ROC curves given the other covariates are kept ﬁxed. To inspect
the covariate eﬀect further, we calculated the age- and gender-speciﬁc AUCs and Youden
indices from the model. Figure 4 clearly shows that the discriminatory capabilities of WHtR
in distinguishing workers with MetS is consistently better for females and decreases with age.

4.3. Comparing correlated biomarkers

Finally, we compare the performance of WHtR to SBP, explicitly accounting for the within-
patient clustered nature of these measurements. That is, both markers are measured on the
same subject and hence their measurements are correlated. We consider a transformation

1 − SpecificitySensitivity0.00.20.40.60.81.00.00.20.40.60.81.0Smoker0.00.20.40.60.81.0Age : 30Non−smoker0.00.20.40.60.81.0Age : 400.00.20.40.60.81.0Age : 50FemaleMaleAinesh Sewak, Torsten Hothorn

23

Figure 4: Age-based AUC and Youden indices where WHtR is used as a marker to detect
MetS for non-smoking female (solid line) and male (dashed line) workers. 95% Wald pointwise
conﬁdence bands are represented by gray shaded areas.

model for the joint distribution of Y = (WHtR, SBP) that induces a marginal ROC curve for
the jth marker, given by

ROCj(p | x) = 1 − FZ(F −1
Z

(1 − p) − (δj + γ>

j x))

for j ∈ {WHtR, SBP},

where δj is the marginal shift parameter, γj are the marginal interaction coeﬃcients and
FZ = probit−1. Figure 5 shows the corresponding estimated marginal ROC curves for the
two markers for a 40-year old non-smoking female worker. The uniform conﬁdence band
is generated by the simulation procedure detailed in Section 2.4.3. Whilst both markers
perform well at predicting MetS, WHtR seems to be favorable with a ROC curve uniformly
above SBP. We tested the hypothesis for equality of ROC curves H0 : ROC1(p) = ROC2(p)
for all p ∈ [0, 1], using the marginal coeﬃcients from the joint model. This hypothesis test
is equivalent to testing if the diﬀerence in the AUCs or Youden indices of the two markers is
equal to 0. The estimates, diﬀerences and corresponding conﬁdence intervals are detailed in
Table 5. The diﬀerence of 0.103 between AUCs is signiﬁcant (p value < 0.001) and indicates
that the WHtR is better at discriminating incident MetS compared to SBP.

5. Discussion

This article presents a new modeling framework for ROC analysis that can be used to charac-
terize the accuracy of medical diagnostic tests. Our model is based on estimating an unknown
transformation function for the test results and yields a distribution-free yet model-based es-

2030405060700.00.20.40.60.81.0AgeAUC(A)FemaleMale2030405060700.00.20.40.60.81.0AgeYouden index, J(B)24

Transformation models for ROC analysis

Type

WHtR

SBP

Diﬀerence

δj

1.874 (1.811, 1.945)
AUC 0.907 (0.900, 0.915)
0.651 (0.635, 0.669)

J

1.214 (1.151, 1.273)
0.805 (0.792, 0.816)
0.456 (0.435, 0.476)

0.660 (0.578, 0.750)
0.103 (0.090, 0.117)
0.195 (0.171, 0.222)

Table 5: Marginal estimates and 95% Wald conﬁdence intervals of the shift paramater, AUC
and Youden index from the two-sample bivariate normal transformation model for WHtR and
SBP as markers of MetS for a 40-year non-smoking female worker. Wald conﬁdence intervals
are calculated by simulating from the asymptotic distribution of the MLE.

Figure 5: Estimated marginal ROC curves for WHtR (solid line) and SBP (dot dashed line)
as markers of MetS for a 40-year old non-smoking female worker. 95% uniform conﬁdence
bands are represented by gray shaded areas.

timator for the ROC curve. Covariates that inﬂuence the diagnostic accuracy of tests can
naturally be accommodated as regression parameters into the model and covariate-speciﬁc
summary indices such as the AUC and Youden index are easily computed using closed-form
expressions. We extend the same conceptual transformation framework to a multivariate
setting for comparing correlated diagnostic tests after appropriately accounting for their de-
pendency structure.

Our proposed approach has several features which distinguish it from contemporary methods
of ROC analysis. Firstly, we employ maximum likelihood to jointly estimate all parameters
deﬁning the transformation function and regression coeﬃcients. This implies the variation

0.00.20.40.60.81.00.00.20.40.60.81.01 − SpecificitySensitivity0.00.20.40.60.81.00.00.20.40.60.81.01 − SpecificitySensitivityWHtRSBPAinesh Sewak, Torsten Hothorn

25

in the estimated transformation parameters is accounted for and appropriately propagated
for the inference of the ROC curve. In turn, asymptotic eﬃciency is guaranteed for our es-
timators and we avoid reliance on resampling procedures for the construction of conﬁdence
intervals. Secondly, transformation models focus on estimating the conditional distribution
function whose evaluation directly provides the likelihood contributions for interval, right-
and left-censored data that commonly arises due to instrument detection limits. Addition-
ally, with a simple reparameterization of the transformation function, our model extends to
ROC curves for ordinal test results. Thirdly, no strong assumptions are made regarding the
transformation function which results in a highly ﬂexible model that retains interpretability
of the regression coeﬃcients. Fourthly, we develop a test for covariate-speciﬁc correlated ROC
curves, a problem which has yet to be addressed in the literature. Lastly, software imple-
mentations for all the methods described in this article are available in the tram R package
(see Supplementary Material for example code), thus enabling a uniﬁed framework for ROC
analysis.

One aspect that warrants further investigation is model selection, speciﬁcally with regards to
the choice of FZ. In general, this may depend on the aim of the study and distinct features of
the data. Our simulation explored the extent to which the bias and coverage of the resulting
estimates were aﬀected by model choice. We found that a model with FZ = logit−1 provided
accurate results even when it was misspeciﬁed for the true data generating process. This
model also behaves very similarly to the semiparametric cumulative probability model (Tian
et al. 2020), also known as a proportional odds ordinal logistic model, both which estimate a
log-odds ratio δ. The equivalence of the transformation model’s odds ratio to the MWW test
statistic has been well studied (Wang and Tian 2017). The MWW statistic has a bounded
inﬂuence function and is robust to contaminations of the speciﬁed model (Hampel 1974).
Due to their equivalence, we hypothesize that the transformation model with FZ = logit−1
is also endowed with the same robustness properties as the MWW and can be chosen when
no a priori model is known. However, further research is needed to develop suitable model
veriﬁcation and selection methods.

Our proposed estimators assume that the diﬀerence between the diseased and nondiseased dis-
tributions is described by a shift-term, µd on the scale of FZ. A relaxation of this assumption
would allow for separate transformation functions in each of the two groups. Namely, consider
a model where the nondiseased results follow a distribution with the CDF F0(y) = FZ(h0(y))
and the diseased with the CDF F1(y) = FZ(h1(y)). Deﬁning a new transformation function
r = h1 ◦ h−1
: [0, 1] 7→ R, the smooth ROC curve with no shift assumptions is given
by ROC(p) = 1 − FZ(r(1 − p)). This model has more ﬂexibility but sacriﬁces the properness
property desirable for ROC curves. Furthermore, care has to be taken in deﬁning the correct
likelihood contributions for accurate inference of this model as uncertainty enters from both
transformation functions.

0 ◦ F −1
Z

In future work we plan to pursue various extensions of transformation models for ROC analysis
to consider (1) penalty terms for high-dimensional covariates (Kook and Hothorn 2021),
(2) mixed eﬀects for clustered observations (Tamási and Hothorn 2021), and (3) covariate-
dependent transformation functions through forest-based machine learning methods (Hothorn
and Zeileis 2021).

26

Transformation models for ROC analysis

Financial support by Swiss National Science Foundation, grant number 200021_184603, is
gratefully acknowledged.

Funding

References

Abarca-Gómez L, Abdeen ZA, Hamid ZA, Abu-Rmeileh NM, Acosta-Cazares B, Acuin C,
Adams RJ, Aekplakorn W, Afsana K, Aguilar-Salinas CA, et al. (2017). “Worldwide trends
in body-mass index, underweight, overweight, and obesity from 1975 to 2016: a pooled anal-
ysis of 2416 population-based measurement studies in 128· 9 million children, adolescents,
and adults.” The Lancet, 390(10113), 2627–2642.

Aitchison J, Silvey S (1958). “Maximum-likelihood estimation of parameters subject to re-

straints.” The Annals of Mathematical Statistics, pp. 813–828.

Alonzo TA, Pepe MS (2002). “Distribution-free ROC analysis using binary regression tech-

niques.” Biostatistics, 3(3), 421–432.

American College of Radiology (ACR) (2013). ACR BI-RADS atlas: Breast Imaging Report-

ing and Data System. 5th edition. American College of Radiology.

Bamber D (1975). “The area above the ordinal dominance graph and the area below the
receiver operating characteristic graph.” Journal of Mathematical Psychology, 12(4), 387–
415.

Bandos AI, Rockette HE, Gur D (2005). “A permutation test sensitive to diﬀerences in areas
for comparing ROC curves from a paired design.” Statistics in Medicine, 24(18), 2873–2893.

Bandos AI, Rockette HE, Gur D (2006). “A permutation test for comparing ROC curves in
multireader studies: a multi-reader ROC, permutation test.” Academic Radiology, 13(4),
414–420.

Bantis LE, Feng Z (2016). “Comparison of two correlated ROC curves at a given speciﬁcity

or sensitivity level.” Statistics in Medicine, 35(24), 4352–4367.

Bantis LE, Yan Q, Tsimikas JV, Feng Z (2017). “Estimation of smooth ROC curves for

biomarkers with limits of detection.” Statistics in Medicine, 36(24), 3830–3843.

Barbanti L, Brandl R, Hothorn T (2022).

“Multi-species count transformation models.”

arXiv:2201.13095 [stat.ME], URL https://arxiv.org/abs/2201.13095.

Bianco AM, Boente G, Gonzalez-Manteiga W (2020). “A robust approach for ROC curves
with covariates.” arXiv:2007.00150 [stat.ME], URL https://arxiv.org/abs/2007.00150.

Bickel P (1986). “Eﬃcient Testing in a Class of Transformation Models.” In Proceedings of

the 45th Session of the International Statistical Institute, volume 23, pp. 63–23.

Bickel PJ, Doksum KA (1981). “An analysis of transformations revisited.” Journal of the

American Statistical Association, 76(374), 296–311.

Ainesh Sewak, Torsten Hothorn

27

Bickel PJ, Klaassen CA, Bickel PJ, Ritov Y, Klaassen J, Wellner JA, Ritov Y (1993). Eﬃcient
and adaptive estimation for semiparametric models, volume 4. Johns Hopkins University
Press Baltimore.

Bosello O, Zamboni M (2000). “Visceral obesity and metabolic syndrome.” Obesity Reviews,

1(1), 47–56.

Box GE, Cox DR (1964). “An analysis of transformations.” Journal of the Royal Statistical

Society: Series B (Methodological), 26(2), 211–243.

Branscum AJ, Johnson WO, Hanson TE, Gardner IA (2008). “Bayesian semiparametric ROC

curve estimation and disease diagnosis.” Statistics in Medicine, 27(13), 2474–2496.

Buschke H, Kuslansky G, Katz M, Stewart WF, Sliwinski MJ, Eckholdt HM, Lipton RB
(1999). “Screening for dementia with the memory impairment screen.” Neurology, 52(2),
231–231.

Cai T, Moskowitz CS (2004). “Semi-parametric estimation of the binormal ROC curve for a

continuous diagnostic test.” Biostatistics, 5(4), 573–586.

Cai T, Pepe MS (2002). “Semiparametric receiver operating characteristic analysis to evaluate
biomarkers for disease.” Journal of the American Statistical Association, 97(460), 1099–
1107.

Dagenais MG, Dufour JM (1991). “Invariance, nonlinear models, and asymptotic tests.”

Econometrica: Journal of the Econometric Society, 59(6), 1601–1615.

De Neve J, Thas O, Gerds TA (2019). “Semiparametric linear transformation models: Eﬀect

measures, estimators, and applications.” Statistics in Medicine, 38(8), 1484–1501.

DeLong ER, DeLong DM, Clarke-Pearson DL (1988). “Comparing the areas under two or
more correlated receiver operating characteristic curves: a nonparametric approach.” Bio-
metrics, 44(3), 837–845.

Demidenko E (2012). “Conﬁdence intervals and bands for the binormal ROC curve revisited.”

Journal of Applied Statistics, 39(1), 67–79.

Dodd LE, Pepe MS (2003). “Partial AUC estimation and regression.” Biometrics, 59(3),

614–623.

Dorfman DD, Alf Jr E (1969). “Maximum-likelihood estimation of parameters of signal-
detection theory and determination of conﬁdence intervals-rating-method data.” Journal
of Mathematical Psychology, 6(3), 487–496.

Dorfman DD, Berbaum KS, Metz CE, Lenth RV, Hanley JA, Dagga HA (1997). “Proper
receiver operating characteristic analysis: the bigamma model.” Academic Radiology, 4(2),
138–149.

Eckel RH, Alberti KG, Grundy SM, Zimmet PZ (2010). “The metabolic syndrome.” The

Lancet, 375(9710), 181–183.

Egan JP (1975). Signal Detection Theory and ROC-Analysis. Academic Press.

28

Transformation models for ROC analysis

Erkanli A, Sung M, Jane Costello E, Angold A (2006). “Bayesian semi-parametric ROC

analysis.” Statistics in Medicine, 25(22), 3905–3928.

Faraggi D (2003). “Adjusting receiver operating characteristic curves and related indices for
covariates.” Journal of the Royal Statistical Society: Series D (The Statistician), 52(2),
179–192.

Farouki RT (2012). “The Bernstein polynomial basis: A centennial retrospective.” Computer

Aided Geometric Design, 29(6), 379–419.

Fay MP (2022). asht: Applied Statistical Hypothesis Tests. R package version 0.9.7, URL

https://CRAN.R-project.org/package=asht.

Feller W (1991). An Introduction to Probability Theory and Its Applications. Wiley, New

York.

Feng D, Manevski D, Perme MP (2020). auRoc: Various Methods to Estimate the AUC.

R package version 0.2-1, URL https://CRAN.R-project.org/package=auRoc.

Franco-Pereira AM, Nakas CT, Reiser B, Carmen Pardo M (2021). “Inference on the over-
lap coeﬃcient: The binormal approach and alternatives.” Statistical Methods in Medical
Research, 30(12), 2672–2684.

Gail MH, Green SB (1976). “A generalization of the one-sided two-sample Kolmogorov-

Smirnov statistic for evaluating diagnostic tests.” Biometrics, pp. 561–570.

Ghosal S, Grantz KL, Chen Z (2022). “Estimation of multiple ordered ROC curves using

placement values.” Statistical Methods in Medical Research, pp. 1470–1483.

Gönen M, Heller G (2010). “Lehmann family of ROC curves.” Medical Decision Making,

30(4), 509–517.

González-Manteiga W, Pardo-Fernández JC, van Keilegom I (2011). “ROC curves in non-
parametric location-scale regression models.” Scandinavian Journal of Statistics, 38(1),
169–184.

Green DM, Swets JA (1966). Signal Detection Theory and Psychophysics, volume 1. Wiley

New York.

Grundy SM (2004). “Obesity, metabolic syndrome, and cardiovascular disease.” The Journal

of Clinical Endocrinology & Metabolism, 89(6), 2595–2600.

Hampel FR (1974). “The inﬂuence curve and its role in robust estimation.” Journal of the

American Statistical Association, 69(346), 383–393.

Hanley JA, McNeil BJ (1982). “The meaning and use of the area under a receiver operating

characteristic (ROC) curve.” Radiology, 143(1), 29–36.

Hanley JA, McNeil BJ (1983). “A method of comparing the areas under receiver operating

characteristic curves derived from the same cases.” Radiology, 148(3), 839–843.

Harrell Jr FE (2001). Regression Modeling Strategies: With Applications to Linear Models,

Logistic Regression, and Survival Analysis, volume 608. Springer.

Ainesh Sewak, Torsten Hothorn

29

Harrell Jr FE (2022). rms: Regression Modeling Strategies. R package version 6.3-0, URL

https://CRAN.R-project.org/package=rms.

Hothorn T (2020). “Most likely transformations: The mlt package.” Journal of Statistical

Software, 92, 1–68.

Hothorn T, Kneib T, Bühlmann P (2014). “Conditional transformation models.” Journal of

the Royal Statistical Society: Series B (Statistical Methodology), 76(1), 3–27.

Hothorn T, Möst L, Bühlmann P (2018). “Most likely transformations.” Scandinavian Journal

of Statistics, 45(1), 110–134.

Hothorn T, Zeileis A (2021). “Predictive distribution modeling using transformation forests.”

Journal of Computational and Graphical Statistics, 30(4), 1181–1196.

Hsieh F, Turnbull BW (1996). “Nonparametric and semiparametric estimation of the receiver

operating characteristic curve.” The Annals of Statistics, 24(1), 25–40.

Inácio V, Jara A, Hanson TE, de Carvalho M (2013). “Bayesian nonparametric ROC regres-

sion modeling.” Bayesian Analysis, 8(3), 623–646.

Inácio V, M Lourenço V, de Carvalho M, Parker RA, Gnanapragasam V (2021a). “Robust and
ﬂexible inference for the covariate-speciﬁc receiver operating characteristic curve.” Statistics
in Medicine, 40(26), 5779–5795.

Inácio V, Rodríguez-Álvarez MX, Gayoso-Diz P (2021b). “Statistical evaluation of medical

tests.” Annual Review of Statistics and Its Application, 8, 41–67.

Jensen K, Müller HH, Schäfer H (2000). “Regional conﬁdence bands for ROC curves.” Statis-

tics in Medicine, 19(4), 493–509.

Jiang Y, Metz CE, Nishikawa RM (1996). “A receiver operating characteristic partial area

index for highly sensitive diagnostic tests.” Radiology, 201(3), 745–750.

Khan MRA, Brandenburger T (2020). ROCit: Performance Assessment of Binary Clas-
siﬁer with Visualization. R package version 2.1.1, URL https://CRAN.R-project.org/
package=ROCit.

Khan RA (2022).

“Resilience family of

receiver operating characteristic curves.”

arXiv:2203.13665 [stat.ME], [math.ST], URL https://arxiv.org/abs/2203.13665.

Klein N, Hothorn T, Barbanti L, Kneib T (2022). “Multivariate conditional transformation

models.” Scandinavian Journal of Statistics, 49(1), 116–142.

Komaba A, Johno H, Nakamoto K (2022). “A novel statistical approach for two-sample testing
based on the overlap coeﬃcient.” arXiv:2206.03166 [math.ST], URL https://arxiv.org/
abs/2206.03166.

Konietschke F, Placzek M, Schaarschmidt F, Hothorn LA (2015). “nparcomp: An R Software
Package for Nonparametric Multiple Comparisons and Simultaneous Conﬁdence Intervals.”
Journal of Statistical Software, 64(9), 1–17. URL http://www.jstatsoft.org/v64/i09/.

30

Transformation models for ROC analysis

Kook L, Hothorn T (2021). “Regularized Transformation Models: The tramnet Package.” R

Journal, 13(1), 581.

Lindsey JK, et al. (1996). Parametric Statistical Inference. Oxford University Press.

Lynn HS (2001). “Maximum likelihood inference for left-censored HIV RNA data.” Statistics

in Medicine, 20(1), 33–45.

Mandel M (2013). “Simulation-based conﬁdence intervals for functions with complicated

derivatives.” The American Statistician, 67(2), 76–81.

Martínez-Camblor P (2022). “About the use of the overlap coeﬃcient in the binary classiﬁ-

cation context.” Communications in Statistics-Theory and Methods, pp. 1–11.

Martínez-Camblor P, Pérez-Fernández S, Corral N (2018). “Eﬃcient nonparametric conﬁ-
dence bands for receiver operating-characteristic curves.” Statistical Methods in Medical
Research, 27(6), 1892–1908.

McClish DK (1989). “Analyzing a portion of the ROC curve.” Medical Decision Making, 9(3),

190–195.

McIntosh MW, Pepe MS (2002). “Combining several screening tests: optimality of the risk

score.” Biometrics, 58(3), 657–664.

Molodianovitch K, Faraggi D, Reiser B (2006). “Comparing the areas under two correlated
ROC curves: parametric and non-parametric approaches.” Biometrical Journal, 48(5),
745–757.

Mumford SL, Schisterman EF, Vexler A, Liu A (2006). “Pooling biospecimens and limits of

detection: eﬀects on ROC curve analysis.” Biostatistics, 7(4), 585–598.

Ogilvie JC, Creelman CD (1968). “Maximum-likelihood estimation of receiver operating
characteristic curve parameters.” Journal of Mathematical Psychology, 5(3), 377–391.

Pan X, Metz CE (1997). “The “proper” binormal model: parametric receiver operating
characteristic curve estimation with degenerate data.” Academic Radiology, 4(5), 380–389.

Pepe MS (1997). “A regression modelling framework for receiver operating characteristic

curves in medical diagnostic testing.” Biometrika, 84(3), 595–608.

Pepe MS (1998). “Three approaches to regression analysis of receiver operating characteristic

curves for continuous test results.” Biometrics, pp. 124–135.

Pepe MS (2000). “An interpretation for the ROC curve and inference using GLM procedures.”

Biometrics, 56(2), 352–359.

Pepe MS (2003). The Statistical Evaluation of Medical Tests for Classiﬁcation and Prediction.

Medicine.

Pérez Fernández S, Martínez Camblor P, Filzmoser P, Corral Blanco NO, et al. (2018).
“nsROC: an R package for non-standard ROC curve analysis.” The R Journal, 10 (2).

Ainesh Sewak, Torsten Hothorn

31

Perez-Jaume S, Skaltsa K, Pallarès N, Carrasco JL (2017).

“ThresholdROC: Optimum
Threshold Estimation Tools for Continuous Diagnostic Tests in R.” Journal of Statisti-
cal Software, 82(4), 1–21. doi:10.18637/jss.v082.i04.

Perkins NJ, Schisterman EF, Vexler A (2007). “Receiver operating characteristic curve infer-
ence from a sample with a limit of detection.” American Journal of Epidemiology, 165(3),
325–333.

Perkins NJ, Schisterman EF, Vexler A (2009).

“Generalized ROC curve inference for a
biomarker subject to a limit of detection and measurement error.” Statistics in Medicine,
28(13), 1841–1860.

Rao CR (1948). “Large sample tests of statistical hypotheses concerning several parameters
with applications to problems of estimation.” In Mathematical Proceedings of the Cambridge
Philosophical Society, volume 44, pp. 50–57. Cambridge University Press.

Rao CR (2005). “Score Test: Historical Review and Recent Developments.” In Advances
in Ranking and Selection, Multiple Comparisons, and Reliability, pp. 8–20. Birkhäuser,
Boston, U.S.A.

Ridout M, Linkie M (2009). “Estimating overlap of daily activity patterns from camera trap
data.” Journal of Agricultural, Biological, and Environmental Statistics, 14(3), 322–337.

Robin X, Turck N, Hainard A, Tiberti N, Lisacek F, Sanchez JC, Müller M (2011). “pROC:
an open-source package for R and S+ to analyze and compare ROC curves.” BMC Bioin-
formatics, 12, 77.

Rodríguez-Álvarez MX, Roca-Pardiñas J, Cadarso-Suárez C (2011). “ROC curve and covari-
ates: extending induced methodology to the non-parametric framework.” Statistics and
Computing, 21(4), 483–499.

Romero-Saldaña M, Fuentes-Jiménez FJ, Vaquero-Abellán M, Álvarez-Fernández C, Molina-
Recio G, López-Miranda J (2016).
“New non-invasive method for early detection of
metabolic syndrome in the working population.” European Journal of Cardiovascular Nurs-
ing, 15(7), 549–558.

Romero-Saldaña M, Tauler P, Vaquero-Abellán M, López-González AA, Fuentes-Jiménez FJ,
Aguiló A, Álvarez-Fernández C, Molina-Recio G, Bennasar-Veny M (2018). “Validation of
a non-invasive method for the early detection of metabolic syndrome: a diagnostic accuracy
test in a working population.” BMJ Open, 8(10), e020476.

Ruopp MD, Perkins NJ, Whitcomb BW, Schisterman EF (2008). “Youden Index and optimal
cut-point estimated from observations aﬀected by a lower limit of detection.” Biometrical
Journal, 50(3), 419–430.

Schisterman EF, Faraggi D, Reiser B (2004). “Adjusting the generalized ROC curve for

covariates.” Statistics in Medicine, 23(21), 3319–3331.

Schmid F, Schmidt A (2006).

“Nonparametric estimation of the coeﬃcient of overlap-
ping—theory and empirical application.” Computational Statistics & Data Analysis, 50(6),
1583–1596.

32

Transformation models for ROC analysis

Shao J, Yu L, Shen X, Li D, Wang K (2010). “Waist-to-height ratio, an optimal predictor
for obesity and metabolic syndrome in Chinese adults.” The Journal of Nutrition, Health
& Aging, 14(9), 782–785.

Siegfried S, Kook L, Hothorn T (2022).

“Distribution-Free Location-Scale Regression.”

arXiv:2208.05302 [stat.ME], URL https://arxiv.org/abs/2208.05302.

Silvey SD (1959). “The Lagrangian multiplier test.” The Annals of Mathematical Statistics,

30(2), 389–407.

Singh A, Nocerino J (2002). “Robust estimation of mean and variance using environmental
data sets with below detection limit observations.” Chemometrics and Intelligent Laboratory
Systems, 60(1-2), 69–86.

Stevens J, Katz EG, Huxley RR (2010). “Associations between gender, age and waist cir-

cumference.” European Journal of Clinical Nutrition, 64(1), 6–15.

Suliga E, Ciesla E, Głuszek-Osuch M, Rogula T, Głuszek S, Kozieł D (2019). “The usefulness
of anthropometric indices to identify the risk of metabolic syndrome.” Nutrients, 11(11),
2598.

Swets JA, Pickett RM (1982). Evaluation of Diagnostic Systems: Methods from Signal De-

tection Theory. New York: Academic Press.

Tamási B, Hothorn T (2021). “tramME: Mixed-Eﬀects Transformation Models Using Tem-

plate Model Builder.” The R Journal, 13(1), 581–594.

Thas O, Neve JD, Clement L, Ottoy JP (2012). “Probabilistic index models.” Journal of the

Royal Statistical Society: Series B (Statistical Methodology), 74(4), 623–671.

Therneau TM (2022). A Package for Survival Analysis in R. R package version 3.3-1, URL

https://CRAN.R-project.org/package=survival.

Thompson ML, Zucchini W (1989). “On the statistical analysis of ROC curves.” Statistics in

Medicine, 8(10), 1277–1290.

Tian Y, Hothorn T, Li C, Harrell Jr FE, Shepherd BE (2020). “An empirical comparison of

two novel transformation models.” Statistics in Medicine, 39(5), 562–576.

Tosteson ANA, Begg CB (1988). “A general regression methodology for ROC curve estima-

tion.” Medical Decision Making, 8(3), 204–215.

Wang Y, Tian L (2017). “The Equivalence Between Mann-Whitney Wilcoxon Test and Score
Test Based on the Proportional Odds Model for Ordinal Responses.” In 4th International
Conference on Industrial Economics System and Industrial Security Engineering (IEIS),
pp. 1–5. IEEE, Kyoto, Japan. doi:10.1109/IEIS.2017.8078606.

Weitzman MS (1970). Measures of Overlap of Income Distributions of White and Negro

Families in the United States, volume 3. US Bureau of the Census.

Wieand S, Gail MH, James BR, James KL (1989). “A family of nonparametric statistics for
comparing diagnostic markers with paired or unpaired data.” Biometrika, 76(3), 585–592.

Ainesh Sewak, Torsten Hothorn

33

Xiong C, Luo J, Agboola F, Grant E, Morris JC (2022). “A family of estimators to diagnostic
accuracy when candidate tests are subject to detection limits—Application to diagnosing
early stage Alzheimer disease.” Statistical Methods in Medical Research, 31(5), 882–898.

Yao F, Craiu RV, Reiser B (2010). “Nonparametric covariate adjustment for receiver operating

characteristic curves.” Canadian Journal of Statistics, 38(1), 27–46.

Youden WJ (1950). “Index for rating diagnostic tests.” Cancer, 3(1), 32–35.

Zalesin KC, Franklin BA, Miller WM, Peterson ED, McCullough PA (2008). “Impact of
obesity on cardiovascular disease.” Endocrinology and Metabolism Clinics of North America,
37(3), 663–684.

Zou KH (1997). Analysis of Some Transformation Models for the Two-sample Problem with
Special Reference to Receiver Operating Characteristic Curves. Ph.D. thesis, University of
Rochester.

Zou KH, Hall W (2000). “Two transformation models for estimating an ROC curve derived

from continuous data.” Journal of Applied Statistics, 27(5), 621–631.

Zou KH, Hall W (2002). “Semiparametric and parametric transformation models for compar-
ing diagnostic markers with paired design.” Journal of Applied Statistics, 29(6), 803–816.

Zou KH, Hall WJ, Shapiro DE (1997). “Smooth non-parametric receiver operating char-
acteristic (ROC) curves for continuous diagnostic tests.” Statistics in Medicine, 16(19),
2143–2156.

Zou KH, Liu A, Bandos AI, Ohno-Machado L, Rockette HE (2011). Statistical Evaluation of

Diagnostic Performance: Topics in ROC analysis. CRC Press.

Zou KH, Tempany CM, Fielding JR, Silverman SG (1998). “Original smooth receiver operat-
ing characteristic curve estimation from continuous data: statistical methods for analyzing
the predictive value of spiral CT of ureteral stones.” Academic Radiology, 5(10), 680–687.

34

Transformation models for ROC analysis

A. Simulation study

Reference

R package

tram
rms
pim
survival
pROC
asht
nparcomp

Hothorn (2020)
Harrell Jr (2001, 2022)
Thas et al. (2012)
Therneau (2022)
Robin et al. (2011)
Fay (2022)
Konietschke et al. (2015)
Khan and Brandenburger (2020) ROCit
Feng et al. (2020)
auRoc
Perez-Jaume et al. (2017)
ThresholdROC
Ridout and Linkie (2009)
overlap
-
Franco-Pereira et al. (2021)
Pérez Fernández et al. (2018)
nsROC

ROC

AUC

Youden index

Estimate CB Estimate CI Estimate CI

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)

(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)
(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)

(cid:51)
(cid:51)
(cid:51)
(cid:51)

(cid:51)
(cid:51)
(cid:51)

Table S1: Overview of the diﬀerent methods used in the simulation study. References to the
original publication along with R software details are given. The ((cid:51)) indicates if a method
computes the speciﬁc metric. The metrics included estimates for the ROC curve, AUC and
Youden index as well as corresponding conﬁdence bands or conﬁdence intervals.

Ainesh Sewak, Torsten Hothorn

35

Figure S1: Empirical coverage probabilities of 90% conﬁdence intervals for the AUC from the
diﬀerent methods used in the simulation study. The methods are denoted by their R package
name from Table S1 followed by a short abbreviation to uniquely identify methods with
multiple procedures. These included “pbt” (probit−1), “lgt” (logit−1), “clg” (cloglog−1),
“asy” (asymptotic), “boot” (bootstrap) and “bn” (binormal).

0.8900.8740.8880.8910.8780.8870.8940.8900.8860.8910.8980.9090.8930.9140.9200.8940.8980.8870.8950.8980.8900.8930.8960.8980.8960.8980.9040.9100.9000.9130.9190.9000.8950.8950.8960.8960.8940.8940.8990.8960.8950.8960.8970.9020.9020.9080.9170.8960.8870.8510.8830.8890.8600.8830.8660.8840.8800.8840.8950.9040.9010.9260.9050.8870.8940.8250.8910.8960.8290.8910.8300.8930.8900.8930.8980.9040.8940.9070.9040.8930.9030.7740.8990.9020.7820.8980.7770.8990.8980.9000.9030.9070.9030.9080.9040.9000.9020.7620.8920.9040.7740.8900.7620.8910.8850.8800.9110.9120.8850.9170.8850.8900.9050.6500.8930.9050.6630.8920.6440.8960.8910.8900.9100.9070.8930.9080.8780.8940.9080.4620.8980.9080.4780.8990.4560.8990.8970.8960.9080.9070.9030.9070.8740.8980.9070.5570.8850.9170.6210.8910.5930.8530.8490.8340.9550.9030.9150.8970.8350.8470.9010.3550.8950.9060.4210.8920.3920.8870.8810.8600.9490.9040.9340.9180.8350.8740.8770.1190.8940.8940.1730.8940.1550.8920.8870.8780.9430.9050.9400.9150.8310.8860.8900.8750.8900.8940.8800.8900.8930.8930.8890.8930.9000.9110.8900.9140.9180.8960.8940.8870.8940.8950.8910.8950.8970.8960.8930.8970.9000.9050.9000.9110.9190.8960.9010.8970.9000.9010.8970.9000.9020.9000.8990.9000.9020.9060.9050.9110.9160.9000.8910.8310.8820.8940.8370.8840.8480.8910.8880.8920.9010.9100.9040.9260.9050.8930.8970.7940.8910.8970.8030.8900.8050.8980.8960.8980.9000.9070.8950.9030.9020.8990.8950.7130.8880.8950.7220.8860.7190.8950.8940.8950.8970.9020.8930.8950.8950.8950.8930.6850.8680.8950.7070.8700.6920.8900.8830.8790.9060.9100.8670.8940.8750.8870.8980.5380.8760.8990.5570.8760.5410.8970.8940.8910.9040.9090.8820.8900.8730.8950.8990.3040.8740.9000.3230.8760.3090.8990.8980.8970.9020.9070.8850.8800.8630.8970.8880.5320.8310.9130.6000.8540.5930.8310.8210.8000.9470.8830.8470.8740.8380.8160.8970.3120.8400.8980.3780.8500.3610.8680.8660.8490.9280.8870.8700.9040.8450.8630.8960.1000.8390.9040.1560.8590.1430.8920.8890.8790.9240.9040.8770.9100.8440.8870.8930.8730.8900.8970.8790.8910.8940.8960.8920.8960.9010.9130.8900.9150.9180.8980.8950.8860.8940.8960.8900.8940.8980.8970.8950.8970.9000.9060.8970.9090.9190.8980.8960.8860.8940.8960.8850.8920.8910.8950.8940.8950.8980.9020.9010.9050.9140.8970.8940.8780.8900.8940.8830.8890.8920.8930.8880.8890.9010.9090.9030.9320.9110.8930.8920.8900.8910.8930.8920.8910.8970.8900.8880.8910.8940.9010.8940.9070.9060.8930.8950.8970.8970.8950.8970.8970.8990.8940.8930.8940.8970.9020.8990.9100.9050.8940.8950.8920.8830.8970.8930.8810.9010.8900.8840.8790.9050.9100.8930.9340.8840.8860.8980.8920.8850.8970.8940.8840.8990.8930.8900.8890.8990.9030.9060.9260.8730.8920.9060.8960.8930.9050.8940.8960.8980.9010.8990.8990.9030.9080.9160.9280.8650.9010.8670.8550.8100.9040.9220.8310.9440.8010.7950.7800.9310.8590.9550.7950.7010.7930.8870.8780.8320.8790.8960.8290.9100.8700.8660.8490.9110.8860.9510.8060.7060.8620.8890.8710.8300.8700.8970.8310.9030.8920.8900.8720.9080.9040.8950.7260.6930.879FZ=probit-1FZ=logit-1FZ=cloglog-1AUC: 0.5AUC: 0.65AUC: 0.8AUC: 0.95255010025501002550100auRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtNCI Method0.800.850.900.951.00Coverage36

Transformation models for ROC analysis

Figure S2: Average width of 90% conﬁdence intervals for the AUC from the diﬀerent meth-
ods used in the simulation study. The methods are denoted by their R package name from
Table S1 followed by a short abbreviation to uniquely identify methods with multiple proce-
dures. These included “pbt” (probit−1), “lgt” (logit−1), “clg” (cloglog−1), “asy” (asymptotic),
“boot” (bootstrap) and “bn” (binormal).

0.2580.2260.2550.2610.2310.2570.2310.2550.2560.2740.2580.2670.2670.2670.2700.2710.1860.1630.1830.1870.1640.1840.1640.1850.1850.1920.1860.1900.1890.1900.1910.1910.1330.1160.1300.1330.1160.1310.1160.1320.1330.1350.1330.1340.1340.1340.1340.1340.2440.2150.2400.2460.2200.2420.2210.2410.2410.2580.2450.2530.2520.2530.2570.2550.1760.1550.1730.1770.1570.1730.1570.1750.1750.1810.1760.1790.1790.1790.1810.1790.1260.1100.1230.1260.1110.1230.1110.1250.1250.1270.1260.1270.1270.1270.1270.1270.1970.1800.1930.2000.1840.1940.1870.1950.1930.2050.2050.2060.2030.2060.2120.2020.1420.1300.1390.1430.1320.1390.1320.1400.1400.1440.1450.1440.1450.1440.1480.1430.1010.0930.0990.1020.0930.0990.0940.1000.1000.1010.1030.1010.1030.1010.1040.1010.1000.1030.0900.1070.1100.0960.1150.0930.0890.0890.1190.1070.0970.1030.1140.0890.0700.0740.0640.0710.0750.0640.0760.0650.0640.0640.0790.0680.0730.0680.0780.0640.0490.0530.0450.0500.0530.0450.0540.0460.0450.0460.0540.0470.0520.0470.0540.0450.2580.2260.2550.2610.2310.2570.2310.2550.2560.2740.2580.2670.2670.2670.2700.2710.1860.1630.1830.1870.1640.1840.1640.1850.1850.1920.1860.1900.1890.1900.1900.1900.1330.1160.1300.1330.1160.1310.1160.1330.1330.1350.1330.1340.1340.1340.1340.1340.2440.2160.2410.2470.2210.2430.2210.2420.2420.2590.2450.2540.2530.2540.2570.2550.1760.1550.1740.1770.1570.1740.1570.1750.1750.1810.1760.1800.1790.1790.1810.1800.1260.1110.1240.1260.1110.1240.1110.1250.1250.1280.1260.1270.1270.1270.1270.1270.1970.1820.1960.2000.1860.1970.1880.1980.1960.2080.2050.2090.2050.2090.2120.2060.1420.1320.1410.1430.1330.1420.1340.1430.1420.1470.1450.1470.1460.1470.1480.1460.1010.0940.1010.1020.0950.1010.0950.1020.1020.1030.1030.1030.1040.1030.1040.1030.0930.1020.0880.1080.1140.1000.1190.0980.0930.0910.1180.1170.0920.1140.1140.0920.0650.0750.0620.0680.0760.0640.0770.0700.0680.0680.0780.0730.0700.0740.0780.0680.0460.0550.0440.0480.0550.0460.0550.0500.0490.0490.0540.0510.0500.0510.0540.0490.2580.2260.2550.2610.2310.2570.2310.2550.2560.2740.2580.2670.2670.2670.2700.2710.1860.1630.1830.1870.1640.1840.1640.1850.1850.1920.1860.1900.1890.1900.1900.1910.1330.1160.1300.1330.1160.1310.1160.1330.1330.1350.1330.1340.1340.1340.1340.1340.2440.2130.2400.2460.2180.2420.2190.2410.2410.2580.2450.2530.2510.2530.2570.2550.1760.1540.1730.1770.1550.1740.1560.1750.1750.1810.1760.1790.1780.1790.1810.1800.1260.1100.1230.1260.1100.1230.1100.1250.1250.1270.1260.1270.1260.1270.1270.1270.1970.1710.1940.2000.1750.1960.1790.1980.1960.2080.2050.2090.2020.2090.2120.2050.1420.1230.1400.1430.1250.1410.1260.1430.1420.1460.1450.1470.1440.1470.1480.1450.1010.0880.1000.1020.0890.1000.0890.1020.1020.1030.1030.1030.1020.1030.1040.1030.0880.0720.0860.1120.1020.1060.1090.1040.0980.0950.1180.1300.1130.1100.1100.0960.0620.0510.0610.0650.0590.0630.0610.0750.0730.0720.0790.0780.0840.0760.0770.0710.0440.0360.0440.0460.0410.0450.0420.0530.0520.0520.0540.0530.0600.0530.0530.051FZ=probit-1FZ=logit-1FZ=cloglog-1AUC: 0.5AUC: 0.65AUC: 0.8AUC: 0.95255010025501002550100auRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtauRocROCit bn lgtROCit bnnparcompashtpROC bootpROC asysurvivalorm clgtram clgpim lgtorm lgttram lgtpim pbtorm pbttram pbtNCI Method0.100.150.200.250.30CI lengthAinesh Sewak, Torsten Hothorn

37

Figure S3: Empirical coverage probabilities of 90% conﬁdence intervals for the Youden index
from the diﬀerent methods used in the simulation study. The methods are denoted by their
R package name from Table S1 followed by a short abbreviation to uniquely identify methods
with multiple procedures. These included “pbt” (probit−1), “lgt” (logit−1), “clg” (cloglog−1),
“norm” (bootstrap normal approximation interval), “basic” (basic bootstrap interval), “perc”
(bootstrap percentile interval), “dta” (delta method), “bc” (BoxCox transformation), “boot”
(bootstrap variance), “bn eq” (binormal equal variance) and “bn uneq” (binormal unequal
variance).

0.8900.8740.8880.1290.0790.0000.7120.0010.6390.0010.0010.9350.9030.8980.8870.8950.1140.0670.0000.7290.0010.6920.0020.0010.9460.9170.8950.8950.8960.0860.0470.0000.7400.0020.7250.0010.0000.9450.9160.8920.8590.8870.8670.8690.8940.8780.8840.8600.8540.8690.9410.9360.8940.8330.8910.8720.8810.9530.8860.9040.8810.8940.8950.9480.9490.8960.7940.8990.8750.8850.9440.8960.9110.8920.9050.8990.9480.9480.8980.7960.8910.8720.8830.9360.8680.8900.8760.8980.8800.9390.9370.8960.7190.8930.8680.8740.8680.8800.8920.8870.8970.8890.9440.9460.8860.5970.8970.8460.8490.7560.8920.8980.8950.9020.8960.9370.9380.9180.7320.8840.7630.7520.6070.8450.8930.9190.9320.8870.8710.8650.9210.6310.8920.5590.5460.2500.8730.9010.9170.9250.8960.9260.9240.9200.4440.8910.2940.2820.0450.8810.8960.9070.9100.8940.9240.9240.8900.8750.8900.1330.0840.0000.7060.0010.6380.0020.0010.9320.9030.8940.8870.8940.1080.0620.0000.7280.0020.6980.0010.0010.9450.9160.9010.8970.9000.0850.0460.0000.7390.0010.7250.0010.0000.9450.9110.8960.8220.8800.8670.8710.8980.8840.9090.8660.8800.9010.9410.9320.8960.7640.8750.8730.8830.9560.8820.9410.8780.9330.9350.9480.9460.8950.6550.8620.8730.8830.9390.8670.9230.8650.9200.9140.9460.9410.8930.6700.8550.8680.8800.9320.8420.8780.8370.8750.8860.9350.9330.8960.5200.8500.8830.8870.8820.8520.8690.8530.8710.8970.9460.9460.8990.2830.8090.8750.8770.8000.8270.8350.8310.8390.8720.9410.9410.8870.6040.8320.8920.8930.8500.7800.8270.8630.8890.8720.8950.8720.8950.4220.8300.8810.8750.7220.8120.8350.8590.8710.8850.9450.9320.8970.1990.8120.8290.8210.5470.8200.8300.8490.8580.8940.9420.9280.8930.8730.8900.1290.0790.0000.7110.0010.6390.0010.0010.9320.8980.8950.8860.8940.1040.0600.0000.7270.0010.6960.0010.0000.9400.9090.8960.8860.8940.0880.0470.0000.7330.0010.7190.0020.0010.9480.9120.9010.8800.8930.8710.8720.8750.8710.8600.9090.9030.9010.9390.9330.8930.8910.8900.8860.8940.9520.8750.8770.9060.9190.9110.9470.9480.8940.8970.8940.8740.8800.9450.8770.8750.9040.9100.8970.9380.9440.8950.8910.8760.7940.8090.8910.8500.8740.9020.9260.9030.9360.9340.8990.8910.8660.6490.6560.6260.8690.8790.9060.9170.9010.9430.9440.9040.8950.8400.4260.4270.2900.8610.8670.9110.9170.9040.9330.9440.8640.8570.7860.0090.0080.0020.8680.9240.9050.9100.8870.9620.8660.8690.8790.7640.0000.0000.0000.9020.9360.9210.9170.8990.9620.9300.8410.8750.6890.0000.0000.0000.9040.9260.9200.9150.8980.9350.932FZ=probit-1FZ=logit-1FZ=cloglog-1J: 0J: 0.25J: 0.5J: 0.8255010025501002550100ThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtNCI Method0.800.850.900.951.00Count38

Transformation models for ROC analysis

Figure S4: Average width of 90% conﬁdence intervals for the AUC from the diﬀerent methods
used in the simulation study. The methods are denoted by their R package name from Ta-
ble S1 followed by a short abbreviation to uniquely identify methods with multiple procedures.
These included “pbt” (probit−1), “lgt” (logit−1), “clg” (cloglog−1), “norm” (bootstrap nor-
mal approximation interval), “basic” (basic bootstrap interval), “perc” (bootstrap percentile
interval), “dta” (delta method), “bc” (BoxCox transformation), “boot” (bootstrap variance),
“bn eq” (binormal equal variance) and “bn uneq” (binormal unequal variance).

0.2470.2100.2300.2700.2700.2700.3320.4320.3380.4230.4060.5470.4920.1770.1500.1630.1920.1910.1910.2380.3530.2400.3470.2900.3890.3510.1260.1080.1170.1360.1360.1360.1690.2820.1700.2800.2090.2760.2490.3580.3110.3390.2960.2960.2960.3430.3500.3420.3470.3540.5280.5110.2690.2320.2520.2260.2270.2270.2490.2500.2490.2500.2500.3770.3700.1930.1670.1800.1740.1740.1740.1790.1790.1790.1790.1790.2670.2650.3340.3040.3210.3130.3140.3140.3160.3060.3150.3050.2990.4700.4670.2400.2180.2300.2370.2380.2380.2280.2240.2280.2240.2200.3360.3350.1710.1540.1630.1750.1760.1760.1620.1610.1630.1610.1590.2390.2380.2250.2240.2220.2700.2700.2700.2070.2080.2240.2240.1960.3170.3160.1600.1620.1590.2000.2010.2010.1510.1510.1580.1580.1470.2300.2300.1140.1160.1140.1460.1460.1460.1080.1080.1110.1110.1070.1640.1640.2460.2080.2290.2700.2700.2700.3320.4340.3380.4240.4060.5470.4920.1760.1500.1640.1920.1910.1910.2370.3510.2400.3450.2870.3890.3510.1260.1080.1170.1370.1360.1360.1690.2770.1700.2740.2040.2760.2490.3570.3030.3340.2980.2980.2980.3430.3570.3410.3540.3670.5290.5080.2690.2290.2510.2280.2290.2290.2490.2530.2490.2520.2550.3770.3690.1940.1670.1810.1760.1760.1760.1790.1800.1790.1800.1830.2670.2650.3400.3070.3280.3180.3190.3190.3200.3100.3170.3070.3290.4700.4670.2440.2200.2350.2410.2420.2420.2310.2270.2310.2270.2440.3360.3350.1740.1560.1670.1770.1780.1780.1650.1640.1650.1640.1770.2390.2380.2280.2300.2290.2540.2540.2540.2060.2070.2190.2200.2150.3240.3200.1640.1680.1670.1870.1870.1870.1510.1520.1570.1570.1670.2340.2320.1170.1210.1190.1350.1350.1350.1090.1090.1110.1110.1250.1670.1660.2480.2090.2300.2700.2690.2690.3320.4340.3380.4220.4060.5470.4930.1770.1510.1640.1920.1920.1920.2370.3500.2400.3440.2870.3890.3500.1260.1060.1160.1370.1360.1360.1690.2800.1700.2770.2070.2760.2490.3570.3220.3380.2940.2940.2940.3330.3360.3420.3460.3350.5290.5010.2690.2370.2520.2230.2240.2240.2400.2390.2460.2460.2340.3770.3610.1940.1690.1810.1710.1710.1710.1720.1710.1760.1750.1690.2680.2580.3400.3100.3280.3080.3090.3090.2940.2860.3220.3120.2980.4660.4520.2440.2220.2350.2350.2360.2360.2130.2100.2300.2260.2180.3340.3240.1740.1580.1670.1750.1760.1760.1520.1510.1620.1610.1560.2370.2310.2310.2050.2380.3060.3070.3070.1860.1880.2290.2290.2180.3290.3080.1670.1480.1740.2340.2340.2340.1360.1360.1590.1590.1530.2360.2250.1190.1060.1250.1740.1740.1740.0980.0980.1110.1110.1050.1680.161FZ=probit-1FZ=logit-1FZ=cloglog-1J: 0J: 0.25J: 0.5J: 0.8255010025501002550100ThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtThresholdROC bn ueqThresholdROC bn eqFP bc bootFP bc lgtFP bcFP dta lgtFP dtaoverlap percoverlap basicoverlap normtram clgtram lgttram pbtNCI Method0.100.150.200.250.30CI lengthAinesh Sewak, Torsten Hothorn

39

Figure S5: Empirical coverage probabilities of 90% conﬁdence bands for the ROC curve
from the diﬀerent methods used in the simulation study. The methods are denoted by
their R package name from Table S1 followed by a short abbreviation to uniquely identify
methods with multiple procedures. These included “pbt” (probit−1), “lgt” (logit−1), “clg”
(cloglog−1), “boot” (empirical bootstrap), “bn” (binormal), “psn” (Martínez-Camblor et al.
2018), “dek” (Demidenko 2012) and “jms” (Jensen et al. 2000).

0.8740.8870.8950.8900.8980.8950.8880.8950.8960.5220.5210.5160.8180.8390.8390.9270.9560.9660.6210.5920.5460.6860.6850.6760.6870.6790.6770.0000.0000.0000.5630.3510.0890.8830.8910.8990.5170.5110.5090.7630.7620.7560.8780.9200.9450.3420.3080.2790.6880.7210.7400.6930.7160.7410.0000.0000.0000.0300.0000.0000.8920.8930.8980.5170.5080.5350.6430.6030.5370.6860.7420.7920.0530.0400.0270.7360.7390.7340.7400.7360.7370.0000.0000.0000.0000.0000.0000.8850.8950.8940.5610.5650.6030.4100.3540.2700.1770.2040.2530.0000.0000.0000.7440.7510.7450.7510.7480.7440.8750.8870.8970.8900.8940.9010.8900.8940.9000.5200.5200.5080.8170.8350.8430.9290.9550.9650.6260.5900.5600.6800.6810.6690.6850.6750.6700.2940.0000.0000.8910.8970.8950.7330.6550.4970.4380.4030.3180.7550.7600.7600.8740.9200.9470.4130.4000.3600.6290.6080.5240.6330.6040.5270.0000.0000.0000.8930.8980.8990.4040.1510.0000.2580.1610.0450.5840.5490.5300.7200.8030.8690.1290.1310.1430.5380.3650.1270.5440.3560.1280.0000.0000.0000.8880.8970.8960.0000.0000.0000.0450.0060.0000.1470.1480.1320.2750.3900.5270.0040.0020.0050.2760.0950.0050.2780.0910.0050.8730.8860.8860.8930.8950.8960.8900.8940.8940.5150.5220.5130.8170.8320.8390.9300.9520.9650.6230.5790.5460.6950.6810.6710.6990.6780.6720.8780.8900.8970.0640.0000.0000.2980.0000.0000.5650.5440.4580.8010.8240.8230.8160.8390.8570.2350.1480.0900.6810.6800.6430.6860.6760.6460.8920.8920.8960.0000.0000.0000.0000.0000.0000.6780.5380.3310.7520.7670.7680.2890.2540.2290.0080.0010.0000.5990.4790.2720.6030.4740.2730.8550.8780.8710.0000.0000.0000.0000.0000.0000.5820.1930.0070.1890.1600.0900.0000.0000.0000.0000.0000.0000.1640.0190.0000.1660.0180.000FZ=probit-1FZ=logit-1FZ=cloglog-1AUC: 0.5AUC: 0.65AUC: 0.8AUC: 0.95255010025501002550100nsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtNCI Method0.800.850.900.951.00Coverage40

Transformation models for ROC analysis

Figure S6: Average areas of 90% conﬁdence bands for the ROC curve from the diﬀerent meth-
ods used in the simulation study. The methods are denoted by their R package name from
Table S1 followed by a short abbreviation to uniquely identify methods with multiple proce-
dures. These included “pbt” (probit−1), “lgt” (logit−1), “clg” (cloglog−1), “boot” (empirical
bootstrap), “bn” (binormal), “psn” (Martínez-Camblor et al. 2018), “dek” (Demidenko 2012)
and “jms” (Jensen et al. 2000).

0.2260.1620.1160.2580.1860.1330.2550.1830.1300.2490.1610.1070.4810.4120.3180.5740.4700.3640.3690.2630.1860.2410.1670.1160.2420.1660.1160.2150.1550.1100.2440.1760.1260.2400.1730.1230.2510.1590.1060.4230.3740.2940.5230.4370.3440.3480.2500.1760.2610.1910.1360.2630.1900.1370.1790.1290.0920.1970.1420.1010.1920.1390.0990.2510.1470.0950.2850.2710.2250.3820.3310.2740.2740.1990.1420.2250.1570.1090.2260.1560.1090.1010.0720.0520.0980.0690.0490.0880.0620.0440.1990.0870.0490.0820.0830.0800.1430.1300.1180.1120.0850.0630.1050.0690.0470.1050.0680.0470.2260.1620.1160.2580.1860.1330.2550.1830.1300.2490.1610.1070.4810.4120.3170.5740.4700.3640.3690.2630.1860.2400.1660.1160.2420.1660.1160.2160.1550.1110.2440.1760.1260.2410.1740.1240.2510.1590.1060.4240.3760.2970.5250.4380.3450.3500.2510.1770.2670.1950.1390.2680.1940.1390.1810.1310.0940.1970.1420.1010.1950.1410.1010.2540.1490.0970.2840.2750.2320.3830.3350.2800.2810.2050.1460.2490.1720.1190.2510.1700.1190.1000.0740.0540.0910.0640.0450.0860.0610.0430.2240.0970.0540.0770.0810.0820.1410.1310.1200.1150.0920.0700.1330.0810.0540.1330.0800.0540.2260.1620.1160.2580.1860.1330.2550.1830.1300.2490.1610.1070.4810.4120.3170.5740.4700.3640.3690.2630.1860.2410.1660.1150.2420.1660.1160.2120.1530.1090.2440.1760.1260.2400.1730.1230.2520.1620.1100.4210.3690.2890.5210.4270.3310.3450.2470.1740.2570.1890.1340.2580.1880.1340.1690.1220.0870.1970.1420.1010.1940.1400.1000.2430.1520.1040.2880.2700.2200.3710.3150.2530.2690.1960.1390.2120.1480.1020.2130.1470.1030.0700.0490.0350.0870.0610.0430.0840.0600.0420.1530.1020.0720.1020.0960.0880.1360.1170.1010.1120.0880.0650.1090.0740.0500.1090.0730.051FZ=probit-1FZ=logit-1FZ=cloglog-1AUC: 0.5AUC: 0.65AUC: 0.8AUC: 0.95255010025501002550100nsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtnsROC jmsnsROC deknsROC psnROCit bn lgtROCit bnpROC boottram clgtram lgttram pbtNCI Method0.100.150.200.250.30CI areaAinesh Sewak, Torsten Hothorn

41

B. Computational details

This section provides R code for ﬁtting transformation models and conducting ROC analysis
for the metabolic syndrome (MetS) application detailed in the paper. We ﬁrst consider the
unconditional performance of waist-to-height ratio (WHtR) as a diagnostic test of MetS.
Next, we examined if the discriminatory ability of WHtR varies with covariates. Finally, we
compare the performance of an alternative diagnostic test for MetS, systolic blood pressure
(SBP). The structure of the code follows the tables and ﬁgures presented in the main text.

B.1. Two-sample analysis

library("tram")
library("rdryad")

### MetS data; doi: 10.5061/dryad.cb51t54
dd <- dryad_files_download(79303)
dat <- read.csv(dd[[1]])
dat$D <- dat$MetS
dat$Y <- dat$WHtR
supp <- with(dat, c(min(Y), max(Y)))
nd <- data.frame(D = c(0,1))
ndD1 <- nd[2,, drop = FALSE]

### Two-sample ROC analysis
### Model with F_Z = logit^{-1}
(m_lgt <- Colr(Y ~ D, data = dat, support = supp))

### ROC curve with 95 percent Wald CI
r <- ROC(m_lgt, newdata = ndD1, conf.level = 0.95)
plot(r)
### Score test
(sc <- score_test(m_lgt, level = 0.95))

### Summary indices and Wald CIs
PI(m_lgt, newdata = ndD1, conf.level = 0.95)
TV(m_lgt, newdata = ndD1, conf.level = 0.95)
OVL(m_lgt, newdata = ndD1, conf.level = 0.95)

### Score CIs for summary indices
PI(sc$conf.int, link = "logistic")
TV(rev(sc$conf.int), link = "logistic")
OVL(sc$conf.int, link = "logistic")

### Modeled densities
grd <- seq(supp[1], supp[2], by=0.001)
dens <- predict(m_lgt, nd, type = "density", q=grd)

42

Transformation models for ROC analysis

plot(grd, dens[,1], type = "l", ylim = c(0, 10),

xlab = "Waist-to-height ratio (WHtR) cm/cm",
ylab = "Density")

lines(grd, dens[,2], lty = 3)
legend("topright", legend=c("No MetS", "MetS"), lty = c(1, 3))

B.2. Conditional ROC analysis

(m_cov <- Colr(Y ~ D * (Age + Gender + Smoke), data = dat, support = supp))

grd_age <- 20:70
nd1 <- expand.grid(D = 1, Age = grd_age, Gender = c(0, 1), Smoke = 0)
nd0 <- expand.grid(D = 0, Age = grd_age, Gender = c(0, 1), Smoke = 0)

### Covariate-specific ROC curve for 40 year old non-smokers
### Solid line: Female, Dashed line: Male
p <- seq(0, 1, by = 0.001)
rcov <- ROC(m_cov,

newdata = subset(nd1, Age == 40),
reference = subset(nd0, Age == 40),
one2one = T, prob = p)

plot(rcov)
### Age-based AUC for non-smokers
### Solid line: Female, Dashed line: Male
auc <- PI(m_cov,

newdata = nd1,
reference = nd0,
one2one = TRUE, conf.level = 0.95)

id_f <- which(nd1$Gender==0)
id_m <- which(nd1$Gender==1)

## Females
plot(grd_age, auc[id_f, "Estimate"],

xlab = "Age (in years)", ylab = "AUC",
ylim = c(0, 1), type = "l")

lines(grd_age, auc[id_f, "lwr"], lty = 3, col = "gray50")
lines(grd_age, auc[id_f, "upr"], lty = 3, col = "gray50")

## Males
lines(grd_age, auc[id_m, "Estimate"], lty = 2)
lines(grd_age, auc[id_m, "lwr"], lty = 3, col = "gray50")
lines(grd_age, auc[id_m, "upr"], lty = 3, col = "gray50")
legend("bottomright", legend = c("Female", "Male"), lty = 1:2, bty = "n")

Ainesh Sewak, Torsten Hothorn

43

B.3. Comparing correlated biomarkers

library("mvtnorm")
dat$Y1 <- dat$WHtR
dat$Y2 <- dat$SBP/250
su <- c(0, 1)
bo <- c(0, Inf)

### Multivariate models
m1 <- BoxCox(Y1 ~ D * (Age + Gender + Smoke),

data = dat, support = su, bounds = bo)

m2 <- BoxCox(Y2 ~ D * (Age + Gender + Smoke),

data = dat, support = su, bounds = bo)

m_comb <- mmlt(m1, m2, formula = ~ 1, data = dat)
S <- coef(m_comb, newdata = dat[1,], type = "Sigma")
cf <- coef(m_comb)
link <- m_comb$marginals[[1]]$model$todistr$name

### Indices
d1idx <- which(names(cf) == "Y1.D")
g1idx <- which(grepl("Y1.D:",names(cf)))
d2idx <- which(names(cf) == "Y2.D")
g2idx <- which(grepl("Y2.D:",names(cf)))

### Covariate effect on the ROC curve
### 40 year old female non-smoker
x <- c(40, 0, 0)
lp1 <- (cf[d1idx] + crossprod(cf[g1idx], x))
lp2 <- (cf[d2idx] + crossprod(cf[g2idx], x)) / sqrt(S$diagonal[2])

### Simulated parameters for 95 percent CIs
V <- vcov(m_comb)
V <- (V + t(V)) / 2
nsim <- 1000
P <- rmvnorm(nsim, mean = cf, sigma = V)
lp1s <- P[,d1idx] + crossprod(t(P[,g1idx]), x)
lp2s <- (P[,d2idx] + crossprod(t(P[,g2idx]), x)) / sqrt(S$diagonal[2])
alpha <- 0.05
qs <- c(alpha/2, 1-alpha/2)
cid1 <- quantile(lp1s, qs)
cid2 <- quantile(lp2s, qs)

### Marginal ROC curves
## WHtR
rm1 <- ROC(lp1, prob = p, link = link)
lwr1 <- ROC(cid1[1], prob = p, link = link)

44

Transformation models for ROC analysis

upr1 <- ROC(cid1[2], prob = p, link = link)

## SBP
rm2 <- ROC(lp2, prob = p, link = link)
lwr2 <- ROC(cid2[1], prob = p, link = link)
upr2 <- ROC(cid2[2], prob = p, link = link)

plot(p, rm1, type = "l",

xlab = "1 - Specificity", ylab = "Sensitivity")

lines(p, lwr1, lty = 3, col = "gray50")
lines(p, upr1, lty = 3, col = "gray50")
lines(p, rm2, lty = 4)
lines(p, lwr2, lty = 3, col = "gray50")
lines(p, upr2, lty = 3, col = "gray50")
legend("bottomright", legend = c("WHtR", "SBP"), lty = c(1, 4), bty = "n")
abline(0, 1, col = "lightgrey")
### Marginal covariate-specific AUCs with 95 percent simulated intervals
## WHtR
(aucm1 <- PI(c(lp1, cid1), link = link))
## SBP
(aucm2 <- PI(c(lp2, cid2), link = link))

### Comparison of correlated covariate-specific AUCs
auc_dff <- PI(lp1, link = link) - PI(lp2, link = link)
dffs <- PI(lp1s, link = link) - PI(lp2s, link = link)
ci_dff <- quantile(dffs, qs)
c(auc_dff, ci_dff)

Aﬃliation:
Ainesh Sewak, Torsten Hothorn
Institut für Epidemiologie, Biostatistik und Prävention
Universität Zürich
Hirschengraben 84, CH-8001 Zürich, Switzerland
Ainesh.Sewak@uzh.ch, Torsten.Hothorn@R-project.org

