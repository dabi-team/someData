Prepared for submission to JINST

Framework and Tools for the Simulation and Analysis of

the Radio Emission from Air Showers at IceCube

D. Z.

R. Abbasi,16 M. Ackermann,60 J. Adams,17 J. A. Aguilar,11 M. Ahlers,21 M. Ahrens,50 J.M.
Alameddine,22 A. A. Alves Jr.,30 N. M. Amin,42 K. Andeen,40 T. Anderson,57 G. Anton,25 C.
Arg√ºelles,13 Y. Ashida,38 S. Axani,14 X. Bai,46 A. Balagopal V.,38 S. W. Barwick,29 B.
Bastian,60 V. Basu,38 S. Baur,11 R. Bay,7 J. J. Beatty,19,20 K.-H. Becker,59 J. Becker Tjus,10 J.
Beise,58 C. Bellenghi,26 S. Benda,38 S. BenZvi,48 D. Berley,18 E. Bernardini,60,ùëé
Besson,33 G. Binder,7,8 D. Bindig,59 E. Blaufuss,18 S. Blot,60 M. Boddenberg,0 F.
Bontempo,30 J. Y. Book,13 J. Borowka,0 S. B√∂ser,39 O. Botner,58 J. B√∂ttcher,0 E. Bourbeau,21
F. Bradascio,60 J. Braun,38 B. Brinson,5 S. Bron,27 J. Brostean-Kaiser,60 R. T. Burley,1 R. S.
Busse,41 M. A. Campana,45 E. G. Carnie-Bronca,1 C. Chen,5 Z. Chen,51 D. Chirkin,38 K.
Choi,52 B. A. Clark,23 K. Clark,32 L. Classen,41 A. Coleman,42 G. H. Collin,14 J. M. Conrad,14 P.
Coppin,12 P. Correa,12 D. F. Cowen,56,57 R. Cross,48 C. Dappen,0 P. Dave,5 C. De Clercq,12 J.
J. DeLaunay,55 D. Delgado L√≥pez,13 H. Dembinski,42 K. Deoskar,50 A. Desai,38 P. Desiati,38 K.
D. de Vries,12 G. de Wasseige,35 M. de With,9 T. DeYoung,23 A. Diaz,14 J. C. D√≠az-V√©lez,38 M.
Dittmer,41 H. Dujmovic,30 M. Dunkman,57 M. A. DuVernois,38 T. Ehrhardt,39 P. Eller,26 R.
Engel,30,31 H. Erpenbeck,0 J. Evans,18 P. A. Evenson,42 K. L. Fan,18 A. R. Fazely,6 A.
Fedynitch,54 N. Feigl,9 S. Fiedlschuster,25 A. T. Fienberg,57 C. Finley,50 L. Fischer,60 D. Fox,56
A. Franckowiak,10,60 E. Friedman,18 A. Fritz,39 P. F√ºrst,0 T. K. Gaisser,42 J. Gallagher,37 E.
Ganster,0 A. Garcia,13 S. Garrappa,60 L. Gerhardt,8 A. Ghadimi,55 C. Glaser,58 T. Glauch,26 T.
Gl√ºsenkamp,25 N. Goehlke,31 J. G. Gonzalez,42 S. Goswami,55 D. Grant,23 T. Gr√©goire,57 S.
Griswold,48 C. G√ºnther,0 P. Gutjahr,22 C. Haack,26 A. Hallgren,58 R. Halliday,23 L. Halve,0 F.
Halzen,38 M. Ha Minh,26 K. Hanson,38 J. Hardin,38 A. A. Harnisch,23 A. Haungs,30 D.
Hebecker,9 K. Helbing,59 F. Henningsen,26 E. C. Hettinger,23 S. Hickford,59 J. Hignight,24 C.
Hill,15 G. C. Hill,1 K. D. HoÔ¨Äman,18 K. Hoshina,38,ùëè
Huber,30 K. Hultqvist,50 M. H√ºnnefeld,22 R. Hussain,38 K. Hymon,22 S. In,52 N. Iovine,11 A.
Ishihara,15 M. Jansson,50 G. S. Japaridze,4 M. Jeong,52 M. Jin,13 B. J. P. Jones,3 D. Kang,30
W. Kang,52 X. Kang,45 A. Kappes,41 D. Kappesser,39 L. Kardum,22 T. Karg,60 M. Karl,26 A.
Karle,38 U. Katz,25 M. Kauer,38 M. Kellermann,0 J. L. Kelley,38 A. Kheirandish,57 K. Kin,15 T.
Kintscher,60 J. Kiryluk,51 S. R. Klein,7,8 A. Kochocki,23 R. Koirala,42 H. Kolanoski,9 T.
Kontrimas,26 L. K√∂pke,39 C. Kopper,23 S. Kopper,55 D. J. Koskinen,21 P. Koundal,30 M.
Kovacevich,45 M. Kowalski,9,60 T. Kozynets,21 E. Krupczak,23 E. Kun,10 N. Kurahashi,45 N.
Lad,60 C. Lagunas Gualda,60 J. L. Lanfranchi,57 M. J. Larson,18 F. Lauber,59 J. P. Lazar,13,38 J.
W. Lee,52 K. Leonard,38 A. Leszczy≈Ñska,42 Y. Li,57 M. Lincetto,10 Q. R. Liu,38 M. Liubarska,24
E. LohÔ¨Ånk,39 C. J. Lozano Mariscal,41 L. Lu,38 F. Lucarelli,27 A. Ludwig,23,34 W. Luszczak,38 Y.
Lyu,7,8 W. Y. Ma,60 J. Madsen,38 K. B. M. Mahn,23 Y. Makino,38 S. Mancina,38 I. C. Mari≈ü,11 I.

W. Hou,30 F. Huang,57 M. Huber,26 T.

2
2
0
2

y
a
M
4

]
E
H
.
h
p
-
o
r
t
s
a
[

1
v
8
5
2
2
0
.
5
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
Martinez-Soler,13 R. Maruyama,43 S. McCarthy,38 T. McElroy,24 F. McNally,36 J. V. Mead,21 K.
Meagher,38 S. Mechbal,60 A. Medina,20 M. Meier,15 S. Meighen-Berger,26 J. Micallef,23 D.
Mockler,11 T. Montaruli,27 R. W. Moore,24 R. Morse,38 M. Moulai,14 T. Mukherjee,30 R. Naab,60
R. Nagai,15 U. Naumann,59 J. Necker,60 L. V. Nguy Àú√™n,23 H. Niederhausen,23 M. U. Nisa,23 S. C.
Nowicki,23 A. Obertacke Pollmann,59 M. Oehler,30 B. Oeyen,28 A. Olivas,18 E. O‚ÄôSullivan,58 H.
Pandya,42 D. V. Pankova,57 N. Park,32 G. K. Parker,3 E. N. Paudel,42 L. Paul,40 C. P√©rez de los
Heros,58 L. Peters,0 J. Peterson,38 S. Philippen,0 S. Pieper,59 A. Pizzuto,38 M. Plum,46 Y.
Popovych,39 A. Porcelli,28 M. Prado Rodriguez,38 B. Pries,23 G. T. Przybylski,8 C. Raab,11 J.
Rack-Helleis,39 A. Raissi,17 M. Rameez,21 K. Rawlins,2 I. C. Rea,26 Z. Rechav,38 A. Rehman,42
P. Reichherzer,10 R. Reimann,0 G. Renzi,11 E. Resconi,26 S. Reusch,60 W. Rhode,22 M.
Richman,45 B. Riedel,38 E. J. Roberts,1 S. Robertson,7,8 G. RoellinghoÔ¨Ä,52 M. Rongen,39 C.
Rott,49,52 T. Ruhe,22 D. Ryckbosch,28 D. Rysewyk Cantu,23 I. Safa,13,38 J. SaÔ¨Äer,31 P.
Sampathkumar,30 S. E. Sanchez Herrera,23 A. Sandrock,22 M. Santander,55 S. Sarkar,24 S.
Sarkar,44 K. Satalecka,60 M. Schaufel,0 H. Schieler,30 S. Schindler,25 T. Schmidt,18 A.
Schneider,38 J. Schneider,25 F. G. Schr√∂der,30,42 L. Schumacher,26 G. Schwefer,0 S.
Sclafani,45 D. Seckel,42 S. Seunarine,47 A. Sharma,58 S. Shefali,31 N. Shimizu,15 M. Silva,38 B.
Skrzypek,13 B. Smithers,3 R. Snihur,38 J. Soedingrekso,22 D. Soldin,42 C. Spannfellner,26 G.
M. Spiczak,47 C. Spiering,60 J. Stachurska,60 M. Stamatikos,20 T. Stanev,42 R. Stein,60 J.
Stettner,0 T. Stezelberger,8 T. St√ºrwald,59 T. Stuttard,21 G. W. Sullivan,18 I. Taboada,5 S.
Ter-Antonyan,6 J. Thwaites,38 S. Tilav,42 F. Tischbein,0 K. Tollefson,23 C. T√∂nnis,53 S.
Toscano,11 D. Tosi,38 A. Trettin,60 M. Tselengidou,25 C. F. Tung,5 A. Turcati,26 R. Turcotte,30 C.
F. Turley,57 J. P. Twagirayezu,23 B. Ty,38 M. A. Unland Elorrieta,41 N. Valtonen-Mattila,58 J.
Vandenbroucke,38 N. van Eijndhoven,12 D. Vannerom,14 J. van Santen,60 J.
Veitch-Michaelis,38 S. Verpoest,28 C. Walck,50 W. Wang,38 T. B. Watson,3 C. Weaver,23 P.
Weigel,14 A. Weindl,30 M. J. Weiss,57 J. Weldert,39 C. Wendt,38 J. Werthebach,22 M.
Weyrauch,30 N. Whitehorn,23,34 C. H. Wiebusch,0 N. Willey,23 D. R. Williams,55 M. Wolf,38 G.
Wrede,25 J. WulÔ¨Ä,10 X. W. Xu,6 J. P. Yanez,24 E. Yildizci,38 S. Yoshida,15 S. Yu,23 T. Yuan,38 Z.
Zhang,51 and P. Zhelnin13

0III. Physikalisches Institut, RWTH Aachen University, D-52056 Aachen, Germany
1Department of Physics, University of Adelaide, Adelaide, 5005, Australia
2Dept. of Physics and Astronomy, University of Alaska Anchorage, 3211 Providence Dr., Anchorage, AK
99508, USA
3Dept. of Physics, University of Texas at Arlington, 502 Yates St., Science Hall Rm 108, Box 19059,
Arlington, TX 76019, USA
4CTSPS, Clark-Atlanta University, Atlanta, GA 30314, USA
5School of Physics and Center for Relativistic Astrophysics, Georgia Institute of Technology, Atlanta, GA
30332, USA
6Dept. of Physics, Southern University, Baton Rouge, LA 70813, USA
7Dept. of Physics, University of California, Berkeley, CA 94720, USA
8Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA
9Institut f√ºr Physik, Humboldt-Universit√§t zu Berlin, D-12489 Berlin, Germany
10Fakult√§t f√ºr Physik & Astronomie, Ruhr-Universit√§t Bochum, D-44780 Bochum, Germany
11Universit√© Libre de Bruxelles, Science Faculty CP230, B-1050 Brussels, Belgium

12Vrƒ≥e Universiteit Brussel (VUB), Dienst ELEM, B-1050 Brussels, Belgium
13Department of Physics and Laboratory for Particle Physics and Cosmology, Harvard University, Cam-

bridge, MA 02138, USA

14Dept. of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139, USA
15Dept. of Physics and The International Center for Hadron Astrophysics, Chiba University, Chiba 263-8522,

Japan

16Department of Physics, Loyola University Chicago, Chicago, IL 60660, USA
17Dept. of Physics and Astronomy, University of Canterbury, Private Bag 4800, Christchurch, New Zealand
18Dept. of Physics, University of Maryland, College Park, MD 20742, USA
19Dept. of Astronomy, Ohio State University, Columbus, OH 43210, USA
20Dept. of Physics and Center for Cosmology and Astro-Particle Physics, Ohio State University, Columbus,

OH 43210, USA

21Niels Bohr Institute, University of Copenhagen, DK-2100 Copenhagen, Denmark
22Dept. of Physics, TU Dortmund University, D-44221 Dortmund, Germany
23Dept. of Physics and Astronomy, Michigan State University, East Lansing, MI 48824, USA
24Dept. of Physics, University of Alberta, Edmonton, Alberta, Canada T6G 2E1
25Erlangen Centre for Astroparticle Physics, Friedrich-Alexander-Universit√§t Erlangen-N√ºrnberg, D-91058

Erlangen, Germany

26Physik-department, Technische Universit√§t M√ºnchen, D-85748 Garching, Germany
27D√©partement de physique nucl√©aire et corpusculaire, Universit√© de Gen√®ve, CH-1211 Gen√®ve, Switzerland
28Dept. of Physics and Astronomy, University of Gent, B-9000 Gent, Belgium
29Dept. of Physics and Astronomy, University of California, Irvine, CA 92697, USA
30Karlsruhe Institute of Technology, Institute for Astroparticle Physics, D-76021 Karlsruhe, Germany
31Karlsruhe Institute of Technology, Institute of Experimental Particle Physics, D-76021 Karlsruhe, Germany
32Dept. of Physics, Engineering Physics, and Astronomy, Queen‚Äôs University, Kingston, ON K7L 3N6,

Canada

33Dept. of Physics and Astronomy, University of Kansas, Lawrence, KS 66045, USA
34Department of Physics and Astronomy, UCLA, Los Angeles, CA 90095, USA
35Centre for Cosmology, Particle Physics and Phenomenology - CP3, Universit√© catholique de Louvain,

Louvain-la-Neuve, Belgium

36Department of Physics, Mercer University, Macon, GA 31207-0001, USA
37Dept. of Astronomy, University of Wisconsin‚ÄìMadison, Madison, WI 53706, USA
38Dept. of Physics and Wisconsin IceCube Particle Astrophysics Center, University of Wisconsin‚ÄìMadison,

Madison, WI 53706, USA

39Institute of Physics, University of Mainz, Staudinger Weg 7, D-55099 Mainz, Germany
40Department of Physics, Marquette University, Milwaukee, WI, 53201, USA
41Institut f√ºr Kernphysik, Westf√§lische Wilhelms-Universit√§t M√ºnster, D-48149 M√ºnster, Germany
42Bartol Research Institute and Dept. of Physics and Astronomy, University of Delaware, Newark, DE 19716,

USA

43Dept. of Physics, Yale University, New Haven, CT 06520, USA
44Dept. of Physics, University of Oxford, Parks Road, Oxford OX1 3PU, UK
45Dept. of Physics, Drexel University, 3141 Chestnut Street, Philadelphia, PA 19104, USA
46Physics Department, South Dakota School of Mines and Technology, Rapid City, SD 57701, USA
47Dept. of Physics, University of Wisconsin, River Falls, WI 54022, USA

48Dept. of Physics and Astronomy, University of Rochester, Rochester, NY 14627, USA
49Department of Physics and Astronomy, University of Utah, Salt Lake City, UT 84112, USA
50Oskar Klein Centre and Dept. of Physics, Stockholm University, SE-10691 Stockholm, Sweden
51Dept. of Physics and Astronomy, Stony Brook University, Stony Brook, NY 11794-3800, USA
52Dept. of Physics, Sungkyunkwan University, Suwon 16419, Korea
53Institute of Basic Science, Sungkyunkwan University, Suwon 16419, Korea
54Institute of Physics, Academia Sinica, Taipei, 11529, Taiwan
55Dept. of Physics and Astronomy, University of Alabama, Tuscaloosa, AL 35487, USA
56Dept. of Astronomy and Astrophysics, Pennsylvania State University, University Park, PA 16802, USA
57Dept. of Physics, Pennsylvania State University, University Park, PA 16802, USA
58Dept. of Physics and Astronomy, Uppsala University, Box 516, S-75120 Uppsala, Sweden
59Dept. of Physics, University of Wuppertal, D-42119 Wuppertal, Germany
60DESY, D-15738 Zeuthen, Germany
ùëéalso at Universit√† di Padova, I-35131 Padova, Italy
ùëèalso at Earthquake Research Institute, University of Tokyo, Bunkyo, Tokyo 113-0032, Japan

E-mail: analysis@icecube.wisc.edu

‚Äì 1 ‚Äì

Abstract: The Surface Enhancement of the IceTop air-shower array will include the addition of
radio antennas and scintillator panels, co-located with the existing ice-Cherenkov tanks and covering
an area of about 1 km2. Together, these will increase the sensitivity of the IceCube Neutrino
Observatory to the electromagnetic and muonic components of cosmic-ray-induced air showers at
the South Pole. The inclusion of the radio technique necessitates an expanded set of simulation and
analysis tools to explore the radio-frequency emission from air showers in the 70 MHz to 350 MHz
band. In this paper we describe the software modules that have been developed to work with time-
and frequency-domain information within IceCube‚Äôs existing software framework, IceTray, which
is used by the entire IceCube collaboration. The software includes a method by which air-shower
simulation, generated using CoREAS, can be reused via waveform interpolation, thus overcoming
a signiÔ¨Åcant computational hurdle in the Ô¨Åeld.

Keywords: Air showers, radio frequency, simulation, cosmic rays

1

Introduction

Cosmic rays with energies above 1 PeV are studied using large (1 km2 to 1000 km2), sparse arrays
of detectors on the ground that observe the air showers that are produced in the interactions of the
primary cosmic rays with nuclei in Earth‚Äôs atmosphere, rather than directly observing the primary
particle. A major design consideration of current and future air-shower arrays includes the ability
to directly measure the size of the electromagnetic and hadronic cascades for individual events.
A modern approach to do this involves combining various detector types to make complimentary
measurements of the same air shower.

Radio antennas have proven to be particularly useful in this pursuit as they are a relatively
cost-eÔ¨Äective technology that can be used to make an accurate measurement of the development
and size of the electromagnetic content in air showers [1‚Äì3]. Likewise, measurements of muons in
air showers have been performed using particle detectors at cosmic ray observatories [4‚Äì9]. The
combined knowledge of the electromagnetic and hadronic content in individual air showers can be
used to provide a more accurate estimate of the mass and energy of the primary [10, 11].

The IceTop Surface Enhancement [12] will feature 32 stations, each consisting of three SKALA-
v2 antennas [13] and eight 1.5 m2 scintillator panels [14]. The instrumentation will be installed
within the footprint of IceTop, the existing 1 km2 array of ice Cherenkov detectors, located at the
South Pole [15]. Triggered by the scintillator panels, the antennas will be used to measure the
atmospheric depth at which the electromagnetic content of an air shower reaches a maximum, ùëãmax,
and to make a calorimetric measurement of the energy content of the electromagnetic cascades.
The radio emission from air showers is a result of two eÔ¨Äects, the dominant geomagnetic eÔ¨Äect
and the subdominant Askaryan eÔ¨Äect [16]. The former arises when the positrons and electrons are
deÔ¨Çected oppositely by the Lorentz force in the Earth‚Äôs magnetic Ô¨Åeld while the latter is due to the
gradual buildup of a net negative charge in the shower front during development. This radiation will
be sampled in the 70 MHz‚Äì350 MHz band and read out with 1 ns resolution, ampliÔ¨Åed and digitized
locally at each station, and then sent to a centralized location for analysis. The information about
the electromagnetic content will be combined with the observations from the scintillator panels and
ice-Cherenkov tanks on the surface as well as with the measurements of > 300 GeV muons by the

‚Äì 2 ‚Äì

optical sensors that comprise the in-ice detectors of the IceCube Neutrino Observatory [17]. The
addition of such information will make IceCube an essential experiment for studying the highest
energy Galactic cosmic rays thanks to its capability to obtain a more complete picture of the particle
content and development of individual air showers.

The inclusion of additional air-shower detection methods to IceCube requires the development
of suitable software tools that can handle multi-detector simulations and reconstructions. The
current analysis framework used by the collaboration, IceTray [18], has been successful for the
analysis of neutrino and cosmic ray observations using the existing surface and in-ice detectors. In
this paper we focus on the proposed radio extension, and to take full advantage of the capabilities
that this addition brings, the IceTray framework has been extended for the analysis of the radio
frequency (RF) information that will be recorded by the antennas on the surface of the ice at the
South Pole.1 We brieÔ¨Çy describe the existing analysis framework and detail the implementation
of tools for the end-to-end simulation of the response of the antennas/hardware and the analysis of
time- and frequency-domain information in section 2.

As part of the standard simulation chain for radio events, we developed a method to re-use air
shower simulations produced by the CoREAS [20] extension of CORSIKA [21]. Via this method,
the radio emission, as given by CoREAS, is directly interpolated to produce the expected waveform
at any other point in the radio footprint. This technique can save orders of magnitude in total
computing time when producing a library of simulated air showers and is described in section 3.

2 Framework for Simulation and Analysis

The general-purpose simulation and analysis framework developed by the IceCube Collaboration,
IceTray, has been used to perform physics analyses on the data collected by the digital optical
modules that comprise the photo-sensitive elements of the in-ice and surface components of the
observatory [17]. The framework includes the Ô¨Çexibility to perform analyses that require the
simultaneous measurements of air showers by the two distinct components of the observatory [22‚Äì
24]. The extension includes the data structures, analysis tools, relevant readers/writers, etc. for the
analysis of an antenna array and naturally Ô¨Åts within this framework.

In this section, we brieÔ¨Çy describe the design and philosophy of IceTray and the extension for
analysis of RF information in section 2.1. We then detail the modular tools that have been developed
for simulation and analysis of the array of surface antennas in section 2.2. Finally, in section 2.3
we describe the method by which the end-to-end simulation is performed, including the response
of all the readout components.

2.1 Extension of the IceTray Design

A key feature of the IceTray framework is the lack of a rigid, predeÔ¨Åned data structure. Instead,
relevant pieces of data are stored in frames. Each frame contains a snapshot of the status of the
observatory (detector locations and orientation, calibration information, etc.), the data read out from
an observed/simulated event, and/or analysis information (e.g. reconstruction variables). These
generally correspond to a triggered readout of the relevant detectors. The frame is implemented

1For information about the simulation techniques for the scintillator panels, see [19].

‚Äì 3 ‚Äì

Figure 1. The radio information is stored as a series of nested C++ maps (represented by the blue/gold
boxes). The outer map (blue) contains one entry for each antenna, while the inner maps (gold) contain an
entry for each waveform associated with that antenna. The waveform information are stored in a format
which facilitates the conversion to/from the Fourier domain (see text).

as a C++ hash table, which allows for any number of pieces of data to be stored inside without
specifying the data-type or how many pieces/types of data might be required by a user. This allows
for Ô¨Çexibility when designing an analysis, but, more relevant to this paper, also makes the framework
easily extendable for handling RF information.

A critical extension for processing RF information is the representation of time-domain wave-
forms in the frequency domain. For this, we implemented a data structure, which internally handles
all discrete Fourier transformations, keeping track of the domain in which the data is most up to date
and only requesting a transformation be performed when necessary. This is particularly important
in a module-based framework (see section 2.2) where an analyzer may not know in which domain
time or Fourier) the information has been altered most recently by a particular algorithm.
(i.e.
Such an approach has been extensively used in the RF analysis code by other astroparticle exper-
iments [25, 26]. The underlying fast Fourier transformation (FFT) algorithm is handled by the
open-source library, Fastest Fourier Transform in the West (FFTW3) [27]. This library includes an
optimization of the speciÔ¨Åc transformation algorithm based on the length of the waveform. Two
representations have been implemented for this data structure for use with 1D and 3D waveforms,
typically used to represent the time series of voltages and electric Ô¨Åeld vectors, respectively.

To store RF waveform information, a speciÔ¨Åc class has been added that includes association
between the antenna, its orthogonal arms (corresponding to two diÔ¨Äerent channels), and the cor-
responding waveforms. Two nested C++ maps hold the information for the radio array, shown
schematically on the left side of Ô¨Ågure 1. Each antenna has an entry containing a map with all
of the read-out information from the corresponding channels. This map structure was chosen for
Ô¨Çexibility so as to allow for future additions/modiÔ¨Åcations to the array, and the possibility to include
antennas with more than two channels. As with the rest of the IceTray framework, the same data
structures are used for simulated and observed data so that each analysis can be developed on the
former and directly applied to the latter.

The IceTray framework already includes tools for reading and writing the information contained

‚Äì 4 ‚Äì

within the frames [18]. A custom binary Ô¨Åle structure has been developed by the collaboration
for (de)serialization of the frames. The code also includes methods by which data can be written
in common, open-source formats, such as hdf5 [28] and ROOT [29]. The radio data structures,
described above, have been integrated into these operations. Additionally, a reader for CoREAS
simulation output has been developed to parse the electric Ô¨Åeld information and relevant air shower
properties.

2.2 Modular Design within IceTray

IceTray was designed with the intent for modular processing of observed and simulated data. Within
this framework, individual modules are used to perform a speciÔ¨Åc, limited calculation/manipulation
of the data. To perform an analysis, the analyzer simply adds the relevant modules to a sequential
list, called a tray. Each module then runs, in the order that they were added to the tray, on each
frame. Some modules are shared across the collaboration, for instance, the ones that propagate
simulated leptons through the ice or those that accept/reject speciÔ¨Åc detectors in a particular event.
New shared modules have been developed to allow for the simulation and analysis of RF information
for the radio antennas of the surface array.

As an extension to the tools to parse air-shower simulation output from CORSIKA, a module
that also reads the corresponding CoREAS output has been included. This reader works as a
stand-alone procedure or in tandem with the previously-existing CORSIKA parser that is used for
injecting secondary particles when simulating the response of the optical sensors and scintillator
panels. This is a crucial step to simulate the response of the entire observatory for a single generated
air shower; see section 2.3.

Several tools to perform commonly used calculations for time- and frequency-domain infor-

mation are also included. These tools enable an analyzer to

1. facilitate the up- and down-sampling of waveforms to a user-speciÔ¨Åed sampling rate;

2. apply a band-pass Ô¨Ålter for a desired transfer functions such as a box (top-hat in Fourier space)

and Butterworth [30];

3. apply a phase gradient in Fourier space to produce a cyclic shift in the time-domain waveform.

The inclusion of noise is particularly important in an RF analysis as it often sets the limit on
the energy threshold and/or precision of an analysis. For this purpose, two modules have been
written. The Ô¨Årst generates uncorrelated noise and adds it to waveforms. The dominant source of
RF noise at the South Pole is due to the emission from Galactic and extragalactic sources and is
incorporated into the code using the Cane model of the brightness, ùêµCane( ùëì ) [31]. Uncorrelated
noise is generated by Ô¨Årst calculating the eÔ¨Äective temperature,

ùëáCane( ùëì ) =

ùúÜ2
2ùëò ùëè

ùêµCane( ùëì ).

The rms voltage for each frequency mode, ùëìùëñ, is then given by,

ùëârms( ùëìùëñ) =

‚àöÔ∏Ç ùëç ùëò ùëè ùëáCane( ùëìùëñ) ùê¥eÔ¨Ä Œî ùëì
2

,

(2.1)

(2.2)

‚Äì 5 ‚Äì

Figure 2. The end-to-end simulation chain for impinging electric Ô¨Åelds, ùê∏, includes the simulation of the
several components. This includes the vector eÔ¨Äective length of the antenna, L, the low-noise ampliÔ¨Åer
(LNA), the cables, readout hardware, and the digitizer. The symbol (cid:203) indicates where the complex-valued
frequency-domain responses are included via a convolution.

where ùëò ùëè is the Boltzmann constant, ùëç is the impedance of the system, ùê¥eÔ¨Ä is the integrated
eÔ¨Äective area, and Œî ùëì is the width of one frequency bin. Additional Johnson-Nyquist noise [32],
with noise-temperature, ùëá, can be added at each step in the processing chain, if desired,

ùëârms( ùëìùëñ) = ‚àöÔ∏Åùëç ùëò ùëè ùëá Œî ùëì ,

(2.3)

For both types of noise, the voltage amplitudes, ùëârms( ùëìùëñ), are given a random phase and then
transformed back into the time domain to produce incoherent, uncorrelated noise in the time
domain. The second module for generating noise directly adds waveforms of measured background
in the time domain. This process uses snapshots of the local background using a Ô¨Åxed-rate trigger
and can thus produce more realistic noise, which, in general, includes all the naturally occurring
correlation between frequency modes and across antennas.

The Ô¨Ånal set of modules is used to (de)convolve the waveforms with the response functions
of the antenna and the read-out electronics. Two modules are also included that convert from/to
electric Ô¨Åelds to voltages, respectively, using the antenna response (see next section). Likewise, the
(un)folding of the response functions of the ampliÔ¨Åers, cables, and digitizers are handled by two
dedicated modules. All the response functions are loaded into memory as singleton objects, which
can be queried by the modules during run-time, as several modules may require access to the same
response function. Further details on the method used to include these response functions will be
given in the next section.

2.3 Simulation of the End-to-End Response

For a full simulation of the detector response, the gains and phases as a function of frequency must
be taken into account for the deployed hardware. In this section, we describe the method by which
each of the detector components are included to perform an end-to-end simulation of a radio event,
shown schematically in Ô¨Ågure 2.

The vector eÔ¨Äective length, (cid:174)L, of the SKALA-v2 antennas was simulated using CST Studio
Suite [33] to produce a table of the gain pattern and phase as a function of frequency and arrival
direction in spherical coordinates, (cid:174)L ( ùëì , ùúÉ, ùúô). This was done in steps of 1 MHz in frequency for
50 MHz‚Äì350 MHz and steps of 1‚ó¶ in arrival direction.
If needed, the values between those in
the table are interpolated separately for the phase and the logarithm of the gain using bicubic-
interpolation.

The voltage produced in an antenna from an impinging electric Ô¨Åeld, (cid:174)ùê∏, is calculated in the
Fourier domain using ùëâ ( ùëì ) = (cid:174)L ( ùëì , ùúÉ, ùúô) ¬∑ (cid:174)ùê∏ ( ùëì ). Note here that the relevant ùúÉ and ùúô are those of the

‚Äì 6 ‚Äì

Figure 3. The power gain of the LNA (blue) as well as the cables (gold) and readout electronics (red)
are shown. The combined response is indicated in black. The gains of the LNA and the total have been
shifted by ‚àí40 dB for visual clarity. The grey band indicates the nominal frequency band of the system,
70 MHz‚Äì350 MHz.

Poynting vector, which are approximated using the propagation direction of the primary particle,
accurate to (cid:39) 1‚ó¶ [34].

The remaining electronics are then included in a similar way, using interpolations of look-up
tables for the corresponding gains and phases. The response table for the low-noise ampliÔ¨Åer
(LNA) has been simulated using AWR Design Environment [35] and includes a roughly 40 dB gain
as shown in Ô¨Ågure 3. The response of the 50 m LMR400 coaxial cables has been measured directly
in the lab as a function of temperature [36]. Finally, the combined response of the signal pre-
processing board, RadioTad v1, and data acquisition module (TAXI v3.0) have also been measured
in the lab [14]. The combined gain pattern of the electronics, shown in Ô¨Ågure 3, results in a nominal
frequency band for the system of 70 MHz‚Äì350 MHz. The complex-valued responses, ùëÖ( ùëì ), are
incorporated in the Fourier domain via a multiplication, ùëâ (cid:48)( ùëì ) = ùëÖ( ùëì ) √ó ùëâ ( ùëì ), equivalent to a
convolution of the time-domain waveforms, ùëâ (ùë°).

The Ô¨Ånal step of the end-to-end simulation, digitization, is the only operation performed in the
time domain. Here, the real-valued voltages are truncated to an integer corresponding to the 14-bit
analog-to-digital converter (1 Vpp) on the TAXI board.

If desired, simulated noise can be added to the voltage waveforms at any step(s) in the ampliÔ¨Å-
cation chain. Otherwise, measured waveforms, which inherently include all the hardware responses,
can be added directly after the digitization step.

An example of the end-to-end simulation at three points during the processing are shown
in Ô¨Ågure 4. The left/right columns show the time series and corresponding frequency spectrum,
respectively. The top row includes the components of the electric Ô¨Åeld, transformed into the local
geographic coordinate system. The middle and bottom plots show the voltages after being convolved
with the antenna response and the readout electronics (before digitization), respectively.

‚Äì 7 ‚Äì

0100200300400500Frequency / MHz15.012.510.07.55.02.50.02.55.0Gain (dB)LNA -40dBLMR400 Cables (50m)RadioTad v1 & TAXI v3.0Total Response -40dBFigure 4. The time series (left) and frequency spectra (right) are shown for three steps of the end-to-end
processing of an electric Ô¨Åeld to a voltage. The top plots represent the raw electric Ô¨Åeld in the north, west,
and vertical directions. The middle plots show the voltage produced in the channels of the crossed-dipole
SKALA-v2 antenna. The bottom plot is again the same after convolving the response of the electronics
described in section 2.3.

3

Interpolation of CoREAS Simulations

The goal of the IceTop Surface Enhancement is to simultaneously measure air showers using various
detection methods to disentangle the muonic and electromagnetic content and ultimately improve the
estimation of the energy and mass of the primary particle. To simulate the combined response of the
multi-detector design, we generate CORSIKA/CoREAS simulations that simultaneously output the
secondary particle content on the ground and the radio emission. A major computational challenge
in the analysis of any radio array is the order of magnitude increase in additional computation time
to generate a single air shower simulation including radio emission.

The radio emission calculated in CoREAS uses the endpoint formalism in which the electric
Ô¨Åeld that is generated by all the particles in an air shower is determined iteratively over many
small steps [37, 38]. This must be calculated for each particle at each step steps for some number

‚Äì 8 ‚Äì

180200220240260280300320340Time / ns42024Amplitude / (mV/m)Simulated E-FieldGrid WGrid NVertical0100200300400500Frequency / MHz175170165160Amplitude (dBm Hz)Grid WGrid NVertical100150200250300350Time / ns0.30.20.10.00.10.20.3Amplitude / mVSignal in AntennaChannel 1Channel 20100200300400500Frequency / MHz210200190180170160Amplitude (dBm Hz)Channel 1Channel 2200250300350400450Time / ns201001020Amplitude / mVFolded with ElectronicsChannel 1Channel 20100200300400500Frequency / MHz180160140120Amplitude (dBm Hz)Channel 1Channel 2of locations in space, {(cid:174)ùëüant,ùëñ }, which must be speciÔ¨Åed before beginning the CORSIKA/CoREAS
simulation. This has two main consequences. Whereas a pure CORSIKA simulation, with the
radio emission turned oÔ¨Ä, can take tens of minutes for a 30 PeV air shower on current hardware,
the inclusion of the radio calculation can take tens of hours and scales with the number of {(cid:174)ùëüant,ùëñ }.
Furthermore, the practice of resampling, wherein the particles of a single air shower are injected into
the detectors several times for diÔ¨Äerent core locations, is generally not possible since the detector
locations, with respect to the shower axis, have already been chosen. We present a method that
allows for the calculation of the expected waveform at an arbitrary point in the shower footprint by
interpolating existing simulations where the electric Ô¨Åelds are generated on a pre-deÔ¨Åned pattern of
locations.

Previous attempts have been made to use a star-shaped grid to estimate the scalar quantities
describing the emission in the radio band [39]. More recent attempts have included simulating the
emission on such a grid and predicting the electric Ô¨Åeld waveforms at oÔ¨Ä-grid locations in space
based on a semi-analytical model of the radio emission process [40]. During the development
of this work, a waveform interpolation technique, similar to the one described below, has been
explored in [41]. We note that the technique described there is not generally applicable for our
use case as it assumes that ùëãmax can be treated as a point source. However, at the South Pole,
cosmic-ray primaries with energies above ‚àº 1017 eV will regularly initiate air showers with an ùëãmax
that is below the surface of the ice (altitude of 2840 m a.s.l.) [42‚Äì44].

In this section, we describe a method by which the electric Ô¨Åelds that are calculated by CoREAS
can be interpolated. In doing so, the location of the electric Ô¨Åeld at any point in the radio footprint
can be determined, thus allowing for the resampling of the radio emission from air showers and
also allowing template-based reconstruction techniques. This method is thus a major component of
the simulation chain of the antenna array and is also directly applicable to other experiments that
detect air showers via the radio technique.

3.1 Simulation on a Star-shaped Pattern

The choice of pattern to use for the interpolation method is based on the symmetries of the radio
emission in air showers. The geomagnetic emission is linearly polarized along the Lorentz force,
the (cid:174)ùë£ √ó (cid:174)ùêµ direction, where ÀÜùë£ is the direction of shower propagation and (cid:174)ùêµ is the Earth‚Äôs magnetic
Ô¨Åeld. The Askaryan emission is radially polarized with respect to the shower axis. Depending on
the polar angle about the shower axis, the interference of these two processes produces a net electric
Ô¨Åeld that is not cylindrically symmetric. Further, the coherent emission that is produced by the
relativistic secondary particles generally can result in a Cherenkov ring on the ground [45]. As a
result, the electric Ô¨Åeld strength does not change monotonically with distance from the shower axis.
To ensure that all of these features can be replicated properly, we chose a pattern of interpolation
points in the shape of a star, with eight spokes that point radially outward from the shower axis,
see Ô¨Ågure 5. Because of the polarization directions of the Askaryan and geomagnetic processes,
there is a preferred orientation to analyze the total electric Ô¨Åeld emission. For a given radius, the
maximum emission will be where the interference is constructive and with a minimum where it is
destructive, on the positive and negative (cid:174)ùë£ √ó (cid:174)ùêµ sides of the shower axis, respectively. It is important
to ensure that both extrema are included in the sampling points that will be used for interpolation.

‚Äì 9 ‚Äì

Figure 5. Left: Locations of the simulated electric Ô¨Åelds along the star-pattern (blue crosses) and test
locations based on the planned array of antennas (red) in the local coordinate system at the South Pole. The
projected direction of the local magnetic Ô¨Åeld is shown. Right: The same locations shown in the shower
coordinate system with one axis along the direction of the Lorentz force.

For this reason, two of the arms of the star are always parallel to the (cid:174)ùë£ √ó (cid:174)ùêµ axis, as shown in the
right panel of Ô¨Ågure 5.

To develop and test the interpolation method, we created a library of simulated air showers
using CORSIKA v7.7401 with the CoREAS radio extension. We used proton and iron as primary
particles and SIBYLL2.3d/FLUKA [46, 47] as the high/low energy hadronic interaction models.
The magnetic Ô¨Åeld corresponding to the South Pole, 54.6 ¬µT with a 17.8‚ó¶ zenith angle [48], was
used along with the average April South Pole atmosphere.2 Discrete zenith angles were chosen in
steps of 5‚ó¶ from 0‚ó¶ to 65‚ó¶ whereas azimuth angles were chosen randomly. For the veriÔ¨Åcation of
this method, we used simulations with a primary energy of 100 PeV.

The electric Ô¨Åeld waveforms were generated using CoREAS with 0.2 ns sampling for two sets
of locations, simultaneously. The Ô¨Årst set of points were chosen according to the layout of the
antennas that will be deployed as part of the IceTop Surface Enhancement [12]. The second set of
points were chosen along the eight spokes of the star, equally spaced around the shower axis. The
locations along each arm are separated by 20 m for distances up to 300 m from the center and 40 m
beyond that up to 750 m. One extra antenna is added at 0.5 m from the shower axis to provide an
inner interpolation node. All chosen locations for both sets of points are at the same altitude of
2840 m above sea level.

Note that since the set of points corresponding to the IceTop Surface Enhancement is Ô¨Åxed in
ground coordinates, and that the star pattern is Ô¨Åxed in shower coordinates to the direction of (cid:174)ùë£ √ó (cid:174)ùêµ,
the relative location of both sets strongly depend on the shower direction. Shower directions with
increasingly large zenith angles will have a star pattern that is increasingly stretched along the ground
plane. The changing direction of (cid:174)ùë£ √ó (cid:174)ùêµ with both the zenith and azimuth angle causes a relative
rotation of the star pattern spokes with respect to the ground plane. Thus, the choice of random
azimuth angles ensures that, in the (cid:174)ùë£ √ó (cid:174)ùêµ coordinate system, a sampling location corresponding to
the IceTop Surface Enhancement can occur at any point within the star.

2This atmosphere is implemented in CORSIKA as ATMOD 33.

‚Äì 10 ‚Äì

100050005001000Grid East / m100075050025002505007501000Grid North / mBEarthZenith : 50Azimuth: 257Ground CoordinatesStarTarget5002500250500v√óB Direction / m6004002000200400600v√ó(v√óB) Direction / mShower CoordinatesStarTargetFigure 6. Each panel is an example of the interpolation process to attain the expected waveform at a target
location (red circle), using the four surrounding neighbors (blue crosses). The other target and star-pattern
locations are displayed in a lighter color. These examples correspond to the simulated shower shown in
Ô¨Ågure 5 and the interpolated waveforms in Ô¨Ågure 7.

Interpolation of Coherent Waveforms

3.2
The interpolation of the electric Ô¨Åeld waveforms, (cid:174)ùê∏ (ùë°), begins with a rotation into the (cid:174)ùë£√ó (cid:174)ùêµ coordinate
system, described above. Each of the three components along the (cid:174)ùë£, (cid:174)ùë£ √ó (cid:174)ùêµ, and (cid:174)ùêµ directions are
interpolated separately. In an air shower, the emission along the (cid:174)ùë£-direction is generally the smallest
of these and thus any numerical noise or non-coherent emission from an air shower will have the
least eÔ¨Äect on this interpolation procedure. The interpolation is performed separately on each of
the three components, ùê∏ (ùë°ùëñ), and the respective Fourier amplitudes, (cid:101)ùê∏ ( ùëì ùëó) ‚â° A ùëó for time-bin, ùëñ,
and frequency-bin, ùëó.

First, the start-time, ùëá0,ùëò, of sampling location, ùëò, is recorded. This time is then shifted by the

arrival time of a plane wave moving at the speed of light,

Œîùëá0,ùëò = ùëá0,ùëò ‚àí (Œî(cid:174)ùëüùëò ¬∑ ÀÜùë£)/ùëê.

(3.1)

Here, ÀÜùë£ is the velocity unit vector of the cosmic ray primary, and Œî(cid:174)ùëüùëò is the corresponding location
at which the electric Ô¨Åeld was calculated, with respect to the core. The use of Œîùëá0,ùëò rather than ùëá0,ùëò
ensures that all values of Œîùëá0,ùëò are of the same order of magnitude, which was ultimately found to
produce more accurate results.

In the next two steps, the complex-valued, A ùëó ùëò are decomposed into the real-valued logarithm

of the magnitudes,

M ùëó ùëò = log |A ùëó ùëò |,

and a complex-valued unit vector representing the phase of A ùëó ùëò,

P ùëó ùëò = expùëñ ùúô ùëó ùëò = A ùëó ùëò/|A ùëó ùëò |.

(3.2)

(3.3)

The use of the unit vector in the complex plane, rather than directly calculating the phase angle,
ùúô ùëó ùëò, was done to more naturally avoid the issues of interpolating cyclically-valued quantities.

The corresponding waveform for an arbitrary point within the simulated radio footprint is
calculated using the Œîùëá0,ùëò, M ùëó ùëò, and P ùëó ùëò. As shown in Ô¨Ågure 6, the electric Ô¨Åeld at a given
location is determined using the four nearest and surrounding locations on the simulated spokes of

‚Äì 11 ‚Äì

0204060v√óB Direction / m5060708090100v√ó(v√óB) Direction / mTargetStar250200150100500v√óB Direction / m200250300350400v√ó(v√óB) Direction / mTargetStarthe star. The corresponding values of Œîùëá0, M, and P for the requested location are determined via
a bilinear interpolation in polar coordinates, ùëü and ùúÉ. For Œîùëá0 and M, this is a relatively straight
forward process. However, the interpolated value of P must be renormalized since, in general, the
resulting value has a magnitude less than unity. The frequency spectrum for the target location is
constructed by inverting the decomposition process described in equations (3.2) and (3.3). Finally,
the time-domain electric Ô¨Åeld is recovered via a Fourier transformation and a start time is assigned
to the waveform by inverting equation (3.1).

3.3 Accuracy of the Interpolation Method

For understanding the power of the interpolation method, it is useful to study two examples of the
interpolation procedure. These are shown in Ô¨Ågure 7 for locations at 85 m and 346 m from the
shower axis. For the location closer to the shower axis, the coherence extends across the entire
frequency band being studied, and the Fourier amplitudes are accurately described to within 3%.
For the location further from the shower axis, there is coherence only below (cid:39) 100 MHz.

The deviation of the interpolated and true Fourier amplitudes above 100 MHz in the second
example is an expected behavior. For radii on or inside the Cherenkov ring (located at (cid:39) 100 m
for this shower), the underlying frequency spectra of the radio emission are relatively Ô¨Çat up
to ‚àº 0.1 GHz‚Äì1 GHz. Likewise, the coherent emission from air showers exhibits a smooth and
continuous evolution of the phase angle, as seen in the center-left plot of Ô¨Ågure 7. At radii outside
of the Cherenkov cone, the frequency spectrum is steeper and includes a cutoÔ¨Ä within the band
of interest. Beyond this cutoÔ¨Ä, there is noise, which may be partially physical in origin, e.g. due
to the non-coherent summation of emission from distant regions of the shower front. However,
artifacts can be introduced via the thinning algorithm in CORSIKA wherein the combination of
particles into a single, weighted entity eÔ¨Äectively creates perfectly coherent emission, locally. As the
interpolation method implicitly requires that the values being described are well behaved between
the interpolation nodes, the phases and Fourier amplitudes cannot be replicated for non-coherent
frequency modes. However, for our use case, a high-accuracy reproduction of the non-coherent
aspects of the signal is not important since such low-level noise would be dominated by other
backgrounds in almost all cases.

We performed a statistical comparison of two quantities, chosen for their use in air-shower
reconstructions [49, 50], to determine the overall accuracy of the interpolation method. For each of
the simulated locations on the proposed array, the amplitude- and time-at-maximum of the Hilbert
envelope were calculated. A comparison of these values for the true- and interpolated-pulses are
shown in Ô¨Ågure 8. This study highlights two physical domains in which the interpolation method
produces (in)accurate results. The Ô¨Årst domain, in which the frequency band of interest is either
fully or mostly non-coherent, is characterized by signals with a peak amplitude below a threshold
of ùëâth (cid:39) 3 ùúáV/m. Such signals occur far from the shower axis where spectral cutoÔ¨Ä occurs at
frequencies (cid:46) 50 MHz.
In this domain, the resolution is 10% to 20% in peak amplitude and a
few tens of ns in the peak location.3
In the second domain, the waveforms are fully or mostly
coherent, and the method works well (see example in the left panels of Ô¨Ågure 7). The resolution for
waveforms with a peak amplitude near ùëâth is about 7% in magnitude and 2 ns in peak time. For the

3The 68% conÔ¨Ådence interval should be compared to 2ùúé of a symmetric distribution.

‚Äì 12 ‚Äì

Figure 7. The results of the interpolation method for two example locations that are closer/further from the
shower axis (left/right columns). The plots in the top row show the time series for the exact CoREAS output
(dashed blue) as compared to the interpolated values (solid red) at that location. The Ô¨Ågures in the center and
bottom rows show the group delay and Fourier amplitudes, respectively, for the true and interpolated values.
The residuals of the Fourier amplitudes are given in the lower panels. In all plots, a third-order Butterworth
Ô¨Ålter has been applied for the band 50 MHz‚Äì350 MHz. These two examples correspond to the respective
panels in Ô¨Ågure 6.

largest signals shown here, the resolution is better than 1.5% in amplitude with a diÔ¨Äerence in peak
time that is comparable to the time binning of the simulated electric Ô¨Åeld (0.2 ns). The example in

‚Äì 13 ‚Äì

50100150200250300350400Time / ns8006004002000200400600800Electric Field / (V/m)Distance from axis: 85 m  Peak difference = 9.63 V/m (1.3%)  InterpolatedTrue50100150200250300350400Time / ns321012345Electric Field / (V/m)Distance from axis: 346 m  Peak difference = -0.08 V/m (1.6%)  InterpolatedTrue0100200300400500Frequency / MHz0510152025303540Group Delay / nsInterpolatedTrue0100200300400500Frequency / MHz2001000100200Group Delay / nsInterpolatedTrue0.00.51.01.5Amp / (V/m/MHz)InterpolatedTrue100200300400500Frequency / MHz0.900.951.001.051.10Amp Ratio  (Interp. / True) 0.000.020.040.06Amp / (V/m/MHz)InterpolatedTrue100200300400500Frequency / MHz0.900.951.001.051.10Amp Ratio  (Interp. / True) Figure 8. Metrics for the accuracy and precision of the interpolation method are shown above for the Hilbert
peak amplitude (left) and time-at-maximum (right). The values for individual waveforms are shown in blue.
The median value is overlaid in black with error bars representing the 68% interval. The bottom panels show
the full width of the 68% interval, ùúé68%, in red and the median value, ùúá, in black.

the right panels of Ô¨Ågure 7, which includes coherence only in a fraction of the band of interest, is
indeed above ùëâth, and has a peak amplitude of 4.6 ùúáV/m.

It is important to consider the way that this method scales with cosmic-ray energy. The
accuracy of the interpolation and the value of ùëâth is not tied to an absolute scale in Ô¨Åeld strength. All
simulations studied in this work include an amount of non-coherent emission that is proportional
to the energy of the primary particle. For cosmic rays with higher/lower energies, the distributions
shift to larger/smaller values with the overall structure being unaÔ¨Äected and ùëâth/ùê∏primary being
constant. This has been tested using two additional sets of simulations with primary energies of
50 PeV and 500 PeV.

It is unknown what fraction of this non-coherent emission would actually occur in air showers
as opposed to, for instance, numerical rounding eÔ¨Äects or the extra coherence introduced by the
thinning algorithm implemented in CORSIKA. Thus, the systematic uncertainties introduced via
the interpolation method should be taken into account when considering high energy simulations
where the experimental background noise is comparable to ùëâth. Generally, this would need to be
studied for individual experiments and frequency bands.

The metrics that were chosen to quantify the accuracy of this method are based on macroscopic
observables of individual waveforms. However, they do not necessarily encapsulate more low-level
details, such as the exact shape of the waveform. For analyses that are sensitive to the exact structure
of the waveforms, such as using interferometry to reconstruct air showers [51‚Äì54], a more detailed
In particular, the interferometry
understanding of this method‚Äôs limitations may be required.
technique has been shown to require < 1 ns timing accuracy for the frequency band that will be used
for the IceTop Surface Enhancement [54].

We studied the impact of using diÔ¨Äerent conÔ¨Ågurations of the star layout. Using fewer than
eight spokes produced large discrepancies in the peak amplitude of several tens of percent. We
also studied using an increased density of nodes along each spoke, up to one node every 5 m. For

‚Äì 14 ‚Äì

Figure 9. The observed voltages, after deconvolving the response of the LNA, cables, and readout hardware,
in the six arms of the prototype station at the South Pole are shown in solid color. The respective interpolated
waveforms using a CoREAS simulation with a direction and core motivated by the IceTop reconstruction
(ùúÉ = 32‚ó¶, ùúô = 275‚ó¶, ùê∏IT = 240 PeV) are overlaid in dashed gray.

increased densities of nodes, the quality metrics shown in Ô¨Ågure 8 did not improve. However, using
a spacing between nodes larger than 20 m produced less accurate results.

3.4

Interpolation Example for an Observed Air Shower

An example of the combination of the tools described in this paper is shown in Ô¨Ågure 9. We
show the waveforms corresponding to the two channels of the three antennas for an air shower
that was observed by the prototype station at the South Pole. We simulated a proton shower
using the star pattern with initial conditions based on the direction and energy estimated using the
IceTop reconstruction [15]. Using the core location from the IceTop reconstruction algorithm, the
waveforms were interpolated for each antenna location and then folded with the antenna response.
The resulting voltages are overlaid in dashed gray. General agreement is seen between the measured
and observed voltages for this shower.

‚Äì 15 ‚Äì

15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-1, Ch-070-350 MHzObservedSimulated15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-1, Ch-170-350 MHzIceCube PreliminaryObservedSimulated15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-2, Ch-070-350 MHzObservedSimulated15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-2, Ch-170-350 MHzObservedSimulated15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-3, Ch-070-350 MHzObservedSimulated15010050050100150Time in shower plane / ns0.40.20.00.20.4Amplitude / mVAnt-3, Ch-170-350 MHzObservedSimulated4 Conclusions

In this paper, we detailed the tools developed by the IceCube Collaboration for simulating and
analyzing the radio emission from air showers. Within the observatory, the radio technique is
unique given that it necessitates analyzing waveforms in the frequency domain as well as the
time domain. We described in section 2 the data structures that were included into the IceTray
framework to enable this. Building on the modular structure, several tools have been included to
perform common RF calculations, such as band pass Ô¨Åltering and waveform resampling.

We described the way that the various aspects of the readout hardware are included into the
analysis chain. These take into account the gains and group delays that are associated with the
antenna and the corresponding hardware. Together, we are able to produce end-to-end simulations
of the way that our detector responds to impinging electric Ô¨Åelds, speciÔ¨Åcally those from COR-
SIKA/CoREAS simulations. This also includes the addition of either non-coherent modeled noise
or measured background waveforms from the antennas at the South Pole.

As an integral part of the simulation chain, we have developed a method whereby the electric
Ô¨Åelds produced in simulated air-showers can be interpolated. This method is based on the inter-
polation of the Fourier components and the start time of the waveform to ultimately produce a
time-domain electric Ô¨Åeld. The interpolation method described above works well for the coherent
emission that radio arrays typically measure. For all studied energies, the peak amplitude and
peak time of the air shower pulses can be faithfully reproduced to 5% and 1.5 ns, respectively, for
waveforms with coherent emission in the band of interest.

While this tool was developed as part of our simulation scheme, it has wider applications
for other experiments as well. Since the radio technique is only viable for primary energies
above ‚àº 10 PeV, the computational burden of producing a large library of air shower simulations is
substantial. Being able to resample air shower core locations when performing a detector simulation
directly reduces the amount of time and resources needed to enable an analysis. Additionally, as
existing astroparticle experiments consider various extensions of antenna arrays, such as IceCube-
Gen2 [55], this method enables the production of a single air-shower library that can be used for
testing multiple arrangements of antennas. The second application for this method is in regards
to the reconstruction of air showers. One of the most precise methods for reconstructing the
electromagnetic energy and ùëãmax is to produce many simulations for each observed event and to
compare the observed and simulated waveforms directly [3, 44, 56]. These simulations have initial
conditions such as direction and core location based on the reconstruction of another detector
(typically scintillator panels or Cherenkov tanks). By interpolating the expected signal, one can
also leave the core location as a free (or constrained) parameter while template matching to improve
the accuracy of the reconstruction.

The framework and simulation tools that are described above have been included in the IceCube
software repository. With these, we can simulate the response of the entire observatory to air
showers. The combined detection technique is a necessary step to improve the precision of the
estimation of the primary particle, speciÔ¨Åcally in the assignment of mass and energy. We expect
that the radio technique will play an important role in this regard with respect to the IceTop Surface
Enhancement as well as for the proposed surface array of IceCube-Gen2 [55].

‚Äì 16 ‚Äì

Acknowledgments

The IceCube collaboration acknowledges the signiÔ¨Åcant contributions to this manuscript from Alan
Coleman, Abdul Rehman and Frank Schroeder.

We would like to thank Eloy de Lera Acedo for providing the simulated responses for the

SKALA-v2 antenna and the LNA.

USA ‚Äì U.S. National Science Foundation-OÔ¨Éce of Polar Programs, U.S. National Science
Foundation-Physics Division, U.S. National Science Foundation-EPSCoR, Wisconsin Alumni Re-
search Foundation, Center for High Throughput Computing (CHTC) at the University of Wiscon-
sin‚ÄìMadison, Open Science Grid (OSG), Extreme Science and Engineering Discovery Environment
(XSEDE), Frontera computing project at the Texas Advanced Computing Center, U.S. Department
of Energy-National Energy Research ScientiÔ¨Åc Computing Center, Particle astrophysics research
computing center at the University of Maryland, Institute for Cyber-Enabled Research at Michigan
State University, and Astroparticle physics computational facility at Marquette University; Belgium
‚Äì Funds for ScientiÔ¨Åc Research (FRS-FNRS and FWO), FWO Odysseus and Big Science pro-
grammes, and Belgian Federal Science Policy OÔ¨Éce (Belspo); Germany ‚Äì Bundesministerium f√ºr
Bildung und Forschung (BMBF), Deutsche Forschungsgemeinschaft (DFG), Helmholtz Alliance
for Astroparticle Physics (HAP), Initiative and Networking Fund of the Helmholtz Association,
Deutsches Elektronen Synchrotron (DESY), and High Performance Computing cluster of the RWTH
Aachen; Sweden ‚Äì Swedish Research Council, Swedish Polar Research Secretariat, Swedish Na-
tional Infrastructure for Computing (SNIC), and Knut and Alice Wallenberg Foundation; Australia
‚Äì Australian Research Council; Canada ‚Äì Natural Sciences and Engineering Research Council of
Canada, Calcul Qu√©bec, Compute Ontario, Canada Foundation for Innovation, WestGrid, and Com-
pute Canada; Denmark ‚Äì Villum Fonden and Carlsberg Foundation; New Zealand ‚Äì Marsden Fund;
Japan ‚Äì Japan Society for Promotion of Science (JSPS) and Institute for Global Prominent Research
(IGPR) of Chiba University; Korea ‚Äì National Research Foundation of Korea (NRF); Switzerland ‚Äì
Swiss National Science Foundation (SNSF); United Kingdom ‚Äì Department of Physics, University
of Oxford; European Union ‚Äì European Research Council, Horizon 2020.

References

[1] LOFAR collaboration, Method for high precision reconstruction of air shower ùëãùëöùëéùë• using
two-dimensional radio intensity proÔ¨Åles, Phys. Rev. D 90 (2014) 082003 [1408.7001].

[2] Pierre Auger collaboration, Energy Estimation of Cosmic Rays with the Engineering Radio Array of

the Pierre Auger Observatory, Phys. Rev. D 93 (2016) 122005 [1508.04267].

[3] P.A. Bezyazeekov et al., Reconstruction of cosmic ray air showers with Tunka-Rex data using

template Ô¨Åtting of radio pulses, Phys. Rev. D 97 (2018) 122004 [1803.06862].

[4] Pierre Auger collaboration, Muons in Air Showers at the Pierre Auger Observatory: Mean Number

in Highly Inclined Events, Phys. Rev. D 91 (2015) 032003 [1408.1421].

[5] KASCADE-Grande collaboration, Probing the evolution of the EAS muon content in the atmosphere

with KASCADE-Grande, Astropart. Phys. 95 (2017) 25 [1801.05513].

[6] Telescope Array collaboration, Study of muons from ultrahigh energy cosmic ray air showers
measured with the Telescope Array experiment, Phys. Rev. D 98 (2018) 022002 [1804.03877].

‚Äì 17 ‚Äì

[7] Pierre Auger collaboration, Direct measurement of the muonic content of extensive air showers

between 2 √ó 1017 and 2 √ó 1018 eV at the Pierre Auger Observatory, Eur. Phys. J. C 80 (2020) 751.

[8] Pierre Auger collaboration, Measurement of the Fluctuations in the Number of Muons in Extensive
Air Showers with the Pierre Auger Observatory, Phys. Rev. Lett. 126 (2021) 152002 [2102.07797].

[9] IceCube collaboration, Density of GeV Muons Measured with IceTop, PoS ICRC2021 (2021) 342

[2107.09583].

[10] Pierre Auger collaboration, The Pierre Auger Observatory Upgrade - Preliminary Design Report,

1604.03637.

[11] E.M. Holt, F.G. Schr√∂der and A. Haungs, Enhancing the cosmic-ray mass sensitivity of air-shower
arrays by combining radio and muon detectors, Eur. Phys. J. C 79 (2019) 371 [1905.01409].

[12] IceCube collaboration, Science Case of a Scintillator and Radio Surface Array at IceCube, PoS

ICRC2019 (2020) 418 [1908.11469].

[13] E. De Lera Acedo et al., Evolution of skala (skala-2), the log-periodic array antenna for the ska-low

instrument, Proceedings of ICEAA 2015 (2015) 839.

[14] IceCube collaboration, Development of a scintillation and radio hybrid detector array at the South

Pole, PoS ICRC2021 (2021) 225 [2107.09983].

[15] IceCube collaboration, IceTop: The surface component of IceCube, Nucl. Instrum. Meth. A 700

(2013) 188 [1207.6326].

[16] G.A. Askar‚Äôyan, Excess negative charge of an electron-photon shower and its coherent radio

emission, Zh. Eksp. Teor. Fiz. 41 (1961) 616.

[17] IceCube collaboration, The IceCube Neutrino Observatory: Instrumentation and Online Systems,

JINST 12 (2017) P03012 [1612.05093].

[18] IceCube collaboration, IceTray: A software framework for IceCube, Proceedings of CHEP 2004

(2005) 463.

[19] IceCube collaboration, Simulation and Reconstruction Study of a Future Surface Scintillator Array at

the IceCube Neutrino Observatory, PoS ICRC2019 (2020) 332 [1909.02258].

[20] T. Huege, M. Ludwig and C.W. James, Simulating radio emission from air showers with CoREAS,

AIP Conf. Proc. 1535 (2013) 128 [1301.2132].

[21] D. Heck et al., Corsika: A monte carlo code to simulate extensive air showers, Report FZKA 6019

(1998) .

[22] IceCube collaboration, Cosmic ray spectrum and composition from PeV to EeV using 3 years of data

from IceTop and IceCube, Phys. Rev. D 100 (2019) 082002 [1906.04317].

[23] IceCube collaboration, Search for PeV Gamma-Ray Emission from the Southern Hemisphere with 5

Years of Data from the IceCube Observatory, Astrophys. J. 891 (2019) 9 [1908.09918].

[24] IceCube collaboration, A Three-dimensional Reconstruction of Cosmic Ray Events in IceCube, PoS

ICRC2019 (2020) 244 [1908.07582].

[25] Pierre Auger collaboration, Advanced Functionality for Radio Analysis in the OÔ¨Ñine Software

Framework of the Pierre Auger Observatory, Nucl. Instrum. Meth. A 635 (2011) 92 [1101.4473].

[26] C. Glaser et al., NuRadioReco: A reconstruction framework for radio neutrino detectors, Eur. Phys. J.

C 79 (2019) 464 [1903.07023].

[27] M. Frigo and S.G. Johnson, The Design and Implementation of FFTW3, IEEE Proc. 93 (2005) 216.

‚Äì 18 ‚Äì

[28] M. Folk et al., An overview of the hdf5 technology suite and its applications, in Proceedings of the

EDBT/ICDT 2011 Workshop on Array Databases, pp. 36‚Äì47, 2011.

[29] R. Brun and F. Rademakers, ROOT: An object oriented data analysis framework, Nucl. Instrum. Meth.

A 389 (1997) 81.

[30] S. Butterworth et al., On the theory of Ô¨Ålter ampliÔ¨Åers, Wireless Engineer 7 (1930) 536.

[31] H.V. Cane, Spectra of the non-thermal radio radiation from the galactic polar regions, Mon. Not. R.

Astron. Soc. 189 (1979) 465.

[32] H. Nyquist, Thermal Agitation of Electric Charge in Conductors, Phys. Rev. 32 (1928) 110.

[33] Computer Simulation Technology, CST Studio Suite, 2015.

[34] W.D. Apel et al., The wavefront of the radio signal emitted by cosmic ray air showers, JCAP 09

(2014) 025 [1404.3283].

[35] Cadence, AWR Design Environment, 2016.

[36] M. Renschler, A Prototype Radio Detector for the IceCube Surface Enhancement, Ph.D. thesis, KIT,

Karlsruhe, 2020. 10.5445/IR/1000104529.

[37] C.W. James, H. Falcke, T. Huege and M. Ludwig, General description of electromagnetic radiation

processes based on instantaneous charge acceleration in ‚Äòendpoints‚Äô, Phys. Rev. E 84 (2011) 056602
[1007.4146].

[38] M. Ludwig and T. Huege, REAS3: Monte Carlo simulations of radio emission from cosmic ray air

showers using an ‚Äôend-point‚Äô formalism, Astropart. Phys. 34 (2011) 438 [1010.5343].

[39] E.M. Holt, ‚ÄúSimulationsstudie f√ºr ein gro√üskaliges Antennenfeld zur Detektion von Radioemission

ausgedehnter Luftschauer.‚Äù diploma thesis, KIT, Karlsruhe, 2013.

[40] D. Butler, T. Huege and O. Scholten, Towards a fast and precise forward model for air shower radio

simulation, PoS ICRC2017 (2018) 307 [1708.02481].

[41] M. Tueros and A. Zilles, Synthesis of radio signals from extensive air showers using previously

computed microscopic simulations, JINST 16 (2021) P02031 [2008.06454].

[42] Telescope Array collaboration, The Cosmic-Ray Composition between 2 PeV and 2 EeV Observed

with the TALE Detector in Monocular Mode, Astrophys. J. 909 (2021) 178 [2012.10372].
[43] Auger collaboration, Mass Composition of Cosmic Rays with Energies above 1017.2 eV from the

Hybrid Data of the Pierre Auger Observatory, PoS ICRC2019 (2020) 482.

[44] A. Corstanje et al., Depth of shower maximum and mass composition of cosmic rays from 50 PeV to 2
EeV measured with the LOFAR radio telescope, Phys. Rev. D 103 (2021) 102006 [2103.12549].

[45] K.D. de Vries, A.M. van den Berg, O. Scholten and K. Werner, Coherent Cherenkov Radiation from

Cosmic-Ray-Induced Air Showers, Phys. Rev. Lett. 107 (2011) 061101 [1107.0665].

[46] F. Riehn et al., Hadronic interaction model Sibyll 2.3d and extensive air showers, Phys. Rev. D 102

(2020) 063002 [1912.03300].

[47] A. Ferrari, P.R. Sala, A. Fasso and J. Ranft, FLUKA: A multi-particle transport code (Program

version 2005), .

[48] A. Chulliat et al., The US/UK world magnetic model for 2015‚Äì2020, .

[49] Tunka-Rex collaboration, Radio measurements of the energy and the depth of the shower maximum

of cosmic-ray air showers by Tunka-Rex, JCAP 01 (2016) 052 [1509.05652].

‚Äì 19 ‚Äì

[50] D. Kostunin et al., Reconstruction of air-shower parameters for large-scale radio detectors using the

lateral distribution, Astropart. Phys. 74 (2016) 79 [1504.05083].

[51] A. Romero-Wolf et al., An interferometric analysis method for radio impulses from ultra-high energy

particle showers, Astropart. Phys. 60 (2015) 72.

[52] H. Schoorlemmer and W.R. Carvalho, Radio interferometry applied to the observation of cosmic-ray

induced extensive air showers, 2006.10348.

[53] LOPES collaboration, Final results of the LOPES radio interferometer for cosmic-ray air showers,

Eur. Phys. J. C 81 (2021) 176 [2102.03928].

[54] F. Schl√ºter and T. Huege, Expected performance of air-shower measurements with the

radio-interferometric technique, JINST 16 (2021) P07048 [2102.13577].

[55] IceCube-Gen2 collaboration, IceCube-Gen2: the window to the extreme Universe, J. Phys. G 48

(2021) 060501 [2008.04323].

[56] K. Mulrey et al., On the cosmic-ray energy scale of the LOFAR radio telescope, JCAP 11 (2020) 017

[2005.13441].

‚Äì 20 ‚Äì

